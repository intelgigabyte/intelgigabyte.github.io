const e=/^(https?:\/\/|mailto:|[^:/?#]*(?:[/?#]|$))/i;class t{constructor(t){if(!e.test(t))throw new Error(`URL not marked as safe: ${t}`);this._url=t}toString(){return this._url}}const i=window.location.origin+Sf()+"/",r=document.createElement("style");r.textContent=`\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Thin.ttf",i)}) format("truetype");\n  font-weight: 100;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-ThinItalic.ttf",i)}) format("truetype");\n  font-weight: 100;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Light.ttf",i)}) format("truetype");\n  font-weight: 300;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-LightItalic.ttf",i)}) format("truetype");\n  font-weight: 300;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Regular.ttf",i)}) format("truetype");\n  font-weight: 400;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Italic.ttf",i)}) format("truetype");\n  font-weight: 400;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Medium.ttf",i)}) format("truetype");\n  font-weight: 500;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-MediumItalic.ttf",i)}) format("truetype");\n  font-weight: 500;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Bold.ttf",i)}) format("truetype");\n  font-weight: 700;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-BoldItalic.ttf",i)}) format("truetype");\n  font-weight: 700;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-Black.ttf",i)}) format("truetype");\n  font-weight: 900;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto";\n  src: url(${new URL("fonts/roboto/Roboto-BlackItalic.ttf",i)}) format("truetype");\n  font-weight: 900;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Thin.ttf",i)}) format("truetype");\n  font-weight: 100;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-ThinItalic.ttf",i)}) format("truetype");\n  font-weight: 100;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Light.ttf",i)}) format("truetype");\n  font-weight: 300;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-LightItalic.ttf",i)}) format("truetype");\n  font-weight: 300;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Regular.ttf",i)}) format("truetype");\n  font-weight: 400;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Italic.ttf",i)}) format("truetype");\n  font-weight: 400;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Medium.ttf",i)}) format("truetype");\n  font-weight: 500;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-MediumItalic.ttf",i)}) format("truetype");\n  font-weight: 500;\n  font-style: italic;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-Bold.ttf",i)}) format("truetype");\n  font-weight: 700;\n  font-style: normal;\n  }\n  @font-face {\n  font-family: "Roboto Mono";\n  src: url(${new URL("fonts/robotomono/RobotoMono-BoldItalic.ttf",i)}) format("truetype");\n  font-weight: 700;\n  font-style: italic;\n  }`,document.head.appendChild(r),window.JSCompiler_renameProperty=function(e,t){return e},window.COMPILED=window.COMPILED||!1,COMPILED||window.goog||(window.goog={require(e){if("webcomponentsjs.custom_elements.auto_es5_shim"!==e)throw new Error("Called goog.require without loading //javascript/closure:base")}},window.goog.require.isDevModeNoOpImpl=!0),goog.require("webcomponentsjs.custom_elements.auto_es5_shim"),COMPILED||function(){let e=window.goog&&window.goog.declareModuleId||(()=>{});const t=function(t){if(goog.isInEs6ModuleLoader_())return e(t)};window.goog.declareModuleId?goog.declareModuleId=t:(window.goog.isInEs6ModuleLoader_=()=>!1,Object.defineProperty(window.goog,"declareModuleId",{get:()=>t,set:i=>(e=i,t)}))}(),goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Boot");const o=window.Polymer;window.Polymer=function(e){return window.Polymer._polymerFn(e)},o&&Object.assign(Polymer,o),Polymer._polymerFn=function(e){throw new Error("Load polymer.html to use the Polymer() function.")};let s,n,a=/(url\()([^)]*)(\))/g,l=/(^\/[^\/])|(^#)|(^[\w-\d]*:)/;function d(e,t){if(e&&l.test(e))return e;if("//"===e)return e;if(void 0===s){s=!1;try{const e=new URL("b","http://a");e.pathname="c%20d",s="http://a/c%20d"===e.href}catch(e){}}if(t||(t=document.baseURI||window.location.href),s)try{return new URL(e,t).href}catch(t){return e}return n||(n=document.implementation.createHTMLDocument("temp"),n.base=n.createElement("base"),n.head.appendChild(n.base),n.anchor=n.createElement("a"),n.body.appendChild(n.anchor)),n.base.href=t,n.anchor.href=e,n.anchor.href||e}function c(e,t){return e.replace(a,(function(e,i,r,o){return i+"'"+d(r.replace(/["']/g,""),t)+"'"+o}))}function h(e){return e.substring(0,e.lastIndexOf("/")+1)}const p=h,u=c,g=d;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.ResolveUrl"),Polymer.ResolveUrl={resolveCss:u,resolveUrl:g,pathFromUrl:p};const m=!window.ShadyDOM||!window.ShadyDOM.inUse,f=Boolean(!window.ShadyCSS||window.ShadyCSS.nativeCss),v=!window.customElements.polyfillWrapFlushCallback,b=m&&"adoptedStyleSheets"in Document.prototype&&"replaceSync"in CSSStyleSheet.prototype&&(()=>{try{const e=new CSSStyleSheet;e.replaceSync("");const t=document.createElement("div");return t.attachShadow({mode:"open"}),t.shadowRoot.adoptedStyleSheets=[e],t.shadowRoot.adoptedStyleSheets[0]===e}catch(e){return!1}})();let y=window.Polymer&&window.Polymer.rootPath||h(document.baseURI||window.location.href);const w=function(e){y=e};let _=window.Polymer&&window.Polymer.sanitizeDOMValue||void 0;const x=function(e){_=e};let C=window.Polymer&&window.Polymer.setPassiveTouchGestures||!1;const E=function(e){C=e};let S=window.Polymer&&window.Polymer.strictTemplatePolicy||!1;const $=function(e){S=e};let k=window.Polymer&&window.Polymer.allowTemplateFromDomModule||!1;const A=function(e){k=e};let R=window.Polymer&&window.Polymer.legacyOptimizations||!1;const T=function(e){R=e};let I=window.Polymer&&window.Polymer.legacyWarnings||!1,P=window.Polymer&&window.Polymer.syncInitialRender||!1;const N=function(e){P=e};let O=window.Polymer&&window.Polymer.legacyUndefined||!1,D=window.Polymer&&window.Polymer.orderedComputed||!1,L=!0,M=window.Polymer&&window.Polymer.removeNestedTemplates||!1,F=window.Polymer&&window.Polymer.fastDomIf||!1,U=window.Polymer&&window.Polymer.suppressTemplateNotifications||!1,B=window.Polymer&&window.Polymer.legacyNoObservedAttributes||!1,H=window.Polymer&&window.Polymer.useAdoptedStyleSheetsWithBuiltCSS||!1;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Settings"),Polymer.Settings={useShadow:m,useNativeCSSProperties:f,useNativeCustomElements:v,get rootPath(){return y},setRootPath:w,get sanitizeDOMValue(){return _},setSanitizeDOMValue:x,get passiveTouchGestures(){return C},setPassiveTouchGestures:E,get strictTemplatePolicy(){return S},setStrictTemplatePolicy:$,get allowTemplateFromDomModule(){return k},setAllowTemplateFromDomModule:A,get legacyOptimizations(){return R},setLegacyOptimizations:T,get syncInitialRender(){return P},setSyncInitialRender:N},void 0!==Polymer.rootPath&&w(Polymer.rootPath),void 0!==Polymer.sanitizeDOMValue&&x(Polymer.sanitizeDOMValue),void 0!==Polymer.passiveTouchGestures&&E(Polymer.passiveTouchGestures),void 0!==Polymer.strictTemplatePolicy&&$(Polymer.strictTemplatePolicy),void 0!==Polymer.allowTemplateFromDomModule?A(Polymer.allowTemplateFromDomModule):A(!0),void 0!==Polymer.legacyOptimizations&&T(Polymer.legacyOptimizations),void 0!==Polymer.syncInitialRender&&N(Polymer.syncInitialRender),Object.defineProperty(Polymer,"sanitizeDOMValue",{get:()=>_,set(e){x(e)}});let j=0;function G(){}G.prototype.__mixinApplications,G.prototype.__mixinSet;const z=function(e){let t=e.__mixinApplications;t||(t=new WeakMap,e.__mixinApplications=t);let i=j++;return function(r){let o=r.__mixinSet;if(o&&o[i])return r;let s=t,n=s.get(r);if(!n){n=e(r),s.set(r,n);let t=Object.create(n.__mixinSet||o||null);t[i]=!0,n.__mixinSet=t}return n}},V=z;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Mixin"),Polymer.dedupingMixin=V;let W={},q={};function K(e,t){W[e]=q[e.toLowerCase()]=t}function Y(e){return W[e]||q[e.toLowerCase()]}class X extends HTMLElement{static get observedAttributes(){return["id"]}static import(e,t){if(e){let i=Y(e);return i&&t?i.querySelector(t):i}return null}attributeChangedCallback(e,t,i,r){t!==i&&this.register()}get assetpath(){if(!this.__assetpath){const e=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument,t=d(this.getAttribute("assetpath")||"",e.baseURI);this.__assetpath=h(t)}return this.__assetpath}register(e){if(e=e||this.id){if(S&&void 0!==Y(e))throw K(e,null),new Error(`strictTemplatePolicy: dom-module ${e} re-registered`);this.id=e,K(e,this),(t=this).querySelector("style")&&console.warn("dom-module %s has style outside template",t.id)}var t}}X.prototype.modules=W,customElements.define("dom-module",X),goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.DomModule"),Polymer.DomModule=X;const J="shady-unscoped";function Q(e){return X.import(e)}function Z(e){const t=c((e.body?e.body:e).textContent,e.baseURI),i=document.createElement("style");return i.textContent=t,i}function ee(e){const t=e.trim().split(/\s+/),i=[];for(let e=0;e<t.length;e++)i.push(...te(t[e]));return i}function te(e){const t=Q(e);if(!t)return console.warn("Could not find style data in module named",e),[];if(void 0===t._styles){const e=[];e.push(...oe(t));const i=t.querySelector("template");i&&e.push(...ie(i,t.assetpath)),t._styles=e}return t._styles}function ie(e,t){if(!e._styles){const i=[],r=e.content.querySelectorAll("style");for(let e=0;e<r.length;e++){let o=r[e],s=o.getAttribute("include");s&&i.push(...ee(s).filter((function(e,t,i){return i.indexOf(e)===t}))),t&&(o.textContent=c(o.textContent,t)),i.push(o)}e._styles=i}return e._styles}function re(e){let t=Q(e);return t?oe(t):[]}function oe(e){const t=[],i=e.querySelectorAll("link[rel=import][type~=css]");for(let e=0;e<i.length;e++){let r=i[e];if(r.import){const e=r.import,i=r.hasAttribute(J);if(i&&!e._unscopedStyle){const t=Z(e);t.setAttribute(J,""),e._unscopedStyle=t}else e._style||(e._style=Z(e));t.push(i?e._unscopedStyle:e._style)}}return t}function se(e){let t=e.trim().split(/\s+/),i="";for(let e=0;e<t.length;e++)i+=ne(t[e]);return i}function ne(e){let t=Q(e);if(t&&void 0===t._cssText){let e=le(t),i=t.querySelector("template");i&&(e+=ae(i,t.assetpath)),t._cssText=e||null}return t||console.warn("Could not find style data in module named",e),t&&t._cssText||""}function ae(e,t){let i="";const r=ie(e,t);for(let e=0;e<r.length;e++){let t=r[e];t.parentNode&&t.parentNode.removeChild(t),i+=t.textContent}return i}function le(e){let t="",i=oe(e);for(let e=0;e<i.length;e++)t+=i[e].textContent;return t}goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.StyleGather");const de=ne,ce=se,he=ae,pe=te,ue=re,ge=ee,me=ie;function fe(e){return e.indexOf(".")>=0}function ve(e){let t=e.indexOf(".");return-1===t?e:e.slice(0,t)}function be(e,t){return 0===e.indexOf(t+".")}function ye(e,t){return 0===t.indexOf(e+".")}function we(e,t,i){return t+i.slice(e.length)}function _e(e,t){return e===t||be(e,t)||ye(e,t)}function xe(e){if(Array.isArray(e)){let t=[];for(let i=0;i<e.length;i++){let r=e[i].toString().split(".");for(let e=0;e<r.length;e++)t.push(r[e])}return t.join(".")}return e}function Ce(e){return Array.isArray(e)?xe(e).split("."):e.toString().split(".")}function Ee(e,t,i){let r=e,o=Ce(t);for(let e=0;e<o.length;e++){if(!r)return;r=r[o[e]]}return i&&(i.path=o.join(".")),r}function Se(e,t,i){let r=e,o=Ce(t),s=o[o.length-1];if(o.length>1){for(let e=0;e<o.length-1;e++)if(r=r[o[e]],!r)return;r[s]=i}else r[t]=i;return o.join(".")}Polymer.StyleGather={stylesFromModules:ge,stylesFromModule:pe,stylesFromTemplate:me,stylesFromModuleImports:ue,cssFromModules:ce,cssFromModule:de,cssFromTemplate:he,cssFromModuleImports:function(e){let t=Q(e);return t?le(t):""}};const $e=fe,ke=ve,Ae=be,Re=ye,Te=we,Ie=_e,Pe=xe,Ne=Ce,Oe=Ee,De=Se,Le=fe;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Path"),Polymer.Path={isPath:$e,root:ke,isAncestor:Ae,isDescendant:Re,translate:Te,matches:Ie,normalize:Pe,split:Ne,get:Oe,set:De,isDeep:Le};const Me={},Fe=/-[a-z]/g,Ue=/([A-Z])/g;function Be(e){return Me[e]||(Me[e]=e.indexOf("-")<0?e:e.replace(Fe,(e=>e[1].toUpperCase())))}function He(e){return Me[e]||(Me[e]=e.replace(Ue,"-$1").toLowerCase())}goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.CaseMap");const je=Be,Ge=He;Polymer.CaseMap={dashToCamelCase:je,camelToDashCase:Ge};let ze=0,Ve=0,We=[],qe=0,Ke=!1,Ye=document.createTextNode("");new window.MutationObserver((function(){Ke=!1;const e=We.length;for(let t=0;t<e;t++){let e=We[t];if(e)try{e()}catch(e){setTimeout((()=>{throw e}))}}We.splice(0,e),Ve+=e})).observe(Ye,{characterData:!0});const Xe={after:e=>({run:t=>window.setTimeout(t,e),cancel(e){window.clearTimeout(e)}}),run:(e,t)=>window.setTimeout(e,t),cancel(e){window.clearTimeout(e)}},Je={run:e=>window.requestAnimationFrame(e),cancel(e){window.cancelAnimationFrame(e)}},Qe={run:e=>window.requestIdleCallback?window.requestIdleCallback(e):window.setTimeout(e,16),cancel(e){window.cancelIdleCallback?window.cancelIdleCallback(e):window.clearTimeout(e)}},Ze={run:e=>(Ke||(Ke=!0,Ye.textContent=qe++),We.push(e),ze++),cancel(e){const t=e-Ve;if(t>=0){if(!We[t])throw new Error("invalid async handle: "+e);We[t]=null}}};goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Async"),Polymer.Async={timeOut:Xe,animationFrame:Je,idlePeriod:Qe,microTask:Ze};const et=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:window.ShadyDOM?e=>ShadyDOM.patch(e):e=>e;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Wrap"),Polymer.wrap=et;const tt=Ze,it=z((e=>class extends e{static createProperties(e){const t=this.prototype;for(let i in e)i in t||t._createPropertyAccessor(i)}static attributeNameForProperty(e){return e.toLowerCase()}static typeForProperty(e){}_createPropertyAccessor(e,t){this._addPropertyToAttributeMap(e),this.hasOwnProperty(JSCompiler_renameProperty("__dataHasAccessor",this))||(this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)),this.__dataHasAccessor[e]||(this.__dataHasAccessor[e]=!0,this._definePropertyAccessor(e,t))}_addPropertyToAttributeMap(e){this.hasOwnProperty(JSCompiler_renameProperty("__dataAttributes",this))||(this.__dataAttributes=Object.assign({},this.__dataAttributes));let t=this.__dataAttributes[e];return t||(t=this.constructor.attributeNameForProperty(e),this.__dataAttributes[t]=e),t}_definePropertyAccessor(e,t){Object.defineProperty(this,e,{get(){return this.__data[e]},set:t?function(){}:function(t){this._setPendingProperty(e,t,!0)&&this._invalidateProperties()}})}constructor(){super(),this.__dataEnabled=!1,this.__dataReady=!1,this.__dataInvalid=!1,this.__data={},this.__dataPending=null,this.__dataOld=null,this.__dataInstanceProps=null,this.__dataCounter=0,this.__serializing=!1,this._initializeProperties()}ready(){this.__dataReady=!0,this._flushProperties()}_initializeProperties(){for(let e in this.__dataHasAccessor)this.hasOwnProperty(e)&&(this.__dataInstanceProps=this.__dataInstanceProps||{},this.__dataInstanceProps[e]=this[e],delete this[e])}_initializeInstanceProperties(e){Object.assign(this,e)}_setProperty(e,t){this._setPendingProperty(e,t)&&this._invalidateProperties()}_getProperty(e){return this.__data[e]}_setPendingProperty(e,t,i){let r=this.__data[e],o=this._shouldPropertyChange(e,t,r);return o&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),this.__dataOld&&!(e in this.__dataOld)&&(this.__dataOld[e]=r),this.__data[e]=t,this.__dataPending[e]=t),o}_isPropertyPending(e){return!(!this.__dataPending||!this.__dataPending.hasOwnProperty(e))}_invalidateProperties(){!this.__dataInvalid&&this.__dataReady&&(this.__dataInvalid=!0,tt.run((()=>{this.__dataInvalid&&(this.__dataInvalid=!1,this._flushProperties())})))}_enableProperties(){this.__dataEnabled||(this.__dataEnabled=!0,this.__dataInstanceProps&&(this._initializeInstanceProperties(this.__dataInstanceProps),this.__dataInstanceProps=null),this.ready())}_flushProperties(){this.__dataCounter++;const e=this.__data,t=this.__dataPending,i=this.__dataOld;this._shouldPropertiesChange(e,t,i)&&(this.__dataPending=null,this.__dataOld=null,this._propertiesChanged(e,t,i)),this.__dataCounter--}_shouldPropertiesChange(e,t,i){return Boolean(t)}_propertiesChanged(e,t,i){}_shouldPropertyChange(e,t,i){return i!==t&&(i==i||t==t)}attributeChangedCallback(e,t,i,r){t!==i&&this._attributeToProperty(e,i),super.attributeChangedCallback&&super.attributeChangedCallback(e,t,i,r)}_attributeToProperty(e,t,i){if(!this.__serializing){const r=this.__dataAttributes,o=r&&r[e]||e;this[o]=this._deserializeValue(t,i||this.constructor.typeForProperty(o))}}_propertyToAttribute(e,t,i){this.__serializing=!0,i=arguments.length<3?this[e]:i,this._valueToNodeAttribute(this,i,t||this.constructor.attributeNameForProperty(e)),this.__serializing=!1}_valueToNodeAttribute(e,t,i){const r=this._serializeValue(t);"class"!==i&&"name"!==i&&"slot"!==i||(e=et(e)),void 0===r?e.removeAttribute(i):e.setAttribute(i,""===r&&window.trustedTypes?window.trustedTypes.emptyScript:r)}_serializeValue(e){return"boolean"==typeof e?e?"":void 0:null!=e?e.toString():void 0}_deserializeValue(e,t){switch(t){case Boolean:return null!==e;case Number:return Number(e);default:return e}}})),rt=it;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.PropertiesChanged"),Polymer.PropertiesChanged=rt;const ot={};let st=HTMLElement.prototype;for(;st;){let e=Object.getOwnPropertyNames(st);for(let t=0;t<e.length;t++)ot[e[t]]=!0;st=Object.getPrototypeOf(st)}const nt=window.trustedTypes?e=>trustedTypes.isHTML(e)||trustedTypes.isScript(e)||trustedTypes.isScriptURL(e):()=>!1,at=z((e=>{const t=it(e);return class extends t{static createPropertiesForAttributes(){let e=this.observedAttributes;for(let t=0;t<e.length;t++)this.prototype._createPropertyAccessor(Be(e[t]))}static attributeNameForProperty(e){return He(e)}_initializeProperties(){this.__dataProto&&(this._initializeProtoProperties(this.__dataProto),this.__dataProto=null),super._initializeProperties()}_initializeProtoProperties(e){for(let t in e)this._setProperty(t,e[t])}_ensureAttribute(e,t){this.hasAttribute(e)||this._valueToNodeAttribute(this,t,e)}_serializeValue(e){if("object"==typeof e){if(e instanceof Date)return e.toString();if(e){if(nt(e))return e;try{return JSON.stringify(e)}catch(e){return""}}}return super._serializeValue(e)}_deserializeValue(e,t){let i;switch(t){case Object:try{i=JSON.parse(e)}catch(t){i=e}break;case Array:try{i=JSON.parse(e)}catch(t){i=null,console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${e}`)}break;case Date:i=isNaN(e)?String(e):Number(e),i=new Date(i);break;default:i=super._deserializeValue(e,t)}return i}_definePropertyAccessor(e,t){!function(e,t){if(!ot[t]){let i=e[t];void 0!==i&&(e.__data?e._setPendingProperty(t,i):(e.__dataProto?e.hasOwnProperty(JSCompiler_renameProperty("__dataProto",e))||(e.__dataProto=Object.create(e.__dataProto)):e.__dataProto={},e.__dataProto[t]=i))}}(this,e),super._definePropertyAccessor(e,t)}_hasAccessor(e){return this.__dataHasAccessor&&this.__dataHasAccessor[e]}_isPropertyPending(e){return Boolean(this.__dataPending&&e in this.__dataPending)}}})),lt=at;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.PropertyAccessors"),Polymer.PropertyAccessors=lt;const dt={"dom-if":!0,"dom-repeat":!0};let ct=!1,ht=!1;const pt=(()=>{const e=window.trustedTypes&&window.trustedTypes.createPolicy("polymer-template-event-attribute-policy",{createScript:e=>e});return(t,i,r)=>{const o=i.getAttribute(r);e&&r.startsWith("on-")?t.setAttribute(r,e.createScript(o,r)):t.setAttribute(r,o)}})();function ut(e){let t=e.getAttribute("is");if(t&&dt[t]){let i=e;for(i.removeAttribute("is"),e=i.ownerDocument.createElement(t),i.parentNode.replaceChild(e,i),e.appendChild(i);i.attributes.length;){const{name:t}=i.attributes[0];pt(e,i,t),i.removeAttribute(t)}}return e}function gt(e,t){let i=t.parentInfo&&gt(e,t.parentInfo);if(!i)return e;for(let e=i.firstChild,r=0;e;e=e.nextSibling)if(t.parentIndex===r++)return e}function mt(e,t,i,r){r.id&&(t[r.id]=i)}function ft(e,t,i){if(i.events&&i.events.length)for(let r,o=0,s=i.events;o<s.length&&(r=s[o]);o++)e._addMethodEventListenerToNode(t,r.name,r.value,e)}function vt(e,t,i,r){i.templateInfo&&(t._templateInfo=i.templateInfo,t._parentTemplateInfo=r)}const bt=z((e=>class extends e{static _parseTemplate(e,t){if(!e._templateInfo){let i=e._templateInfo={};i.nodeInfoList=[],i.nestedTemplate=Boolean(t),i.stripWhiteSpace=t&&t.stripWhiteSpace||e.hasAttribute&&e.hasAttribute("strip-whitespace"),this._parseTemplateContent(e,i,{parent:null})}return e._templateInfo}static _parseTemplateContent(e,t,i){return this._parseTemplateNode(e.content,t,i)}static _parseTemplateNode(e,t,i){let r=!1,o=e;return"template"!=o.localName||o.hasAttribute("preserve-content")?"slot"===o.localName&&(t.hasInsertionPoint=!0):r=this._parseTemplateNestedTemplate(o,t,i)||r,function(e){(function(){if(!ct){ct=!0;const e=document.createElement("textarea");e.placeholder="a",ht=e.placeholder===e.textContent}return ht})()&&"textarea"===e.localName&&e.placeholder&&e.placeholder===e.textContent&&(e.textContent=null)}(o),o.firstChild&&this._parseTemplateChildNodes(o,t,i),o.hasAttributes&&o.hasAttributes()&&(r=this._parseTemplateNodeAttributes(o,t,i)||r),r||i.noted}static _parseTemplateChildNodes(e,t,i){if("script"!==e.localName&&"style"!==e.localName)for(let r,o=e.firstChild,s=0;o;o=r){if("template"==o.localName&&(o=ut(o)),r=o.nextSibling,o.nodeType===Node.TEXT_NODE){let i=r;for(;i&&i.nodeType===Node.TEXT_NODE;)o.textContent+=i.textContent,r=i.nextSibling,e.removeChild(i),i=r;if(t.stripWhiteSpace&&!o.textContent.trim()){e.removeChild(o);continue}}let n={parentIndex:s,parentInfo:i};this._parseTemplateNode(o,t,n)&&(n.infoIndex=t.nodeInfoList.push(n)-1),o.parentNode&&s++}}static _parseTemplateNestedTemplate(e,t,i){let r=e,o=this._parseTemplate(r,t);return(o.content=r.content.ownerDocument.createDocumentFragment()).appendChild(r.content),i.templateInfo=o,!0}static _parseTemplateNodeAttributes(e,t,i){let r=!1,o=Array.from(e.attributes);for(let s,n=o.length-1;s=o[n];n--)r=this._parseTemplateNodeAttribute(e,t,i,s.name,s.value)||r;return r}static _parseTemplateNodeAttribute(e,t,i,r,o){return"on-"===r.slice(0,3)?(e.removeAttribute(r),i.events=i.events||[],i.events.push({name:r.slice(3),value:o}),!0):"id"===r&&(i.id=o,!0)}static _contentForTemplate(e){let t=e._templateInfo;return t&&t.content||e.content}_stampTemplate(e,t){e&&!e.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e);let i=(t=t||this.constructor._parseTemplate(e)).nodeInfoList,r=t.content||e.content,o=document.importNode(r,!0);o.__noInsertionPoint=!t.hasInsertionPoint;let s=o.nodeList=new Array(i.length);o.$={};for(let e,r=0,n=i.length;r<n&&(e=i[r]);r++){let i=s[r]=gt(o,e);mt(0,o.$,i,e),vt(0,i,e,t),ft(this,i,e)}return o}_addMethodEventListenerToNode(e,t,i,r){let o=function(e,t,i){return e=e._methodHost||e,function(t){e[i]?e[i](t,t.detail):console.warn("listener method `"+i+"` not defined")}}(r=r||e,0,i);return this._addEventListenerToNode(e,t,o),o}_addEventListenerToNode(e,t,i){e.addEventListener(t,i)}_removeEventListenerFromNode(e,t,i){e.removeEventListener(t,i)}})),yt=bt;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.TemplateStamp"),Polymer.TemplateStamp=yt;let wt=0;const _t=[],xt={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"},Ct="__computeInfo",Et=/[A-Z]/;function St(e,t,i){let r=e[t];if(r){if(!e.hasOwnProperty(t)&&(r=e[t]=Object.create(e[t]),i))for(let e in r){let t=r[e],i=r[e]=Array(t.length);for(let e=0;e<t.length;e++)i[e]=t[e]}}else r=e[t]={};return r}function $t(e,t,i,r,o,s){if(t){let n=!1;const a=wt++;for(let l in i){let d=t[o?ve(l):l];if(d)for(let t,c=0,h=d.length;c<h&&(t=d[c]);c++)t.info&&t.info.lastRun===a||o&&!At(l,t.trigger)||(t.info&&(t.info.lastRun=a),t.fn(e,l,i,r,t.info,o,s),n=!0)}return n}return!1}function kt(e,t,i,r,o,s,n,a){let l=!1,d=t[n?ve(r):r];if(d)for(let t,c=0,h=d.length;c<h&&(t=d[c]);c++)t.info&&t.info.lastRun===i||n&&!At(r,t.trigger)||(t.info&&(t.info.lastRun=i),t.fn(e,r,o,s,t.info,n,a),l=!0);return l}function At(e,t){if(t){let i=t.name;return i==e||!(!t.structured||!be(i,e))||!(!t.wildcard||!ye(i,e))}return!0}function Rt(e,t,i,r,o){let s="string"==typeof o.method?e[o.method]:o.method,n=o.property;s?s.call(e,e.__data[n],r[n]):o.dynamicFn||console.warn("observer method `"+o.method+"` not defined")}function Tt(e,t,i){let r=ve(t);return r!==t&&(It(e,He(r)+"-changed",i[t],t),!0)}function It(e,t,i,r){let o={value:i,queueProperty:!0};r&&(o.path=r),et(e).dispatchEvent(new CustomEvent(t,{detail:o}))}function Pt(e,t,i,r,o,s){let n=(s?ve(t):t)!=t?t:null,a=n?Ee(e,n):e.__data[t];n&&void 0===a&&(a=i[t]),It(e,o.eventName,a,n)}function Nt(e,t,i,r,o){let s=e.__data[t];_&&(s=_(s,o.attrName,"attribute",e)),e._propertyToAttribute(t,o.attrName,s)}const Ot=(e,t,i)=>{let r=0,o=t.length-1,s=-1;for(;r<=o;){const n=r+o>>1,a=i.get(t[n].methodInfo)-i.get(e.methodInfo);if(a<0)r=n+1;else{if(!(a>0)){s=n;break}o=n-1}}s<0&&(s=o+1),t.splice(s,0,e)},Dt=(e,t,i,r,o)=>{const s=t[o?ve(e):e];if(s)for(let t=0;t<s.length;t++){const n=s[t];n.info.lastRun===wt||o&&!At(e,n.trigger)||(n.info.lastRun=wt,Ot(n.info,i,r))}};function Lt(e,t,i,r,o){let s=Gt(e,t,i,0,o);if(s===_t)return!1;let n=o.methodInfo;return e.__dataHasAccessor&&e.__dataHasAccessor[n]?e._setPendingProperty(n,s,!0):(e[n]=s,!1)}function Mt(e,t,i,r,o,s,n){i.bindings=i.bindings||[];let a={kind:r,target:o,parts:s,literal:n,isCompound:1!==s.length};if(i.bindings.push(a),function(e){return Boolean(e.target)&&"attribute"!=e.kind&&"text"!=e.kind&&!e.isCompound&&"{"===e.parts[0].mode}(a)){let{event:e,negate:t}=a.parts[0];a.listenerEvent=e||He(o)+"-changed",a.listenerNegate=t}let l=t.nodeInfoList.length;for(let i=0;i<a.parts.length;i++){let r=a.parts[i];r.compoundIndex=i,Ft(e,t,a,r,l)}}function Ft(e,t,i,r,o){if(!r.literal)if("attribute"===i.kind&&"-"===i.target[0])console.warn("Cannot set attribute "+i.target+' because "-" is not a valid attribute starting character');else{let s=r.dependencies,n={index:o,binding:i,part:r,evaluator:e};for(let i=0;i<s.length;i++){let r=s[i];"string"==typeof r&&(r=Xt(r),r.wildcard=!0),e._addTemplatePropertyEffect(t,r.rootProperty,{fn:Ut,info:n,trigger:r})}}}function Ut(e,t,i,r,o,s,n){let a=n[o.index],l=o.binding,d=o.part;if(s&&d.source&&t.length>d.source.length&&"property"==l.kind&&!l.isCompound&&a.__isPropertyEffectsClient&&a.__dataHasAccessor&&a.__dataHasAccessor[l.target]){let r=i[t];t=we(d.source,l.target,t),a._setPendingPropertyOrPath(t,r,!1,!0)&&e._enqueueClient(a)}else{let n=o.evaluator._evaluateBinding(e,d,t,i,r,s);n!==_t&&function(e,t,i,r,o){if(o=function(e,t,i,r){if(i.isCompound){let o=e.__dataCompoundStorage[i.target];o[r.compoundIndex]=t,t=o.join("")}return"attribute"!==i.kind&&("textContent"!==i.target&&("value"!==i.target||"input"!==e.localName&&"textarea"!==e.localName)||(t=t??"")),t}(t,o,i,r),_&&(o=_(o,i.target,i.kind,t)),"attribute"==i.kind)e._valueToNodeAttribute(t,o,i.target);else{let r=i.target;t.__isPropertyEffectsClient&&t.__dataHasAccessor&&t.__dataHasAccessor[r]?t[xt.READ_ONLY]&&t[xt.READ_ONLY][r]||t._setPendingProperty(r,o)&&e._enqueueClient(t):e._setUnmanagedPropertyToNode(t,r,o)}}(e,a,l,d,n)}}function Bt(e,t){if(t.isCompound){let i=e.__dataCompoundStorage||(e.__dataCompoundStorage={}),r=t.parts,o=new Array(r.length);for(let e=0;e<r.length;e++)o[e]=r[e].literal;let s=t.target;i[s]=o,t.literal&&"property"==t.kind&&("className"===s&&(e=et(e)),e[s]=t.literal)}}function Ht(e,t,i){if(i.listenerEvent){let r=i.parts[0];e.addEventListener(i.listenerEvent,(function(e){!function(e,t,i,r,o){let s,n=e.detail,a=n&&n.path;a?(r=we(i,r,a),s=n&&n.value):s=e.currentTarget[i],s=o?!s:s,t[xt.READ_ONLY]&&t[xt.READ_ONLY][r]||!t._setPendingPropertyOrPath(r,s,!0,Boolean(a))||n&&n.queueProperty||t._invalidateProperties()}(e,t,i.target,r.source,r.negate)}))}}function jt(e,t,i,r,o,s){s=t.static||s&&("object"!=typeof s||s[t.methodName]);let n={methodName:t.methodName,args:t.args,methodInfo:o,dynamicFn:s};for(let o,s=0;s<t.args.length&&(o=t.args[s]);s++)o.literal||e._addPropertyEffect(o.rootProperty,i,{fn:r,info:n,trigger:o});return s&&e._addPropertyEffect(t.methodName,i,{fn:r,info:n}),n}function Gt(e,t,i,r,o){let s=e._methodHost||e,n=s[o.methodName];if(n){let r=e._marshalArgs(o.args,t,i);return r===_t?_t:n.apply(s,r)}o.dynamicFn||console.warn("method `"+o.methodName+"` not defined")}const zt=[],Vt="(?:[a-zA-Z_$][\\w.:$\\-*]*)",Wt="(?:("+Vt+"|(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|(?:(?:'(?:[^'\\\\]|\\\\.)*')|(?:\"(?:[^\"\\\\]|\\\\.)*\")))\\s*)",qt=new RegExp("(\\[\\[|{{)\\s*(?:(!)\\s*)?("+Vt+"\\s*(?:\\(\\s*(?:(?:"+Wt+"(?:,\\s*"+Wt+")*)?)\\)\\s*)?)(?:]]|}})","g");function Kt(e){let t="";for(let i=0;i<e.length;i++)t+=e[i].literal||"";return t}function Yt(e){let t=e.match(/([^\s]+?)\(([\s\S]*)\)/);if(t){let e={methodName:t[1],static:!0,args:zt};return t[2].trim()?function(e,t){return t.args=e.map((function(e){let i=Xt(e);return i.literal||(t.static=!1),i}),this),t}(t[2].replace(/\\,/g,"&comma;").split(","),e):e}return null}function Xt(e){let t=e.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),i={name:t,value:"",literal:!1},r=t[0];switch("-"===r&&(r=t[1]),r>="0"&&r<="9"&&(r="#"),r){case"'":case'"':i.value=t.slice(1,-1),i.literal=!0;break;case"#":i.value=Number(t),i.literal=!0}return i.literal||(i.rootProperty=ve(t),i.structured=fe(t),i.structured&&(i.wildcard=".*"==t.slice(-2),i.wildcard&&(i.name=t.slice(0,-2)))),i}function Jt(e,t,i){let r=Ee(e,i);return void 0===r&&(r=t[i]),r}function Qt(e,t,i,r){const o={indexSplices:r};O&&!e._overrideLegacyUndefined&&(t.splices=o),e.notifyPath(i+".splices",o),e.notifyPath(i+".length",t.length),O&&!e._overrideLegacyUndefined&&(o.indexSplices=[])}function Zt(e,t,i,r,o,s){Qt(e,t,i,[{index:r,addedCount:o,removed:s,object:t,type:"splice"}])}const ei=z((e=>{const t=bt(at(e));return class extends t{constructor(){super(),this.__isPropertyEffectsClient=!0,this.__dataClientsReady,this.__dataPendingClients,this.__dataToNotify,this.__dataLinkedPaths,this.__dataHasPaths,this.__dataCompoundStorage,this.__dataHost,this.__dataTemp,this.__dataClientsInitialized,this.__data,this.__dataPending,this.__dataOld,this.__computeEffects,this.__computeInfo,this.__reflectEffects,this.__notifyEffects,this.__propagateEffects,this.__observeEffects,this.__readOnly,this.__templateInfo,this._overrideLegacyUndefined}get PROPERTY_EFFECT_TYPES(){return xt}_initializeProperties(){super._initializeProperties(),this._registerHost(),this.__dataClientsReady=!1,this.__dataPendingClients=null,this.__dataToNotify=null,this.__dataLinkedPaths=null,this.__dataHasPaths=!1,this.__dataCompoundStorage=this.__dataCompoundStorage||null,this.__dataHost=this.__dataHost||null,this.__dataTemp={},this.__dataClientsInitialized=!1}_registerHost(){if(ti.length){let e=ti[ti.length-1];e._enqueueClient(this),this.__dataHost=e}}_initializeProtoProperties(e){this.__data=Object.create(e),this.__dataPending=Object.create(e),this.__dataOld={}}_initializeInstanceProperties(e){let t=this[xt.READ_ONLY];for(let i in e)t&&t[i]||(this.__dataPending=this.__dataPending||{},this.__dataOld=this.__dataOld||{},this.__data[i]=this.__dataPending[i]=e[i])}_addPropertyEffect(e,t,i){this._createPropertyAccessor(e,t==xt.READ_ONLY);let r=St(this,t,!0)[e];r||(r=this[t][e]=[]),r.push(i)}_removePropertyEffect(e,t,i){let r=St(this,t,!0)[e],o=r.indexOf(i);o>=0&&r.splice(o,1)}_hasPropertyEffect(e,t){let i=this[t];return Boolean(i&&i[e])}_hasReadOnlyEffect(e){return this._hasPropertyEffect(e,xt.READ_ONLY)}_hasNotifyEffect(e){return this._hasPropertyEffect(e,xt.NOTIFY)}_hasReflectEffect(e){return this._hasPropertyEffect(e,xt.REFLECT)}_hasComputedEffect(e){return this._hasPropertyEffect(e,xt.COMPUTE)}_setPendingPropertyOrPath(e,t,i,r){if(r||ve(Array.isArray(e)?e[0]:e)!==e){if(!r){let i=Ee(this,e);if(!(e=Se(this,e,t))||!super._shouldPropertyChange(e,t,i))return!1}if(this.__dataHasPaths=!0,this._setPendingProperty(e,t,i))return function(e,t,i){let r=e.__dataLinkedPaths;if(r){let o;for(let s in r){let n=r[s];ye(s,t)?(o=we(s,n,t),e._setPendingPropertyOrPath(o,i,!0,!0)):ye(n,t)&&(o=we(n,s,t),e._setPendingPropertyOrPath(o,i,!0,!0))}}}(this,e,t),!0}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[e])return this._setPendingProperty(e,t,i);this[e]=t}return!1}_setUnmanagedPropertyToNode(e,t,i){i===e[t]&&"object"!=typeof i||("className"===t&&(e=et(e)),e[t]=i)}_setPendingProperty(e,t,i){let r=this.__dataHasPaths&&fe(e),o=r?this.__dataTemp:this.__data;return!!this._shouldPropertyChange(e,t,o[e])&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),e in this.__dataOld||(this.__dataOld[e]=this.__data[e]),r?this.__dataTemp[e]=t:this.__data[e]=t,this.__dataPending[e]=t,(r||this[xt.NOTIFY]&&this[xt.NOTIFY][e])&&(this.__dataToNotify=this.__dataToNotify||{},this.__dataToNotify[e]=i),!0)}_setProperty(e,t){this._setPendingProperty(e,t,!0)&&this._invalidateProperties()}_invalidateProperties(){this.__dataReady&&this._flushProperties()}_enqueueClient(e){this.__dataPendingClients=this.__dataPendingClients||[],e!==this&&this.__dataPendingClients.push(e)}_flushClients(){this.__dataClientsReady?this.__enableOrFlushClients():(this.__dataClientsReady=!0,this._readyClients(),this.__dataReady=!0)}__enableOrFlushClients(){let e=this.__dataPendingClients;if(e){this.__dataPendingClients=null;for(let t=0;t<e.length;t++){let i=e[t];i.__dataEnabled?i.__dataPending&&i._flushProperties():i._enableProperties()}}}_readyClients(){this.__enableOrFlushClients()}setProperties(e,t){for(let i in e)!t&&this[xt.READ_ONLY]&&this[xt.READ_ONLY][i]||this._setPendingPropertyOrPath(i,e[i],!0);this._invalidateProperties()}ready(){this._flushProperties(),this.__dataClientsReady||this._flushClients(),this.__dataPending&&this._flushProperties()}_propertiesChanged(e,t,i){let r,o=this.__dataHasPaths;this.__dataHasPaths=!1,function(e,t,i,r){let o=e[xt.COMPUTE];if(o)if(D){wt++;const s=function(e){let t=e.constructor.__orderedComputedDeps;if(!t){t=new Map;const i=e[xt.COMPUTE];let r,{counts:o,ready:s,total:n}=function(e){const t=e[Ct],i={},r=e[xt.COMPUTE],o=[];let s=0;for(let e in t){const r=t[e];s+=i[e]=r.args.filter((e=>!e.literal)).length+(r.dynamicFn?1:0)}for(let e in r)t[e]||o.push(e);return{counts:i,ready:o,total:s}}(e);for(;r=s.shift();){t.set(r,t.size);const e=i[r];e&&e.forEach((e=>{const t=e.info.methodInfo;--n,0===--o[t]&&s.push(t)}))}if(0!==n){const t=e;console.warn(`Computed graph for ${t.localName} incomplete; circular?`)}e.constructor.__orderedComputedDeps=t}return t}(e),n=[];for(let e in t)Dt(e,o,n,s,r);let a;for(;a=n.shift();)Lt(e,"",t,0,a)&&Dt(a.methodInfo,o,n,s,r);Object.assign(i,e.__dataOld),Object.assign(t,e.__dataPending),e.__dataPending=null}else{let s=t;for(;$t(e,o,s,i,r);)Object.assign(i,e.__dataOld),Object.assign(t,e.__dataPending),s=e.__dataPending,e.__dataPending=null}}(this,t,i,o),r=this.__dataToNotify,this.__dataToNotify=null,this._propagatePropertyChanges(t,i,o),this._flushClients(),$t(this,this[xt.REFLECT],t,i,o),$t(this,this[xt.OBSERVE],t,i,o),r&&function(e,t,i,r,o){let s,n,a=e[xt.NOTIFY],l=wt++;for(let n in t)t[n]&&(a&&kt(e,a,l,n,i,r,o)||o&&Tt(e,n,i))&&(s=!0);s&&(n=e.__dataHost)&&n._invalidateProperties&&n._invalidateProperties()}(this,r,t,i,o),1==this.__dataCounter&&(this.__dataTemp={})}_propagatePropertyChanges(e,t,i){this[xt.PROPAGATE]&&$t(this,this[xt.PROPAGATE],e,t,i),this.__templateInfo&&this._runEffectsForTemplate(this.__templateInfo,e,t,i)}_runEffectsForTemplate(e,t,i,r){const o=(t,r)=>{$t(this,e.propertyEffects,t,i,r,e.nodeList);for(let o=e.firstChild;o;o=o.nextSibling)this._runEffectsForTemplate(o,t,i,r)};e.runEffects?e.runEffects(o,t,r):o(t,r)}linkPaths(e,t){e=xe(e),t=xe(t),this.__dataLinkedPaths=this.__dataLinkedPaths||{},this.__dataLinkedPaths[e]=t}unlinkPaths(e){e=xe(e),this.__dataLinkedPaths&&delete this.__dataLinkedPaths[e]}notifySplices(e,t){let i={path:""};Qt(this,Ee(this,e,i),i.path,t)}get(e,t){return Ee(t||this,e)}set(e,t,i){i?Se(i,e,t):this[xt.READ_ONLY]&&this[xt.READ_ONLY][e]||this._setPendingPropertyOrPath(e,t,!0)&&this._invalidateProperties()}push(e,...t){let i={path:""},r=Ee(this,e,i),o=r.length,s=r.push(...t);return t.length&&Zt(this,r,i.path,o,t.length,[]),s}pop(e){let t={path:""},i=Ee(this,e,t),r=Boolean(i.length),o=i.pop();return r&&Zt(this,i,t.path,i.length,0,[o]),o}splice(e,t,i,...r){let o,s={path:""},n=Ee(this,e,s);return t<0?t=n.length-Math.floor(-t):t&&(t=Math.floor(t)),o=2===arguments.length?n.splice(t):n.splice(t,i,...r),(r.length||o.length)&&Zt(this,n,s.path,t,r.length,o),o}shift(e){let t={path:""},i=Ee(this,e,t),r=Boolean(i.length),o=i.shift();return r&&Zt(this,i,t.path,0,0,[o]),o}unshift(e,...t){let i={path:""},r=Ee(this,e,i),o=r.unshift(...t);return t.length&&Zt(this,r,i.path,0,t.length,[]),o}notifyPath(e,t){let i;if(1==arguments.length){let r={path:""};t=Ee(this,e,r),i=r.path}else i=Array.isArray(e)?xe(e):e;this._setPendingPropertyOrPath(i,t,!0,!0)&&this._invalidateProperties()}_createReadOnlyProperty(e,t){var i;this._addPropertyEffect(e,xt.READ_ONLY),t&&(this["_set"+(i=e,i[0].toUpperCase()+i.substring(1))]=function(t){this._setProperty(e,t)})}_createPropertyObserver(e,t,i){let r={property:e,method:t,dynamicFn:Boolean(i)};this._addPropertyEffect(e,xt.OBSERVE,{fn:Rt,info:r,trigger:{name:e}}),i&&this._addPropertyEffect(t,xt.OBSERVE,{fn:Rt,info:r,trigger:{name:t}})}_createMethodObserver(e,t){let i=Yt(e);if(!i)throw new Error("Malformed observer expression '"+e+"'");jt(this,i,xt.OBSERVE,Gt,null,t)}_createNotifyingProperty(e){this._addPropertyEffect(e,xt.NOTIFY,{fn:Pt,info:{eventName:He(e)+"-changed",property:e}})}_createReflectedProperty(e){let t=this.constructor.attributeNameForProperty(e);"-"===t[0]?console.warn("Property "+e+" cannot be reflected to attribute "+t+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.'):this._addPropertyEffect(e,xt.REFLECT,{fn:Nt,info:{attrName:t}})}_createComputedProperty(e,t,i){let r=Yt(t);if(!r)throw new Error("Malformed computed expression '"+t+"'");const o=jt(this,r,xt.COMPUTE,Lt,e,i);St(this,Ct)[e]=o}_marshalArgs(e,t,i){const r=this.__data,o=[];for(let s=0,n=e.length;s<n;s++){let{name:n,structured:a,wildcard:l,value:d,literal:c}=e[s];if(!c)if(l){const e=ye(n,t),o=Jt(r,i,e?t:n);d={path:e?t:n,value:o,base:e?Ee(r,n):o}}else d=a?Jt(r,i,n):r[n];if(O&&!this._overrideLegacyUndefined&&void 0===d&&e.length>1)return _t;o[s]=d}return o}static addPropertyEffect(e,t,i){this.prototype._addPropertyEffect(e,t,i)}static createPropertyObserver(e,t,i){this.prototype._createPropertyObserver(e,t,i)}static createMethodObserver(e,t){this.prototype._createMethodObserver(e,t)}static createNotifyingProperty(e){this.prototype._createNotifyingProperty(e)}static createReadOnlyProperty(e,t){this.prototype._createReadOnlyProperty(e,t)}static createReflectedProperty(e){this.prototype._createReflectedProperty(e)}static createComputedProperty(e,t,i){this.prototype._createComputedProperty(e,t,i)}static bindTemplate(e){return this.prototype._bindTemplate(e)}_bindTemplate(e,t){let i=this.constructor._parseTemplate(e),r=this.__preBoundTemplateInfo==i;if(!r)for(let e in i.propertyEffects)this._createPropertyAccessor(e);if(t)if(i=Object.create(i),i.wasPreBound=r,this.__templateInfo){const t=e._parentTemplateInfo||this.__templateInfo,r=t.lastChild;i.parent=t,t.lastChild=i,i.previousSibling=r,r?r.nextSibling=i:t.firstChild=i}else this.__templateInfo=i;else this.__preBoundTemplateInfo=i;return i}static _addTemplatePropertyEffect(e,t,i){(e.hostProps=e.hostProps||{})[t]=!0;let r=e.propertyEffects=e.propertyEffects||{};(r[t]=r[t]||[]).push(i)}_stampTemplate(e,t){t=t||this._bindTemplate(e,!0),ti.push(this);let i=super._stampTemplate(e,t);if(ti.pop(),t.nodeList=i.nodeList,!t.wasPreBound){let e=t.childNodes=[];for(let t=i.firstChild;t;t=t.nextSibling)e.push(t)}return i.templateInfo=t,function(e,t){let{nodeList:i,nodeInfoList:r}=t;if(r.length)for(let t=0;t<r.length;t++){let o=r[t],s=i[t],n=o.bindings;if(n)for(let t=0;t<n.length;t++){let i=n[t];Bt(s,i),Ht(s,e,i)}s.__dataHost=e}}(this,t),this.__dataClientsReady&&(this._runEffectsForTemplate(t,this.__data,null,!1),this._flushClients()),i}_removeBoundDom(e){const t=e.templateInfo,{previousSibling:i,nextSibling:r,parent:o}=t;i?i.nextSibling=r:o&&(o.firstChild=r),r?r.previousSibling=i:o&&(o.lastChild=i),t.nextSibling=t.previousSibling=null;let s=t.childNodes;for(let e=0;e<s.length;e++){let t=s[e];et(et(t).parentNode).removeChild(t)}}static _parseTemplateNode(e,i,r){let o=t._parseTemplateNode.call(this,e,i,r);if(e.nodeType===Node.TEXT_NODE){let t=this._parseBindings(e.textContent,i);t&&(e.textContent=Kt(t)||" ",Mt(this,i,r,"text","textContent",t),o=!0)}return o}static _parseTemplateNodeAttribute(e,i,r,o,s){let n=this._parseBindings(s,i);if(n){let t=o,s="property";Et.test(o)?s="attribute":"$"==o[o.length-1]&&(o=o.slice(0,-1),s="attribute");let a=Kt(n);return a&&"attribute"==s&&("class"==o&&e.hasAttribute("class")&&(a+=" "+e.getAttribute(o)),e.setAttribute(o,a)),"attribute"==s&&"disable-upgrade$"==t&&e.setAttribute(o,""),"input"===e.localName&&"value"===t&&e.setAttribute(t,""),e.removeAttribute(t),"property"===s&&(o=Be(o)),Mt(this,i,r,s,o,n,a),!0}return t._parseTemplateNodeAttribute.call(this,e,i,r,o,s)}static _parseTemplateNestedTemplate(e,i,r){let o=t._parseTemplateNestedTemplate.call(this,e,i,r);const s=e.parentNode,n=r.templateInfo,a="dom-if"===s.localName,l="dom-repeat"===s.localName;M&&(a||l)&&(s.removeChild(e),(r=r.parentInfo).templateInfo=n,r.noted=!0,o=!1);let d=n.hostProps;if(F&&a)d&&(i.hostProps=Object.assign(i.hostProps||{},d),M||(r.parentInfo.noted=!0));else{let e="{";for(let t in d)Mt(this,i,r,"property","_host_"+t,[{mode:e,source:t,dependencies:[t],hostProp:!0}])}return o}static _parseBindings(e,t){let i,r=[],o=0;for(;null!==(i=qt.exec(e));){i.index>o&&r.push({literal:e.slice(o,i.index)});let s=i[1][0],n=Boolean(i[2]),a=i[3].trim(),l=!1,d="",c=-1;"{"==s&&(c=a.indexOf("::"))>0&&(d=a.substring(c+2),a=a.substring(0,c),l=!0);let h=Yt(a),p=[];if(h){let{args:e,methodName:i}=h;for(let t=0;t<e.length;t++){let i=e[t];i.literal||p.push(i)}let r=t.dynamicFns;(r&&r[i]||h.static)&&(p.push(i),h.dynamicFn=!0)}else p.push(a);r.push({source:a,mode:s,negate:n,customEvent:l,signature:h,dependencies:p,event:d}),o=qt.lastIndex}if(o&&o<e.length){let t=e.substring(o);t&&r.push({literal:t})}return r.length?r:null}static _evaluateBinding(e,t,i,r,o,s){let n;return n=t.signature?Gt(e,i,r,0,t.signature):i!=t.source?Ee(e,t.source):s&&fe(i)?Ee(e,i):e.__data[i],t.negate&&(n=!n),n}}})),ti=[],ii=ei;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.PropertyEffects"),Polymer.PropertyEffects=ii;let ri=0;function oi(){ri++}const si=[];function ni(e){console.log("["+e.is+"]: registered")}function ai(e){si.push(e)}const li=oi,di=si,ci=ai;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Telemetry"),Polymer.telemetry={instanceCount:ri,incrementInstanceCount:li,registrations:di,register:ci,dumpRegistrations:function(){si.forEach(ni)}};const hi=z((e=>{const t=it(e);function i(e){const t=Object.getPrototypeOf(e);return t.prototype instanceof o?t:null}function r(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",e))){let t=null;if(e.hasOwnProperty(JSCompiler_renameProperty("properties",e))){const i=e.properties;i&&(t=function(e){const t={};for(let i in e){const r=e[i];t[i]="function"==typeof r?{type:r}:r}return t}(i))}e.__ownProperties=t}return e.__ownProperties}class o extends t{static get observedAttributes(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))){ai(this.prototype);const e=this._properties;this.__observedAttributes=e?Object.keys(e).map((e=>this.prototype._addPropertyToAttributeMap(e))):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const e=i(this);e&&e.finalize(),this.__finalized=!0,this._finalizeClass()}}static _finalizeClass(){const e=r(this);e&&this.createProperties(e)}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const e=i(this);this.__properties=Object.assign({},e&&e._properties,r(this))}return this.__properties}static typeForProperty(e){const t=this._properties[e];return t&&t.type}_initializeProperties(){oi(),this.constructor.finalize(),super._initializeProperties()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._enableProperties()}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback()}}return o})),pi=hi;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.PropertiesMixin"),Polymer.PropertiesMixin=pi;let ui=class e{constructor(){this._asyncModule=null,this._callback=null,this._timer=null}setConfig(e,t){this._asyncModule=e,this._callback=t,this._timer=this._asyncModule.run((()=>{this._timer=null,gi.delete(this),this._callback()}))}cancel(){this.isActive()&&(this._cancelAsync(),gi.delete(this))}_cancelAsync(){this.isActive()&&(this._asyncModule.cancel(this._timer),this._timer=null)}flush(){this.isActive()&&(this.cancel(),this._callback())}isActive(){return null!=this._timer}static debounce(t,i,r){return t instanceof e?t._cancelAsync():t=new e,t.setConfig(i,r),t}},gi=new Set;const mi=function(e){gi.add(e)},fi=function(){const e=Boolean(gi.size);return gi.forEach((e=>{try{e.flush()}catch(e){setTimeout((()=>{throw e}))}})),e};goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Debounce");const vi=ui;Polymer.Debouncer=vi;let bi="string"==typeof document.head.style.touchAction,yi="__polymerGestures",wi="__polymerGesturesHandled",_i="__polymerGesturesTouchAction",xi=["mousedown","mousemove","mouseup","click"],Ci=[0,1,4,2],Ei=function(){try{return 1===new MouseEvent("test",{buttons:1}).buttons}catch(e){return!1}}();function Si(e){return xi.indexOf(e)>-1}let $i=!1;function ki(e){if(!Si(e)&&"touchend"!==e)return bi&&$i&&C?{passive:!0}:void 0}!function(){try{let e=Object.defineProperty({},"passive",{get(){$i=!0}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}}();let Ai=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/);const Ri=[],Ti={button:!0,input:!0,keygen:!0,meter:!0,output:!0,textarea:!0,progress:!0,select:!0},Ii={button:!0,command:!0,fieldset:!0,input:!0,keygen:!0,optgroup:!0,option:!0,select:!0,textarea:!0};function Pi(e){let t=Array.prototype.slice.call(e.labels||[]);if(!t.length){t=[];try{let i=e.getRootNode();if(e.id){let r=i.querySelectorAll(`label[for = '${e.id}']`);for(let e=0;e<r.length;e++)t.push(r[e])}}catch(e){}}return t}let Ni=function(e){let t=e.sourceCapabilities;var i;if((!t||t.firesTouchEvents)&&(e[wi]={skip:!0},"click"===e.type)){let t=!1,r=Ui(e);for(let e=0;e<r.length;e++){if(r[e].nodeType===Node.ELEMENT_NODE)if("label"===r[e].localName)Ri.push(r[e]);else if(i=r[e],Ti[i.localName]){let i=Pi(r[e]);for(let e=0;e<i.length;e++)t=t||Ri.indexOf(i[e])>-1}if(r[e]===Li.mouse.target)return}if(t)return;e.preventDefault(),e.stopPropagation()}};function Oi(e){let t=Ai?["click"]:xi;for(let i,r=0;r<t.length;r++)i=t[r],e?(Ri.length=0,document.addEventListener(i,Ni,!0)):document.removeEventListener(i,Ni,!0)}function Di(e){let t=e.type;if(!Si(t))return!1;if("mousemove"===t){let t=void 0===e.buttons?1:e.buttons;return e instanceof window.MouseEvent&&!Ei&&(t=Ci[e.which]||0),Boolean(1&t)}return 0===(void 0===e.button?0:e.button)}let Li={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};function Mi(e,t,i){e.movefn=t,e.upfn=i,document.addEventListener("mousemove",t),document.addEventListener("mouseup",i)}function Fi(e){document.removeEventListener("mousemove",e.movefn),document.removeEventListener("mouseup",e.upfn),e.movefn=null,e.upfn=null}L&&document.addEventListener("touchend",(function(e){L&&(Li.mouse.mouseIgnoreJob||Oi(!0),Li.mouse.target=Ui(e)[0],Li.mouse.mouseIgnoreJob=ui.debounce(Li.mouse.mouseIgnoreJob,Xe.after(2500),(function(){Oi(),Li.mouse.target=null,Li.mouse.mouseIgnoreJob=null})))}),!!$i&&{passive:!0});const Ui=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:e=>e.composedPath&&e.composedPath()||[],Bi={},Hi=[];function ji(e,t){let i=document.elementFromPoint(e,t),r=i;for(;r&&r.shadowRoot&&!window.ShadyDOM;){let o=r;if(r=r.shadowRoot.elementFromPoint(e,t),o===r)break;r&&(i=r)}return i}function Gi(e){const t=Ui(e);return t.length>0?t[0]:e.target}function zi(e){let t,i=e.type,r=e.currentTarget[yi];if(!r)return;let o=r[i];if(o){if(!e[wi]&&(e[wi]={},"touch"===i.slice(0,5))){let t=e.changedTouches[0];if("touchstart"===i&&1===e.touches.length&&(Li.touch.id=t.identifier),Li.touch.id!==t.identifier)return;bi||"touchstart"!==i&&"touchmove"!==i||function(e){let t=e.changedTouches[0],i=e.type;if("touchstart"===i)Li.touch.x=t.clientX,Li.touch.y=t.clientY,Li.touch.scrollDecided=!1;else if("touchmove"===i){if(Li.touch.scrollDecided)return;Li.touch.scrollDecided=!0;let i=function(e){let t="auto",i=Ui(e);for(let e,r=0;r<i.length;r++)if(e=i[r],e[_i]){t=e[_i];break}return t}(e),r=!1,o=Math.abs(Li.touch.x-t.clientX),s=Math.abs(Li.touch.y-t.clientY);e.cancelable&&("none"===i?r=!0:"pan-x"===i?r=s>o:"pan-y"===i&&(r=o>s)),r?e.preventDefault():Xi("track")}}(e)}if(t=e[wi],!t.skip){for(let i,r=0;r<Hi.length;r++)i=Hi[r],o[i.name]&&!t[i.name]&&i.flow&&i.flow.start.indexOf(e.type)>-1&&i.reset&&i.reset();for(let r,s=0;s<Hi.length;s++)r=Hi[s],o[r.name]&&!t[r.name]&&(t[r.name]=!0,r[i](e))}}}function Vi(e,t,i){return!!Bi[t]&&(function(e,t,i){let r=Bi[t],o=r.deps,s=r.name,n=e[yi];n||(e[yi]=n={});for(let t,i,r=0;r<o.length;r++)t=o[r],Ai&&Si(t)&&"click"!==t||(i=n[t],i||(n[t]=i={_count:0}),0===i._count&&e.addEventListener(t,zi,ki(t)),i[s]=(i[s]||0)+1,i._count=(i._count||0)+1);e.addEventListener(t,i),r.touchAction&&Ki(e,r.touchAction)}(e,t,i),!0)}function Wi(e,t,i){return!!Bi[t]&&(function(e,t,i){let r=Bi[t],o=r.deps,s=r.name,n=e[yi];if(n)for(let t,i,r=0;r<o.length;r++)t=o[r],i=n[t],i&&i[s]&&(i[s]=(i[s]||1)-1,i._count=(i._count||1)-1,0===i._count&&e.removeEventListener(t,zi,ki(t)));e.removeEventListener(t,i)}(e,t,i),!0)}function qi(e){Hi.push(e);for(let t=0;t<e.emits.length;t++)Bi[e.emits[t]]=e}function Ki(e,t){bi&&e instanceof HTMLElement&&Ze.run((()=>{e.style.touchAction=t})),e[_i]=t}function Yi(e,t,i){let r=new Event(t,{bubbles:!0,cancelable:!0,composed:!0});if(r.detail=i,et(e).dispatchEvent(r),r.defaultPrevented){let e=i.preventer||i.sourceEvent;e&&e.preventDefault&&e.preventDefault()}}function Xi(e){let t=function(e){for(let t,i=0;i<Hi.length;i++){t=Hi[i];for(let i,r=0;r<t.emits.length;r++)if(i=t.emits[r],i===e)return t}return null}(e);t.info&&(t.info.prevent=!0)}function Ji(e,t,i,r){t&&Yi(t,e,{x:i.clientX,y:i.clientY,sourceEvent:i,preventer:r,prevent:function(e){return Xi(e)}})}function Qi(e,t,i){if(e.prevent)return!1;if(e.started)return!0;let r=Math.abs(e.x-t),o=Math.abs(e.y-i);return r>=5||o>=5}function Zi(e,t,i){if(!t)return;let r,o=e.moves[e.moves.length-2],s=e.moves[e.moves.length-1],n=s.x-e.x,a=s.y-e.y,l=0;o&&(r=s.x-o.x,l=s.y-o.y),Yi(t,"track",{state:e.state,x:i.clientX,y:i.clientY,dx:n,dy:a,ddx:r,ddy:l,sourceEvent:i,hover:function(){return ji(i.clientX,i.clientY)}})}function er(e,t,i){let r=Math.abs(t.clientX-e.x),o=Math.abs(t.clientY-e.y),s=Gi(i||t);!s||Ii[s.localName]&&s.hasAttribute("disabled")||(isNaN(r)||isNaN(o)||r<=25&&o<=25||function(e){if("click"===e.type){if(0===e.detail)return!0;let t=Gi(e);if(!t.nodeType||t.nodeType!==Node.ELEMENT_NODE)return!0;let i=t.getBoundingClientRect(),r=e.pageX,o=e.pageY;return!(r>=i.left&&r<=i.right&&o>=i.top&&o<=i.bottom)}return!1}(t))&&(e.prevent||Yi(s,"tap",{x:t.clientX,y:t.clientY,sourceEvent:t,preventer:i}))}qi({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){Fi(this.info)},mousedown:function(e){if(!Di(e))return;let t=Gi(e),i=this;Mi(this.info,(function(e){Di(e)||(Ji("up",t,e),Fi(i.info))}),(function(e){Di(e)&&Ji("up",t,e),Fi(i.info)})),Ji("down",t,e)},touchstart:function(e){Ji("down",Gi(e),e.changedTouches[0],e)},touchend:function(e){Ji("up",Gi(e),e.changedTouches[0],e)}}),qi({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(e){this.moves.length>2&&this.moves.shift(),this.moves.push(e)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,Fi(this.info)},mousedown:function(e){if(!Di(e))return;let t=Gi(e),i=this,r=function(e){let r=e.clientX,o=e.clientY;Qi(i.info,r,o)&&(i.info.state=i.info.started?"mouseup"===e.type?"end":"track":"start","start"===i.info.state&&Xi("tap"),i.info.addMove({x:r,y:o}),Di(e)||(i.info.state="end",Fi(i.info)),t&&Zi(i.info,t,e),i.info.started=!0)};Mi(this.info,r,(function(e){i.info.started&&r(e),Fi(i.info)})),this.info.x=e.clientX,this.info.y=e.clientY},touchstart:function(e){let t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchmove:function(e){let t=Gi(e),i=e.changedTouches[0],r=i.clientX,o=i.clientY;Qi(this.info,r,o)&&("start"===this.info.state&&Xi("tap"),this.info.addMove({x:r,y:o}),Zi(this.info,t,i),this.info.state="track",this.info.started=!0)},touchend:function(e){let t=Gi(e),i=e.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:i.clientX,y:i.clientY}),Zi(this.info,t,i))}}),qi({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},mousedown:function(e){Di(e)&&(this.info.x=e.clientX,this.info.y=e.clientY)},click:function(e){Di(e)&&er(this.info,e)},touchstart:function(e){const t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchend:function(e){er(this.info,e.changedTouches[0],e)}});const tr=Bi,ir=Hi,rr=ji,or=Vi,sr=Wi,nr=qi,ar=Ki,lr=Xi,dr=Gi,cr=Vi,hr=Wi;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Gestures"),Polymer.Gestures={gestures:tr,recognizers:ir,deepTargetFind:rr,addListener:or,removeListener:sr,register:nr,setTouchAction:ar,prevent:lr,resetMouseCanceller:function(){Li.mouse.mouseIgnoreJob&&Li.mouse.mouseIgnoreJob.flush()},findOriginalTarget:dr,add:cr,remove:hr};const pr=z((e=>class extends e{_addEventListenerToNode(e,t,i){Vi(e,t,i)||super._addEventListenerToNode(e,t,i)}_removeEventListenerFromNode(e,t,i){Wi(e,t,i)||super._removeEventListenerFromNode(e,t,i)}})),ur=pr;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.GestureEventListeners"),Polymer.GestureEventListeners=ur;const gr=/:host\(:dir\((ltr|rtl)\)\)/g,mr=/([\s\w-#\.\[\]\*]*):dir\((ltr|rtl)\)/g,fr=/:dir\((?:ltr|rtl)\)/,vr=Boolean(window.ShadyDOM&&window.ShadyDOM.inUse),br=[];let yr=null,wr="";function _r(){wr=document.documentElement.getAttribute("dir")}function xr(e){e.__autoDirOptOut||e.setAttribute("dir",wr)}function Cr(){_r(),wr=document.documentElement.getAttribute("dir");for(let e=0;e<br.length;e++)xr(br[e])}const Er=z((e=>{vr||yr||(_r(),yr=new MutationObserver(Cr),yr.observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]}));const t=at(e);class i extends t{static _processStyleText(e,i){return e=t._processStyleText.call(this,e,i),!vr&&fr.test(e)&&(e=this._replaceDirInCssText(e),this.__activateDir=!0),e}static _replaceDirInCssText(e){let t=e;return t=t.replace(gr,':host([dir="$1"])'),t=t.replace(mr,':host([dir="$2"]) $1'),t}constructor(){super(),this.__autoDirOptOut=!1}ready(){super.ready(),this.__autoDirOptOut=this.hasAttribute("dir")}connectedCallback(){t.prototype.connectedCallback&&super.connectedCallback(),this.constructor.__activateDir&&(yr&&yr.takeRecords().length&&Cr(),br.push(this),xr(this))}disconnectedCallback(){if(t.prototype.disconnectedCallback&&super.disconnectedCallback(),this.constructor.__activateDir){const e=br.indexOf(this);e>-1&&br.splice(e,1)}}}return i.__activateDir=!1,i})),Sr=Er;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.DirMixin"),Polymer.DirMixin=Sr;let $r=!1,kr=[],Ar=[];function Rr(){$r=!0,requestAnimationFrame((function(){$r=!1,Tr(kr),setTimeout((function(){!function(e){for(let t=0,i=e.length;t<i;t++)Ir(e.shift())}(Ar)}))}))}function Tr(e){for(;e.length;)Ir(e.shift())}function Ir(e){const t=e[0],i=e[1],r=e[2];try{i.apply(t,r)}catch(e){setTimeout((()=>{throw e}))}}function Pr(){document.body.removeAttribute("unresolved")}function Nr(e,t,i){return{index:e,removed:t,addedCount:i}}function Or(e,t){return function(e,t,i,r,o,s){let n,a=0,l=0,d=Math.min(i-t,s-o);if(0==t&&0==o&&(a=function(e,t,i){for(let r=0;r<i;r++)if(!Dr(e[r],t[r]))return r;return i}(e,r,d)),i==e.length&&s==r.length&&(l=function(e,t,i){let r=e.length,o=t.length,s=0;for(;s<i&&Dr(e[--r],t[--o]);)s++;return s}(e,r,d-a)),o+=a,s-=l,(i-=l)-(t+=a)==0&&s-o==0)return[];if(t==i){for(n=Nr(t,[],0);o<s;)n.removed.push(r[o++]);return[n]}if(o==s)return[Nr(t,[],i-t)];let c=function(e){let t=e.length-1,i=e[0].length-1,r=e[t][i],o=[];for(;t>0||i>0;){if(0==t){o.push(2),i--;continue}if(0==i){o.push(3),t--;continue}let s,n=e[t-1][i-1],a=e[t-1][i],l=e[t][i-1];s=a<l?a<n?a:n:l<n?l:n,s==n?(n==r?o.push(0):(o.push(1),r=n),t--,i--):s==a?(o.push(3),t--,r=a):(o.push(2),i--,r=l)}return o.reverse(),o}(function(e,t,i,r,o,s){let n=s-o+1,a=i-t+1,l=new Array(n);for(let e=0;e<n;e++)l[e]=new Array(a),l[e][0]=e;for(let e=0;e<a;e++)l[0][e]=e;for(let i=1;i<n;i++)for(let s=1;s<a;s++)if(Dr(e[t+s-1],r[o+i-1]))l[i][s]=l[i-1][s-1];else{let e=l[i-1][s]+1,t=l[i][s-1]+1;l[i][s]=e<t?e:t}return l}(e,t,i,r,o,s));n=void 0;let h=[],p=t,u=o;for(let e=0;e<c.length;e++)switch(c[e]){case 0:n&&(h.push(n),n=void 0),p++,u++;break;case 1:n||(n=Nr(p,[],0)),n.addedCount++,p++,n.removed.push(r[u]),u++;break;case 2:n||(n=Nr(p,[],0)),n.addedCount++,p++;break;case 3:n||(n=Nr(p,[],0)),n.removed.push(r[u]),u++}return n&&h.push(n),h}(e,0,e.length,t,0,t.length)}function Dr(e,t){return e===t}goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.RenderStatus"),Polymer.RenderStatus={beforeNextRender:function(e,t,i){$r||Rr(),kr.push([e,t,i])},afterNextRender:function(e,t,i){$r||Rr(),Ar.push([e,t,i])},flush:function(){for(;kr.length||Ar.length;)Tr(kr),Tr(Ar);$r=!1}},"interactive"===document.readyState||"complete"===document.readyState?Pr():window.addEventListener("DOMContentLoaded",Pr),goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Unresolved");const Lr=Or;function Mr(e){return"slot"===e.localName}goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.ArraySplice"),Polymer.ArraySplice={calculateSplices:Lr};let Fr=class{static getFlattenedNodes(e){const t=et(e);if(Mr(e))return t.assignedNodes({flatten:!0});{const e=[];for(let i=0;i<t.childNodes.length;i++){const r=t.childNodes[i];if(Mr(r)){const t=r;e.push(...et(t).assignedNodes({flatten:!0}))}else e.push(r)}return e}}constructor(e,t){this._shadyChildrenObserver=null,this._nativeChildrenObserver=null,this._connected=!1,this._target=e,this.callback=t,this._effectiveNodes=[],this._observer=null,this._scheduled=!1,this._boundSchedule=()=>{this._schedule()},this.connect(),this._schedule()}connect(){Mr(this._target)?this._listenSlots([this._target]):et(this._target).children&&(this._listenSlots(et(this._target).children),window.ShadyDOM?this._shadyChildrenObserver=window.ShadyDOM.observeChildren(this._target,(e=>{this._processMutations(e)})):(this._nativeChildrenObserver=new MutationObserver((e=>{this._processMutations(e)})),this._nativeChildrenObserver.observe(this._target,{childList:!0}))),this._connected=!0}disconnect(){Mr(this._target)?this._unlistenSlots([this._target]):et(this._target).children&&(this._unlistenSlots(et(this._target).children),window.ShadyDOM&&this._shadyChildrenObserver?(window.ShadyDOM.unobserveChildren(this._shadyChildrenObserver),this._shadyChildrenObserver=null):this._nativeChildrenObserver&&(this._nativeChildrenObserver.disconnect(),this._nativeChildrenObserver=null)),this._connected=!1}_schedule(){this._scheduled||(this._scheduled=!0,Ze.run((()=>this.flush())))}_processMutations(e){this._processSlotMutations(e),this.flush()}_processSlotMutations(e){if(e)for(let t=0;t<e.length;t++){let i=e[t];i.addedNodes&&this._listenSlots(i.addedNodes),i.removedNodes&&this._unlistenSlots(i.removedNodes)}}flush(){if(!this._connected)return!1;window.ShadyDOM&&ShadyDOM.flush(),this._nativeChildrenObserver?this._processSlotMutations(this._nativeChildrenObserver.takeRecords()):this._shadyChildrenObserver&&this._processSlotMutations(this._shadyChildrenObserver.takeRecords()),this._scheduled=!1;let e={target:this._target,addedNodes:[],removedNodes:[]},t=this.constructor.getFlattenedNodes(this._target),i=Or(t,this._effectiveNodes);for(let t,r=0;r<i.length&&(t=i[r]);r++)for(let i,r=0;r<t.removed.length&&(i=t.removed[r]);r++)e.removedNodes.push(i);for(let r,o=0;o<i.length&&(r=i[o]);o++)for(let i=r.index;i<r.index+r.addedCount;i++)e.addedNodes.push(t[i]);this._effectiveNodes=t;let r=!1;return(e.addedNodes.length||e.removedNodes.length)&&(r=!0,this.callback.call(this._target,e)),r}_listenSlots(e){for(let t=0;t<e.length;t++){let i=e[t];Mr(i)&&i.addEventListener("slotchange",this._boundSchedule)}}_unlistenSlots(e){for(let t=0;t<e.length;t++){let i=e[t];Mr(i)&&i.removeEventListener("slotchange",this._boundSchedule)}}};goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.FlattenedNodesObserver"),Polymer.FlattenedNodesObserver=Fr;const Ur=function(){let e,t;do{e=window.ShadyDOM&&ShadyDOM.flush(),window.ShadyCSS&&window.ShadyCSS.ScopingShim&&window.ShadyCSS.ScopingShim.flush(),t=fi()}while(e||t)},Br=mi,Hr=Ur;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Flush"),Polymer.enqueueDebouncer=Br,Polymer.flush=Hr;const jr=Element.prototype,Gr=jr.matches||jr.matchesSelector||jr.mozMatchesSelector||jr.msMatchesSelector||jr.oMatchesSelector||jr.webkitMatchesSelector,zr=function(e,t){return Gr.call(e,t)};class Vr{constructor(e){window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.patch(e),this.node=e}observeNodes(e){return new Fr(this.node,e)}unobserveNodes(e){e.disconnect()}notifyObserver(){}deepContains(e){if(et(this.node).contains(e))return!0;let t=e,i=e.ownerDocument;for(;t&&t!==i&&t!==this.node;)t=et(t).parentNode||et(t).host;return t===this.node}getOwnerRoot(){return et(this.node).getRootNode()}getDistributedNodes(){return"slot"===this.node.localName?et(this.node).assignedNodes({flatten:!0}):[]}getDestinationInsertionPoints(){let e=[],t=et(this.node).assignedSlot;for(;t;)e.push(t),t=et(t).assignedSlot;return e}importNode(e,t){let i=this.node instanceof Document?this.node:this.node.ownerDocument;return et(i).importNode(e,t)}getEffectiveChildNodes(){return Fr.getFlattenedNodes(this.node)}queryDistributedElements(e){let t=this.getEffectiveChildNodes(),i=[];for(let r,o=0,s=t.length;o<s&&(r=t[o]);o++)r.nodeType===Node.ELEMENT_NODE&&zr(r,e)&&i.push(r);return i}get activeElement(){let e=this.node;return void 0!==e._activeElement?e._activeElement:e.activeElement}}function Wr(e,t){for(let i=0;i<t.length;i++){let r=t[i];Object.defineProperty(e,r,{get:function(){return this.node[r]},configurable:!0})}}let qr=class{constructor(e){this.event=e}get rootTarget(){return this.path[0]}get localTarget(){return this.event.target}get path(){return this.event.composedPath()}};Vr.prototype.cloneNode,Vr.prototype.appendChild,Vr.prototype.insertBefore,Vr.prototype.removeChild,Vr.prototype.replaceChild,Vr.prototype.setAttribute,Vr.prototype.removeAttribute,Vr.prototype.querySelector,Vr.prototype.querySelectorAll,Vr.prototype.parentNode,Vr.prototype.firstChild,Vr.prototype.lastChild,Vr.prototype.nextSibling,Vr.prototype.previousSibling,Vr.prototype.firstElementChild,Vr.prototype.lastElementChild,Vr.prototype.nextElementSibling,Vr.prototype.previousElementSibling,Vr.prototype.childNodes,Vr.prototype.children,Vr.prototype.classList,Vr.prototype.textContent,Vr.prototype.innerHTML;let Kr=Vr;if(window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.noPatch&&window.ShadyDOM.Wrapper){class e extends window.ShadyDOM.Wrapper{}Object.getOwnPropertyNames(Vr.prototype).forEach((t=>{"activeElement"!=t&&(e.prototype[t]=Vr.prototype[t])})),Wr(e.prototype,["classList"]),Kr=e,Object.defineProperties(qr.prototype,{localTarget:{get(){const e=this.event.currentTarget,t=e&&Yr(e).getOwnerRoot(),i=this.path;for(let e=0;e<i.length;e++){const r=i[e];if(Yr(r).getOwnerRoot()===t)return r}},configurable:!0},path:{get(){return window.ShadyDOM.composedPath(this.event)},configurable:!0}})}else!function(e,t){for(let i=0;i<t.length;i++){let r=t[i];e[r]=function(){return this.node[r].apply(this.node,arguments)}}}(Vr.prototype,["cloneNode","appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute","querySelector","querySelectorAll","attachShadow"]),Wr(Vr.prototype,["parentNode","firstChild","lastChild","nextSibling","previousSibling","firstElementChild","lastElementChild","nextElementSibling","previousElementSibling","childNodes","children","classList","shadowRoot"]),function(e,t){for(let i=0;i<t.length;i++){let r=t[i];Object.defineProperty(e,r,{get:function(){return this.node[r]},set:function(e){this.node[r]=e},configurable:!0})}}(Vr.prototype,["textContent","innerHTML","className"]);const Yr=function(e){if((e=e||document)instanceof Kr)return e;if(e instanceof qr)return e;let t=e.__domApi;return t||(t=e instanceof Event?new qr(e):new Kr(e),e.__domApi=t),t},Xr=Kr,Jr=qr,Qr=Yr,Zr=zr,eo=Ur,to=mi;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.PolymerDom"),Polymer.DomApi=Xr,Polymer.EventApi=Jr,Polymer.dom=Qr,Polymer.dom.matchesSelector=Zr,Polymer.dom.flush=eo,Polymer.dom.addDebouncer=to;const io="3.5.2",ro=window.ShadyCSS&&window.ShadyCSS.cssBuild,oo=z((e=>{const t=hi(ei(e));function i(e,t,i,r){i.computed&&(i.readOnly=!0),i.computed&&(e._hasReadOnlyEffect(t)?console.warn(`Cannot redefine computed property '${t}'.`):e._createComputedProperty(t,i.computed,r)),i.readOnly&&!e._hasReadOnlyEffect(t)?e._createReadOnlyProperty(t,!i.computed):!1===i.readOnly&&e._hasReadOnlyEffect(t)&&console.warn(`Cannot make readOnly property '${t}' non-readOnly.`),i.reflectToAttribute&&!e._hasReflectEffect(t)?e._createReflectedProperty(t):!1===i.reflectToAttribute&&e._hasReflectEffect(t)&&console.warn(`Cannot make reflected property '${t}' non-reflected.`),i.notify&&!e._hasNotifyEffect(t)?e._createNotifyingProperty(t):!1===i.notify&&e._hasNotifyEffect(t)&&console.warn(`Cannot make notify property '${t}' non-notify.`),i.observer&&e._createPropertyObserver(t,i.observer,r[i.observer]),e._addPropertyToAttributeMap(t)}return class extends t{static get polymerElementVersion(){return io}static _finalizeClass(){t._finalizeClass.call(this);const e=((i=this).hasOwnProperty(JSCompiler_renameProperty("__ownObservers",i))||(i.__ownObservers=i.hasOwnProperty(JSCompiler_renameProperty("observers",i))?i.observers:null),i.__ownObservers);var i;e&&this.createObservers(e,this._properties),this._prepareTemplate()}static _prepareTemplate(){let e=this.template;e&&("string"==typeof e?(console.error("template getter must return HTMLTemplateElement"),e=null):R||(e=e.cloneNode(!0))),this.prototype._template=e}static createProperties(e){for(let t in e)i(this.prototype,t,e[t],e)}static createObservers(e,t){const i=this.prototype;for(let r=0;r<e.length;r++)i._createMethodObserver(e[r],t)}static get template(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_template",this))){let e=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:void 0;"function"==typeof e&&(e=e()),this._template=void 0!==e?e:this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&function(e){let t=null;if(e&&(!S||k)&&(t=X.import(e,"template"),S&&!t))throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${e}`);return t}(this.is)||Object.getPrototypeOf(this.prototype).constructor.template}return this._template}static set template(e){this._template=e}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const e=this.importMeta;if(e)this._importPath=h(e.url);else{const e=X.import(this.is);this._importPath=e&&e.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super(),this._template,this._importPath,this.rootPath,this.importPath,this.root,this.$}_initializeProperties(){this.constructor.finalize(),this.constructor._finalizeTemplate(this.localName),super._initializeProperties(),this.rootPath=y,this.importPath=this.constructor.importPath;let e=function(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",e))){e.__propertyDefaults=null;let t=e._properties;for(let i in t){let r=t[i];"value"in r&&(e.__propertyDefaults=e.__propertyDefaults||{},e.__propertyDefaults[i]=r)}}return e.__propertyDefaults}(this.constructor);if(e)for(let t in e){let i=e[t];if(this._canApplyPropertyDefault(t)){let e="function"==typeof i.value?i.value.call(this):i.value;this._hasAccessor(t)?this._setPendingProperty(t,e,!0):this[t]=e}}}_canApplyPropertyDefault(e){return!this.hasOwnProperty(e)}static _processStyleText(e,t){return c(e,t)}static _finalizeTemplate(e){const t=this.prototype._template;if(t&&!t.__polymerFinalized){t.__polymerFinalized=!0;const i=this.importPath;!function(e,t,i,r){if(!ro){const o=t.content.querySelectorAll("style"),s=ie(t),n=re(i),a=t.content.firstElementChild;for(let i=0;i<n.length;i++){let o=n[i];o.textContent=e._processStyleText(o.textContent,r),t.content.insertBefore(o,a)}let l=0;for(let t=0;t<s.length;t++){let i=s[t],n=o[l];n!==i?(i=i.cloneNode(!0),n.parentNode.insertBefore(i,n)):l++,i.textContent=e._processStyleText(i.textContent,r)}}if(window.ShadyCSS&&window.ShadyCSS.prepareTemplate(t,i),H&&ro&&b){const i=t.content.querySelectorAll("style");if(i){let t="";Array.from(i).forEach((e=>{t+=e.textContent,e.parentNode.removeChild(e)})),e._styleSheet=new CSSStyleSheet,e._styleSheet.replaceSync(t)}}}(this,t,e,i?d(i):""),this.prototype._bindTemplate(t)}}connectedCallback(){window.ShadyCSS&&this._template&&window.ShadyCSS.styleElement(this),super.connectedCallback()}ready(){this._template&&(this.root=this._stampTemplate(this._template),this.$=this.root.$),super.ready()}_readyClients(){this._template&&(this.root=this._attachDom(this.root)),super._readyClients()}_attachDom(e){const t=et(this);if(t.attachShadow)return e?(t.shadowRoot||(t.attachShadow({mode:"open",shadyUpgradeFragment:e}),t.shadowRoot.appendChild(e),this.constructor._styleSheet&&(t.shadowRoot.adoptedStyleSheets=[this.constructor._styleSheet])),P&&window.ShadyDOM&&window.ShadyDOM.flushInitial(t.shadowRoot),t.shadowRoot):null;throw new Error("ShadowDOM not available. PolymerElement can create dom as children instead of in ShadowDOM by setting `this.root = this;` before `ready`.")}updateStyles(e){window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,e)}resolveUrl(e,t){return!t&&this.importPath&&(t=d(this.importPath)),d(e,t)}static _parseTemplateContent(e,i,r){return i.dynamicFns=i.dynamicFns||this._properties,t._parseTemplateContent.call(this,e,i,r)}static _addTemplatePropertyEffect(e,i,r){return!I||i in this._properties||r.info.part.signature&&r.info.part.signature.static||r.info.part.hostProp||e.nestedTemplate||console.warn(`Property '${i}' used in template but not declared in 'properties'; attribute will not be observed.`),t._addTemplatePropertyEffect.call(this,e,i,r)}}})),so=oo;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.ElementMixin"),Polymer.ElementMixin=so,Polymer.updateStyles=function(e){window.ShadyCSS&&window.ShadyCSS.styleDocument(e)},Polymer.version=io;const no=!(window.ShadyDOM&&window.ShadyDOM.inUse);let ao,lo;function co(e){ao=(!e||!e.shimcssproperties)&&(no||Boolean(!navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)&&window.CSS&&CSS.supports&&CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.cssBuild&&(lo=window.ShadyCSS.cssBuild);const ho=Boolean(window.ShadyCSS&&window.ShadyCSS.disableRuntime);window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?ao=window.ShadyCSS.nativeCss:window.ShadyCSS?(co(window.ShadyCSS),window.ShadyCSS=void 0):co(window.WebComponents&&window.WebComponents.flags);const po=ao;class uo{constructor(){this.start=0,this.end=0,this.previous=null,this.parent=null,this.rules=null,this.parsedCssText="",this.cssText="",this.atRule=!1,this.type=0,this.keyframesName="",this.selector="",this.parsedSelector=""}}function go(e){return mo(function(e){let t=new uo;t.start=0,t.end=e.length;let i=t;for(let r=0,o=e.length;r<o;r++)if(e[r]===bo){i.rules||(i.rules=[]);let e=i,t=e.rules[e.rules.length-1]||null;i=new uo,i.start=r+1,i.parent=e,i.previous=t,e.rules.push(i)}else e[r]===yo&&(i.end=r+1,i=i.parent||t);return t}(e=e.replace(wo.comments,"").replace(wo.port,"")),e)}function mo(e,t){let i=t.substring(e.start,e.end-1);if(e.parsedCssText=e.cssText=i.trim(),e.parent){let r=e.previous?e.previous.end:e.parent.start;i=t.substring(r,e.start-1),i=function(e){return e.replace(/\\([0-9a-f]{1,6})\s/gi,(function(){let e=arguments[1],t=6-e.length;for(;t--;)e="0"+e;return"\\"+e}))}(i),i=i.replace(wo.multipleSpaces," "),i=i.substring(i.lastIndexOf(";")+1);let o=e.parsedSelector=e.selector=i.trim();e.atRule=0===o.indexOf(Co),e.atRule?0===o.indexOf(xo)?e.type=vo.MEDIA_RULE:o.match(wo.keyframesRule)&&(e.type=vo.KEYFRAMES_RULE,e.keyframesName=e.selector.split(wo.multipleSpaces).pop()):0===o.indexOf(_o)?e.type=vo.MIXIN_RULE:e.type=vo.STYLE_RULE}let r=e.rules;if(r)for(let e,i=0,o=r.length;i<o&&(e=r[i]);i++)mo(e,t);return e}function fo(e,t,i=""){let r="";if(e.cssText||e.rules){let i=e.rules;if(i&&!function(e){let t=e[0];return Boolean(t)&&Boolean(t.selector)&&0===t.selector.indexOf(_o)}(i))for(let e,o=0,s=i.length;o<s&&(e=i[o]);o++)r=fo(e,t,r);else r=t?e.cssText:function(e){return function(e){return e.replace(wo.mixinApply,"").replace(wo.varApply,"")}(e=function(e){return e.replace(wo.customProp,"").replace(wo.mixinProp,"")}(e))}(e.cssText),r=r.trim(),r&&(r="  "+r+"\n")}return r&&(e.selector&&(i+=e.selector+" "+bo+"\n"),i+=r,e.selector&&(i+=yo+"\n\n")),i}const vo={STYLE_RULE:1,KEYFRAMES_RULE:7,MEDIA_RULE:4,MIXIN_RULE:1e3},bo="{",yo="}",wo={comments:/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,port:/@import[^;]*;/gim,customProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mixinProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,mixinApply:/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,varApply:/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,keyframesRule:/^@[^\s]*keyframes/,multipleSpaces:/\s+/g},_o="--",xo="@media",Co="@",Eo=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,So=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,$o=/@media\s(.*)/,ko=new Set;function Ao(e){const t=e.textContent;if(!ko.has(t)){ko.add(t);const e=document.createElement("style");e.setAttribute("shady-unscoped",""),e.textContent=t,document.head.appendChild(e)}}function Ro(e){return e.hasAttribute("shady-unscoped")}function To(e,t){return e?("string"==typeof e&&(e=go(e)),t&&Po(e,t),fo(e,po)):""}function Io(e){return!e.__cssRules&&e.textContent&&(e.__cssRules=go(e.textContent)),e.__cssRules||null}function Po(e,t,i,r){if(!e)return;let o=!1,s=e.type;if(r&&s===vo.MEDIA_RULE){let t=e.selector.match($o);t&&(window.matchMedia(t[1]).matches||(o=!0))}s===vo.STYLE_RULE?t(e):i&&s===vo.KEYFRAMES_RULE?i(e):s===vo.MIXIN_RULE&&(o=!0);let n=e.rules;if(n&&!o)for(let e,o=0,s=n.length;o<s&&(e=n[o]);o++)Po(e,t,i,r)}function No(e,t){let i=e.indexOf("var(");if(-1===i)return t(e,"","","");let r=function(e,t){let i=0;for(let r=t,o=e.length;r<o;r++)if("("===e[r])i++;else if(")"===e[r]&&0===--i)return r;return-1}(e,i+3),o=e.substring(i+4,r),s=e.substring(0,i),n=No(e.substring(r+1),t),a=o.indexOf(",");return-1===a?t(s,o.trim(),"",n):t(s,o.substring(0,a).trim(),o.substring(a+1).trim(),n)}window.ShadyDOM&&window.ShadyDOM.wrap;const Oo="css-build";function Do(e){return""!==function(e){if(void 0!==lo)return lo;if(void 0===e.__cssBuild){const t=e.getAttribute(Oo);if(t)e.__cssBuild=t;else{const t=function(e){const t="template"===e.localName?e.content.firstChild:e.firstChild;if(t instanceof Comment){const e=t.textContent.trim().split(":");if(e[0]===Oo)return e[1]}return""}(e);""!==t&&function(e){const t="template"===e.localName?e.content.firstChild:e.firstChild;t.parentNode.removeChild(t)}(e),e.__cssBuild=t}}return e.__cssBuild||""}(e)}function Lo(e,t){for(let i in t)null===i?e.style.removeProperty(i):e.style.setProperty(i,t[i])}function Mo(e,t){const i=window.getComputedStyle(e).getPropertyValue(t);return i?i.trim():""}const Fo=/;\s*/m,Uo=/^\s*(initial)|(inherit)\s*$/,Bo=/\s*!important/,Ho="_-_";class jo{constructor(){this._map={}}set(e,t){e=e.trim(),this._map[e]={properties:t,dependants:{}}}get(e){return e=e.trim(),this._map[e]||null}}let Go=null;class zo{constructor(){this._currentElement=null,this._measureElement=null,this._map=new jo}detectMixin(e){return function(e){const t=So.test(e)||Eo.test(e);return So.lastIndex=0,Eo.lastIndex=0,t}(e)}gatherStyles(e){const t=function(e){const t=[],i=e.querySelectorAll("style");for(let e=0;e<i.length;e++){const r=i[e];Ro(r)?no||(Ao(r),r.parentNode.removeChild(r)):(t.push(r.textContent),r.parentNode.removeChild(r))}return t.join("").trim()}(e.content);if(t){const i=document.createElement("style");return i.textContent=t,e.content.insertBefore(i,e.content.firstChild),i}return null}transformTemplate(e,t){void 0===e._gatheredStyle&&(e._gatheredStyle=this.gatherStyles(e));const i=e._gatheredStyle;return i?this.transformStyle(i,t):null}transformStyle(e,t=""){let i=Io(e);return this.transformRules(i,t),e.textContent=To(i),i}transformCustomStyle(e){let t=Io(e);return Po(t,(e=>{":root"===e.selector&&(e.selector="html"),this.transformRule(e)})),e.textContent=To(t),t}transformRules(e,t){this._currentElement=t,Po(e,(e=>{this.transformRule(e)})),this._currentElement=null}transformRule(e){e.cssText=this.transformCssText(e.parsedCssText,e),":root"===e.selector&&(e.selector=":host > *")}transformCssText(e,t){return e=e.replace(Eo,((e,i,r,o)=>this._produceCssProperties(e,i,r,o,t))),this._consumeCssProperties(e,t)}_getInitialValueForProperty(e){return this._measureElement||(this._measureElement=document.createElement("meta"),this._measureElement.setAttribute("apply-shim-measure",""),this._measureElement.style.all="initial",document.head.appendChild(this._measureElement)),window.getComputedStyle(this._measureElement).getPropertyValue(e)}_fallbacksFromPreviousRules(e){let t=e;for(;t.parent;)t=t.parent;const i={};let r=!1;return Po(t,(t=>{r=r||t===e,r||t.selector===e.selector&&Object.assign(i,this._cssTextToMap(t.parsedCssText))})),i}_consumeCssProperties(e,t){let i=null;for(;i=So.exec(e);){let r=i[0],o=i[1],s=i.index,n=s+r.indexOf("@apply"),a=s+r.length,l=e.slice(0,n),d=e.slice(a),c=t?this._fallbacksFromPreviousRules(t):{};Object.assign(c,this._cssTextToMap(l));let h=this._atApplyToCssProperties(o,c);e=`${l}${h}${d}`,So.lastIndex=s+h.length}return e}_atApplyToCssProperties(e,t){e=e.replace(Fo,"");let i=[],r=this._map.get(e);if(r||(this._map.set(e,{}),r=this._map.get(e)),r){let o,s,n;this._currentElement&&(r.dependants[this._currentElement]=!0);const a=r.properties;for(o in a)n=t&&t[o],s=[o,": var(",e,Ho,o],n&&s.push(",",n.replace(Bo,"")),s.push(")"),Bo.test(a[o])&&s.push(" !important"),i.push(s.join(""))}return i.join("; ")}_replaceInitialOrInherit(e,t){let i=Uo.exec(t);return i&&(t=i[1]?this._getInitialValueForProperty(e):"apply-shim-inherit"),t}_cssTextToMap(e,t=!1){let i,r,o=e.split(";"),s={};for(let e,n,a=0;a<o.length;a++)e=o[a],e&&(n=e.split(":"),n.length>1&&(i=n[0].trim(),r=n.slice(1).join(":"),t&&(r=this._replaceInitialOrInherit(i,r)),s[i]=r));return s}_invalidateMixinEntry(e){if(Go)for(let t in e.dependants)t!==this._currentElement&&Go(t)}_produceCssProperties(e,t,i,r,o){if(i&&No(i,((e,t)=>{t&&this._map.get(t)&&(r=`@apply ${t};`)})),!r)return e;let s=this._consumeCssProperties(""+r,o),n=e.slice(0,e.indexOf("--")),a=this._cssTextToMap(s,!0),l=a,d=this._map.get(t),c=d&&d.properties;c?l=Object.assign(Object.create(c),a):this._map.set(t,l);let h,p,u=[],g=!1;for(h in l)p=a[h],void 0===p&&(p="initial"),c&&!(h in c)&&(g=!0),u.push(`${t}${Ho}${h}: ${p}`);return g&&this._invalidateMixinEntry(d),d&&(d.properties=l),i&&(n=`${e};${n}`),`${n}${u.join("; ")};`}}zo.prototype.detectMixin=zo.prototype.detectMixin,zo.prototype.transformStyle=zo.prototype.transformStyle,zo.prototype.transformCustomStyle=zo.prototype.transformCustomStyle,zo.prototype.transformRules=zo.prototype.transformRules,zo.prototype.transformRule=zo.prototype.transformRule,zo.prototype.transformTemplate=zo.prototype.transformTemplate,zo.prototype._separator=Ho,Object.defineProperty(zo.prototype,"invalidCallback",{get:()=>Go,set(e){Go=e}});const Vo={},Wo="_applyShimCurrentVersion",qo="_applyShimNextVersion",Ko="_applyShimValidatingVersion",Yo=Promise.resolve();function Xo(e){let t=Vo[e];t&&function(e){e[Wo]=e[Wo]||0,e[Ko]=e[Ko]||0,e[qo]=(e[qo]||0)+1}(t)}function Jo(e){return e[Wo]===e[qo]}let Qo,Zo=null,es=window.HTMLImports&&window.HTMLImports.whenReady||null;function ts(e){requestAnimationFrame((function(){es?es(e):(Zo||(Zo=new Promise((e=>{Qo=e})),"complete"===document.readyState?Qo():document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&Qo()}))),Zo.then((function(){e&&e()})))}))}const is="__seenByShadyCSS",rs="__shadyCSSCachedStyle";let os=null,ss=null,ns=class{constructor(){this.customStyles=[],this.enqueued=!1,ts((()=>{window.ShadyCSS.flushCustomStyles&&window.ShadyCSS.flushCustomStyles()}))}enqueueDocumentValidation(){!this.enqueued&&ss&&(this.enqueued=!0,ts(ss))}addCustomStyle(e){e[is]||(e[is]=!0,this.customStyles.push(e),this.enqueueDocumentValidation())}getStyleForCustomStyle(e){if(e[rs])return e[rs];let t;return t=e.getStyle?e.getStyle():e,t}processStyles(){const e=this.customStyles;for(let t=0;t<e.length;t++){const i=e[t];if(i[rs])continue;const r=this.getStyleForCustomStyle(i);if(r){const e=r.__appliedElement||r;os&&os(e),i[rs]=e}}return e}};ns.prototype.addCustomStyle=ns.prototype.addCustomStyle,ns.prototype.getStyleForCustomStyle=ns.prototype.getStyleForCustomStyle,ns.prototype.processStyles=ns.prototype.processStyles,Object.defineProperties(ns.prototype,{transformCallback:{get:()=>os,set(e){os=e}},validateCallback:{get:()=>ss,set(e){let t=!1;ss||(t=!0),ss=e,t&&this.enqueueDocumentValidation()}}});const as=new zo;class ls{constructor(){this.customStyleInterface=null,as.invalidCallback=Xo}ensure(){this.customStyleInterface||window.ShadyCSS.CustomStyleInterface&&(this.customStyleInterface=window.ShadyCSS.CustomStyleInterface,this.customStyleInterface.transformCallback=e=>{as.transformCustomStyle(e)},this.customStyleInterface.validateCallback=()=>{requestAnimationFrame((()=>{this.customStyleInterface.enqueued&&this.flushCustomStyles()}))})}prepareTemplate(e,t){if(this.ensure(),Do(e))return;Vo[t]=e;let i=as.transformTemplate(e,t);e._styleAst=i}flushCustomStyles(){if(this.ensure(),!this.customStyleInterface)return;let e=this.customStyleInterface.processStyles();if(this.customStyleInterface.enqueued){for(let t=0;t<e.length;t++){let i=e[t],r=this.customStyleInterface.getStyleForCustomStyle(i);r&&as.transformCustomStyle(r)}this.customStyleInterface.enqueued=!1}}styleSubtree(e,t){if(this.ensure(),t&&Lo(e,t),e.shadowRoot){this.styleElement(e);let t=e.shadowRoot.children||e.shadowRoot.childNodes;for(let e=0;e<t.length;e++)this.styleSubtree(t[e])}else{let t=e.children||e.childNodes;for(let e=0;e<t.length;e++)this.styleSubtree(t[e])}}styleElement(e){this.ensure();let{is:t}=function(e){let t=e.localName,i="",r="";return t?t.indexOf("-")>-1?i=t:(r=t,i=e.getAttribute&&e.getAttribute("is")||""):(i=e.is,r=e.extends),{is:i,typeExtension:r}}(e),i=Vo[t];if((!i||!Do(i))&&i&&!Jo(i)){(function(e){return!Jo(e)&&e[Ko]===e[qo]})(i)||(this.prepareTemplate(i,t),function(e){e[Ko]=e[qo],e._validating||(e._validating=!0,Yo.then((function(){e[Wo]=e[qo],e._validating=!1})))}(i));let r=e.shadowRoot;if(r){let e=r.querySelector("style");e&&(e.__cssRules=i._styleAst,e.textContent=To(i._styleAst))}}}styleDocument(e){this.ensure(),this.styleSubtree(document.body,e)}}if(!window.ShadyCSS||!window.ShadyCSS.ScopingShim){const e=new ls;let t=window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface;window.ShadyCSS={prepareTemplate(t,i,r){e.flushCustomStyles(),e.prepareTemplate(t,i)},prepareTemplateStyles(e,t,i){window.ShadyCSS.prepareTemplate(e,t,i)},prepareTemplateDom(e,t){},styleSubtree(t,i){e.flushCustomStyles(),e.styleSubtree(t,i)},styleElement(t){e.flushCustomStyles(),e.styleElement(t)},styleDocument(t){e.flushCustomStyles(),e.styleDocument(t)},getComputedStyleValue:(e,t)=>Mo(e,t),flushCustomStyles(){e.flushCustomStyles()},nativeCss:po,nativeShadow:no,cssBuild:lo,disableRuntime:ho},t&&(window.ShadyCSS.CustomStyleInterface=t)}window.ShadyCSS.ApplyShim=as;const ds=window.ShadyDOM,cs=window.ShadyCSS;function hs(e,t){return et(e).getRootNode()===t}const ps="disable-upgrade",us=e=>{for(;e;){const t=Object.getOwnPropertyDescriptor(e,"observedAttributes");if(t)return t.get;e=Object.getPrototypeOf(e.prototype).constructor}return()=>[]},gs=(z((e=>{const t=oo(e);let i=us(t);return class extends t{constructor(){super(),this.__isUpgradeDisabled}static get observedAttributes(){return i.call(this).concat(ps)}_initializeProperties(){this.hasAttribute(ps)?this.__isUpgradeDisabled=!0:super._initializeProperties()}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(e){return super._canApplyPropertyDefault(e)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(e))}attributeChangedCallback(e,t,i,r){e==ps?this.__isUpgradeDisabled&&null==i&&(super._initializeProperties(),this.__isUpgradeDisabled=!1,et(this).isConnected&&super.connectedCallback()):super.attributeChangedCallback(e,t,i,r)}connectedCallback(){this.__isUpgradeDisabled||super.connectedCallback()}disconnectedCallback(){this.__isUpgradeDisabled||super.disconnectedCallback()}}})),"disable-upgrade");let ms=window.ShadyCSS;const fs=z((e=>{const t=pr(oo(e)),i=ro?t:Er(t),r=us(i),o={x:"pan-x",y:"pan-y",none:"none",all:"auto"};class s extends i{constructor(){super(),this.isAttached,this.__boundListeners,this._debouncers,this.__isUpgradeDisabled,this.__needsAttributesAtConnected,this._legacyForceObservedAttributes}static get importMeta(){return this.prototype.importMeta}created(){}__attributeReaction(e,t,i){(this.__dataAttributes&&this.__dataAttributes[e]||e===gs)&&this.attributeChangedCallback(e,t,i,null)}setAttribute(e,t){if(B&&!this._legacyForceObservedAttributes){const i=this.getAttribute(e);super.setAttribute(e,t),this.__attributeReaction(e,i,String(t))}else super.setAttribute(e,t)}removeAttribute(e){if(B&&!this._legacyForceObservedAttributes){const t=this.getAttribute(e);super.removeAttribute(e),this.__attributeReaction(e,t,null)}else super.removeAttribute(e)}static get observedAttributes(){return B&&!this.prototype._legacyForceObservedAttributes?(this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))||(this.__observedAttributes=[],ai(this.prototype)),this.__observedAttributes):r.call(this).concat(gs)}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(e){return super._canApplyPropertyDefault(e)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(e))}connectedCallback(){this.__needsAttributesAtConnected&&this._takeAttributes(),this.__isUpgradeDisabled||(super.connectedCallback(),this.isAttached=!0,this.attached())}attached(){}disconnectedCallback(){this.__isUpgradeDisabled||(super.disconnectedCallback(),this.isAttached=!1,this.detached())}detached(){}attributeChangedCallback(e,t,i,r){t!==i&&(e==gs?this.__isUpgradeDisabled&&null==i&&(this._initializeProperties(),this.__isUpgradeDisabled=!1,et(this).isConnected&&this.connectedCallback()):(super.attributeChangedCallback(e,t,i,r),this.attributeChanged(e,t,i)))}attributeChanged(e,t,i){}_initializeProperties(){if(R&&this.hasAttribute(gs))this.__isUpgradeDisabled=!0;else{let e=Object.getPrototypeOf(this);e.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",e))||(this._registered(),e.__hasRegisterFinished=!0),super._initializeProperties(),this.root=this,this.created(),B&&!this._legacyForceObservedAttributes&&(this.hasAttributes()?this._takeAttributes():this.parentNode||(this.__needsAttributesAtConnected=!0)),this._applyListeners()}}_takeAttributes(){const e=this.attributes;for(let t=0,i=e.length;t<i;t++){const i=e[t];this.__attributeReaction(i.name,null,i.value)}}_registered(){}ready(){this._ensureAttributes(),super.ready()}_ensureAttributes(){}_applyListeners(){}serialize(e){return this._serializeValue(e)}deserialize(e,t){return this._deserializeValue(e,t)}reflectPropertyToAttribute(e,t,i){this._propertyToAttribute(e,t,i)}serializeValueToAttribute(e,t,i){this._valueToNodeAttribute(i||this,e,t)}extend(e,t){if(!e||!t)return e||t;let i=Object.getOwnPropertyNames(t);for(let r,o=0;o<i.length&&(r=i[o]);o++){let i=Object.getOwnPropertyDescriptor(t,r);i&&Object.defineProperty(e,r,i)}return e}mixin(e,t){for(let i in t)e[i]=t[i];return e}chainObject(e,t){return e&&t&&e!==t&&(e.__proto__=t),e}instanceTemplate(e){let t=this.constructor._contentForTemplate(e);return document.importNode(t,!0)}fire(e,t,i){i=i||{},t=t??{};let r=new Event(e,{bubbles:void 0===i.bubbles||i.bubbles,cancelable:Boolean(i.cancelable),composed:void 0===i.composed||i.composed});r.detail=t;let o=i.node||this;return et(o).dispatchEvent(r),r}listen(e,t,i){e=e||this;let r=this.__boundListeners||(this.__boundListeners=new WeakMap),o=r.get(e);o||(o={},r.set(e,o));let s=t+i;o[s]||(o[s]=this._addMethodEventListenerToNode(e,t,i,this))}unlisten(e,t,i){e=e||this;let r=this.__boundListeners&&this.__boundListeners.get(e),o=t+i,s=r&&r[o];s&&(this._removeEventListenerFromNode(e,t,s),r[o]=null)}setScrollDirection(e,t){Ki(t||this,o[e]||"auto")}$$(e){return this.root.querySelector(e)}get domHost(){let e=et(this).getRootNode();return e instanceof DocumentFragment?e.host:e}distributeContent(){const e=Yr(this);window.ShadyDOM&&e.shadowRoot&&ShadyDOM.flush()}getEffectiveChildNodes(){return Yr(this).getEffectiveChildNodes()}queryDistributedElements(e){return Yr(this).queryDistributedElements(e)}getEffectiveChildren(){return this.getEffectiveChildNodes().filter((function(e){return e.nodeType===Node.ELEMENT_NODE}))}getEffectiveTextContent(){let e=this.getEffectiveChildNodes(),t=[];for(let i,r=0;i=e[r];r++)i.nodeType!==Node.COMMENT_NODE&&t.push(i.textContent);return t.join("")}queryEffectiveChildren(e){let t=this.queryDistributedElements(e);return t&&t[0]}queryAllEffectiveChildren(e){return this.queryDistributedElements(e)}getContentChildNodes(e){let t=this.root.querySelector(e||"slot");return t?Yr(t).getDistributedNodes():[]}getContentChildren(e){let t=this.getContentChildNodes(e).filter((function(e){return e.nodeType===Node.ELEMENT_NODE}));return t}isLightDescendant(e){const t=this;return t!==e&&et(t).contains(e)&&et(t).getRootNode()===et(e).getRootNode()}isLocalDescendant(e){return this.root===et(e).getRootNode()}scopeSubtree(e,t=!1){return function(e,t=!1){if(!ds||!cs)return null;if(!ds.handlesDynamicScoping)return null;const i=cs.ScopingShim;if(!i)return null;const r=i.scopeForNode(e),o=et(e).getRootNode(),s=e=>{if(!hs(e,o))return;const t=Array.from(ds.nativeMethods.querySelectorAll.call(e,"*"));t.push(e);for(let e=0;e<t.length;e++){const s=t[e];if(!hs(s,o))continue;const n=i.currentScopeForNode(s);n!==r&&(""!==n&&i.unscopeNode(s,n),i.scopeNode(s,r))}};if(s(e),t){const t=new MutationObserver((e=>{for(let t=0;t<e.length;t++){const i=e[t];for(let e=0;e<i.addedNodes.length;e++){const t=i.addedNodes[e];t.nodeType===Node.ELEMENT_NODE&&s(t)}}}));return t.observe(e,{childList:!0,subtree:!0}),t}return null}(e,t)}getComputedStyleValue(e){return ms.getComputedStyleValue(this,e)}debounce(e,t,i){return this._debouncers=this._debouncers||{},this._debouncers[e]=ui.debounce(this._debouncers[e],i>0?Xe.after(i):Ze,t.bind(this))}isDebouncerActive(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];return!(!t||!t.isActive())}flushDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.flush()}cancelDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.cancel()}async(e,t){return t>0?Xe.run(e.bind(this),t):~Ze.run(e.bind(this))}cancelAsync(e){e<0?Ze.cancel(~e):Xe.cancel(e)}create(e,t){let i=document.createElement(e);if(t)if(i.setProperties)i.setProperties(t);else for(let e in t)i[e]=t[e];return i}elementMatches(e,t){return zr(t||this,e)}toggleAttribute(e,t){let i=this;return 3===arguments.length&&(i=arguments[2]),1==arguments.length&&(t=!i.hasAttribute(e)),t?(et(i).setAttribute(e,""),!0):(et(i).removeAttribute(e),!1)}toggleClass(e,t,i){i=i||this,1==arguments.length&&(t=!i.classList.contains(e)),t?i.classList.add(e):i.classList.remove(e)}transform(e,t){(t=t||this).style.webkitTransform=e,t.style.transform=e}translate3d(e,t,i,r){r=r||this,this.transform("translate3d("+e+","+t+","+i+")",r)}arrayDelete(e,t){let i;if(Array.isArray(e)){if(i=e.indexOf(t),i>=0)return e.splice(i,1)}else if(i=Ee(this,e).indexOf(t),i>=0)return this.splice(e,i,1);return null}_logger(e,t){switch(Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),e){case"log":case"warn":case"error":console[e](...t)}}_log(...e){this._logger("log",e)}_warn(...e){this._logger("warn",e)}_error(...e){this._logger("error",e)}_logf(e,...t){return["[%s::%s]",this.is,e,...t]}}return s.prototype.is="",s})),vs=fs;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.LegacyElementMixin"),Polymer.LegacyElementMixin=vs;const bs={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,listeners:!0,hostAttributes:!0},ys={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,behaviors:!0,_noAccessors:!0},ws=Object.assign({listeners:!0,hostAttributes:!0,properties:!0,observers:!0},ys);function _s(e,t,i,r){!function(e,t,i){const r=e._noAccessors,o=Object.getOwnPropertyNames(e);for(let s=0;s<o.length;s++){let n=o[s];if(!(n in i))if(r)t[n]=e[n];else{let i=Object.getOwnPropertyDescriptor(e,n);i&&(i.configurable=!0,Object.defineProperty(t,n,i))}}}(t,e,r);for(let e in bs)t[e]&&(i[e]=i[e]||[],i[e].push(t[e]))}function xs(e,t,i){t=t||[];for(let r=e.length-1;r>=0;r--){let o=e[r];o?Array.isArray(o)?xs(o,t):t.indexOf(o)<0&&(!i||i.indexOf(o)<0)&&t.unshift(o):console.warn("behavior is null, check for missing or 404 import")}return t}function Cs(e,t){for(const i in t){const r=e[i],o=t[i];e[i]=!("value"in o)&&r&&"value"in r?Object.assign({value:r.value},o):o}}const Es=fs(HTMLElement);function Ss(e,t,i){let r;const o={};class s extends t{static _finalizeClass(){if(this.hasOwnProperty(JSCompiler_renameProperty("generatedFrom",this))){if(r)for(let e,t=0;t<r.length;t++)e=r[t],e.properties&&this.createProperties(e.properties),e.observers&&this.createObservers(e.observers,e.properties);e.properties&&this.createProperties(e.properties),e.observers&&this.createObservers(e.observers,e.properties),this._prepareTemplate()}else t._finalizeClass.call(this)}static get properties(){const t={};if(r)for(let e=0;e<r.length;e++)Cs(t,r[e].properties);return Cs(t,e.properties),t}static get observers(){let t=[];if(r)for(let e,i=0;i<r.length;i++)e=r[i],e.observers&&(t=t.concat(e.observers));return e.observers&&(t=t.concat(e.observers)),t}created(){super.created();const e=o.created;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}_registered(){const e=s.prototype;if(!e.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",e))){e.__hasRegisterFinished=!0,super._registered(),R&&n(e);const t=Object.getPrototypeOf(this);let i=o.beforeRegister;if(i)for(let e=0;e<i.length;e++)i[e].call(t);if(i=o.registered,i)for(let e=0;e<i.length;e++)i[e].call(t)}}_applyListeners(){super._applyListeners();const e=o.listeners;if(e)for(let t=0;t<e.length;t++){const i=e[t];if(i)for(let e in i)this._addMethodEventListenerToNode(this,e,i[e])}}_ensureAttributes(){const e=o.hostAttributes;if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];for(let e in i)this._ensureAttribute(e,i[e])}super._ensureAttributes()}ready(){super.ready();let e=o.ready;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}attached(){super.attached();let e=o.attached;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}detached(){super.detached();let e=o.detached;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}attributeChanged(e,t,i){super.attributeChanged();let r=o.attributeChanged;if(r)for(let o=0;o<r.length;o++)r[o].call(this,e,t,i)}}if(i){Array.isArray(i)||(i=[i]);let e=t.prototype.behaviors;r=xs(i,null,e),s.prototype.behaviors=e?e.concat(i):r}const n=t=>{r&&function(e,t,i){for(let r=0;r<t.length;r++)_s(e,t[r],i,ws)}(t,r,o),_s(t,e,o,ys)};return R||n(s.prototype),s.generatedFrom=e,s}const $s=function(e,t){e||console.warn("Polymer.Class requires `info` argument");let i=t?t(Es):Es;return i=Ss(e,i,e.behaviors),i.is=i.prototype.is=e.is,i};goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.Class");const ks=$s;Polymer.Class=ks,Polymer.mixinBehaviors=function(e,t){return Ss({},fs(t),e)};const As=function(e){let t;return t="function"==typeof e?e:As.Class(e),e._legacyForceObservedAttributes&&(t.prototype._legacyForceObservedAttributes=e._legacyForceObservedAttributes),customElements.define(t.is,t),t};As.Class=$s,goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.PolymerFn"),Polymer._polymerFn=As;const Rs=window.onLegacyPolymerFunctionDefinedCallback;function Ts(e,t,i,r,o){let s;o&&(s="object"==typeof i&&null!==i,s&&(r=e.__dataTemp[t]));let n=r!==i&&(r==r||i==i);return s&&n&&(e.__dataTemp[t]=i),n}Rs&&Rs();const Is=z((e=>class extends e{_shouldPropertyChange(e,t,i){return Ts(this,e,t,i,!0)}})),Ps=z((e=>class extends e{static get properties(){return{mutableData:Boolean}}_shouldPropertyChange(e,t,i){return Ts(this,e,t,i,this.mutableData)}}));Is._mutablePropertyChange=Ts;const Ns=Ps,Os=Is;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Mixins.MutableData"),Polymer.MutableData=Os,Polymer.OptionalMutableData=Ns;let Ds=null;function Ls(){return Ds}Ls.prototype=Object.create(HTMLTemplateElement.prototype,{constructor:{value:Ls,writable:!0}});const Ms=ei(Ls),Fs=Is(Ms),Us=ei(class{});function Bs(e,t){for(let i=0;i<t.length;i++){let r=t[i];if(Boolean(e)!=Boolean(r.__hideTemplateChildren__))if(r.nodeType===Node.TEXT_NODE)e?(r.__polymerTextContent__=r.textContent,r.textContent=""):r.textContent=r.__polymerTextContent__;else if("slot"===r.localName)if(e)r.__polymerReplaced__=document.createComment("hidden-slot"),et(et(r).parentNode).replaceChild(r.__polymerReplaced__,r);else{const e=r.__polymerReplaced__;e&&et(et(e).parentNode).replaceChild(r,e)}else r.style&&(e?(r.__polymerDisplay__=r.style.display,r.style.display="none"):r.style.display=r.__polymerDisplay__);r.__hideTemplateChildren__=e,r._showHideChildren&&r._showHideChildren(e)}}let Hs=class extends Us{constructor(e){super(),this._configureProperties(e),this.root=this._stampTemplate(this.__dataHost);let t=[];this.children=t;for(let e=this.root.firstChild;e;e=e.nextSibling)t.push(e),e.__templatizeInstance=this;this.__templatizeOwner&&this.__templatizeOwner.__hideTemplateChildren__&&this._showHideChildren(!0);let i=this.__templatizeOptions;(e&&i.instanceProps||!i.instanceProps)&&this._enableProperties()}_configureProperties(e){if(this.__templatizeOptions.forwardHostProp)for(let e in this.__hostProps)this._setPendingProperty(e,this.__dataHost["_host_"+e]);for(let t in e)this._setPendingProperty(t,e[t])}forwardHostProp(e,t){this._setPendingPropertyOrPath(e,t,!1,!0)&&this.__dataHost._enqueueClient(this)}_addEventListenerToNode(e,t,i){if(this._methodHost&&this.__templatizeOptions.parentModel)this._methodHost._addEventListenerToNode(e,t,(e=>{e.model=this,i(e)}));else{let r=this.__dataHost.__dataHost;r&&r._addEventListenerToNode(e,t,i)}}_showHideChildren(e){Bs(e,this.children)}_setUnmanagedPropertyToNode(e,t,i){e.__hideTemplateChildren__&&e.nodeType==Node.TEXT_NODE&&"textContent"==t?e.__polymerTextContent__=i:super._setUnmanagedPropertyToNode(e,t,i)}get parentModel(){let e=this.__parentModel;if(!e){let t;e=this;do{e=e.__dataHost.__dataHost}while((t=e.__templatizeOptions)&&!t.parentModel);this.__parentModel=e}return e}dispatchEvent(e){return!0}};Hs.prototype.__dataHost,Hs.prototype.__templatizeOptions,Hs.prototype._methodHost,Hs.prototype.__templatizeOwner,Hs.prototype.__hostProps;const js=Is(Hs);function Gs(e){let t=e.__dataHost;return t&&t._methodHost||t}function zs(e,t){return function(e,i,r){t.call(e.__templatizeOwner,i.substring(6),r[i])}}function Vs(e,t){return function(e,i,r){t.call(e.__templatizeOwner,e,i,r[i])}}function Ws(e,t,i){if(S&&!Gs(e))throw new Error("strictTemplatePolicy: template owner not trusted");if(i=i||{},e.__templatizeOwner)throw new Error("A <template> can only be templatized once");e.__templatizeOwner=t;let r=(t?t.constructor:Hs)._parseTemplate(e),o=r.templatizeInstanceClass;o||(o=function(e,t,i){let r=i.mutableData?js:Hs;Ws.mixin&&(r=Ws.mixin(r));let o=class extends r{};return o.prototype.__templatizeOptions=i,o.prototype._bindTemplate(e),function(e,t,i,r){let o=i.hostProps||{};for(let t in r.instanceProps){delete o[t];let i=r.notifyInstanceProp;i&&e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:Vs(0,i)})}if(r.forwardHostProp&&t.__dataHost)for(let t in o)i.hasHostProps||(i.hasHostProps=!0),e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:function(e,t,i){e.__dataHost._setPendingPropertyOrPath("_host_"+t,i[t],!0,!0)}})}(o,e,t,i),o}(e,r,i),r.templatizeInstanceClass=o);const s=Gs(e);!function(e,t,i,r){let o=i.forwardHostProp;if(o&&t.hasHostProps){const s="template"==e.localName;let n=t.templatizeTemplateClass;if(!n){if(s){let e=i.mutableData?Fs:Ms;class r extends e{}n=t.templatizeTemplateClass=r}else{const i=e.constructor;class r extends i{}n=t.templatizeTemplateClass=r}let a=t.hostProps;for(let e in a)n.prototype._addPropertyEffect("_host_"+e,n.prototype.PROPERTY_EFFECT_TYPES.PROPAGATE,{fn:zs(0,o)}),n.prototype._createNotifyingProperty("_host_"+e);I&&r&&function(e,t,i){const r=i.constructor._properties,{propertyEffects:o}=e,{instanceProps:s}=t;for(let e in o)if(!(r[e]||s&&s[e])){const t=o[e];for(let i=0;i<t.length;i++){const{part:r}=t[i].info;if(!r.signature||!r.signature.static){console.warn(`Property '${e}' used in template but not declared in 'properties'; attribute will not be observed.`);break}}}}(t,i,r)}if(e.__dataProto&&Object.assign(e.__data,e.__dataProto),s)!function(e,t){Ds=e,Object.setPrototypeOf(e,t.prototype),new t,Ds=null}(e,n),e.__dataTemp={},e.__dataPending=null,e.__dataOld=null,e._enableProperties();else{Object.setPrototypeOf(e,n.prototype);const i=t.hostProps;for(let t in i)if(t="_host_"+t,t in e){const i=e[t];delete e[t],e.__data[t]=i}}}}(e,r,i,s);let n=class extends o{};return n.prototype._methodHost=s,n.prototype.__dataHost=e,n.prototype.__templatizeOwner=t,n.prototype.__hostProps=r.hostProps,n}function qs(e,t){let i;for(;t;)if(i=t.__dataHost?t:t.__templatizeInstance){if(i.__dataHost==e)return i;t=i.__dataHost}else t=et(t).parentNode;return null}const Ks=Ws,Ys=qs,Xs=Hs;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.Templatize"),Polymer.Templatize={templatize:Ks,modelForElement:Ys},Polymer.TemplateInstanceBase=Xs;const Js={templatize(e,t){this._templatizerTemplate=e,this.ctor=Ws(e,this,{mutableData:Boolean(t),parentModel:this._parentModel,instanceProps:this._instanceProps,forwardHostProp:this._forwardHostPropV2,notifyInstanceProp:this._notifyInstancePropV2})},stamp(e){return new this.ctor(e)},modelForElement(e){return qs(this._templatizerTemplate,e)}};goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.TemplatizerBehavior"),Polymer.Templatizer=Js;let Qs=!1;function Zs(){if(R&&!m){if(!Qs){Qs=!0;const e=document.createElement("style");e.textContent="dom-bind,dom-if,dom-repeat{display:none;}",document.head.appendChild(e)}return!0}return!1}const en=pr(Ps(ei(HTMLElement)));class tn extends en{static get observedAttributes(){return["mutable-data"]}constructor(){if(super(),S)throw new Error("strictTemplatePolicy: dom-bind not allowed");this.root=null,this.$=null,this.__children=null}attributeChangedCallback(e,t,i,r){this.mutableData=!0}connectedCallback(){Zs()||(this.style.display="none"),this.render()}disconnectedCallback(){this.__removeChildren()}__insertChildren(){et(et(this).parentNode).insertBefore(this.root,this)}__removeChildren(){if(this.__children)for(let e=0;e<this.__children.length;e++)this.root.appendChild(this.__children[e])}render(){let e;if(!this.__children){if(e=e||this.querySelector("template"),!e){let t=new MutationObserver((()=>{if(e=this.querySelector("template"),!e)throw new Error("dom-bind requires a <template> child");t.disconnect(),this.render()}));return void t.observe(this,{childList:!0})}this.root=this._stampTemplate(e),this.$=this.root.$,this.__children=[];for(let e=this.root.firstChild;e;e=e.nextSibling)this.__children[this.__children.length]=e;this._enableProperties()}this.__insertChildren(),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}}customElements.define("dom-bind",tn),goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.DomBind"),Polymer.DomBind=tn;const rn=window.trustedTypes&&trustedTypes.createPolicy("polymer-html-literal",{createHTML:e=>e});class on{constructor(e,t){an(e,t);const i=t.reduce(((t,i,r)=>t+sn(i)+e[r+1]),e[0]);this.value=i.toString()}toString(){return this.value}}function sn(e){if(e instanceof on)return e.value;throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${e}`)}const nn=function(e,...t){an(e,t);const i=document.createElement("template");let r=t.reduce(((t,i,r)=>t+function(e){if(e instanceof HTMLTemplateElement)return e.innerHTML;if(e instanceof on)return sn(e);throw new Error(`non-template value passed to Polymer's html function: ${e}`)}(i)+e[r+1]),e[0]);return rn&&(r=rn.createHTML(r)),i.innerHTML=r,i},an=(e,t)=>{if(!Array.isArray(e)||!Array.isArray(e.raw)||t.length!==e.length-1)throw new TypeError("Invalid call to the html template tag")},ln=nn;goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Utils.HtmlTag"),Polymer.html=ln,Polymer.htmlLiteral=function(e,...t){return new on(e,t)};const dn=oo(HTMLElement);goog.declareModuleId("HtmlImportsNamespace.Polymer.PolymerElement");const cn=dn;Polymer.Element=cn;const hn=Ps(dn);class pn extends hn{static get is(){return"dom-repeat"}static get template(){return null}static get properties(){return{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},itemsIndexAs:{type:String,value:"itemsIndex"},sort:{type:Function,observer:"__sortChanged"},filter:{type:Function,observer:"__filterChanged"},observe:{type:String,observer:"__observeChanged"},delay:Number,renderedItemCount:{type:Number,notify:!U,readOnly:!0},initialCount:{type:Number},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:"__computeFrameTime(targetFramerate)"},notifyDomChange:{type:Boolean},reuseChunkedInstances:{type:Boolean}}}static get observers(){return["__itemsChanged(items.*)"]}constructor(){super(),this.__instances=[],this.__renderDebouncer=null,this.__itemsIdxToInstIdx={},this.__chunkCount=null,this.__renderStartTime=null,this.__itemsArrayChanged=!1,this.__shouldMeasureChunk=!1,this.__shouldContinueChunking=!1,this.__chunkingId=0,this.__sortFn=null,this.__filterFn=null,this.__observePaths=null,this.__ctor=null,this.__isDetached=!0,this.template=null,this._templateInfo}disconnectedCallback(){super.disconnectedCallback(),this.__isDetached=!0;for(let e=0;e<this.__instances.length;e++)this.__detachInstance(e);this.__chunkingId&&cancelAnimationFrame(this.__chunkingId)}connectedCallback(){if(super.connectedCallback(),Zs()||(this.style.display="none"),this.__isDetached){this.__isDetached=!1;let e=et(et(this).parentNode);for(let t=0;t<this.__instances.length;t++)this.__attachInstance(t,e);this.__chunkingId&&this.__render()}}__ensureTemplatized(){if(!this.__ctor){const e=this;let t=this.template=e._templateInfo?e:this.querySelector("template");if(!t){let e=new MutationObserver((()=>{if(!this.querySelector("template"))throw new Error("dom-repeat requires a <template> child");e.disconnect(),this.__render()}));return e.observe(this,{childList:!0}),!1}let i={};i[this.as]=!0,i[this.indexAs]=!0,i[this.itemsIndexAs]=!0,this.__ctor=Ws(t,this,{mutableData:this.mutableData,parentModel:!0,instanceProps:i,forwardHostProp:function(e,t){let i=this.__instances;for(let r,o=0;o<i.length&&(r=i[o]);o++)r.forwardHostProp(e,t)},notifyInstanceProp:function(e,t,i){if(_e(this.as,t)){let r=e[this.itemsIndexAs];t==this.as&&(this.items[r]=i);let o=we(this.as,`${JSCompiler_renameProperty("items",this)}.${r}`,t);this.notifyPath(o,i)}}})}return!0}__getMethodHost(){return this.__dataHost._methodHost||this.__dataHost}__functionFromPropertyValue(e){if("string"==typeof e){let t=e,i=this.__getMethodHost();return function(){return i[t].apply(i,arguments)}}return e}__sortChanged(e){this.__sortFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__filterChanged(e){this.__filterFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__computeFrameTime(e){return Math.ceil(1e3/e)}__observeChanged(){this.__observePaths=this.observe&&this.observe.replace(".*",".").split(" ")}__handleObservedPaths(e){if(this.__sortFn||this.__filterFn)if(e){if(this.__observePaths){let t=this.__observePaths;for(let i=0;i<t.length;i++)0===e.indexOf(t[i])&&this.__debounceRender(this.__render,this.delay)}}else this.__debounceRender(this.__render,this.delay)}__itemsChanged(e){this.items&&!Array.isArray(this.items)&&console.warn("dom-repeat expected array for `items`, found",this.items),this.__handleItemPath(e.path,e.value)||("items"===e.path&&(this.__itemsArrayChanged=!0),this.__debounceRender(this.__render))}__debounceRender(e,t=0){this.__renderDebouncer=ui.debounce(this.__renderDebouncer,t>0?Xe.after(t):Ze,e.bind(this)),mi(this.__renderDebouncer)}render(){this.__debounceRender(this.__render),Ur()}__render(){if(!this.__ensureTemplatized())return;let e=this.items||[];const t=this.__sortAndFilterItems(e),i=this.__calculateLimit(t.length);this.__updateInstances(e,i,t),this.initialCount&&(this.__shouldMeasureChunk||this.__shouldContinueChunking)&&(cancelAnimationFrame(this.__chunkingId),this.__chunkingId=requestAnimationFrame((()=>{this.__chunkingId=null,this.__continueChunking()}))),this._setRenderedItemCount(this.__instances.length),U&&!this.notifyDomChange||this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}__sortAndFilterItems(e){let t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=i;return this.__filterFn&&(t=t.filter(((t,i,r)=>this.__filterFn(e[t],i,r)))),this.__sortFn&&t.sort(((t,i)=>this.__sortFn(e[t],e[i]))),t}__calculateLimit(e){let t=e;const i=this.__instances.length;if(this.initialCount){let r;!this.__chunkCount||this.__itemsArrayChanged&&!this.reuseChunkedInstances?(t=Math.min(e,this.initialCount),r=Math.max(t-i,0),this.__chunkCount=r||1):(r=Math.min(Math.max(e-i,0),this.__chunkCount),t=Math.min(i+r,e)),this.__shouldMeasureChunk=r===this.__chunkCount,this.__shouldContinueChunking=t<e,this.__renderStartTime=performance.now()}return this.__itemsArrayChanged=!1,t}__continueChunking(){if(this.__shouldMeasureChunk){const e=performance.now()-this.__renderStartTime,t=this._targetFrameTime/e;this.__chunkCount=Math.round(this.__chunkCount*t)||1}this.__shouldContinueChunking&&this.__debounceRender(this.__render)}__updateInstances(e,t,i){const r=this.__itemsIdxToInstIdx={};let o;for(o=0;o<t;o++){let t=this.__instances[o],s=i[o],n=e[s];r[s]=o,t?(t._setPendingProperty(this.as,n),t._setPendingProperty(this.indexAs,o),t._setPendingProperty(this.itemsIndexAs,s),t._flushProperties()):this.__insertInstance(n,o,s)}for(let e=this.__instances.length-1;e>=o;e--)this.__detachAndRemoveInstance(e)}__detachInstance(e){let t=this.__instances[e];const i=et(t.root);for(let e=0;e<t.children.length;e++){let r=t.children[e];i.appendChild(r)}return t}__attachInstance(e,t){let i=this.__instances[e];t.insertBefore(i.root,this)}__detachAndRemoveInstance(e){this.__detachInstance(e),this.__instances.splice(e,1)}__stampInstance(e,t,i){let r={};return r[this.as]=e,r[this.indexAs]=t,r[this.itemsIndexAs]=i,new this.__ctor(r)}__insertInstance(e,t,i){const r=this.__stampInstance(e,t,i);let o=this.__instances[t+1],s=o?o.children[0]:this;return et(et(this).parentNode).insertBefore(r.root,s),this.__instances[t]=r,r}_showHideChildren(e){for(let t=0;t<this.__instances.length;t++)this.__instances[t]._showHideChildren(e)}__handleItemPath(e,t){let i=e.slice(6),r=i.indexOf("."),o=r<0?i:i.substring(0,r);if(o==parseInt(o,10)){let e=r<0?"":i.substring(r+1);this.__handleObservedPaths(e);let s=this.__itemsIdxToInstIdx[o],n=this.__instances[s];if(n){let i=this.as+(e?"."+e:"");n._setPendingPropertyOrPath(i,t,!1,!0),n._flushProperties()}return!0}}itemForElement(e){let t=this.modelForElement(e);return t&&t[this.as]}indexForElement(e){let t=this.modelForElement(e);return t&&t[this.indexAs]}modelForElement(e){return qs(this.template,e)}}customElements.define(pn.is,pn),goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.DomRepeat"),Polymer.DomRepeat=pn;class un extends dn{static get is(){return"dom-if"}static get template(){return null}static get properties(){return{if:{type:Boolean,observer:"__debounceRender"},restamp:{type:Boolean,observer:"__debounceRender"},notifyDomChange:{type:Boolean}}}constructor(){super(),this.__renderDebouncer=null,this._lastIf=!1,this.__hideTemplateChildren__=!1,this.__template,this._templateInfo}__debounceRender(){this.__renderDebouncer=ui.debounce(this.__renderDebouncer,Ze,(()=>this.__render())),mi(this.__renderDebouncer)}disconnectedCallback(){super.disconnectedCallback();const e=et(this).parentNode;e&&(e.nodeType!=Node.DOCUMENT_FRAGMENT_NODE||et(e).host)||this.__teardownInstance()}connectedCallback(){super.connectedCallback(),Zs()||(this.style.display="none"),this.if&&this.__debounceRender()}__ensureTemplate(){if(!this.__template){const e=this;let t=e._templateInfo?e:et(e).querySelector("template");if(!t){let e=new MutationObserver((()=>{if(!et(this).querySelector("template"))throw new Error("dom-if requires a <template> child");e.disconnect(),this.__render()}));return e.observe(this,{childList:!0}),!1}this.__template=t}return!0}__ensureInstance(){let e=et(this).parentNode;if(this.__hasInstance()){let t=this.__getInstanceNodes();if(t&&t.length&&et(this).previousSibling!==t[t.length-1])for(let i,r=0;r<t.length&&(i=t[r]);r++)et(e).insertBefore(i,this)}else{if(!e)return!1;if(!this.__ensureTemplate())return!1;this.__createAndInsertInstance(e)}return!0}render(){Ur()}__render(){if(this.if){if(!this.__ensureInstance())return}else this.restamp&&this.__teardownInstance();this._showHideChildren(),U&&!this.notifyDomChange||this.if==this._lastIf||(this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this._lastIf=this.if)}__hasInstance(){}__getInstanceNodes(){}__createAndInsertInstance(e){}__teardownInstance(){}_showHideChildren(){}}const gn=F?class extends un{constructor(){super(),this.__instance=null,this.__syncInfo=null}__hasInstance(){return Boolean(this.__instance)}__getInstanceNodes(){return this.__instance.templateInfo.childNodes}__createAndInsertInstance(e){const t=this.__dataHost||this;if(S&&!this.__dataHost)throw new Error("strictTemplatePolicy: template owner not trusted");const i=t._bindTemplate(this.__template,!0);i.runEffects=(e,t,i)=>{let r=this.__syncInfo;if(this.if)r&&(this.__syncInfo=null,this._showHideChildren(),t=Object.assign(r.changedProps,t)),e(t,i);else if(this.__instance)if(r||(r=this.__syncInfo={runEffects:e,changedProps:{}}),i)for(const e in t){const t=ve(e);r.changedProps[t]=this.__dataHost[t]}else Object.assign(r.changedProps,t)},this.__instance=t._stampTemplate(this.__template,i),et(e).insertBefore(this.__instance,this)}__syncHostProperties(){const e=this.__syncInfo;e&&(this.__syncInfo=null,e.runEffects(e.changedProps,!1))}__teardownInstance(){const e=this.__dataHost||this;this.__instance&&(e._removeBoundDom(this.__instance),this.__instance=null,this.__syncInfo=null)}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&Boolean(this.__instance.__hidden)!==e&&(this.__instance.__hidden=e,Bs(e,this.__instance.templateInfo.childNodes)),e||this.__syncHostProperties()}}:class extends un{constructor(){super(),this.__ctor=null,this.__instance=null,this.__invalidProps=null}__hasInstance(){return Boolean(this.__instance)}__getInstanceNodes(){return this.__instance.children}__createAndInsertInstance(e){this.__ctor||(this.__ctor=Ws(this.__template,this,{mutableData:!0,forwardHostProp:function(e,t){this.__instance&&(this.if?this.__instance.forwardHostProp(e,t):(this.__invalidProps=this.__invalidProps||Object.create(null),this.__invalidProps[ve(e)]=!0))}})),this.__instance=new this.__ctor,et(e).insertBefore(this.__instance.root,this)}__teardownInstance(){if(this.__instance){let e=this.__instance.children;if(e&&e.length){let t=et(e[0]).parentNode;if(t){t=et(t);for(let i,r=0;r<e.length&&(i=e[r]);r++)t.removeChild(i)}}this.__invalidProps=null,this.__instance=null}}__syncHostProperties(){let e=this.__invalidProps;if(e){this.__invalidProps=null;for(let t in e)this.__instance._setPendingProperty(t,this.__dataHost[t]);this.__instance._flushProperties()}}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&Boolean(this.__instance.__hidden)!==e&&(this.__instance.__hidden=e,this.__instance._showHideChildren(e)),e||this.__syncHostProperties()}};customElements.define(gn.is,gn),goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.DomIf"),Polymer.DomIf=gn;let mn=z((e=>{let t=oo(e);return class extends t{static get properties(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}static get observers(){return["__updateSelection(multi, items.*)"]}constructor(){super(),this.__lastItems=null,this.__lastMulti=null,this.__selectedMap=null}__updateSelection(e,t){let i=t.path;if(i==JSCompiler_renameProperty("items",this)){let i=t.base||[],r=this.__lastItems;if(e!==this.__lastMulti&&this.clearSelection(),r){let e=Or(i,r);this.__applySplices(e)}this.__lastItems=i,this.__lastMulti=e}else if(t.path==`${JSCompiler_renameProperty("items",this)}.splices`)this.__applySplices(t.value.indexSplices);else{let e=i.slice(`${JSCompiler_renameProperty("items",this)}.`.length),t=parseInt(e,10);e.indexOf(".")<0&&e==t&&this.__deselectChangedIdx(t)}}__applySplices(e){let t=this.__selectedMap;for(let i=0;i<e.length;i++){let r=e[i];t.forEach(((e,i)=>{e<r.index||(e>=r.index+r.removed.length?t.set(i,e+r.addedCount-r.removed.length):t.set(i,-1))}));for(let e=0;e<r.addedCount;e++){let i=r.index+e;t.has(this.items[i])&&t.set(this.items[i],i)}}this.__updateLinks();let i=0;t.forEach(((e,r)=>{e<0?(this.multi?this.splice(JSCompiler_renameProperty("selected",this),i,1):this.selected=this.selectedItem=null,t.delete(r)):i++}))}__updateLinks(){if(this.__dataLinkedPaths={},this.multi){let e=0;this.__selectedMap.forEach((t=>{t>=0&&this.linkPaths(`${JSCompiler_renameProperty("items",this)}.${t}`,`${JSCompiler_renameProperty("selected",this)}.${e++}`)}))}else this.__selectedMap.forEach((e=>{this.linkPaths(JSCompiler_renameProperty("selected",this),`${JSCompiler_renameProperty("items",this)}.${e}`),this.linkPaths(JSCompiler_renameProperty("selectedItem",this),`${JSCompiler_renameProperty("items",this)}.${e}`)}))}clearSelection(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}isSelected(e){return this.__selectedMap.has(e)}isIndexSelected(e){return this.isSelected(this.items[e])}__deselectChangedIdx(e){let t=this.__selectedIndexForItemIndex(e);if(t>=0){let e=0;this.__selectedMap.forEach(((i,r)=>{t==e++&&this.deselect(r)}))}}__selectedIndexForItemIndex(e){let t=this.__dataLinkedPaths[`${JSCompiler_renameProperty("items",this)}.${e}`];if(t)return parseInt(t.slice(`${JSCompiler_renameProperty("selected",this)}.`.length),10)}deselect(e){let t=this.__selectedMap.get(e);if(t>=0){let i;this.__selectedMap.delete(e),this.multi&&(i=this.__selectedIndexForItemIndex(t)),this.__updateLinks(),this.multi?this.splice(JSCompiler_renameProperty("selected",this),i,1):this.selected=this.selectedItem=null}}deselectIndex(e){this.deselect(this.items[e])}select(e){this.selectIndex(this.items.indexOf(e))}selectIndex(e){let t=this.items[e];this.isSelected(t)?this.toggle&&this.deselectIndex(e):(this.multi||this.__selectedMap.clear(),this.__selectedMap.set(t,e),this.__updateLinks(),this.multi?this.push(JSCompiler_renameProperty("selected",this),t):this.selected=this.selectedItem=t)}}})),fn=mn(dn);class vn extends fn{static get is(){return"array-selector"}static get template(){return null}}customElements.define(vn.is,vn),goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.ArraySelector"),Polymer.ArraySelectorMixin=mn,Polymer.ArraySelector=vn;const bn=new ns;window.ShadyCSS||(window.ShadyCSS={prepareTemplate(e,t,i){},prepareTemplateDom(e,t){},prepareTemplateStyles(e,t,i){},styleSubtree(e,t){bn.processStyles(),Lo(e,t)},styleElement(e){bn.processStyles()},styleDocument(e){bn.processStyles(),Lo(document.body,e)},getComputedStyleValue:(e,t)=>Mo(e,t),flushCustomStyles(){},nativeCss:po,nativeShadow:no,cssBuild:lo,disableRuntime:ho}),window.ShadyCSS.CustomStyleInterface=bn;const yn="include",wn=window.ShadyCSS.CustomStyleInterface;class _n extends HTMLElement{constructor(){super(),this._style=null,wn.addCustomStyle(this)}getStyle(){if(this._style)return this._style;const e=this.querySelector("style");if(!e)return null;this._style=e;const t=e.getAttribute(yn);return t&&(e.removeAttribute(yn),e.textContent=se(t)+e.textContent),this.ownerDocument!==window.document&&window.document.head.appendChild(this),this._style}}let xn;window.customElements.define("custom-style",_n),goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Elements.CustomStyle"),Polymer.CustomStyle=_n,xn=Is._mutablePropertyChange;const Cn={_shouldPropertyChange(e,t,i){return xn(this,e,t,i,!0)}},En={properties:{mutableData:Boolean},_shouldPropertyChange(e,t,i){return xn(this,e,t,i,this.mutableData)}};goog.declareModuleId("HtmlImportsNamespace.Polymer.Lib.Legacy.MutableDataBehavior"),Polymer.MutableDataBehavior=Cn,Polymer.OptionalMutableDataBehavior=En;const Sn=fs(HTMLElement).prototype;goog.declareModuleId("HtmlImportsNamespace.Polymer.Polymer");const $n=Sn;function kn(e){return"shadowRoot"in e}function An(e){return!!e&&"nodeType"in e&&1===e.nodeType}function Rn(){const e=new Error;console.info(`Calling window.location.reload(): ${e.stack}`),window.location.reload()}function Tn(e){if(!e)return"";let t=e.composedPath();if(!t||!t.length){t=[];let i=e.target;for(;i;)t.push(i),i=i.parentNode||i.host}return t.reduce(((e,t)=>{const i=function(e){let t="",i="",r="";if(e instanceof Element&&(t=e.tagName,i=e.id,r=e.className),!t||"GR-APP"===t||e instanceof DocumentFragment||e instanceof HTMLSlotElement)return"";let o="";return t&&(o+=t.toLowerCase()),i&&(o+=`#${i}`),r&&(o+=`.${r.replace(/ /g,".")}`),o}(t);return i?e?`${i}>${e}`:i:e}),"")}function In(e,t,i){return void 0!==Pn(e,t,i)}function Pn(e,t,i){for(;e&&(!i||e!==i);){if(e.classList.contains(t))return e;e=e.parentElement??void 0}}function Nn(e="",t="generated_"){return`${t}${e.replace(/[^a-zA-Z0-9-_]/g,"_")}`}function On(e,t){return null===e||t&&e.activeElement&&e.activeElement.nodeName.toUpperCase().includes("DIALOG")?null:e.activeElement?.shadowRoot?.activeElement?On(e.activeElement.shadowRoot):e.activeElement?"BODY"===e.activeElement.nodeName.toUpperCase()?null:e.activeElement:null}function Dn(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||/iPad|iPhone|iPod/.test(navigator.userAgent)}function Ln(e,t,i=0){const r=new IntersectionObserver((e=>{for(const i of e)if(i.isIntersecting)return r.unobserve(i.target),void t()}),{rootMargin:`${i}px`});r.observe(e)}var Mn,Fn,Un;Polymer.Base=$n,function(e){e.ENTER="Enter",e.ESC="Escape",e.TAB="Tab",e.SPACE=" ",e.LEFT="ArrowLeft",e.RIGHT="ArrowRight",e.UP="ArrowUp",e.DOWN="ArrowDown"}(Mn||(Mn={})),function(e){e[e.ALT_KEY=0]="ALT_KEY",e[e.CTRL_KEY=1]="CTRL_KEY",e[e.META_KEY=2]="META_KEY",e[e.SHIFT_KEY=3]="SHIFT_KEY"}(Fn||(Fn={})),function(e){e.G="g",e.V="v"}(Un||(Un={}));const Bn=new RegExp(/^[A-Za-z0-9]$/);function Hn(e,t){if(e.key!==t.key)return!1;const i=t.modifiers??[];return e.ctrlKey===i.includes(Fn.CTRL_KEY)&&e.metaKey===i.includes(Fn.META_KEY)&&(r=e.key,!((Bn.test(r)||Object.values(Mn).includes(r))&&e.altKey!==i.includes(Fn.ALT_KEY)||function(e){return Object.values(Mn).includes(e)}(e.key)&&e.shiftKey!==i.includes(Fn.SHIFT_KEY)));var r}function jn(e,t,i,r){const o=r?.shouldSuppress??!1,s=r?.preventDefault??!0,n=e=>{e.repeat&&!t.allowRepeat||o&&zn(e)||Hn(e,t)&&(s&&e.preventDefault(),s&&e.stopPropagation(),i(e))};return e.addEventListener("keydown",n),()=>e.removeEventListener("keydown",n)}function Gn(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey}function zn(e){const t=e.composedPath()[0];if(!An(t))return!1;const i=t.tagName,r=t.getAttribute("type");if(t.isContentEditable||"INPUT"===i&&"checkbox"!==r||"TEXTAREA"===i||"GR-TEXTAREA"===i||"Enter"===e.key&&("A"===i||"BUTTON"===i||"GR-BUTTON"===i||"PAPER-TAB"===i))return!0;const o=e.composedPath()??[];for(const e of o)if(An(e)&&"DIALOG"===e.tagName)return!0;return!1}function Vn(e){return new Promise((t=>{Wn(e,t)}))}function Wn(e,t){if(e.clientHeight>0)return void t();const i=new ResizeObserver((()=>{e.clientHeight>0&&(t(),i.unobserve(e))}));i.observe(e)}function qn(e,t){if(e?.getSelection)return e.getSelection();if(Dn()){const i=window.getSelection();if(i.getComposedRanges){const t=i.getComposedRanges(e)[0],r=new Range;return t&&(r.setStart(t.startContainer,t.startOffset),r.setEnd(t.endContainer,t.endOffset)),r}return t}return document.getSelection()}let Kn;function Yn(e){Kn?.finalize(),Kn=e}function Xn(){if(!Kn)throw new Error("App context has not been injected");return Kn}function Jn(e,t,i){e&&e.dispatchEvent(new CustomEvent(t,{detail:i,composed:!0,bubbles:!0}))}function Qn(e,t,i){e.dispatchEvent(new CustomEvent(t,{detail:i,composed:!0,bubbles:!1}))}function Zn(e,t,i){e.dispatchEvent(new CustomEvent(t,{detail:i,composed:!1,bubbles:!1}))}function ea(e,t){Jn(e,"show-alert",{message:t,showDismiss:!0})}function ta(e,t){Jn(e,"show-error",{message:t})}function ia(e){null===e&&(e=void 0),Jn(document,"page-error",{response:e})}function ra(e,t){Jn(document,"server-error",{response:e,request:t})}function oa(e){Jn(document,"title-change",{title:e})}function sa(e,t){Jn(e,"iron-announce",{text:t})}function na(e,t,i,r){Jn(e,"show-tab",{tab:t,scrollIntoView:i,tabState:r})}function aa(e){Jn(e,"reload",{})}class la{constructor(e,t,i,r){this.plugin=e,this.action=t,this.change=i,this.revision=r,this.popups=[],this.reporting=Xn().reportingService}popup(e){this.plugin.popup().then((t=>{const i=t._getElement();if(!i)throw new Error("Popup element not found");i.appendChild(e),this.popups.push(t)}))}hide(){for(const e of this.popups)e.close();this.popups.splice(0)}refresh(){Rn()}textfield(){return document.createElement("md-outlined-text-field")}br(){return document.createElement("br")}msg(e){const t=document.createElement("gr-label");return t.appendChild(document.createTextNode(e)),t}div(...e){const t=document.createElement("div");for(const i of e)t.appendChild(i);return t}button(e,t){const i=t&&t.onclick,r=document.createElement("gr-button");return r.appendChild(document.createTextNode(e)),i&&this.plugin.eventHelper(r).onTap(i),r}checkbox(){const e=document.createElement("input");return e.type="checkbox",e}label(e,t){return this.div(e,this.msg(t))}prependLabel(e,t){return this.label(t,e)}call(e,t){this.action.method&&(this.action.__url?this.plugin.restApi().send(this.action.method,this.action.__url,e).then(t).catch((e=>{ea(document,`Plugin network error: ${e}`)})):this.reporting.error("GrPluginActionContext",new Error(`Unable to ${this.action.method} to ${this.action.__key}!`)))}}var da,ca,ha,pa,ua,ga;function ma(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function fa(e,t){throw console.error(t,e),new Error(t)}function va(e,t){if(!e)throw new Error(t)}function ba(e,t="variable"){if(null==e)throw new Error(`${t} is not defined`)}function ya(e,t){if(!e)throw new Error("element not defined");if(e.shadowRoot){const i=e.shadowRoot.querySelectorAll(t);if(i.length>0)return i}return e.querySelectorAll(t)}function wa(e,t){if(e){if(e.shadowRoot){const i=e.shadowRoot.querySelector(t);if(i)return i}return e.querySelector(t)??void 0}}function _a(e,t){const i=wa(e,t);if(!i)throw new Error(`selector '${t}' did not match anything'`);return i}function xa(e,t){for(const i of t)if(!e.has(i))return!1;return!0}function Ca(e,t,i){return i.indexOf(e)===t}function Ea(e,t,i=(e,t)=>e===t){return e.filter((e=>!t.some((t=>i(e,t)))))}async function Sa(e,t){await navigator.clipboard.writeText(e),ea(document,`${t??e} was copied to clipboard`)}function $a(){return Math.random().toString(36).substring(2)}!function(e){e.NEW_IMAGE_DIFF_UI="UiFeature__new_image_diff_ui",e.CHECKS_DEVELOPER="UiFeature__checks_developer",e.PUSH_NOTIFICATIONS_DEVELOPER="UiFeature__push_notifications_developer",e.ML_SUGGESTED_EDIT_V2="UiFeature__ml_suggested_edit_v2",e.PARALLEL_DASHBOARD_REQUESTS="UiFeature__parallel_dashboard_requests",e.ML_SUGGESTED_EDIT_UNCHECK_BY_DEFAULT="UiFeature__ml_suggested_edit_uncheck_by_default",e.ML_SUGGESTED_EDIT_FEEDBACK="UiFeature__ml_suggested_edit_feedback",e.ML_SUGGESTED_EDIT_EDITABLE_SUGGESTION="UiFeature__ml_suggested_edit_editable_suggestion",e.SHOW_FLOWS_TAB="UiFeature__show_flows_tab",e.ASYNC_SUBMIT_REQUIREMENTS="UiFeature__async_submit_requirements"}(da||(da={})),function(e){e.EVENT_ONCE_PER_SESSION="EVENT_ONCE_PER_SESSION",e.EVENT_ONCE_PER_CHANGE="EVENT_ONCE_PER_CHANGE",e.DETAILS_ONCE_PER_SESSION="DETAILS_ONCE_PER_SESSION",e.DETAILS_ONCE_PER_CHANGE="DETAILS_ONCE_PER_CHANGE"}(ca||(ca={})),function(e){e.PLUGIN_LIFE_CYCLE="Plugin life cycle",e.STARTED_AS_USER="Started as user",e.STARTED_AS_GUEST="Started as guest",e.VISIBILILITY_HIDDEN="Visibility changed to hidden",e.VISIBILILITY_VISIBLE="Visibility changed to visible",e.FOCUS="Focus changed",e.EXTENSION_DETECTED="Extension detected",e.PLUGINS_INSTALLED="Plugins installed",e.PLUGINS_FAILED="Some plugins failed to load",e.USER_REFERRED_FROM="User referred from",e.NOTIFICATION_PERMISSION="Notification Permission",e.SERVICE_WORKER_UPDATE="Service worker update"}(ha||(ha={})),function(e){e.PLUGIN_API="plugin-api",e.REACHABLE_CODE="reachable code",e.METHOD_USED="method used",e.CHECKS_API_NOT_LOGGED_IN="checks-api not-logged-in",e.CHECKS_API_ERROR="checks-api error",e.USER_PREFERENCES_COLUMNS="user-preferences-columns",e.PREFER_MERGE_FIRST_PARENT="prefer-merge-first-parent",e.PUBLISHED_DRAFTS_DEDUPLICATED="published-drafts-deduplicated"}(pa||(pa={})),function(e){e.APP_STARTED="App Started",e.CHANGE_DISPLAYED="ChangeDisplayed",e.CHANGE_LOAD_FULL="ChangeFullyLoaded",e.DASHBOARD_DISPLAYED="DashboardDisplayed",e.DIFF_VIEW_CONTENT_DISPLAYED="DiffViewOnlyContent",e.DIFF_VIEW_DISPLAYED="DiffViewDisplayed",e.FILE_LIST_DISPLAYED="FileListDisplayed",e.PLUGINS_LOADED="PluginsLoaded",e.METRICS_PLUGIN_LOADED="MetricsPluginLoaded",e.STARTUP_CHANGE_DISPLAYED="StartupChangeDisplayed",e.STARTUP_CHANGE_LOAD_FULL="StartupChangeFullyLoaded",e.STARTUP_DASHBOARD_DISPLAYED="StartupDashboardDisplayed",e.STARTUP_DIFF_VIEW_CONTENT_DISPLAYED="StartupDiffViewOnlyContent",e.STARTUP_DIFF_VIEW_DISPLAYED="StartupDiffViewDisplayed",e.STARTUP_FILE_LIST_DISPLAYED="StartupFileListDisplayed",e.WEB_COMPONENTS_READY="WebComponentsReady",e.CHANGE_DATA="ChangeDataLoaded",e.CHANGE_RELOAD="ChangeReloaded",e.SEND_REPLY="SendReply",e.DIFF_TOTAL="Diff Total Render",e.DIFF_CONTENT="Diff Content Render",e.DIFF_SYNTAX="Diff Syntax Render",e.DIFF_LOAD="Diff Load Render",e.FILE_RENDER="FileListRenderTime",e.FILE_EXPAND_ALL="ExpandAllDiffs",e.DRAFT_CREATE="CreateDraftComment",e.DRAFT_UPDATE="UpdateDraftComment",e.DRAFT_DISCARD="DiscardDraftComment",e.CHECKS_LOAD="ChecksLoad",e.CLS="CLS",e.LCP="LCP",e.INP="INP",e.PREVIEW_FIX_LOAD="PreviewFixLoad",e.APPLY_FIX_LOAD="ApplyFixLoad",e.COPY_TO_CLIPBOARD="CopyToClipboard",e.COMMENT_COMPLETION="CommentCompletion"}(ua||(ua={})),function(e){e.TOGGLE_SHOW_ALL_BUTTON="toggle show all button",e.SHOW_TAB="show-tab",e.ATTENTION_SET_CHIP="attention-set-chip",e.BULK_ACTION="bulk-action",e.SAVE_COMMENT="save-comment",e.COMMENT_SAVED="comment-saved",e.DISCARD_COMMENT="discard-comment",e.COMMENT_DISCARDED="comment-discarded",e.CHECKS_TAB_RENDERED="checks-tab-rendered",e.CHECKS_CHIP_CLICKED="checks-chip-clicked",e.CHECKS_CHIP_LINK_CLICKED="checks-chip-link-clicked",e.CHECKS_RESULT_ROW_TOGGLE="checks-result-row-toggle",e.CHECKS_RESULT_DIFF_RENDERED="checks-result-diff-rendered",e.CHECKS_ACTION_TRIGGERED="checks-action-triggered",e.CHECKS_TAG_CLICKED="checks-tag-clicked",e.CHECKS_RESULT_FILTER_CHANGED="checks-result-filter-changed",e.CHECKS_RESULT_SECTION_TOGGLE="checks-result-section-toggle",e.CHECKS_RESULT_SECTION_SHOW_ALL="checks-result-section-show-all",e.CHECKS_RUN_SELECTED="checks-run-selected",e.CHECKS_RUN_LINK_CLICKED="checks-run-link-clicked",e.CHECKS_RUN_FILTER_CHANGED="checks-run-filter-changed",e.CHECKS_RUN_SECTION_TOGGLE="checks-run-section-toggle",e.CHECKS_ATTEMPT_SELECTED="checks-attempt-selected",e.CHECKS_RUNS_PANEL_TOGGLE="checks-runs-panel-toggle",e.CHECKS_RUNS_SELECTED_TRIGGERED="checks-runs-selected-triggered",e.CHECKS_STATS="checks-stats",e.COMMENTS_STATS="comments-stats",e.THREADS_STATS="threads-stats",e.CHANGE_ACTION_FIRED="change-action-fired",e.BUTTON_CLICK="button-click",e.LINK_CLICK="link-click",e.USER_ACTIVE="user-active",e.USER_PASSIVE="user-passive",e.GENERATE_SUGGESTION_REQUEST="generate_suggestion_request",e.GENERATE_SUGGESTION_RESPONSE="generate_suggestion_response",e.GENERATE_SUGGESTION_ENABLED="generate_suggestion_enabled",e.GENERATE_SUGGESTION_DISABLED="generate_suggestion_disabled",e.GENERATE_SUGGESTION_EDITED="generate_suggestion_edited",e.GENERATE_SUGGESTION_COLLAPSED="generate_suggestion_collapsed",e.GENERATE_SUGGESTION_EXPANDED="generate_suggestion_expanded",e.GENERATE_SUGGESTION_THUMB_UP="generate_suggestion_thumb_up",e.GENERATE_SUGGESTION_THUMB_DOWN="generate_suggestion_thumb_down",e.START_REVIEW="start-review",e.CODE_REVIEW_APPROVAL="code-review-approval",e.FILE_LIST_DIFF_COLLAPSED="file-list-diff-collapsed",e.FILE_LIST_DIFF_EXPANDED="file-list-diff-expanded",e.FILE_LIST_ALL_DIFFS_COLLAPSED="file-list-all-diffs-collapsed",e.FILE_LIST_ALL_DIFFS_EXPANDED="file-list-all-diffs-expanded",e.CHANGE_ID_CHANGED="change-id-changed",e.COMMENT_COMPLETION_SUGGESTION_SHOWN="comment-completion-suggestion-shown",e.COMMENT_COMPLETION_SUGGESTION_ACCEPTED="comment-completion-suggestion-accepted",e.COMMENT_COMPLETION_SAVE_DRAFT="comment-completion-save-draft",e.COMMENT_COMPLETION_SUGGESTION_FETCHED="comment-completion-suggestion-fetched"}(ga||(ga={}));var ka,Aa=-1,Ra=function(e){addEventListener("pageshow",(function(t){t.persisted&&(Aa=t.timeStamp,e(t))}),!0)},Ta=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},Ia=function(){var e=Ta();return e&&e.activationStart||0},Pa=function(e,t){var i=Ta(),r="navigate";return Aa>=0?r="back-forward-cache":i&&(document.prerendering||Ia()>0?r="prerender":document.wasDiscarded?r="restore":i.type&&(r=i.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},Na=function(e,t,i){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},i||{})),r}}catch(e){}},Oa=function(e,t,i,r){var o,s;return function(n){t.value>=0&&(n||r)&&((s=t.value-(o||0))||void 0===o)&&(o=t.value,t.delta=s,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,i),e(t))}},Da=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},La=function(e){var t=function(t){"pagehide"!==t.type&&"hidden"!==document.visibilityState||e(t)};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)},Ma=function(e){var t=!1;return function(i){t||(e(i),t=!0)}},Fa=-1,Ua=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},Ba=function(e){"hidden"===document.visibilityState&&Fa>-1&&(Fa="visibilitychange"===e.type?e.timeStamp:0,ja())},Ha=function(){addEventListener("visibilitychange",Ba,!0),addEventListener("prerenderingchange",Ba,!0)},ja=function(){removeEventListener("visibilitychange",Ba,!0),removeEventListener("prerenderingchange",Ba,!0)},Ga=function(){return Fa<0&&(Fa=Ua(),Ha(),Ra((function(){setTimeout((function(){Fa=Ua(),Ha()}),0)}))),{get firstHiddenTime(){return Fa}}},za=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},Va=[1800,3e3],Wa=[.1,.25],qa=(new Date,0),Ka=1/0,Ya=0,Xa=function(e){e.forEach((function(e){e.interactionId&&(Ka=Math.min(Ka,e.interactionId),Ya=Math.max(Ya,e.interactionId),qa=Ya?(Ya-Ka)/7+1:0)}))},Ja=function(){return ka?qa:performance.interactionCount||0},Qa=[200,500],Za=0,el=function(){return Ja()-Za},tl=[],il={},rl=function(e){var t=tl[tl.length-1],i=il[e.interactionId];if(i||tl.length<10||e.duration>t.latency){if(i)i.entries.push(e),i.latency=Math.max(i.latency,e.duration);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};il[r.id]=r,tl.push(r)}tl.sort((function(e,t){return t.latency-e.latency})),tl.splice(10).forEach((function(e){delete il[e.id]}))}},ol=[2500,4e3],sl={};const nl="timing-report",al="UI Latency",ll="RPC Timing",dl="lifecycle",cl="Default",hl="Extension detected",pl="Plugins installed",ul="Visibility",gl="Execution",ml="Default",fl="Location Changed",vl="Page",bl="error",yl="exception",wl="Error Dialog",_l="plugin-log",xl="lifecycle",Cl="interaction",El={[ua.PLUGINS_LOADED]:0,[ua.METRICS_PLUGIN_LOADED]:0,[ua.STARTUP_CHANGE_DISPLAYED]:0,[ua.STARTUP_CHANGE_LOAD_FULL]:0,[ua.STARTUP_DASHBOARD_DISPLAYED]:0,[ua.STARTUP_DIFF_VIEW_CONTENT_DISPLAYED]:0,[ua.STARTUP_DIFF_VIEW_DISPLAYED]:0,[ua.STARTUP_FILE_LIST_DISPLAYED]:0,[ua.APP_STARTED]:0,[ua.WEB_COMPONENTS_READY]:0},Sl=[ua.SEND_REPLY];class $l{constructor(e,t=1e4){this.reportingService=e,this.reportingIntervalMs=t,this.interactionEvents=new Set;const i=["mousemove","scroll","wheel","keydown","pointerdown"];for(const e of i)document.addEventListener(e,(()=>this.interactionEvents.add(e)));this.intervalId=window.setInterval((()=>this.report()),this.reportingIntervalMs)}finalize(){window.clearInterval(this.intervalId)}report(){this.interactionEvents.size>0?this.reportingService.reportInteraction(ga.USER_ACTIVE,{events:[...this.interactionEvents]}):"visible"===document.visibilityState&&this.reportingService.reportInteraction(ga.USER_PASSIVE,{}),this.interactionEvents.clear()}}let kl;function Al(e){function t(t,i){let r=i.value;t===ua.CLS&&(r*=100),e.reporter(nl,al,t,r,{navigationType:i.navigationType,rating:i.rating,entries:i.entries})}(function(e,t){t=t||{},function(e,t){t=t||{},za((function(){var i,r=Ga(),o=Pa("FCP"),s=Na("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(s.disconnect(),e.startTime<r.firstHiddenTime&&(o.value=Math.max(e.startTime-Ia(),0),o.entries.push(e),i(!0)))}))}));s&&(i=Oa(e,o,Va,t.reportAllChanges),Ra((function(r){o=Pa("FCP"),i=Oa(e,o,Va,t.reportAllChanges),Da((function(){o.value=performance.now()-r.timeStamp,i(!0)}))})))}))}(Ma((function(){var i,r=Pa("CLS",0),o=0,s=[],n=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=s[0],i=s[s.length-1];o&&e.startTime-i.startTime<1e3&&e.startTime-t.startTime<5e3?(o+=e.value,s.push(e)):(o=e.value,s=[e])}})),o>r.value&&(r.value=o,r.entries=s,i())},a=Na("layout-shift",n);a&&(i=Oa(e,r,Wa,t.reportAllChanges),La((function(){n(a.takeRecords()),i(!0)})),Ra((function(){o=0,r=Pa("CLS",0),i=Oa(e,r,Wa,t.reportAllChanges),Da((function(){return i()}))})),setTimeout(i,0))})))})((e=>t(ua.CLS,e))),function(e,t){t=t||{},za((function(){var i,r=Ga(),o=Pa("LCP"),s=function(e){var t=e[e.length-1];t&&t.startTime<r.firstHiddenTime&&(o.value=Math.max(t.startTime-Ia(),0),o.entries=[t],i())},n=Na("largest-contentful-paint",s);if(n){i=Oa(e,o,ol,t.reportAllChanges);var a=Ma((function(){sl[o.id]||(s(n.takeRecords()),n.disconnect(),sl[o.id]=!0,i(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return setTimeout(a,0)}),!0)})),La(a),Ra((function(r){o=Pa("LCP"),i=Oa(e,o,ol,t.reportAllChanges),Da((function(){o.value=performance.now()-r.timeStamp,sl[o.id]=!0,i(!0)}))}))}}))}((e=>t(ua.LCP,e))),function(e,t){t=t||{},za((function(){var i;"interactionCount"in performance||ka||(ka=Na("event",Xa,{type:"event",buffered:!0,durationThreshold:0}));var r,o=Pa("INP"),s=function(e){e.forEach((function(e){e.interactionId&&rl(e),"first-input"===e.entryType&&!tl.some((function(t){return t.entries.some((function(t){return e.duration===t.duration&&e.startTime===t.startTime}))}))&&rl(e)}));var t,i=(t=Math.min(tl.length-1,Math.floor(el()/50)),tl[t]);i&&i.latency!==o.value&&(o.value=i.latency,o.entries=i.entries,r())},n=Na("event",s,{durationThreshold:null!==(i=t.durationThreshold)&&void 0!==i?i:40});r=Oa(e,o,Qa,t.reportAllChanges),n&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&n.observe({type:"first-input",buffered:!0}),La((function(){s(n.takeRecords()),o.value<0&&el()>0&&(o.value=0,o.entries=[]),r(!0)})),Ra((function(){tl=[],Za=Ja(),o=Pa("INP"),r=Oa(e,o,Qa,t.reportAllChanges)})))}))}((e=>t(ua.INP,e)))}class Rl{constructor(){this.accHiddenDurationMs=0,this.lastVisibleTimestampMs=null,this.reset()}reset(){this.accHiddenDurationMs=0,this.lastVisibleTimestampMs=0}onVisibilityChange(){"hidden"===document.visibilityState?this.lastVisibleTimestampMs=Tl():"visible"===document.visibilityState&&null!==this.lastVisibleTimestampMs&&(this.accHiddenDurationMs+=Tl()-this.lastVisibleTimestampMs,this.lastVisibleTimestampMs=null)}get hiddenDurationMs(){return"hidden"===document.visibilityState&&null!==this.lastVisibleTimestampMs?this.accHiddenDurationMs+Tl()-this.lastVisibleTimestampMs:this.accHiddenDurationMs}}function Tl(){return Math.round(window.performance.now())}class Il{constructor(e){this._baselines=El,this.pending=[],this.slowRpcList=[],this.reportedIds=new Set,this.hiddenDurationTimer=new Rl,this._flagsService=e}get performanceTiming(){return window.performance.timing}get slowRpcSnapshot(){return(this.slowRpcList||[]).slice()}_arePluginsLoaded(){return this._baselines&&!ma(this._baselines,ua.PLUGINS_LOADED)}_isMetricsPluginLoaded(){return this._arePluginsLoaded()||this._baselines&&!ma(this._baselines,ua.METRICS_PLUGIN_LOADED)}finalize(){}reporter(e,t,i,r,o,s){const n=this._createEventInfo(e,t,i,r,o);e===bl&&t===yl&&console.error("object"==typeof r&&r.error||i),this._isMetricsPluginLoaded()&&!this.pending.length?this._reportEvent(n,s):(this.pending.push([n,s]),this._isMetricsPluginLoaded()&&(this.pending.forEach((([e,t])=>{this._reportEvent(e,t)})),this.pending=[]))}_reportEvent(e,t){const{type:i,value:r,name:o,eventDetails:s}=e;document.dispatchEvent(new CustomEvent(i,{detail:e})),t||i!==bl&&(void 0!==r?console.debug(`Reporting(${(new Date).toISOString()}): ${o}: ${r}`):void 0!==s?console.debug(`Reporting(${(new Date).toISOString()}): ${o}: ${s}`):console.debug(`Reporting(${(new Date).toISOString()}): ${o}`))}_createEventInfo(e,t,i,r,o){const s={type:e,category:t,name:i,value:r,eventStart:Tl()};"object"==typeof o&&0!==Object.entries(o).length&&(s.eventDetails=JSON.stringify(o)),this.reportRepoName&&(s.repoName=this.reportRepoName),this.reportChangeId&&(s.changeId=`${this.reportChangeId}`);const n="hidden"===document.visibilityState;return void 0!==n&&(s.inBackgroundTab=n),i===ua.APP_STARTED&&this._flagsService.enabledExperiments.length&&(s.enabledExperiments=JSON.stringify(this._flagsService.enabledExperiments)),s}appStarted(){this.timeEnd(ua.APP_STARTED),this._reportNavResTimes()}onFocusChange(){this.reporter(dl,ul,ha.FOCUS,void 0,{isVisible:"visible"===document.visibilityState,hasFocus:document.hasFocus()},!1)}onVisibilityChange(){let e;this.hiddenDurationTimer.onVisibilityChange(),"hidden"===document.visibilityState?e=ha.VISIBILILITY_HIDDEN:"visible"===document.visibilityState&&(e=ha.VISIBILILITY_VISIBLE),e&&this.reporter(dl,ul,e,void 0,{hiddenDurationMs:this.hiddenDurationTimer.hiddenDurationMs,isVisible:"visible"===document.visibilityState,hasFocus:document.hasFocus()},!1)}_reportNavResTimes(){Object.keys(this.performanceTiming.toJSON()).forEach((e=>this._reportPerformanceTiming(e)))}_reportPerformanceTiming(e,t){const i=this.performanceTiming[e];if(i>0){const r=i-this.performanceTiming.navigationStart;this.reporter(nl,al,`NavResTime - ${e}`,r,t,!0)}}beforeLocationChanged(){for(const e of Object.keys(this._baselines))Sl.includes(e)||delete this._baselines[e];this.time(ua.CHANGE_DISPLAYED),this.time(ua.CHANGE_LOAD_FULL),this.time(ua.DASHBOARD_DISPLAYED),this.time(ua.DIFF_VIEW_CONTENT_DISPLAYED),this.time(ua.DIFF_VIEW_DISPLAYED),this.time(ua.FILE_LIST_DISPLAYED),this.setRepoName(void 0),this.setChangeId(void 0),this.slowRpcList=[],this.hiddenDurationTimer.reset()}locationChanged(e){this.reporter("nav-report",fl,vl,e)}dashboardDisplayed(){ma(this._baselines,ua.STARTUP_DASHBOARD_DISPLAYED)?this.timeEnd(ua.STARTUP_DASHBOARD_DISPLAYED,this._pageLoadDetails()):this.timeEnd(ua.DASHBOARD_DISPLAYED,this._pageLoadDetails())}changeDisplayed(e){e={...e,...this._pageLoadDetails()},ma(this._baselines,ua.STARTUP_CHANGE_DISPLAYED)?this.timeEnd(ua.STARTUP_CHANGE_DISPLAYED,e):this.timeEnd(ua.CHANGE_DISPLAYED,e)}changeFullyLoaded(){ma(this._baselines,ua.STARTUP_CHANGE_LOAD_FULL)?this.timeEnd(ua.STARTUP_CHANGE_LOAD_FULL):this.timeEnd(ua.CHANGE_LOAD_FULL)}diffViewDisplayed(){ma(this._baselines,ua.STARTUP_DIFF_VIEW_DISPLAYED)?this.timeEnd(ua.STARTUP_DIFF_VIEW_DISPLAYED,this._pageLoadDetails()):this.timeEnd(ua.DIFF_VIEW_DISPLAYED,this._pageLoadDetails())}diffViewContentDisplayed(){ma(this._baselines,ua.STARTUP_DIFF_VIEW_CONTENT_DISPLAYED)?this.timeEnd(ua.STARTUP_DIFF_VIEW_CONTENT_DISPLAYED):this.timeEnd(ua.DIFF_VIEW_CONTENT_DISPLAYED)}fileListDisplayed(){ma(this._baselines,ua.STARTUP_FILE_LIST_DISPLAYED)?this.timeEnd(ua.STARTUP_FILE_LIST_DISPLAYED):this.timeEnd(ua.FILE_LIST_DISPLAYED)}_pageLoadDetails(){const e={rpcList:this.slowRpcSnapshot,hiddenDurationMs:this.hiddenDurationTimer.accHiddenDurationMs,parallelRequestsEnabled:this._flagsService.isEnabled(da.PARALLEL_DASHBOARD_REQUESTS)};if(window.screen&&(e.screenSize={width:window.screen.width,height:window.screen.height}),document?.documentElement&&(e.viewport={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}),window.performance?.memory){const t=e=>Math.round(e/1048576*100)/100;e.usedJSHeapSizeMb=t(window.performance.memory.usedJSHeapSize)}return e.hiddenDurationMs=this.hiddenDurationTimer.hiddenDurationMs,e}reportExtension(e){this.reporter(dl,hl,ha.EXTENSION_DETECTED,void 0,{name:e})}pluginLoaded(e){e.startsWith("metrics-")&&this.timeEnd(ua.METRICS_PLUGIN_LOADED)}pluginsLoaded(e){this.timeEnd(ua.PLUGINS_LOADED),this.reporter(dl,pl,ha.PLUGINS_INSTALLED,void 0,{pluginsList:e||[]},!1)}pluginsFailed(e){e&&0!==e.length&&this.reporter(dl,pl,ha.PLUGINS_FAILED,void 0,{pluginsList:e||[]},!1)}time(e){this._baselines[e]=Tl(),window.performance.mark(`${e}-start`),e===ua.DASHBOARD_DISPLAYED&&(this.slowRpcList=[],this.hiddenDurationTimer.reset())}timeEnd(e,t){if(!ma(this._baselines,e))return 0;const i=this._baselines[e];delete this._baselines[e];const r=Tl()-i;return this._reportTiming(e,r,t),0!==i?window.performance.measure(e,`${e}-start`):window.performance.measure(e),r}_reportTiming(e,t,i){this.reporter(nl,al,e,t,i)}getTimer(e){let t,i=!1,r=null;const o={reset:()=>(i=!1,t=Tl(),o),end:s=>{if(i)throw new Error(`Timer for "${e}" already ended.`);i=!0;const n=Tl()-t;return r&&n>r||this._reportTiming(e,n,s),o},withMaximum:e=>(r=e,o)};return o.reset()}reportRpcTiming(e,t){this.reporter(nl,ll,"RPC-"+e,t,{},!0),t>=500&&this.slowRpcList.push({anonymizedUrl:e,elapsed:t})}reportLifeCycle(e,t){this.reporter(dl,cl,e,void 0,t,!1)}reportPluginLifeCycleLog(e,t){this.reporter(_l,xl,e,void 0,t,!1)}reportPluginInteractionLog(e,t){this.reporter(_l,Cl,e,void 0,t,!0)}_dedup(e,t,i){if(!i)return!1;let r="";switch(i){case ca.DETAILS_ONCE_PER_CHANGE:r=`${e}-${this.reportChangeId}-${JSON.stringify(t)}`;break;case ca.DETAILS_ONCE_PER_SESSION:r=`${e}-${JSON.stringify(t)}`;break;case ca.EVENT_ONCE_PER_CHANGE:r=`${e}-${this.reportChangeId}`;break;case ca.EVENT_ONCE_PER_SESSION:r=`${e}`;break;default:throw new Error(`Invalid 'deduping' option '${i}'.`)}return!!this.reportedIds.has(r)||(this.reportedIds.add(r),!1)}reportInteraction(e,t,i){this._dedup(e,t,i?.deduping)||this.reporter("interaction",ml,e,void 0,t,!1)}reportExecution(e,t){this._dedup(e,t,ca.DETAILS_ONCE_PER_SESSION)||this.reporter(dl,gl,e,void 0,t,!0)}trackApi(e,t,i){const r=e?.getPluginName()??"unknown";this.reportExecution(pa.PLUGIN_API,{plugin:r,object:t,method:i})}error(e,t,i){const r={errorMessage:`${e}: ${t.message}`,...i,stack:t.stack};this.reporter(bl,yl,e,{error:t},r)}reportErrorDialog(e){this.reporter(bl,wl,"ErrorDialog",{error:new Error(e)},{errorMessage:e})}setRepoName(e){this.reportRepoName=e}setChangeId(e){const t=this.reportChangeId;this.reportChangeId=e,e&&e!==t&&this.reportInteraction(ga.CHANGE_ID_CHANGED,{changeId:e})}}const Pl={};function Nl(e){return Object.isFrozen(e)&&Object.isFrozen(e.raw)}function Ol(e){return-1===e.toString().indexOf("`")}Ol((e=>e``))||Ol((e=>e`\0`))||Ol((e=>e`\n`))||Ol((e=>e`\u0000`)),Nl``&&Nl`\0`&&Nl`\n`&&Nl`\u0000`;let Dl="google#safe";let Ll,Ml=globalThis.trustedTypes;function Fl(){return void 0===Ll&&(Ll=function(){let e=null;if(!Ml)return e;try{const t=e=>e;e=Ml.createPolicy(Dl,{createHTML:t,createScript:t,createScriptURL:t})}catch(e){}return e}()),Ll}function Ul(e){return{valueOf:e}.valueOf()}class Bl{constructor(e,t){this.privateDoNotAccessOrElseWrappedHtml=t}toString(){return this.privateDoNotAccessOrElseWrappedHtml+""}}const Hl=Bl;function jl(e){const t=e,i=Fl();return function(e){return new Hl(Pl,e)}(i?i.createHTML(t):t)}function Gl(e){return e instanceof Bl}function zl(e,t){if(Gl(e))return e;let i=String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;");return(null==t?void 0:t.preserveSpaces)&&(i=i.replace(/(^|[\r\n\t ]) /g,"$1&#160;")),(null==t?void 0:t.preserveNewlines)&&(i=i.replace(/(\r\n|\n|\r)/g,"<br>")),(null==t?void 0:t.preserveTabs)&&(i=i.replace(/(\t+)/g,'<span style="white-space:pre">$1</span>')),jl(i)}var Vl,Wl;function ql(e){try{return new URL(e,window.document.baseURI)}catch(e){return new URL("about:invalid")}}new Set(["accent-color","align-content","align-items","align-self","alignment-baseline","all","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-shadow","box-sizing","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","content","content-visibility","counter-increment","counter-reset","counter-set","cx","cy","d","display","dominant-baseline","empty-cells","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","font","font-family","font-feature-settings","font-kerning","font-optical-sizing","font-palette","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","height","hyphenate-character","hyphenate-limit-chars","hyphens","image-orientation","image-rendering","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","left","letter-spacing","lighting-color","line-break","line-clamp","line-gap-override","line-height","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","marker","marker-end","marker-mid","marker-start","mask","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","object-fit","object-position","object-view-box","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","paint-order","perspective","perspective-origin","place-content","place-items","place-self","position","quotes","r","resize","right","rotate","row-gap","ruby-align","ruby-position","rx","ry","scale","shape-image-threshold","shape-margin","shape-outside","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-last","text-anchor","text-autospace","text-box-edge","text-box-trim","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-spacing","text-spacing-trim","text-transform","text-underline-offset","text-underline-position","text-wrap","top","transform","transform-box","transform-origin","transform-style","translate","unicode-bidi","vector-effect","vertical-align","visibility","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function"]),new Set(["alpha","cubic-bezier","linear-gradient","matrix","perspective","radial-gradient","rect","repeating-linear-gradient","repeating-radial-gradient","rgb","rgba","rotate","rotate3d","rotatex","rotatey","rotatez","scale","scale3d","scalex","scaley","scalez","skew","skewx","skewy","steps","translate","translate3d","translatex","translatey","translatez","url"]),function(e){e[e.STYLE_ELEMENT=0]="STYLE_ELEMENT",e[e.STYLE_ATTRIBUTE=1]="STYLE_ATTRIBUTE",e[e.HTML_ATTRIBUTE=2]="HTML_ATTRIBUTE"}(Vl||(Vl={})),function(e){e[e.AT_KEYWORD=0]="AT_KEYWORD",e[e.CDC=1]="CDC",e[e.CDO=2]="CDO",e[e.CLOSE_CURLY=3]="CLOSE_CURLY",e[e.CLOSE_PAREN=4]="CLOSE_PAREN",e[e.CLOSE_SQUARE=5]="CLOSE_SQUARE",e[e.COLON=6]="COLON",e[e.COMMA=7]="COMMA",e[e.DELIM=8]="DELIM",e[e.DIMENSION=9]="DIMENSION",e[e.EOF=10]="EOF",e[e.FUNCTION=11]="FUNCTION",e[e.HASH=12]="HASH",e[e.IDENT=13]="IDENT",e[e.NUMBER=14]="NUMBER",e[e.OPEN_CURLY=15]="OPEN_CURLY",e[e.OPEN_PAREN=16]="OPEN_PAREN",e[e.OPEN_SQUARE=17]="OPEN_SQUARE",e[e.PERCENTAGE=18]="PERCENTAGE",e[e.SEMICOLON=19]="SEMICOLON",e[e.STRING=20]="STRING",e[e.WHITESPACE=21]="WHITESPACE"}(Wl||(Wl={}));const Kl=["data:","http:","https:","mailto:","ftp:"],Yl=/^\s*(?!javascript:)(?:[\w+.-]+:|[^:/?#]*(?:[/?#]|$))/i;function Xl(e){return function(e){if(!function(e){return!Yl.test(e)}(e))return e}(e)}function Jl(e){const t=function(e){let t;try{t=new URL(e)}catch(e){return"https:"}return t.protocol}(e);return void 0!==t&&-1!==Kl.indexOf(t.toLowerCase())?e:"about:invalid#zClosurez"}function Ql(e,t){const i=t.createRange();return i.selectNode(t.body),function(e,t){return e.createContextualFragment(function(e){if(Gl(e))return e.privateDoNotAccessOrElseWrappedHtml;throw new Error("")}(t))}(i,jl(e))}function Zl(e){const t=e.nodeName;return"string"==typeof t?t:"FORM"}function ed(e){return 3===e.nodeType}function td(e){const t=e.nodeType;return 1===t||"number"!=typeof t}var id;!function(e){e[e.DROP=0]="DROP",e[e.KEEP=1]="KEEP",e[e.KEEP_AND_SANITIZE_URL=2]="KEEP_AND_SANITIZE_URL",e[e.KEEP_AND_NORMALIZE=3]="KEEP_AND_NORMALIZE",e[e.KEEP_AND_SANITIZE_STYLE=4]="KEEP_AND_SANITIZE_STYLE",e[e.KEEP_AND_USE_RESOURCE_URL_POLICY=5]="KEEP_AND_USE_RESOURCE_URL_POLICY",e[e.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET=6]="KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET"}(id||(id={})),new Set(["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"]);const rd=[["A",new Map([["href",{policyAction:id.KEEP_AND_SANITIZE_URL}]])],["AREA",new Map([["href",{policyAction:id.KEEP_AND_SANITIZE_URL}]])],["LINK",new Map([["href",{policyAction:id.KEEP_AND_USE_RESOURCE_URL_POLICY,conditions:new Map([["rel",new Set(["alternate","author","bookmark","canonical","cite","help","icon","license","next","prefetch","dns-prefetch","prerender","preconnect","preload","prev","search","subresource"])]])}]])],["SOURCE",new Map([["src",{policyAction:id.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:id.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["IMG",new Map([["src",{policyAction:id.KEEP_AND_USE_RESOURCE_URL_POLICY}],["srcset",{policyAction:id.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET}]])],["VIDEO",new Map([["src",{policyAction:id.KEEP_AND_USE_RESOURCE_URL_POLICY}]])],["AUDIO",new Map([["src",{policyAction:id.KEEP_AND_USE_RESOURCE_URL_POLICY}]])]],od=[["dir",{policyAction:id.KEEP_AND_NORMALIZE,conditions:Ul((()=>new Map([["dir",new Set(["auto","ltr","rtl"])]])))}],["async",{policyAction:id.KEEP_AND_NORMALIZE,conditions:Ul((()=>new Map([["async",new Set(["async"])]])))}],["loading",{policyAction:id.KEEP_AND_NORMALIZE,conditions:Ul((()=>new Map([["loading",new Set(["eager","lazy"])]])))}],["target",{policyAction:id.KEEP_AND_NORMALIZE,conditions:Ul((()=>new Map([["target",new Set(["_self","_blank"])]])))}]],sd=new class{constructor(e,t,i,r,o){this.allowedElements=e,this.elementPolicies=t,this.allowedGlobalAttributes=i,this.globalAttributePolicies=r,this.globallyAllowedAttributePrefixes=o}isAllowedElement(e){return"FORM"!==e&&(this.allowedElements.has(e)||this.elementPolicies.has(e))}getAttributePolicy(e,t){const i=this.elementPolicies.get(t);if(null==i?void 0:i.has(e))return i.get(e);if(this.allowedGlobalAttributes.has(e))return{policyAction:id.KEEP};return this.globalAttributePolicies.get(e)||(this.globallyAllowedAttributePrefixes&&[...this.globallyAllowedAttributePrefixes].some((t=>0===e.indexOf(t)))?{policyAction:id.KEEP}:{policyAction:id.DROP})}}(new Set(["ARTICLE","SECTION","NAV","ASIDE","H1","H2","H3","H4","H5","H6","HEADER","FOOTER","ADDRESS","P","HR","PRE","BLOCKQUOTE","OL","UL","LH","LI","DL","DT","DD","FIGURE","FIGCAPTION","MAIN","DIV","EM","STRONG","SMALL","S","CITE","Q","DFN","ABBR","RUBY","RB","RT","RTC","RP","DATA","TIME","CODE","VAR","SAMP","KBD","SUB","SUP","I","B","U","MARK","BDI","BDO","SPAN","BR","WBR","NOBR","INS","DEL","PICTURE","PARAM","TRACK","MAP","TABLE","CAPTION","COLGROUP","COL","TBODY","THEAD","TFOOT","TR","TD","TH","SELECT","DATALIST","OPTGROUP","OPTION","OUTPUT","PROGRESS","METER","FIELDSET","LEGEND","DETAILS","SUMMARY","MENU","DIALOG","SLOT","CANVAS","FONT","CENTER","ACRONYM","BASEFONT","BIG","DIR","HGROUP","STRIKE","TT"]),new Map(rd),new Set(["title","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-current","aria-disabled","aria-dropeffect","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","alt","align","autocapitalize","autocomplete","autocorrect","autofocus","autoplay","bgcolor","border","cellpadding","cellspacing","checked","cite","color","cols","colspan","controls","controlslist","datetime","disabled","download","draggable","enctype","face","formenctype","frameborder","height","hreflang","hidden","ismap","label","lang","loop","max","maxlength","media","minlength","min","multiple","muted","nonce","open","placeholder","poster","preload","rel","required","reversed","role","rows","rowspan","selected","shape","size","sizes","slot","span","spellcheck","start","step","summary","translate","type","valign","value","width","wrap","itemscope","itemtype","itemid","itemprop","itemref"]),new Map(od),void 0);class nd{constructor(e,t,i,r,o,s){this.sanitizerTable=e,this.styleElementSanitizer=i,this.styleAttributeSanitizer=r,this.resourceUrlPolicy=o,this.openShadow=s,this.changes=[]}sanitizeAssertUnchanged(e){return this.sanitize(e)}sanitize(e){const t=document.implementation.createHTMLDocument("");return function(e,t){t.appendChild(e);let i=(new XMLSerializer).serializeToString(t);return i=i.slice(i.indexOf(">")+1,i.lastIndexOf("</")),jl(i)}(this.sanitizeToFragmentInternal(e,t),t.body)}sanitizeToFragment(e){const t=document.implementation.createHTMLDocument("");return this.styleElementSanitizer&&this.styleAttributeSanitizer?this.sanitizeWithCssToFragment(e,t):this.sanitizeToFragmentInternal(e,t)}sanitizeWithCssToFragment(e,t){const i=document.createElement("safevalues-with-css"),r=this.openShadow?"open":"closed",o=i.attachShadow({mode:r}),s=this.sanitizeToFragmentInternal(e,t),n=document.createElement("style");n.textContent=":host{display:inline-block;clip-path:inset(0);overflow:hidden;vertical-align:top;text-decoration:inherit}",n.id="safevalues-internal-style",o.appendChild(n),o.appendChild(s);const a=t.createDocumentFragment();return a.appendChild(i),a}sanitizeToFragmentInternal(e,t){const i=Ql(e,t),r=document.createTreeWalker(i,5,(e=>this.nodeFilter(e)));let o=r.nextNode();const s=t.createDocumentFragment();let n=s;for(;null!==o;){let e;if(ed(o))if(this.styleElementSanitizer&&"STYLE"===n.nodeName){const t=this.styleElementSanitizer(o.data);e=this.createTextNode(t)}else e=this.sanitizeTextNode(o);else{if(!td(o)){throw new Error("")}e=this.sanitizeElementNode(o,t)}if(n.appendChild(e),o=r.firstChild(),o)n=e;else for(;!(o=r.nextSibling())&&(o=r.parentNode());)n=n.parentNode}return s}createTextNode(e){return document.createTextNode(e)}sanitizeTextNode(e){return this.createTextNode(e.data)}sanitizeElementNode(e,t){const i=Zl(e),r=t.createElement(i),o=e.attributes;for(const{name:e,value:t}of o){const s=this.sanitizerTable.getAttributePolicy(e,i);if(this.satisfiesAllConditions(s.conditions,o))switch(s.policyAction){case id.KEEP:ad(r,e,t);break;case id.KEEP_AND_SANITIZE_URL:const o=Jl(t);o!==t&&this.recordChange(`Url in attribute ${e} was modified during sanitization. Original url:"${t}" was sanitized to: "${o}"`),ad(r,e,o);break;case id.KEEP_AND_NORMALIZE:ad(r,e,t.toLowerCase());break;case id.KEEP_AND_SANITIZE_STYLE:this.styleAttributeSanitizer?ad(r,e,this.styleAttributeSanitizer(t)):ad(r,e,t);break;case id.KEEP_AND_USE_RESOURCE_URL_POLICY:if(this.resourceUrlPolicy){const o={type:Vl.HTML_ATTRIBUTE,attributeName:e,elementName:i},s=ql(t),n=this.resourceUrlPolicy(s,o);n&&ad(r,e,n.toString())}else ad(r,e,t);break;case id.KEEP_AND_USE_RESOURCE_URL_POLICY_FOR_SRCSET:if(this.resourceUrlPolicy){const o={type:Vl.HTML_ATTRIBUTE,attributeName:e,elementName:i},s=ld(t),n={parts:[]};for(const e of s.parts){const t=ql(e.url),i=this.resourceUrlPolicy(t,o);i&&n.parts.push({url:i.toString(),descriptor:e.descriptor})}ad(r,e,dd(n))}else ad(r,e,t);break;case id.DROP:this.recordChange(`Attribute: ${e} was dropped`)}else this.recordChange(`Not all conditions satisfied for attribute: ${e}.`)}return r}nodeFilter(e){if(ed(e))return 1;if(!td(e))return 2;const t=Zl(e);return null===t?(this.recordChange(`Node name was null for node: ${e}`),2):this.sanitizerTable.isAllowedElement(t)?1:(this.recordChange(`Element: ${t} was dropped`),2)}recordChange(e){}satisfiesAllConditions(e,t){var i;if(!e)return!0;for(const[r,o]of e){const e=null===(i=t.getNamedItem(r))||void 0===i?void 0:i.value;if(e&&!o.has(e))return!1}return!0}}function ad(e,t,i){e.setAttribute(t,i)}function ld(e){const t=[];for(const i of e.split(",")){const[e,r]=i.trim().split(/\s+/,2);t.push({url:e,descriptor:r})}return{parts:t}}function dd(e){return e.parts.map((e=>{const{url:t,descriptor:i}=e;return`${t}${i?` ${i}`:""}`})).join(" , ")}const cd=Ul((()=>new nd(sd,Pl)));function hd(e){return cd.sanitizeToFragment(e)}function pd(e){const t=e[0];if(/[<>]/.test(t))throw new Error("Forbidden characters in styleSheet string: "+t);return t}function ud(e,t){e.textContent=t}const gd=pd`
  html {
    /**
       * When adding a new color variable make sure to also add it to the other
       * theme files in the same directory.
       *
       * For colors prefer lower case hex colors.
       *
       * Note that plugins might be using these variables, so removing a variable
       * can be a breaking change that should go into the release notes.
       */

    /* color palette */
    --gerrit-blue-light: #1565c0;
    --gerrit-blue-dark: #90caf9;
    --red-50: #fce8e6;
    --red-100: #fad2cf;
    --red-200: #f6aea9;
    --red-300: #f28b82;
    --red-400: #ee675c;
    --red-500: #ea4335;
    --red-600: #d93025;
    --red-700: #c5221f;
    --red-700-04: #c5221f0a;
    --red-700-10: #c5221f1a;
    --red-700-12: #c5221f1f;
    --red-800: #b31412;
    --red-900: #a50e0e;
    --red-tonal: #6c322f;
    --blue-50: #e8f0fe;
    --blue-100: #d2e3fc;
    --blue-200: #aecbfa;
    --blue-200-16: #aecbfa29;
    --blue-200-24: #aecbfa3d;
    --blue-300: #8ab4f8;
    --blue-300-24: #8ab4f83D;
    --blue-400: #669df6;
    --blue-500: #4285f4;
    --blue-600: #1a73e8;
    --blue-700: #1967d2;
    --blue-700-04: #1967d20a;
    --blue-700-10: #1967d21a;
    --blue-700-12: #1967d21f;
    --blue-700-16: #1967d229;
    --blue-700-24: #1967d23d;
    --blue-800: #185abc;
    --blue-900: #174ea6;
    --blue-tonal: #314972;
    --orange-50: #feefe3;
    --orange-100: #fedfc8;
    --orange-200: #fdc69c;
    --orange-300: #fcad70;
    --orange-400: #fa903e;
    --orange-500: #fa7b17;
    --orange-600: #e8710a;
    --orange-700: #d56e0c;
    --orange-700-04: #d56e0c0a;
    --orange-700-10: #d56e0c1a;
    --orange-700-12: #d56e0c1f;
    --orange-800: #c26401;
    --orange-900: #b06000;
    --orange-tonal: #714625;
    --cyan-50: #e4f7fb;
    --cyan-100: #cbf0f8;
    --cyan-200: #a1e4f2;
    --cyan-300: #78d9ec;
    --cyan-400: #4ecde6;
    --cyan-500: #24c1e0;
    --cyan-600: #12b5cb;
    --cyan-700: #129eaf;
    --cyan-800: #098591;
    --cyan-900: #007b83;
    --cyan-tonal: #275e6b;
    --green-50: #e6f4ea;
    --green-100: #ceead6;
    --green-200: #a8dab5;
    --green-300: #81c995;
    --green-400: #5bb974;
    --green-500: #34a853;
    --green-600: #1e8e3e;
    --green-700: #188038;
    --green-700-04: #1880380a;
    --green-700-10: #1880381a;
    --green-700-12: #1880381f;
    --green-800: #137333;
    --green-900: #0d652d;
    --green-tonal: #2c553a;
    --gray-900: #202124;
    --gray-800: #3c4043;
    --gray-800-12: #3c40431f;
    --gray-800-38: #3c404361;
    --gray-700: #5f6368;
    --gray-700-04: #5f63680a;
    --gray-700-10: #5f63681a;
    --gray-700-12: #5f63681f;
    --gray-500: #9aa0a6;
    --gray-400: #bdc1c6;
    --gray-300: #dadce0;
    --gray-200: #e8eaed;
    --gray-200-12: #e8eaed1f;
    --gray-200-38: #e8eaed61;
    --gray-100: #f1f3f4;
    --gray-50: #f8f9fa;
    --gray-tonal: #505357;
    --purple-50: #f3e8fd;
    --purple-100: #e9d2fd;
    --purple-200: #d7aefb;
    --purple-300: #c58af9;
    --purple-400: #af5cf7;
    --purple-500: #a142f4;
    --purple-600: #9334e6;
    --purple-700: #8430ce;
    --purple-800: #7627bb;
    --purple-900: #681da8;
    --purple-tonal: #523272;
    --deep-purple-800: #4527a0;
    --deep-purple-600: #5e35b1;
    --pink-50: #fde7f3;
    --pink-100: #fdcfe8;
    --pink-200: #fba9d6;
    --pink-300: #ff8bcb;
    --pink-400: #ff63b8;
    --pink-500: #f439a0;
    --pink-600: #e52592;
    --pink-700: #c92786;
    --pink-800: #b80672;
    --pink-900: #9c166b;
    --pink-tonal: #702f55;
    --yellow-50: #fef7e0;
    --yellow-100: #feefc3;
    --yellow-200: #fde293;
    --yellow-300: #fdd663;
    --yellow-400: #fcc934;
    --yellow-500: #fbbc04;
    --yellow-600: #f9ab00;
    --yellow-700: #f29900;
    --yellow-800: #ea8600;
    --yellow-900: #e37400;
    --yellow-tonal: #6a5619;
    --brown-50: #efebe9;
    --brown-tonal: #6d4c41;
    --white-04: #ffffff0a;
    --white-10: #ffffff1a;
    --white-12: #ffffff1f;

    --modal-opacity: 0.32;

    --error-foreground: var(--red-700);
    --error-background: var(--red-50);
    --error-background-hover: linear-gradient(
        var(--red-700-04),
        var(--red-700-04)
      ),
      var(--red-50);
    --error-background-focus: linear-gradient(
        var(--red-700-12),
        var(--red-700-12)
      ),
      var(--red-50);
    --error-ripple: var(--red-700-10);

    --code-review-warning-background: var(--blue-50);

    --warning-foreground: var(--orange-700);
    --warning-background: var(--orange-50);
    --warning-background-hover: linear-gradient(
        var(--orange-700-04),
        var(--orange-700-04)
      ),
      var(--orange-50);
    --warning-background-focus: linear-gradient(
        var(--orange-700-12),
        var(--orange-700-12)
      ),
      var(--orange-50);
    --warning-ripple: var(--orange-700-10);

    --info-foreground: var(--blue-700);
    --info-background: var(--blue-50);
    --info-background-hover: linear-gradient(
        var(--blue-700-04),
        var(--blue-700-04)
      ),
      var(--blue-50);
    --info-background-focus: linear-gradient(
        var(--blue-700-12),
        var(--blue-700-12)
      ),
      var(--blue-50);
    --info-ripple: var(--blue-700-10);

    --primary-button-text-color: white;
    --primary-button-background-color: var(--gerrit-blue-light);
    --primary-button-background-hover: var(--blue-700-16);
    --primary-button-background-focus: var(--blue-700-24);

    --selected-foreground: var(--blue-800);
    --selected-background: var(--blue-50);
    --selected-chip-background: var(--blue-50);

    --success-foreground: var(--green-700);
    --success-background: var(--green-50);
    --success-background-hover: linear-gradient(
        var(--green-700-04),
        var(--green-700-04)
      ),
      var(--green-50);
    --success-background-focus: linear-gradient(
        var(--green-700-12),
        var(--green-700-12)
      ),
      var(--green-50);
    --success-ripple: var(--green-700-10);

    --gray-foreground: var(--gray-700);
    --gray-background: var(--gray-100);
    --gray-background-hover: linear-gradient(
        var(--gray-700-04),
        var(--gray-700-04)
      ),
      var(--gray-100);
    --gray-background-focus: linear-gradient(
        var(--gray-700-12),
        var(--gray-700-12)
      ),
      var(--gray-100);
    --gray-ripple: var(--gray-700-10);

    --disabled-foreground: var(--gray-800-38);
    --disabled-background: var(--gray-800-12);

    --chip-color: var(--gray-900);
    --error-color: var(--red-900);
    --tag-background: var(--cyan-100);
    --label-background: var(--red-50);

    --not-working-hours-icon-background-color: var(--purple-50);
    --not-working-hours-icon-color: var(--purple-700);
    --unavailability-icon-color: var(--gray-700);
    --unavailability-chip-icon-color: var(--orange-900);
    --unavailability-chip-background-color: var(--yellow-50);

    /* text colors */
    --primary-text-color: var(--gray-900);
    --link-color: var(--gerrit-blue-light);
    --comment-text-color: var(--gray-900);
    --deemphasized-text-color: var(--gray-700);
    --default-button-text-color: var(--gerrit-blue-light);
    --chip-selected-text-color: var(--selected-foreground);
    --error-text-color: var(--red-700);
    /* Used on text color for change list that doesn't need user's attention. */
    --reviewed-text-color: black;
    --vote-text-color: black;
    --status-text-color: white;
    --tooltip-text-color: white;
    --tooltip-button-text-color: var(--gerrit-blue-dark);
    --negative-red-text-color: var(--red-600);
    --positive-green-text-color: var(--green-700);
    --indirect-relation-text-color: var(--green-700);

    /* background colors */
    /* primary background colors */
    --background-color-primary: white;
    --background-color-secondary: var(--gray-50);
    --background-color-tertiary: var(--gray-100);
    /* directly derived from primary background colors */
    --chip-background-color: var(--background-color-tertiary);
    --default-button-background-color: var(--background-color-primary);
    --dialog-background-color: var(--background-color-primary);
    --dropdown-background-color: var(--background-color-primary);
    --expanded-background-color: var(--background-color-tertiary);
    --select-background-color: var(--background-color-secondary);
    --shell-command-background-color: var(--background-color-secondary);
    --shell-command-decoration-background-color: var(
      --background-color-tertiary
    );
    --table-header-background-color: var(--background-color-secondary);
    --table-subheader-background-color: var(--background-color-tertiary);
    --view-background-color: var(--background-color-primary);
    /* unique background colors */
    /* TODO: Remove assignee colors once references are migrated */
    --assignee-highlight-color: #fcfad6;
    --assignee-highlight-selection-color: #f6f4d0;
    --line-item-highlight-color: #fcfad6;
    /* TODO: Find a nicer way to combine the --line-item-highlight-color and the
       --selection-background-color than to just invent another unique color. */
    --line-item-highlight-selection-color: #f6f4d0;
    --chip-selected-background-color: var(--blue-50);
    --edit-mode-background-color: #ebf5fb;
    --emphasis-color: #fff9c4;
    --hover-background-color: rgba(161, 194, 250, 0.2);
    --disabled-button-background-color: var(--disabled-background);
    --selection-background-color: rgba(161, 194, 250, 0.1);
    --tooltip-background-color: var(--gray-900);
    --section-header-background-color: var(--blue-50);
    --gr-autogrow-textarea-disabled-color: lightgrey;

    /* dashboard size background colors */
    --dashboard-size-xs: var(--gray-200);
    --dashboard-size-s: var(--gray-300);
    --dashboard-size-m: var(--gray-400);
    --dashboard-size-l: var(--gray-500);
    --dashboard-size-xl: var(--gray-700);
    --dashboard-size-text: black;
    --dashboard-size-xs-text: black;
    --dashboard-size-xl-text: white;

    /* comment background colors */
    --comment-background-color: var(--gray-200);
    --unresolved-comment-background-color: #fef7e0;


    /* Suggest edits */
    --user-suggestion-header-background: var(--gray-700);
    --user-suggestion-header-color: white;

    /* vote background colors */
    --vote-color-approved: var(--green-300);
    --vote-color-disliked: var(--red-50);
    --vote-outline-disliked: var(--red-700);
    --vote-color-neutral: var(--gray-300);
    --vote-color-recommended: var(--green-50);
    --vote-outline-recommended: var(--green-700);
    --vote-color-rejected: var(--red-300);

    /* vote chip background colors */
    --vote-chip-unselected-outline-color: var(--gray-500);
    --vote-chip-unselected-color: white;
    --vote-chip-selected-positive-color: var(--green-300);
    --vote-chip-selected-neutral-color: var(--gray-300);
    --vote-chip-selected-negative-color: var(--red-300);
    --vote-chip-unselected-text-color: black;
    --vote-chip-selected-text-color: black;

    --outline-color-focus: var(--gray-900);

    /* misc colors */
    --border-color: var(--gray-300);
    --input-focus-border-color: var(--blue-800);
    --comment-separator-color: var(--gray-300);
    --comment-quote-marker-color: var(--gray-500);

    /* checks tag colors */
    --tag-gray: var(--gray-200);
    --tag-yellow: var(--yellow-50);
    --tag-pink: var(--pink-50);
    --tag-purple: var(--purple-50);
    --tag-cyan: var(--cyan-50);
    --tag-brown: var(--brown-50);

    /* status colors */
    --status-merged: var(--gray-700);
    --status-abandoned: var(--gray-700);
    --status-wip: #795548;
    --status-private: var(--purple-500);
    --status-conflict: var(--red-600);
    --status-revert: var(--gray-900);
    --status-revert-created: #e64a19;
    --status-active: var(--yellow-700);
    --status-ready: var(--green-700);
    --status-custom: var(--purple-900);

    /* file status colors */
    --file-status-font-color: black;
    --file-status-added: var(--green-300);
    --file-status-deleted: var(--red-200);
    --file-status-modified: var(--gray-300);
    --file-status-renamed: var(--orange-300);
    --file-status-unchanged: var(--gray-300);
    --file-status-reverted: var(--gray-300);

    /* fonts */
    --font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI',
      Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
      'Segoe UI Symbol';
    --header-font-family: 'Open Sans', 'Roboto', -apple-system,
      BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif,
      'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
    --monospace-font-family: 'Roboto Mono', 'SF Mono', 'Lucida Console', Monaco,
      monospace;
    --font-size-code: 12px; /* 12px mono */
    --font-size-mono: 0.929rem; /* 13px mono */
    --font-size-small: 0.857rem; /* 12px */
    --font-size-normal: 1rem; /* 14px */
    --font-size-h3: 1.143rem; /* 16px */
    --font-size-h2: 1.29rem; /* 18px */
    --font-size-h1: 1.57rem; /* 22px */
    --line-height-mono: 1.286rem; /* 18px */
    --line-height-small: 1.143rem; /* 16px */
    --line-height-normal: 1.429rem; /* 20px */
    --line-height-h3: 1.715rem; /* 24px */
    --line-height-h2: 2rem; /* 28px */
    --line-height-h1: 2.286rem; /* 32px */
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-bold: 700;
    --font-weight-h1: 500;
    --font-weight-h2: 500;
    --font-weight-h3: 400;
    --font-weight-h4: 600;
    --context-control-button-font: var(--font-weight-normal)
      var(--font-size-normal) var(--font-family);
    --code-hint-font-weight: 500;
    --image-diff-button-font: var(--font-weight-normal) var(--font-size-normal)
      var(--font-family);

    /* spacing */
    --spacing-xxs: 1px;
    --spacing-xs: 2px;
    --spacing-s: 4px;
    --spacing-m: 8px;
    --spacing-l: 12px;
    --spacing-xl: 16px;
    --spacing-xxl: 24px;

    /* header and footer */
    --footer-background-color: transparent;
    --footer-border-top: none;
    --header-background-color: var(--background-color-tertiary);
    --header-border-bottom: 1px solid var(--border-color);
    --header-border-image: '';
    --header-box-shadow: none;
    --header-padding: 0 var(--spacing-l);
    --header-icon-size: 0em;
    --header-icon: none;
    --header-text-color: black;
    --header-title-content: 'Gerrit';
    --header-title-font-size: 1.75rem;

    /* diff colors */
    --dark-add-highlight-color: #aaf2aa;
    --light-add-highlight-color: #d8fed8;
    --dark-remove-highlight-color: #ffcdd2;
    --light-remove-highlight-color: #ffebee;

    --dark-rebased-add-highlight-color: #d7d7f9;
    --light-rebased-add-highlight-color: #eef;
    --dark-rebased-remove-highlight-color: #f7e8b7;
    --light-rebased-remove-highlight-color: #fff8dc;

    --diff-moved-in-background: var(--cyan-50);
    --diff-moved-in-label-color: var(--cyan-900);
    --diff-moved-out-background: var(--purple-50);
    --diff-moved-out-label-color: var(--purple-900);

    --diff-blank-background-color: var(--background-color-secondary);
    --diff-context-control-background-color: #fff7d4;
    --diff-context-control-border-color: #f6e6a5;
    --diff-context-control-color: var(--default-button-text-color);
    --diff-highlight-range-color: rgba(255, 220, 0, 0.5);
    --diff-highlight-range-hover-color: rgba(255, 190, 0, 0.5);
    --diff-selection-background-color: #c7dbf9;
    --diff-tab-indicator-color: var(--deemphasized-text-color);
    --diff-trailing-whitespace-indicator: #ff9ad2;
    --focused-line-outline-color: var(--blue-700);
    --coverage-covered-line-num-color: var(--deemphasized-text-color);
    --coverage-covered: var(--cyan-100);
    --coverage-not-covered: var(--orange-100);
    --ranged-comment-hint-text-color: var(--orange-900);
    --token-highlighting-color: #fffd54;

    /* syntax colors */
    --syntax-attr-color: #219;
    --syntax-attribute-color: var(--primary-text-color);
    --syntax-built_in-color: #30a;
    --syntax-bullet-color: var(--syntax-keyword-color);
    --syntax-code-color: var(--syntax-literal-color);
    --syntax-comment-color: #3f7f5f;
    --syntax-default-color: var(--primary-text-color);
    --syntax-doctag-weight: bold;
    --syntax-emphasis-color: var(--primary-text-color);
    --syntax-emphasis-style: italic;
    --syntax-emphasis-weight: normal;
    --syntax-formula-color: var(--syntax-regexp-color);
    --syntax-function-color: var(--primary-text-color);
    --syntax-keyword-color: #9e0069;
    --syntax-link-color: #219;
    --syntax-literal-color: #219;
    --syntax-meta-color: #ff1717;
    --syntax-meta-keyword-color: #219;
    --syntax-number-color: #164;
    --syntax-params-color: var(--primary-text-color);
    --syntax-property-color: var(--primary-text-color);
    --syntax-quote-color: var(--primary-text-color);
    --syntax-regexp-color: #fa8602;
    --syntax-section-color: var(--syntax-keyword-color);
    --syntax-section-style: normal;
    --syntax-section-weight: bold;
    --syntax-selector-attr-color: #fa8602;
    --syntax-selector-class-color: #164;
    --syntax-selector-id-color: #2a00ff;
    --syntax-selector-pseudo-color: #fa8602;
    --syntax-string-color: #2a00ff;
    --syntax-strong-color: var(--primary-text-color);
    --syntax-strong-style: normal;
    --syntax-strong-weight: bold;
    --syntax-tag-color: #170;
    --syntax-template-tag-color: #fa8602;
    --syntax-template-variable-color: #0000c0;
    --syntax-title-color: #0000c0;
    --syntax-title-function-color: var(--syntax-title-color);
    --syntax-type-color: var(--blue-700);
    --syntax-variable-color: var(--primary-text-color);
    --syntax-variable-language-color: var(--syntax-built_in-color);

    /* elevation */
    --elevation-level-1: 0px 1px 2px 0px rgba(60, 64, 67, 0.3),
      0px 1px 3px 1px rgba(60, 64, 67, 0.15);
    --elevation-level-2: 0px 1px 2px 0px rgba(60, 64, 67, 0.3),
      0px 2px 6px 2px rgba(60, 64, 67, 0.15);
    --elevation-level-3: 0px 1px 3px 0px rgba(60, 64, 67, 0.3),
      0px 4px 8px 3px rgba(60, 64, 67, 0.15);
    --elevation-level-4: 0px 2px 3px 0px rgba(60, 64, 67, 0.3),
      0px 6px 10px 4px rgba(60, 64, 67, 0.15);
    --elevation-level-5: 0px 4px 4px 0px rgba(60, 64, 67, 0.3),
      0px 8px 12px 6px rgba(60, 64, 67, 0.15);

    /* misc */
    --border-radius: 4px;
    --line-length-indicator-color: #681da8;

    /* md-filled-card (colours originate from paper-card) */
    --card-surface-container-highest: #f8f9fa;

    /* md-checkbox (colours from paper-checkbox but adapted using material/web theme selector) */
    --checkbox-primary: #273a9f;
    --checkbox-on-primary: #ffffff;
    --checkbox-on-surface: #1a1b22;
    --checkbox-on-surface-variant: #3f4948;

    /* md-radio (similar to md-checkbox above) */
    --radio-primary: #273a9f;
    --radio-on-primary: #ffffff;
    --radio-on-surface: #1a1b22;
    --radio-on-surface-variant: #3f4948;

    /* md-filled-select/md-outlined-select (colour originates from paper-listbox but generated by material-web using the hex */
    --select-surface-container: #f8f9fa;
    --select-surface-container-highest: #f8f9fa;
    --select-on-surface: #1c1b1b;
    --select-on-surface-variant: #444749;
    --select-primary: #5c5f60;
    --select-secondary-container: #e5e3e3;
    --select-on-secondary-container: #484949;

    /* md-switch (colour originates from paper-toggle-button but generated by material-web using the hex */
    --switch-color-surface-container-highest: #e0e2ea;
    --switch-color-on-surface: #181c22;
    --switch-color-on-surface-variant: #404752;
    --switch-color-outline: #707783;
    --switch-color-primary: #005290;
    --switch-color-on-primary: #ffffff;
    --switch-color-primary-container: #d7e2ff;
    --switch-color-on-primary-container: #ffffff;
    --switch-disabled-track-color: #000;
  }
  @media screen and (max-width: 50em) {
    html {
      --spacing-xxs: 1px;
      --spacing-xs: 1px;
      --spacing-s: 2px;
      --spacing-m: 4px;
      --spacing-l: 8px;
      --spacing-xl: 12px;
      --spacing-xxl: 16px;
    }
  }
`,md=document.createElement("style");md.setAttribute("id","light-theme"),ud(md,gd),document.head.appendChild(md);const fd=pd`
  /* prettier formatter removes semi-colons after css mixins. */
  /* prettier-ignore */
  html {
    --paper-tooltip: {
      font-size: var(--font-size-small);
    };
  }
`,vd=document.createElement("custom-style"),bd=document.createElement("style");ud(bd,fd),vd.appendChild(bd),document.head.appendChild(vd);const yd=pd`
  html {
    /**
       * Sections and variables must stay consistent with app-theme.js.
       *
       * Only modify color variables in this theme file. dark-theme extends
       * app-theme, so there is no need to repeat all variables, but for colors
       * it does make sense to list them all: If you override one color, then
       * you probably want to override all.
       */

    --error-foreground: var(--red-200);
    --error-background: var(--red-tonal);
    --error-background-hover: linear-gradient(var(--white-04), var(--white-04)),
      var(--red-tonal);
    --error-background-focus: linear-gradient(var(--white-12), var(--white-12)),
      var(--red-tonal);
    --error-ripple: var(--white-10);

    --code-review-warning-background: var(--blue-tonal);

    --warning-foreground: var(--orange-200);
    --warning-background: var(--orange-tonal);
    --warning-background-hover: linear-gradient(
        var(--white-04),
        var(--white-04)
      ),
      var(--orange-tonal);
    --warning-background-focus: linear-gradient(
        var(--white-12),
        var(--white-12)
      ),
      var(--orange-tonal);
    --warning-ripple: var(--white-10);

    --info-foreground: var(--blue-200);
    --info-background: var(--blue-tonal);
    --info-background-hover: linear-gradient(var(--white-04), var(--white-04)),
      var(--blue-tonal);
    --info-background-focus: linear-gradient(var(--white-12), var(--white-12)),
      var(--blue-tonal);
    --info-ripple: var(--white-10);

    --primary-button-text-color: black;
    --primary-button-background-color: var(--gerrit-blue-dark);
    --primary-button-background-hover: var(--blue-200-16);
    --primary-button-background-focus: var(--blue-200-24);

    --selected-foreground: var(--blue-200);
    --selected-background: var(--blue-900);
    --selected-chip-background: var(--blue-300-24);

    --success-foreground: var(--green-200);
    --success-background: var(--green-tonal);
    --success-background-hover: linear-gradient(
        var(--white-04),
        var(--white-04)
      ),
      var(--green-tonal);
    --success-background-focus: linear-gradient(
        var(--white-12),
        var(--white-12)
      ),
      var(--green-tonal);
    --success-ripple: var(--white-10);

    --gray-foreground: var(--gray-300);
    --gray-background: var(--gray-tonal);
    --gray-background-hover: linear-gradient(var(--white-04), var(--white-04)),
      var(--gray-tonal);
    --gray-background-focus: linear-gradient(var(--white-12), var(--white-12)),
      var(--gray-tonal);
    --gray-ripple: var(--white-10);

    --disabled-foreground: var(--gray-200-38);
    --disabled-background: var(--gray-200-12);

    --chip-color: var(--gray-100);
    --error-color: var(--red-200);
    --tag-background: var(--cyan-900);
    --label-background: var(--red-900);

    --not-working-hours-icon-background-color: var(--purple-tonal);
    --not-working-hours-icon-color: var(--purple-100);
    --unavailability-icon-color: var(--gray-500);
    --unavailability-chip-icon-color: var(--orange-700);
    --unavailability-chip-background-color: var(--orange-tonal);

    /* text colors */
    --primary-text-color: var(--gray-200);
    --link-color: var(--gerrit-blue-dark);
    --comment-text-color: var(--primary-text-color);
    --deemphasized-text-color: var(--gray-400);
    --default-button-text-color: var(--gerrit-blue-dark);
    --chip-selected-text-color: var(--blue-100);
    --error-text-color: var(--red-200);
    /* Used on text color for change list doesn't need user's attention. */
    --reviewed-text-color: var(--gray-300);
    --vote-text-color: black;
    --status-text-color: black;
    --tooltip-text-color: var(--gray-900);
    --tooltip-button-text-color: var(--gerrit-blue-light);
    --negative-red-text-color: var(--red-200);
    --positive-green-text-color: var(--green-200);
    --indirect-relation-text-color: var(--green-200);

    /* background colors */
    /* primary background colors */
    --background-color-primary: var(--gray-900);
    --background-color-secondary: #2f3034;
    --background-color-tertiary: var(--gray-800);
    /* directly derived from primary background colors */
    /*   empty, because inheriting from app-theme is just fine
      /* unique background colors */
    --line-item-highlight-color: #3a361c;
    --line-item-highlight-selection-color: #423e24;
    --chip-selected-background-color: #3c4455;
    --edit-mode-background-color: #5c0a36;
    --emphasis-color: #383f4a;
    --hover-background-color: rgba(161, 194, 250, 0.2);
    --disabled-button-background-color: #484a4d;
    --selection-background-color: rgba(161, 194, 250, 0.1);
    --tooltip-background-color: var(--gray-200);
    --section-header-background-color: var(--blue-tonal);
    --gr-autogrow-textarea-disabled-color: #6c6c6c;

    /* comment background colors */
    --comment-background-color: #3c3f43;
    --unresolved-comment-background-color: #614a19;

    /* Suggest edits */
    --user-suggestion-header-background: var(--gray-700);
    --user-suggestion-header-color: white;

    /* vote background colors */
    --vote-color-approved: var(--green-300);
    --vote-color-disliked: var(--red-tonal);
    --vote-outline-disliked: var(--red-200);
    --vote-color-neutral: var(--gray-700);
    --vote-color-recommended: var(--green-tonal);
    --vote-outline-recommended: var(--green-200);
    --vote-color-rejected: var(--red-200);

    /* vote chip background colors */
    --vote-chip-unselected-outline-color: var(--gray-500);
    --vote-chip-unselected-color: var(--grey-800);
    --vote-chip-selected-positive-color: var(--green-200);
    --vote-chip-selected-neutral-color: var(--gray-300);
    --vote-chip-selected-negative-color: var(--red-200);
    --vote-chip-unselected-text-color: white;
    --vote-chip-selected-text-color: black;

    --outline-color-focus: var(--gray-100);

    /* misc colors */
    --border-color: var(--gray-700);
    --input-focus-border-color: var(--blue-200);
    --comment-separator-color: var(--border-color);

    /* checks tag colors */
    --tag-gray: var(--gray-tonal);
    --tag-yellow: var(--yellow-tonal);
    --tag-pink: var(--pink-tonal);
    --tag-purple: var(--purple-tonal);
    --tag-cyan: var(--cyan-tonal);
    --tag-brown: var(--brown-tonal);

    /* status colors */
    --status-merged: #a4a4a4;
    --status-abandoned: var(--gray-300);
    --status-wip: #bcaaa4;
    --status-private: var(--purple-200);
    --status-conflict: var(--red-300);
    --status-revert: var(--gray-200);
    --status-revert-created: #ff8a65;
    --status-active: #f4ce5d;
    --status-ready: #55c374;
    --status-custom: var(--purple-400);

    /* file status colors */
    --file-status-added: var(--green-400);
    --file-status-deleted: var(--red-300);
    --file-status-modified: var(--gray-500);
    --file-status-renamed: var(--orange-400);
    --file-status-unchanged: var(--gray-500);
    --file-status-reverted: var(--gray-500);

    /* fonts */

    /* spacing */

    /* header and footer */
    --footer-background-color: var(--background-color-tertiary);
    --footer-border-top: 1px solid var(--border-color);
    --header-background-color: var(--background-color-tertiary);
    --header-border-bottom: 1px solid var(--border-color);
    --header-padding: 0 var(--spacing-l);
    --header-text-color: var(--primary-text-color);

    /* dashboard size background colors */
    --dashboard-size-xs: var(--gray-700);
    --dashboard-size-s: var(--gray-500);
    --dashboard-size-m: var(--gray-400);
    --dashboard-size-l: var(--gray-300);
    --dashboard-size-xl: var(--gray-200);
    --dashboard-size-text: black;
    --dashboard-size-xs-text: white;
    --dashboard-size-xl-text: black;

    /* diff colors */
    --dark-add-highlight-color: var(--green-tonal);
    --light-add-highlight-color: #182b1f;
    --dark-remove-highlight-color: #62110f;
    --light-remove-highlight-color: #320404;

    --dark-rebased-add-highlight-color: var(--deep-purple-800);
    --light-rebased-add-highlight-color: var(--deep-purple-600);
    --dark-rebased-remove-highlight-color: rgba(255, 139, 6, 0.15);
    --light-rebased-remove-highlight-color: #2f3f2f;

    --diff-moved-in-background: #1d4042;
    --diff-moved-in-label-color: var(--cyan-50);
    --diff-moved-out-background: #230e34;
    --diff-moved-out-label-color: var(--purple-50);

    --diff-blank-background-color: var(--background-color-secondary);
    --diff-context-control-background-color: #333311;
    --diff-context-control-border-color: var(--border-color);
    --diff-context-control-color: var(--deemphasized-text-color);
    --diff-highlight-range-color: rgba(0, 100, 200, 0.5);
    --diff-highlight-range-hover-color: rgba(0, 150, 255, 0.5);
    --diff-selection-background-color: #3a71d8;
    --diff-tab-indicator-color: var(--deemphasized-text-color);
    --diff-trailing-whitespace-indicator: #ff9ad2;
    --focused-line-outline-color: var(--blue-200);
    --coverage-covered: var(--cyan-tonal);
    --coverage-covered-line-num-color: var(--gray-200);
    --coverage-not-covered: var(--orange-tonal);
    --ranged-comment-hint-text-color: var(--blue-50);
    --token-highlighting-color: var(--yellow-tonal);

    /* syntax colors */
    --syntax-attr-color: #80cbbf;
    --syntax-attribute-color: var(--primary-text-color);
    --syntax-built_in-color: #f7c369;
    --syntax-comment-color: var(--deemphasized-text-color);
    --syntax-default-color: var(--primary-text-color);
    --syntax-doctag-weight: bold;
    --syntax-function-color: var(--primary-text-color);
    --syntax-keyword-color: #cd4cf0;
    --syntax-link-color: #c792ea;
    --syntax-literal-color: #eefff7;
    --syntax-meta-color: #6d7eee;
    --syntax-meta-keyword-color: #eefff7;
    --syntax-number-color: #00998a;
    --syntax-params-color: var(--primary-text-color);
    --syntax-property-color: #c792ea;
    --syntax-regexp-color: #f77669;
    --syntax-selector-attr-color: #80cbbf;
    --syntax-selector-class-color: #ffcb68;
    --syntax-selector-id-color: #f77669;
    --syntax-selector-pseudo-color: #c792ea;
    --syntax-string-color: #c3e88d;
    --syntax-tag-color: #f77669;
    --syntax-template-tag-color: #c792ea;
    --syntax-template-variable-color: #f77669;
    --syntax-title-color: #75a5ff;
    --syntax-title-function-color: var(--syntax-title-color);
    --syntax-type-color: #dd5f5f;
    --syntax-variable-color: #f77669;
    --syntax-variable-language-color: var(--syntax-built_in-color);

    /* misc */
    --line-length-indicator-color: #d7aefb;

    /* rules applied to html */
    background-color: var(--view-background-color);

    /* md-filled-card (colours originate from paper-card) */
    --card-surface-container-highest: #2f3034;

    /* md-checkbox (colours from paper-checkbox but adapted using material/web theme selector) */
    --checkbox-primary: #bac3ff;
    --checkbox-on-primary: #08218a;
    --checkbox-on-surface: #e3e1ea;
    --checkbox-on-surface-variant: #c5c5d4;

  /* These colours come from paper-checkbox */
    --radio-primary: #bac3ff;
    --radio-on-primary: #08218a;
    --radio-on-surface: #e3e1ea;
    --radio-on-surface-variant: #c5c5d4;

    /* md-filled-select/md-outlined-select (colour originates from paper-listbox but generated by material-web using the hex */
    --select-surface-container: #201f20;
    --select-surface-container-highest: #2f3034;
    --select-on-surface: #e5e2e1;
    --select-on-surface-variant: #c7c6cb;
    --select-primary: #c7c6cb;
    --select-secondary-container: #3d3d3f;
    --select-on-secondary-container: #d2d0d2;
    --switch-disabled-track-color: #000;

    /* md-menu/md-menu-itme/md-focus-ring */
    --gr-dropdown-focus-ring-color: #c8c6c7;

    /* md-switch (colour originates from paper-toggle-button but generated by material-web using the hex */
    --switch-color-surface-container-highest: #000000;
    --switch-color-on-surface: #e0e2ea;
    --switch-color-on-surface-variant: #c0c7d4;
    --switch-color-outline: #8a919e;
    --switch-color-primary: #a2c9ff;
    --switch-color-on-primary: #00315b;
    --switch-color-primary-container: #0077ce;
    --switch-color-on-primary-container: #ffffff;

    /* md-tabs */
    --tabs-color-on-surface: #e1e2e6;
  }
`,wd=globalThis,_d=wd.ShadowRoot&&(void 0===wd.ShadyCSS||wd.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,xd=Symbol(),Cd=new WeakMap;let Ed=class{constructor(e,t,i){if(this._$cssResult$=!0,i!==xd)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(_d&&void 0===e){const i=void 0!==t&&1===t.length;i&&(e=Cd.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&Cd.set(t,e))}return e}toString(){return this.cssText}};const Sd=(e,...t)=>{const i=1===e.length?e[0]:t.reduce(((t,i,r)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+e[r+1]),e[0]);return new Ed(i,e,xd)},$d=_d?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return(e=>new Ed("string"==typeof e?e:e+"",void 0,xd))(t)})(e):e,{is:kd,defineProperty:Ad,getOwnPropertyDescriptor:Rd,getOwnPropertyNames:Td,getOwnPropertySymbols:Id,getPrototypeOf:Pd}=Object,Nd=globalThis,Od=Nd.trustedTypes,Dd=Od?Od.emptyScript:"",Ld=Nd.reactiveElementPolyfillSupport,Md=(e,t)=>e,Fd={toAttribute(e,t){switch(t){case Boolean:e=e?Dd:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let i=e;switch(t){case Boolean:i=null!==e;break;case Number:i=null===e?null:Number(e);break;case Object:case Array:try{i=JSON.parse(e)}catch(e){i=null}}return i}},Ud=(e,t)=>!kd(e,t),Bd={attribute:!0,type:String,converter:Fd,reflect:!1,useDefault:!1,hasChanged:Ud};Symbol.metadata??=Symbol("metadata"),Nd.litPropertyMetadata??=new WeakMap;let Hd=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=Bd){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const i=Symbol(),r=this.getPropertyDescriptor(e,i,t);void 0!==r&&Ad(this.prototype,e,r)}}static getPropertyDescriptor(e,t,i){const{get:r,set:o}=Rd(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:r,set(t){const s=r?.call(this);o?.call(this,t),this.requestUpdate(e,s,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Bd}static _$Ei(){if(this.hasOwnProperty(Md("elementProperties")))return;const e=Pd(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Md("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Md("properties"))){const e=this.properties,t=[...Td(e),...Id(e)];for(const i of t)this.createProperty(i,e[i])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,i]of t)this.elementProperties.set(e,i)}this._$Eh=new Map;for(const[e,t]of this.elementProperties){const i=this._$Eu(e,t);void 0!==i&&this._$Eh.set(i,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const e of i)t.unshift($d(e))}else void 0!==e&&t.push($d(e));return t}static _$Eu(e,t){const i=t.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const i of t.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{if(_d)e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet));else for(const i of t){const t=document.createElement("style"),r=wd.litNonce;void 0!==r&&t.setAttribute("nonce",r),t.textContent=i.cssText,e.appendChild(t)}})(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$ET(e,t){const i=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,i);if(void 0!==r&&!0===i.reflect){const o=(void 0!==i.converter?.toAttribute?i.converter:Fd).toAttribute(t,i.type);this._$Em=e,null==o?this.removeAttribute(r):this.setAttribute(r,o),this._$Em=null}}_$AK(e,t){const i=this.constructor,r=i._$Eh.get(e);if(void 0!==r&&this._$Em!==r){const e=i.getPropertyOptions(r),o="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:Fd;this._$Em=r;const s=o.fromAttribute(t,e.type);this[r]=s??this._$Ej?.get(r)??s,this._$Em=null}}requestUpdate(e,t,i){if(void 0!==e){const r=this.constructor,o=this[e];if(i??=r.getPropertyOptions(e),!((i.hasChanged??Ud)(o,t)||i.useDefault&&i.reflect&&o===this._$Ej?.get(e)&&!this.hasAttribute(r._$Eu(e,i))))return;this.C(e,t,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,{useDefault:i,reflect:r,wrapped:o},s){i&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,s??t??this[e]),!0!==o||void 0!==s)||(this._$AL.has(e)||(this.hasUpdated||i||(t=void 0),this._$AL.set(e,t)),!0===r&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,i]of e){const{wrapped:e}=i,r=this[t];!0!==e||this._$AL.has(t)||void 0===r||this.C(t,void 0,i,r)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach((e=>e.hostUpdate?.())),this.update(t)):this._$EM()}catch(t){throw e=!1,this._$EM(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach((e=>e.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((e=>this._$ET(e,this[e]))),this._$EM()}updated(e){}firstUpdated(e){}};Hd.elementStyles=[],Hd.shadowRootOptions={mode:"open"},Hd[Md("elementProperties")]=new Map,Hd[Md("finalized")]=new Map,Ld?.({ReactiveElement:Hd}),(Nd.reactiveElementVersions??=[]).push("2.1.1");const jd=globalThis,Gd=jd.trustedTypes,zd=Gd?Gd.createPolicy("lit-html",{createHTML:e=>e}):void 0,Vd="$lit$",Wd=`lit$${Math.random().toFixed(9).slice(2)}$`,qd="?"+Wd,Kd=`<${qd}>`,Yd=document,Xd=()=>Yd.createComment(""),Jd=e=>null===e||"object"!=typeof e&&"function"!=typeof e,Qd=Array.isArray,Zd=e=>Qd(e)||"function"==typeof e?.[Symbol.iterator],ec="[ \t\n\f\r]",tc=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,ic=/-->/g,rc=/>/g,oc=RegExp(`>|${ec}(?:([^\\s"'>=/]+)(${ec}*=${ec}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),sc=/'/g,nc=/"/g,ac=/^(?:script|style|textarea|title)$/i,lc=e=>(t,...i)=>({_$litType$:e,strings:t,values:i}),dc=lc(1),cc=lc(2),hc=lc(3),pc=Symbol.for("lit-noChange"),uc=Symbol.for("lit-nothing"),gc=new WeakMap,mc=Yd.createTreeWalker(Yd,129);function fc(e,t){if(!Qd(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==zd?zd.createHTML(t):t}const vc=(e,t)=>{const i=e.length-1,r=[];let o,s=2===t?"<svg>":3===t?"<math>":"",n=tc;for(let t=0;t<i;t++){const i=e[t];let a,l,d=-1,c=0;for(;c<i.length&&(n.lastIndex=c,l=n.exec(i),null!==l);)c=n.lastIndex,n===tc?"!--"===l[1]?n=ic:void 0!==l[1]?n=rc:void 0!==l[2]?(ac.test(l[2])&&(o=RegExp("</"+l[2],"g")),n=oc):void 0!==l[3]&&(n=oc):n===oc?">"===l[0]?(n=o??tc,d=-1):void 0===l[1]?d=-2:(d=n.lastIndex-l[2].length,a=l[1],n=void 0===l[3]?oc:'"'===l[3]?nc:sc):n===nc||n===sc?n=oc:n===ic||n===rc?n=tc:(n=oc,o=void 0);const h=n===oc&&e[t+1].startsWith("/>")?" ":"";s+=n===tc?i+Kd:d>=0?(r.push(a),i.slice(0,d)+Vd+i.slice(d)+Wd+h):i+Wd+(-2===d?t:h)}return[fc(e,s+(e[i]||"<?>")+(2===t?"</svg>":3===t?"</math>":"")),r]};class bc{constructor({strings:e,_$litType$:t},i){let r;this.parts=[];let o=0,s=0;const n=e.length-1,a=this.parts,[l,d]=vc(e,t);if(this.el=bc.createElement(l,i),mc.currentNode=this.el.content,2===t||3===t){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(r=mc.nextNode())&&a.length<n;){if(1===r.nodeType){if(r.hasAttributes())for(const e of r.getAttributeNames())if(e.endsWith(Vd)){const t=d[s++],i=r.getAttribute(e).split(Wd),n=/([.?@])?(.*)/.exec(t);a.push({type:1,index:o,name:n[2],strings:i,ctor:"."===n[1]?Cc:"?"===n[1]?Ec:"@"===n[1]?Sc:xc}),r.removeAttribute(e)}else e.startsWith(Wd)&&(a.push({type:6,index:o}),r.removeAttribute(e));if(ac.test(r.tagName)){const e=r.textContent.split(Wd),t=e.length-1;if(t>0){r.textContent=Gd?Gd.emptyScript:"";for(let i=0;i<t;i++)r.append(e[i],Xd()),mc.nextNode(),a.push({type:2,index:++o});r.append(e[t],Xd())}}}else if(8===r.nodeType)if(r.data===qd)a.push({type:2,index:o});else{let e=-1;for(;-1!==(e=r.data.indexOf(Wd,e+1));)a.push({type:7,index:o}),e+=Wd.length-1}o++}}static createElement(e,t){const i=Yd.createElement("template");return i.innerHTML=e,i}}function yc(e,t,i=e,r){if(t===pc)return t;let o=void 0!==r?i._$Co?.[r]:i._$Cl;const s=Jd(t)?void 0:t._$litDirective$;return o?.constructor!==s&&(o?._$AO?.(!1),void 0===s?o=void 0:(o=new s(e),o._$AT(e,i,r)),void 0!==r?(i._$Co??=[])[r]=o:i._$Cl=o),void 0!==o&&(t=yc(e,o._$AS(e,t.values),o,r)),t}let wc=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:i}=this._$AD,r=(e?.creationScope??Yd).importNode(t,!0);mc.currentNode=r;let o=mc.nextNode(),s=0,n=0,a=i[0];for(;void 0!==a;){if(s===a.index){let t;2===a.type?t=new _c(o,o.nextSibling,this,e):1===a.type?t=new a.ctor(o,a.name,a.strings,this,e):6===a.type&&(t=new $c(o,this,e)),this._$AV.push(t),a=i[++n]}s!==a?.index&&(o=mc.nextNode(),s++)}return mc.currentNode=Yd,r}p(e){let t=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}};class _c{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,i,r){this.type=2,this._$AH=uc,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=yc(this,e,t),Jd(e)?e===uc||null==e||""===e?(this._$AH!==uc&&this._$AR(),this._$AH=uc):e!==this._$AH&&e!==pc&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):Zd(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==uc&&Jd(this._$AH)?this._$AA.nextSibling.data=e:this.T(Yd.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:i}=e,r="number"==typeof i?this._$AC(e):(void 0===i.el&&(i.el=bc.createElement(fc(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===r)this._$AH.p(t);else{const e=new wc(r,this),i=e.u(this.options);e.p(t),this.T(i),this._$AH=e}}_$AC(e){let t=gc.get(e.strings);return void 0===t&&gc.set(e.strings,t=new bc(e)),t}k(e){Qd(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,r=0;for(const o of e)r===t.length?t.push(i=new _c(this.O(Xd()),this.O(Xd()),this,this.options)):i=t[r],i._$AI(o),r++;r<t.length&&(this._$AR(i&&i._$AB.nextSibling,r),t.length=r)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class xc{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,i,r,o){this.type=1,this._$AH=uc,this._$AN=void 0,this.element=e,this.name=t,this._$AM=r,this.options=o,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=uc}_$AI(e,t=this,i,r){const o=this.strings;let s=!1;if(void 0===o)e=yc(this,e,t,0),s=!Jd(e)||e!==this._$AH&&e!==pc,s&&(this._$AH=e);else{const r=e;let n,a;for(e=o[0],n=0;n<o.length-1;n++)a=yc(this,r[i+n],t,n),a===pc&&(a=this._$AH[n]),s||=!Jd(a)||a!==this._$AH[n],a===uc?e=uc:e!==uc&&(e+=(a??"")+o[n+1]),this._$AH[n]=a}s&&!r&&this.j(e)}j(e){e===uc?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Cc extends xc{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===uc?void 0:e}}class Ec extends xc{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==uc)}}class Sc extends xc{constructor(e,t,i,r,o){super(e,t,i,r,o),this.type=5}_$AI(e,t=this){if((e=yc(this,e,t,0)??uc)===pc)return;const i=this._$AH,r=e===uc&&i!==uc||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,o=e!==uc&&(i===uc||r);r&&this.element.removeEventListener(this.name,this,i),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class $c{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){yc(this,e)}}const kc={M:Vd,P:Wd,A:qd,C:1,L:vc,R:wc,D:Zd,V:yc,I:_c,H:xc,N:Ec,U:Sc,B:Cc,F:$c},Ac=jd.litHtmlPolyfillSupport;Ac?.(bc,_c),(jd.litHtmlVersions??=[]).push("3.3.1");const Rc=(e,t,i)=>{const r=i?.renderBefore??t;let o=r._$litPart$;if(void 0===o){const e=i?.renderBefore??null;r._$litPart$=o=new _c(t.insertBefore(Xd(),e),e,void 0,i??{})}return o._$AI(e),o},Tc=globalThis;let Ic=class extends Hd{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Rc(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return pc}};Ic._$litElement$=!0,Ic.finalized=!0,Tc.litElementHydrateSupport?.({LitElement:Ic});const Pc=Tc.litElementPolyfillSupport;Pc?.({LitElement:Ic}),(Tc.litElementVersions??=[]).push("4.2.1");const Nc=Sd`
  /* CSS reset */

  html,
  body,
  button,
  div,
  span,
  applet,
  object,
  iframe,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  p,
  blockquote,
  pre,
  a,
  abbr,
  acronym,
  address,
  big,
  cite,
  code,
  del,
  dfn,
  em,
  img,
  ins,
  kbd,
  q,
  s,
  samp,
  small,
  strike,
  strong,
  sub,
  sup,
  tt,
  var,
  b,
  u,
  i,
  center,
  dl,
  dt,
  dd,
  ol,
  ul,
  li,
  fieldset,
  form,
  label,
  legend,
  table,
  caption,
  tbody,
  tfoot,
  thead,
  tr,
  th,
  td,
  article,
  aside,
  canvas,
  details,
  embed,
  figure,
  figcaption,
  footer,
  header,
  hgroup,
  main,
  menu,
  nav,
  output,
  ruby,
  section,
  summary,
  time,
  mark,
  audio,
  video {
    border: 0;
    box-sizing: border-box;
    font-size: 100%;
    font: inherit;
    margin: 0;
    padding: 0;
    vertical-align: baseline;
  }
  *::after,
  *::before {
    box-sizing: border-box;
  }
  a {
    color: var(--link-color);
  }
  textarea,
  select,
  button {
    font: inherit;
  }
  ol,
  ul {
    list-style: none;
  }
  blockquote,
  q {
    quotes: none;
  }
  blockquote:before,
  blockquote:after,
  q:before,
  q:after {
    content: '';
    content: none;
  }
  table {
    border-collapse: collapse;
    border-spacing: 0;
  }

  /* Stopgap solution until we remove hidden$ attributes. */

  :host([hidden]),
  [hidden] {
    display: none !important;
  }
  .separator {
    border-left: 1px solid var(--border-color);
    height: 20px;
    margin: 0 8px;
  }
  .separator.transparent {
    border-color: transparent;
  }

  /**
   * TODO: Remove these rules and change (plugin) users to rely on
   * gr-spinner-styles directly.
   */
  /** BEGIN: loading spiner */
  .loadingSpin {
    border: 2px solid var(--disabled-button-background-color);
    border-top: 2px solid var(--primary-button-background-color);
    border-radius: 50%;
    width: 10px;
    height: 10px;
    animation: spin 2s linear infinite;
    margin-right: var(--spacing-s);
  }
  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
  /** END: loading spiner */
`,Oc=document.createElement("template");Oc.innerHTML=`<dom-module id="shared-styles">\n  <template>\n    <style>\n    ${Nc.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(Oc.content);const Dc=e=>(t,i)=>{void 0!==i?i.addInitializer((()=>{customElements.define(e,t)})):customElements.define(e,t)},Lc={attribute:!0,type:String,converter:Fd,reflect:!1,hasChanged:Ud},Mc=(e=Lc,t,i)=>{const{kind:r,metadata:o}=i;let s=globalThis.litPropertyMetadata.get(o);if(void 0===s&&globalThis.litPropertyMetadata.set(o,s=new Map),"setter"===r&&((e=Object.create(e)).wrapped=!0),s.set(i.name,e),"accessor"===r){const{name:r}=i;return{set(i){const o=t.get.call(this);t.set.call(this,i),this.requestUpdate(r,o,e)},init(t){return void 0!==t&&this.C(r,void 0,e,t),t}}}if("setter"===r){const{name:r}=i;return function(i){const o=this[r];t.call(this,i),this.requestUpdate(r,o,e)}}throw Error("Unsupported decorator location: "+r)};function Fc(e){return(t,i)=>"object"==typeof i?Mc(e,t,i):((e,t,i)=>{const r=t.hasOwnProperty(i);return t.constructor.createProperty(i,e),r?Object.getOwnPropertyDescriptor(t,i):void 0})(e,t,i)}function Uc(e){return Fc({...e,state:!0,attribute:!1})}const Bc=(e,t,i)=>(i.configurable=!0,i.enumerable=!0,Reflect.decorate&&"object"!=typeof t&&Object.defineProperty(e,t,i),i);function Hc(e,t){return(i,r,o)=>{const s=t=>t.renderRoot?.querySelector(e)??null;if(t){const{get:e,set:t}="object"==typeof r?i:o??(()=>{const e=Symbol();return{get(){return this[e]},set(t){this[e]=t}}})();return Bc(i,r,{get(){let i=e.call(this);return void 0===i&&(i=s(this),(null!==i||this.hasUpdated)&&t.call(this,i)),i}})}return Bc(i,r,{get(){return s(this)}})}}let jc;function Gc(e){return(t,i)=>Bc(t,i,{get(){return(this.renderRoot??(jc??=document.createDocumentFragment())).querySelectorAll(e)}})}function zc(e){return(t,i)=>Bc(t,i,{async get(){return await this.updateComplete,this.renderRoot?.querySelector(e)??null}})}function Vc(e){return(t,i)=>{const{slot:r,selector:o}=e??{},s="slot"+(r?`[name=${r}]`:":not([name])");return Bc(t,i,{get(){const t=this.renderRoot?.querySelector(s),i=t?.assignedElements(e)??[];return void 0===o?i:i.filter((e=>e.matches(o)))}})}}function Wc(e){return(t,i)=>{const{slot:r}=e??{},o="slot"+(r?`[name=${r}]`:":not([name])");return Bc(t,i,{get(){const t=this.renderRoot?.querySelector(o);return t?.assignedNodes(e)??[]}})}}var qc=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let Kc=class extends Ic{static get styles(){return[Sd`
        :host {
          /* Fallback rule for color */
          color: var(--deemphasized-text-color);
          font-family: var(--icon-font-family, 'Material Symbols Outlined');
          font-weight: normal;
          font-style: normal;
          font-size: 20px;
          line-height: 1;
          letter-spacing: normal;
          text-transform: none;
          display: inline-block;
          white-space: nowrap;
          word-wrap: normal;
          direction: ltr;
          font-feature-settings: 'liga';
          -webkit-font-feature-settings: 'liga';
          -webkit-font-smoothing: antialiased;
          font-variation-settings: 'FILL' 0;
          vertical-align: top;
        }
        :host([small]) {
          font-size: 16px;
          position: relative;
          top: 2px;
        }
        :host([filled]) {
          font-variation-settings: 'FILL' 1;
        }
        /* This is the trick such that the name of the icon doesn't appear in
         * search
         */
        :host::before {
          content: attr(icon);
        }
      `]}render(){return dc``}};qc([Fc({type:String,reflect:!0})],Kc.prototype,"icon",void 0),qc([Fc({type:Boolean,reflect:!0})],Kc.prototype,"filled",void 0),Kc=qc([Dc("gr-icon")],Kc);const Yc=Sd`
  .loadingSpin {
    border: 2px solid var(--disabled-button-background-color);
    border-top: 2px solid var(--primary-button-background-color);
    border-radius: 50%;
    width: 10px;
    height: 10px;
    animation: spin 2s linear infinite;
    margin-right: var(--spacing-s);
  }
  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
`,Xc=document.createElement("template");Xc.innerHTML=`<dom-module id="gr-spinner-styles">\n  <template>\n    <style>\n      ${Yc.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(Xc.content);const Jc=Sd`
  .voteChip {
    border: 1px solid var(--border-color);
    /* max rounded */
    border-radius: 1em;
    box-shadow: none;
    box-sizing: border-box;
    min-width: 3em;
    color: var(--vote-text-color);
  }
`,Qc=document.createElement("template");Qc.innerHTML=`<dom-module id="gr-voting-styles">\n  <template>\n    <style>\n    ${Jc.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(Qc.content);const Zc=e=>(...t)=>({_$litDirective$:e,values:t});let eh=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,i){this._$Ct=e,this._$AM=t,this._$Ci=i}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}};const th=Zc(class extends eh{constructor(e){if(super(e),1!==e.type||"class"!==e.name||e.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,[t]){if(void 0===this.st){this.st=new Set,void 0!==e.strings&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter((e=>""!==e))));for(const e in t)t[e]&&!this.nt?.has(e)&&this.st.add(e);return this.render(t)}const i=e.element.classList;for(const e of this.st)e in t||(i.remove(e),this.st.delete(e));for(const e in t){const r=!!t[e];r===this.st.has(e)||this.nt?.has(e)||(r?(i.add(e),this.st.add(e)):(i.remove(e),this.st.delete(e)))}return pc}});var ih=function(e,t){return ih=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},ih(e,t)};function rh(e,t){function i(){this.constructor=e}ih(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function oh(e){return"function"==typeof e}var sh=!1,nh={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,sh=e},get useDeprecatedSynchronousErrorHandling(){return sh}};function ah(e){setTimeout((function(){throw e}),0)}var lh={closed:!0,next:function(e){},error:function(e){if(nh.useDeprecatedSynchronousErrorHandling)throw e;ah(e)},complete:function(){}},dh=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function ch(e){return null!==e&&"object"==typeof e}var hh=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),ph=hh,uh=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var i=this,r=i._parentOrParents,o=i._ctorUnsubscribe,s=i._unsubscribe,n=i._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var a=0;a<r.length;++a)r[a].remove(this);if(oh(s)){o&&(this._unsubscribe=void 0);try{s.call(this)}catch(e){t=e instanceof ph?gh(e.errors):[e]}}if(dh(n)){a=-1;for(var l=n.length;++a<l;){var d=n[a];if(ch(d))try{d.unsubscribe()}catch(e){t=t||[],e instanceof ph?t=t.concat(gh(e.errors)):t.push(e)}}}if(t)throw new ph(t)}},e.prototype.add=function(t){var i=t;if(!t)return e.EMPTY;switch(typeof t){case"function":i=new e(t);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof e)){var r=i;(i=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=i._parentOrParents;if(null===o)i._parentOrParents=this;else if(o instanceof e){if(o===this)return i;i._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return i;o.push(this)}var s=this._subscriptions;return null===s?this._subscriptions=[i]:s.push(i),i},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function gh(e){return e.reduce((function(e,t){return e.concat(t instanceof ph?t.errors:t)}),[])}var mh=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),fh=function(e){function t(i,r,o){var s=e.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=lh;break;case 1:if(!i){s.destination=lh;break}if("object"==typeof i){i instanceof t?(s.syncErrorThrowable=i.syncErrorThrowable,s.destination=i,i.add(s)):(s.syncErrorThrowable=!0,s.destination=new vh(s,i));break}default:s.syncErrorThrowable=!0,s.destination=new vh(s,i,r,o)}return s}return rh(t,e),t.prototype[mh]=function(){return this},t.create=function(e,i,r){var o=new t(e,i,r);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(uh),vh=function(e){function t(t,i,r,o){var s,n=e.call(this)||this;n._parentSubscriber=t;var a=n;return oh(i)?s=i:i&&(s=i.next,r=i.error,o=i.complete,i!==lh&&(oh((a=Object.create(i)).unsubscribe)&&n.add(a.unsubscribe.bind(a)),a.unsubscribe=n.unsubscribe.bind(n))),n._context=a,n._next=s,n._error=r,n._complete=o,n}return rh(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;nh.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,i=nh.useDeprecatedSynchronousErrorHandling;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):ah(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;ah(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var i=function(){return e._complete.call(e._context)};nh.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,i),this.unsubscribe()):(this.__tryOrUnsub(i),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),nh.useDeprecatedSynchronousErrorHandling)throw e;ah(e)}},t.prototype.__tryOrSetError=function(e,t,i){if(!nh.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(t){return nh.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(ah(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(fh);var bh=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function yh(e){return e}var wh=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var i=new e;return i.source=this,i.operator=t,i},e.prototype.subscribe=function(e,t,i){var r=this.operator,o=function(e,t,i){if(e){if(e instanceof fh)return e;if(e[mh])return e[mh]()}return e||t||i?new fh(e,t,i):new fh(lh)}(e,t,i);if(r?o.add(r.call(o,this.source)):o.add(this.source||nh.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),nh.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){nh.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,i=t.closed,r=t.destination,o=t.isStopped;if(i||o)return!1;e=r&&r instanceof fh?r:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var i=this;return new(t=_h(t))((function(t,r){var o;o=i.subscribe((function(t){try{e(t)}catch(e){r(e),o&&o.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[bh]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:(0===(i=e).length?yh:1===i.length?i[0]:function(e){return i.reduce((function(e,t){return t(e)}),e)})(this);var i},e.prototype.toPromise=function(e){var t=this;return new(e=_h(e))((function(e,i){var r;t.subscribe((function(e){return r=e}),(function(e){return i(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function _h(e){if(e||(e=nh.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var xh=function(e){return function(t){for(var i=0,r=e.length;i<r&&!t.closed;i++)t.next(e[i]);t.complete()}};function Ch(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var Eh=Ch(),Sh=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function $h(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var kh=function(e){if(e&&"function"==typeof e[bh])return i=e,function(e){var t=i[bh]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(Sh(e))return xh(e);if($h(e))return function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,ah),t}}(e);if(e&&"function"==typeof e[Eh])return t=e,function(e){for(var i=t[Eh]();;){var r=void 0;try{r=i.next()}catch(t){return e.error(t),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof i.return&&e.add((function(){i.return&&i.return()})),e};var t,i,r=ch(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+r+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},Ah=function(e){function t(t){var i=e.call(this)||this;return i.parent=t,i}return rh(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(fh),Rh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return rh(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(fh);function Th(e,t){if(!t.closed){if(e instanceof wh)return e.subscribe(t);var i;try{i=kh(e)(t)}catch(e){t.error(e)}return i}}var Ih=function(e){function t(t,i){return e.call(this)||this}return rh(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(uh),Ph=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.scheduler=t,r.work=i,r.pending=!1,r}return rh(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,i){return void 0===i&&(i=0),setInterval(e.flush.bind(e,this),i)},t.prototype.recycleAsyncId=function(e,t,i){if(void 0===i&&(i=0),null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var i=!1,r=void 0;try{this.work(e)}catch(e){i=!0,r=!!e&&e||new Error(e)}if(i)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(Ih),Nh=function(){function e(t,i){void 0===i&&(i=e.now),this.SchedulerAction=t,this.now=i}return e.prototype.schedule=function(e,t,i){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(i,t)},e.now=function(){return Date.now()},e}(),Oh=function(e){function t(i,r){void 0===r&&(r=Nh.now);var o=e.call(this,i,(function(){return t.delegate&&t.delegate!==o?t.delegate.now():r()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return rh(t,e),t.prototype.schedule=function(i,r,o){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(i,r,o):e.prototype.schedule.call(this,i,r,o)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}},t}(Nh),Dh=new Oh(Ph);function Lh(e){return!dh(e)&&e-parseFloat(e)+1>=0}function Mh(e){return e&&"function"==typeof e.schedule}function Fh(e,t,i){void 0===e&&(e=0);var r=-1;return Lh(t)?r=Number(t)<1?1:Number(t):Mh(t)&&(i=t),Mh(i)||(i=Dh),new wh((function(t){var o=Lh(e)?e:+e-i.now();return i.schedule(Uh,o,{index:0,period:r,subscriber:t})}))}function Uh(e){var t=e.index,i=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===i)return r.complete();e.index=t+1,this.schedule(e,i)}}var Bh=function(e){function t(t,i,r){var o=e.call(this)||this;return o.parent=t,o.outerValue=i,o.outerIndex=r,o.index=0,o}return rh(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(fh);function Hh(e,t,i,r,o){if(void 0===o&&(o=new Bh(e,i,r)),!o.closed)return t instanceof wh?t.subscribe(o):kh(t)(o)}var jh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return rh(t,e),t.prototype.notifyNext=function(e,t,i,r,o){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(fh);function Gh(e){return function(t){var i=new zh(e),r=t.lift(i);return i.caught=r}}var zh=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new Vh(e,this.selector,this.caught))},e}(),Vh=function(e){function t(t,i,r){var o=e.call(this,t)||this;return o.selector=i,o.caught=r,o}return rh(t,e),t.prototype.error=function(t){if(!this.isStopped){var i=void 0;try{i=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var r=new Ah(this);this.add(r);var o=Th(i,r);o!==r&&this.add(o)}},t}(Rh);function Wh(e,t){return new wh((function(i){var r=new uh,o=0;return r.add(t.schedule((function(){o!==e.length?(i.next(e[o++]),i.closed||r.add(this.schedule())):i.complete()}))),r}))}function qh(e,t){return t?Wh(e,t):new wh(xh(e))}var Kh={};function Yh(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=void 0,r=void 0;return Mh(e[e.length-1])&&(r=e.pop()),"function"==typeof e[e.length-1]&&(i=e.pop()),1===e.length&&dh(e[0])&&(e=e[0]),qh(e,r).lift(new Xh(i))}var Xh=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Jh(e,this.resultSelector))},e}(),Jh=function(e){function t(t,i){var r=e.call(this,t)||this;return r.resultSelector=i,r.active=0,r.values=[],r.observables=[],r}return rh(t,e),t.prototype._next=function(e){this.values.push(Kh),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var i=0;i<t;i++){var r=e[i];this.add(Hh(this,r,void 0,i))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,i){var r=this.values,o=r[i],s=this.toRespond?o===Kh?--this.toRespond:this.toRespond:0;r[i]=t,0===s&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(jh);function Qh(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[bh]}(e))return function(e,t){return new wh((function(i){var r=new uh;return r.add(t.schedule((function(){var o=e[bh]();r.add(o.subscribe({next:function(e){r.add(t.schedule((function(){return i.next(e)})))},error:function(e){r.add(t.schedule((function(){return i.error(e)})))},complete:function(){r.add(t.schedule((function(){return i.complete()})))}}))}))),r}))}(e,t);if($h(e))return function(e,t){return new wh((function(i){var r=new uh;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){i.next(e),r.add(t.schedule((function(){return i.complete()})))})))}),(function(e){r.add(t.schedule((function(){return i.error(e)})))}))}))),r}))}(e,t);if(Sh(e))return Wh(e,t);if(function(e){return e&&"function"==typeof e[Eh]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new wh((function(i){var r,o=new uh;return o.add((function(){r&&"function"==typeof r.return&&r.return()})),o.add(t.schedule((function(){r=e[Eh](),o.add(t.schedule((function(){if(!i.closed){var e,t;try{var o=r.next();e=o.value,t=o.done}catch(e){return void i.error(e)}t?i.complete():(i.next(e),this.schedule())}})))}))),o}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof wh?e:new wh(kh(e))}function Zh(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e[e.length-1];return Mh(i)?(e.pop(),Wh(e,i)):qh(e)}function ep(e,t){return function(i){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new tp(e,t))}}var tp=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new ip(e,this.project,this.thisArg))},e}(),ip=function(e){function t(t,i,r){var o=e.call(this,t)||this;return o.project=i,o.count=0,o.thisArg=r||o,o}return rh(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(fh);function rp(e,t,i){return void 0===i&&(i=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(rp((function(i,r){return Qh(e(i,r)).pipe(ep((function(e,o){return t(i,e,r,o)})))}),i))}:("number"==typeof t&&(i=t),function(t){return t.lift(new op(e,i))})}var op=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new sp(e,this.project,this.concurrent))},e}(),sp=function(e){function t(t,i,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var o=e.call(this,t)||this;return o.project=i,o.concurrent=r,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return rh(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,i=this.index++;try{t=this.project(e,i)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new Ah(this),i=this.destination;i.add(t);var r=Th(e,t);r!==t&&i.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(Rh);function np(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),rp(yh,e)}function ap(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return np(1)(Zh.apply(void 0,e))}function lp(e,t){return void 0===t&&(t=Dh),function(i){return i.lift(new dp(e,t))}}var dp=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new cp(e,this.dueTime,this.scheduler))},e}(),cp=function(e){function t(t,i,r){var o=e.call(this,t)||this;return o.dueTime=i,o.scheduler=r,o.debouncedSubscription=null,o.lastValue=null,o.hasValue=!1,o}return rh(t,e),t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(hp,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(fh);function hp(e){e.debouncedNext()}function pp(e){return e instanceof Date&&!isNaN(+e)}var up,gp=new wh((function(e){return e.complete()}));function mp(e){return e?function(e){return new wh((function(t){return e.schedule((function(){return t.complete()}))}))}(e):gp}function fp(e,t){return new wh(t?function(i){return t.schedule(vp,0,{error:e,subscriber:i})}:function(t){return t.error(e)})}function vp(e){var t=e.error;e.subscriber.error(t)}up||(up={});var bp=function(){function e(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}},e.prototype.accept=function(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)},e.prototype.toObservable=function(){switch(this.kind){case"N":return Zh(this.value);case"E":return fp(this.error);case"C":return mp()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),yp=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new wp(e,this.delay,this.scheduler))},e}(),wp=function(e){function t(t,i,r){var o=e.call(this,t)||this;return o.delay=i,o.scheduler=r,o.queue=[],o.active=!1,o.errored=!1,o}return rh(t,e),t.dispatch=function(e){for(var t=e.source,i=t.queue,r=e.scheduler,o=e.destination;i.length>0&&i[0].time-r.now()<=0;)i.shift().notification.observe(o);if(i.length>0){var s=Math.max(0,i[0].time-r.now());this.schedule(e,s)}else this.unsubscribe(),t.active=!1},t.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,i=new _p(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(bp.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(bp.createComplete()),this.unsubscribe()},t}(fh),_p=function(){return function(e,t){this.time=e,this.notification=t}}();function xp(e,t){return function(i){return i.lift(new Cp(e,t))}}var Cp=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new Ep(e,this.compare,this.keySelector))},e}(),Ep=function(e){function t(t,i,r){var o=e.call(this,t)||this;return o.keySelector=r,o.hasKey=!1,"function"==typeof i&&(o.compare=i),o}return rh(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var i=this.keySelector;t=i?i(e):e}catch(e){return this.destination.error(e)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))},t}(fh),Sp=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}();function $p(e,t){return function(i){return i.lift(new kp(e,t))}}var kp=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Ap(e,this.predicate,this.thisArg))},e}(),Ap=function(e){function t(t,i,r){var o=e.call(this,t)||this;return o.predicate=i,o.thisArg=r,o.count=0,o}return rh(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(fh);function Rp(e){return function(t){return 0===e?mp():t.lift(new Tp(e))}}var Tp=function(){function e(e){if(this.total=e,this.total<0)throw new Sp}return e.prototype.call=function(e,t){return t.subscribe(new Ip(e,this.total))},e}(),Ip=function(e){function t(t,i){var r=e.call(this,t)||this;return r.total=i,r.count=0,r}return rh(t,e),t.prototype._next=function(e){var t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))},t}(fh),Pp=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),Np=function(e){function t(t,i){var r=e.call(this)||this;return r.subject=t,r.subscriber=i,r.closed=!1,r}return rh(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}},t}(uh),Op=function(e){function t(t){var i=e.call(this,t)||this;return i.destination=t,i}return rh(t,e),t}(fh),Dp=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return rh(t,e),t.prototype[mh]=function(){return new Op(this)},t.prototype.lift=function(e){var t=new Lp(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new Pp;if(!this.isStopped)for(var t=this.observers,i=t.length,r=t.slice(),o=0;o<i;o++)r[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new Pp;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,i=t.length,r=t.slice(),o=0;o<i;o++)r[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new Pp;this.isStopped=!0;for(var e=this.observers,t=e.length,i=e.slice(),r=0;r<t;r++)i[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new Pp;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new Pp;return this.hasError?(e.error(this.thrownError),uh.EMPTY):this.isStopped?(e.complete(),uh.EMPTY):(this.observers.push(e),new Np(this,e))},t.prototype.asObservable=function(){var e=new wh;return e.source=this,e},t.create=function(e,t){return new Lp(e,t)},t}(wh),Lp=function(e){function t(t,i){var r=e.call(this)||this;return r.destination=t,r.source=i,r}return rh(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):uh.EMPTY},t}(Dp),Mp=function(e){function t(t,i,r){void 0===r&&(r=0);var o=e.call(this,t)||this;return o.scheduler=i,o.delay=r,o}return rh(t,e),t.dispatch=function(e){var t=e.notification,i=e.destination;t.observe(i),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new Fp(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(bp.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(bp.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(bp.createComplete()),this.unsubscribe()},t}(fh),Fp=function(){return function(e,t){this.notification=e,this.destination=t}}(),Up=function(e){function t(t){var i=e.call(this)||this;return i._value=t,i}return rh(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var i=e.prototype._subscribe.call(this,t);return i&&!i.closed&&t.next(this._value),i},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Pp;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Dp),Bp=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.scheduler=t,r.work=i,r}return rh(t,e),t.prototype.schedule=function(t,i){return void 0===i&&(i=0),i>0?e.prototype.schedule.call(this,t,i):(this.delay=i,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,i){return i>0||this.closed?e.prototype.execute.call(this,t,i):this._execute(t,i)},t.prototype.requestAsyncId=function(t,i,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,i,r):t.flush(this)},t}(Ph),Hp=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return rh(t,e),t}(Oh))(Bp),jp=function(e){function t(t,i,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===i&&(i=Number.POSITIVE_INFINITY);var o=e.call(this)||this;return o.scheduler=r,o._events=[],o._infiniteTimeWindow=!1,o._bufferSize=t<1?1:t,o._windowTime=i<1?1:i,i===Number.POSITIVE_INFINITY?(o._infiniteTimeWindow=!0,o.next=o.nextInfiniteTimeWindow):o.next=o.nextTimeWindow,o}return rh(t,e),t.prototype.nextInfiniteTimeWindow=function(t){if(!this.isStopped){var i=this._events;i.push(t),i.length>this._bufferSize&&i.shift()}e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this.isStopped||(this._events.push(new Gp(this._getNow(),t)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,i=this._infiniteTimeWindow,r=i?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,s=r.length;if(this.closed)throw new Pp;if(this.isStopped||this.hasError?t=uh.EMPTY:(this.observers.push(e),t=new Np(this,e)),o&&e.add(e=new Mp(e,o)),i)for(var n=0;n<s&&!e.closed;n++)e.next(r[n]);else for(n=0;n<s&&!e.closed;n++)e.next(r[n].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||Hp).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,o=r.length,s=0;s<o&&!(e-r[s].time<i);)s++;return o>t&&(s=Math.max(s,o-t)),s>0&&r.splice(0,s),r},t}(Dp),Gp=function(){return function(e,t){this.time=e,this.value=t}}();function zp(e,t,i){var r;return r=e&&"object"==typeof e?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:i},function(e){return e.lift(function(e){var t,i,r=e.bufferSize,o=void 0===r?Number.POSITIVE_INFINITY:r,s=e.windowTime,n=void 0===s?Number.POSITIVE_INFINITY:s,a=e.refCount,l=e.scheduler,d=0,c=!1,h=!1;return function(e){var r;d++,!t||c?(c=!1,t=new jp(o,n,l),r=t.subscribe(this),i=e.subscribe({next:function(e){t.next(e)},error:function(e){c=!0,t.error(e)},complete:function(){h=!0,i=void 0,t.complete()}}),h&&(i=void 0)):r=t.subscribe(this),this.add((function(){d--,r.unsubscribe(),r=void 0,i&&!h&&a&&0===d&&(i.unsubscribe(),i=void 0,t=void 0)}))}}(r))}}function Vp(e,t){return"function"==typeof t?function(i){return i.pipe(Vp((function(i,r){return Qh(e(i,r)).pipe(ep((function(e,o){return t(i,e,r,o)})))})))}:function(t){return t.lift(new Wp(e))}}var Wp=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new qp(e,this.project))},e}(),qp=function(e){function t(t,i){var r=e.call(this,t)||this;return r.project=i,r.index=0,r}return rh(t,e),t.prototype._next=function(e){var t,i=this.index++;try{t=this.project(e,i)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var i=new Ah(this),r=this.destination;r.add(i),this.innerSubscription=Th(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(Rh),Kp=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var i=new Yp(e),r=Th(this.notifier,new Ah(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i},e}(),Yp=function(e){function t(t){var i=e.call(this,t)||this;return i.seenValue=!1,i}return rh(t,e),t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(Rh),Xp=function(){function e(e,t){this.predicate=e,this.inclusive=t}return e.prototype.call=function(e,t){return t.subscribe(new Jp(e,this.predicate,this.inclusive))},e}(),Jp=function(e){function t(t,i,r){var o=e.call(this,t)||this;return o.predicate=i,o.inclusive=r,o.index=0,o}return rh(t,e),t.prototype._next=function(e){var t,i=this.destination;try{t=this.predicate(e,this.index++)}catch(e){return void i.error(e)}this.nextOrComplete(e,t)},t.prototype.nextOrComplete=function(e,t){var i=this.destination;Boolean(t)?i.next(e):(this.inclusive&&i.next(e),i.complete())},t}(fh);function Qp(){}function Zp(e,t,i){return function(r){return r.lift(new eu(e,t,i))}}var eu=function(){function e(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}return e.prototype.call=function(e,t){return t.subscribe(new tu(e,this.nextOrObserver,this.error,this.complete))},e}(),tu=function(e){function t(t,i,r,o){var s=e.call(this,t)||this;return s._tapNext=Qp,s._tapError=Qp,s._tapComplete=Qp,s._tapError=r||Qp,s._tapComplete=o||Qp,oh(i)?(s._context=s,s._tapNext=i):i&&(s._context=i,s._tapNext=i.next||Qp,s._tapError=i.error||Qp,s._tapComplete=i.complete||Qp),s}return rh(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(fh),iu={leading:!0,trailing:!1},ru=function(){function e(e,t,i,r){this.duration=e,this.scheduler=t,this.leading=i,this.trailing=r}return e.prototype.call=function(e,t){return t.subscribe(new ou(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),ou=function(e){function t(t,i,r,o,s){var n=e.call(this,t)||this;return n.duration=i,n.scheduler=r,n.leading=o,n.trailing=s,n._hasTrailingValue=!1,n._trailingValue=null,n}return rh(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(su,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(fh);function su(e){e.subscriber.clearThrottle()}var nu=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),au=function(){function e(e,t,i,r){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=i,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new lu(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),lu=function(e){function t(t,i,r,o,s){var n=e.call(this,t)||this;return n.absoluteTimeout=i,n.waitFor=r,n.withObservable=o,n.scheduler=s,n.scheduleTimeout(),n}return rh(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(Th(t,new Ah(e)))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},t}(Rh);function du(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var i;"function"==typeof e[e.length-1]&&(i=e.pop());var r=e;return t.lift(new uu(r,i))}}var cu,hu,pu,uu=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new gu(e,this.observables,this.project))},e}(),gu=function(e){function t(t,i,r){var o=e.call(this,t)||this;o.observables=i,o.project=r,o.toRespond=[];var s=i.length;o.values=new Array(s);for(var n=0;n<s;n++)o.toRespond.push(n);for(n=0;n<s;n++){var a=i[n];o.add(Hh(o,a,void 0,n))}return o}return rh(t,e),t.prototype.notifyNext=function(e,t,i){this.values[i]=t;var r=this.toRespond;if(r.length>0){var o=r.indexOf(i);-1!==o&&r.splice(o,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(jh);function mu(e){return Symbol(e)}!function(e){e.DOC_ONLY="DOC_ONLY",e.GO_KEY="GO_KEY",e.V_KEY="V_KEY"}(cu||(cu={})),function(e){e.ACTIONS="Actions",e.DIFFS="Diffs",e.EVERYWHERE="Global Shortcuts",e.FILE_LIST="File list",e.NAVIGATION="Navigation",e.REPLY_DIALOG="Reply dialog"}(hu||(hu={})),function(e){e.OPEN_SHORTCUT_HELP_DIALOG="OPEN_SHORTCUT_HELP_DIALOG",e.GO_TO_USER_DASHBOARD="GO_TO_USER_DASHBOARD",e.GO_TO_OPENED_CHANGES="GO_TO_OPENED_CHANGES",e.GO_TO_MERGED_CHANGES="GO_TO_MERGED_CHANGES",e.GO_TO_ABANDONED_CHANGES="GO_TO_ABANDONED_CHANGES",e.GO_TO_WATCHED_CHANGES="GO_TO_WATCHED_CHANGES",e.GO_TO_REPOS="GO_TO_REPOS",e.GO_TO_GROUPS="GO_TO_GROUPS",e.CURSOR_NEXT_CHANGE="CURSOR_NEXT_CHANGE",e.CURSOR_PREV_CHANGE="CURSOR_PREV_CHANGE",e.OPEN_CHANGE="OPEN_CHANGE",e.NEXT_PAGE="NEXT_PAGE",e.PREV_PAGE="PREV_PAGE",e.TOGGLE_CHANGE_STAR="TOGGLE_CHANGE_STAR",e.REFRESH_CHANGE_LIST="REFRESH_CHANGE_LIST",e.OPEN_SUBMIT_DIALOG="OPEN_SUBMIT_DIALOG",e.TOGGLE_ATTENTION_SET="TOGGLE_ATTENTION_SET",e.OPEN_REPLY_DIALOG="OPEN_REPLY_DIALOG",e.OPEN_DOWNLOAD_DIALOG="OPEN_DOWNLOAD_DIALOG",e.OPEN_COPY_LINKS_DROPDOWN="OPEN_COPY_LINKS_DROPDOWN",e.EXPAND_ALL_MESSAGES="EXPAND_ALL_MESSAGES",e.COLLAPSE_ALL_MESSAGES="COLLAPSE_ALL_MESSAGES",e.UP_TO_DASHBOARD="UP_TO_DASHBOARD",e.UP_TO_CHANGE="UP_TO_CHANGE",e.TOGGLE_DIFF_MODE="TOGGLE_DIFF_MODE",e.REFRESH_CHANGE="REFRESH_CHANGE",e.EDIT_TOPIC="EDIT_TOPIC",e.DIFF_AGAINST_BASE="DIFF_AGAINST_BASE",e.DIFF_AGAINST_LATEST="DIFF_AGAINST_LATEST",e.DIFF_BASE_AGAINST_LEFT="DIFF_BASE_AGAINST_LEFT",e.DIFF_RIGHT_AGAINST_LATEST="DIFF_RIGHT_AGAINST_LATEST",e.DIFF_BASE_AGAINST_LATEST="DIFF_BASE_AGAINST_LATEST",e.NEXT_LINE="NEXT_LINE",e.PREV_LINE="PREV_LINE",e.VISIBLE_LINE="VISIBLE_LINE",e.NEXT_CHUNK="NEXT_CHUNK",e.PREV_CHUNK="PREV_CHUNK",e.TOGGLE_ALL_DIFF_CONTEXT="TOGGLE_ALL_DIFF_CONTEXT",e.NEXT_COMMENT_THREAD="NEXT_COMMENT_THREAD",e.PREV_COMMENT_THREAD="PREV_COMMENT_THREAD",e.EXPAND_ALL_COMMENT_THREADS="EXPAND_ALL_COMMENT_THREADS",e.COLLAPSE_ALL_COMMENT_THREADS="COLLAPSE_ALL_COMMENT_THREADS",e.LEFT_PANE="LEFT_PANE",e.RIGHT_PANE="RIGHT_PANE",e.TOGGLE_LEFT_PANE="TOGGLE_LEFT_PANE",e.NEW_COMMENT="NEW_COMMENT",e.SAVE_COMMENT="SAVE_COMMENT",e.OPEN_DIFF_PREFS="OPEN_DIFF_PREFS",e.TOGGLE_DIFF_REVIEWED="TOGGLE_DIFF_REVIEWED",e.NEXT_FILE="NEXT_FILE",e.PREV_FILE="PREV_FILE",e.NEXT_FILE_WITH_COMMENTS="NEXT_FILE_WITH_COMMENTS",e.PREV_FILE_WITH_COMMENTS="PREV_FILE_WITH_COMMENTS",e.NEXT_UNREVIEWED_FILE="NEXT_UNREVIEWED_FILE",e.CURSOR_NEXT_FILE="CURSOR_NEXT_FILE",e.CURSOR_PREV_FILE="CURSOR_PREV_FILE",e.OPEN_FILE="OPEN_FILE",e.TOGGLE_FILE_REVIEWED="TOGGLE_FILE_REVIEWED",e.TOGGLE_ALL_INLINE_DIFFS="TOGGLE_ALL_INLINE_DIFFS",e.TOGGLE_INLINE_DIFF="TOGGLE_INLINE_DIFF",e.TOGGLE_HIDE_ALL_COMMENT_THREADS_AND_CODE_POINTERS="TOGGLE_HIDE_ALL_COMMENT_THREADS_AND_CODE_POINTERS",e.TOGGLE_HIDE_CHECK_CODE_POINTERS="TOGGLE_HIDE_CHECK_CODE_POINTERS",e.OPEN_FILE_LIST="OPEN_FILE_LIST",e.OPEN_FIRST_FILE="OPEN_FIRST_FILE",e.OPEN_LAST_FILE="OPEN_LAST_FILE",e.SEARCH="SEARCH",e.EMOJI_DROPDOWN="EMOJI_DROPDOWN",e.MENTIONS_DROPDOWN="MENTIONS_DROPDOWN",e.TOGGLE_BLAME="TOGGLE_BLAME",e.TOGGLE_CHECKBOX="TOGGLE_CHECKBOX"}(pu||(pu={}));const fu=Symbol("providers"),vu=Symbol("resolvers");function bu(e,t,i){const r=e[fu]||=new Map,o=r.get(t);o&&(e.removeController(o),o.hostDisconnected());const s=new Eu(e,t,i);r.set(t,s),e.addController(s)}function yu(e,t){const i=e[vu]||=new Map;let r=i.get(t);if(!r){const o=new Cu(e,t);e.addController(o),r=()=>o.get(),i.set(t,r)}return r}class wu extends Event{constructor(e,t){super("request-dependency",{bubbles:!0,composed:!0}),this.dependency=e,this.callback=t}}class _u extends Error{constructor(e,t){super(t),this.dependency=e}}function xu(e,t){const i=t.description,r=e.tagName;return new _u(t,`Could not resolve dependency '${i}' in '${r}'`)}class Cu{constructor(e,t){this.host=e,this.dependency=t}get(){if(!this.provider)throw xu(this.host,this.dependency);return this.provider()}hostConnected(){if(this.provider=void 0,this.host.dispatchEvent(new wu(this.dependency,(e=>{this.provider=e}))),!this.provider)throw xu(this.host,this.dependency)}}class Eu{constructor(e,t,i){this.host=e,this.dependency=t,this.provider=i,this.fullfill=e=>{e.dependency===this.dependency&&(e.stopPropagation(),e.preventDefault(),e.callback(this.provider))}}hostConnected(){this.host.addEventListener("request-dependency",this.fullfill)}hostDisconnected(){this.host.removeEventListener("request-dependency",this.fullfill)}}var Su,$u,ku;!function(e){e.SIDE_BY_SIDE="SIDE_BY_SIDE",e.UNIFIED="UNIFIED_DIFF"}(Su||(Su={})),function(e){e.LEFT="left",e.RIGHT="right"}($u||($u={})),function(e){e.COVERED="COVERED",e.NOT_COVERED="NOT_COVERED",e.PARTIALLY_COVERED="PARTIALLY_COVERED",e.NOT_INSTRUMENTED="NOT_INSTRUMENTED"}(ku||(ku={}));const Au="FILE",Ru="LOST";var Tu,Iu,Pu,Nu,Ou,Du,Lu,Mu,Fu,Uu,Bu,Hu,ju,Gu,zu,Vu,Wu,qu,Ku,Yu;function Xu(e){return!!e.values}!function(e){e.ABOVE="above",e.BELOW="below",e.BLOCK_ABOVE="block-above",e.BLOCK_BELOW="block-below",e.ALL="all"}(Tu||(Tu={})),function(e){e.ADD="add",e.BOTH="both",e.BLANK="blank",e.REMOVE="remove"}(Iu||(Iu={})),function(e){e.OPENID="OPENID",e.OPENID_SSO="OPENID_SSO",e.OAUTH="OAUTH",e.HTTP="HTTP",e.HTTP_LDAP="HTTP_LDAP",e.CLIENT_SSL_CERT_LDAP="CLIENT_SSL_CERT_LDAP",e.LDAP="LDAP",e.LDAP_BIND="LDAP_BIND",e.CUSTOM_EXTENSION="CUSTOM_EXTENSION",e.DEVELOPMENT_BECOME_ANY_ACCOUNT="DEVELOPMENT_BECOME_ANY_ACCOUNT"}(Pu||(Pu={})),function(e){e.ABANDONED="ABANDONED",e.MERGED="MERGED",e.NEW="NEW"}(Nu||(Nu={})),function(e){e.STRING="STRING",e.INT="INT",e.LONG="LONG",e.BOOLEAN="BOOLEAN",e.LIST="LIST",e.ARRAY="ARRAY"}(Ou||(Ou={})),function(e){e.USERNAME="USERNAME",e.FIRST_NAME="FIRST_NAME",e.FULL_NAME="FULL_NAME"}(Du||(Du={})),function(e){e.FULL_NAME="FULL_NAME",e.USER_NAME="USER_NAME",e.REGISTER_NEW_EMAIL="REGISTER_NEW_EMAIL"}(Lu||(Lu={})),function(e){e.ADDED="A",e.DELETED="D",e.RENAMED="R",e.COPIED="C",e.REWRITTEN="W",e.MODIFIED="M",e.UNMODIFIED="U",e.REVERTED="X"}(Mu||(Mu={})),function(e){e.BAD="BAD",e.OK="OK",e.TRUSTED="TRUSTED"}(Fu||(Fu={})),function(e){e.HEAD="HEAD",e.POST="POST",e.GET="GET",e.DELETE="DELETE",e.PUT="PUT"}(Uu||(Uu={})),function(e){e.TRUE="TRUE",e.FALSE="FALSE",e.INHERIT="INHERIT"}(Bu||(Bu={})),function(e){e.API_REF_UPDATED_AND_CHANGE_REINDEX="API_REF_UPDATED_AND_CHANGE_REINDEX",e.REF_UPDATED_AND_CHANGE_REINDEX="REF_UPDATED_AND_CHANGE_REINDEX",e.NEVER="NEVER"}(Hu||(Hu={})),function(e){e.FIXED="FIXED",e.FIX_FAILED="FIX_FAILED"}(ju||(ju={})),function(e){e.ACTIVE="ACTIVE",e.READ_ONLY="READ_ONLY",e.HIDDEN="HIDDEN"}(Gu||(Gu={})),function(e){e.OK="OK",e.NOT_READY="NOT_READY",e.RULE_ERROR="RULE_ERROR"}(zu||(zu={})),function(e){e.REVIEWER="REVIEWER",e.CC="CC",e.REMOVED="REMOVED"}(Vu||(Vu={})),function(e){e.REWORK="REWORK",e.TRIVIAL_REBASE="TRIVIAL_REBASE",e.TRIVIAL_REBASE_WITH_MESSAGE_UPDATE="TRIVIAL_REBASE_WITH_MESSAGE_UPDATE",e.MERGE_FIRST_PARENT_UPDATE="MERGE_FIRST_PARENT_UPDATE",e.NO_CODE_CHANGE="NO_CODE_CHANGE",e.NO_CHANGE="NO_CHANGE"}(Wu||(Wu={})),function(e){e.MERGE_IF_NECESSARY="MERGE_IF_NECESSARY",e.FAST_FORWARD_ONLY="FAST_FORWARD_ONLY",e.REBASE_IF_NECESSARY="REBASE_IF_NECESSARY",e.REBASE_ALWAYS="REBASE_ALWAYS",e.MERGE_ALWAYS="MERGE_ALWAYS ",e.CHERRY_PICK="CHERRY_PICK",e.INHERIT="INHERIT"}(qu||(qu={})),function(e){e.DONE="DONE",e.FAILED="FAILED",e.PENDING="PENDING",e.TERMINATED="TERMINATED"}(Ku||(Ku={})),function(e){e.REVISION="REVISION",e.PARENT="PARENT"}(Yu||(Yu={}));const Ju="edit",Qu="PARENT";function Zu(e){const t=e;return void 0!==t.approved||void 0!==t.rejected||void 0!==t.recommended||void 0!==t.disliked||void 0!==t.blocking||void 0!==t.blocking||void 0!==t.value}var eg,tg,ig,rg,og,sg,ng,ag,lg,dg,cg,hg,pg,ug,gg,mg,fg,vg,bg,yg,wg,_g,xg,Cg;function Eg(){return{changes_per_page:25,diff_view:Su.SIDE_BY_SIDE,size_bar_in_change_table:!0,my:[],theme:mg.AUTO,date_format:fg.STD,time_format:vg.HHMM_12,change_table:[],email_strategy:bg.ATTENTION_SET_ONLY,default_base_for_merges:wg.AUTO_MERGE,allow_browser_notifications:!1,allow_suggest_code_while_commenting:!0,allow_autocompleting_comments:!0,diff_page_sidebar:"NONE"}}!function(e){e.PASS="PASS",e.FAIL="FAIL",e.ERROR="ERROR",e.NOT_EVALUATED="NOT_EVALUATED"}(eg||(eg={})),function(e){e.SATISFIED="SATISFIED",e.UNSATISFIED="UNSATISFIED",e.OVERRIDDEN="OVERRIDDEN",e.NOT_APPLICABLE="NOT_APPLICABLE",e.ERROR="ERROR",e.FORCED="FORCED"}(tg||(tg={})),function(e){e.OK="OK",e.NOT_READY="NOT_READY",e.CLOSED="CLOSED",e.FORCED="FORCED",e.RULE_ERROR="RULE_ERROR"}(ig||(ig={})),function(e){e.OK="OK",e.REJECT="REJECT",e.MAY="MAY",e.NEED="NEED",e.IMPOSSIBLE="IMPOSSIBLE",e.OPTIONAL="OPTIONAL"}(rg||(rg={})),function(e){e.MaxWithBlock="MaxWithBlock",e.AnyWithBlock="AnyWithBlock",e.MaxNoBlock="MaxNoBlock",e.NoBlock="NoBlock",e.Noop="Noop",e.PatchSetLock="PatchSetLock"}(og||(og={})),function(e){e.SERVICE_USER="SERVICE_USER"}(sg||(sg={})),function(e){e.FILES="files",e.COMMENT_THREADS="comments",e.CHECKS="checks",e.FLOWS="flows"}(ng||(ng={})),function(e){e.TAG_DELETE_REVIEWER="autogenerated:gerrit:deleteReviewer",e.TAG_NEW_PATCHSET="autogenerated:gerrit:newPatchSet",e.TAG_NEW_PATCHSET_OUTDATED_VOTES="autogenerated:gerrit:newPatchSetOutdatedVotes",e.TAG_NEW_WIP_PATCHSET="autogenerated:gerrit:newWipPatchSet",e.TAG_REVIEWER_UPDATE="autogenerated:gerrit:reviewerUpdate",e.TAG_SET_PRIVATE="autogenerated:gerrit:setPrivate",e.TAG_UNSET_PRIVATE="autogenerated:gerrit:unsetPrivate",e.TAG_SET_READY="autogenerated:gerrit:setReadyForReview",e.TAG_SET_WIP="autogenerated:gerrit:setWorkInProgress",e.TAG_MERGED="autogenerated:gerrit:merged",e.TAG_REVERT="autogenerated:gerrit:revert"}(ag||(ag={})),function(e){e.RUNNING="RUNNING",e.FAILED="FAILED",e.NOT_STARTED="NOT STARTED",e.SUCCESSFUL="SUCCESSFUL"}(lg||(lg={})),function(e){e.SUBJECT="Subject",e.OWNER="Owner",e.REVIEWERS="Reviewers",e.REPO="Repo",e.BRANCH="Branch",e.UPDATED="Updated",e.SIZE="Size",e.STATUS="Status"}(dg||(dg={})),function(e){e.KEEP_VISIBLE="keep-visible",e.NEVER="never"}(cg||(cg={})),function(e){e.PATCHSET_LEVEL_COMMENTS="/PATCHSET_LEVEL",e.COMMIT_MESSAGE="/COMMIT_MSG",e.MERGE_LIST="/MERGE_LIST"}(hg||(hg={})),function(e){e.RECURSIVE="recursive",e.RESOLVE="resolve",e.SIMPLE_TWO_WAY_IN_CORE="simple-two-way-in-core",e.OURS="ours",e.THEIRS="theirs"}(pg||(pg={})),function(e){e.ALLOW="ALLOW",e.DENY="DENY",e.BLOCK="BLOCK",e.INTERACTIVE="INTERACTIVE",e.BATCH="BATCH"}(ug||(ug={})),function(e){e.BATCH="BATCH",e.INTERACTIVE="INTERACTIVE"}(gg||(gg={})),function(e){e.AUTO="AUTO",e.DARK="DARK",e.LIGHT="LIGHT"}(mg||(mg={})),function(e){e.STD="STD",e.US="US",e.ISO="ISO",e.EURO="EURO",e.UK="UK"}(fg||(fg={})),function(e){e.HHMM_12="HHMM_12",e.HHMM_24="HHMM_24"}(vg||(vg={})),function(e){e.ENABLED="ENABLED",e.CC_ON_OWN_COMMENTS="CC_ON_OWN_COMMENTS",e.ATTENTION_SET_ONLY="ATTENTION_SET_ONLY",e.DISABLED="DISABLED"}(bg||(bg={})),function(e){e.PLAINTEXT="PLAINTEXT",e.HTML_PLAINTEXT="HTML_PLAINTEXT"}(yg||(yg={})),function(e){e.AUTO_MERGE="AUTO_MERGE",e.FIRST_PARENT="FIRST_PARENT"}(wg||(wg={})),function(e){e.PUBLISH="PUBLISH",e.PUBLISH_ALL_REVISIONS="PUBLISH_ALL_REVISIONS",e.KEEP="KEEP"}(_g||(_g={})),function(e){e.NONE="NONE",e.OWNER="OWNER",e.OWNER_REVIEWERS="OWNER_REVIEWERS",e.ALL="ALL"}(xg||(xg={})),function(e){e.ALL="ALL",e.SAME_GROUP="SAME_GROUP",e.VISIBLE_GROUP="VISIBLE_GROUP",e.NONE="NONE"}(Cg||(Cg={}));const Sg="Waiting";function $g(e,t){if(e===hg.COMMIT_MESSAGE)return-1;if(t===hg.COMMIT_MESSAGE)return 1;if(e===hg.MERGE_LIST)return-1;if(t===hg.MERGE_LIST)return 1;const i=e.lastIndexOf("."),r=e.substr(i+1),o=e.substr(0,i)||e,s=t.lastIndexOf("."),n=t.substr(s+1),a=t.substr(0,s)||t,l=["h","hh","hxx","hpp"];if(o.length>0&&o===a){if(l.includes(r)&&l.includes(n))return e.localeCompare(t);if(l.includes(r))return-1;if(l.includes(n))return 1}return o.localeCompare(a)||e.localeCompare(t)}function kg(e){return e===hg.COMMIT_MESSAGE?"Commit message":e===hg.MERGE_LIST?"Merge list":e??""}function Ag(e){return!!e&&(e===hg.COMMIT_MESSAGE||e===hg.MERGE_LIST)}function Rg(e){return Tg(kg(e))}function Tg(e,t=1){const i=e.split("/");if(i.length<=t)return e;const r=i.length-t;return`…/${i.slice(r).join("/")}`}function Ig(e,t){return 0===e?"":`${e} ${t}`+(e>1?"s":"")}function Pg(e){return e.replace(/[^a-zA-Z]+/g,"")}function Ng(e){return 1===e.length&&e.toLowerCase()!==e.toUpperCase()}function Og(e){return void 0===e?"":e%10==1&&e%100!=11?`${e}st`:e%10==2&&e%100!=12?`${e}nd`:e%10==3&&e%100!=13?`${e}rd`:`${e}th`}function Dg(e){return`"${e.replaceAll("\\","\\\\").replaceAll('"','\\"')}"`}function Lg(e){return void 0!==e?String(e):""}function Mg(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Fg(e,t){return e?e.length<=t?e:e.substring(0,t-3)+"...":""}function Ug(e){if(e.length<2)return e.join("");if(2===e.length)return e.join(" and ");const t=e.slice(0,e.length-1),i=e[e.length-1];return`${t.join(", ")}, and ${i}`}const Bg=mu("shortcuts-service");class Hg{constructor(e,t){this.userModel=e,this.reporting=t,this.activeShortcuts=new Set,this.bindings=new Map,this.listeners=new Set,this.comboKeyLastPressed={},this.shortcutsDisabled=!1,this.subscriptions=[],this.config=function(){const e=new Map;function t(t,i,r,o,...s){e.has(i)||e.set(i,[]);const n=e.get(i);n&&n.push({shortcut:t,text:r,bindings:[o,...s]})}return t(pu.SEARCH,hu.EVERYWHERE,"Search",{key:"/"}),t(pu.OPEN_SHORTCUT_HELP_DIALOG,hu.EVERYWHERE,"Show this dialog",{key:"?"}),t(pu.GO_TO_USER_DASHBOARD,hu.EVERYWHERE,"Go to User Dashboard",{key:"i",combo:Un.G}),t(pu.GO_TO_OPENED_CHANGES,hu.EVERYWHERE,"Go to Opened Changes",{key:"o",combo:Un.G}),t(pu.GO_TO_MERGED_CHANGES,hu.EVERYWHERE,"Go to Merged Changes",{key:"m",combo:Un.G}),t(pu.GO_TO_ABANDONED_CHANGES,hu.EVERYWHERE,"Go to Abandoned Changes",{key:"a",combo:Un.G}),t(pu.GO_TO_WATCHED_CHANGES,hu.EVERYWHERE,"Go to Watched Changes",{key:"w",combo:Un.G}),t(pu.GO_TO_REPOS,hu.EVERYWHERE,"Go to Repositories",{key:"r",combo:Un.G}),t(pu.GO_TO_GROUPS,hu.EVERYWHERE,"Go to Groups",{key:"g",combo:Un.G}),t(pu.TOGGLE_CHECKBOX,hu.ACTIONS,"Toggle checkbox",{key:"x"}),t(pu.CURSOR_NEXT_CHANGE,hu.ACTIONS,"Select next change",{key:"j",allowRepeat:!0}),t(pu.CURSOR_PREV_CHANGE,hu.ACTIONS,"Select previous change",{key:"k",allowRepeat:!0}),t(pu.OPEN_CHANGE,hu.ACTIONS,"Show selected change",{key:"o"}),t(pu.NEXT_PAGE,hu.ACTIONS,"Go to next page",{key:"n"},{key:"]"}),t(pu.PREV_PAGE,hu.ACTIONS,"Go to previous page",{key:"p"},{key:"["}),t(pu.OPEN_REPLY_DIALOG,hu.ACTIONS,"Open reply dialog to publish comments and add reviewers",{key:"a"}),t(pu.OPEN_DOWNLOAD_DIALOG,hu.ACTIONS,"Open download overlay",{key:"d"}),t(pu.OPEN_COPY_LINKS_DROPDOWN,hu.ACTIONS,"Open link dialog",{key:"l"}),t(pu.EXPAND_ALL_MESSAGES,hu.ACTIONS,"Expand all messages",{key:"x"}),t(pu.COLLAPSE_ALL_MESSAGES,hu.ACTIONS,"Collapse all messages",{key:"z"}),t(pu.REFRESH_CHANGE,hu.ACTIONS,"Reload the change at the latest patch",{key:"R"}),t(pu.TOGGLE_FILE_REVIEWED,hu.ACTIONS,"Toggle review flag on selected file",{key:"r"}),t(pu.REFRESH_CHANGE_LIST,hu.ACTIONS,"Refresh list of changes",{key:"R"}),t(pu.TOGGLE_CHANGE_STAR,hu.ACTIONS,"Star/unstar change",{key:"s"}),t(pu.OPEN_SUBMIT_DIALOG,hu.ACTIONS,"Open submit dialog",{key:"S"}),t(pu.TOGGLE_ATTENTION_SET,hu.ACTIONS,"Toggle attention set status",{key:"T"}),t(pu.EDIT_TOPIC,hu.ACTIONS,"Add a change topic",{key:"t"}),t(pu.DIFF_AGAINST_BASE,hu.DIFFS,"Diff against base",{key:Mn.DOWN,combo:Un.V},{key:"s",combo:Un.V}),t(pu.DIFF_AGAINST_LATEST,hu.DIFFS,"Diff against latest patchset",{key:Mn.UP,combo:Un.V},{key:"w",combo:Un.V}),t(pu.DIFF_BASE_AGAINST_LEFT,hu.DIFFS,"Diff base against left",{key:Mn.LEFT,combo:Un.V},{key:"a",combo:Un.V}),t(pu.DIFF_RIGHT_AGAINST_LATEST,hu.DIFFS,"Diff right against latest",{key:Mn.RIGHT,combo:Un.V},{key:"d",combo:Un.V}),t(pu.DIFF_BASE_AGAINST_LATEST,hu.DIFFS,"Diff base against latest",{key:"b",combo:Un.V}),t(pu.NEXT_LINE,hu.DIFFS,"Go to next line",{key:"j",allowRepeat:!0},{key:Mn.DOWN,allowRepeat:!0}),t(pu.PREV_LINE,hu.DIFFS,"Go to previous line",{key:"k",allowRepeat:!0},{key:Mn.UP,allowRepeat:!0}),t(pu.VISIBLE_LINE,hu.DIFFS,"Move cursor to currently visible code",{key:"."}),t(pu.NEXT_CHUNK,hu.DIFFS,"Go to next diff chunk",{key:"n"}),t(pu.PREV_CHUNK,hu.DIFFS,"Go to previous diff chunk",{key:"p"}),t(pu.TOGGLE_ALL_DIFF_CONTEXT,hu.DIFFS,"Toggle all diff context",{key:"X"}),t(pu.NEXT_COMMENT_THREAD,hu.DIFFS,"Go to next comment thread",{key:"N"}),t(pu.PREV_COMMENT_THREAD,hu.DIFFS,"Go to previous comment thread",{key:"P"}),t(pu.EXPAND_ALL_COMMENT_THREADS,hu.DIFFS,"Expand all comment threads",{key:"e",docOnly:!0}),t(pu.COLLAPSE_ALL_COMMENT_THREADS,hu.DIFFS,"Collapse all comment threads",{key:"E",docOnly:!0}),t(pu.TOGGLE_HIDE_ALL_COMMENT_THREADS_AND_CODE_POINTERS,hu.DIFFS,"Hide/Display all comment threads and check code pointers",{key:"h"}),t(pu.TOGGLE_HIDE_CHECK_CODE_POINTERS,hu.DIFFS,"Hide/Display all check code pointers",{key:"H"}),t(pu.LEFT_PANE,hu.DIFFS,"Select left pane",{key:Mn.LEFT,modifiers:[Fn.SHIFT_KEY]}),t(pu.RIGHT_PANE,hu.DIFFS,"Select right pane",{key:Mn.RIGHT,modifiers:[Fn.SHIFT_KEY]}),t(pu.TOGGLE_LEFT_PANE,hu.DIFFS,"Hide/show left diff",{key:"A"}),t(pu.NEW_COMMENT,hu.DIFFS,"Draft new comment",{key:"c"}),t(pu.SAVE_COMMENT,hu.DIFFS,"Save comment",{key:Mn.ENTER,modifiers:[Fn.CTRL_KEY]},{key:Mn.ENTER,modifiers:[Fn.META_KEY]},{key:"s",modifiers:[Fn.CTRL_KEY]},{key:"s",modifiers:[Fn.META_KEY]}),t(pu.OPEN_DIFF_PREFS,hu.DIFFS,"Show diff preferences",{key:","}),t(pu.TOGGLE_DIFF_REVIEWED,hu.DIFFS,"Mark/unmark file as reviewed",{key:"r"}),t(pu.TOGGLE_DIFF_MODE,hu.DIFFS,"Toggle unified/side-by-side diff",{key:"m"}),t(pu.NEXT_UNREVIEWED_FILE,hu.DIFFS,"Mark file as reviewed and go to next unreviewed file",{key:"M"}),t(pu.TOGGLE_BLAME,hu.DIFFS,"Toggle blame",{key:"b"}),t(pu.OPEN_FILE_LIST,hu.DIFFS,"Open file list",{key:"f"}),t(pu.NEXT_FILE,hu.NAVIGATION,"Go to next file",{key:"]"}),t(pu.PREV_FILE,hu.NAVIGATION,"Go to previous file",{key:"["}),t(pu.NEXT_FILE_WITH_COMMENTS,hu.NAVIGATION,"Go to next file that has comments",{key:"J"}),t(pu.PREV_FILE_WITH_COMMENTS,hu.NAVIGATION,"Go to previous file that has comments",{key:"K"}),t(pu.OPEN_FIRST_FILE,hu.NAVIGATION,"Go to first file",{key:"]"}),t(pu.OPEN_LAST_FILE,hu.NAVIGATION,"Go to last file",{key:"["}),t(pu.UP_TO_DASHBOARD,hu.NAVIGATION,"Up to dashboard",{key:"u"}),t(pu.UP_TO_CHANGE,hu.NAVIGATION,"Up to change",{key:"u"}),t(pu.CURSOR_NEXT_FILE,hu.FILE_LIST,"Select next file",{key:"j",allowRepeat:!0},{key:Mn.DOWN,allowRepeat:!0}),t(pu.CURSOR_PREV_FILE,hu.FILE_LIST,"Select previous file",{key:"k",allowRepeat:!0},{key:Mn.UP,allowRepeat:!0}),t(pu.OPEN_FILE,hu.FILE_LIST,"Go to selected file",{key:"o"},{key:Mn.ENTER}),t(pu.TOGGLE_ALL_INLINE_DIFFS,hu.FILE_LIST,"Show/hide all inline diffs",{key:"I"}),t(pu.TOGGLE_INLINE_DIFF,hu.FILE_LIST,"Show/hide selected inline diff",{key:"i"}),t(pu.EMOJI_DROPDOWN,hu.REPLY_DIALOG,"Emoji dropdown",{key:":",docOnly:!0}),t(pu.MENTIONS_DROPDOWN,hu.REPLY_DIALOG,"Mentions dropdown",{key:"@",docOnly:!0}),e}();for(const e of this.config.keys()){const t=this.config.get(e)??[];for(const e of t)this.bindings.set(e.shortcut,e.bindings)}this.subscriptions.push(this.userModel.preferences$.pipe(ep((e=>e?.disable_keyboard_shortcuts??!1)),xp()).subscribe((e=>this.shortcutsDisabled=e))),this.keydownListener=e=>{var t;t=e.key,Object.values(Un).includes(t)&&(this.shortcutsDisabled||zn(e)||(this.comboKeyLastPressed={key:e.key,timestampMs:Date.now()}))},document.addEventListener("keydown",this.keydownListener)}finalize(){document.removeEventListener("keydown",this.keydownListener);for(const e of this.subscriptions)e.unsubscribe()}_testOnly_isEmpty(){return 0===this.activeShortcuts.size&&0===this.listeners.size}isInComboKeyMode(){return Object.values(Un).some((e=>this.isInSpecificComboKeyMode(e)))}isInSpecificComboKeyMode(e){const{key:t,timestampMs:i}=this.comboKeyLastPressed;return t===e&&i&&Date.now()-i<1e3}addShortcut(e,t,i,r){const o=r?.shouldSuppress??!0,s=r?.preventDefault??!0,n=e=>{if((!e.repeat||t.allowRepeat)&&Hn(e,t)){if(t.combo){if(!this.isInSpecificComboKeyMode(t.combo))return}else if(this.isInComboKeyMode())return;o&&zn(e)||o&&this.shortcutsDisabled||(s&&e.preventDefault(),s&&e.stopPropagation(),this.reportTriggered(e),t.combo&&setTimeout((()=>{this.comboKeyLastPressed={}})),i(e))}};return e.addEventListener("keydown",n),()=>e.removeEventListener("keydown",n)}reportTriggered(e){let t=`${e.key}:${e.type}`;this.isInSpecificComboKeyMode(Un.G)&&(t="g+"+t),this.isInSpecificComboKeyMode(Un.V)&&(t="v+"+t),e.shiftKey&&(t="shift+"+t),e.ctrlKey&&(t="ctrl+"+t),e.metaKey&&(t="meta+"+t),e.altKey&&(t="alt+"+t);let i="unknown";An(e.currentTarget)&&(i=e.currentTarget.tagName),this.reporting?.reportInteraction("shortcut-triggered",{key:t,from:i})}createTitle(e,t){const i=this.getDescription(t,e),r=this.getShortcut(e);return i&&r?`${i} (shortcut: ${r})`:""}getBindingsForShortcut(e){return this.bindings.get(e)}addShortcutListener(e,t,i){const r=[];this.activeShortcuts.add(e),r.push((()=>{this.activeShortcuts.delete(e),this.notifyViewListeners()}));const o=this.getBindingsForShortcut(e);for(const e of o??[])e.docOnly||r.push(this.addShortcut(document.body,e,t,i));return this.notifyViewListeners(),()=>{for(const e of r??[])e()}}addListener(e){this.listeners.add(e),e(this.directoryView())}removeListener(e){return this.listeners.delete(e)}getDescription(e,t){const i=this.config.get(e);if(!i)return"";const r=i.find((e=>e.shortcut===t));return r?.text??""}getShortcut(e){const t=this.bindings.get(e);return t?t.map((e=>jg(e).join("+"))).join(","):""}activeShortcutsBySection(){const e=new Map;return this.config.forEach(((t,i)=>{t.forEach((t=>{this.activeShortcuts.has(t.shortcut)&&(e.has(i)||e.set(i,[]),e.get(i).push(t))}))})),e}directoryView(){const e=new Map;return this.activeShortcutsBySection().forEach(((t,i)=>{const r=[];t.forEach((e=>{const t=this.describeBindings(e.shortcut);t&&this.distributeBindingDesc(t).forEach((t=>{r.push({binding:t,text:e.text})}))})),e.set(i,r)})),e}distributeBindingDesc(e){if(1===e.length||this.comboSetDisplayWidth(e)<21)return[e];const t=[e[0]];for(let i=1;i<e.length;i++)if(t.push(e[i]),this.comboSetDisplayWidth(t)>=21)return t.pop(),[t].concat(this.distributeBindingDesc(e.slice(i)));return[]}comboSetDisplayWidth(e){return e.reduce(((e,t)=>e+(e=>e.reduce(((e,t)=>e+t.length),0))(t)),0)+2*(e.length-1)}describeBindings(e){const t=this.bindings.get(e);return t?t.map((e=>jg(e))):null}notifyViewListeners(){const e=this.directoryView();this.listeners.forEach((t=>t(e)))}}function jg(e){const t=[];var i;e.combo===Un.G&&t.push("g"),e.combo===Un.V&&t.push("v"),(e.modifiers?.includes(Fn.SHIFT_KEY)||Ng(e.key)&&(i=e.key)===i.toUpperCase())&&t.push("Shift"),e.modifiers?.includes(Fn.ALT_KEY)&&t.push("Alt"),e.modifiers?.includes(Fn.CTRL_KEY)&&t.push("Ctrl"),e.modifiers?.includes(Fn.META_KEY)&&t.push("Meta/Cmd");let r=function(e){switch(e){case Mn.UP:return"↑";case Mn.DOWN:return"↓";case Mn.LEFT:return"←";case Mn.RIGHT:return"→";default:return e}}(e.key);return Ng(r)&&(r=r.toLowerCase()),t.push(r),t}class Gg{constructor(e){this.host=e,this.listenersLocal=[],this.listenersGlobal=[],this.listenersAbstract=[],this.cleanups=[],this.getShortcutsService=yu(this.host,Bg),e.addController(this)}addLocal(e,t,i){this.listenersLocal.push({binding:e,listener:t,options:i})}addGlobal(e,t){this.listenersGlobal.push({binding:e,listener:t})}addAbstract(e,t,i){this.listenersAbstract.push({shortcut:e,listener:t,options:i})}hostConnected(){const e=this.getShortcutsService();for(const{binding:t,listener:i,options:r}of this.listenersLocal){const o=e.addShortcut(this.host,t,i,{shouldSuppress:r?.shouldSuppress??!1,preventDefault:r?.preventDefault});this.cleanups.push(o)}for(const{shortcut:t,listener:i,options:r}of this.listenersAbstract){const o=e.addShortcutListener(t,i,r);this.cleanups.push(o)}for(const{binding:t,listener:i}of this.listenersGlobal){const r=e.addShortcut(document.body,t,i);this.cleanups.push(r)}}hostDisconnected(){for(const e of this.cleanups)e();this.cleanups=[]}}function zg(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;class Vg extends Ic{connectedCallback(){super.connectedCallback(),this.setAttribute("aria-hidden","true")}render(){return dc`<span class="shadow"></span>`}}const Wg=Sd`:host,.shadow,.shadow::before,.shadow::after{border-radius:inherit;inset:0;position:absolute;transition-duration:inherit;transition-property:inherit;transition-timing-function:inherit}:host{display:flex;pointer-events:none;transition-property:box-shadow,opacity}.shadow::before,.shadow::after{content:"";transition-property:box-shadow,opacity;--_level: var(--md-elevation-level, 0);--_shadow-color: var(--md-elevation-shadow-color, var(--md-sys-color-shadow, #000))}.shadow::before{box-shadow:0px calc(1px*(clamp(0,var(--_level),1) + clamp(0,var(--_level) - 3,1) + 2*clamp(0,var(--_level) - 4,1))) calc(1px*(2*clamp(0,var(--_level),1) + clamp(0,var(--_level) - 2,1) + clamp(0,var(--_level) - 4,1))) 0px var(--_shadow-color);opacity:.3}.shadow::after{box-shadow:0px calc(1px*(clamp(0,var(--_level),1) + clamp(0,var(--_level) - 1,1) + 2*clamp(0,var(--_level) - 2,3))) calc(1px*(3*clamp(0,var(--_level),2) + 2*clamp(0,var(--_level) - 2,3))) calc(1px*(clamp(0,var(--_level),4) + 2*clamp(0,var(--_level) - 4,1))) var(--_shadow-color);opacity:.15}
`;let qg=class extends Vg{};qg.styles=[Wg],qg=zg([Dc("md-elevation")],qg);const Kg=Symbol("attachableController");let Yg;Yg=new MutationObserver((e=>{for(const t of e)t.target[Kg]?.hostConnected()}));class Xg{get htmlFor(){return this.host.getAttribute("for")}set htmlFor(e){null===e?this.host.removeAttribute("for"):this.host.setAttribute("for",e)}get control(){return this.host.hasAttribute("for")?this.htmlFor&&this.host.isConnected?this.host.getRootNode().querySelector(`#${this.htmlFor}`):null:this.currentControl||this.host.parentElement}set control(e){e?this.attach(e):this.detach()}constructor(e,t){this.host=e,this.onControlChange=t,this.currentControl=null,e.addController(this),e[Kg]=this,Yg?.observe(e,{attributeFilter:["for"]})}attach(e){e!==this.currentControl&&(this.setCurrentControl(e),this.host.removeAttribute("for"))}detach(){this.setCurrentControl(null),this.host.setAttribute("for","")}hostConnected(){this.setCurrentControl(this.control)}hostDisconnected(){this.setCurrentControl(null)}setCurrentControl(e){this.onControlChange(this.currentControl,e),this.currentControl=e}}const Jg=["focusin","focusout","pointerdown"];class Qg extends Ic{constructor(){super(...arguments),this.visible=!1,this.inward=!1,this.attachableController=new Xg(this,this.onControlChange.bind(this))}get htmlFor(){return this.attachableController.htmlFor}set htmlFor(e){this.attachableController.htmlFor=e}get control(){return this.attachableController.control}set control(e){this.attachableController.control=e}attach(e){this.attachableController.attach(e)}detach(){this.attachableController.detach()}connectedCallback(){super.connectedCallback(),this.setAttribute("aria-hidden","true")}handleEvent(e){if(!e[Zg]){switch(e.type){default:return;case"focusin":this.visible=this.control?.matches(":focus-visible")??!1;break;case"focusout":case"pointerdown":this.visible=!1}e[Zg]=!0}}onControlChange(e,t){for(const i of Jg)e?.removeEventListener(i,this),t?.addEventListener(i,this)}update(e){e.has("visible")&&this.dispatchEvent(new Event("visibility-changed")),super.update(e)}}zg([Fc({type:Boolean,reflect:!0})],Qg.prototype,"visible",void 0),zg([Fc({type:Boolean,reflect:!0})],Qg.prototype,"inward",void 0);const Zg=Symbol("handledByFocusRing"),em=Sd`:host{animation-delay:0s,calc(var(--md-focus-ring-duration, 600ms)*.25);animation-duration:calc(var(--md-focus-ring-duration, 600ms)*.25),calc(var(--md-focus-ring-duration, 600ms)*.75);animation-timing-function:cubic-bezier(0.2, 0, 0, 1);box-sizing:border-box;color:var(--md-focus-ring-color, var(--md-sys-color-secondary, #625b71));display:none;pointer-events:none;position:absolute}:host([visible]){display:flex}:host(:not([inward])){animation-name:outward-grow,outward-shrink;border-end-end-radius:calc(var(--md-focus-ring-shape-end-end, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) + var(--md-focus-ring-outward-offset, 2px));border-end-start-radius:calc(var(--md-focus-ring-shape-end-start, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) + var(--md-focus-ring-outward-offset, 2px));border-start-end-radius:calc(var(--md-focus-ring-shape-start-end, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) + var(--md-focus-ring-outward-offset, 2px));border-start-start-radius:calc(var(--md-focus-ring-shape-start-start, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) + var(--md-focus-ring-outward-offset, 2px));inset:calc(-1*var(--md-focus-ring-outward-offset, 2px));outline:var(--md-focus-ring-width, 3px) solid currentColor}:host([inward]){animation-name:inward-grow,inward-shrink;border-end-end-radius:calc(var(--md-focus-ring-shape-end-end, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) - var(--md-focus-ring-inward-offset, 0px));border-end-start-radius:calc(var(--md-focus-ring-shape-end-start, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) - var(--md-focus-ring-inward-offset, 0px));border-start-end-radius:calc(var(--md-focus-ring-shape-start-end, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) - var(--md-focus-ring-inward-offset, 0px));border-start-start-radius:calc(var(--md-focus-ring-shape-start-start, var(--md-focus-ring-shape, var(--md-sys-shape-corner-full, 9999px))) - var(--md-focus-ring-inward-offset, 0px));border:var(--md-focus-ring-width, 3px) solid currentColor;inset:var(--md-focus-ring-inward-offset, 0px)}@keyframes outward-grow{from{outline-width:0}to{outline-width:var(--md-focus-ring-active-width, 8px)}}@keyframes outward-shrink{from{outline-width:var(--md-focus-ring-active-width, 8px)}}@keyframes inward-grow{from{border-width:0}to{border-width:var(--md-focus-ring-active-width, 8px)}}@keyframes inward-shrink{from{border-width:var(--md-focus-ring-active-width, 8px)}}@media(prefers-reduced-motion){:host{animation:none}}
`;let tm=class extends Qg{};tm.styles=[em],tm=zg([Dc("md-focus-ring")],tm);const im="cubic-bezier(0.2, 0, 0, 1)",rm="cubic-bezier(.3,0,0,1)",om="cubic-bezier(.3,0,.8,.15)";var sm;!function(e){e[e.INACTIVE=0]="INACTIVE",e[e.TOUCH_DELAY=1]="TOUCH_DELAY",e[e.HOLDING=2]="HOLDING",e[e.WAITING_FOR_CLICK=3]="WAITING_FOR_CLICK"}(sm||(sm={}));const nm=["click","contextmenu","pointercancel","pointerdown","pointerenter","pointerleave","pointerup"],am=window.matchMedia("(forced-colors: active)");let lm=class extends Ic{constructor(){super(...arguments),this.disabled=!1,this.hovered=!1,this.pressed=!1,this.rippleSize="",this.rippleScale="",this.initialSize=0,this.state=sm.INACTIVE,this.attachableController=new Xg(this,this.onControlChange.bind(this))}get htmlFor(){return this.attachableController.htmlFor}set htmlFor(e){this.attachableController.htmlFor=e}get control(){return this.attachableController.control}set control(e){this.attachableController.control=e}attach(e){this.attachableController.attach(e)}detach(){this.attachableController.detach()}connectedCallback(){super.connectedCallback(),this.setAttribute("aria-hidden","true")}render(){const e={hovered:this.hovered,pressed:this.pressed};return dc`<div class="surface ${th(e)}"></div>`}update(e){e.has("disabled")&&this.disabled&&(this.hovered=!1,this.pressed=!1),super.update(e)}handlePointerenter(e){this.shouldReactToEvent(e)&&(this.hovered=!0)}handlePointerleave(e){this.shouldReactToEvent(e)&&(this.hovered=!1,this.state!==sm.INACTIVE&&this.endPressAnimation())}handlePointerup(e){if(this.shouldReactToEvent(e)){if(this.state!==sm.HOLDING)return this.state===sm.TOUCH_DELAY?(this.state=sm.WAITING_FOR_CLICK,void this.startPressAnimation(this.rippleStartEvent)):void 0;this.state=sm.WAITING_FOR_CLICK}}async handlePointerdown(e){if(this.shouldReactToEvent(e)){if(this.rippleStartEvent=e,!this.isTouch(e))return this.state=sm.WAITING_FOR_CLICK,void this.startPressAnimation(e);this.state=sm.TOUCH_DELAY,await new Promise((e=>{setTimeout(e,150)})),this.state===sm.TOUCH_DELAY&&(this.state=sm.HOLDING,this.startPressAnimation(e))}}handleClick(){this.disabled||(this.state!==sm.WAITING_FOR_CLICK?this.state===sm.INACTIVE&&(this.startPressAnimation(),this.endPressAnimation()):this.endPressAnimation())}handlePointercancel(e){this.shouldReactToEvent(e)&&this.endPressAnimation()}handleContextmenu(){this.disabled||this.endPressAnimation()}determineRippleSize(){const{height:e,width:t}=this.getBoundingClientRect(),i=Math.max(e,t),r=Math.max(.35*i,75),o=this.currentCSSZoom??1,s=Math.floor(.2*i/o),n=Math.sqrt(t**2+e**2)+10;this.initialSize=s;const a=(n+r)/s;this.rippleScale=""+a/o,this.rippleSize=`${s}px`}getNormalizedPointerEventCoords(e){const{scrollX:t,scrollY:i}=window,{left:r,top:o}=this.getBoundingClientRect(),s=t+r,n=i+o,{pageX:a,pageY:l}=e,d=this.currentCSSZoom??1;return{x:(a-s)/d,y:(l-n)/d}}getTranslationCoordinates(e){const{height:t,width:i}=this.getBoundingClientRect(),r=this.currentCSSZoom??1,o={x:(i/r-this.initialSize)/2,y:(t/r-this.initialSize)/2};let s;return s=e instanceof PointerEvent?this.getNormalizedPointerEventCoords(e):{x:i/r/2,y:t/r/2},s={x:s.x-this.initialSize/2,y:s.y-this.initialSize/2},{startPoint:s,endPoint:o}}startPressAnimation(e){if(!this.mdRoot)return;this.pressed=!0,this.growAnimation?.cancel(),this.determineRippleSize();const{startPoint:t,endPoint:i}=this.getTranslationCoordinates(e),r=`${t.x}px, ${t.y}px`,o=`${i.x}px, ${i.y}px`;this.growAnimation=this.mdRoot.animate({top:[0,0],left:[0,0],height:[this.rippleSize,this.rippleSize],width:[this.rippleSize,this.rippleSize],transform:[`translate(${r}) scale(1)`,`translate(${o}) scale(${this.rippleScale})`]},{pseudoElement:"::after",duration:450,easing:im,fill:"forwards"})}async endPressAnimation(){this.rippleStartEvent=void 0,this.state=sm.INACTIVE;const e=this.growAnimation;let t=1/0;"number"==typeof e?.currentTime?t=e.currentTime:e?.currentTime&&(t=e.currentTime.to("ms").value),t>=225?this.pressed=!1:(await new Promise((e=>{setTimeout(e,225-t)})),this.growAnimation===e&&(this.pressed=!1))}shouldReactToEvent(e){if(this.disabled||!e.isPrimary)return!1;if(this.rippleStartEvent&&this.rippleStartEvent.pointerId!==e.pointerId)return!1;if("pointerenter"===e.type||"pointerleave"===e.type)return!this.isTouch(e);const t=1===e.buttons;return this.isTouch(e)||t}isTouch({pointerType:e}){return"touch"===e}async handleEvent(e){if(!am?.matches)switch(e.type){case"click":this.handleClick();break;case"contextmenu":this.handleContextmenu();break;case"pointercancel":this.handlePointercancel(e);break;case"pointerdown":await this.handlePointerdown(e);break;case"pointerenter":this.handlePointerenter(e);break;case"pointerleave":this.handlePointerleave(e);break;case"pointerup":this.handlePointerup(e)}}onControlChange(e,t){for(const i of nm)e?.removeEventListener(i,this),t?.addEventListener(i,this)}};zg([Fc({type:Boolean,reflect:!0})],lm.prototype,"disabled",void 0),zg([Uc()],lm.prototype,"hovered",void 0),zg([Uc()],lm.prototype,"pressed",void 0),zg([Hc(".surface")],lm.prototype,"mdRoot",void 0);const dm=Sd`:host{display:flex;margin:auto;pointer-events:none}:host([disabled]){display:none}@media(forced-colors: active){:host{display:none}}:host,.surface{border-radius:inherit;position:absolute;inset:0;overflow:hidden}.surface{-webkit-tap-highlight-color:rgba(0,0,0,0)}.surface::before,.surface::after{content:"";opacity:0;position:absolute}.surface::before{background-color:var(--md-ripple-hover-color, var(--md-sys-color-on-surface, #1d1b20));inset:0;transition:opacity 15ms linear,background-color 15ms linear}.surface::after{background:radial-gradient(closest-side, var(--md-ripple-pressed-color, var(--md-sys-color-on-surface, #1d1b20)) max(100% - 70px, 65%), transparent 100%);transform-origin:center center;transition:opacity 375ms linear}.hovered::before{background-color:var(--md-ripple-hover-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-ripple-hover-opacity, 0.08)}.pressed::after{opacity:var(--md-ripple-pressed-opacity, 0.12);transition-duration:105ms}
`;let cm=class extends lm{};cm.styles=[dm],cm=zg([Dc("md-ripple")],cm);const hm=["role","ariaAtomic","ariaAutoComplete","ariaBusy","ariaChecked","ariaColCount","ariaColIndex","ariaColSpan","ariaCurrent","ariaDisabled","ariaExpanded","ariaHasPopup","ariaHidden","ariaInvalid","ariaKeyShortcuts","ariaLabel","ariaLevel","ariaLive","ariaModal","ariaMultiLine","ariaMultiSelectable","ariaOrientation","ariaPlaceholder","ariaPosInSet","ariaPressed","ariaReadOnly","ariaRequired","ariaRoleDescription","ariaRowCount","ariaRowIndex","ariaRowSpan","ariaSelected","ariaSetSize","ariaSort","ariaValueMax","ariaValueMin","ariaValueNow","ariaValueText"],pm=hm.map(gm);function um(e){return pm.includes(e)}function gm(e){return e.replace("aria","aria-").replace(/Elements?/g,"").toLowerCase()}const mm=Symbol("privateIgnoreAttributeChangesFor");function fm(e){var t;class i extends e{constructor(){super(...arguments),this[t]=new Set}attributeChangedCallback(e,t,i){if(!um(e))return void super.attributeChangedCallback(e,t,i);if(this[mm].has(e))return;this[mm].add(e),this.removeAttribute(e),this[mm].delete(e);const r=bm(e);null===i?delete this.dataset[r]:this.dataset[r]=i,this.requestUpdate(bm(e),t)}getAttribute(e){return um(e)?super.getAttribute(vm(e)):super.getAttribute(e)}removeAttribute(e){super.removeAttribute(e),um(e)&&(super.removeAttribute(vm(e)),this.requestUpdate())}}return t=mm,function(e){for(const t of hm){const i=gm(t),r=vm(i),o=bm(i);e.createProperty(t,{attribute:i,noAccessor:!0}),e.createProperty(Symbol(r),{attribute:r,noAccessor:!0}),Object.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get(){return this.dataset[o]??null},set(e){const i=this.dataset[o]??null;e!==i&&(null===e?delete this.dataset[o]:this.dataset[o]=e,this.requestUpdate(t,i))}})}}(i),i}function vm(e){return`data-${e}`}function bm(e){return e.replace(/-\w/,(e=>e[1].toUpperCase()))}const ym=Symbol("internals"),wm=Symbol("privateInternals");function _m(e){return class extends e{get[ym](){return this[wm]||(this[wm]=this.attachInternals()),this[wm]}}}function xm(e){e.addInitializer((e=>{const t=e;t.addEventListener("click",(async e=>{const{type:i,[ym]:r}=t,{form:o}=r;o&&"button"!==i&&(await new Promise((e=>{setTimeout(e)})),e.defaultPrevented||("reset"!==i?(o.addEventListener("submit",(e=>{Object.defineProperty(e,"submitter",{configurable:!0,enumerable:!0,get:()=>t})}),{capture:!0,once:!0}),r.setFormValue(t.value),o.requestSubmit()):o.reset()))}))}))}function Cm(e){const t=new MouseEvent("click",{bubbles:!0});return e.dispatchEvent(t),t}function Em(e){return e.currentTarget===e.target&&e.composedPath()[0]===e.target&&!e.target.disabled&&!function(e){const t=Sm;return t&&(e.preventDefault(),e.stopImmediatePropagation()),async function(){Sm=!0,await null,Sm=!1}(),t}(e)}let Sm=!1;const $m=fm(_m(Ic));class km extends $m{get name(){return this.getAttribute("name")??""}set name(e){this.setAttribute("name",e)}get form(){return this[ym].form}constructor(){super(),this.disabled=!1,this.softDisabled=!1,this.href="",this.download="",this.target="",this.trailingIcon=!1,this.hasIcon=!1,this.type="submit",this.value="",this.addEventListener("click",this.handleClick.bind(this))}focus(){this.buttonElement?.focus()}blur(){this.buttonElement?.blur()}render(){const e=this.disabled||this.softDisabled,t=this.href?this.renderLink():this.renderButton(),i=this.href?"link":"button";return dc`
      ${this.renderElevationOrOutline?.()}
      <div class="background"></div>
      <md-focus-ring part="focus-ring" for=${i}></md-focus-ring>
      <md-ripple
        part="ripple"
        for=${i}
        ?disabled="${e}"></md-ripple>
      ${t}
    `}renderButton(){const{ariaLabel:e,ariaHasPopup:t,ariaExpanded:i}=this;return dc`<button
      id="button"
      class="button"
      ?disabled=${this.disabled}
      aria-disabled=${this.softDisabled||uc}
      aria-label="${e||uc}"
      aria-haspopup="${t||uc}"
      aria-expanded="${i||uc}">
      ${this.renderContent()}
    </button>`}renderLink(){const{ariaLabel:e,ariaHasPopup:t,ariaExpanded:i}=this;return dc`<a
      id="link"
      class="button"
      aria-label="${e||uc}"
      aria-haspopup="${t||uc}"
      aria-expanded="${i||uc}"
      aria-disabled=${this.disabled||this.softDisabled||uc}
      tabindex="${this.disabled&&!this.softDisabled?-1:uc}"
      href=${this.href}
      download=${this.download||uc}
      target=${this.target||uc}
      >${this.renderContent()}
    </a>`}renderContent(){const e=dc`<slot
      name="icon"
      @slotchange="${this.handleSlotChange}"></slot>`;return dc`
      <span class="touch"></span>
      ${this.trailingIcon?uc:e}
      <span class="label"><slot></slot></span>
      ${this.trailingIcon?e:uc}
    `}handleClick(e){if(this.softDisabled||this.disabled&&this.href)return e.stopImmediatePropagation(),void e.preventDefault();Em(e)&&this.buttonElement&&(this.focus(),Cm(this.buttonElement))}handleSlotChange(){this.hasIcon=this.assignedIcons.length>0}}xm(km),km.formAssociated=!0,km.shadowRootOptions={mode:"open",delegatesFocus:!0},zg([Fc({type:Boolean,reflect:!0})],km.prototype,"disabled",void 0),zg([Fc({type:Boolean,attribute:"soft-disabled",reflect:!0})],km.prototype,"softDisabled",void 0),zg([Fc()],km.prototype,"href",void 0),zg([Fc()],km.prototype,"download",void 0),zg([Fc()],km.prototype,"target",void 0),zg([Fc({type:Boolean,attribute:"trailing-icon",reflect:!0})],km.prototype,"trailingIcon",void 0),zg([Fc({type:Boolean,attribute:"has-icon",reflect:!0})],km.prototype,"hasIcon",void 0),zg([Fc()],km.prototype,"type",void 0),zg([Fc({reflect:!0})],km.prototype,"value",void 0),zg([Hc(".button")],km.prototype,"buttonElement",void 0),zg([Vc({slot:"icon",flatten:!0})],km.prototype,"assignedIcons",void 0);class Am extends km{renderElevationOrOutline(){return dc`<md-elevation part="elevation"></md-elevation>`}}const Rm=Sd`:host{--_container-color: var(--md-elevated-button-container-color, var(--md-sys-color-surface-container-low, #f7f2fa));--_container-elevation: var(--md-elevated-button-container-elevation, 1);--_container-height: var(--md-elevated-button-container-height, 40px);--_container-shadow-color: var(--md-elevated-button-container-shadow-color, var(--md-sys-color-shadow, #000));--_disabled-container-color: var(--md-elevated-button-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-elevation: var(--md-elevated-button-disabled-container-elevation, 0);--_disabled-container-opacity: var(--md-elevated-button-disabled-container-opacity, 0.12);--_disabled-label-text-color: var(--md-elevated-button-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-elevated-button-disabled-label-text-opacity, 0.38);--_focus-container-elevation: var(--md-elevated-button-focus-container-elevation, 1);--_focus-label-text-color: var(--md-elevated-button-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_hover-container-elevation: var(--md-elevated-button-hover-container-elevation, 2);--_hover-label-text-color: var(--md-elevated-button-hover-label-text-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-color: var(--md-elevated-button-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-opacity: var(--md-elevated-button-hover-state-layer-opacity, 0.08);--_label-text-color: var(--md-elevated-button-label-text-color, var(--md-sys-color-primary, #6750a4));--_label-text-font: var(--md-elevated-button-label-text-font, var(--md-sys-typescale-label-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-elevated-button-label-text-line-height, var(--md-sys-typescale-label-large-line-height, 1.25rem));--_label-text-size: var(--md-elevated-button-label-text-size, var(--md-sys-typescale-label-large-size, 0.875rem));--_label-text-weight: var(--md-elevated-button-label-text-weight, var(--md-sys-typescale-label-large-weight, var(--md-ref-typeface-weight-medium, 500)));--_pressed-container-elevation: var(--md-elevated-button-pressed-container-elevation, 1);--_pressed-label-text-color: var(--md-elevated-button-pressed-label-text-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-color: var(--md-elevated-button-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-opacity: var(--md-elevated-button-pressed-state-layer-opacity, 0.12);--_disabled-icon-color: var(--md-elevated-button-disabled-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-icon-opacity: var(--md-elevated-button-disabled-icon-opacity, 0.38);--_focus-icon-color: var(--md-elevated-button-focus-icon-color, var(--md-sys-color-primary, #6750a4));--_hover-icon-color: var(--md-elevated-button-hover-icon-color, var(--md-sys-color-primary, #6750a4));--_icon-color: var(--md-elevated-button-icon-color, var(--md-sys-color-primary, #6750a4));--_icon-size: var(--md-elevated-button-icon-size, 18px);--_pressed-icon-color: var(--md-elevated-button-pressed-icon-color, var(--md-sys-color-primary, #6750a4));--_container-shape-start-start: var(--md-elevated-button-container-shape-start-start, var(--md-elevated-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-start-end: var(--md-elevated-button-container-shape-start-end, var(--md-elevated-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-end: var(--md-elevated-button-container-shape-end-end, var(--md-elevated-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-start: var(--md-elevated-button-container-shape-end-start, var(--md-elevated-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_leading-space: var(--md-elevated-button-leading-space, 24px);--_trailing-space: var(--md-elevated-button-trailing-space, 24px);--_with-leading-icon-leading-space: var(--md-elevated-button-with-leading-icon-leading-space, 16px);--_with-leading-icon-trailing-space: var(--md-elevated-button-with-leading-icon-trailing-space, 24px);--_with-trailing-icon-leading-space: var(--md-elevated-button-with-trailing-icon-leading-space, 24px);--_with-trailing-icon-trailing-space: var(--md-elevated-button-with-trailing-icon-trailing-space, 16px)}
`,Tm=Sd`md-elevation{transition-duration:280ms}:host(:is([disabled],[soft-disabled])) md-elevation{transition:none}md-elevation{--md-elevation-level: var(--_container-elevation);--md-elevation-shadow-color: var(--_container-shadow-color)}:host(:focus-within) md-elevation{--md-elevation-level: var(--_focus-container-elevation)}:host(:hover) md-elevation{--md-elevation-level: var(--_hover-container-elevation)}:host(:active) md-elevation{--md-elevation-level: var(--_pressed-container-elevation)}:host(:is([disabled],[soft-disabled])) md-elevation{--md-elevation-level: var(--_disabled-container-elevation)}
`,Im=Sd`:host{border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end);box-sizing:border-box;cursor:pointer;display:inline-flex;gap:8px;min-height:var(--_container-height);outline:none;padding-block:calc((var(--_container-height) - max(var(--_label-text-line-height),var(--_icon-size)))/2);padding-inline-start:var(--_leading-space);padding-inline-end:var(--_trailing-space);place-content:center;place-items:center;position:relative;font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight);text-overflow:ellipsis;text-wrap:nowrap;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);vertical-align:top;--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity)}md-focus-ring{--md-focus-ring-shape-start-start: var(--_container-shape-start-start);--md-focus-ring-shape-start-end: var(--_container-shape-start-end);--md-focus-ring-shape-end-end: var(--_container-shape-end-end);--md-focus-ring-shape-end-start: var(--_container-shape-end-start)}:host(:is([disabled],[soft-disabled])){cursor:default;pointer-events:none}.button{border-radius:inherit;cursor:inherit;display:inline-flex;align-items:center;justify-content:center;border:none;outline:none;-webkit-appearance:none;vertical-align:middle;background:rgba(0,0,0,0);text-decoration:none;min-width:calc(64px - var(--_leading-space) - var(--_trailing-space));width:100%;z-index:0;height:100%;font:inherit;color:var(--_label-text-color);padding:0;gap:inherit;text-transform:inherit}.button::-moz-focus-inner{padding:0;border:0}:host(:hover) .button{color:var(--_hover-label-text-color)}:host(:focus-within) .button{color:var(--_focus-label-text-color)}:host(:active) .button{color:var(--_pressed-label-text-color)}.background{background:var(--_container-color);border-radius:inherit;inset:0;position:absolute}.label{overflow:hidden}:is(.button,.label,.label slot),.label ::slotted(*){text-overflow:inherit}:host(:is([disabled],[soft-disabled])) .label{color:var(--_disabled-label-text-color);opacity:var(--_disabled-label-text-opacity)}:host(:is([disabled],[soft-disabled])) .background{background:var(--_disabled-container-color);opacity:var(--_disabled-container-opacity)}@media(forced-colors: active){.background{border:1px solid CanvasText}:host(:is([disabled],[soft-disabled])){--_disabled-icon-color: GrayText;--_disabled-icon-opacity: 1;--_disabled-container-opacity: 1;--_disabled-label-text-color: GrayText;--_disabled-label-text-opacity: 1}}:host([has-icon]:not([trailing-icon])){padding-inline-start:var(--_with-leading-icon-leading-space);padding-inline-end:var(--_with-leading-icon-trailing-space)}:host([has-icon][trailing-icon]){padding-inline-start:var(--_with-trailing-icon-leading-space);padding-inline-end:var(--_with-trailing-icon-trailing-space)}::slotted([slot=icon]){display:inline-flex;position:relative;writing-mode:horizontal-tb;fill:currentColor;flex-shrink:0;color:var(--_icon-color);font-size:var(--_icon-size);inline-size:var(--_icon-size);block-size:var(--_icon-size)}:host(:hover) ::slotted([slot=icon]){color:var(--_hover-icon-color)}:host(:focus-within) ::slotted([slot=icon]){color:var(--_focus-icon-color)}:host(:active) ::slotted([slot=icon]){color:var(--_pressed-icon-color)}:host(:is([disabled],[soft-disabled])) ::slotted([slot=icon]){color:var(--_disabled-icon-color);opacity:var(--_disabled-icon-opacity)}.touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--_container-height))/2) 0}:host([touch-target=none]) .touch{display:none}
`;let Pm=class extends Am{};Pm.styles=[Im,Tm,Rm],Pm=zg([Dc("md-elevated-button")],Pm);class Nm extends km{}const Om=Sd`:host{--_container-height: var(--md-text-button-container-height, 40px);--_disabled-label-text-color: var(--md-text-button-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-text-button-disabled-label-text-opacity, 0.38);--_focus-label-text-color: var(--md-text-button-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_hover-label-text-color: var(--md-text-button-hover-label-text-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-color: var(--md-text-button-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-opacity: var(--md-text-button-hover-state-layer-opacity, 0.08);--_label-text-color: var(--md-text-button-label-text-color, var(--md-sys-color-primary, #6750a4));--_label-text-font: var(--md-text-button-label-text-font, var(--md-sys-typescale-label-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-text-button-label-text-line-height, var(--md-sys-typescale-label-large-line-height, 1.25rem));--_label-text-size: var(--md-text-button-label-text-size, var(--md-sys-typescale-label-large-size, 0.875rem));--_label-text-weight: var(--md-text-button-label-text-weight, var(--md-sys-typescale-label-large-weight, var(--md-ref-typeface-weight-medium, 500)));--_pressed-label-text-color: var(--md-text-button-pressed-label-text-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-color: var(--md-text-button-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-opacity: var(--md-text-button-pressed-state-layer-opacity, 0.12);--_disabled-icon-color: var(--md-text-button-disabled-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-icon-opacity: var(--md-text-button-disabled-icon-opacity, 0.38);--_focus-icon-color: var(--md-text-button-focus-icon-color, var(--md-sys-color-primary, #6750a4));--_hover-icon-color: var(--md-text-button-hover-icon-color, var(--md-sys-color-primary, #6750a4));--_icon-color: var(--md-text-button-icon-color, var(--md-sys-color-primary, #6750a4));--_icon-size: var(--md-text-button-icon-size, 18px);--_pressed-icon-color: var(--md-text-button-pressed-icon-color, var(--md-sys-color-primary, #6750a4));--_container-shape-start-start: var(--md-text-button-container-shape-start-start, var(--md-text-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-start-end: var(--md-text-button-container-shape-start-end, var(--md-text-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-end: var(--md-text-button-container-shape-end-end, var(--md-text-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_container-shape-end-start: var(--md-text-button-container-shape-end-start, var(--md-text-button-container-shape, var(--md-sys-shape-corner-full, 9999px)));--_leading-space: var(--md-text-button-leading-space, 12px);--_trailing-space: var(--md-text-button-trailing-space, 12px);--_with-leading-icon-leading-space: var(--md-text-button-with-leading-icon-leading-space, 12px);--_with-leading-icon-trailing-space: var(--md-text-button-with-leading-icon-trailing-space, 16px);--_with-trailing-icon-leading-space: var(--md-text-button-with-trailing-icon-leading-space, 16px);--_with-trailing-icon-trailing-space: var(--md-text-button-with-trailing-icon-trailing-space, 12px);--_container-color: none;--_disabled-container-color: none;--_disabled-container-opacity: 0}
`;let Dm=class extends Nm{};Dm.styles=[Im,Om],Dm=zg([Dc("md-text-button")],Dm);var Lm=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let Mm=class extends Ic{static get styles(){return[Jc,Yc,Sd`
        /* general styles for all buttons */
        :host {
          --background-color: var(
            --button-background-color,
            var(--default-button-background-color)
          );
          --text-color: var(
            --gr-button-text-color,
            var(--default-button-text-color)
          );
          display: inline-block;
          position: relative;
        }
        :host([hidden]) {
          display: none;
        }
        :host md-text-button,
        :host md-elevated-button {
          --md-text-button-label-text-font: var(--header-font-family);
          --md-text-button-label-text-weight: var(--font-weight-medium);
          --md-elevated-button-label-text-font: var(--header-font-family);
          --md-elevated-button-label-text-weight: var(--font-weight-medium);
          text-transform: none;
          /* This is also set in the button-label-(font|weight) css vars above. We keep this incase it is also needed. */
          font-weight: var(--font-weight-medium);
          font-family: var(--header-font-family);
          color: var(--text-color);
          --md-text-button-container-color: var(--text-color);
        }

        md-text-button,
        md-elevated-button {
          --md-text-button-label-text-font: var(--font-family, inherit);
          --md-text-button-label-text-weight: var(
            --font-weight-normal,
            inherit
          );
          --md-elevated-button-label-text-font: var(--font-family, inherit);
          --md-elevated-button-label-text-weight: var(
            --font-weight-normal,
            inherit
          );
          --md-text-button-container-color: var(--background-color);
          --md-text-button-hover-container-color: var(--background-color);
          --md-elevated-button-container-color: var(--background-color);
          --md-elevated-button-hover-container-color: var(--background-color);
          --md-sys-color-primary: var(--text-color);
          /* We set this to 0 which defaults to 12px under text-button.
            This is because for some reason it makes the size of it bigger
            which makes some of the buttons look wrong. E.g. attention set has
            a bigger width and thus a lot of space. This fixes it. */
          --md-text-button-leading-space: 0;
          --md-text-button-trailing-space: 0;
          /* Brings back the round corners we had with paper-button */
          --md-text-button-container-shape: 4px;
          --md-elevated-button-container-shape: 4px;
          /* We have a variable for setting the text colour when it is disabled */
          --md-elevated-button-disabled-label-text-color: var(--text-color);
          --md-text-button-disabled-label-text-color: var(--text-color);
          align-items: center;
          background-color: var(--background-color);
          color: var(--text-color);
          /* paper-button set this but md-(elevated|text)-button does not. So we set it. */
          font: inherit;
          /* This is also set in the button-label-(font|weight) css vars above. We keep this incase it is also needed. */
          font-family: var(--font-family, inherit);
          font-weight: var(--font-weight-normal, inherit);
          display: flex;
          justify-content: center;
          margin: var(--margin, 0);
          min-width: var(--border, 0);
          padding: var(--gr-button-padding, var(--spacing-s) var(--spacing-m));
          /* Needed to resize properly */
          --md-elevated-button-container-height: none;
          --md-text-button-container-height: none;
          cursor: pointer;
        }
        :host md-text-button:hover,
        :host md-elevated-button:hover {
          background: linear-gradient(rgba(0, 0, 0, 0.12), rgba(0, 0, 0, 0.12)),
            var(--background-color);
        }

        :host([primary]) {
          --background-color: var(--primary-button-background-color);
          --text-color: var(--primary-button-text-color);
        }
        :host([link][primary]) {
          --text-color: var(--primary-button-background-color);
        }

        /* Keep below color definition for primary so that this takes precedence
          when disabled. */
        :host([disabled]),
        :host([loading]) {
          --background-color: var(--disabled-button-background-color);
          --text-color: var(--deemphasized-text-color);
          cursor: default;
        }

        :host([disabled][flatten]) {
          --background-color: transparent;
          --text-color: var(--disabled-foreground);
        }

        /* Styles for link buttons specifically */
        :host([link]) {
          --background-color: transparent;
          --margin: 0;
        }
        :host([disabled][link]),
        :host([loading][link]) {
          --background-color: transparent;
          --text-color: var(--disabled-foreground);
          cursor: default;
        }
        gr-icon.downArrow {
          color: inherit;
        }
        .newVoteChip {
          border: 1px solid var(--border-color);
          box-shadow: none;
          box-sizing: border-box;
          min-width: 3em;
          --md-sys-color-primary: var(--vote-text-color);
        }
        .loadingSpin {
          display: inline-block;
        }
        .flex {
          display: flex;
          align-items: center;
        }
      `]}render(){const e=th({newVoteChip:this.voteChip});return this.link||this.flatten?dc`
      <md-text-button
        class=${e}
        ?disabled=${this.disabled||this.loading}
        part="md-text-button"
        touch-target="none"
        role="button"
        tabindex="-1"
      >
        <div class="flex">
          ${this.loading?dc`<span class="loadingSpin"></span>`:""}
          <slot></slot>
          ${this.renderArrowIcon()}
        </div>
      </md-text-button>
    `:dc`
        <md-elevated-button
          class=${e}
          ?disabled=${this.disabled||this.loading}
          part="md-elevated-button"
          touch-target="none"
          role="button"
          tabindex="-1"
        >
          <div class="flex">
            ${this.loading?dc`<span class="loadingSpin"></span>`:""}
            <slot></slot>
            ${this.renderArrowIcon()}
          </div>
        </md-elevated-button>
      `}renderArrowIcon(){return this.downArrow?dc`<gr-icon icon="arrow_drop_down" class="downArrow"></gr-icon>`:uc}constructor(){super(),this.voteChip=!1,this.downArrow=!1,this.link=!1,this.flatten=!1,this.loading=!1,this.disabled=null,this.reporting=Xn().reportingService,this.shortcuts=new Gg(this),this.initialTabindex=this.getAttribute("tabindex")||"0",this.addEventListener("click",(e=>this.handleAction(e))),this.shortcuts.addLocal({key:Mn.ENTER},(()=>this.click())),this.shortcuts.addLocal({key:Mn.SPACE},(()=>this.click()))}updated(e){e.has("disabled")&&this.setAttribute("tabindex",this.disabled?"-1":this.initialTabindex||"0"),(e.has("loading")||e.has("disabled"))&&this.setAttribute("aria-disabled",this.disabled||this.loading?"true":"false")}connectedCallback(){super.connectedCallback(),this.getAttribute("role")||this.setAttribute("role","button"),this.getAttribute("tabindex")||this.setAttribute("tabindex","0")}handleAction(e){if(this.disabled||this.loading)return e.preventDefault(),e.stopPropagation(),void e.stopImmediatePropagation();this.reporting.reportInteraction(ga.BUTTON_CLICK,{path:Tn(e),text:this.innerText.toUpperCase()})}};Lm([Fc({type:Boolean,reflect:!0})],Mm.prototype,"voteChip",void 0),Lm([Fc({type:Boolean,attribute:"down-arrow"})],Mm.prototype,"downArrow",void 0),Lm([Fc({type:Boolean,reflect:!0})],Mm.prototype,"link",void 0),Lm([Fc({type:Boolean,reflect:!0})],Mm.prototype,"flatten",void 0),Lm([Fc({type:Boolean,reflect:!0})],Mm.prototype,"loading",void 0),Lm([Fc({type:Boolean,reflect:!0})],Mm.prototype,"disabled",void 0),Mm=Lm([Dc("gr-button")],Mm);const Fm="important",Um=" !"+Fm,Bm=Zc(class extends eh{constructor(e){if(super(e),1!==e.type||"style"!==e.name||e.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(e){return Object.keys(e).reduce(((t,i)=>{const r=e[i];return null==r?t:t+`${i=i.includes("-")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`}),"")}update(e,[t]){const{style:i}=e.element;if(void 0===this.ft)return this.ft=new Set(Object.keys(t)),this.render(t);for(const e of this.ft)null==t[e]&&(this.ft.delete(e),e.includes("-")?i.removeProperty(e):i[e]=null);for(const e in t){const r=t[e];if(null!=r){this.ft.add(e);const t="string"==typeof r&&r.endsWith(Um);e.includes("-")||t?i.setProperty(e,t?r.slice(0,-11):r,t?Fm:""):i[e]=r}}return pc}});var Hm=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let jm=class extends Ic{constructor(){super(...arguments),this.text="",this.maxWidth="",this.arrowCenterOffset="0",this.positionBelow=!1}static get styles(){return[Nc,Sd`
        :host {
          --gr-tooltip-arrow-size: 0.5em;

          background-color: var(--tooltip-background-color);
          box-shadow: var(--elevation-level-2);
          color: var(--tooltip-text-color);
          font-size: var(--font-size-small);
          position: absolute;
          z-index: 1000;
        }
        :host .tooltip {
          padding: var(--spacing-m) var(--spacing-l);
        }
        :host .arrowPositionBelow,
        :host([position-below]) .arrowPositionAbove {
          display: none;
        }
        :host([position-below]) .arrowPositionBelow {
          display: initial;
        }
        .arrow {
          border-left: var(--gr-tooltip-arrow-size) solid transparent;
          border-right: var(--gr-tooltip-arrow-size) solid transparent;
          height: 0;
          position: absolute;
          left: calc(50% - var(--gr-tooltip-arrow-size));
          width: 0;
        }
        .arrowPositionAbove {
          border-top: var(--gr-tooltip-arrow-size) solid
            var(--tooltip-background-color);
          bottom: calc(-1 * var(--gr-tooltip-arrow-size));
        }
        .arrowPositionBelow {
          border-bottom: var(--gr-tooltip-arrow-size) solid
            var(--tooltip-background-color);
          top: calc(-1 * var(--gr-tooltip-arrow-size));
        }
        .text {
          white-space: pre-wrap;
        }
      `]}render(){return this.style.maxWidth=this.maxWidth,dc` <div class="tooltip" aria-live="polite" role="tooltip">
      <i
        class="arrowPositionBelow arrow"
        style=${Bm({marginLeft:this.arrowCenterOffset})}
      ></i>
      <div class="text">${this.text.split(";").map((e=>dc`${e}<br />`))}</div>
      <i
        class="arrowPositionAbove arrow"
        style=${Bm({marginLeft:this.arrowCenterOffset})}
      ></i>
    </div>`}};Hm([Fc({type:String})],jm.prototype,"text",void 0),Hm([Fc({type:String})],jm.prototype,"maxWidth",void 0),Hm([Fc({type:String})],jm.prototype,"arrowCenterOffset",void 0),Hm([Fc({type:Boolean,reflect:!0,attribute:"position-below"})],jm.prototype,"positionBelow",void 0),jm=Hm([Dc("gr-tooltip")],jm);var Gm=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let zm=class extends Ic{constructor(){super(),this.hasTooltip=!1,this.lightTooltip=!1,this.positionBelow=!1,this.showIcon=!1,this.isTouchDevice="ontouchstart"in document.documentElement,this.tooltip=null,this.originalTitle="",this.hasSetupTooltipListeners=!1,this.windowScrollHandler=()=>this._handleWindowScroll(),this.showHandler=()=>this._handleShowTooltip(),this.hideHandler=e=>this._handleHideTooltip(e)}disconnectedCallback(){this._handleHideTooltip(void 0),this.removeEventListener("mouseenter",this.showHandler),window.removeEventListener("scroll",this.windowScrollHandler),super.disconnectedCallback()}static get styles(){return[Sd`
        gr-icon {
          font-size: var(--line-height-normal);
        }
      `]}render(){return dc`
      <slot></slot>
      ${this.renderIcon()}
    `}renderIcon(){if(this.showIcon)return dc`<gr-icon icon="info" filled></gr-icon>`}updated(e){e.has("hasTooltip")&&this.setupTooltipListeners()}setupTooltipListeners(){this.hasTooltip?this.hasSetupTooltipListeners||(this.hasSetupTooltipListeners=!0,this.addEventListener("mouseenter",this.showHandler)):this.hasSetupTooltipListeners&&(this.removeEventListener("mouseenter",this.showHandler),this.hasSetupTooltipListeners=!1)}async _handleShowTooltip(){if(this.isTouchDevice)return;if(!this.hasAttribute("title")||""===this.getAttribute("title")||this.tooltip)return;this.originalTitle=this.getAttribute("title")||"",this.setAttribute("title","");const e=document.createElement("gr-tooltip");e.text=this.originalTitle,e.maxWidth=this.getAttribute("max-width")||"",e.positionBelow=this.hasAttribute("position-below"),this.tooltip=e,e.style.visibility="hidden",e.style.top="0",e.style.left="0",this.getTooltipParent(this).appendChild(e),await e.updateComplete,this._positionTooltip(e),e.style.visibility="initial",window.addEventListener("scroll",this.windowScrollHandler),this.addEventListener("mouseleave",this.hideHandler),this.addEventListener("click",this.hideHandler),this.lightTooltip||e.addEventListener("mouseleave",this.hideHandler)}getTooltipParent(e){return e===document.body||e instanceof HTMLDialogElement?e:e instanceof ShadowRoot?this.getTooltipParent(e.host):e.parentNode?this.getTooltipParent(e.parentNode):document.body}_handleHideTooltip(e){this.isTouchDevice||this.hasAttribute("title")&&this.originalTitle&&(!this.lightTooltip&&e?.relatedTarget===this.tooltip||e?.relatedTarget===this||(window.removeEventListener("scroll",this.windowScrollHandler),this.removeEventListener("mouseleave",this.hideHandler),this.removeEventListener("click",this.hideHandler),this.setAttribute("title",this.originalTitle),this.lightTooltip||this.tooltip?.removeEventListener("mouseleave",this.hideHandler),this.tooltip?.parentNode&&this.tooltip.parentNode.removeChild(this.tooltip),this.tooltip=null))}_handleWindowScroll(){this.tooltip&&this.updateComplete.then((()=>this._positionTooltip(this.tooltip)))}_positionTooltip(e){if(null===e)return;const t=this.getBoundingClientRect(),i=e.getBoundingClientRect();if(!e.parentElement)return;const r=e.parentElement.getBoundingClientRect(),o=e.parentElement.clientWidth,s=.5*(t.left+t.right)-r.left,n=this.computeLeft(i,s,o),{isBelow:a,top:l}=this.computeTop(i,t,r),d=n+.5*i.width;e.arrowCenterOffset=s-d+"px",e.positionBelow=a,e.style.top=`${l}px`,e.style.left=`${n}px`}computeLeft(e,t,i){let r=t-.5*e.width;return r+e.width>i-1&&(r=i-e.width-1),Math.max(0,r)}computeTop(e,t,i){const r=t.top-i.top-e.height-7.2;return this.positionBelow||r<0?{isBelow:!0,top:t.bottom-i.top+7.2}:{isBelow:!1,top:r}}};Gm([Fc({type:Boolean,attribute:"has-tooltip",reflect:!0})],zm.prototype,"hasTooltip",void 0),Gm([Fc({type:Boolean,attribute:"light-tooltip",reflect:!0})],zm.prototype,"lightTooltip",void 0),Gm([Fc({type:Boolean,attribute:"position-below",reflect:!0})],zm.prototype,"positionBelow",void 0),Gm([Fc({type:String,attribute:"max-width",reflect:!0})],zm.prototype,"maxWidth",void 0),Gm([Fc({type:Boolean,attribute:"show-icon"})],zm.prototype,"showIcon",void 0),Gm([Uc()],zm.prototype,"isTouchDevice",void 0),Gm([Uc()],zm.prototype,"originalTitle",void 0),zm=Gm([Dc("gr-tooltip-content")],zm);const Vm=864e5;function Wm(e){return new Date(e.replace(" ","T")+"Z")}function qm(e){return e instanceof Date&&!isNaN(e.valueOf())}function Km(e,t=!1){return Ym(e,new Date,"",t?"":"ago")}function Ym(e,t,i="",r=""){i=i?`${i.trim()} `:"",r=r?` ${r.trim()}`:"";const o=Math.floor((t.valueOf()-e.valueOf())/1e3);if(o<=59)return i||r?"just now":`${o} seconds`;if(o<=119)return`${i}1 minute${r}`;const s=Math.floor(o/60);if(s<=59)return`${i}${s} minutes${r}`;if(60===s)return`${i}1 hour${r}`;if(s<=119)return`${i}1 hour ${s-60} min${r}`;const n=Math.floor(s/60);if(n<=23)return`${i}${n} hours${r}`;if(24===n)return`${i}1 day${r}`;if(n<=47)return`${i}1 day ${n-24} hr${r}`;const a=Math.floor(n/24);if(a<=30)return`${i}${a} days${r}`;if(a<=60)return`${i}1 month${r}`;const l=Math.floor(a/30);return l<=11?`${i}${l} months${r}`:12===l?`${i}1 year${r}`:l<=24?`${i}1 year ${l-12} m${r}`:`${i}${Math.floor(a/365)} years${r}`}function Xm(e,t){return Math.abs(e.valueOf()-t.valueOf())<Vm&&t.getDay()===e.getDay()}function Jm(e,t){const i={};t.includes("MM")&&(t.includes("MMM")?i.month="short":i.month="2-digit"),t.includes("YY")&&(t.includes("YYYY")?i.year="numeric":i.year="2-digit"),t.includes("ddd")&&(t.includes("dddd")?i.weekday="long":i.weekday="short"),t.includes("DD")&&(i.day="2-digit"),t.includes("HH")&&(i.hour="2-digit",i.hour12=!1),t.includes("h")&&(i.hour="numeric",i.hour12=!0),t.includes("mm")&&(i.minute="2-digit"),t.includes("ss")&&(i.second="2-digit");let r="en-US";t.includes("HH")&&(r="en-GB");const o=new Intl.DateTimeFormat(r,i).formatToParts(e),s={};for(const e of o)switch(e.type){case"year":s.year=e.value;break;case"month":s.month=e.value;break;case"day":s.day=e.value;break;case"hour":s.hour=e.value;break;case"minute":s.minute=e.value;break;case"second":s.second=e.value;break;case"dayPeriod":s.dayPeriod=e.value;break;case"weekday":s.weekday=e.value}return s.year&&t.includes("YY")&&(t=t.includes("YYYY")?t.replace("YYYY",s.year):t.replace("YY",s.year)),s.day&&t.includes("DD")&&(t=t.replace("DD",s.day)),s.hour&&t.includes("HH")&&(t=t.replace("HH",s.hour)),s.hour&&t.includes("h")&&(t=t.replace("h",s.hour)),s.minute&&t.includes("mm")&&(t=t.replace("mm",s.minute)),s.second&&t.includes("ss")&&(t=t.replace("ss",s.second)),s.dayPeriod&&t.includes("A")&&(t=t.replace("A",s.dayPeriod.toUpperCase())),s.month&&t.includes("MM")&&(t=t.includes("MMM")?t.replace("MMM",s.month):t.replace("MM",s.month)),s.weekday&&t.includes("ddd")&&(t=t.includes("dddd")?t.replace("dddd",s.weekday):t.replace("ddd",s.weekday)),t}function Qm(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var i=e[0];if(dh(i))return Zm(i,null);if(ch(i)&&Object.getPrototypeOf(i)===Object.prototype){var r=Object.keys(i);return Zm(r.map((function(e){return i[e]})),r)}}if("function"==typeof e[e.length-1]){var o=e.pop();return Zm(e=1===e.length&&dh(e[0])?e[0]:e,null).pipe(ep((function(e){return o.apply(void 0,e)})))}return Zm(e,null)}function Zm(e,t){return new wh((function(i){var r=e.length;if(0!==r)for(var o=new Array(r),s=0,n=0,a=function(a){var l=Qh(e[a]),d=!1;i.add(l.subscribe({next:function(e){d||(d=!0,n++),o[a]=e},error:function(e){return i.error(e)},complete:function(){++s!==r&&d||(n===r&&i.next(t?t.reduce((function(e,t,i){return e[t]=o[i],e}),{}):o),i.complete())}}))},l=0;l<r;l++)a(l);else i.complete()}))}function ef(e,t,i,r){return oh(i)&&(r=i,i=void 0),r?ef(e,t,i).pipe(ep((function(e){return dh(e)?r.apply(void 0,e):r(e)}))):new wh((function(r){tf(e,t,(function(e){arguments.length>1?r.next(Array.prototype.slice.call(arguments)):r.next(e)}),r,i)}))}function tf(e,t,i,r,o){var s;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){var n=e;e.addEventListener(t,i,o),s=function(){return n.removeEventListener(t,i,o)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){var a=e;e.on(t,i),s=function(){return a.off(t,i)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){var l=e;e.addListener(t,i),s=function(){return l.removeListener(t,i)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var d=0,c=e.length;d<c;d++)tf(e[d],t,i,r,o)}r.add(s)}var rf,of;function sf(e,t){const i=new Map,r=new Map;return function e(t,o){if(t===o)return!0;if(void 0===t||void 0===o)return!1;if(null===t||null===o)return!1;if(t instanceof Date||o instanceof Date)return t instanceof Date&&o instanceof Date&&t.getTime()===o.getTime();if(r?.get(t)?.has(o))return!0;if(t instanceof Set||o instanceof Set){if(!(t instanceof Set&&o instanceof Set))return!1;if(t.size!==o.size)return!1;for(const e of t)if(!o.has(e))return!1;return r.set(t,(r.get(t)??new Set).add(o)),!0}if(t instanceof Map||o instanceof Map){if(!(t instanceof Map&&o instanceof Map))return!1;if(t.size!==o.size)return!1;if(i.get(t)?.has(o))return!0;i.set(t,(i.get(t)??new Set).add(o));for(const[i,r]of t.entries())if(!o.has(i)||!e(r,o.get(i)))return!1;return i.get(t).delete(o),r.set(t,(r.get(t)??new Set).add(o)),!0}if("object"==typeof t){if("object"!=typeof o)return!1;if(i.get(t)?.has(o))return!0;i.set(t,(i.get(t)??new Set).add(o));const s=t,n=o,a=Object.keys(s),l=Object.keys(n);if(a.length!==l.length)return!1;for(const t of a)if(!e(s[t],n[t]))return!1;return i.get(t).delete(o),r.set(t,(r.get(t)??new Set).add(o)),!0}return!1}(e,t)}function nf(e,t){return!sf(e,t)}function af(e){if(!e)throw new Error("undefined object for deepClone");return JSON.parse(JSON.stringify(e))}function lf(e,t){return e.pipe(ep(t),xp(sf),zp(1))}class df{constructor(e){this.stateUpdateInProgress=!1,this.subscriptions=[],this.subject$=new Up(e),this.state$=this.subject$.asObservable()}getState(){return this.subject$.getValue()}setState(e){if(this.stateUpdateInProgress)setTimeout((()=>this.setState(e)));else if(!sf(e,this.getState()))try{this.stateUpdateInProgress=!0,this.subject$.next(e)}finally{this.stateUpdateInProgress=!1}}updateState(e){this.stateUpdateInProgress?setTimeout((()=>this.updateState(e))):this.setState({...this.getState(),...e})}finalize(){this.subject$.complete();for(const e of this.subscriptions)e.unsubscribe();this.subscriptions=[]}}function cf(e){return null!=e}function hf(e){return!!e.path}function pf(e){return!!e&&Number.isInteger(e)&&e>0}!function(e){e.AUTH="AUTH",e.NETWORK="NETWORK",e.GENERIC="GENERIC"}(rf||(rf={})),function(e){e.NOT_LOADED="NOT_LOADED",e.LOADING="LOADING",e.LOADED="LOADED"}(of||(of={}));const uf={LABELS:0,DETAILED_LABELS:8,CURRENT_REVISION:1,ALL_REVISIONS:2,CURRENT_COMMIT:3,ALL_COMMITS:4,CURRENT_FILES:5,ALL_FILES:6,DETAILED_ACCOUNTS:7,MESSAGES:9,CURRENT_ACTIONS:10,REVIEWED:11,DOWNLOAD_COMMANDS:13,WEB_LINKS:14,CHECK:15,CHANGE_ACTIONS:16,COMMIT_FOOTERS:17,PUSH_CERTIFICATES:18,REVIEWER_UPDATES:19,SUBMITTABLE:20,TRACKING_IDS:21,SKIP_MERGEABLE:22,SKIP_DIFFSTAT:23,SUBMIT_REQUIREMENTS:24,CUSTOM_KEYED_VALUES:25,STAR:26,PARENTS:27};function gf(e){const t=e;return void 0!==t._account_id||void 0!==t.email}function mf(e){return void 0!==e.id}var ff,vf,bf;function yf(e){return!!e&&void 0!==e.savingState}function wf(e){return!!e&&e.savingState===bf.SAVING}function _f(e){return!!e&&e.savingState===bf.ERROR}function xf(e){return!!e&&!!e.client_id&&!e.id}function Cf(e){return void 0!==e.account}function Ef(e){return void 0!==e.group}function Sf(){return"undefined"==typeof window?"":self.CANONICAL_PATH||""}function $f(e,t){return e.endsWith("/")&&(e=e.slice(0,-1)),t.startsWith("/")&&(t=t.slice(1)),`${e}/${t}`}function kf(){return`${Sf()}/`}function Af(e){if(e.startsWith("http"))return e;if(e.startsWith("/"))return window.location.origin+e;throw new Error(`Cannot prepend origin to relative path '${e}'.`)}function Rf(e){let t=e.replaceAll("%","%25");return t=t.replaceAll("+","%2B"),t=encodeURIComponent(t),t=t.replace(/%3A/g,":"),t=t.replace(/%40/g,"@"),t=t.replace(/%2F/g,"/"),t=t.replace(/%20/g,"+"),t}function Tf(e){const t=e.replace(/\+/g,"%20");return decodeURIComponent(t)}function If(e){if(!e)return!1;let t;try{t=new URL(e,window.location.origin)}catch(e){if(e instanceof TypeError)return!1;throw e}return t.origin===window.location.origin}!function(e){e.ADD_USER="ADD_USER",e.REMOVE_USER="REMOVE_USER",e.ADD_GROUP="ADD_GROUP",e.REMOVE_GROUP="REMOVE_GROUP"}(ff||(ff={})),function(e){e.ABANDONED="Abandoned",e.ACTIVE="Active",e.MERGE_CONFLICT="Merge Conflict",e.GIT_CONFLICT="Git Conflict",e.MERGED="Merged",e.PRIVATE="Private",e.READY_TO_SUBMIT="Ready to submit",e.REVERT="Revert",e.REVERT_CREATED="Revert Created",e.REVERT_SUBMITTED="Revert Submitted",e.WIP="WIP"}(vf||(vf={})),function(e){e.OK="OK",e.SAVING="SAVING",e.ERROR="ERROR"}(bf||(bf={}));class Pf extends Error{constructor(e,t="Retry Error"){super(t),this.payload=e}}class Nf{constructor(e,t,i,r=1.618){this.base=e,this.maxRetry=t,this.backoffIntervalMs=i,this.backoffFactor=r}async schedule(e){let t=0,i=this.backoffIntervalMs;const r=async()=>{try{return await this.base.schedule(e)}catch(e){if(e instanceof Pf&&t++<this.maxRetry)return await(o=i,new Promise((e=>window.setTimeout(e,o)))),i*=this.backoffFactor,await r();throw e}var o};return r()}}const Of="X-Gerrit-Request-Origin";async function Df(e){const t=await e.text();let i;try{i=Lf(t)}catch(e){throw new Error(`Response payload is not prefixed json. Payload: ${t}`)}return{parsed:i,raw:t}}function Lf(e){return JSON.parse(e.substring(4))}function Mf(e){return Sf()?e.startsWith(Sf())?e:Sf()+e:e}function Ff(e,t){if(t)throw t;if(e)return e.text().then((t=>{let i=`Error ${e.status}`;throw e.statusText&&(i+=` (${e.statusText})`),t&&(i+=`: ${t}`),new Error(i)}))}function Uf(e){const t={method:e.method,headers:new Headers};if(e.body&&(t.headers.set("Content-Type",e.contentType||"application/json"),t.body="string"==typeof e.body?e.body:JSON.stringify(e.body)),e.requestOrigin&&t.headers.set(Of,e.requestOrigin),e.headers)for(const[i,r]of Object.entries(e.headers))t.headers.set(i,r);return t}class Bf{constructor(e,t,i,r,o){this._cache=e,this._auth=t,this._fetchPromisesCache=i,this.readScheduler=r,this.writeScheduler=o}schedule(e,t){return"PUT"===e||"POST"===e||"DELETE"===e?this.writeScheduler.schedule(t):this.readScheduler.schedule(t)}fetchImpl(e){const t=e.fetchOptions?.method??Uu.GET,i=Date.now(),r=this.schedule(t,(async()=>{const t=await this._auth.fetch(e.url,e.fetchOptions);if(!t.ok&&429===t.status)throw new Pf(t);return t})).catch((e=>{if(e instanceof Pf)return e.payload;throw e}));return r.then((t=>this.logCall(e,i,t.status))),r}logCall(e,t,i){const r=e.fetchOptions&&e.fetchOptions.method?e.fetchOptions.method:"GET",o=Date.now(),s=o-t,n=new Date(t),a=new Date(o);if(console.debug(["HTTP",i,r,`${s}ms`,e.anonymizedUrl||e.url,`(${n.toISOString()}, ${a.toISOString()})`].join(" ")),e.anonymizedUrl){const t={status:i,method:r,elapsed:s,anonymizedUrl:e.anonymizedUrl};Jn(document,"gr-rpc-log",t)}}async fetch(e){e.fetchOptions||(e.fetchOptions={}),e.fetchOptions.headers||(e.fetchOptions.headers=new Headers),e.fetchOptions.headers.get(Of)||e.fetchOptions.headers.set(Of,"core-ui");const t=this.urlWithParams(e.url,e.params),i={url:t,fetchOptions:e.fetchOptions,anonymizedUrl:e.reportUrlAsIs?t:e.anonymizedUrl};let r;try{r=await this.fetchImpl(i)}catch(t){const i=new Error(`Network error when trying to fetch. Cause: ${t.message}`);throw i.stack=(i.stack??"")+"\n"+(t.stack??""),e.errFn?await e.errFn.call(void 0,null,i):Jn(document,"network-error",{error:i}),i}return e.reportServerError&&!r.ok&&(e.errFn?await e.errFn.call(void 0,r):ra(r,e)),r}async fetchJSON(e,t){t||(e=this.addAcceptJsonHeader(e)),e.reportServerError??=!0;const i=await this.fetch(e);if(i.ok)return(await Df(i)).parsed}urlWithParams(e,t){if(!t)return Sf()+e;const i=[];for(const[e,r]of Object.entries(t))if(null!=r)if(Array.isArray(r))for(const t of r)i.push(`${this.encodeRFC5987(e)}=${this.encodeRFC5987(t)}`);else i.push(`${this.encodeRFC5987(e)}=${this.encodeRFC5987(r)}`);else i.push(this.encodeRFC5987(e));return Sf()+e+"?"+i.join("&")}encodeRFC5987(e){return encodeURIComponent(e).replace(/['()*]/g,(e=>"%"+e.charCodeAt(0).toString(16)))}addAcceptJsonHeader(e){return e.fetchOptions||(e.fetchOptions={}),e.fetchOptions.headers||(e.fetchOptions.headers=new Headers),e.fetchOptions.headers.has("Accept")||e.fetchOptions.headers.append("Accept","application/json"),e}fetchCacheJSON(e){const t=this.urlWithParams(e.url,e.params);return this._fetchPromisesCache.has(t)?this._fetchPromisesCache.get(t):this._cache.has(t)?Promise.resolve(this._cache.get(t)):(this._fetchPromisesCache.set(t,this.fetchJSON(e).then((e=>(void 0!==e&&this._cache.set(t,e),this._fetchPromisesCache.set(t,void 0),e))).catch((e=>{throw this._fetchPromisesCache.set(t,void 0),e}))),this._fetchPromisesCache.get(t))}invalidateFetchPromisesPrefix(e){this._fetchPromisesCache.invalidatePrefix(e),this._cache.invalidatePrefix(e)}}function Hf(e){const t=e.change_table??[];return 0===t.length?Object.values(dg):t.map((e=>"Project"===e?dg.REPO:e)).map((e=>" Status "===e?dg.STATUS:e))}const jf=mu("user-model");class Gf extends df{constructor(e){super({accountLoaded:!1}),this.restApiService=e,this.account$=lf(this.state$,(e=>e.account)),this.emails$=lf(this.state$,(e=>e.emails)).pipe(Zp((e=>{void 0===e&&this.loadEmails()}))),this.loadedAccount$=lf(this.state$.pipe($p((e=>e.accountLoaded))),(e=>e.account)),this.loggedIn$=lf(this.account$,(e=>!!e)),this.capabilities$=lf(this.state$,(e=>e.capabilities)),this.isAdmin$=lf(this.capabilities$,(e=>e?.administrateServer??!1)),this.preferences$=lf(this.state$,(e=>e.preferences)).pipe($p(cf)),this.diffPreferences$=lf(this.state$,(e=>e.diffPreferences)).pipe($p(cf)),this.editPreferences$=lf(this.state$,(e=>e.editPreferences)).pipe($p(cf)),this.preferenceDiffViewMode$=lf(this.preferences$,(e=>e.diff_view??Su.SIDE_BY_SIDE)),this.preferenceTheme$=lf(this.preferences$,(e=>e.theme)),this.myMenuItems$=lf(this.preferences$,(e=>e?.my??[])),this.preferenceChangesPerPage$=lf(this.preferences$,(e=>e.changes_per_page)),this.loadAccount(),this.subscriptions=[this.loadedAccount$.pipe(Vp((e=>e?Qh(this.restApiService.getPreferences()):Zh(Eg())))).subscribe((e=>{this.setPreferences(e??Eg())})),this.loadedAccount$.pipe(Vp((e=>e?Qh(this.restApiService.getDiffPreferences()):Zh({context:10,cursor_blink_rate:0,font_size:12,ignore_whitespace:"IGNORE_NONE",line_length:100,line_wrapping:!1,show_line_endings:!0,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8})))).subscribe((e=>{this.setDiffPreferences(e??{context:10,cursor_blink_rate:0,font_size:12,ignore_whitespace:"IGNORE_NONE",line_length:100,line_wrapping:!1,show_line_endings:!0,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8})})),this.loadedAccount$.pipe(Vp((e=>e?Qh(this.restApiService.getEditPreferences()):Zh({auto_close_brackets:!1,cursor_blink_rate:0,hide_line_numbers:!1,hide_top_menu:!1,indent_unit:2,indent_with_tabs:!1,line_length:100,line_wrapping:!1,match_brackets:!0,show_base:!1,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8})))).subscribe((e=>{this.setEditPreferences(e??{auto_close_brackets:!1,cursor_blink_rate:0,hide_line_numbers:!1,hide_top_menu:!1,indent_unit:2,indent_with_tabs:!1,line_length:100,line_wrapping:!1,match_brackets:!0,show_base:!1,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8})})),this.loadedAccount$.pipe(Vp((e=>e?Qh(this.restApiService.getAccountCapabilities()):Zh(void 0)))).subscribe((e=>{this.setCapabilities(e)}))]}updatePreferences(e){return this.setPreferences({...this.getState().preferences??Eg(),...e}),this.restApiService.savePreferences(e).then((e=>{if(e)return this.setPreferences(e),e}))}updateDiffPreference(e){return this.restApiService.saveDiffPreferences(e).then((e=>Df(e).then((e=>{const t=e.parsed;t&&this.setDiffPreferences(t)}))))}updateEditPreference(e){return this.restApiService.saveEditPreferences(e).then((e=>Df(e).then((e=>{const t=e.parsed;t&&this.setEditPreferences(t)}))))}getDiffPreferences(){return this.restApiService.getDiffPreferences().then((e=>{e&&this.setDiffPreferences(e)}))}setPreferences(e){this.updateState({preferences:e})}setDiffPreferences(e){this.updateState({diffPreferences:e})}setEditPreferences(e){this.updateState({editPreferences:e})}setCapabilities(e){this.updateState({capabilities:e})}setAccount(e){this.updateState({account:e,accountLoaded:!0})}setAccountEmails(e){this.updateState({emails:e})}loadAccount(e){return e&&this.restApiService.invalidateAccountsDetailCache(),this.restApiService.getAccount().then((e=>{this.setAccount(e)}))}loadEmails(e){return e&&this.restApiService.invalidateAccountsEmailCache(),this.restApiService.getAccountEmails().then((e=>{this.setAccountEmails(e)}))}}function zf(e,t,i){if(e.isConnected)throw new Error("Subscriptions should happen before a component is connected");const r=new Vf(t,i);e.addController(r)}Error;class Vf{constructor(e,t){this.provider=e,this.callback=t}hostConnected(){this.sub=this.provider().subscribe((e=>this.update(e)))}update(e){this.callback(e)}hostDisconnected(){this.sub?.unsubscribe()}}var Wf=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const qf="h:mm A",Kf={short:"MMM DD",full:"MMM DD, YYYY"},Yf={short:"MM/DD",full:"MM/DD/YY"},Xf={short:"MM-DD",full:"YYYY-MM-DD"},Jf={short:"DD. MMM",full:"DD.MM.YYYY"},Qf={short:"DD/MM",full:"DD/MM/YYYY"};let Zf=class extends Ic{static get styles(){return[Sd`
        host {
          color: inherit;
          display: inline;
        }
      `]}constructor(){super(),this.dateStr=void 0,this.showDateAndTime=!1,this.withTooltip=!1,this.showYesterday=!1,this.forceRelative=!1,this.relativeOptionNoAgo=!1,this.relative=!1,this.getUserModel=yu(this,jf),zf(this,(()=>this.getUserModel().preferences$),(e=>this.setPreferences(e)))}setPreferences(e){this.decideDateFormat(e.date_format),this.decideTimeFormat(e.time_format),this.relative=this.forceRelative||Boolean(e?.relative_date_in_change_table)}render(){if(!this.withTooltip)return this.renderDateString();const e=this.computeFullDateStr();return e?dc`
      <gr-tooltip-content has-tooltip title=${e}>
        ${this.renderDateString()}
      </gr-tooltip-content>
    `:this.renderDateString()}renderDateString(){return dc` <span>${this.computeDateStr()}</span>`}getUtcOffsetString(){return function(){const e=-(new Date).getTimezoneOffset(),t=e=>{const t=Math.floor(Math.abs(e));return(t<10?"0":"")+t.toString()};return` UTC${e>=0?"+":"-"}${t(e/60)}:${t(e%60)}`}()}decideTimeFormat(e){switch(e){case vg.HHMM_12:this.timeFormat=qf;break;case vg.HHMM_24:this.timeFormat="HH:mm";break;default:fa(e,`Invalid time format: ${e}`)}}decideDateFormat(e){switch(e){case fg.STD:this.dateFormat=Kf;break;case fg.US:this.dateFormat=Yf;break;case fg.ISO:this.dateFormat=Xf;break;case fg.EURO:this.dateFormat=Jf;break;case fg.UK:this.dateFormat=Qf;break;default:fa(e,`Invalid date format: ${e}`)}}computeDateStr(){if(!this.dateStr||!this.timeFormat||!this.dateFormat)return"";const e=Wm(this.dateStr);if(!qm(e))return"";if(this.relative)return function(e,t=!1){return new Date>e?Km(e,t):function(e,t=!1){return Ym(new Date,e,t?"":"in","")}(e,t)}(e,this.relativeOptionNoAgo);const t=new Date;let i=this.dateFormat.full;if(Xm(t,e))i=this.timeFormat;else{if(this.showYesterday&&function(e,t){return e.valueOf()-t.valueOf()<Vm&&t.getDay()!==e.getDay()||(e.setDate(e.getDate()-1),Xm(e,t))}(t,e))return`Yesterday at ${Jm(e,this.timeFormat)}`;(function(e,t){return Math.abs(e.valueOf()-t.valueOf())<15552e6})(t,e)&&(i=this.dateFormat.short),this.showDateAndTime&&(i=`${i} ${this.timeFormat}`)}return Jm(e,i)}computeFullDateStr(){if(!this.dateStr)return"";if(!this.timeFormat)return"";if(!this.dateFormat)return"";const e=Wm(this.dateStr);if(!qm(e))return"";const t=this.timeFormat===qf?"h:mm:ss A":"HH:mm:ss";return Jm(e,`dddd, ${this.dateFormat.full}, ${t}`)+this.getUtcOffsetString()}};Wf([Fc({type:String})],Zf.prototype,"dateStr",void 0),Wf([Fc({type:Boolean})],Zf.prototype,"showDateAndTime",void 0),Wf([Fc({type:Boolean})],Zf.prototype,"withTooltip",void 0),Wf([Fc({type:Boolean})],Zf.prototype,"showYesterday",void 0),Wf([Fc({type:Boolean})],Zf.prototype,"forceRelative",void 0),Wf([Fc({type:Boolean})],Zf.prototype,"relativeOptionNoAgo",void 0),Wf([Uc()],Zf.prototype,"dateFormat",void 0),Wf([Uc()],Zf.prototype,"timeFormat",void 0),Wf([Uc()],Zf.prototype,"relative",void 0),Zf=Wf([Dc("gr-date-formatter")],Zf);var ev=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};function tv(e){if(!e)return"";switch(e){case Mu.ADDED:return"Added";case Mu.COPIED:return"Copied";case Mu.DELETED:return"Deleted";case Mu.MODIFIED:return"Modified";case Mu.RENAMED:return"Renamed";case Mu.REWRITTEN:return"Rewritten";case Mu.UNMODIFIED:return"Unchanged";case Mu.REVERTED:return"Reverted";default:fa(e,`Unsupported status: ${e}`)}}let iv=class extends Ic{constructor(){super(...arguments),this.newlyChanged=!1,this.labelPostfix=""}static get styles(){return[Sd`
        :host {
          display: inline-block;
        }
        div.status {
          display: inline-block;
          line-height: var(--line-height-normal);
          width: var(--line-height-normal);
          text-align: center;
          border-radius: var(--border-radius);
          background-color: transparent;
          color: var(--file-status-font-color);
        }
        div.status gr-icon {
          color: var(--file-status-font-color);
        }
        div.status.M {
          border: 1px solid var(--border-color);
          line-height: calc(var(--line-height-normal) - 2px);
          width: calc(var(--line-height-normal) - 2px);
          color: var(--deemphasized-text-color);
        }
        div.status.A {
          background-color: var(--file-status-added);
        }
        div.status.D {
          background-color: var(--file-status-deleted);
        }
        div.status.R,
        div.status.W {
          background-color: var(--file-status-renamed);
        }
        div.status.U {
          background-color: var(--file-status-unchanged);
        }
        div.status.X {
          background-color: var(--file-status-reverted);
        }
        .size-16 {
          font-size: 16px;
          position: relative;
          top: 2px;
        }
      `]}render(){return dc`${this.renderNewlyChanged()}${this.renderStatus()}`}renderStatus(){const e=["status",this.status];return dc`
      <gr-tooltip-content
        title=${this.computeLabel()}
        has-tooltip
        aria-label=${tv(this.status)}
      >
        <div class=${e.join(" ")} aria-hidden="true">
          ${this.renderIconOrLetter()}
        </div>
      </gr-tooltip-content>
    `}renderIconOrLetter(){return this.status===Mu.REVERTED?dc`<gr-icon small icon="undo"></gr-icon>`:dc`<span>${this.status??""}</span>`}renderNewlyChanged(){if(this.newlyChanged)return dc`
      <gr-tooltip-content
        title=${this.computeLabel()}
        has-tooltip
        aria-label="newly"
      >
        <gr-icon icon="new_releases" class="size-16"></gr-icon>
      </gr-tooltip-content>
    `}computeLabel(){return this.status?`${this.newlyChanged?"Newly ":""}${tv(this.status)}${this.labelPostfix}`:""}};var rv,ov;function sv(e){if(e&&Xu(e)&&e.values)return function(e){const t=Object.keys(e).map((e=>Number(e)));if(t.sort(((e,t)=>e-t)),t.length)return{min:t[0],max:t[t.length-1]}}(e.values)}function nv(e){return sv(e)||{min:0,max:0}}function av(e){if(!e?.all)return 0;const t=e.all.map((e=>e.value??0));if(0===t.length)return 0;const i=Math.max(...t),r=Math.min(...t);return i>-r?i:r}function lv(e,t){if(!e)return ov.NEUTRAL;if(Xu(e)){const i=t??av(e),r=nv(e);if(i<0)return i===r.min?ov.REJECTED:ov.DISLIKED;if(i>0)return i===r.max?ov.APPROVED:ov.RECOMMENDED}else if(Zu(e)){if(e.approved)return ov.APPROVED;if(e.rejected)return ov.REJECTED;if(e.disliked)return ov.DISLIKED;if(e.recommended)return ov.RECOMMENDED}return ov.NEUTRAL}function dv(e,t){return void 0===t?.value||lv(e,t.value)===ov.NEUTRAL}function cv(e){switch(e){case ov.APPROVED:return"max";case ov.RECOMMENDED:return"positive";case ov.DISLIKED:return"negative";case ov.REJECTED:return"min";case ov.NEUTRAL:return"neutral";default:fa(e,`Unsupported status: ${e}`)}}function hv(e){if(!e)return" 0";let t=`${e}`;return e>0&&(t=`+${t}`),t}function pv(e,t){return e.all?.filter((e=>e._account_id===t._account_id))[0]}function uv(e,t){return Xu(e)?!dv(e,pv(e,t)):!!Zu(e)&&(e.approved?._account_id===t._account_id||e.rejected?._account_id===t._account_id)}function gv(e,t){const i=pv(e,t);return!!i&&(i.permitted_voting_range?i.permitted_voting_range.max>0:void 0!==i.value)}function mv(e){if(!e||!Xu(e))return[];const t=(e.all??[]).filter(((e,t,i)=>t===i.findIndex((t=>t.value===e.value)))).sort(((e,t)=>-(e.value??0)+(t.value??0)));return t}function fv(e){return Xu(e)?(e.all??[]).some((t=>!dv(e,t))):!!Zu(e)&&!!(e.rejected||e.approved||e.recommended||e.disliked)}function vv(e,t){return e===rv.CODE_REVIEW&&t===rv.CODE_REVIEW?0:e===rv.CODE_REVIEW?-1:t===rv.CODE_REVIEW?1:e.localeCompare(t)}function bv(e){for(const t of Object.keys(e))if(t===rv.CODE_REVIEW)return e[t]}function yv(e){const t=new RegExp("label[0-9]*:([\\w-]+)","g"),i=[];let r;for(;null!==(r=t.exec(e));)i.push(r[1]);return i}function wv(e,t={extractFromSubmittability:!0,extractFromOverride:!0}){let i=[];e.submittability_expression_result&&t.extractFromSubmittability&&(i=i.concat(yv(e.submittability_expression_result.expression)));const r=!!e.override_expression_result?.fulfilled,o=!0===t.extractFromOverride||r&&"onlyIfOverridden"===t.extractFromOverride;return e.override_expression_result&&o&&(i=i.concat(yv(e.override_expression_result.expression))),i.filter(Ca)}function _v(e){return function(e){return e.status===tg.UNSATISFIED&&!!e.submittability_expression_result.passing_atoms?.some((e=>e.match(/^label[0-9]*:[\w-]+=MIN$/)))}(e)?{icon:"cancel",filled:!0}:xv(e.status)}function xv(e){switch(e){case tg.SATISFIED:return{icon:"check_circle",filled:!0};case tg.UNSATISFIED:return{icon:"block"};case tg.OVERRIDDEN:return{icon:"published_with_changes"};case tg.NOT_APPLICABLE:return{icon:"info",filled:!0};case tg.ERROR:return{icon:"error",filled:!0};case tg.FORCED:return{icon:"check_circle",filled:!0};default:fa(e,`Unsupported status: ${e}`)}}function Cv(e){return t=e?.submit_requirements,(t??[]).filter((e=>e.status!==tg.NOT_APPLICABLE));var t}ev([Fc({type:String})],iv.prototype,"status",void 0),ev([Fc({type:Boolean})],iv.prototype,"newlyChanged",void 0),ev([Fc({type:String})],iv.prototype,"labelPostfix",void 0),iv=ev([Dc("gr-file-status")],iv),function(e){e.CODE_REVIEW="Code-Review",e.CODE_OWNERS="Code Owners",e.PRESUBMIT_VERIFIED="Presubmit-Verified"}(rv||(rv={})),function(e){e.APPROVED="APPROVED",e.REJECTED="REJECTED",e.RECOMMENDED="RECOMMENDED",e.DISLIKED="DISLIKED",e.NEUTRAL="NEUTRAL"}(ov||(ov={}));const Ev=[rv.CODE_REVIEW,rv.CODE_OWNERS,rv.PRESUBMIT_VERIFIED];function Sv(e,t,i){const r=e[t];if(r.values)for(const e of Object.keys(r.values))if(Number(e)===i)return e;return`${i}`}function $v(e,t){if(t&&e?.[t])return e[t].default_value}function kv(e,t,i){const r=i?.labels;if(!t||!r)return null;const o=r[e];if(!o.all?.length)return null;for(let i=0;i<o.all.length;i++)if(o.all[i]._account_id===t._account_id)return Sv(r,e,o.all[i].value);return null}function Av(e){if(!e)return[];const t=Object.keys(e),i=new Set;for(const r of t)for(const t of e[r])i.add(Number(t));return Array.from(i.values()).sort(((e,t)=>e-t))}function Rv(e,t){if(!e||!t)return{};const i={};for(const r of Object.keys(e))ma(t,r)&&(i[r]=e[r]);return i}function Tv(e,t){if(!e||!t)return{};const i={};for(const r of Object.keys(e))ma(t,r)&&(i[r]=Iv(e[r],t[r]));return i}function Iv(e,t){return e.filter((e=>t.includes(e)))}function Pv(e,t){if(!e)return[];const i=t?.labels;return i?Object.keys(i).sort(vv).map((i=>({name:i,value:kv(i,e,t)}))):[]}function Nv(e){const t=Object.keys(e?.labels??{}),i=(e?.submit_requirements??[]).flatMap((e=>wv(e))).filter(Ca);return t.filter((e=>!i.includes(e)))}var Ov=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let Dv=class extends Ic{constructor(){super(...arguments),this.more=!1,this.tooltipWithWhoVoted=!1}static get styles(){return[Sd`
        :host([circle-shape]) .vote-chip {
          border-radius: 50%;
          border: none;
          padding: 2px;
        }
        .vote-chip.max {
          background-color: var(--vote-color-approved);
          padding: 2px;
        }
        .more > .vote-chip.max {
          padding: 1px;
          border: 1px solid var(--vote-outline-recommended);
        }
        .vote-chip.min {
          background-color: var(--vote-color-rejected);
          padding: 2px;
        }
        .more > .vote-chip.min {
          padding: 1px;
          border: 1px solid var(--vote-outline-disliked);
        }
        .vote-chip.positive,
        .chip-angle.max,
        .chip-angle.positive {
          background-color: var(--vote-color-recommended);
          border: 1px solid var(--vote-outline-recommended);
          color: var(--chip-color);
        }
        .vote-chip.negative,
        .chip-angle.min,
        .chip-angle.negative {
          background-color: var(--vote-color-disliked);
          border: 1px solid var(--vote-outline-disliked);
          color: var(--chip-color);
        }
        .vote-chip,
        .chip-angle {
          display: flex;
          width: var(--gr-vote-chip-width, 16px);
          height: var(--gr-vote-chip-height, 16px);
          font-size: var(--font-size-small);
          justify-content: center;
          padding: 1px;
          border-radius: var(--border-radius);
          line-height: var(--gr-vote-chip-width, 16px);
          color: var(--vote-text-color);
        }
        .more > .vote-chip {
          position: relative;
          z-index: 2;
        }
        .more > .chip-angle {
          position: absolute;
          top: 2px;
          left: 2px;
          z-index: 1;
        }
        .container {
          position: relative;
        }
        /* fix for firefox only */
        @supports (-moz-appearance: none) {
          .container.more {
            display: inline-block;
          }
        }
      `]}render(){const e=this.renderValue();if(e)return dc`<gr-tooltip-content
      class="container ${this.more?"more":""}"
      title=${this.computeTooltip(e)}
      has-tooltip
    >
      <div class="vote-chip ${this.computeClass()}">${e}</div>
      ${this.more?dc`<div class="chip-angle ${this.computeClass()}">
            ${e}
          </div>`:""}
    </gr-tooltip-content>`}renderValue(){if(this.displayValue)return this.displayValue;if(!this.label)return"";if(Xu(this.label)){if(this.vote?.value)return hv(this.vote.value)}else if(Zu(this.label)){if(this.label.approved)return dc`&#x2713;`;if(this.label.rejected)return dc`&#x2717;`;if(this.label.disliked||this.label.recommended)return hv(this.label.value)}return""}computeClass(){return this.label?this.displayValue?cv(lv(this.label,Number(this.displayValue))):cv(lv(this.label,this.vote?.value)):""}computeTooltip(e){if(!this.label||!Xu(this.label))return"";const t="string"==typeof e?this.label.values?.[e]??"":"";return this.tooltipWithWhoVoted&&this.vote?`${this.vote?.name}: ${t}`:t}};Ov([Fc({type:Object})],Dv.prototype,"vote",void 0),Ov([Fc({type:Object})],Dv.prototype,"label",void 0),Ov([Fc({type:Boolean})],Dv.prototype,"more",void 0),Ov([Fc()],Dv.prototype,"displayValue",void 0),Ov([Fc({type:Boolean,attribute:"tooltip-with-who-voted"})],Dv.prototype,"tooltipWithWhoVoted",void 0),Dv=Ov([Dc("gr-vote-chip")],Dv);const{I:Lv}=kc,Mv=(e,t)=>void 0===t?void 0!==e?._$litType$:e?._$litType$===t,Fv=e=>void 0===e.strings,Uv=()=>document.createComment(""),Bv=(e,t,i)=>{const r=e._$AA.parentNode,o=void 0===t?e._$AB:t._$AA;if(void 0===i){const t=r.insertBefore(Uv(),o),s=r.insertBefore(Uv(),o);i=new Lv(t,s,e,e.options)}else{const t=i._$AB.nextSibling,s=i._$AM,n=s!==e;if(n){let t;i._$AQ?.(e),i._$AM=e,void 0!==i._$AP&&(t=e._$AU)!==s._$AU&&i._$AP(t)}if(t!==o||n){let e=i._$AA;for(;e!==t;){const t=e.nextSibling;r.insertBefore(e,o),e=t}}}return i},Hv=(e,t,i=e)=>(e._$AI(t,i),e),jv={},Gv=(e,t=jv)=>e._$AH=t,zv=e=>e._$AH,Vv=e=>{e._$AR(),e._$AA.remove()},Wv=(e,t)=>{const i=e._$AN;if(void 0===i)return!1;for(const e of i)e._$AO?.(t,!1),Wv(e,t);return!0},qv=e=>{let t,i;do{if(void 0===(t=e._$AM))break;i=t._$AN,i.delete(e),e=t}while(0===i?.size)},Kv=e=>{for(let t;t=e._$AM;e=t){let i=t._$AN;if(void 0===i)t._$AN=i=new Set;else if(i.has(e))break;i.add(e),Jv(t)}};function Yv(e){void 0!==this._$AN?(qv(this),this._$AM=e,Kv(this)):this._$AM=e}function Xv(e,t=!1,i=0){const r=this._$AH,o=this._$AN;if(void 0!==o&&0!==o.size)if(t)if(Array.isArray(r))for(let e=i;e<r.length;e++)Wv(r[e],!1),qv(r[e]);else null!=r&&(Wv(r,!1),qv(r));else Wv(this,e)}const Jv=e=>{2==e.type&&(e._$AP??=Xv,e._$AQ??=Yv)};class Qv extends eh{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,t,i){super._$AT(e,t,i),Kv(this),this.isConnected=e._$AU}_$AO(e,t=!0){e!==this.isConnected&&(this.isConnected=e,e?this.reconnected?.():this.disconnected?.()),t&&(Wv(this,e),qv(this))}setValue(e){if(Fv(this._$Ct))this._$Ct._$AI(e,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=e,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}}const Zv=Zc(class extends Qv{constructor(){super(...arguments),this.children=[],this.animationFrameHandler=()=>{if(this.state.startAt>=this.state.endAt)return void(this.nextScheduledFrameWork=void 0);const e=performance.now();1e3/(e-this.state.lastRenderedAt)<this.state.targetFrameRate?this.state.incrementAmount=Math.max(1,Math.round(this.state.incrementAmount/2)):this.state.incrementAmount++,this.state.lastRenderedAt=e,this.appendPart({mapFn:this.state.mapFn,values:this.state.values,initialCount:this.state.incrementAmount,startAt:this.state.startAt,endAt:this.state.endAt}),this.state.startAt+=this.state.incrementAmount,this.state.startAt<this.state.endAt?this.nextScheduledFrameWork=requestAnimationFrame(this.animationFrameHandler):this.nextScheduledFrameWork=void 0}}render(e){const t=e.startAt??0,i=t+e.initialCount,r=void 0===e.endAt?i:Math.min(e.endAt,i),o=e.values.slice(t,r);if(e.mapFn){const i=e.mapFn;return o.map(((e,r)=>i(e,r+t)))}return o}update(e,[t]){return t.values!==this.state?.values?(void 0!==this.nextScheduledFrameWork&&cancelAnimationFrame(this.nextScheduledFrameWork),this.part=e,this.clearParts(),this.state={values:t.values,mapFn:t.mapFn,startAt:t.initialCount,endAt:t.endAt??t.values.length,incrementAmount:t.initialCount,lastRenderedAt:performance.now(),targetFrameRate:t.targetFrameRate??30},this.nextScheduledFrameWork=requestAnimationFrame(this.animationFrameHandler)):(this.updateParts(),(t.endAt??t.values.length)>=this.state.endAt&&(this.state.endAt=t.endAt??t.values.length,this.nextScheduledFrameWork&&cancelAnimationFrame(this.nextScheduledFrameWork),this.nextScheduledFrameWork=requestAnimationFrame(this.animationFrameHandler))),this.render(t)}appendPart(e){const t=Bv(this.part);this.children.push({part:t,options:e}),Hv(t,this.render(e))}clearParts(){for(const e of this.children)Vv(e.part);this.children=[]}updateParts(){for(const e of this.children)Hv(e.part,this.render(e.options))}});function eb(e,t,i){return e?t(e):i?.(e)}class tb extends Ic{constructor(){super(...arguments),this.inset=!1,this.insetStart=!1,this.insetEnd=!1}}zg([Fc({type:Boolean,reflect:!0})],tb.prototype,"inset",void 0),zg([Fc({type:Boolean,reflect:!0,attribute:"inset-start"})],tb.prototype,"insetStart",void 0),zg([Fc({type:Boolean,reflect:!0,attribute:"inset-end"})],tb.prototype,"insetEnd",void 0);const ib=Sd`:host{box-sizing:border-box;color:var(--md-divider-color, var(--md-sys-color-outline-variant, #cac4d0));display:flex;height:var(--md-divider-thickness, 1px);width:100%}:host([inset]),:host([inset-start]){padding-inline-start:16px}:host([inset]),:host([inset-end]){padding-inline-end:16px}:host::before{background:currentColor;content:"";height:100%;width:100%}@media(forced-colors: active){:host::before{background:CanvasText}}
`;let rb=class extends tb{};function ob(e,t=hb){const i=ab(e,t);return i&&(i.tabIndex=0,i.focus()),i}function sb(e,t=hb){const i=lb(e,t);return i&&(i.tabIndex=0,i.focus()),i}function nb(e,t=hb){for(let i=0;i<e.length;i++){const r=e[i];if(0===r.tabIndex&&t(r))return{item:r,index:i}}return null}function ab(e,t=hb){for(const i of e)if(t(i))return i;return null}function lb(e,t=hb){for(let i=e.length-1;i>=0;i--){const r=e[i];if(t(r))return r}return null}function db(e,t,i=hb,r=!0){if(t){const o=function(e,t,i=hb,r=!0){for(let o=1;o<e.length;o++){const s=(o+t)%e.length;if(s<t&&!r)return null;const n=e[s];if(i(n))return n}return e[t]?e[t]:null}(e,t.index,i,r);return o&&(o.tabIndex=0,o.focus()),o}return ob(e,i)}function cb(e,t,i=hb,r=!0){if(t){const o=function(e,t,i=hb,r=!0){for(let o=1;o<e.length;o++){const s=(t-o+e.length)%e.length;if(s>t&&!r)return null;const n=e[s];if(i(n))return n}return e[t]?e[t]:null}(e,t.index,i,r);return o&&(o.tabIndex=0,o.focus()),o}return sb(e,i)}function hb(e){return!e.disabled}rb.styles=[ib],rb=zg([Dc("md-divider")],rb);const pb={ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",Home:"Home",End:"End"};class ub{constructor(e){this.handleKeydown=e=>{const t=e.key;if(e.defaultPrevented||!this.isNavigableKey(t))return;const i=this.items;if(!i.length)return;const r=nb(i,this.isActivatable);e.preventDefault();const o=this.isRtl();let s=null;switch(t){case pb.ArrowDown:case o?pb.ArrowLeft:pb.ArrowRight:s=db(i,r,this.isActivatable,this.wrapNavigation());break;case pb.ArrowUp:case o?pb.ArrowRight:pb.ArrowLeft:s=cb(i,r,this.isActivatable,this.wrapNavigation());break;case pb.Home:s=ob(i,this.isActivatable);break;case pb.End:s=sb(i,this.isActivatable)}s&&r&&r.item!==s&&(r.item.tabIndex=-1)},this.onDeactivateItems=()=>{const e=this.items;for(const t of e)this.deactivateItem(t)},this.onRequestActivation=e=>{this.onDeactivateItems();const t=e.target;this.activateItem(t),t.focus()},this.onSlotchange=()=>{const e=this.items;let t=!1;for(const i of e)!i.disabled&&i.tabIndex>-1&&!t?(t=!0,i.tabIndex=0):i.tabIndex=-1;if(t)return;const i=ab(e,this.isActivatable);i&&(i.tabIndex=0)};const{isItem:t,getPossibleItems:i,isRtl:r,deactivateItem:o,activateItem:s,isNavigableKey:n,isActivatable:a,wrapNavigation:l}=e;this.isItem=t,this.getPossibleItems=i,this.isRtl=r,this.deactivateItem=o,this.activateItem=s,this.isNavigableKey=n,this.isActivatable=a,this.wrapNavigation=l??(()=>!0)}get items(){const e=this.getPossibleItems(),t=[];for(const i of e){if(this.isItem(i)){t.push(i);continue}const e=i.item;e&&this.isItem(e)&&t.push(e)}return t}activateNextItem(){const e=this.items,t=nb(e,this.isActivatable);return t&&(t.item.tabIndex=-1),db(e,t,this.isActivatable,this.wrapNavigation())}activatePreviousItem(){const e=this.items,t=nb(e,this.isActivatable);return t&&(t.item.tabIndex=-1),cb(e,t,this.isActivatable,this.wrapNavigation())}}const gb=function(e,t){return new CustomEvent("close-menu",{bubbles:!0,composed:!0,detail:{initiator:e,reason:t,itemPath:[e]}})},mb={SPACE:"Space",ENTER:"Enter"},fb={ESCAPE:"Escape",SPACE:mb.SPACE,ENTER:mb.ENTER};function vb(e){return Object.values(fb).some((t=>t===e))}function bb(e,t){const i=new Event("md-contains",{bubbles:!0,composed:!0});let r=[];const o=e=>{r=e.composedPath()};return t.addEventListener("md-contains",o),e.dispatchEvent(i),t.removeEventListener("md-contains",o),r.length>0}const yb="none",wb="first-item",_b="last-item";class xb{constructor(e,t){this.host=e,this.getProperties=t,this.surfaceStylesInternal={display:"none"},this.lastValues={isOpen:!1},this.host.addController(this)}get surfaceStyles(){return this.surfaceStylesInternal}async position(){const{surfaceEl:e,anchorEl:t,anchorCorner:i,surfaceCorner:r,positioning:o,xOffset:s,yOffset:n,disableBlockFlip:a,disableInlineFlip:l,repositionStrategy:d}=this.getProperties(),c=i.toLowerCase().trim(),h=r.toLowerCase().trim();if(!e||!t)return;const p=window.innerWidth,u=window.innerHeight,g=document.createElement("div");g.style.opacity="0",g.style.position="fixed",g.style.display="block",g.style.inset="0",document.body.appendChild(g);const m=g.getBoundingClientRect();g.remove();const f=window.innerHeight-m.bottom,v=window.innerWidth-m.right;this.surfaceStylesInternal={display:"block",opacity:"0"},this.host.requestUpdate(),await this.host.updateComplete,e.popover&&e.isConnected&&e.showPopover();const b=e.getSurfacePositionClientRect?e.getSurfacePositionClientRect():e.getBoundingClientRect(),y=t.getSurfacePositionClientRect?t.getSurfacePositionClientRect():t.getBoundingClientRect(),[w,_]=h.split("-"),[x,C]=c.split("-"),E="ltr"===getComputedStyle(e).direction;let{blockInset:S,blockOutOfBoundsCorrection:$,surfaceBlockProperty:k}=this.calculateBlock({surfaceRect:b,anchorRect:y,anchorBlock:x,surfaceBlock:w,yOffset:n,positioning:o,windowInnerHeight:u,blockScrollbarHeight:f});if($&&!a){const e="start"===w?"end":"start",t="start"===x?"end":"start",i=this.calculateBlock({surfaceRect:b,anchorRect:y,anchorBlock:t,surfaceBlock:e,yOffset:n,positioning:o,windowInnerHeight:u,blockScrollbarHeight:f});$>i.blockOutOfBoundsCorrection&&(S=i.blockInset,$=i.blockOutOfBoundsCorrection,k=i.surfaceBlockProperty)}let{inlineInset:A,inlineOutOfBoundsCorrection:R,surfaceInlineProperty:T}=this.calculateInline({surfaceRect:b,anchorRect:y,anchorInline:C,surfaceInline:_,xOffset:s,positioning:o,isLTR:E,windowInnerWidth:p,inlineScrollbarWidth:v});if(R&&!l){const e="start"===_?"end":"start",t="start"===C?"end":"start",i=this.calculateInline({surfaceRect:b,anchorRect:y,anchorInline:t,surfaceInline:e,xOffset:s,positioning:o,isLTR:E,windowInnerWidth:p,inlineScrollbarWidth:v});Math.abs(R)>Math.abs(i.inlineOutOfBoundsCorrection)&&(A=i.inlineInset,R=i.inlineOutOfBoundsCorrection,T=i.surfaceInlineProperty)}"move"===d&&(S-=$,A-=R),this.surfaceStylesInternal={display:"block",opacity:"1",[k]:`${S}px`,[T]:`${A}px`},"resize"===d&&($&&(this.surfaceStylesInternal.height=b.height-$+"px"),R&&(this.surfaceStylesInternal.width=b.width-R+"px")),this.host.requestUpdate()}calculateBlock(e){const{surfaceRect:t,anchorRect:i,anchorBlock:r,surfaceBlock:o,yOffset:s,positioning:n,windowInnerHeight:a,blockScrollbarHeight:l}=e,d="fixed"===n||"document"===n?1:0,c="document"===n?1:0,h="start"===o?1:0,p="end"===o?1:0,u=(r!==o?1:0)*i.height+s,g=h*i.top+p*(a-i.bottom-l);return{blockInset:d*g+c*(h*window.scrollY-p*window.scrollY)+u,blockOutOfBoundsCorrection:Math.abs(Math.min(0,a-g-u-t.height)),surfaceBlockProperty:"start"===o?"inset-block-start":"inset-block-end"}}calculateInline(e){const{isLTR:t,surfaceInline:i,anchorInline:r,anchorRect:o,surfaceRect:s,xOffset:n,positioning:a,windowInnerWidth:l,inlineScrollbarWidth:d}=e,c="fixed"===a||"document"===a?1:0,h="document"===a?1:0,p=t?1:0,u=t?0:1,g="start"===i?1:0,m="end"===i?1:0,f=(r!==i?1:0)*o.width+n,v=p*(g*o.left+m*(l-o.right-d))+u*(g*(l-o.right-d)+m*o.left);let b="start"===i?"inset-inline-start":"inset-inline-end";return"document"!==a&&"fixed"!==a||(b="start"===i&&t||"end"===i&&!t?"left":"right"),{inlineInset:c*v+f+h*(p*(g*window.scrollX-m*window.scrollX)+u*(m*window.scrollX-g*window.scrollX)),inlineOutOfBoundsCorrection:Math.abs(Math.min(0,l-v-f-s.width)),surfaceInlineProperty:b}}hostUpdate(){this.onUpdate()}hostUpdated(){this.onUpdate()}async onUpdate(){const e=this.getProperties();let t=!1;for(const[i,r]of Object.entries(e))if(t=t||r!==this.lastValues[i],t)break;const i=this.lastValues.isOpen!==e.isOpen,r=!!e.anchorEl,o=!!e.surfaceEl;t&&r&&o&&(this.lastValues.isOpen=e.isOpen,e.isOpen?(this.lastValues=e,await this.position(),e.onOpen()):i&&(await e.beforeClose(),this.close(),e.onClose()))}close(){this.surfaceStylesInternal={display:"none"},this.host.requestUpdate();const e=this.getProperties().surfaceEl;e?.popover&&e?.isConnected&&e.hidePopover()}}class Cb{constructor(e){this.getProperties=e,this.typeaheadRecords=[],this.typaheadBuffer="",this.cancelTypeaheadTimeout=0,this.isTypingAhead=!1,this.lastActiveRecord=null,this.onKeydown=e=>{this.isTypingAhead?this.typeahead(e):this.beginTypeahead(e)},this.endTypeahead=()=>{this.isTypingAhead=!1,this.typaheadBuffer="",this.typeaheadRecords=[]}}get items(){return this.getProperties().getItems()}get active(){return this.getProperties().active}beginTypeahead(e){this.active&&("Space"===e.code||"Enter"===e.code||e.code.startsWith("Arrow")||"Escape"===e.code||(this.isTypingAhead=!0,this.typeaheadRecords=this.items.map(((e,t)=>[t,e,e.typeaheadText.trim().toLowerCase()])),this.lastActiveRecord=this.typeaheadRecords.find((e=>0===e[1].tabIndex))??null,this.lastActiveRecord&&(this.lastActiveRecord[1].tabIndex=-1),this.typeahead(e)))}typeahead(e){if(e.defaultPrevented)return;if(clearTimeout(this.cancelTypeaheadTimeout),"Enter"===e.code||e.code.startsWith("Arrow")||"Escape"===e.code)return this.endTypeahead(),void(this.lastActiveRecord&&(this.lastActiveRecord[1].tabIndex=-1));"Space"===e.code&&e.preventDefault(),this.cancelTypeaheadTimeout=setTimeout(this.endTypeahead,this.getProperties().typeaheadBufferTime),this.typaheadBuffer+=e.key.toLowerCase();const t=this.lastActiveRecord?this.lastActiveRecord[0]:-1,i=this.typeaheadRecords.length,r=e=>(e[0]+i-t)%i,o=this.typeaheadRecords.filter((e=>!e[1].disabled&&e[2].startsWith(this.typaheadBuffer))).sort(((e,t)=>r(e)-r(t)));if(0===o.length)return clearTimeout(this.cancelTypeaheadTimeout),this.lastActiveRecord&&(this.lastActiveRecord[1].tabIndex=-1),void this.endTypeahead();const s=1===this.typaheadBuffer.length;let n;n=this.lastActiveRecord===o[0]&&s?o[1]??o[0]:o[0],this.lastActiveRecord&&(this.lastActiveRecord[1].tabIndex=-1),this.lastActiveRecord=n,n[1].tabIndex=0,n[1].focus()}}const Eb=new Set([pb.ArrowDown,pb.ArrowUp,pb.Home,pb.End]),Sb=new Set([pb.ArrowLeft,pb.ArrowRight,...Eb]);class $b extends Ic{get openDirection(){return"start"===this.menuCorner.split("-")[0]?"DOWN":"UP"}get anchorElement(){return this.anchor?this.getRootNode().querySelector(`#${this.anchor}`):this.currentAnchorElement}set anchorElement(e){this.currentAnchorElement=e,this.requestUpdate("anchorElement")}constructor(){super(),this.anchor="",this.positioning="absolute",this.quick=!1,this.hasOverflow=!1,this.open=!1,this.xOffset=0,this.yOffset=0,this.noHorizontalFlip=!1,this.noVerticalFlip=!1,this.typeaheadDelay=200,this.anchorCorner="end-start",this.menuCorner="start-start",this.stayOpenOnOutsideClick=!1,this.stayOpenOnFocusout=!1,this.skipRestoreFocus=!1,this.defaultFocus=wb,this.noNavigationWrap=!1,this.typeaheadActive=!0,this.isSubmenu=!1,this.pointerPath=[],this.isRepositioning=!1,this.openCloseAnimationSignal=function(){let e=null;return{start:()=>(e?.abort(),e=new AbortController,e.signal),finish(){e=null}}}(),this.listController=new ub({isItem:e=>e.hasAttribute("md-menu-item"),getPossibleItems:()=>this.slotItems,isRtl:()=>"rtl"===getComputedStyle(this).direction,deactivateItem:e=>{e.selected=!1,e.tabIndex=-1},activateItem:e=>{e.selected=!0,e.tabIndex=0},isNavigableKey:e=>this.isSubmenu?e===("rtl"===getComputedStyle(this).direction?pb.ArrowLeft:pb.ArrowRight)||Eb.has(e):Sb.has(e),wrapNavigation:()=>!this.noNavigationWrap}),this.lastFocusedElement=null,this.typeaheadController=new Cb((()=>({getItems:()=>this.items,typeaheadBufferTime:this.typeaheadDelay,active:this.typeaheadActive}))),this.currentAnchorElement=null,this.internals=this.attachInternals(),this.menuPositionController=new xb(this,(()=>({anchorCorner:this.anchorCorner,surfaceCorner:this.menuCorner,surfaceEl:this.surfaceEl,anchorEl:this.anchorElement,positioning:"popover"===this.positioning?"document":this.positioning,isOpen:this.open,xOffset:this.xOffset,yOffset:this.yOffset,disableBlockFlip:this.noVerticalFlip,disableInlineFlip:this.noHorizontalFlip,onOpen:this.onOpened,beforeClose:this.beforeClose,onClose:this.onClosed,repositionStrategy:this.hasOverflow&&"popover"!==this.positioning?"move":"resize"}))),this.onWindowResize=()=>{this.isRepositioning||"document"!==this.positioning&&"fixed"!==this.positioning&&"popover"!==this.positioning||(this.isRepositioning=!0,this.reposition(),this.isRepositioning=!1)},this.handleFocusout=async e=>{const t=this.anchorElement;if(this.stayOpenOnFocusout||!this.open||this.pointerPath.includes(t))return;if(e.relatedTarget){if(bb(e.relatedTarget,this)||0!==this.pointerPath.length&&bb(e.relatedTarget,t))return}else if(this.pointerPath.includes(this))return;const i=this.skipRestoreFocus;this.skipRestoreFocus=!0,this.close(),await this.updateComplete,this.skipRestoreFocus=i},this.onOpened=async()=>{this.lastFocusedElement=function(e=document){let t=e.activeElement;for(;t&&t?.shadowRoot?.activeElement;)t=t.shadowRoot.activeElement;return t}();const e=this.items,t=nb(e);t&&this.defaultFocus!==yb&&(t.item.tabIndex=-1);let i=!this.quick;switch(this.quick?this.dispatchEvent(new Event("opening")):i=!!await this.animateOpen(),this.defaultFocus){case wb:const t=ab(e);t&&(t.tabIndex=0,t.focus(),await t.updateComplete);break;case _b:const i=lb(e);i&&(i.tabIndex=0,i.focus(),await i.updateComplete);break;case"list-root":this.focus()}i||this.dispatchEvent(new Event("opened"))},this.beforeClose=async()=>{this.open=!1,this.skipRestoreFocus||this.lastFocusedElement?.focus?.(),this.quick||await this.animateClose()},this.onClosed=()=>{this.quick&&(this.dispatchEvent(new Event("closing")),this.dispatchEvent(new Event("closed")))},this.onWindowPointerdown=e=>{this.pointerPath=e.composedPath()},this.onDocumentClick=e=>{if(!this.open)return;const t=e.composedPath();this.stayOpenOnOutsideClick||t.includes(this)||t.includes(this.anchorElement)||(this.open=!1)},this.internals.role="menu",this.addEventListener("keydown",this.handleKeydown),this.addEventListener("keydown",this.captureKeydown,{capture:!0}),this.addEventListener("focusout",this.handleFocusout)}get items(){return this.listController.items}willUpdate(e){e.has("open")&&(this.open?this.removeAttribute("aria-hidden"):this.setAttribute("aria-hidden","true"))}update(e){e.has("open")&&(this.open?this.setUpGlobalEventListeners():this.cleanUpGlobalEventListeners()),e.has("positioning")&&"popover"===this.positioning&&!this.showPopover&&(this.positioning="fixed"),super.update(e)}connectedCallback(){super.connectedCallback(),this.open&&this.setUpGlobalEventListeners()}disconnectedCallback(){super.disconnectedCallback(),this.cleanUpGlobalEventListeners()}getBoundingClientRect(){return this.surfaceEl?this.surfaceEl.getBoundingClientRect():super.getBoundingClientRect()}getClientRects(){return this.surfaceEl?this.surfaceEl.getClientRects():super.getClientRects()}render(){return this.renderSurface()}renderSurface(){return dc`
      <div
        class="menu ${th(this.getSurfaceClasses())}"
        style=${Bm(this.menuPositionController.surfaceStyles)}
        popover=${"popover"===this.positioning?"manual":uc}>
        ${this.renderElevation()}
        <div class="items">
          <div class="item-padding"> ${this.renderMenuItems()} </div>
        </div>
      </div>
    `}renderMenuItems(){return dc`<slot
      @close-menu=${this.onCloseMenu}
      @deactivate-items=${this.onDeactivateItems}
      @request-activation=${this.onRequestActivation}
      @deactivate-typeahead=${this.handleDeactivateTypeahead}
      @activate-typeahead=${this.handleActivateTypeahead}
      @stay-open-on-focusout=${this.handleStayOpenOnFocusout}
      @close-on-focusout=${this.handleCloseOnFocusout}
      @slotchange=${this.listController.onSlotchange}></slot>`}renderElevation(){return dc`<md-elevation part="elevation"></md-elevation>`}getSurfaceClasses(){return{open:this.open,fixed:"fixed"===this.positioning,"has-overflow":this.hasOverflow}}captureKeydown(e){e.target===this&&!e.defaultPrevented&&vb(e.code)&&(e.preventDefault(),this.close()),this.typeaheadController.onKeydown(e)}async animateOpen(){const e=this.surfaceEl,t=this.slotEl;if(!e||!t)return!0;const i=this.openDirection;this.dispatchEvent(new Event("opening")),e.classList.toggle("animating",!0);const r=this.openCloseAnimationSignal.start(),o=e.offsetHeight,s="UP"===i,n=this.items,a=250/n.length,l=e.animate([{height:"0px"},{height:`${o}px`}],{duration:500,easing:rm}),d=t.animate([{transform:s?`translateY(-${o}px)`:""},{transform:""}],{duration:500,easing:rm}),c=e.animate([{opacity:0},{opacity:1}],50),h=[];for(let e=0;e<n.length;e++){const t=n[s?n.length-1-e:e],i=t.animate([{opacity:0},{opacity:1}],{duration:250,delay:a*e});t.classList.toggle("md-menu-hidden",!0),i.addEventListener("finish",(()=>{t.classList.toggle("md-menu-hidden",!1)})),h.push([t,i])}let p=e=>{};const u=new Promise((e=>{p=e}));return r.addEventListener("abort",(()=>{l.cancel(),d.cancel(),c.cancel(),h.forEach((([e,t])=>{e.classList.toggle("md-menu-hidden",!1),t.cancel()})),p(!0)})),l.addEventListener("finish",(()=>{e.classList.toggle("animating",!1),this.openCloseAnimationSignal.finish(),p(!1)})),await u}animateClose(){let e;const t=new Promise((t=>{e=t})),i=this.surfaceEl,r=this.slotEl;if(!i||!r)return e(!1),t;const o="UP"===this.openDirection;this.dispatchEvent(new Event("closing")),i.classList.toggle("animating",!0);const s=this.openCloseAnimationSignal.start(),n=i.offsetHeight,a=this.items,l=50/a.length,d=i.animate([{height:`${n}px`},{height:.35*n+"px"}],{duration:150,easing:om}),c=r.animate([{transform:""},{transform:o?`translateY(-${.65*n}px)`:""}],{duration:150,easing:om}),h=i.animate([{opacity:1},{opacity:0}],{duration:50,delay:100}),p=[];for(let e=0;e<a.length;e++){const t=a[o?e:a.length-1-e],i=t.animate([{opacity:1},{opacity:0}],{duration:50,delay:50+l*e});i.addEventListener("finish",(()=>{t.classList.toggle("md-menu-hidden",!0)})),p.push([t,i])}return s.addEventListener("abort",(()=>{d.cancel(),c.cancel(),h.cancel(),p.forEach((([e,t])=>{t.cancel(),e.classList.toggle("md-menu-hidden",!1)})),e(!1)})),d.addEventListener("finish",(()=>{i.classList.toggle("animating",!1),p.forEach((([e])=>{e.classList.toggle("md-menu-hidden",!1)})),this.openCloseAnimationSignal.finish(),this.dispatchEvent(new Event("closed")),e(!0)})),t}handleKeydown(e){this.pointerPath=[],this.listController.handleKeydown(e)}setUpGlobalEventListeners(){document.addEventListener("click",this.onDocumentClick,{capture:!0}),window.addEventListener("pointerdown",this.onWindowPointerdown),document.addEventListener("resize",this.onWindowResize,{passive:!0}),window.addEventListener("resize",this.onWindowResize,{passive:!0})}cleanUpGlobalEventListeners(){document.removeEventListener("click",this.onDocumentClick,{capture:!0}),window.removeEventListener("pointerdown",this.onWindowPointerdown),document.removeEventListener("resize",this.onWindowResize),window.removeEventListener("resize",this.onWindowResize)}onCloseMenu(){this.close()}onDeactivateItems(e){e.stopPropagation(),this.listController.onDeactivateItems()}onRequestActivation(e){e.stopPropagation(),this.listController.onRequestActivation(e)}handleDeactivateTypeahead(e){e.stopPropagation(),this.typeaheadActive=!1}handleActivateTypeahead(e){e.stopPropagation(),this.typeaheadActive=!0}handleStayOpenOnFocusout(e){e.stopPropagation(),this.stayOpenOnFocusout=!0}handleCloseOnFocusout(e){e.stopPropagation(),this.stayOpenOnFocusout=!1}close(){this.open=!1,this.slotItems.forEach((e=>{e.close?.()}))}show(){this.open=!0}activateNextItem(){return this.listController.activateNextItem()??null}activatePreviousItem(){return this.listController.activatePreviousItem()??null}reposition(){this.open&&this.menuPositionController.position()}}zg([Hc(".menu")],$b.prototype,"surfaceEl",void 0),zg([Hc("slot")],$b.prototype,"slotEl",void 0),zg([Fc()],$b.prototype,"anchor",void 0),zg([Fc()],$b.prototype,"positioning",void 0),zg([Fc({type:Boolean})],$b.prototype,"quick",void 0),zg([Fc({type:Boolean,attribute:"has-overflow"})],$b.prototype,"hasOverflow",void 0),zg([Fc({type:Boolean,reflect:!0})],$b.prototype,"open",void 0),zg([Fc({type:Number,attribute:"x-offset"})],$b.prototype,"xOffset",void 0),zg([Fc({type:Number,attribute:"y-offset"})],$b.prototype,"yOffset",void 0),zg([Fc({type:Boolean,attribute:"no-horizontal-flip"})],$b.prototype,"noHorizontalFlip",void 0),zg([Fc({type:Boolean,attribute:"no-vertical-flip"})],$b.prototype,"noVerticalFlip",void 0),zg([Fc({type:Number,attribute:"typeahead-delay"})],$b.prototype,"typeaheadDelay",void 0),zg([Fc({attribute:"anchor-corner"})],$b.prototype,"anchorCorner",void 0),zg([Fc({attribute:"menu-corner"})],$b.prototype,"menuCorner",void 0),zg([Fc({type:Boolean,attribute:"stay-open-on-outside-click"})],$b.prototype,"stayOpenOnOutsideClick",void 0),zg([Fc({type:Boolean,attribute:"stay-open-on-focusout"})],$b.prototype,"stayOpenOnFocusout",void 0),zg([Fc({type:Boolean,attribute:"skip-restore-focus"})],$b.prototype,"skipRestoreFocus",void 0),zg([Fc({attribute:"default-focus"})],$b.prototype,"defaultFocus",void 0),zg([Fc({type:Boolean,attribute:"no-navigation-wrap"})],$b.prototype,"noNavigationWrap",void 0),zg([Vc({flatten:!0})],$b.prototype,"slotItems",void 0),zg([Uc()],$b.prototype,"typeaheadActive",void 0);const kb=Sd`:host{--md-elevation-level: var(--md-menu-container-elevation, 2);--md-elevation-shadow-color: var(--md-menu-container-shadow-color, var(--md-sys-color-shadow, #000));min-width:112px;color:unset;display:contents}md-focus-ring{--md-focus-ring-shape: var(--md-menu-container-shape, var(--md-sys-shape-corner-extra-small, 4px))}.menu{border-radius:var(--md-menu-container-shape, var(--md-sys-shape-corner-extra-small, 4px));display:none;inset:auto;border:none;padding:0px;overflow:visible;background-color:rgba(0,0,0,0);color:inherit;opacity:0;z-index:20;position:absolute;user-select:none;max-height:inherit;height:inherit;min-width:inherit;max-width:inherit;scrollbar-width:inherit}.menu::backdrop{display:none}.fixed{position:fixed}.items{display:block;list-style-type:none;margin:0;outline:none;box-sizing:border-box;background-color:var(--md-menu-container-color, var(--md-sys-color-surface-container, #f3edf7));height:inherit;max-height:inherit;overflow:auto;min-width:inherit;max-width:inherit;border-radius:inherit;scrollbar-width:inherit}.item-padding{padding-block:var(--md-menu-top-space, 8px) var(--md-menu-bottom-space, 8px)}.has-overflow:not([popover]) .items{overflow:visible}.has-overflow.animating .items,.animating .items{overflow:hidden}.has-overflow.animating .items{pointer-events:none}.animating ::slotted(.md-menu-hidden){opacity:0}slot{display:block;height:inherit;max-height:inherit}::slotted(:is(md-divider,[role=separator])){margin:8px 0}@media(forced-colors: active){.menu{border-style:solid;border-color:CanvasText;border-width:1px}}
`;let Ab=class extends $b{};Ab.styles=[kb],Ab=zg([Dc("md-menu")],Ab);class Rb extends Ic{constructor(){super(...arguments),this.multiline=!1}render(){return dc`
      <slot name="container"></slot>
      <slot class="non-text" name="start"></slot>
      <div class="text">
        <slot name="overline" @slotchange=${this.handleTextSlotChange}></slot>
        <slot
          class="default-slot"
          @slotchange=${this.handleTextSlotChange}></slot>
        <slot name="headline" @slotchange=${this.handleTextSlotChange}></slot>
        <slot
          name="supporting-text"
          @slotchange=${this.handleTextSlotChange}></slot>
      </div>
      <slot class="non-text" name="trailing-supporting-text"></slot>
      <slot class="non-text" name="end"></slot>
    `}handleTextSlotChange(){let e=!1,t=0;for(const i of this.textSlots)if(Tb(i)&&(t+=1),t>1){e=!0;break}this.multiline=e}}function Tb(e){for(const t of e.assignedNodes({flatten:!0})){const e=t.nodeType===Node.ELEMENT_NODE,i=t.nodeType===Node.TEXT_NODE&&t.textContent?.match(/\S/);if(e||i)return!0}return!1}zg([Fc({type:Boolean,reflect:!0})],Rb.prototype,"multiline",void 0),zg([Gc(".text slot")],Rb.prototype,"textSlots",void 0);const Ib=Sd`:host{color:var(--md-sys-color-on-surface, #1d1b20);font-family:var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-body-large-size, 1rem);font-weight:var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400));line-height:var(--md-sys-typescale-body-large-line-height, 1.5rem);align-items:center;box-sizing:border-box;display:flex;gap:16px;min-height:56px;overflow:hidden;padding:12px 16px;position:relative;text-overflow:ellipsis}:host([multiline]){min-height:72px}[name=overline]{color:var(--md-sys-color-on-surface-variant, #49454f);font-family:var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-label-small-size, 0.6875rem);font-weight:var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500));line-height:var(--md-sys-typescale-label-small-line-height, 1rem)}[name=supporting-text]{color:var(--md-sys-color-on-surface-variant, #49454f);font-family:var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-body-medium-size, 0.875rem);font-weight:var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400));line-height:var(--md-sys-typescale-body-medium-line-height, 1.25rem)}[name=trailing-supporting-text]{color:var(--md-sys-color-on-surface-variant, #49454f);font-family:var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-label-small-size, 0.6875rem);font-weight:var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500));line-height:var(--md-sys-typescale-label-small-line-height, 1rem)}[name=container]::slotted(*){inset:0;position:absolute}.default-slot{display:inline}.default-slot,.text ::slotted(*){overflow:hidden;text-overflow:ellipsis}.text{display:flex;flex:1;flex-direction:column;overflow:hidden}
`;let Pb=class extends Rb{};Pb.styles=[Ib],Pb=zg([Dc("md-item")],Pb);const Nb=Symbol.for(""),Ob=e=>{if(e?.r===Nb)return e?._$litStatic$},Db=(e,...t)=>({_$litStatic$:t.reduce(((t,i,r)=>t+(e=>{if(void 0!==e._$litStatic$)return e._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${e}. Use 'unsafeStatic' to pass non-literal values, but\n            take care to ensure page security.`)})(i)+e[r+1]),e[0]),r:Nb}),Lb=new Map,Mb=e=>(t,...i)=>{const r=i.length;let o,s;const n=[],a=[];let l,d=0,c=!1;for(;d<r;){for(l=t[d];d<r&&void 0!==(s=i[d],o=Ob(s));)l+=o+t[++d],c=!0;d!==r&&a.push(s),n.push(l),d++}if(d===r&&n.push(t[r]),c){const e=n.join("$$lit$$");void 0===(t=Lb.get(e))&&(n.raw=n,Lb.set(e,t=n)),i=a}return e(t,...i)},Fb=Mb(dc);Mb(cc),Mb(hc);class Ub{constructor(e,t){this.host=e,this.internalTypeaheadText=null,this.onClick=()=>{this.host.keepOpen||this.host.dispatchEvent(gb(this.host,{kind:"click-selection"}))},this.onKeydown=e=>{if(this.host.href&&"Enter"===e.code){const e=this.getInteractiveElement();e instanceof HTMLAnchorElement&&e.click()}if(e.defaultPrevented)return;const t=e.code;this.host.keepOpen&&"Escape"!==t||vb(t)&&(e.preventDefault(),this.host.dispatchEvent(gb(this.host,{kind:"keydown",key:t})))},this.getHeadlineElements=t.getHeadlineElements,this.getSupportingTextElements=t.getSupportingTextElements,this.getDefaultElements=t.getDefaultElements,this.getInteractiveElement=t.getInteractiveElement,this.host.addController(this)}get typeaheadText(){if(null!==this.internalTypeaheadText)return this.internalTypeaheadText;const e=this.getHeadlineElements(),t=[];return e.forEach((e=>{e.textContent&&e.textContent.trim()&&t.push(e.textContent.trim())})),0===t.length&&this.getDefaultElements().forEach((e=>{e.textContent&&e.textContent.trim()&&t.push(e.textContent.trim())})),0===t.length&&this.getSupportingTextElements().forEach((e=>{e.textContent&&e.textContent.trim()&&t.push(e.textContent.trim())})),t.join(" ")}get tagName(){switch(this.host.type){case"link":return"a";case"button":return"button";default:return"li"}}get role(){return"option"===this.host.type?"option":"menuitem"}hostConnected(){this.host.toggleAttribute("md-menu-item",!0)}hostUpdate(){this.host.href&&(this.host.type="link")}setTypeaheadText(e){this.internalTypeaheadText=e}}const Bb=fm(Ic);class Hb extends Bb{constructor(){super(...arguments),this.disabled=!1,this.type="menuitem",this.href="",this.target="",this.keepOpen=!1,this.selected=!1,this.menuItemController=new Ub(this,{getHeadlineElements:()=>this.headlineElements,getSupportingTextElements:()=>this.supportingTextElements,getDefaultElements:()=>this.defaultElements,getInteractiveElement:()=>this.listItemRoot})}get typeaheadText(){return this.menuItemController.typeaheadText}set typeaheadText(e){this.menuItemController.setTypeaheadText(e)}render(){return this.renderListItem(dc`
      <md-item>
        <div slot="container">
          ${this.renderRipple()} ${this.renderFocusRing()}
        </div>
        <slot name="start" slot="start"></slot>
        <slot name="end" slot="end"></slot>
        ${this.renderBody()}
      </md-item>
    `)}renderListItem(e){const t="link"===this.type;let i;switch(this.menuItemController.tagName){case"a":i=Db`a`;break;case"button":i=Db`button`;break;default:i=Db`li`}const r=t&&this.target?this.target:uc;return Fb`
      <${i}
        id="item"
        tabindex=${this.disabled&&!t?-1:0}
        role=${this.menuItemController.role}
        aria-label=${this.ariaLabel||uc}
        aria-selected=${this.ariaSelected||uc}
        aria-checked=${this.ariaChecked||uc}
        aria-expanded=${this.ariaExpanded||uc}
        aria-haspopup=${this.ariaHasPopup||uc}
        class="list-item ${th(this.getRenderClasses())}"
        href=${this.href||uc}
        target=${r}
        @click=${this.menuItemController.onClick}
        @keydown=${this.menuItemController.onKeydown}
      >${e}</${i}>
    `}renderRipple(){return dc` <md-ripple
      part="ripple"
      for="item"
      ?disabled=${this.disabled}></md-ripple>`}renderFocusRing(){return dc` <md-focus-ring
      part="focus-ring"
      for="item"
      inward></md-focus-ring>`}getRenderClasses(){return{disabled:this.disabled,selected:this.selected}}renderBody(){return dc`
      <slot></slot>
      <slot name="overline" slot="overline"></slot>
      <slot name="headline" slot="headline"></slot>
      <slot name="supporting-text" slot="supporting-text"></slot>
      <slot
        name="trailing-supporting-text"
        slot="trailing-supporting-text"></slot>
    `}focus(){this.listItemRoot?.focus()}}Hb.shadowRootOptions={...Ic.shadowRootOptions,delegatesFocus:!0},zg([Fc({type:Boolean,reflect:!0})],Hb.prototype,"disabled",void 0),zg([Fc()],Hb.prototype,"type",void 0),zg([Fc()],Hb.prototype,"href",void 0),zg([Fc()],Hb.prototype,"target",void 0),zg([Fc({type:Boolean,attribute:"keep-open"})],Hb.prototype,"keepOpen",void 0),zg([Fc({type:Boolean})],Hb.prototype,"selected",void 0),zg([Hc(".list-item")],Hb.prototype,"listItemRoot",void 0),zg([Vc({slot:"headline"})],Hb.prototype,"headlineElements",void 0),zg([Vc({slot:"supporting-text"})],Hb.prototype,"supportingTextElements",void 0),zg([Wc({slot:""})],Hb.prototype,"defaultElements",void 0),zg([Fc({attribute:"typeahead-text"})],Hb.prototype,"typeaheadText",null);const jb=Sd`:host{display:flex;--md-ripple-hover-color: var(--md-menu-item-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-menu-item-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-menu-item-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-opacity: var(--md-menu-item-pressed-state-layer-opacity, 0.12)}:host([disabled]){opacity:var(--md-menu-item-disabled-opacity, 0.3);pointer-events:none}md-focus-ring{z-index:1;--md-focus-ring-shape: 8px}a,button,li{background:none;border:none;padding:0;margin:0;text-align:unset;text-decoration:none}.list-item{border-radius:inherit;display:flex;flex:1;max-width:inherit;min-width:inherit;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.list-item:not(.disabled){cursor:pointer}[slot=container]{pointer-events:none}md-ripple{border-radius:inherit}md-item{border-radius:inherit;flex:1;color:var(--md-menu-item-label-text-color, var(--md-sys-color-on-surface, #1d1b20));font-family:var(--md-menu-item-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-menu-item-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));line-height:var(--md-menu-item-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));font-weight:var(--md-menu-item-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));min-height:var(--md-menu-item-one-line-container-height, 56px);padding-top:var(--md-menu-item-top-space, 12px);padding-bottom:var(--md-menu-item-bottom-space, 12px);padding-inline-start:var(--md-menu-item-leading-space, 16px);padding-inline-end:var(--md-menu-item-trailing-space, 16px)}md-item[multiline]{min-height:var(--md-menu-item-two-line-container-height, 72px)}[slot=supporting-text]{color:var(--md-menu-item-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-menu-item-supporting-text-font, var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-menu-item-supporting-text-size, var(--md-sys-typescale-body-medium-size, 0.875rem));line-height:var(--md-menu-item-supporting-text-line-height, var(--md-sys-typescale-body-medium-line-height, 1.25rem));font-weight:var(--md-menu-item-supporting-text-weight, var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400)))}[slot=trailing-supporting-text]{color:var(--md-menu-item-trailing-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-menu-item-trailing-supporting-text-font, var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-menu-item-trailing-supporting-text-size, var(--md-sys-typescale-label-small-size, 0.6875rem));line-height:var(--md-menu-item-trailing-supporting-text-line-height, var(--md-sys-typescale-label-small-line-height, 1rem));font-weight:var(--md-menu-item-trailing-supporting-text-weight, var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500)))}:is([slot=start],[slot=end])::slotted(*){fill:currentColor}[slot=start]{color:var(--md-menu-item-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}[slot=end]{color:var(--md-menu-item-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}.list-item{background-color:var(--md-menu-item-container-color, transparent)}.list-item.selected{background-color:var(--md-menu-item-selected-container-color, var(--md-sys-color-secondary-container, #e8def8))}.selected:not(.disabled) ::slotted(*){color:var(--md-menu-item-selected-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b))}@media(forced-colors: active){:host([disabled]),:host([disabled]) slot{color:GrayText;opacity:1}.list-item{position:relative}.list-item.selected::before{content:"";position:absolute;inset:0;box-sizing:border-box;border-radius:inherit;pointer-events:none;border:3px double CanvasText}}
`;let Gb=class extends Hb{};var zb;Gb.styles=[jb],Gb=zg([Dc("md-menu-item")],Gb),function(e){e[e.MOVED=0]="MOVED",e[e.NO_STOPS=1]="NO_STOPS",e[e.CLIPPED=2]="CLIPPED",e[e.ABORTED=3]="ABORTED"}(zb||(zb={}));class Vb{}function Wb(e){return!(e instanceof Vb)}class qb{constructor(){this.targetSubject=new Up(null),this.target$=this.targetSubject.asObservable(),this._targetHeight=null,this.index=-1,this.cursorTargetClass=null,this.cursorTargetAttribute=null,this.scrollMode=cg.NEVER,this.focusOnMove=!1,this.stopsInternal=[]}get target(){return this.targetSubject.getValue()}set target(e){this.targetSubject.next(e),this._scrollToTarget()}set stops(e){this.stopsInternal=e,this._updateIndex()}get stops(){return this.stopsInternal}get targetableStops(){return this.stops.filter(Wb)}next(e={}){return this._moveCursor(1,e)}previous(e={}){return this._moveCursor(-1,e)}async moveToVisibleArea(e){const t=await this.getCenterMostStop(e);t&&this.setCursor(t,!0)}async getCenterMostStop(e){const t=await this.getVisibleEntries(e),i=Math.round(window.innerHeight/2);let r,o=Number.MAX_VALUE;for(const e of t){const t=e.boundingClientRect.top+Math.round(e.boundingClientRect.height/2),s=Math.abs(t-i);s<o&&(r=e.target,o=s)}return r}async getVisibleEntries(e){if(!this.stops)return[];const t=e?this.targetableStops.filter(e):this.targetableStops;return new Promise((e=>{let i=t.length;const r=[],o=new IntersectionObserver((t=>{r.push(...t.filter((e=>e.isIntersecting||e.intersectionRatio>0)));for(const e of t)o.unobserve(e.target);i-=t.length,0===i&&e(r)}));for(const e of t)o.observe(e)}))}setCursor(e,t,i){if(!this.targetableStops.includes(e))return void this.unsetCursor();let r;t&&(r=this.scrollMode,this.scrollMode=cg.NEVER),this.unsetCursor(),this.target=e,this._updateIndex(),this._decorateTarget(),i&&this._focusAfterMove(),t&&r&&(this.scrollMode=r)}unsetCursor(){this._unDecorateTarget(),this.index=-1,this.target=null,this._targetHeight=null}isAtStart(){return 0===this.stops.length||0===this.index}isAtEnd(){return 0===this.stops.length||this.index===this.stops.length-1}moveToStart(){this.stops.length&&this.setCursorAtIndex(0)}moveToEnd(){this.stops.length&&this.setCursorAtIndex(this.stops.length-1)}setCursorAtIndex(e,t){const i=this.stops[e];Wb(i)&&this.setCursor(i,t)}_moveCursor(e,{filter:t,getTargetHeight:i,clipToTop:r,circular:o}={}){if(!this.stops.length)return this.unsetCursor(),zb.NO_STOPS;let s=this.index;-1===this.index&&e<0&&(s=this.stops.length);let n,a=!1;do{if(s+=e,e>0&&s>=this.stops.length||e<0&&s<0){s=e<0&&!o||e>0&&o||r?0:this.stops.length-1,n=this.stops[s],a=!0;break}n=this.stops[s]}while(Wb(n)&&t&&!t(n));return Wb(n)?(this._unDecorateTarget(),this.index=s,this.target=n,this._targetHeight=i?i(this.target):this.target.scrollHeight,this._decorateTarget(),this._focusAfterMove(),a?zb.CLIPPED:zb.MOVED):zb.ABORTED}_focusAfterMove(){this.focusOnMove&&this.target?.focus()}_decorateTarget(){this.target&&this.cursorTargetClass&&this.target.classList.add(this.cursorTargetClass),this.target&&this.cursorTargetAttribute&&this.target.setAttribute(this.cursorTargetAttribute,"")}_unDecorateTarget(){this.target&&this.cursorTargetClass&&this.target.classList.remove(this.cursorTargetClass),this.target&&this.cursorTargetAttribute&&this.target.removeAttribute(this.cursorTargetAttribute)}_updateIndex(){if(!this.target)return void(this.index=-1);const e=this.stops.indexOf(this.target);-1===e?this.unsetCursor():this.index=e}_getTop(e){let t=e.offsetTop;for(let i=e.offsetParent;i;i=i.offsetParent)t+=i.offsetTop;return t}_targetIsVisible(e){return this.scrollMode===cg.KEEP_VISIBLE&&e>window.scrollY+100&&e<window.scrollY+window.innerHeight}_calculateScrollToValue(e,t){return e+-window.innerHeight/3+t.offsetHeight/2}_scrollToTarget(){if(!this.target||this.scrollMode===cg.NEVER)return;const e=this._getTop(this.target),t=!this._targetHeight||this._targetIsVisible(e+this._targetHeight),i=this._calculateScrollToValue(e,this.target);this._targetIsVisible(e)&&(t||i<window.scrollY)||window.scrollTo(window.scrollX,i)}}var Kb=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let Yb=class extends Ic{constructor(){super(),this.initialCount=75,this.disabled=!1,this.value="",this.showCopyForTriggerText=!1,this.selectedIndex=0,this.opened=!1,this.hadKeyboardEvent=!1,this.cursor=new qb,this.onWindowResize=()=>{this.dropdown?.reposition()},this.cursor.cursorTargetAttribute="selected",this.cursor.focusOnMove=!0}static get styles(){return[Nc,Sd`
        :host {
          display: inline-block;
        }
        #triggerText {
          -moz-user-select: text;
          -ms-user-select: text;
          -webkit-user-select: text;
          user-select: text;
        }
        .dropdown-trigger {
          cursor: pointer;
          padding: 0;
        }
        md-menu {
          white-space: nowrap;
          --md-menu-container-color: var(--dropdown-background-color);
          --md-menu-top-space: 0px;
          --md-menu-bottom-space: 0px;
          --md-focus-ring-duration: 0s;
          max-height: calc(100vh - 48px);
        }
        md-divider {
          margin: auto;
          --md-divider-color: var(--border-color);
        }
        md-menu-item {
          max-height: 70vh;
          min-width: 266px;
          --md-sys-color-on-surface: var(
            --gr-dropdown-item-color,
            var(--primary-text-color, black)
          );
          --md-sys-color-on-secondary-container: var(
            --gr-dropdown-item-color,
            var(--primary-text-color, black)
          );
          --md-sys-typescale-body-large-font: inherit;
          --md-menu-item-hover-state-layer-color: var(
            --selection-background-color
          );
          --md-menu-item-hover-state-layer-opacity: 1;
          --md-menu-item-selected-container-color: var(
            --selection-background-color
          );
          --md-focus-ring-color: var(--gr-dropdown-focus-ring-color);
          --md-menu-item-one-line-container-height: auto;
        }
        md-menu-item[active] .topContent {
          font-weight: bold;
        }
        .dropdown {
          position: relative;
        }
        .dropdown-menu {
          position: relative;
          z-index: 120;
        }
        .bottomContent {
          color: var(--deemphasized-text-color);
          white-space: pre-wrap;
        }
        .bottomContent,
        .topContent {
          display: flex;
          justify-content: space-between;
          flex-direction: row;
          width: 100%;
        }
        gr-button {
          font-family: var(--trigger-style-font-family);
          --gr-button-text-color: var(--trigger-style-text-color);
        }
        gr-vote-chip {
          margin-right: var(--spacing-s);
        }
        gr-date-formatter {
          color: var(--deemphasized-text-color);
          margin-left: var(--spacing-xxl);
          white-space: nowrap;
        }
        .topContent.deemphasized {
          color: var(--deemphasized-text-color);
          font-style: italic;
        }
        gr-comments-summary {
          padding-left: var(--spacing-s);
        }
        .copyClipboard {
          display: inline-flex;
          vertical-align: top;
        }
        .mobileText {
          display: none;
        }
        .desktopText {
          display: inline-block;
        }
        gr-file-status {
          margin-left: var(--spacing-xxl);
        }
        @media only screen and (max-width: 50em) {
          .mobileText {
            display: inline-block;
          }
          .desktopText {
            display: none;
          }
        }
      `]}willUpdate(e){(e.has("value")||e.has("items"))&&this.updateText(),e.has("value")&&Qn(this,"value-change",{value:this.value})}updated(e){if(e.has("items")&&this.resetCursorStops(),e.has("opened"))if(this.opened){if(this.resetCursorStops(),this.cursor.setCursorAtIndex(this.selectedIndex),null!==this.cursor.target&&(this.cursor.target.focus(),Dn()&&!this.hadKeyboardEvent)){const e=this.cursor.target?.shadowRoot?.querySelector("md-item")?.querySelector("md-focus-ring");e&&(e.visible=!1)}this.setUpGlobalEventListeners()}else this.cleanUpGlobalEventListeners()}setUpGlobalEventListeners(){const e={passive:!0};window.addEventListener("resize",this.onWindowResize,e),window.addEventListener("scroll",this.onWindowResize,e)}cleanUpGlobalEventListeners(){const e={passive:!0};window.removeEventListener("resize",this.onWindowResize,e),window.removeEventListener("scroll",this.onWindowResize,e)}render(){return dc`<div class="dropdown">
      <gr-button
        id="trigger"
        ?disabled=${!!this.disabled}
        down-arrow
        link
        class="dropdown-trigger"
        slot="dropdown-trigger"
        @click=${this.showDropdownTapHandler}
        @keydown=${e=>{this.hadKeyboardEvent=!0,e.key!==Mn.DOWN&&e.key!==Mn.UP||this.dropdown?.open||(e.preventDefault(),e.stopPropagation(),this.dropdown?.show())}}
        @mousedown=${()=>{this.hadKeyboardEvent=!1}}
        @pointerdown=${()=>{this.hadKeyboardEvent=!1}}
        @touchstart=${()=>{this.hadKeyboardEvent=!1}}
      >
        <span id="triggerText" class="desktopText">${this.text}</span>
        <span id="triggerText" class="mobileText"
          >${Rg(this.text)}</span
        >
        <gr-copy-clipboard
          class="copyClipboard"
          ?hidden=${!this.showCopyForTriggerText}
          hideInput
          .text=${this.text}
        ></gr-copy-clipboard>
      </gr-button>
      <div class="dropdown-menu">
        <md-menu
          id="dropdown"
          anchor="trigger"
          default-focus="none"
          tabindex="-1"
          .menuCorner=${"start-start"}
          ?quick=${!0}
          .skipRestoreFocus=${!0}
          positioning="fixed"
          @click=${this.handleDropdownClick}
          @opened=${e=>{this.opened=!0,this.scrollToSelected(e)}}
          @closed=${()=>{this.opened=!1,this.hadKeyboardEvent=!1,this.cursor.target?.removeAttribute("selected"),this.cursor.target?.blur()}}
        >
          ${Zv({values:this.items??[],initialCount:this.initialCount,mapFn:(e,t)=>this.renderMdMenuItem(e,t)})}
        </md-menu>
      </div>
    </div> `}renderMdMenuItem(e,t){return this.value===String(e.value)&&(this.selectedIndex=t),dc`
      <md-menu-item
        ?selected=${this.value===String(e.value)}
        ?active=${this.value===String(e.value)}
        ?disabled=${!!e.disabled}
        @click=${()=>{this.value=String(e.value)}}
        @keydown=${e=>{e.key!==Mn.ENTER&&e.key!==Mn.SPACE||(e.preventDefault(),e.stopPropagation(),this.handleEnter()),e.key===Mn.UP&&(e.preventDefault(),e.stopPropagation(),this.handleUp()),e.key===Mn.DOWN&&(e.preventDefault(),e.stopPropagation(),this.handleDown())}}
      >
        <div
          class=${th({topContent:!0,deemphasized:!!e.deemphasizeReason})}
        >
          <div>
            <span class="desktopText">${e.text}</span>
            <span class="mobileText">${this.computeMobileText(e)}</span>
            ${eb(!!e.deemphasizeReason,(()=>dc`<span>| ${e.deemphasizeReason}</span>`))}
            ${eb(e.commentThreads,(()=>dc`<gr-comments-summary
                .commentThreads=${e.commentThreads}
                emptyWhenNoComments
                showAvatarForResolved
              ></gr-comments-summary>`))}
          </div>
          ${eb(e.vote,(()=>dc` <div>
                <gr-vote-chip
                  .vote=${e.vote}
                  .label=${e.label}
                ></gr-vote-chip>
              </div>`))}
          ${eb(e.date,(()=>dc`
              <gr-date-formatter .dateStr=${e.date}></gr-date-formatter>
            `))}
          ${eb(e.file?.status&&!Ag(e.file?.__path),(()=>dc`
              <gr-file-status .status=${e.file?.status}></gr-file-status>
            `))}
        </div>
        ${eb(e.bottomText,(()=>dc`
            <div class="bottomContent">
              <div>${e.bottomText}</div>
            </div>
          `))}
      </md-menu-item>
      ${t<this.items.length-1?dc`<md-divider role="separator" tabindex="-1"></md-divider>`:uc}
    `}handleUp(){this.cursor.previous()}handleDown(){this.cursor.next()}handleEnter(){if(null!==this.cursor.target){const e=this.cursor.target.shadowRoot?.querySelector(":not([hidden])");e&&e.click()}}handleDropdownClick(e){ba(this.dropdown),e&&(e.preventDefault(),e.stopPropagation()),this.dropdown.close(),e&&e.currentTarget&&e.currentTarget.blur()}updateText(){if(void 0===this.value||void 0===this.items)return;const e=this.items.find((e=>`${e.value}`===this.value));e&&(this.text=e.triggerText?e.triggerText:e.text)}showDropdownTapHandler(e){e.preventDefault(),e.stopPropagation(),this.open()}open(){ba(this.dropdown),this.dropdown.open=!this.dropdown.open,this.dropdown.focus()}computeMobileText(e){return e.mobileText?e.mobileText:e.text}scrollToSelected(e){const t=e.target.querySelector("md-menu-item[selected]");t?.scrollIntoView({block:"nearest"})}resetCursorStops(){ba(this.dropdown),this.items&&this.items.length>0&&this.dropdown.open&&(this.cursor.stops=Array.from(this.shadowRoot?.querySelectorAll("md-menu-item")??[]))}};Kb([Hc("#dropdown")],Yb.prototype,"dropdown",void 0),Kb([Hc("#trigger")],Yb.prototype,"trigger",void 0),Kb([Fc({type:Number})],Yb.prototype,"initialCount",void 0),Kb([Fc({type:Array})],Yb.prototype,"items",void 0),Kb([Fc({type:String})],Yb.prototype,"text",void 0),Kb([Fc({type:Boolean})],Yb.prototype,"disabled",void 0),Kb([Fc({type:String})],Yb.prototype,"value",void 0),Kb([Fc({type:Boolean,attribute:"show-copy-for-trigger-text"})],Yb.prototype,"showCopyForTriggerText",void 0),Kb([Uc()],Yb.prototype,"selectedIndex",void 0),Kb([Uc()],Yb.prototype,"opened",void 0),Kb([Uc()],Yb.prototype,"hadKeyboardEvent",void 0),Yb=Kb([Dc("gr-dropdown-list")],Yb);var Xb=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let Jb=class extends Ic{constructor(){super(),this.bodyScrollHandler=()=>this.handleBodyScroll()}connectedCallback(){super.connectedCallback(),window.addEventListener("scroll",this.bodyScrollHandler)}disconnectedCallback(){window.removeEventListener("scroll",this.bodyScrollHandler),super.disconnectedCallback()}static get styles(){return[Nc,Sd`
        nav {
          background-color: var(--table-header-background-color);
          border: 1px solid var(--border-color);
          border-top: none;
          height: 100%;
          position: absolute;
          top: 0;
          width: 14em;
        }
        nav.pinned {
          position: fixed;
        }
        @media only screen and (max-width: 53em) {
          nav {
            display: none;
          }
        }
      `]}render(){return dc`
      <nav aria-label="Sidebar">
        <slot></slot>
      </nav>
    `}handleBodyScroll(){if(ba(this.nav,"nav"),void 0===this.headerHeight){let e=this.getOffsetTop(this);for(let t=this.offsetParent;t;t=this.getOffsetParent(t))e+=this.getOffsetTop(t);this.headerHeight=e}this.nav.classList.toggle("pinned",this.getScrollY()>=(this.headerHeight||0))}getOffsetParent(e){if(e&&"offsetParent"in e)return e.offsetParent}getOffsetTop(e){return e.offsetTop}getScrollY(){return window.scrollY}};Xb([Hc("nav")],Jb.prototype,"nav",void 0),Xb([Uc()],Jb.prototype,"headerHeight",void 0),Jb=Xb([Dc("gr-page-nav")],Jb);const Qb=Sd`
  .font-normal {
    font-size: var(--font-size-normal);
    font-weight: var(--font-weight-normal);
    line-height: var(--line-height-normal);
  }
  .font-small {
    font-size: var(--font-size-small);
    font-weight: var(--font-weight-normal);
    line-height: var(--line-height-small);
  }
  .heading-1 {
    font-family: var(--header-font-family);
    font-size: var(--font-size-h1);
    font-weight: var(--font-weight-h1);
    line-height: var(--line-height-h1);
  }
  .heading-2 {
    font-family: var(--header-font-family);
    font-size: var(--font-size-h2);
    font-weight: var(--font-weight-h2);
    line-height: var(--line-height-h2);
  }
  .heading-3 {
    font-family: var(--header-font-family);
    font-size: var(--font-size-h3);
    font-weight: var(--font-weight-h3);
    line-height: var(--line-height-h3);
  }
  .heading-4 {
    font-family: var(--header-font-family);
    font-size: var(--font-size-normal);
    font-weight: var(--font-weight-h4);
    line-height: var(--line-height-normal);
  }
  strong {
    font-weight: var(--font-weight-medium);
  }
`,Zb=document.createElement("template");Zb.innerHTML=`<dom-module id="gr-font-styles">\n  <template>\n    <style>\n    ${Qb.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(Zb.content);var ey=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let ty=class extends Ic{constructor(){super(...arguments),this.confirmLabel="Confirm",this.cancelLabel="Cancel",this.loading=!1,this.loadingLabel="Loading...",this.disabled=!1,this.disableCancel=!1,this.confirmOnEnter=!1}firstUpdated(e){super.firstUpdated(e),this.getAttribute("role")||this.setAttribute("role","dialog")}static get styles(){return[Nc,Qb,Sd`
        :host {
          color: var(--primary-text-color);
          display: block;
          max-height: 90vh;
          overflow: auto;
        }
        .container {
          display: flex;
          flex-direction: column;
          max-height: 90vh;
        }
        header {
          flex-shrink: 0;
          padding: var(--spacing-xl);
        }
        main {
          display: flex;
          flex-shrink: 1;
          width: 100%;
          flex: 1;
          /* IMPORTANT: required for firefox */
          min-height: 0px;
        }
        main .overflow-container {
          flex: 1;
          overflow: auto;
          padding: 0 var(--spacing-xl);
        }
        footer {
          display: flex;
          flex-shrink: 0;
          padding: var(--spacing-xl);
          align-items: center;
        }
        .flex-space {
          flex-grow: 1;
        }
        gr-button {
          margin-left: var(--spacing-l);
        }
        .loadingSpin {
          width: 18px;
          height: 18px;
        }
      `]}render(){return dc`
      <div
        class="container"
        @keydown=${e=>this._handleKeydown(e)}
      >
        <header class="heading-3"><slot name="header"></slot></header>
        <main>
          <div class="overflow-container">
            <slot name="main"></slot>
          </div>
        </main>
        <footer>
          ${eb(this.loading,(()=>dc`
              <span
                class="loadingSpin"
                role="progressbar"
                aria-label=${this.loadingLabel}
              ></span>
              <span class="loadingLabel"> ${this.loadingLabel} </span>
            `))}
          <slot name="footer"></slot>
          ${eb(this.confirmLabel||this.cancelLabel,(()=>dc`
              <div class="flex-space"></div>
              ${eb(this.cancelLabel,(()=>dc`<gr-button
                  id="cancel"
                  link
                  ?disabled=${this.disableCancel}
                  @click=${e=>this.handleCancelTap(e)}
                >
                  ${this.cancelLabel}
                </gr-button>`))}
              ${eb(this.confirmLabel,(()=>dc`<gr-button
                  id="confirm"
                  link
                  primary
                  @click=${this._handleConfirm}
                  ?disabled=${this.disabled}
                  title=${this.confirmTooltip??""}
                >
                  ${this.confirmLabel}
                </gr-button>`))}
            `))}
        </footer>
      </div>
    `}updated(e){e.has("confirmTooltip")&&this.updateTooltip()}updateTooltip(){const e=this.confirmButton;e&&(this.confirmTooltip?e.setAttribute("has-tooltip","true"):e.removeAttribute("has-tooltip"))}_handleConfirm(e){this.disabled||(e.preventDefault(),e.stopPropagation(),Qn(this,"confirm",{}))}handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"cancel",{})}_handleKeydown(e){this.confirmOnEnter&&"Enter"===e.key&&this._handleConfirm(e)}resetFocus(){this.disabled&&this.cancelLabel?this.cancelButton.focus():this.confirmButton.focus()}};function iy(e,t){if(!e.length)return Promise.resolve();let i=!1;return t(e[0],(()=>{i=!0})).then((()=>i?Promise.resolve():iy(e.slice(1),t)))}ey([Hc("#cancel")],ty.prototype,"cancelButton",void 0),ey([Hc("#confirm")],ty.prototype,"confirmButton",void 0),ey([Fc({type:String,attribute:"confirm-label"})],ty.prototype,"confirmLabel",void 0),ey([Fc({type:String,attribute:"cancel-label"})],ty.prototype,"cancelLabel",void 0),ey([Fc({type:Boolean,attribute:"loading"})],ty.prototype,"loading",void 0),ey([Fc({type:String,attribute:"loading-label"})],ty.prototype,"loadingLabel",void 0),ey([Fc({type:Boolean})],ty.prototype,"disabled",void 0),ey([Fc({type:Boolean})],ty.prototype,"disableCancel",void 0),ey([Fc({type:Boolean,attribute:"confirm-on-enter"})],ty.prototype,"confirmOnEnter",void 0),ey([Fc({type:String,attribute:"confirm-tooltip"})],ty.prototype,"confirmTooltip",void 0),ty=ey([Dc("gr-dialog")],ty);const ry=new Map;var oy;!function(e){e.CALLBACK_EXECUTED="CALLBACK_EXECUTED",e.TASK_CANCELLED="TASK_CANCELLED"}(oy||(oy={}));class sy{callCallbackAndResolveOnCompletion(){let e;this.callback&&(e=this.callback()),e instanceof Promise?e.finally((()=>{this.resolvePromise(oy.CALLBACK_EXECUTED)})):this.resolvePromise(oy.CALLBACK_EXECUTED)}constructor(e,t=0){this.callback=e,this.promise=new Promise((e=>{this.resolvePromise=e,this.timerId=window.setTimeout((()=>{this.timerId&&ry.delete(this.timerId),this.timerId=void 0,this.callCallbackAndResolveOnCompletion()}),t),ry.set(this.timerId,this)}))}cancelTimer(){window.clearTimeout(this.timerId),this.timerId&&ry.delete(this.timerId),this.timerId=void 0}cancel(){this.isActive()&&(this.cancelTimer(),this.resolvePromise?.(oy.TASK_CANCELLED))}flush(){this.isActive()&&(this.cancelTimer(),this.callCallbackAndResolveOnCompletion())}isActive(){return void 0!==this.timerId}}function ny(e,t,i=0){return e?.cancel(),new sy(t,i)}const ay=Symbol("Delayed Cancellation");class ly extends Promise{constructor(e,t=0){let i,r;super(((e,t)=>{i=e,r=t})),this.callback=e,ba(i),ba(r),this.resolve=i,this.reject=r,this.timer=window.setTimeout((async()=>{await this.flush()}),t)}stop(){return void 0!==this.timer&&(window.clearTimeout(this.timer),this.timer=void 0,!0)}async flush(){if(this.stop())try{this.resolve(await this.callback())}catch(e){this.reject(e)}}cancel(e){this.stop()&&this.reject(e??ay)}delegate(e){this.stop()&&e.then((e=>this.resolve(e))).catch((e=>this.reject(e)))}static get[Symbol.species](){return Promise}get[Symbol.toStringTag](){return"DelayedPromise"}}function dy(e,t=500){let i;return r=>{void 0!==i&&Date.now()-i<t||(i=Date.now(),e(r))}}function cy(e,t){return new Promise((i=>{e.pipe($p(t),Rp(1)).subscribe((()=>{i()}))}))}function hy(e){return"fulfilled"===e?.status}function py(e){return Promise.all(e.map((e=>e.then((e=>({status:"fulfilled",value:e}))).catch((e=>({status:"rejected",reason:e}))))))}async function uy(e,t="The waitUntil() predicate is still false after 1000 ms.",i=1e3){if(await e())return Promise.resolve();const r=Date.now();let o=10;const s=new Error(t);return new Promise(((t,n)=>{const a=async()=>{await e()?t():Date.now()-r>=i?n(s):(setTimeout(a,o),o*=2)};a()}))}const gy=mu("navigation"),my=Sd`
  .gr-form-styles input {
    background-color: var(--view-background-color);
    color: var(--primary-text-color);
    font: inherit;
  }
  .gr-form-styles select {
    background-color: var(--select-background-color);
    color: var(--primary-text-color);
  }
  .gr-form-styles h1,
  .gr-form-styles h2 {
    margin-bottom: var(--spacing-s);
  }
  .gr-form-styles h4 {
    font-weight: var(--font-weight-medium);
  }
  .gr-form-styles fieldset {
    border: none;
    margin-bottom: var(--spacing-xxl);
  }
  .gr-form-styles section {
    display: flex;
    margin: var(--spacing-s) 0;
    min-height: 2em;
    align-items: center;
  }
  .gr-form-styles section * {
    vertical-align: middle;
  }
  .gr-form-styles .title,
  .gr-form-styles .value {
    display: inline-block;
  }
  .gr-form-styles .title {
    color: var(--deemphasized-text-color);
    font-weight: var(--font-weight-medium);
    padding-right: var(--spacing-m);
    width: 15em;
  }
  .gr-form-styles th {
    color: var(--deemphasized-text-color);
    text-align: left;
    vertical-align: bottom;
  }
  .gr-form-styles td,
  .gr-form-styles tfoot th {
    padding: var(--spacing-s) 0;
    vertical-align: middle;
  }
  .gr-form-styles .emptyHeader {
    text-align: right;
  }
  .gr-form-styles table {
    width: 50em;
  }
  .gr-form-styles th:first-child,
  .gr-form-styles td:first-child {
    width: 15em;
  }
  .gr-form-styles th:first-child input,
  .gr-form-styles td:first-child input {
    width: 14em;
  }
  .gr-form-styles input:not([type='checkbox']),
  .gr-form-styles select,
  .gr-form-styles textarea {
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    padding: var(--spacing-s);
  }
  .gr-form-styles td:last-child {
    width: 5em;
  }
  .gr-form-styles th:last-child gr-button,
  .gr-form-styles td:last-child gr-button {
    width: 100%;
  }
  .gr-form-styles gr-autogrow-textarea {
    height: auto;
    min-height: 4em;
  }
  .gr-form-styles gr-autocomplete {
    width: 14em;
  }
  @media only screen and (max-width: 40em) {
    .gr-form-styles section {
      margin-bottom: var(--spacing-l);
    }
    .gr-form-styles .title,
    .gr-form-styles .value {
      display: block;
    }
    .gr-form-styles table {
      width: 100%;
    }
  }
`,fy=document.createElement("template");fy.innerHTML=`<dom-module id="gr-form-styles">\n  <template>\n    <style>\n    ${my.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(fy.content);const vy=Sd`
  input {
    background-color: var(--background-color-primary);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    box-sizing: border-box;
    color: var(--primary-text-color);
    margin: 0;
    padding: var(--spacing-s);
  }
  /* prettier formatter removes semi-colons after css mixins. */
  /* prettier-ignore */
  gr-autogrow-textarea {
    background-color: inherit;
    color: var(--primary-text-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    padding: 0;
    box-sizing: border-box;
    /* gr-autogrow-textarea has a "-webkit-appearance: textarea" :host
        css rule, which prevents overriding the border color. Clear that. */
    -webkit-appearance: none;
    --gr-autogrow-textarea-box-sizing: border-box;
    --gr-autogrow-textarea-padding: var(--spacing-s);
  }
  input,
  textarea,
  select {
    font: inherit;
  }
`,by=document.createElement("template");by.innerHTML=`<dom-module id="form-styles">\n  <template>\n    <style>\n    ${my.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(by.content);class yy extends Ic{constructor(){super(...arguments),this.disabled=!1,this.error=!1,this.focused=!1,this.label="",this.noAsterisk=!1,this.populated=!1,this.required=!1,this.resizable=!1,this.supportingText="",this.errorText="",this.count=-1,this.max=-1,this.hasStart=!1,this.hasEnd=!1,this.isAnimating=!1,this.refreshErrorAlert=!1,this.disableTransitions=!1}get counterText(){const e=this.count??-1,t=this.max??-1;return e<0||t<=0?"":`${e} / ${t}`}get supportingOrErrorText(){return this.error&&this.errorText?this.errorText:this.supportingText}reannounceError(){this.refreshErrorAlert=!0}update(e){e.has("disabled")&&void 0!==e.get("disabled")&&(this.disableTransitions=!0),this.disabled&&this.focused&&(e.set("focused",!0),this.focused=!1),this.animateLabelIfNeeded({wasFocused:e.get("focused"),wasPopulated:e.get("populated")}),super.update(e)}render(){const e=this.renderLabel(!0),t=this.renderLabel(!1),i=this.renderOutline?.(e),r={disabled:this.disabled,"disable-transitions":this.disableTransitions,error:this.error&&!this.disabled,focused:this.focused,"with-start":this.hasStart,"with-end":this.hasEnd,populated:this.populated,resizable:this.resizable,required:this.required,"no-label":!this.label};return dc`
      <div class="field ${th(r)}">
        <div class="container-overflow">
          ${this.renderBackground?.()}
          <slot name="container"></slot>
          ${this.renderStateLayer?.()} ${this.renderIndicator?.()} ${i}
          <div class="container">
            <div class="start">
              <slot name="start"></slot>
            </div>
            <div class="middle">
              <div class="label-wrapper">
                ${t} ${i?uc:e}
              </div>
              <div class="content">
                <slot></slot>
              </div>
            </div>
            <div class="end">
              <slot name="end"></slot>
            </div>
          </div>
        </div>
        ${this.renderSupportingText()}
      </div>
    `}updated(e){(e.has("supportingText")||e.has("errorText")||e.has("count")||e.has("max"))&&this.updateSlottedAriaDescribedBy(),this.refreshErrorAlert&&requestAnimationFrame((()=>{this.refreshErrorAlert=!1})),this.disableTransitions&&requestAnimationFrame((()=>{this.disableTransitions=!1}))}renderSupportingText(){const{supportingOrErrorText:e,counterText:t}=this;if(!e&&!t)return uc;const i=dc`<span>${e}</span>`,r=t?dc`<span class="counter">${t}</span>`:uc,o=this.error&&this.errorText&&!this.refreshErrorAlert;return dc`
      <div class="supporting-text" role=${o?"alert":uc}>${i}${r}</div>
      <slot
        name="aria-describedby"
        @slotchange=${this.updateSlottedAriaDescribedBy}></slot>
    `}updateSlottedAriaDescribedBy(){for(const e of this.slottedAriaDescribedBy)Rc(dc`${this.supportingOrErrorText} ${this.counterText}`,e),e.setAttribute("hidden","")}renderLabel(e){if(!this.label)return uc;let t;t=e?this.focused||this.populated||this.isAnimating:!this.focused&&!this.populated&&!this.isAnimating;const i={hidden:!t,floating:e,resting:!e},r=`${this.label}${this.required&&!this.noAsterisk?"*":""}`;return dc`
      <span class="label ${th(i)}" aria-hidden=${!t}
        >${r}</span
      >
    `}animateLabelIfNeeded({wasFocused:e,wasPopulated:t}){this.label&&(e??=this.focused,t??=this.populated,(e||t)!==(this.focused||this.populated)&&(this.isAnimating=!0,this.labelAnimation?.cancel(),this.labelAnimation=this.floatingLabelEl?.animate(this.getLabelKeyframes(),{duration:150,easing:im}),this.labelAnimation?.addEventListener("finish",(()=>{this.isAnimating=!1}))))}getLabelKeyframes(){const{floatingLabelEl:e,restingLabelEl:t}=this;if(!e||!t)return[];const{x:i,y:r,height:o}=e.getBoundingClientRect(),{x:s,y:n,height:a}=t.getBoundingClientRect(),l=e.scrollWidth,d=t.scrollWidth,c=d/l,h=`translateX(${s-i}px) translateY(${n-r+Math.round((a-o*c)/2)}px) scale(${c})`,p="translateX(0) translateY(0) scale(1)",u=t.clientWidth,g=d>u?u/c+"px":"";return this.focused||this.populated?[{transform:h,width:g},{transform:p,width:g}]:[{transform:p,width:g},{transform:h,width:g}]}getSurfacePositionClientRect(){return this.containerEl.getBoundingClientRect()}}zg([Fc({type:Boolean})],yy.prototype,"disabled",void 0),zg([Fc({type:Boolean})],yy.prototype,"error",void 0),zg([Fc({type:Boolean})],yy.prototype,"focused",void 0),zg([Fc()],yy.prototype,"label",void 0),zg([Fc({type:Boolean,attribute:"no-asterisk"})],yy.prototype,"noAsterisk",void 0),zg([Fc({type:Boolean})],yy.prototype,"populated",void 0),zg([Fc({type:Boolean})],yy.prototype,"required",void 0),zg([Fc({type:Boolean})],yy.prototype,"resizable",void 0),zg([Fc({attribute:"supporting-text"})],yy.prototype,"supportingText",void 0),zg([Fc({attribute:"error-text"})],yy.prototype,"errorText",void 0),zg([Fc({type:Number})],yy.prototype,"count",void 0),zg([Fc({type:Number})],yy.prototype,"max",void 0),zg([Fc({type:Boolean,attribute:"has-start"})],yy.prototype,"hasStart",void 0),zg([Fc({type:Boolean,attribute:"has-end"})],yy.prototype,"hasEnd",void 0),zg([Vc({slot:"aria-describedby"})],yy.prototype,"slottedAriaDescribedBy",void 0),zg([Uc()],yy.prototype,"isAnimating",void 0),zg([Uc()],yy.prototype,"refreshErrorAlert",void 0),zg([Uc()],yy.prototype,"disableTransitions",void 0),zg([Hc(".label.floating")],yy.prototype,"floatingLabelEl",void 0),zg([Hc(".label.resting")],yy.prototype,"restingLabelEl",void 0),zg([Hc(".container")],yy.prototype,"containerEl",void 0);class wy extends yy{renderOutline(e){return dc`
      <div class="outline">
        <div class="outline-start"></div>
        <div class="outline-notch">
          <div class="outline-panel-inactive"></div>
          <div class="outline-panel-active"></div>
          <div class="outline-label">${e}</div>
        </div>
        <div class="outline-end"></div>
      </div>
    `}}const _y=Sd`@layer styles{:host{--_bottom-space: var(--md-outlined-field-bottom-space, 16px);--_content-color: var(--md-outlined-field-content-color, var(--md-sys-color-on-surface, #1d1b20));--_content-font: var(--md-outlined-field-content-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_content-line-height: var(--md-outlined-field-content-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_content-size: var(--md-outlined-field-content-size, var(--md-sys-typescale-body-large-size, 1rem));--_content-space: var(--md-outlined-field-content-space, 16px);--_content-weight: var(--md-outlined-field-content-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_disabled-content-color: var(--md-outlined-field-disabled-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-content-opacity: var(--md-outlined-field-disabled-content-opacity, 0.38);--_disabled-label-text-color: var(--md-outlined-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-outlined-field-disabled-label-text-opacity, 0.38);--_disabled-leading-content-color: var(--md-outlined-field-disabled-leading-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-content-opacity: var(--md-outlined-field-disabled-leading-content-opacity, 0.38);--_disabled-outline-color: var(--md-outlined-field-disabled-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-outline-opacity: var(--md-outlined-field-disabled-outline-opacity, 0.12);--_disabled-outline-width: var(--md-outlined-field-disabled-outline-width, 1px);--_disabled-supporting-text-color: var(--md-outlined-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-outlined-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-content-color: var(--md-outlined-field-disabled-trailing-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-content-opacity: var(--md-outlined-field-disabled-trailing-content-opacity, 0.38);--_error-content-color: var(--md-outlined-field-error-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-content-color: var(--md-outlined-field-error-focus-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-label-text-color: var(--md-outlined-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-content-color: var(--md-outlined-field-error-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-outline-color: var(--md-outlined-field-error-focus-outline-color, var(--md-sys-color-error, #b3261e));--_error-focus-supporting-text-color: var(--md-outlined-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-content-color: var(--md-outlined-field-error-focus-trailing-content-color, var(--md-sys-color-error, #b3261e));--_error-hover-content-color: var(--md-outlined-field-error-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-outlined-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-content-color: var(--md-outlined-field-error-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-outline-color: var(--md-outlined-field-error-hover-outline-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-supporting-text-color: var(--md-outlined-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-content-color: var(--md-outlined-field-error-hover-trailing-content-color, var(--md-sys-color-on-error-container, #410e0b));--_error-label-text-color: var(--md-outlined-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-content-color: var(--md-outlined-field-error-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-outline-color: var(--md-outlined-field-error-outline-color, var(--md-sys-color-error, #b3261e));--_error-supporting-text-color: var(--md-outlined-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-content-color: var(--md-outlined-field-error-trailing-content-color, var(--md-sys-color-error, #b3261e));--_focus-content-color: var(--md-outlined-field-focus-content-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-outlined-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-content-color: var(--md-outlined-field-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-outline-color: var(--md-outlined-field-focus-outline-color, var(--md-sys-color-primary, #6750a4));--_focus-outline-width: var(--md-outlined-field-focus-outline-width, 3px);--_focus-supporting-text-color: var(--md-outlined-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-content-color: var(--md-outlined-field-focus-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-content-color: var(--md-outlined-field-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-outlined-field-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-leading-content-color: var(--md-outlined-field-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-outline-color: var(--md-outlined-field-hover-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-outline-width: var(--md-outlined-field-hover-outline-width, 1px);--_hover-supporting-text-color: var(--md-outlined-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-content-color: var(--md-outlined-field-hover-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-color: var(--md-outlined-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-outlined-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-outlined-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-padding-bottom: var(--md-outlined-field-label-text-padding-bottom, 8px);--_label-text-populated-line-height: var(--md-outlined-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-outlined-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-outlined-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-outlined-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-content-color: var(--md-outlined-field-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-space: var(--md-outlined-field-leading-space, 16px);--_outline-color: var(--md-outlined-field-outline-color, var(--md-sys-color-outline, #79747e));--_outline-label-padding: var(--md-outlined-field-outline-label-padding, 4px);--_outline-width: var(--md-outlined-field-outline-width, 1px);--_supporting-text-color: var(--md-outlined-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-outlined-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-leading-space: var(--md-outlined-field-supporting-text-leading-space, 16px);--_supporting-text-line-height: var(--md-outlined-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-outlined-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-top-space: var(--md-outlined-field-supporting-text-top-space, 4px);--_supporting-text-trailing-space: var(--md-outlined-field-supporting-text-trailing-space, 16px);--_supporting-text-weight: var(--md-outlined-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_top-space: var(--md-outlined-field-top-space, 16px);--_trailing-content-color: var(--md-outlined-field-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-space: var(--md-outlined-field-trailing-space, 16px);--_with-leading-content-leading-space: var(--md-outlined-field-with-leading-content-leading-space, 12px);--_with-trailing-content-trailing-space: var(--md-outlined-field-with-trailing-content-trailing-space, 12px);--_container-shape-start-start: var(--md-outlined-field-container-shape-start-start, var(--md-outlined-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-outlined-field-container-shape-start-end, var(--md-outlined-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-outlined-field-container-shape-end-end, var(--md-outlined-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-start: var(--md-outlined-field-container-shape-end-start, var(--md-outlined-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)))}.outline{border-color:var(--_outline-color);border-radius:inherit;display:flex;pointer-events:none;height:100%;position:absolute;width:100%;z-index:1}.outline-start::before,.outline-start::after,.outline-panel-inactive::before,.outline-panel-inactive::after,.outline-panel-active::before,.outline-panel-active::after,.outline-end::before,.outline-end::after{border:inherit;content:"";inset:0;position:absolute}.outline-start,.outline-end{border:inherit;border-radius:inherit;box-sizing:border-box;position:relative}.outline-start::before,.outline-start::after,.outline-end::before,.outline-end::after{border-bottom-style:solid;border-top-style:solid}.outline-start::after,.outline-end::after{opacity:0;transition:opacity 150ms cubic-bezier(0.2, 0, 0, 1)}.focused .outline-start::after,.focused .outline-end::after{opacity:1}.outline-start::before,.outline-start::after{border-inline-start-style:solid;border-inline-end-style:none;border-start-start-radius:inherit;border-start-end-radius:0;border-end-start-radius:inherit;border-end-end-radius:0;margin-inline-end:var(--_outline-label-padding)}.outline-end{flex-grow:1;margin-inline-start:calc(-1*var(--_outline-label-padding))}.outline-end::before,.outline-end::after{border-inline-start-style:none;border-inline-end-style:solid;border-start-start-radius:0;border-start-end-radius:inherit;border-end-start-radius:0;border-end-end-radius:inherit}.outline-notch{align-items:flex-start;border:inherit;display:flex;margin-inline-start:calc(-1*var(--_outline-label-padding));margin-inline-end:var(--_outline-label-padding);max-width:calc(100% - var(--_leading-space) - var(--_trailing-space));padding:0 var(--_outline-label-padding);position:relative}.no-label .outline-notch{display:none}.outline-panel-inactive,.outline-panel-active{border:inherit;border-bottom-style:solid;inset:0;position:absolute}.outline-panel-inactive::before,.outline-panel-inactive::after,.outline-panel-active::before,.outline-panel-active::after{border-top-style:solid;border-bottom:none;bottom:auto;transform:scaleX(1);transition:transform 150ms cubic-bezier(0.2, 0, 0, 1)}.outline-panel-inactive::before,.outline-panel-active::before{right:50%;transform-origin:top left}.outline-panel-inactive::after,.outline-panel-active::after{left:50%;transform-origin:top right}.populated .outline-panel-inactive::before,.populated .outline-panel-inactive::after,.populated .outline-panel-active::before,.populated .outline-panel-active::after,.focused .outline-panel-inactive::before,.focused .outline-panel-inactive::after,.focused .outline-panel-active::before,.focused .outline-panel-active::after{transform:scaleX(0)}.outline-panel-active{opacity:0;transition:opacity 150ms cubic-bezier(0.2, 0, 0, 1)}.focused .outline-panel-active{opacity:1}.outline-label{display:flex;max-width:100%;transform:translateY(calc(-100% + var(--_label-text-padding-bottom)))}.outline-start,.field:not(.with-start) .content ::slotted(*){padding-inline-start:max(var(--_leading-space),max(var(--_container-shape-start-start),var(--_container-shape-end-start)) + var(--_outline-label-padding))}.field:not(.with-start) .label-wrapper{margin-inline-start:max(var(--_leading-space),max(var(--_container-shape-start-start),var(--_container-shape-end-start)) + var(--_outline-label-padding))}.field:not(.with-end) .content ::slotted(*){padding-inline-end:max(var(--_trailing-space),max(var(--_container-shape-start-end),var(--_container-shape-end-end)))}.field:not(.with-end) .label-wrapper{margin-inline-end:max(var(--_trailing-space),max(var(--_container-shape-start-end),var(--_container-shape-end-end)))}.outline-start::before,.outline-end::before,.outline-panel-inactive,.outline-panel-inactive::before,.outline-panel-inactive::after{border-width:var(--_outline-width)}:hover .outline{border-color:var(--_hover-outline-color);color:var(--_hover-outline-color)}:hover .outline-start::before,:hover .outline-end::before,:hover .outline-panel-inactive,:hover .outline-panel-inactive::before,:hover .outline-panel-inactive::after{border-width:var(--_hover-outline-width)}.focused .outline{border-color:var(--_focus-outline-color);color:var(--_focus-outline-color)}.outline-start::after,.outline-end::after,.outline-panel-active,.outline-panel-active::before,.outline-panel-active::after{border-width:var(--_focus-outline-width)}.disabled .outline{border-color:var(--_disabled-outline-color);color:var(--_disabled-outline-color)}.disabled .outline-start,.disabled .outline-end,.disabled .outline-panel-inactive{opacity:var(--_disabled-outline-opacity)}.disabled .outline-start::before,.disabled .outline-end::before,.disabled .outline-panel-inactive,.disabled .outline-panel-inactive::before,.disabled .outline-panel-inactive::after{border-width:var(--_disabled-outline-width)}.error .outline{border-color:var(--_error-outline-color);color:var(--_error-outline-color)}.error:hover .outline{border-color:var(--_error-hover-outline-color);color:var(--_error-hover-outline-color)}.error.focused .outline{border-color:var(--_error-focus-outline-color);color:var(--_error-focus-outline-color)}.resizable .container{bottom:var(--_focus-outline-width);inset-inline-end:var(--_focus-outline-width);clip-path:inset(var(--_focus-outline-width) 0 0 var(--_focus-outline-width))}.resizable .container>*{top:var(--_focus-outline-width);inset-inline-start:var(--_focus-outline-width)}.resizable .container:dir(rtl){clip-path:inset(var(--_focus-outline-width) var(--_focus-outline-width) 0 0)}}@layer hcm{@media(forced-colors: active){.disabled .outline{border-color:GrayText;color:GrayText}.disabled :is(.outline-start,.outline-end,.outline-panel-inactive){opacity:1}}}
`,xy=Sd`:host{display:inline-flex;resize:both}.field{display:flex;flex:1;flex-direction:column;writing-mode:horizontal-tb;max-width:100%}.container-overflow{border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-end-radius:var(--_container-shape-end-end);border-end-start-radius:var(--_container-shape-end-start);display:flex;height:100%;position:relative}.container{align-items:center;border-radius:inherit;display:flex;flex:1;max-height:100%;min-height:100%;min-width:min-content;position:relative}.field,.container-overflow{resize:inherit}.resizable:not(.disabled) .container{resize:inherit;overflow:hidden}.disabled{pointer-events:none}slot[name=container]{border-radius:inherit}slot[name=container]::slotted(*){border-radius:inherit;inset:0;pointer-events:none;position:absolute}@layer styles{.start,.middle,.end{display:flex;box-sizing:border-box;height:100%;position:relative}.start{color:var(--_leading-content-color)}.end{color:var(--_trailing-content-color)}.start,.end{align-items:center;justify-content:center}.with-start .start{margin-inline:var(--_with-leading-content-leading-space) var(--_content-space)}.with-end .end{margin-inline:var(--_content-space) var(--_with-trailing-content-trailing-space)}.middle{align-items:stretch;align-self:baseline;flex:1}.content{color:var(--_content-color);display:flex;flex:1;opacity:0;transition:opacity 83ms cubic-bezier(0.2, 0, 0, 1)}.no-label .content,.focused .content,.populated .content{opacity:1;transition-delay:67ms}:is(.disabled,.disable-transitions) .content{transition:none}.content ::slotted(*){all:unset;color:currentColor;font-family:var(--_content-font);font-size:var(--_content-size);line-height:var(--_content-line-height);font-weight:var(--_content-weight);width:100%;overflow-wrap:revert;white-space:revert}.content ::slotted(:not(textarea)){padding-top:var(--_top-space);padding-bottom:var(--_bottom-space)}.content ::slotted(textarea){margin-top:var(--_top-space);margin-bottom:var(--_bottom-space)}:hover .content{color:var(--_hover-content-color)}:hover .start{color:var(--_hover-leading-content-color)}:hover .end{color:var(--_hover-trailing-content-color)}.focused .content{color:var(--_focus-content-color)}.focused .start{color:var(--_focus-leading-content-color)}.focused .end{color:var(--_focus-trailing-content-color)}.disabled .content{color:var(--_disabled-content-color)}.disabled.no-label .content,.disabled.focused .content,.disabled.populated .content{opacity:var(--_disabled-content-opacity)}.disabled .start{color:var(--_disabled-leading-content-color);opacity:var(--_disabled-leading-content-opacity)}.disabled .end{color:var(--_disabled-trailing-content-color);opacity:var(--_disabled-trailing-content-opacity)}.error .content{color:var(--_error-content-color)}.error .start{color:var(--_error-leading-content-color)}.error .end{color:var(--_error-trailing-content-color)}.error:hover .content{color:var(--_error-hover-content-color)}.error:hover .start{color:var(--_error-hover-leading-content-color)}.error:hover .end{color:var(--_error-hover-trailing-content-color)}.error.focused .content{color:var(--_error-focus-content-color)}.error.focused .start{color:var(--_error-focus-leading-content-color)}.error.focused .end{color:var(--_error-focus-trailing-content-color)}}@layer hcm{@media(forced-colors: active){.disabled :is(.start,.content,.end){color:GrayText;opacity:1}}}@layer styles{.label{box-sizing:border-box;color:var(--_label-text-color);overflow:hidden;max-width:100%;text-overflow:ellipsis;white-space:nowrap;z-index:1;font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight);width:min-content}.label-wrapper{inset:0;pointer-events:none;position:absolute}.label.resting{position:absolute;top:var(--_top-space)}.label.floating{font-size:var(--_label-text-populated-size);line-height:var(--_label-text-populated-line-height);transform-origin:top left}.label.hidden{opacity:0}.no-label .label{display:none}.label-wrapper{inset:0;position:absolute;text-align:initial}:hover .label{color:var(--_hover-label-text-color)}.focused .label{color:var(--_focus-label-text-color)}.disabled .label{color:var(--_disabled-label-text-color)}.disabled .label:not(.hidden){opacity:var(--_disabled-label-text-opacity)}.error .label{color:var(--_error-label-text-color)}.error:hover .label{color:var(--_error-hover-label-text-color)}.error.focused .label{color:var(--_error-focus-label-text-color)}}@layer hcm{@media(forced-colors: active){.disabled .label:not(.hidden){color:GrayText;opacity:1}}}@layer styles{.supporting-text{color:var(--_supporting-text-color);display:flex;font-family:var(--_supporting-text-font);font-size:var(--_supporting-text-size);line-height:var(--_supporting-text-line-height);font-weight:var(--_supporting-text-weight);gap:16px;justify-content:space-between;padding-inline-start:var(--_supporting-text-leading-space);padding-inline-end:var(--_supporting-text-trailing-space);padding-top:var(--_supporting-text-top-space)}.supporting-text :nth-child(2){flex-shrink:0}:hover .supporting-text{color:var(--_hover-supporting-text-color)}.focus .supporting-text{color:var(--_focus-supporting-text-color)}.disabled .supporting-text{color:var(--_disabled-supporting-text-color);opacity:var(--_disabled-supporting-text-opacity)}.error .supporting-text{color:var(--_error-supporting-text-color)}.error:hover .supporting-text{color:var(--_error-hover-supporting-text-color)}.error.focus .supporting-text{color:var(--_error-focus-supporting-text-color)}}@layer hcm{@media(forced-colors: active){.disabled .supporting-text{color:GrayText;opacity:1}}}
`;let Cy=class extends wy{};Cy.styles=[xy,_y],Cy=zg([Dc("md-outlined-field")],Cy);const Ey=Sd`:host{--_caret-color: var(--md-outlined-text-field-caret-color, var(--md-sys-color-primary, #6750a4));--_disabled-input-text-color: var(--md-outlined-text-field-disabled-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-input-text-opacity: var(--md-outlined-text-field-disabled-input-text-opacity, 0.38);--_disabled-label-text-color: var(--md-outlined-text-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-outlined-text-field-disabled-label-text-opacity, 0.38);--_disabled-leading-icon-color: var(--md-outlined-text-field-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-icon-opacity: var(--md-outlined-text-field-disabled-leading-icon-opacity, 0.38);--_disabled-outline-color: var(--md-outlined-text-field-disabled-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-outline-opacity: var(--md-outlined-text-field-disabled-outline-opacity, 0.12);--_disabled-outline-width: var(--md-outlined-text-field-disabled-outline-width, 1px);--_disabled-supporting-text-color: var(--md-outlined-text-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-outlined-text-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-icon-color: var(--md-outlined-text-field-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-icon-opacity: var(--md-outlined-text-field-disabled-trailing-icon-opacity, 0.38);--_error-focus-caret-color: var(--md-outlined-text-field-error-focus-caret-color, var(--md-sys-color-error, #b3261e));--_error-focus-input-text-color: var(--md-outlined-text-field-error-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-label-text-color: var(--md-outlined-text-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-icon-color: var(--md-outlined-text-field-error-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-outline-color: var(--md-outlined-text-field-error-focus-outline-color, var(--md-sys-color-error, #b3261e));--_error-focus-supporting-text-color: var(--md-outlined-text-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-icon-color: var(--md-outlined-text-field-error-focus-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_error-hover-input-text-color: var(--md-outlined-text-field-error-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-outlined-text-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-icon-color: var(--md-outlined-text-field-error-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-outline-color: var(--md-outlined-text-field-error-hover-outline-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-supporting-text-color: var(--md-outlined-text-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-icon-color: var(--md-outlined-text-field-error-hover-trailing-icon-color, var(--md-sys-color-on-error-container, #410e0b));--_error-input-text-color: var(--md-outlined-text-field-error-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-label-text-color: var(--md-outlined-text-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-icon-color: var(--md-outlined-text-field-error-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-outline-color: var(--md-outlined-text-field-error-outline-color, var(--md-sys-color-error, #b3261e));--_error-supporting-text-color: var(--md-outlined-text-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-icon-color: var(--md-outlined-text-field-error-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_focus-input-text-color: var(--md-outlined-text-field-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-outlined-text-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-icon-color: var(--md-outlined-text-field-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-outline-color: var(--md-outlined-text-field-focus-outline-color, var(--md-sys-color-primary, #6750a4));--_focus-outline-width: var(--md-outlined-text-field-focus-outline-width, 3px);--_focus-supporting-text-color: var(--md-outlined-text-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-icon-color: var(--md-outlined-text-field-focus-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-input-text-color: var(--md-outlined-text-field-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-outlined-text-field-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-leading-icon-color: var(--md-outlined-text-field-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-outline-color: var(--md-outlined-text-field-hover-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-outline-width: var(--md-outlined-text-field-hover-outline-width, 1px);--_hover-supporting-text-color: var(--md-outlined-text-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-icon-color: var(--md-outlined-text-field-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-color: var(--md-outlined-text-field-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_input-text-font: var(--md-outlined-text-field-input-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_input-text-line-height: var(--md-outlined-text-field-input-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_input-text-placeholder-color: var(--md-outlined-text-field-input-text-placeholder-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-prefix-color: var(--md-outlined-text-field-input-text-prefix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-size: var(--md-outlined-text-field-input-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_input-text-suffix-color: var(--md-outlined-text-field-input-text-suffix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-weight: var(--md-outlined-text-field-input-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_label-text-color: var(--md-outlined-text-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-outlined-text-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-outlined-text-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-populated-line-height: var(--md-outlined-text-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-outlined-text-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-outlined-text-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-outlined-text-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-icon-color: var(--md-outlined-text-field-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-icon-size: var(--md-outlined-text-field-leading-icon-size, 24px);--_outline-color: var(--md-outlined-text-field-outline-color, var(--md-sys-color-outline, #79747e));--_outline-width: var(--md-outlined-text-field-outline-width, 1px);--_supporting-text-color: var(--md-outlined-text-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-outlined-text-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-line-height: var(--md-outlined-text-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-outlined-text-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-weight: var(--md-outlined-text-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_trailing-icon-color: var(--md-outlined-text-field-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-icon-size: var(--md-outlined-text-field-trailing-icon-size, 24px);--_container-shape-start-start: var(--md-outlined-text-field-container-shape-start-start, var(--md-outlined-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-outlined-text-field-container-shape-start-end, var(--md-outlined-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-outlined-text-field-container-shape-end-end, var(--md-outlined-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-start: var(--md-outlined-text-field-container-shape-end-start, var(--md-outlined-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_icon-input-space: var(--md-outlined-text-field-icon-input-space, 16px);--_leading-space: var(--md-outlined-text-field-leading-space, 16px);--_trailing-space: var(--md-outlined-text-field-trailing-space, 16px);--_top-space: var(--md-outlined-text-field-top-space, 16px);--_bottom-space: var(--md-outlined-text-field-bottom-space, 16px);--_input-text-prefix-trailing-space: var(--md-outlined-text-field-input-text-prefix-trailing-space, 2px);--_input-text-suffix-leading-space: var(--md-outlined-text-field-input-text-suffix-leading-space, 2px);--_focus-caret-color: var(--md-outlined-text-field-focus-caret-color, var(--md-sys-color-primary, #6750a4));--_with-leading-icon-leading-space: var(--md-outlined-text-field-with-leading-icon-leading-space, 12px);--_with-trailing-icon-trailing-space: var(--md-outlined-text-field-with-trailing-icon-trailing-space, 12px);--md-outlined-field-bottom-space: var(--_bottom-space);--md-outlined-field-container-shape-end-end: var(--_container-shape-end-end);--md-outlined-field-container-shape-end-start: var(--_container-shape-end-start);--md-outlined-field-container-shape-start-end: var(--_container-shape-start-end);--md-outlined-field-container-shape-start-start: var(--_container-shape-start-start);--md-outlined-field-content-color: var(--_input-text-color);--md-outlined-field-content-font: var(--_input-text-font);--md-outlined-field-content-line-height: var(--_input-text-line-height);--md-outlined-field-content-size: var(--_input-text-size);--md-outlined-field-content-space: var(--_icon-input-space);--md-outlined-field-content-weight: var(--_input-text-weight);--md-outlined-field-disabled-content-color: var(--_disabled-input-text-color);--md-outlined-field-disabled-content-opacity: var(--_disabled-input-text-opacity);--md-outlined-field-disabled-label-text-color: var(--_disabled-label-text-color);--md-outlined-field-disabled-label-text-opacity: var(--_disabled-label-text-opacity);--md-outlined-field-disabled-leading-content-color: var(--_disabled-leading-icon-color);--md-outlined-field-disabled-leading-content-opacity: var(--_disabled-leading-icon-opacity);--md-outlined-field-disabled-outline-color: var(--_disabled-outline-color);--md-outlined-field-disabled-outline-opacity: var(--_disabled-outline-opacity);--md-outlined-field-disabled-outline-width: var(--_disabled-outline-width);--md-outlined-field-disabled-supporting-text-color: var(--_disabled-supporting-text-color);--md-outlined-field-disabled-supporting-text-opacity: var(--_disabled-supporting-text-opacity);--md-outlined-field-disabled-trailing-content-color: var(--_disabled-trailing-icon-color);--md-outlined-field-disabled-trailing-content-opacity: var(--_disabled-trailing-icon-opacity);--md-outlined-field-error-content-color: var(--_error-input-text-color);--md-outlined-field-error-focus-content-color: var(--_error-focus-input-text-color);--md-outlined-field-error-focus-label-text-color: var(--_error-focus-label-text-color);--md-outlined-field-error-focus-leading-content-color: var(--_error-focus-leading-icon-color);--md-outlined-field-error-focus-outline-color: var(--_error-focus-outline-color);--md-outlined-field-error-focus-supporting-text-color: var(--_error-focus-supporting-text-color);--md-outlined-field-error-focus-trailing-content-color: var(--_error-focus-trailing-icon-color);--md-outlined-field-error-hover-content-color: var(--_error-hover-input-text-color);--md-outlined-field-error-hover-label-text-color: var(--_error-hover-label-text-color);--md-outlined-field-error-hover-leading-content-color: var(--_error-hover-leading-icon-color);--md-outlined-field-error-hover-outline-color: var(--_error-hover-outline-color);--md-outlined-field-error-hover-supporting-text-color: var(--_error-hover-supporting-text-color);--md-outlined-field-error-hover-trailing-content-color: var(--_error-hover-trailing-icon-color);--md-outlined-field-error-label-text-color: var(--_error-label-text-color);--md-outlined-field-error-leading-content-color: var(--_error-leading-icon-color);--md-outlined-field-error-outline-color: var(--_error-outline-color);--md-outlined-field-error-supporting-text-color: var(--_error-supporting-text-color);--md-outlined-field-error-trailing-content-color: var(--_error-trailing-icon-color);--md-outlined-field-focus-content-color: var(--_focus-input-text-color);--md-outlined-field-focus-label-text-color: var(--_focus-label-text-color);--md-outlined-field-focus-leading-content-color: var(--_focus-leading-icon-color);--md-outlined-field-focus-outline-color: var(--_focus-outline-color);--md-outlined-field-focus-outline-width: var(--_focus-outline-width);--md-outlined-field-focus-supporting-text-color: var(--_focus-supporting-text-color);--md-outlined-field-focus-trailing-content-color: var(--_focus-trailing-icon-color);--md-outlined-field-hover-content-color: var(--_hover-input-text-color);--md-outlined-field-hover-label-text-color: var(--_hover-label-text-color);--md-outlined-field-hover-leading-content-color: var(--_hover-leading-icon-color);--md-outlined-field-hover-outline-color: var(--_hover-outline-color);--md-outlined-field-hover-outline-width: var(--_hover-outline-width);--md-outlined-field-hover-supporting-text-color: var(--_hover-supporting-text-color);--md-outlined-field-hover-trailing-content-color: var(--_hover-trailing-icon-color);--md-outlined-field-label-text-color: var(--_label-text-color);--md-outlined-field-label-text-font: var(--_label-text-font);--md-outlined-field-label-text-line-height: var(--_label-text-line-height);--md-outlined-field-label-text-populated-line-height: var(--_label-text-populated-line-height);--md-outlined-field-label-text-populated-size: var(--_label-text-populated-size);--md-outlined-field-label-text-size: var(--_label-text-size);--md-outlined-field-label-text-weight: var(--_label-text-weight);--md-outlined-field-leading-content-color: var(--_leading-icon-color);--md-outlined-field-leading-space: var(--_leading-space);--md-outlined-field-outline-color: var(--_outline-color);--md-outlined-field-outline-width: var(--_outline-width);--md-outlined-field-supporting-text-color: var(--_supporting-text-color);--md-outlined-field-supporting-text-font: var(--_supporting-text-font);--md-outlined-field-supporting-text-line-height: var(--_supporting-text-line-height);--md-outlined-field-supporting-text-size: var(--_supporting-text-size);--md-outlined-field-supporting-text-weight: var(--_supporting-text-weight);--md-outlined-field-top-space: var(--_top-space);--md-outlined-field-trailing-content-color: var(--_trailing-icon-color);--md-outlined-field-trailing-space: var(--_trailing-space);--md-outlined-field-with-leading-content-leading-space: var(--_with-leading-icon-leading-space);--md-outlined-field-with-trailing-content-trailing-space: var(--_with-trailing-icon-trailing-space)}
`,Sy=Zc(class extends eh{constructor(e){if(super(e),3!==e.type&&1!==e.type&&4!==e.type)throw Error("The `live` directive is not allowed on child or event bindings");if(!Fv(e))throw Error("`live` bindings can only contain a single expression")}render(e){return e}update(e,[t]){if(t===pc||t===uc)return t;const i=e.element,r=e.name;if(3===e.type){if(t===i[r])return pc}else if(4===e.type){if(!!t===i.hasAttribute(r))return pc}else if(1===e.type&&i.getAttribute(r)===t+"")return pc;return Gv(e),t}});function $y(e,t){!t.bubbles||e.shadowRoot&&!t.composed||t.stopPropagation();const i=Reflect.construct(t.constructor,[t.type,t]),r=e.dispatchEvent(i);return r||t.preventDefault(),r}const ky=Symbol("createValidator"),Ay=Symbol("getValidityAnchor"),Ry=Symbol("privateValidator"),Ty=Symbol("privateSyncValidity"),Iy=Symbol("privateCustomValidationMessage");function Py(e){var t;class i extends e{constructor(){super(...arguments),this[t]=""}get validity(){return this[Ty](),this[ym].validity}get validationMessage(){return this[Ty](),this[ym].validationMessage}get willValidate(){return this[Ty](),this[ym].willValidate}checkValidity(){return this[Ty](),this[ym].checkValidity()}reportValidity(){return this[Ty](),this[ym].reportValidity()}setCustomValidity(e){this[Iy]=e,this[Ty]()}requestUpdate(e,t,i){super.requestUpdate(e,t,i),this[Ty]()}firstUpdated(e){super.firstUpdated(e),this[Ty]()}[(t=Iy,Ty)](){this[Ry]||(this[Ry]=this[ky]());const{validity:e,validationMessage:t}=this[Ry].getValidity(),i=!!this[Iy],r=this[Iy]||t;this[ym].setValidity({...e,customError:i},r,this[Ay]()??void 0)}[ky](){throw new Error("Implement [createValidator]")}[Ay](){throw new Error("Implement [getValidityAnchor]")}}return i}const Ny=Symbol("getFormValue"),Oy=Symbol("getFormState");function Dy(e){class t extends e{get form(){return this[ym].form}get labels(){return this[ym].labels}get name(){return this.getAttribute("name")??""}set name(e){this.setAttribute("name",e)}get disabled(){return this.hasAttribute("disabled")}set disabled(e){this.toggleAttribute("disabled",e)}attributeChangedCallback(e,t,i){if("name"!==e&&"disabled"!==e)super.attributeChangedCallback(e,t,i);else{const i="disabled"===e?null!==t:t;this.requestUpdate(e,i)}}requestUpdate(e,t,i){super.requestUpdate(e,t,i),this[ym].setFormValue(this[Ny](),this[Oy]())}[Ny](){throw new Error("Implement [getFormValue]")}[Oy](){return this[Ny]()}formDisabledCallback(e){this.disabled=e}}return t.formAssociated=!0,zg([Fc({noAccessor:!0})],t.prototype,"name",null),zg([Fc({type:Boolean,noAccessor:!0})],t.prototype,"disabled",null),t}const Ly=Symbol("onReportValidity"),My=Symbol("privateCleanupFormListeners"),Fy=Symbol("privateDoNotReportInvalid"),Uy=Symbol("privateIsSelfReportingValidity"),By=Symbol("privateCallOnReportValidity");function Hy(e){var t,i,r;class o extends e{constructor(...e){super(...e),this[t]=new AbortController,this[i]=!1,this[r]=!1,this.addEventListener("invalid",(e=>{!this[Fy]&&e.isTrusted&&this.addEventListener("invalid",(()=>{this[By](e)}),{once:!0})}),{capture:!0})}checkValidity(){this[Fy]=!0;const e=super.checkValidity();return this[Fy]=!1,e}reportValidity(){this[Uy]=!0;const e=super.reportValidity();return e&&this[By](null),this[Uy]=!1,e}[(t=My,i=Fy,r=Uy,By)](e){const t=e?.defaultPrevented;t||(this[Ly](e),!t&&e?.defaultPrevented&&(this[Uy]||function(e,t){if(!e)return!0;let i;for(const t of e.elements)if(t.matches(":invalid")){i=t;break}return i===t}(this[ym].form,this))&&this.focus())}[Ly](e){throw new Error("Implement [onReportValidity]")}formAssociatedCallback(e){super.formAssociatedCallback&&super.formAssociatedCallback(e),this[My].abort(),e&&(this[My]=new AbortController,function(e,t,i,r){const o=function(e){if(!jy.has(e)){const t=new EventTarget;jy.set(e,t);for(const i of["reportValidity","requestSubmit"]){const r=e[i];e[i]=function(){t.dispatchEvent(new Event("before"));const e=Reflect.apply(r,this,arguments);return t.dispatchEvent(new Event("after")),e}}}return jy.get(e)}(t);let s,n=!1,a=!1;o.addEventListener("before",(()=>{a=!0,s=new AbortController,n=!1,e.addEventListener("invalid",(()=>{n=!0}),{signal:s.signal})}),{signal:r}),o.addEventListener("after",(()=>{a=!1,s?.abort(),n||i()}),{signal:r}),t.addEventListener("submit",(()=>{a||i()}),{signal:r})}(this,e,(()=>{this[By](null)}),this[My].signal))}}return o}const jy=new WeakMap;class Gy{constructor(e){this.getCurrentState=e,this.currentValidity={validity:{},validationMessage:""}}getValidity(){const e=this.getCurrentState();if(this.prevState&&this.equals(this.prevState,e))return this.currentValidity;const{validity:t,validationMessage:i}=this.computeValidity(e);return this.prevState=this.copy(e),this.currentValidity={validationMessage:i,validity:{badInput:t.badInput,customError:t.customError,patternMismatch:t.patternMismatch,rangeOverflow:t.rangeOverflow,rangeUnderflow:t.rangeUnderflow,stepMismatch:t.stepMismatch,tooLong:t.tooLong,tooShort:t.tooShort,typeMismatch:t.typeMismatch,valueMissing:t.valueMissing}},this.currentValidity}}class zy extends Gy{computeValidity({state:e,renderedControl:t}){let i=t;Vy(e)&&!i?(i=this.inputControl||document.createElement("input"),this.inputControl=i):i||(i=this.textAreaControl||document.createElement("textarea"),this.textAreaControl=i);const r=Vy(e)?i:null;if(r&&(r.type=e.type),i.value!==e.value&&(i.value=e.value),i.required=e.required,r){const t=e;t.pattern?r.pattern=t.pattern:r.removeAttribute("pattern"),t.min?r.min=t.min:r.removeAttribute("min"),t.max?r.max=t.max:r.removeAttribute("max"),t.step?r.step=t.step:r.removeAttribute("step")}return(e.minLength??-1)>-1?i.setAttribute("minlength",String(e.minLength)):i.removeAttribute("minlength"),(e.maxLength??-1)>-1?i.setAttribute("maxlength",String(e.maxLength)):i.removeAttribute("maxlength"),{validity:i.validity,validationMessage:i.validationMessage}}equals({state:e},{state:t}){const i=e.type===t.type&&e.value===t.value&&e.required===t.required&&e.minLength===t.minLength&&e.maxLength===t.maxLength;return Vy(e)&&Vy(t)?i&&e.pattern===t.pattern&&e.min===t.min&&e.max===t.max&&e.step===t.step:i}copy({state:e}){return{state:Vy(e)?this.copyInput(e):this.copyTextArea(e),renderedControl:null}}copyInput(e){const{type:t,pattern:i,min:r,max:o,step:s}=e;return{...this.copySharedState(e),type:t,pattern:i,min:r,max:o,step:s}}copyTextArea(e){return{...this.copySharedState(e),type:e.type}}copySharedState({value:e,required:t,minLength:i,maxLength:r}){return{value:e,required:t,minLength:i,maxLength:r}}}function Vy(e){return"textarea"!==e.type}const Wy=fm(Hy(Py(Dy(_m(Ic)))));class qy extends Wy{constructor(){super(...arguments),this.error=!1,this.errorText="",this.label="",this.noAsterisk=!1,this.required=!1,this.value="",this.prefixText="",this.suffixText="",this.hasLeadingIcon=!1,this.hasTrailingIcon=!1,this.supportingText="",this.textDirection="",this.rows=2,this.cols=20,this.inputMode="",this.max="",this.maxLength=-1,this.min="",this.minLength=-1,this.noSpinner=!1,this.pattern="",this.placeholder="",this.readOnly=!1,this.multiple=!1,this.step="",this.type="text",this.autocomplete="",this.dirty=!1,this.focused=!1,this.nativeError=!1,this.nativeErrorText=""}get selectionDirection(){return this.getInputOrTextarea().selectionDirection}set selectionDirection(e){this.getInputOrTextarea().selectionDirection=e}get selectionEnd(){return this.getInputOrTextarea().selectionEnd}set selectionEnd(e){this.getInputOrTextarea().selectionEnd=e}get selectionStart(){return this.getInputOrTextarea().selectionStart}set selectionStart(e){this.getInputOrTextarea().selectionStart=e}get valueAsNumber(){const e=this.getInput();return e?e.valueAsNumber:NaN}set valueAsNumber(e){const t=this.getInput();t&&(t.valueAsNumber=e,this.value=t.value)}get valueAsDate(){const e=this.getInput();return e?e.valueAsDate:null}set valueAsDate(e){const t=this.getInput();t&&(t.valueAsDate=e,this.value=t.value)}get hasError(){return this.error||this.nativeError}select(){this.getInputOrTextarea().select()}setRangeText(...e){this.getInputOrTextarea().setRangeText(...e),this.value=this.getInputOrTextarea().value}setSelectionRange(e,t,i){this.getInputOrTextarea().setSelectionRange(e,t,i)}showPicker(){const e=this.getInput();e&&e.showPicker()}stepDown(e){const t=this.getInput();t&&(t.stepDown(e),this.value=t.value)}stepUp(e){const t=this.getInput();t&&(t.stepUp(e),this.value=t.value)}reset(){this.dirty=!1,this.value=this.getAttribute("value")??"",this.nativeError=!1,this.nativeErrorText=""}attributeChangedCallback(e,t,i){"value"===e&&this.dirty||super.attributeChangedCallback(e,t,i)}render(){const e={disabled:this.disabled,error:!this.disabled&&this.hasError,textarea:"textarea"===this.type,"no-spinner":this.noSpinner};return dc`
      <span class="text-field ${th(e)}">
        ${this.renderField()}
      </span>
    `}updated(e){const t=this.getInputOrTextarea().value;this.value!==t&&(this.value=t)}renderField(){return Fb`<${this.fieldTag}
      class="field"
      count=${this.value.length}
      ?disabled=${this.disabled}
      ?error=${this.hasError}
      error-text=${this.getErrorText()}
      ?focused=${this.focused}
      ?has-end=${this.hasTrailingIcon}
      ?has-start=${this.hasLeadingIcon}
      label=${this.label}
      ?no-asterisk=${this.noAsterisk}
      max=${this.maxLength}
      ?populated=${!!this.value}
      ?required=${this.required}
      ?resizable=${"textarea"===this.type}
      supporting-text=${this.supportingText}
    >
      ${this.renderLeadingIcon()}
      ${this.renderInputOrTextarea()}
      ${this.renderTrailingIcon()}
      <div id="description" slot="aria-describedby"></div>
      <slot name="container" slot="container"></slot>
    </${this.fieldTag}>`}renderLeadingIcon(){return dc`
      <span class="icon leading" slot="start">
        <slot name="leading-icon" @slotchange=${this.handleIconChange}></slot>
      </span>
    `}renderTrailingIcon(){return dc`
      <span class="icon trailing" slot="end">
        <slot name="trailing-icon" @slotchange=${this.handleIconChange}></slot>
      </span>
    `}renderInputOrTextarea(){const e={direction:this.textDirection},t=this.ariaLabel||this.label||uc,i=this.autocomplete,r=(this.maxLength??-1)>-1,o=(this.minLength??-1)>-1;if("textarea"===this.type)return dc`
        <textarea
          class="input"
          style=${Bm(e)}
          aria-describedby="description"
          aria-invalid=${this.hasError}
          aria-label=${t}
          autocomplete=${i||uc}
          name=${this.name||uc}
          ?disabled=${this.disabled}
          maxlength=${r?this.maxLength:uc}
          minlength=${o?this.minLength:uc}
          placeholder=${this.placeholder||uc}
          ?readonly=${this.readOnly}
          ?required=${this.required}
          rows=${this.rows}
          cols=${this.cols}
          .value=${Sy(this.value)}
          @change=${this.redispatchEvent}
          @focus=${this.handleFocusChange}
          @blur=${this.handleFocusChange}
          @input=${this.handleInput}
          @select=${this.redispatchEvent}></textarea>
      `;const s=this.renderPrefix(),n=this.renderSuffix(),a=this.inputMode;return dc`
      <div class="input-wrapper">
        ${s}
        <input
          class="input"
          style=${Bm(e)}
          aria-describedby="description"
          aria-invalid=${this.hasError}
          aria-label=${t}
          autocomplete=${i||uc}
          name=${this.name||uc}
          ?disabled=${this.disabled}
          inputmode=${a||uc}
          max=${this.max||uc}
          maxlength=${r?this.maxLength:uc}
          min=${this.min||uc}
          minlength=${o?this.minLength:uc}
          pattern=${this.pattern||uc}
          placeholder=${this.placeholder||uc}
          ?readonly=${this.readOnly}
          ?required=${this.required}
          ?multiple=${this.multiple}
          step=${this.step||uc}
          type=${this.type}
          .value=${Sy(this.value)}
          @change=${this.redispatchEvent}
          @focus=${this.handleFocusChange}
          @blur=${this.handleFocusChange}
          @input=${this.handleInput}
          @select=${this.redispatchEvent} />
        ${n}
      </div>
    `}renderPrefix(){return this.renderAffix(this.prefixText,!1)}renderSuffix(){return this.renderAffix(this.suffixText,!0)}renderAffix(e,t){return e?dc`<span class="${th({suffix:t,prefix:!t})}">${e}</span>`:uc}getErrorText(){return this.error?this.errorText:this.nativeErrorText}handleFocusChange(){this.focused=this.inputOrTextarea?.matches(":focus")??!1}handleInput(e){this.dirty=!0,this.value=e.target.value}redispatchEvent(e){$y(this,e)}getInputOrTextarea(){return this.inputOrTextarea||(this.connectedCallback(),this.scheduleUpdate()),this.isUpdatePending&&this.scheduleUpdate(),this.inputOrTextarea}getInput(){return"textarea"===this.type?null:this.getInputOrTextarea()}handleIconChange(){this.hasLeadingIcon=this.leadingIcons.length>0,this.hasTrailingIcon=this.trailingIcons.length>0}[Ny](){return this.value}formResetCallback(){this.reset()}formStateRestoreCallback(e){this.value=e}focus(){this.getInputOrTextarea().focus()}[ky](){return new zy((()=>({state:this,renderedControl:this.inputOrTextarea})))}[Ay](){return this.inputOrTextarea}[Ly](e){e?.preventDefault();const t=this.getErrorText();this.nativeError=!!e,this.nativeErrorText=this.validationMessage,t===this.getErrorText()&&this.field?.reannounceError()}}qy.shadowRootOptions={...Ic.shadowRootOptions,delegatesFocus:!0},zg([Fc({type:Boolean,reflect:!0})],qy.prototype,"error",void 0),zg([Fc({attribute:"error-text"})],qy.prototype,"errorText",void 0),zg([Fc()],qy.prototype,"label",void 0),zg([Fc({type:Boolean,attribute:"no-asterisk"})],qy.prototype,"noAsterisk",void 0),zg([Fc({type:Boolean,reflect:!0})],qy.prototype,"required",void 0),zg([Fc()],qy.prototype,"value",void 0),zg([Fc({attribute:"prefix-text"})],qy.prototype,"prefixText",void 0),zg([Fc({attribute:"suffix-text"})],qy.prototype,"suffixText",void 0),zg([Fc({type:Boolean,attribute:"has-leading-icon"})],qy.prototype,"hasLeadingIcon",void 0),zg([Fc({type:Boolean,attribute:"has-trailing-icon"})],qy.prototype,"hasTrailingIcon",void 0),zg([Fc({attribute:"supporting-text"})],qy.prototype,"supportingText",void 0),zg([Fc({attribute:"text-direction"})],qy.prototype,"textDirection",void 0),zg([Fc({type:Number})],qy.prototype,"rows",void 0),zg([Fc({type:Number})],qy.prototype,"cols",void 0),zg([Fc({reflect:!0})],qy.prototype,"inputMode",void 0),zg([Fc()],qy.prototype,"max",void 0),zg([Fc({type:Number})],qy.prototype,"maxLength",void 0),zg([Fc()],qy.prototype,"min",void 0),zg([Fc({type:Number})],qy.prototype,"minLength",void 0),zg([Fc({type:Boolean,attribute:"no-spinner"})],qy.prototype,"noSpinner",void 0),zg([Fc()],qy.prototype,"pattern",void 0),zg([Fc({reflect:!0,converter:{fromAttribute:e=>e??"",toAttribute:e=>e||null}})],qy.prototype,"placeholder",void 0),zg([Fc({type:Boolean,reflect:!0})],qy.prototype,"readOnly",void 0),zg([Fc({type:Boolean,reflect:!0})],qy.prototype,"multiple",void 0),zg([Fc()],qy.prototype,"step",void 0),zg([Fc({reflect:!0})],qy.prototype,"type",void 0),zg([Fc({reflect:!0})],qy.prototype,"autocomplete",void 0),zg([Uc()],qy.prototype,"dirty",void 0),zg([Uc()],qy.prototype,"focused",void 0),zg([Uc()],qy.prototype,"nativeError",void 0),zg([Uc()],qy.prototype,"nativeErrorText",void 0),zg([Hc(".input")],qy.prototype,"inputOrTextarea",void 0),zg([Hc(".field")],qy.prototype,"field",void 0),zg([Vc({slot:"leading-icon"})],qy.prototype,"leadingIcons",void 0),zg([Vc({slot:"trailing-icon"})],qy.prototype,"trailingIcons",void 0);class Ky extends qy{constructor(){super(...arguments),this.fieldTag=Db`md-outlined-field`}}const Yy=Sd`:host{display:inline-flex;outline:none;resize:both;text-align:start;-webkit-tap-highlight-color:rgba(0,0,0,0)}.text-field,.field{width:100%}.text-field{display:inline-flex}.field{cursor:text}.disabled .field{cursor:default}.text-field,.textarea .field{resize:inherit}slot[name=container]{border-radius:inherit}.icon{color:currentColor;display:flex;align-items:center;justify-content:center;fill:currentColor;position:relative}.icon ::slotted(*){display:flex;position:absolute}[has-start] .icon.leading{font-size:var(--_leading-icon-size);height:var(--_leading-icon-size);width:var(--_leading-icon-size)}[has-end] .icon.trailing{font-size:var(--_trailing-icon-size);height:var(--_trailing-icon-size);width:var(--_trailing-icon-size)}.input-wrapper{display:flex}.input-wrapper>*{all:inherit;padding:0}.input{caret-color:var(--_caret-color);overflow-x:hidden;text-align:inherit}.input::placeholder{color:currentColor;opacity:1}.input::-webkit-calendar-picker-indicator{display:none}.input::-webkit-search-decoration,.input::-webkit-search-cancel-button{display:none}@media(forced-colors: active){.input{background:none}}.no-spinner .input::-webkit-inner-spin-button,.no-spinner .input::-webkit-outer-spin-button{display:none}.no-spinner .input[type=number]{-moz-appearance:textfield}:focus-within .input{caret-color:var(--_focus-caret-color)}.error:focus-within .input{caret-color:var(--_error-focus-caret-color)}.text-field:not(.disabled) .prefix{color:var(--_input-text-prefix-color)}.text-field:not(.disabled) .suffix{color:var(--_input-text-suffix-color)}.text-field:not(.disabled) .input::placeholder{color:var(--_input-text-placeholder-color)}.prefix,.suffix{text-wrap:nowrap;width:min-content}.prefix{padding-inline-end:var(--_input-text-prefix-trailing-space)}.suffix{padding-inline-start:var(--_input-text-suffix-leading-space)}
`;let Xy=class extends Ky{constructor(){super(...arguments),this.fieldTag=Db`md-outlined-field`}};Xy.styles=[Yy,Ey],Xy=zg([Dc("md-outlined-text-field")],Xy);const Jy=Sd`
  md-switch {
    --md-sys-color-surface-container-highest: var(
      --switch-color-surface-container-highest
    );
    --md-sys-color-on-surface: var(--switch-color-on-surface);
    --md-sys-color-on-surface-variant: var(--switch-color-on-surface-variant);
    --md-sys-color-outline: var(--switch-color-outline);
    --md-sys-color-primary: var(--switch-color-primary);
    --md-sys-color-on-primary: var(--switch-color-on-primary);
    --md-sys-color-primary-container: var(--switch-color-primary-container);
    --md-switch-disabled-track-color: var(--switch-disabled-track-color);
    --md-focus-ring-duration: 0s;
    --md-switch-handle-height: 12px;
    --md-switch-handle-width: 12px;
    --md-switch-selected-handle-height: 12px;
    --md-switch-selected-handle-width: 12px;
    --md-switch-pressed-handle-height: 12px;
    --md-switch-pressed-handle-width: 12px;
    --md-switch-track-height: 16px;
    --md-switch-track-outline-width: 0;
    --md-switch-track-width: 32px;
    --md-switch-state-layer-size: 32px;
    padding-right: 0.5em;
  }

  md-tabs {
    font-size: var(--font-size-h3);
    font-weight: var(--font-weight-h3);
    line-height: var(--line-height-h3);
    --md-sys-typescale-title-small-font: var(--header-font-family);
    --md-sys-typescale-title-small-size: var(--font-size-h3);
    --md-sys-typescale-title-small-line-height: var(--line-height-h3);
    --md-sys-color-on-surface: var(--tabs-color-on-surface);
    --md-secondary-tab-active-hover-state-layer-color: var(
      --deemphasized-text-color
    );
    --md-sys-color-on-surface-variant: var(--deemphasized-text-color);
    --md-sys-color-primary: var(--link-color);
    --md-sys-color-surface: transparent;
  }
  md-tabs::part(divider) {
    display: none;
  }

  md-outlined-text-field {
    background-color: var(--view-background-color);
    color: var(--primary-text-color);
    --md-sys-color-primary: var(--primary-text-color);
    --md-sys-color-on-surface: var(--primary-text-color);
    --md-sys-color-on-surface-variant: var(--deemphasized-text-color);
    --md-outlined-text-field-label-text-color: var(--deemphasized-text-color);
    --md-outlined-text-field-focus-label-text-color: var(
      --deemphasized-text-color
    );
    --md-outlined-text-field-hover-label-text-color: var(
      --deemphasized-text-color
    );
    border-radius: var(--border-radius);
    --md-outlined-text-field-container-shape: var(--border-radius);
    --md-outlined-text-field-focus-outline-color: var(
      --prominent-border-color,
      var(--border-color)
    );
    --md-outlined-text-field-outline-color: var(
      --prominent-border-color,
      var(--border-color)
    );
    --md-outlined-text-field-hover-outline-color: var(
      --prominent-border-color,
      var(--border-color)
    );
    --md-sys-color-outline: var(--prominent-border-color, var(--border-color));
    --md-outlined-field-top-space: var(--spacing-s);
    --md-outlined-field-bottom-space: var(--spacing-s);
    --md-outlined-text-field-outline-width: 1px;
    --md-outlined-text-field-hover-outline-width: 1px;
    --md-outlined-text-field-focus-outline-width: 0;
    --md-outlined-field-leading-space: 8px;
  }

  md-outlined-text-field.showBlueFocusBorder {
    --md-outlined-text-field-focus-outline-width: 2px;
    --md-outlined-text-field-focus-outline-color: var(
      --input-focus-border-color
    );
  }

  /* These colours come from paper-checkbox */
  md-checkbox {
    background-color: var(--background-color-primary);
    --md-sys-color-primary: var(--checkbox-primary);
    --md-sys-color-on-primary: var(--checkbox-on-primary);
    --md-sys-color-on-surface: var(--checkbox-on-surface);
    --md-sys-color-on-surface-variant: var(--checkbox-on-surface-variant);
    --md-checkbox-container-shape: 0px;
  }

  md-radio {
    --md-sys-color-primary: var(--radio-primary);
    --md-sys-color-on-primary: var(--radio-on-primary);
    --md-sys-color-on-surface: var(--radio-on-surface);
    --md-sys-color-on-surface-variant: var(--radio-on-surface-variant);
  }

  md-outlined-select {
    min-width: unset;
    --md-outlined-field-top-space: 4px;
    --md-outlined-field-bottom-space: 4px;
    --md-sys-color-surface-container: var(--select-surface-container);
    --md-sys-color-on-secondary-container: var(--select-on-secondary-container);
    --md-sys-color-secondary-container: var(--select-secondary-container);
    --md-sys-color-primary: var(--select-primary);
    --md-sys-color-on-surface: var(--select-on-surface);
  }
`,Qy=document.createElement("template");Qy.innerHTML=`<dom-module id="gr-material-styles">\n  <template>\n    <style>\n    ${Jy.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(Qy.content);var Zy=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let ew=class extends Ic{constructor(){super(...arguments),this.itemsPerPage=25,this.offset=0,this.getNavigation=yu(this,gy)}disconnectedCallback(){this.reloadTask?.cancel(),super.disconnectedCallback()}static get styles(){return[Jy,vy,Nc,Sd`
        #topContainer {
          align-items: center;
          display: flex;
          height: 3rem;
          justify-content: space-between;
          margin: 0 var(--spacing-l);
        }
        .filterContainer {
          display: flex;
          align-items: center;
          gap: 4px;
        }
        .filterContainer label {
          margin-bottom: 3px;
        }
        a {
          color: var(--primary-text-color);
          text-decoration: none;
        }
        a:hover {
          text-decoration: underline;
        }
        nav {
          align-items: center;
          display: flex;
          height: 3rem;
          justify-content: flex-end;
          margin-right: 20px;
          color: var(--deemphasized-text-color);
        }
        gr-icon {
          font-size: 1.85rem;
          margin-left: 16px;
        }
        md-outlined-text-field {
          max-width: 25em;
        }
      `]}render(){return dc`
      <div id="topContainer">
        <div class="filterContainer">
          <label>Filter:</label>
          <md-outlined-text-field
            .value=${this.filter??""}
            @input=${e=>{const t=e.target;this.filter=t.value}}
          >
          </md-outlined-text-field>
        </div>
        <div id="createNewContainer">
          <gr-button
            id="createNew"
            ?hidden=${!this.createNew}
            primary
            link
            @click=${()=>this.createNewItem()}
          >
            Create New
          </gr-button>
          <slot name="createNewContainer"></slot>
        </div>
      </div>
      <slot></slot>
      <nav>
        Page ${this.computePage()}
        <a
          id="prevArrow"
          href=${this.computeNavLink(-1)}
          ?hidden=${this.loading||0===this.offset}
        >
          <gr-icon icon="chevron_left"></gr-icon>
        </a>
        <a
          id="nextArrow"
          href=${this.computeNavLink(1)}
          ?hidden=${this.hideNextArrow()}
        >
          <gr-icon icon="chevron_right"></gr-icon>
        </a>
      </nav>
    `}willUpdate(e){e.has("filter")&&this.filterChanged(this.filter,e.get("filter"))}filterChanged(e,t){(e||t)&&this.debounceReload(e)}debounceReload(e){this.reloadTask=ny(this.reloadTask,(()=>{this.isConnected&&this.path&&(e?this.getNavigation().setUrl(`${this.path}/q/filter:${Rf(e)}`):this.getNavigation().setUrl(this.path))}),200)}createNewItem(){Jn(this,"create-clicked",{})}computeNavLink(e){const t=+(this.offset||0),i=Math.max(0,t+this.itemsPerPage*e);let r=this.path||Sf();return this.filter&&(r+="/q/filter:"+Rf(this.filter)),i>0&&(r+=`,${i}`),r}hideNextArrow(){return!(!this.loading&&this.items?.length)||this.items.length<this.itemsPerPage+1}computePage(){return this.offset/this.itemsPerPage+1}};var tw;function iw(e){let t=`/admin/groups/${Rf(`${e.groupId}`)}`;return e.detail===tw.MEMBERS?t+=",members":e.detail===tw.LOG&&(t+=",audit-log"),Sf()+t}Zy([Fc({type:Boolean})],ew.prototype,"createNew",void 0),Zy([Fc({type:Array})],ew.prototype,"items",void 0),Zy([Fc({type:Number})],ew.prototype,"itemsPerPage",void 0),Zy([Fc({type:String})],ew.prototype,"filter",void 0),Zy([Fc({type:Number})],ew.prototype,"offset",void 0),Zy([Fc({type:Boolean})],ew.prototype,"loading",void 0),Zy([Fc({type:String})],ew.prototype,"path",void 0),ew=Zy([Dc("gr-list-view")],ew),function(e){e.MEMBERS="members",e.LOG="log"}(tw||(tw={}));const rw=mu("group-view-model");class ow extends df{constructor(){super(void 0)}}class sw extends Gy{computeValidity(e){return this.checkboxControl||(this.checkboxControl=document.createElement("input"),this.checkboxControl.type="checkbox"),this.checkboxControl.checked=e.checked,this.checkboxControl.required=e.required,{validity:this.checkboxControl.validity,validationMessage:this.checkboxControl.validationMessage}}equals(e,t){return e.checked===t.checked&&e.required===t.required}copy({checked:e,required:t}){return{checked:e,required:t}}}const nw=fm(Py(Dy(_m(Ic))));class aw extends nw{constructor(){super(),this.checked=!1,this.indeterminate=!1,this.required=!1,this.value="on",this.prevChecked=!1,this.prevDisabled=!1,this.prevIndeterminate=!1,this.addEventListener("click",(e=>{Em(e)&&this.input&&(this.focus(),Cm(this.input))}))}update(e){(e.has("checked")||e.has("disabled")||e.has("indeterminate"))&&(this.prevChecked=e.get("checked")??this.checked,this.prevDisabled=e.get("disabled")??this.disabled,this.prevIndeterminate=e.get("indeterminate")??this.indeterminate),super.update(e)}render(){const e=!this.prevChecked&&!this.prevIndeterminate,t=this.prevChecked&&!this.prevIndeterminate,i=this.prevIndeterminate,r=this.checked&&!this.indeterminate,o=this.indeterminate,s=th({disabled:this.disabled,selected:r||o,unselected:!r&&!o,checked:r,indeterminate:o,"prev-unselected":e,"prev-checked":t,"prev-indeterminate":i,"prev-disabled":this.prevDisabled}),{ariaLabel:n,ariaInvalid:a}=this;return dc`
      <div class="container ${s}">
        <input
          type="checkbox"
          id="input"
          aria-checked=${o?"mixed":uc}
          aria-label=${n||uc}
          aria-invalid=${a||uc}
          ?disabled=${this.disabled}
          ?required=${this.required}
          .indeterminate=${this.indeterminate}
          .checked=${this.checked}
          @input=${this.handleInput}
          @change=${this.handleChange} />

        <div class="outline"></div>
        <div class="background"></div>
        <md-focus-ring part="focus-ring" for="input"></md-focus-ring>
        <md-ripple for="input" ?disabled=${this.disabled}></md-ripple>
        <svg class="icon" viewBox="0 0 18 18" aria-hidden="true">
          <rect class="mark short" />
          <rect class="mark long" />
        </svg>
      </div>
    `}handleInput(e){const t=e.target;this.checked=t.checked,this.indeterminate=t.indeterminate}handleChange(e){$y(this,e)}[Ny](){return!this.checked||this.indeterminate?null:this.value}[Oy](){return String(this.checked)}formResetCallback(){this.checked=this.hasAttribute("checked")}formStateRestoreCallback(e){this.checked="true"===e}[ky](){return new sw((()=>this))}[Ay](){return this.input}}aw.shadowRootOptions={...Ic.shadowRootOptions,delegatesFocus:!0},zg([Fc({type:Boolean})],aw.prototype,"checked",void 0),zg([Fc({type:Boolean})],aw.prototype,"indeterminate",void 0),zg([Fc({type:Boolean})],aw.prototype,"required",void 0),zg([Fc()],aw.prototype,"value",void 0),zg([Uc()],aw.prototype,"prevChecked",void 0),zg([Uc()],aw.prototype,"prevDisabled",void 0),zg([Uc()],aw.prototype,"prevIndeterminate",void 0),zg([Hc("input")],aw.prototype,"input",void 0);const lw=Sd`:host{border-start-start-radius:var(--md-checkbox-container-shape-start-start, var(--md-checkbox-container-shape, 2px));border-start-end-radius:var(--md-checkbox-container-shape-start-end, var(--md-checkbox-container-shape, 2px));border-end-end-radius:var(--md-checkbox-container-shape-end-end, var(--md-checkbox-container-shape, 2px));border-end-start-radius:var(--md-checkbox-container-shape-end-start, var(--md-checkbox-container-shape, 2px));display:inline-flex;height:var(--md-checkbox-container-size, 18px);position:relative;vertical-align:top;width:var(--md-checkbox-container-size, 18px);-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer}:host([disabled]){cursor:default}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--md-checkbox-container-size, 18px))/2)}md-focus-ring{height:44px;inset:unset;width:44px}input{appearance:none;height:48px;margin:0;opacity:0;outline:none;position:absolute;width:48px;z-index:1;cursor:inherit}:host([touch-target=none]) input{height:100%;width:100%}.container{border-radius:inherit;display:flex;height:100%;place-content:center;place-items:center;position:relative;width:100%}.outline,.background,.icon{inset:0;position:absolute}.outline,.background{border-radius:inherit}.outline{border-color:var(--md-checkbox-outline-color, var(--md-sys-color-on-surface-variant, #49454f));border-style:solid;border-width:var(--md-checkbox-outline-width, 2px);box-sizing:border-box}.background{background-color:var(--md-checkbox-selected-container-color, var(--md-sys-color-primary, #6750a4))}.background,.icon{opacity:0;transition-duration:150ms,50ms;transition-property:transform,opacity;transition-timing-function:cubic-bezier(0.3, 0, 0.8, 0.15),linear;transform:scale(0.6)}:where(.selected) :is(.background,.icon){opacity:1;transition-duration:350ms,50ms;transition-timing-function:cubic-bezier(0.05, 0.7, 0.1, 1),linear;transform:scale(1)}md-ripple{border-radius:var(--md-checkbox-state-layer-shape, var(--md-sys-shape-corner-full, 9999px));height:var(--md-checkbox-state-layer-size, 40px);inset:unset;width:var(--md-checkbox-state-layer-size, 40px);--md-ripple-hover-color: var(--md-checkbox-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-checkbox-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-checkbox-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-pressed-opacity: var(--md-checkbox-pressed-state-layer-opacity, 0.12)}.selected md-ripple{--md-ripple-hover-color: var(--md-checkbox-selected-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-hover-opacity: var(--md-checkbox-selected-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-checkbox-selected-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-opacity: var(--md-checkbox-selected-pressed-state-layer-opacity, 0.12)}.icon{fill:var(--md-checkbox-selected-icon-color, var(--md-sys-color-on-primary, #fff));height:var(--md-checkbox-icon-size, 18px);width:var(--md-checkbox-icon-size, 18px)}.mark.short{height:2px;transition-property:transform,height;width:2px}.mark.long{height:2px;transition-property:transform,width;width:10px}.mark{animation-duration:150ms;animation-timing-function:cubic-bezier(0.3, 0, 0.8, 0.15);transition-duration:150ms;transition-timing-function:cubic-bezier(0.3, 0, 0.8, 0.15)}.selected .mark{animation-duration:350ms;animation-timing-function:cubic-bezier(0.05, 0.7, 0.1, 1);transition-duration:350ms;transition-timing-function:cubic-bezier(0.05, 0.7, 0.1, 1)}.checked .mark,.prev-checked.unselected .mark{transform:scaleY(-1) translate(7px, -14px) rotate(45deg)}.checked .mark.short,.prev-checked.unselected .mark.short{height:5.6568542495px}.checked .mark.long,.prev-checked.unselected .mark.long{width:11.313708499px}.indeterminate .mark,.prev-indeterminate.unselected .mark{transform:scaleY(-1) translate(4px, -10px) rotate(0deg)}.prev-unselected .mark{transition-property:none}.prev-unselected.checked .mark.long{animation-name:prev-unselected-to-checked}@keyframes prev-unselected-to-checked{from{width:0}}:where(:hover) .outline{border-color:var(--md-checkbox-hover-outline-color, var(--md-sys-color-on-surface, #1d1b20));border-width:var(--md-checkbox-hover-outline-width, 2px)}:where(:hover) .background{background:var(--md-checkbox-selected-hover-container-color, var(--md-sys-color-primary, #6750a4))}:where(:hover) .icon{fill:var(--md-checkbox-selected-hover-icon-color, var(--md-sys-color-on-primary, #fff))}:where(:focus-within) .outline{border-color:var(--md-checkbox-focus-outline-color, var(--md-sys-color-on-surface, #1d1b20));border-width:var(--md-checkbox-focus-outline-width, 2px)}:where(:focus-within) .background{background:var(--md-checkbox-selected-focus-container-color, var(--md-sys-color-primary, #6750a4))}:where(:focus-within) .icon{fill:var(--md-checkbox-selected-focus-icon-color, var(--md-sys-color-on-primary, #fff))}:where(:active) .outline{border-color:var(--md-checkbox-pressed-outline-color, var(--md-sys-color-on-surface, #1d1b20));border-width:var(--md-checkbox-pressed-outline-width, 2px)}:where(:active) .background{background:var(--md-checkbox-selected-pressed-container-color, var(--md-sys-color-primary, #6750a4))}:where(:active) .icon{fill:var(--md-checkbox-selected-pressed-icon-color, var(--md-sys-color-on-primary, #fff))}:where(.disabled,.prev-disabled) :is(.background,.icon,.mark){animation-duration:0s;transition-duration:0s}:where(.disabled) .outline{border-color:var(--md-checkbox-disabled-outline-color, var(--md-sys-color-on-surface, #1d1b20));border-width:var(--md-checkbox-disabled-outline-width, 2px);opacity:var(--md-checkbox-disabled-container-opacity, 0.38)}:where(.selected.disabled) .outline{visibility:hidden}:where(.selected.disabled) .background{background:var(--md-checkbox-selected-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-checkbox-selected-disabled-container-opacity, 0.38)}:where(.disabled) .icon{fill:var(--md-checkbox-selected-disabled-icon-color, var(--md-sys-color-surface, #fef7ff))}@media(forced-colors: active){.background{background-color:CanvasText}.selected.disabled .background{background-color:GrayText;opacity:1}.outline{border-color:CanvasText}.disabled .outline{border-color:GrayText;opacity:1}.icon{fill:Canvas}}
`;let dw=class extends aw{};dw.styles=[lw],dw=zg([Dc("md-checkbox")],dw);var cw=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let hw=class extends Ic{constructor(){super(...arguments),this.name="",this.visibleToAll=!1,this.restApiService=Xn().restApiService,this.getNavigation=yu(this,gy)}static get styles(){return[Jy,my,Nc,Sd`
        :host {
          display: inline-block;
        }
        div.title-flex,
        div.value-flex {
          display: flex;
          flex-direction: column;
          justify-content: center;
        }
        div.gr-form-styles section {
          margin: var(--spacing-m) 0;
        }
        div.gr-form-styles span.title {
          width: 13em;
        }
        md-outlined-text-field {
          width: 20em;
        }
      `]}render(){return dc`
      <div class="gr-form-styles">
        <div id="form">
          <section>
            <div class="title-flex">
              <span class="title">Group name</span>
            </div>
            <div class="value-flex">
              <span class="value">
                <md-outlined-text-field
                  class="showBlueFocusBorder"
                  .value=${this.name??""}
                  @input=${e=>{const t=e.target;this.name=t.value}}
                >
                </md-outlined-text-field>
              </span>
            </div>
          </section>
          <section>
            <div class="title-flex">
              <span class="title">
                Make group visible to all registered users
              </span>
            </div>
            <div class="value-flex">
              <span class="value">
                <md-checkbox
                  ?checked=${this.visibleToAll}
                  @change=${()=>{this.visibleToAll=!this.visibleToAll}}
                ></md-checkbox>
              </span>
            </div>
          </section>
        </div>
      </div>
    `}updated(e){e.has("name")&&this.updateGroupName()}updateGroupName(){Jn(this,"has-new-group-name",{})}focus(){this.input.focus()}handleCreateGroup(){const e=this.name,t=this.visibleToAll;return this.restApiService.createGroup({name:e,visible_to_all:t}).then((t=>{if(201===t.status)return this.restApiService.getGroupConfig(e).then((e=>{e&&this.getNavigation().setUrl(iw({groupId:e.id}))}))}))}};cw([Hc("md-outlined-text-field")],hw.prototype,"input",void 0),cw([Fc({type:String})],hw.prototype,"name",void 0),cw([Uc()],hw.prototype,"visibleToAll",void 0),hw=cw([Dc("gr-create-group-dialog")],hw);const pw=Sd`
  .genericList {
    background-color: var(--background-color-primary);
    border-collapse: collapse;
    width: 100%;
  }
  .genericList th,
  .genericList td {
    padding: var(--spacing-m) 0;
    vertical-align: middle;
  }
  .genericList tr {
    border-bottom: 1px solid var(--border-color);
  }
  .genericList tr:hover {
    background-color: var(--hover-background-color);
  }
  .genericList th {
    white-space: nowrap;
  }
  .genericList th,
  .genericList td {
    padding-right: var(--spacing-l);
  }
  .genericList tr th:first-of-type,
  .genericList tr td:first-of-type {
    padding-left: var(--spacing-l);
  }
  .genericList tr:first-of-type {
    border-top: 1px solid var(--border-color);
  }
  .genericList tr th:last-of-type,
  .genericList tr td:last-of-type {
    border-left: 1px solid var(--border-color);
    text-align: center;
    padding-left: var(--spacing-l);
  }
  .genericList tr th.delete,
  .genericList tr td.delete {
    padding-top: 0;
    padding-bottom: 0;
  }
  .genericList tr th.delete,
  .genericList tr td.delete,
  .genericList tr.loadingMsg td,
  .genericList tr.groupHeader td {
    border-left: none;
  }
  .genericList .loading {
    border: none;
    display: none;
  }
  .genericList td {
    flex-shrink: 0;
  }
  .genericList .topHeader,
  .genericList .groupHeader {
    color: var(--primary-text-color);
    font-weight: var(--font-weight-medium);
    text-align: left;
    vertical-align: middle;
  }
  .genericList .groupHeader {
    background-color: var(--background-color-secondary);
    font-family: var(--header-font-family);
    font-size: var(--font-size-h3);
    font-weight: var(--font-weight-h3);
    line-height: var(--line-height-h3);
  }
  .genericList a {
    color: var(--primary-text-color);
    text-decoration: none;
  }
  .genericList a:hover {
    text-decoration: underline;
  }
  .genericList .description {
    width: var(--generic-list-description-width, 99%);
  }
  .genericList .loadingMsg {
    color: var(--deemphasized-text-color);
    display: block;
    padding: var(--spacing-s) var(--spacing-l);
  }
  .genericList .loadingMsg:not(.loading) {
    display: none;
  }
`,uw=document.createElement("template");var gw;uw.innerHTML=`\n  <dom-module id="gr-table-styles">\n    <template>\n      <style>\n      ${pw.cssText}\n      </style>\n    </template>\n  </dom-module>\n`,document.head.appendChild(uw.content),function(e){e.ADMIN="admin",e.AGREEMENTS="agreements",e.CHANGE="change",e.DASHBOARD="dashboard",e.DOCUMENTATION_SEARCH="documentation-search",e.GROUP="group",e.PLUGIN_SCREEN="plugin-screen",e.REPO="repo",e.SEARCH="search",e.SERVER_INFO="server-info",e.SETTINGS="settings"}(gw||(gw={}));const mw=mu("router-model");class fw extends df{constructor(e){super({}),this.pluginLoader=e,this.routerView$=lf(this.state$,(e=>e.view)),this.subscriptions=[this.routerView$.subscribe((e=>{this.pluginLoader.jsApiService.handleViewChange(e)}))]}}var vw;function bw(e){let t=`/admin/repos/${Rf(`${e.repo}`)}`;return e.detail===vw.GENERAL?t+=",general":e.detail===vw.ACCESS?t+=",access":e.detail===vw.BRANCHES?t+=",branches":e.detail===vw.TAGS?t+=",tags":e.detail===vw.COMMANDS?t+=",commands":e.detail===vw.DASHBOARDS?t+=",dashboards":e.detail===vw.SUBMIT_REQUIREMENTS?t+=",submit-requirements":e.detail===vw.LABELS&&(t+=",labels"),Sf()+t}!function(e){e.GENERAL="general",e.ACCESS="access",e.BRANCHES="branches",e.COMMANDS="commands",e.DASHBOARDS="dashboards",e.TAGS="tags",e.SUBMIT_REQUIREMENTS="submit-requirements",e.LABELS="labels"}(vw||(vw={}));const yw=mu("repo-view-model");class ww extends df{constructor(){super(void 0)}}const _w={urlPattern:/^\/admin\/plugins(\/)?$/,createState:()=>({view:gw.ADMIN,adminView:Cw.PLUGINS})},xw={urlPattern:/^\/admin\/server-info$/,createState:()=>({view:gw.ADMIN,adminView:Cw.SERVER_INFO})};var Cw;!function(e){e.REPOS="gr-repo-list",e.GROUPS="gr-admin-group-list",e.PLUGINS="gr-plugin-list",e.SERVER_INFO="gr-server-info"}(Cw||(Cw={}));const Ew=[{name:"Repositories",url:Aw({adminView:Cw.REPOS}),view:"gr-repo-list",viewableToAll:!0},{name:"Groups",section:"Groups",url:Aw({adminView:Cw.GROUPS}),view:"gr-admin-group-list"},{name:"Plugins",capability:"viewPlugins",section:"Plugins",url:Aw({adminView:Cw.PLUGINS}),view:"gr-plugin-list"},{name:"Server Info",section:"Server Info",url:Aw({adminView:Cw.SERVER_INFO}),view:"gr-server-info"}];function Sw(e,t,i,r){return e?t().then((e=>$w((t=>!t.capability||ma(e,t.capability)),i,r))):Promise.resolve($w((e=>!!e.viewableToAll),i,r))}function $w(e,t,i){let r,o=Ew.slice(0);const s=e=>"/"!==e.url[0];o.push(...t().map((e=>({url:e.url,name:e.text,capability:e.capability||void 0,view:void 0,viewableToAll:!e.capability,target:s(e)?"_blank":null})))),o=o.filter(e);const n=[],a=i&&i.repoName,l=i&&i.groupId,d=i&&i.groupName,c=i&&i.groupIsInternal,h=i&&i.isAdmin,p=i&&i.groupOwner;if(!a&&!l)return{links:o,expandedSection:r};for(const e of o){const t={...e};"Repositories"===t.name&&a?(t.subsection={name:u=a,view:gw.REPO,children:[{name:"General",view:gw.REPO,detailType:vw.GENERAL,url:bw({repo:u,detail:vw.GENERAL})},{name:"Access",view:gw.REPO,detailType:vw.ACCESS,url:bw({repo:u,detail:vw.ACCESS})},{name:"Commands",view:gw.REPO,detailType:vw.COMMANDS,url:bw({repo:u,detail:vw.COMMANDS})},{name:"Branches",view:gw.REPO,detailType:vw.BRANCHES,url:bw({repo:u,detail:vw.BRANCHES})},{name:"Tags",view:gw.REPO,detailType:vw.TAGS,url:bw({repo:u,detail:vw.TAGS})},{name:"Dashboards",view:gw.REPO,detailType:vw.DASHBOARDS,url:bw({repo:u,detail:vw.DASHBOARDS})},{name:"Submit Requirements",view:gw.REPO,detailType:vw.SUBMIT_REQUIREMENTS,url:bw({repo:u,detail:vw.SUBMIT_REQUIREMENTS})},{name:"Labels",view:gw.REPO,detailType:vw.LABELS,url:bw({repo:u,detail:vw.LABELS})}]},r=t.subsection):"Groups"===t.name&&l&&d&&(t.subsection=kw(l,d,c,h,p),r=t.subsection),n.push(t)}var u;return{links:n,expandedSection:r}}function kw(e,t,i,r,o){const s=[],n={name:t,view:gw.GROUP,url:iw({groupId:e}),children:s};return i&&s.push({name:"Members",detailType:tw.MEMBERS,view:gw.GROUP,url:iw({groupId:e,detail:tw.MEMBERS})}),i&&(r||o)&&s.push({name:"Audit Log",detailType:tw.LOG,view:gw.GROUP,url:iw({groupId:e,detail:tw.LOG})}),n}function Aw(e){switch(e.adminView){case Cw.REPOS:return`${Sf()}/admin/repos`;case Cw.GROUPS:return`${Sf()}/admin/groups`;case Cw.PLUGINS:return`${Sf()}/admin/plugins`;case Cw.SERVER_INFO:return`${Sf()}/admin/server-info`}}const Rw=mu("admin-view-model");class Tw extends df{constructor(){super(void 0)}}const Iw=Sd`
  dialog {
    padding: 0;
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    background: var(--dialog-background-color);
    box-shadow: var(--elevation-level-5);
    /*
     * These styles are taken from main.css
     * Dialog exists in the top-layer outside the body hence the styles
     * in main.css were not being applied.
     */
    font-family: var(--font-family, ''), 'Roboto', Arial, sans-serif;
    font-size: var(--font-size-normal, 1rem);
    line-height: var(--line-height-normal, 1.4);
    color: var(--primary-text-color, black);
  }

  dialog::backdrop {
    background-color: black;
    opacity: var(--modal-opacity, 0.6);
  }
`,Pw=document.createElement("template");Pw.innerHTML=`<dom-module id="gr-modal-styles">\n  <template>\n    <style>\n      ${Iw.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(Pw.content);var Nw=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let Ow=class extends Ic{constructor(){super(...arguments),this.offset=0,this.hasNewGroupName=!1,this.createNewCapability=!1,this.groups=[],this.groupsPerPage=25,this.loading=!0,this.filter="",this.restApiService=Xn().restApiService}connectedCallback(){super.connectedCallback(),this.getCreateGroupCapability(),oa("Groups")}static get styles(){return[pw,Nc,Iw,Sd`
        gr-list-view {
          --generic-list-description-width: 70%;
        }
      `]}render(){return dc`
      <gr-list-view
        .createNew=${this.createNewCapability}
        .filter=${this.filter}
        .items=${this.groups}
        .itemsPerPage=${this.groupsPerPage}
        .loading=${this.loading}
        .offset=${this.offset}
        .path=${Aw({adminView:Cw.GROUPS})}
        @create-clicked=${()=>this.handleCreateClicked()}
      >
        <table id="list" class="genericList">
          <tbody>
            <tr class="headerRow">
              <th class="name topHeader">Group Name</th>
              <th class="description topHeader">Group Description</th>
              <th class="visibleToAll topHeader">Visible To All</th>
            </tr>
            <tr
              id="loading"
              class="loadingMsg ${this.loading?"loading":""}"
            >
              <td>Loading...</td>
            </tr>
          </tbody>
          <tbody class=${this.loading?"loading":""}>
            ${this.groups.slice(0,this.groupsPerPage).map((e=>this.renderGroupList(e)))}
          </tbody>
        </table>
      </gr-list-view>
      <dialog id="createModal" tabindex="-1">
        <gr-dialog
          id="createDialog"
          class="confirmDialog"
          ?disabled=${!this.hasNewGroupName}
          confirm-label="Create"
          confirm-on-enter
          @confirm=${()=>this.handleCreateGroup()}
          @cancel=${()=>this.handleCloseCreate()}
        >
          <div class="header" slot="header">Create Group</div>
          <div class="main" slot="main">
            <gr-create-group-dialog
              id="createNewModal"
              @has-new-group-name=${this.handleHasNewGroupName}
            ></gr-create-group-dialog>
          </div>
        </gr-dialog>
      </dialog>
    `}renderGroupList(e){return dc`
      <tr class="table">
        <td class="name">
          <a href=${this.computeGroupUrl(e.id)}>${e.name}</a>
        </td>
        <td class="description">${e.description}</td>
        <td class="visibleToAll">
          ${!0===e.options?.visible_to_all?"Y":"N"}
        </td>
      </tr>
    `}willUpdate(e){e.has("params")&&this.paramsChanged()}paramsChanged(){return this.filter=this.params?.filter??"",this.offset=Number(this.params?.offset??0),this.maybeOpenCreateModal(this.params),this.getGroups(this.filter,this.groupsPerPage,this.offset)}async maybeOpenCreateModal(e){e?.openCreateModal&&(await this.updateComplete,this.createModal?.open||this.createModal?.showModal())}computeGroupUrl(e){return iw({groupId:decodeURIComponent(e)})}getCreateGroupCapability(){return this.restApiService.getAccount().then((e=>{if(e)return this.restApiService.getAccountCapabilities(["createGroup"]).then((e=>{e?.createGroup&&(this.createNewCapability=!0)}))}))}getGroups(e,t,i){return this.groups=[],this.loading=!0,this.restApiService.getGroups(e,t,i).then((e=>{e&&(this.groups=Object.keys(e).map((t=>{const i=e[t];return i.name=t,i})))})).finally((()=>{this.loading=!1}))}refreshGroupsList(){return this.restApiService.invalidateGroupsCache(),this.getGroups(this.filter,this.groupsPerPage,this.offset)}handleCreateGroup(){ba(this.createNewModal,"createNewModal"),this.createNewModal.handleCreateGroup().then((()=>{this.refreshGroupsList()}))}handleCloseCreate(){ba(this.createModal,"createModal"),this.createModal.close()}handleCreateClicked(){ba(this.createModal,"createModal"),this.createModal.showModal(),Ln(this.createModal,(()=>{ba(this.createNewModal,"createNewModal"),this.createNewModal.focus()}))}handleHasNewGroupName(){ba(this.createNewModal,"createNewModal"),this.hasNewGroupName=!!this.createNewModal.name}};Nw([Hc("#createModal")],Ow.prototype,"createModal",void 0),Nw([Hc("#createNewModal")],Ow.prototype,"createNewModal",void 0),Nw([Fc({type:Object})],Ow.prototype,"params",void 0),Nw([Uc()],Ow.prototype,"offset",void 0),Nw([Uc()],Ow.prototype,"hasNewGroupName",void 0),Nw([Uc()],Ow.prototype,"createNewCapability",void 0),Nw([Uc()],Ow.prototype,"groups",void 0),Nw([Uc()],Ow.prototype,"groupsPerPage",void 0),Nw([Uc()],Ow.prototype,"loading",void 0),Nw([Uc()],Ow.prototype,"filter",void 0),Ow=Nw([Dc("gr-admin-group-list")],Ow);class Dw{constructor(e){(this.host=e).addController(this)}hostConnected(){this.positionTarget=this.getPositionTarget()}hostDisconnected(){}getPositionTarget(){let e=this.host.parentNode;return e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e}saveOriginalStyles(){this.originalStyles={top:this.host.style.top||"",left:this.host.style.left||"",position:this.host.style.position||"",maxWidth:this.host.style.maxWidth||"",maxHeight:this.host.style.maxHeight||"",boxSizing:this.host.style.boxSizing||""}}resetStyles(){void 0!==this.originalStyles&&Object.assign(this.host.style,this.originalStyles),this.originalStyles=void 0}setPositionTarget(e){this.positionTarget=e}refit(){const e=this.host.scrollLeft,t=this.host.scrollTop;this.resetStyles(),this.position(),this.host.scrollLeft=e,this.host.scrollTop=t}position(){this.saveOriginalStyles(),this.host.style.position="fixed",this.host.style.boxSizing="border-box";const e=this.host.getBoundingClientRect(),t=this.getNormalizedRect(this.positionTarget),i=this.getNormalizedRect(window);this.calculateAndSetPositions(e,t,i)}calculateAndSetPositions(e,t,i){const r=window.getComputedStyle(this.host),o=parseInt(r.minWidth)||0,s=parseInt(r.minHeight)||0,n=parseInt(r.marginTop)||0,a=parseInt(r.marginRight)||0,l=parseInt(r.marginBottom)||0,d=parseInt(r.marginLeft)||0;let c=t.left+this.host.horizontalOffset+d,h=t.top+this.host.verticalOffset+n;const p=Math.min(i.right-a,c+e.width),u=Math.min(i.bottom-l,h+e.height);c=Math.min(c,p-o),h=Math.min(h,u-s),c=Math.max(i.left+d,c),h=Math.max(i.top+n,h);const g=Math.max(p-c,o),m=Math.max(u-h,s);this.host.style.maxWidth=`${g}px`,this.host.style.maxHeight=`${m}px`,this.host.style.left=`${c}px`,this.host.style.top=`${h}px`}getNormalizedRect(e){return e===document.documentElement||e===window?new DOMRect(0,0,window.innerWidth,window.innerHeight):e.getBoundingClientRect()}}const Lw=(e,t,i)=>{const r=new Map;for(let o=t;o<=i;o++)r.set(e[o],o);return r},Mw=Zc(class extends eh{constructor(e){if(super(e),2!==e.type)throw Error("repeat() can only be used in text expressions")}dt(e,t,i){let r;void 0===i?i=t:void 0!==t&&(r=t);const o=[],s=[];let n=0;for(const t of e)o[n]=r?r(t,n):n,s[n]=i(t,n),n++;return{values:s,keys:o}}render(e,t,i){return this.dt(e,t,i).values}update(e,[t,i,r]){const o=zv(e),{values:s,keys:n}=this.dt(t,i,r);if(!Array.isArray(o))return this.ut=n,s;const a=this.ut??=[],l=[];let d,c,h=0,p=o.length-1,u=0,g=s.length-1;for(;h<=p&&u<=g;)if(null===o[h])h++;else if(null===o[p])p--;else if(a[h]===n[u])l[u]=Hv(o[h],s[u]),h++,u++;else if(a[p]===n[g])l[g]=Hv(o[p],s[g]),p--,g--;else if(a[h]===n[g])l[g]=Hv(o[h],s[g]),Bv(e,l[g+1],o[h]),h++,g--;else if(a[p]===n[u])l[u]=Hv(o[p],s[u]),Bv(e,o[h],o[p]),p--,u++;else if(void 0===d&&(d=Lw(n,u,g),c=Lw(a,h,p)),d.has(a[h]))if(d.has(a[p])){const t=c.get(n[u]),i=void 0!==t?o[t]:null;if(null===i){const t=Bv(e,o[h]);Hv(t,s[u]),l[u]=t}else l[u]=Hv(i,s[u]),Bv(e,o[h],i),o[t]=null;u++}else Vv(o[p]),p--;else Vv(o[h]),h++;for(;u<=g;){const t=Bv(e,l[g+1]);Hv(t,s[u]),l[u++]=t}for(;h<=p;){const e=o[h++];null!==e&&Vv(e)}return this.ut=n,Gv(e,l),pc}});var Fw,Uw=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e.LOADING="loading",e.ERROR="error"}(Fw||(Fw={}));let Bw=class extends Ic{static get styles(){return[Nc,Sd`
        :host {
          z-index: 100;
          box-shadow: var(--elevation-level-2);
          overflow: auto;
          background: var(--dropdown-background-color);
          border-radius: var(--border-radius);
          max-height: 50vh;
        }
        :host([is-hidden]) {
          display: none;
        }
        ul {
          list-style: none;
        }
        li {
          border-bottom: 1px solid var(--border-color);
          cursor: pointer;
          display: flex;
          justify-content: space-between;
          padding: var(--spacing-m) var(--spacing-l);
        }
        li:last-of-type {
          border: none;
        }
        li:focus {
          outline: none;
        }
        li:hover {
          background-color: var(--hover-background-color);
        }
        li.selected {
          background-color: var(--hover-background-color);
        }
        li.query-status {
          background-color: var(--disabled-background);
          cursor: default;
        }
        li.query-status.error {
          color: var(--error-foreground);
          white-space: pre-wrap;
        }
        @media only screen and (max-height: 35em) {
          .dropdown-content {
            max-height: 80vh;
          }
        }
        .label {
          color: var(--deemphasized-text-color);
          padding-left: var(--spacing-l);
        }
        .hide {
          display: none;
        }
      `]}isSuggestionListInteractible(){return!this.isHidden&&!this.queryStatus}constructor(){super(),this.index=null,this.isHidden=!0,this.verticalOffset=0,this.horizontalOffset=0,this.suggestions=[],this.shortcuts=new Gg(this),this.cursor=new qb,this.fitController=new Dw(this),this.onWindowResize=()=>{this.fitController?.refit()},this.cursor.cursorTargetClass="selected",this.cursor.focusOnMove=!0,this.shortcuts.addLocal({key:Mn.UP,allowRepeat:!0},(()=>this.cursorUp())),this.shortcuts.addLocal({key:Mn.DOWN,allowRepeat:!0},(()=>this.cursorDown())),this.shortcuts.addLocal({key:Mn.ENTER},(()=>this.handleEnter())),this.shortcuts.addLocal({key:Mn.ESC},(()=>this.handleEscape())),this.shortcuts.addLocal({key:Mn.TAB},(()=>this.handleTab()))}disconnectedCallback(){this.cursor.unsetCursor(),this.cleanUpGlobalEventListeners(),super.disconnectedCallback()}willUpdate(e){e.has("index")&&this.setIndex()}updated(e){(e.has("suggestions")||e.has("isHidden")||e.has("queryStatus"))&&(this.isHidden?this.cleanUpGlobalEventListeners():(this.computeCursorStopsAndRefit(),this.setUpGlobalEventListeners()))}setUpGlobalEventListeners(){const e={passive:!0};window.addEventListener("resize",this.onWindowResize,e),window.addEventListener("scroll",this.onWindowResize,e)}cleanUpGlobalEventListeners(){const e={passive:!0};window.removeEventListener("resize",this.onWindowResize,e),window.removeEventListener("scroll",this.onWindowResize,e)}renderStatus(){return dc`
      <li
        tabindex="-1"
        aria-label="autocomplete query status"
        class="query-status ${this.queryStatus?.type}"
      >
        <span>${this.queryStatus?.message}</span>
        <span class="label"
          >${this.queryStatus?.type===Fw.ERROR?"ERROR":""}</span
        >
      </li>
    `}render(){return dc`
      <div class="dropdown-content" id="suggestions" role="listbox">
        <ul>
          ${eb(this.queryStatus,(()=>this.renderStatus()),(()=>dc`
              ${Mw(this.suggestions,((e,t)=>dc`
                  <li
                    data-index=${t}
                    data-value=${e.dataValue??""}
                    tabindex="-1"
                    aria-label=${e.name??""}
                    class="autocompleteOption"
                    role="option"
                    @click=${this.handleClickItem}
                  >
                    <span>${e.text}</span>
                    <span class="label ${this.computeLabelClass(e)}"
                      >${e.label}</span
                    >
                  </li>
                `))}
            `))}
        </ul>
      </div>
    `}close(){this.isHidden=!0}open(){this.isHidden=!1}getCurrentText(){return this.queryStatus?"":this.getCursorTarget()?.dataset.value||""}setPositionTarget(e){this.fitController.setPositionTarget(e)}cursorDown(){this.isSuggestionListInteractible()&&this.cursor.next()}cursorUp(){this.isSuggestionListInteractible()&&this.cursor.previous()}handleTab(){this.isSuggestionListInteractible()&&Jn(this,"item-selected",{trigger:"tab",selected:this.cursor.target})}handleEnter(){this.isSuggestionListInteractible()&&Jn(this,"item-selected",{trigger:"enter",selected:this.cursor.target})}handleEscape(){this.fireClose(),this.close()}handleClickItem(e){e.preventDefault(),e.stopPropagation();let t=e.target;for(;!t.classList.contains("autocompleteOption");){if(!t||t===this)return;t=t.parentElement}Jn(this,"item-selected",{trigger:"click",selected:t})}fireClose(){Jn(this,"dropdown-closed",{})}getCursorTarget(){return this.cursor.target}computeCursorStopsAndRefit(){this.suggestions.length>0?(this.cursor.stops=Array.from(this.suggestionsDiv?.querySelectorAll("li.autocompleteOption")??[]),this.resetCursorIndex()):this.cursor.stops=[],this.fitController.refit()}setIndex(){this.cursor.index=this.index||-1}resetCursorIndex(){this.cursor.setCursorAtIndex(0)}computeLabelClass(e){return e.label?"":"hide"}};Uw([Fc({type:Number})],Bw.prototype,"index",void 0),Uw([Fc({type:Boolean,reflect:!0,attribute:"is-hidden"})],Bw.prototype,"isHidden",void 0),Uw([Fc({type:Object})],Bw.prototype,"queryStatus",void 0),Uw([Fc({type:Number})],Bw.prototype,"verticalOffset",void 0),Uw([Fc({type:Number})],Bw.prototype,"horizontalOffset",void 0),Uw([Fc({type:Array})],Bw.prototype,"suggestions",void 0),Uw([Hc("#suggestions")],Bw.prototype,"suggestionsDiv",void 0),Bw=Uw([Dc("gr-autocomplete-dropdown")],Bw);var Hw,jw=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const Gw=/(?:[^\s"]+|"[^"]*")+/g;let zw=Hw=class extends Ic{constructor(){super(...arguments),this.query=()=>Promise.resolve([]),this.threshold=1,this.allowNonSuggestedValues=!1,this.borderless=!1,this.disabled=!1,this.verticalOffset=31,this.text="",this.placeholder="",this.clearOnCommit=!1,this.tabComplete=!1,this.value="",this.multi=!1,this.warnUncommitted=!1,this.showBlueFocusBorder=!1,this.skipCommitOnItemSelect=!1,this.debounceWait=200,this.label="",this.suggestions=[],this.index=null,this.disableDisplayingSuggestions=!1,this.focused=!1,this.selected=null,this.activeQueryId=0,this.handleBodyClick=e=>{const t=e.composedPath();if(t){for(let e=0;e<t.length;e++)if(t[e]===this)return;this.setFocus(!1),this.activeQueryId=0}}}static getNextQueryId(){return Hw.NEXT_QUERY_ID++}get latestSuggestionUpdateComplete(){return this.updateSuggestionsTask?.promise}get nativeInput(){return this.input.shadowRoot.querySelector("input")}static get styles(){return[Jy,Nc,Sd`
        md-outlined-text-field {
          height: var(--gr-autocomplete-height);
          width: 100%;
          border-radius: var(
            --gr-autocomplete-text-field-border-radius,
            var(--border-radius)
          );
          --md-outlined-text-field-container-shape: var(
            --gr-autocomplete-text-field-border-radius,
            var(--border-radius)
          );
        }
        md-outlined-text-field.borderless {
          --md-outlined-text-field-outline-width: 0;
          --md-outlined-text-field-hover-outline-width: 0;
          --md-outlined-text-field-focus-outline-width: 0;
          border: none;
          padding: 0;
        }
        md-outlined-text-field.warnUncommitted {
          --md-outlined-text-field-input-text-size: 16px;
          --md-sys-color-primary: var(--error-text-color);
          --md-sys-color-on-surface: var(--error-text-color);
        }
      `]}connectedCallback(){super.connectedCallback(),document.addEventListener("click",this.handleBodyClick)}disconnectedCallback(){document.removeEventListener("click",this.handleBodyClick),this.updateSuggestionsTask?.cancel(),super.disconnectedCallback()}willUpdate(e){(e.has("text")||e.has("threshold"))&&this.updateSuggestions(),(e.has("suggestions")||e.has("queryStatus"))&&this.updateDropdownVisibility(),e.has("text")&&Jn(this,"text-changed",{value:this.text}),e.has("value")&&Jn(this,"value-changed",{value:this.value})}hasNamedSlot(e){const t=this.querySelectorAll(`[slot="${e}"]`);return!!t&&t.length>0}render(){return dc`
      <md-outlined-text-field
        id="input"
        class=${this.computeClass()}
        ?disabled=${this.disabled}
        .value=${this.text}
        @input=${e=>{const t=e.target;this.text=t.value}}
        .placeholder=${this.placeholder}
        @keydown=${this.handleKeydown}
        @focus=${this.onInputFocus}
        @blur=${this.onInputBlur}
        autocomplete="off"
        .label=${this.label}
        aria-label=${this.label||this.placeholder||uc}
      >
        ${this.hasNamedSlot("leading-icon")?dc`
              <div slot="leading-icon">
                <slot name="leading-icon"></slot>
              </div>
            `:uc}
        ${this.hasNamedSlot("trailing-icon")?dc`
              <div slot="trailing-icon">
                <slot name="trailing-icon"></slot>
              </div>
            `:uc}
      </md-outlined-text-field>
      <gr-autocomplete-dropdown
        .verticalOffset=${this.verticalOffset}
        id="suggestions"
        @item-selected=${this.handleItemSelect}
        @dropdown-closed=${this.focusWithoutDisplayingSuggestions}
        .suggestions=${this.suggestions}
        .queryStatus=${this.queryStatus}
        role="listbox"
        .index=${this.index}
      >
      </gr-autocomplete-dropdown>
    `}get focusStart(){return this.input}focus(){this.nativeInput.focus()}focusWithoutDisplayingSuggestions(){this.disableDisplayingSuggestions=!0,this.focus(),this.updateComplete.then((()=>{this.disableDisplayingSuggestions=!1}))}selectAll(){const e=this.nativeInput;this.input?.value&&e.setSelectionRange(0,this.input?.value.length)}clear(){this.text=""}handleItemSelectEnter(e){this.handleInputCommit(this.skipCommitOnItemSelect),e.stopPropagation(),e.preventDefault(),this.focusWithoutDisplayingSuggestions()}handleItemSelect(e){"click"===e.detail.trigger?(this.selected=e.detail.selected,this.commit(),e.stopPropagation(),e.preventDefault(),this.focusWithoutDisplayingSuggestions()):"enter"===e.detail.trigger?this.handleItemSelectEnter(e):"tab"===e.detail.trigger&&(this.tabComplete?(this.handleInputCommit(!0),e.stopPropagation(),e.preventDefault(),this.focus()):this.setFocus(!1))}setText(e){this.disableDisplayingSuggestions=!0,this.text=e,this.updateComplete.then((()=>{this.disableDisplayingSuggestions=!1}))}onInputFocus(){this.setFocus(!0),this.updateSuggestions(),this.input?.classList.remove("warnUncommitted")}onInputBlur(){this.input?.classList.toggle("warnUncommitted",this.warnUncommitted&&!!this.text.length&&!this.focused)}updateSuggestions(){if(void 0===this.text||void 0===this.threshold)return;if(this.resetQueryOutput(),this.disableDisplayingSuggestions)return;if(!this.query)return;if(this.text.length<this.threshold)return void(this.value="");if(!this.focused)return;const e=Hw.getNextQueryId();this.activeQueryId=e,this.setQueryStatus({type:Fw.LOADING,message:"Loading..."}),this.updateSuggestionsTask=ny(this.updateSuggestionsTask,this.createUpdateTask(e,this.query,this.text),this.debounceWait)}createUpdateTask(e,t,i){return async()=>{let r;try{r=await t(i)}catch(e){return this.value="",void("string"==typeof e?this.setQueryStatus({type:Fw.ERROR,message:e}):e instanceof Error&&this.setQueryStatus({type:Fw.ERROR,message:e.message}))}if(e===this.activeQueryId){for(const e of r)e.text=e?.name??"";this.setSuggestions(r),-1===this.index&&(this.value="")}}}setFocus(e){e!==this.focused&&(this.focused=e,this.updateDropdownVisibility())}shouldShowDropdown(){return(this.suggestions.length>0||this.queryStatus)&&this.focused}updateDropdownVisibility(){this.shouldShowDropdown()?this.suggestionsDropdown?.open():this.suggestionsDropdown?.close()}computeClass(){const e=[];return this.borderless&&e.push("borderless"),this.showBlueFocusBorder&&e.push("showBlueFocusBorder"),e.join(" ")}handleKeydown(e){switch(this.setFocus(!0),e.key){case"ArrowUp":e.preventDefault(),this.suggestionsDropdown?.cursorUp();break;case"ArrowDown":e.preventDefault(),this.suggestionsDropdown?.cursorDown();break;case"Escape":e.preventDefault(),this.cancel();break;case"Tab":if(this.queryStatus?.type===Fw.LOADING&&this.tabComplete){e.preventDefault(),this.queryStatus={type:Fw.LOADING,message:"Loading... (Handle Tab on load)"};const t=this.activeQueryId;this.latestSuggestionUpdateComplete?.then((()=>{t===this.activeQueryId&&this.handleInputCommit(!0)}))}else this.suggestions.length>0&&this.tabComplete?(e.preventDefault(),this.handleInputCommit(!0),this.focus()):this.setFocus(!1);break;case"Enter":if(Gn(e))break;if(e.preventDefault(),this.queryStatus?.type===Fw.LOADING){this.queryStatus={type:Fw.LOADING,message:"Loading... (Handle Enter on load)"};const t=this.activeQueryId;this.latestSuggestionUpdateComplete?.then((()=>{t===this.activeQueryId&&this.handleItemSelectEnter(e)}))}else this.suggestions.length>0?this.handleItemSelectEnter(e):this.handleInputCommit();break;default:this.focus(),this.resetQueryOutput(),this.activeQueryId=0}}cancel(){this.shouldShowDropdown()?(this.resetQueryOutput(),this.activeQueryId=0,this.requestUpdate()):Jn(this,"cancel",{})}handleInputCommit(e){(this.allowNonSuggestedValues||!this.suggestionsDropdown?.isHidden&&0!==this.suggestions.length)&&(this.selected=this.suggestionsDropdown?.getCursorTarget()??null,this.commit(e))}updateValue(e,t){if(!e)return;const i=Number(e.dataset.index);if(isNaN(i))return;const r=t[i].value;if(null!=r)if(this.multi){const e=this.text.match(Gw);e?.length&&(e[e.length-1]=r,this.value=e.join(" "))}else this.value=r}async commit(e){this.suggestions.length>0?this.updateValue(this.selected,this.suggestions):this.value=this.text||"";const t=this.value;if(this.multi)this.setText(this.value);else if(!this.clearOnCommit&&this.selected){const e=this.selected.dataset;if(e){const t=Number(e.index);if(isNaN(t))return;this.setText(this.suggestions[t]?.name||"")}}else this.clear();this.resetQueryOutput(),await this.updateComplete,e||Jn(this,"commit",{value:t})}resetQueryOutput(){this.suggestions=[],this.queryStatus=void 0}setSuggestions(e){this.suggestions=e,this.queryStatus=void 0}setQueryStatus(e){this.suggestions=[],this.queryStatus=e}};zw.NEXT_QUERY_ID=1,jw([Fc({type:Object})],zw.prototype,"query",void 0),jw([Hc("#input")],zw.prototype,"input",void 0),jw([Hc("#suggestions")],zw.prototype,"suggestionsDropdown",void 0),jw([Fc({type:Number})],zw.prototype,"threshold",void 0),jw([Fc({type:Boolean,attribute:"allow-non-suggested-values"})],zw.prototype,"allowNonSuggestedValues",void 0),jw([Fc({type:Boolean})],zw.prototype,"borderless",void 0),jw([Fc({type:Boolean})],zw.prototype,"disabled",void 0),jw([Fc({type:Number})],zw.prototype,"verticalOffset",void 0),jw([Fc({type:String})],zw.prototype,"text",void 0),jw([Fc({type:String})],zw.prototype,"placeholder",void 0),jw([Fc({type:Boolean,attribute:"clear-on-commit"})],zw.prototype,"clearOnCommit",void 0),jw([Fc({type:Boolean,attribute:"tab-complete"})],zw.prototype,"tabComplete",void 0),jw([Fc({type:String})],zw.prototype,"value",void 0),jw([Fc({type:Boolean})],zw.prototype,"multi",void 0),jw([Fc({type:Boolean,attribute:"warn-uncommitted"})],zw.prototype,"warnUncommitted",void 0),jw([Fc({type:Boolean,attribute:"show-blue-focus-border"})],zw.prototype,"showBlueFocusBorder",void 0),jw([Fc({type:Boolean,attribute:"skip-commit-on-item-select"})],zw.prototype,"skipCommitOnItemSelect",void 0),jw([Fc({type:Number})],zw.prototype,"debounceWait",void 0),jw([Fc({type:String})],zw.prototype,"label",void 0),jw([Uc()],zw.prototype,"suggestions",void 0),jw([Uc()],zw.prototype,"queryStatus",void 0),jw([Uc()],zw.prototype,"index",void 0),jw([Uc()],zw.prototype,"selected",void 0),zw=Hw=jw([Dc("gr-autocomplete")],zw);const Vw=e=>e??uc;var Ww=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let qw=class extends Ic{constructor(){super(...arguments),this.hasTooltip=!1,this.hideInput=!1,this.multiline=!1,this.nowrap=!1,this.reporting=Xn().reportingService}static get styles(){return[Jy,vy,Sd`
        .text {
          align-items: center;
          display: flex;
          flex-wrap: wrap;
        }
        :host([nowrap]) .text {
          flex-wrap: nowrap;
        }
        .text label {
          flex: 0 0 120px;
          color: var(--deemphasized-text-color);
        }
        .text .shortcut {
          width: 27px;
          margin: 0 var(--spacing-m);
          color: var(--deemphasized-text-color);
        }
        .copyText {
          flex-grow: 1;
          margin-right: var(--spacing-s);
        }
        .hideInput {
          display: none;
        }
        input#input {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          width: 100%;
          background-color: var(--view-background-color);
          color: var(--primary-text-color);
        }
        textarea#input {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          width: 100%;
          min-height: 100px;
          resize: vertical;
          background-color: var(--view-background-color);
          color: var(--primary-text-color);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          padding: var(--spacing-s);
        }
        textarea#input:focus {
          outline: none;
          box-shadow: none;
          border-color: var(--prominent-border-color, var(--border-color));
        }
        textarea#input::placeholder {
          color: var(--deemphasized-text-color);
        }
        gr-icon {
          color: var(
            --gr-copy-clipboard-icon-color,
            var(--deemphasized-text-color)
          );
        }
        gr-button {
          display: block;
          --gr-button-padding: var(--spacing-s);
          margin: calc(0px - var(--spacing-s));
        }
      `]}render(){return dc`
      <div class="text">
        ${eb(this.label,(()=>dc`<label for="input">${this.label}</label>`))}
        ${eb(this.multiline,(()=>dc`<textarea
            id="input"
            class=${th({hideInput:this.hideInput})}
            @click=${this.handleInputClick}
            readonly=""
            .value=${this.text??""}
            part="text-container-wrapper-style"
          >
          </textarea>`),(()=>dc` <md-outlined-text-field
            id="input"
            class="copyText ${th({hideInput:this.hideInput})}"
            .value=${this.text??""}
            ?readOnly=${!0}
            part="text-container-wrapper-style"
            @click=${this.handleInputClick}
          >
          </md-outlined-text-field>`))}
        ${eb(this.shortcut,(()=>dc`<span class="shortcut">${this.shortcut}</span>`))}
        <gr-tooltip-content
          ?has-tooltip=${this.hasTooltip}
          title=${Vw(this.buttonTitle)}
        >
          <gr-button
            id="copy-clipboard-button"
            link=""
            class="copyToClipboard"
            @click=${this.copyToClipboard}
            aria-label="copy"
            aria-description="Click to copy to clipboard"
          >
            <div>
              <gr-icon id="icon" icon="content_copy" small></gr-icon>
            </div>
          </gr-button>
        </gr-tooltip-content>
      </div>
    `}focusOnCopy(){_a(this,"#copy-clipboard-button").focus()}handleInputClick(e){e.preventDefault(),e.composedPath()[0].select()}copyToClipboard(e){e.preventDefault(),e.stopPropagation(),Jn(this,"item-copied",{}),this.text=_a(this,"#input").value,ba(this.text,"text"),this.iconEl.icon="check",this.reporting.time(ua.COPY_TO_CLIPBOARD),Sa(this.text,this.copyTargetName??"Link").finally((()=>{this.reporting.timeEnd(ua.COPY_TO_CLIPBOARD,{copyTargetName:this.copyTargetName})})),setTimeout((()=>this.iconEl.icon="content_copy"),1e3)}};Ww([Fc({type:String})],qw.prototype,"text",void 0),Ww([Fc({type:String})],qw.prototype,"buttonTitle",void 0),Ww([Fc({type:Boolean})],qw.prototype,"hasTooltip",void 0),Ww([Fc({type:Boolean})],qw.prototype,"hideInput",void 0),Ww([Fc({type:String})],qw.prototype,"label",void 0),Ww([Fc({type:String})],qw.prototype,"shortcut",void 0),Ww([Fc({type:String,reflect:!0})],qw.prototype,"copyTargetName",void 0),Ww([Fc({type:Boolean})],qw.prototype,"multiline",void 0),Ww([Fc({type:Boolean,reflect:!0})],qw.prototype,"nowrap",void 0),Ww([Hc("#icon")],qw.prototype,"iconEl",void 0),qw=Ww([Dc("gr-copy-clipboard")],qw);const Kw=Sd`
  .main {
    margin: var(--spacing-l);
  }
  .loading {
    display: none;
  }
  #loading.loading {
    display: block;
  }
  #loading:not(.loading) {
    display: none;
  }
`,Yw=document.createElement("template");Yw.innerHTML=`\n  <dom-module id="gr-subpage-styles">\n    <template>\n      <style>\n      ${Kw.cssText}\n      </style>\n    </template>\n  </dom-module>\n`,document.head.appendChild(Yw.content);var Xw=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let Jw=class extends Ic{constructor(){super(...arguments),this.disabled=!1,this.value="",this.rows=1,this.maxRows=0,this.putCursorAtEndOnFocus=!1,this.autocomplete="off",this.required=!1,this.focused=!1,this.tokens=[]}get isFocused(){return!!this.focused}get nativeElement(){return this.editableTextAreaElement}get scrollTop(){return this.editableTextAreaElement?.scrollTop??0}static get styles(){return[Sd`
        :host {
          display: inline-block;
          position: relative;
          width: 400px;
          border: var(--gr-autogrow-textarea-border-width, 2px) solid
            var(--gr-textarea-border-color, white);
          border-radius: 4px;
          padding: 2px;
          -moz-appearance: textarea;
          -webkit-appearance: textarea;
          appearance: textarea;
          overflow: hidden;
        }
        :host([disabled]) {
          textarea {
            background-color: var(--gr-autogrow-textarea-disabled-color);
            color: var(--text-disabled, black);
            cursor: default;
          }
        }
        .mirror-text {
          visibility: hidden;
          word-wrap: break-word;
          padding: var(--gr-autogrow-textarea-padding);
          box-sizing: var(--gr-autogrow-textarea-box-sizing);
        }
        .textarea-container {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
        }
        textarea {
          position: relative;
          outline: none;
          border: none;
          resize: none;
          background: inherit;
          color: inherit;
          width: 100%;
          height: 100%;
          font-size: inherit;
          font-family: inherit;
          line-height: inherit;
          text-align: inherit;
          padding: var(--gr-autogrow-textarea-padding);
          box-sizing: var(--gr-autogrow-textarea-box-sizing);
        }
        textarea::placeholder {
          color: var(--deemphasized-text-color);
        }
        textarea:focus-visible {
          border-color: var(--gr-textarea-focus-outline-color, black);
          outline: none;
        }
      `]}render(){return dc` <div id="mirror" class="mirror-text" aria-hidden="true">
        ${1===this.tokens.length&&""===this.tokens[0]?dc`&#160;`:this.tokens.map(((e,t)=>t===this.tokens.length-1?dc`${e}&#160;`:dc`${e}<br />`))}
      </div>
      <div class="textarea-container">
        <textarea
          class="editableTextArea"
          .value=${this.value}
          aria-label=${Vw(this.label)}
          aria-disabled=${this.disabled}
          aria-multiline="true"
          aria-placeholder=${Vw(this.placeholder)}
          autocomplete=${this.autocomplete}
          ?autofocus=${this.autofocus}
          autocapitalize=${this.autocapitalize}
          inputmode=${Vw(this.inputmode)}
          placeholder=${Vw(this.placeholder)}
          ?disabled=${this.disabled}
          rows=${this.rows}
          minlength=${Vw(this.minlength)}
          maxlength=${Vw(this.maxlength)}
          spellcheck=${this.spellcheck}
          @input=${this.onInput}
          @focus=${this.onFocus}
          @blur=${this.onBlur}
          @keyup=${this.handleKeyUp}
          @mouseup=${this.handleMouseUp}
        ></textarea>
      </div>`}updated(e){e.has("value")&&(this.editableTextAreaElement&&this.editableTextAreaElement.value!==this.value&&(this.editableTextAreaElement.value=this.value??""),this.updateMirror()),(e.has("rows")||e.has("maxRows"))&&this.updateMirror()}async focus(){const e=await this.editableTextArea,t=this.isFocused;e?.focus?.(),this.putCursorAtEndOnFocus&&!t&&await this.putCursorAtEnd()}async putCursorAtEnd(){const e=await this.editableTextArea;if(!e)return;const t=this.value.length;e.selectionStart=t,e.selectionEnd=t,e.focus()}setCursorPosition(e){this.editableTextAreaElement&&(this.editableTextAreaElement.selectionStart=e,this.editableTextAreaElement.selectionEnd=e,this.onCursorPositionChange())}async setRangeText(e,t,i){const r=this.value?.substring(0,t)??"",o=this.value?.substring(i,this.value?.length??0)??"";this.value=r+e+o,await async function(){return new Promise((e=>{requestAnimationFrame((()=>{e()}))}))}(),this.setCursorPosition(r.length+e.length)}onInput(e){e.preventDefault(),e.stopImmediatePropagation();const t=e.target;this.value=t.value,this.fire("input",{value:this.value})}onFocus(){this.focused=!0,this.onCursorPositionChange()}onBlur(){this.focused=!1,this.onCursorPositionChange()}handleKeyUp(){this.onCursorPositionChange()}handleMouseUp(){this.onCursorPositionChange()}fire(e,t){this.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))}onCursorPositionChange(){const e=this.getCursorPosition();this.fire("cursorPositionChange",{position:e})}getCursorPosition(){return this.editableTextAreaElement?.selectionStart??-1}async getCursorPositionAsync(){const e=await this.editableTextArea;return e?.selectionStart??-1}updateMirror(){this.editableTextAreaElement&&(this.tokens=this.constrain(this.tokenize(this.editableTextAreaElement.value)))}tokenize(e){return e?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").split("\n"):[""]}constrain(e){let t=e.slice();for(this.maxRows>0&&t.length>this.maxRows&&(t=t.slice(0,this.maxRows));this.rows>0&&t.length<this.rows;)t.push("");return t}};Xw([Hc(".editableTextArea")],Jw.prototype,"editableTextAreaElement",void 0),Xw([zc(".editableTextArea")],Jw.prototype,"editableTextArea",void 0),Xw([Fc({type:Boolean,reflect:!0})],Jw.prototype,"disabled",void 0),Xw([Fc({type:String,reflect:!0})],Jw.prototype,"placeholder",void 0),Xw([Fc({type:String})],Jw.prototype,"value",void 0),Xw([Fc({type:Number})],Jw.prototype,"rows",void 0),Xw([Fc({type:Number})],Jw.prototype,"maxRows",void 0),Xw([Fc({type:Boolean})],Jw.prototype,"putCursorAtEndOnFocus",void 0),Xw([Fc({type:String})],Jw.prototype,"autocomplete",void 0),Xw([Fc({type:String})],Jw.prototype,"inputmode",void 0),Xw([Fc({type:String})],Jw.prototype,"readonly",void 0),Xw([Fc({type:Boolean})],Jw.prototype,"required",void 0),Xw([Fc({type:Number})],Jw.prototype,"minlength",void 0),Xw([Fc({type:Number})],Jw.prototype,"maxlength",void 0),Xw([Fc({type:String})],Jw.prototype,"label",void 0),Xw([Uc()],Jw.prototype,"tokens",void 0),Jw=Xw([Dc("gr-autogrow-textarea")],Jw);const Qw=mu("config-model");class Zw extends df{constructor(e,t){super({}),this.changeModel=e,this.restApiService=t,this.repoConfig$=lf(this.state$,(e=>e.repoConfig)),this.repoCommentLinks$=lf(this.repoConfig$,(e=>e?.commentlinks??{})),this.serverConfig$=lf(this.state$,(e=>e.serverConfig)),this.download$=lf(this.serverConfig$,(e=>e?.download)),this.loginUrl$=lf(this.serverConfig$,(e=>function(e){const t=Sf(),i=e?.login_url,r=e?.auth_type;if(!i||r!==Pu.HTTP&&r!==Pu.HTTP_LDAP){const e=`${t}/login`;let i=window.location.pathname.substring(t.length)+window.location.search+window.location.hash;return i="/"===i?"":encodeURIComponent(i),`${e}/${i}`}return i.startsWith("http")?i:t+((o=i).startsWith("/")?o:`/${o}`);var o}(e?.auth))),this.loginText$=lf(this.serverConfig$,(e=>e?.auth.login_text??"Sign in")),this.mergeabilityComputationBehavior$=lf(this.serverConfig$,(e=>e?.change?.mergeability_computation_behavior)),this.allowMarkdownBase64ImagesInComments$=lf(this.serverConfig$,(e=>!!e?.change?.allow_markdown_base64_images_in_comments)),this.docsBaseUrl$=lf(this.serverConfig$.pipe(Vp((e=>Qh(this.getDocsBaseUrl(e))))),(e=>e)),this.subscriptions=[Qh(this.restApiService.getConfig()).subscribe((e=>{this.updateServerConfig(e)})),this.changeModel.repo$.pipe(Vp((e=>void 0===e?Zh(void 0):Qh(this.restApiService.getProjectConfig(e))))).subscribe((e=>{this.updateRepoConfig(e)}))]}async getDocsBaseUrl(e){return e?.gerrit?.doc_url?e.gerrit.doc_url:await this.restApiService.probePath(Sf()+"/Documentation/index.html")?Sf()+"/Documentation":"https://gerrit-review.googlesource.com/Documentation"}updateRepoConfig(e){this.updateState({repoConfig:e})}updateServerConfig(e){this.updateState({serverConfig:e})}}var e_=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const t_=/^[\da-f]{40}$/;let i_=class extends Ic{constructor(){super(),this.isAdmin=!1,this.groupOwner=!1,this.groupIsInternal=!1,this.loading=!0,this.restApiService=Xn().restApiService,this.getNavigation=yu(this,gy),this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.enableDeleteGroup=!!e?.groups.enable_delete_group})),this.query=e=>this.getGroupSuggestions(e)}connectedCallback(){super.connectedCallback()}static get styles(){return[Iw,Qb,my,vy,Nc,Kw,Jy,Sd`
        h3.edited:after {
          color: var(--deemphasized-text-color);
          content: ' *';
        }
        gr-autogrow-textarea {
          background-color: var(--view-background-color);
          width: 100%;
        }
        gr-autogrow-textarea:focus {
          border: 2px solid var(--input-focus-border-color);
        }
      `]}render(){return dc`
      <div class="main gr-form-styles read-only">
        <div id="loading" class=${this.computeLoadingClass()}>Loading...</div>
        <div id="loadedContent" class=${this.computeLoadingClass()}>
          <h1 id="Title" class="heading-1">${this.originalName}</h1>
          <h2 id="configurations" class="heading-2">General</h2>
          <div id="form">
            <fieldset>
              ${this.renderGroupUUID()} ${this.renderGroupName()}
              ${this.renderGroupOwner()} ${this.renderGroupDescription()}
              ${this.renderGroupOptions()}${this.renderGroupDeleteButton()}
            </fieldset>
          </div>
        </div>
      </div>
    `}renderGroupUUID(){return dc`
      <h3 id="groupUUID" class="heading-3">Group UUID</h3>
      <fieldset>
        <gr-copy-clipboard
          id="uuid"
          .text=${this.getGroupUUID()}
        ></gr-copy-clipboard>
      </fieldset>
    `}renderGroupName(){const e=this.originalName!==this.groupConfig?.name;return dc`
      <h3
        id="groupName"
        class="heading-3 ${this.computeHeaderClass(e)}"
      >
        Group Name
      </h3>
      <fieldset>
        <span class="value">
          <gr-autocomplete
            id="groupNameInput"
            .text=${this.groupConfig?.name??""}
            .showBlueFocusBorder=${!0}
            ?disabled=${this.computeGroupDisabled()}
            @text-changed=${this.handleNameTextChanged}
          ></gr-autocomplete>
        </span>
        <span class="value">
          <gr-button
            id="inputUpdateNameBtn"
            ?disabled=${!e}
            @click=${this.handleSaveName}
          >
            Rename Group</gr-button
          >
        </span>
      </fieldset>
    `}renderGroupOwner(){const e=this.originalOwnerName!==this.groupConfig?.owner;return dc`
      <h3
        id="groupOwner"
        class="heading-3 ${this.computeHeaderClass(e)}"
      >
        Owners
      </h3>
      <fieldset>
        <span class="value">
          <gr-autocomplete
            id="groupOwnerInput"
            .text=${this.groupConfig?.owner??""}
            .value=${this.groupConfigOwner??""}
            .query=${this.query}
            .showBlueFocusBorder=${!0}
            ?disabled=${this.computeGroupDisabled()}
            @text-changed=${this.handleOwnerTextChanged}
            @value-changed=${this.handleOwnerValueChanged}
          >
          </gr-autocomplete>
        </span>
        <span class="value">
          <gr-button
            id="inputUpdateOwnerBtn"
            ?disabled=${!e}
            @click=${this.handleSaveOwner}
          >
            Change Owners</gr-button
          >
        </span>
      </fieldset>
    `}renderGroupDescription(){const e=this.originalDescriptionName!==this.groupConfig?.description;return dc`
      <h3 class="heading-3 ${this.computeHeaderClass(e)}">
        Description
      </h3>
      <fieldset>
        <div>
          <gr-autogrow-textarea
            id="descriptionInput"
            class="description"
            autocomplete="on"
            placeholder="&lt;Insert group description here&gt;"
            .rows=${4}
            .maxRows=${10}
            .value=${this.groupConfig?.description??""}
            ?disabled=${this.computeGroupDisabled()}
            @input=${this.handleDescriptionInput}
          ></gr-autogrow-textarea>
        </div>
        <span class="value">
          <gr-button
            ?disabled=${!e}
            @click=${this.handleSaveDescription}
          >
            Save Description
          </gr-button>
        </span>
      </fieldset>
    `}renderGroupOptions(){const e=Boolean(this.originalOptionsVisibleToAll)!==Boolean(this.groupConfig?.options?.visible_to_all);return dc`
      <h3
        id="options"
        class="heading-3 ${this.computeHeaderClass(e)}"
      >
        Group Options
      </h3>
      <fieldset>
        <section>
          <span class="title">
            Make group visible to all registered users
          </span>
          <span class="value">
            <md-checkbox
              id="visibleToAll"
              ?checked=${Boolean(this.groupConfig?.options?.visible_to_all)}
              ?disabled=${this.computeGroupDisabled()}
              @change=${this.handleOptionsChange}
            ></md-checkbox>
          </span>
        </section>
        <span class="value">
          <gr-button
            ?disabled=${!e}
            @click=${this.handleSaveOptions}
          >
            Save Group Options
          </gr-button>
        </span>
      </fieldset>
    `}renderGroupDeleteButton(){return eb(!this.computeGroupDisabled()&&this.canDelete&&this.enableDeleteGroup,(()=>dc`
        <div id="deleteGroupContainer">
          <h3
            id="deleteGroup"
            class="heading-3 ${this.computeHeaderClass(!1)}"
          >
            Delete Group
          </h3>
          <fieldset>
            <span class="value">
              <gr-button
                @click=${()=>{this.deleteGroupModal?.showModal()}}
              >
                Delete Group
              </gr-button>
            </span>
          </fieldset>
          <dialog id="deleteGroupModal">
            <gr-dialog
              id="deleteGroupDialog"
              confirm-label="Delete"
              @confirm=${this.handleDeleteGroup}
              @cancel=${()=>this.deleteGroupModal?.close()}
            >
              <div class="header" slot="header">
                Are you really sure you want to delete the group
                "${this.originalName}"?
              </div>
            </gr-dialog>
          </dialog>
        </div>
      `))}willUpdate(e){e.has("groupId")&&this.loadGroup()}async loadGroup(){if(!this.groupId)return;const e=[],t=await this.restApiService.getGroupConfig(this.groupId,(e=>{ia(e)}));t&&t.name&&(void 0===t.description&&(t.description=""),this.originalName=t.name,this.originalOwnerName=t.owner,this.originalDescriptionName=t.description,this.groupIsInternal=!!t.id.match(t_),e.push(this.restApiService.getIsAdmin().then((e=>{this.isAdmin=!!e}))),e.push(this.restApiService.getIsGroupOwner(t.name).then((e=>{this.groupOwner=!!e}))),this.groupConfig=t,this.originalOptionsVisibleToAll=t?.options?.visible_to_all,oa(t.name),await Promise.all(e),this.loading=!1)}computeLoadingClass(){return this.loading?"loading":""}async handleSaveName(){const e=this.groupConfig;if(!this.groupId||!e||!e.name)return Promise.reject(new Error("invalid groupId or config name"));const t=e.name;200===(await this.restApiService.saveGroupName(this.groupId,t)).status&&(this.originalName=t,Jn(this,"name-changed",{name:t,external:!this.groupIsInternal}),this.requestUpdate())}async handleSaveOwner(){if(!this.groupId||!this.groupConfig)return;let e=this.groupConfig.owner;this.groupConfigOwner&&(e=decodeURIComponent(this.groupConfigOwner)),e&&(await this.restApiService.saveGroupOwner(this.groupId,e),this.originalOwnerName=this.groupConfig?.owner,this.groupConfigOwner=void 0)}async handleSaveDescription(){this.groupId&&this.groupConfig&&void 0!==this.groupConfig.description&&(await this.restApiService.saveGroupDescription(this.groupId,this.groupConfig.description),this.originalDescriptionName=this.groupConfig.description)}async handleSaveOptions(){if(!this.groupId||!this.groupConfig||!this.groupConfig.options)return;const e=this.groupConfig.options.visible_to_all,t={visible_to_all:e};await this.restApiService.saveGroupOptions(this.groupId,t),this.originalOptionsVisibleToAll=e}async handleDeleteGroup(){this.originalName&&(await this.restApiService.deleteGroup(this.originalName),this.restApiService.invalidateGroupsCache(),this.deleteGroupModal?.close(),this.getNavigation().setUrl(Aw({adminView:Cw.GROUPS})))}computeHeaderClass(e){return e?"edited":""}getGroupSuggestions(e){return this.restApiService.getSuggestedGroups(e,void 0,void 0,Ff).then((e=>{const t=[];for(const[i,r]of Object.entries(e??{}))t.push({name:i,value:decodeURIComponent(r.id)});return t}))}computeGroupDisabled(){return!(this.groupIsInternal&&(this.isAdmin||this.groupOwner))}getGroupUUID(){const e=this.groupConfig?.id;if(e)return e.match(t_)?e:decodeURIComponent(e)}handleNameTextChanged(e){this.groupConfig&&!this.loading&&(this.groupConfig.name=e.detail.value,this.requestUpdate())}handleOwnerTextChanged(e){this.groupConfig&&!this.loading&&(this.groupConfig.owner=e.detail.value,this.requestUpdate())}handleOwnerValueChanged(e){this.loading||(this.groupConfigOwner=e.detail.value,this.requestUpdate())}handleDescriptionInput(e){if(!this.groupConfig||this.loading)return;const t=e.target.value??"";this.groupConfig.description=t,this.requestUpdate()}handleOptionsChange(e){this.groupConfig&&!this.loading&&(this.groupConfig.options.visible_to_all=e.target.checked,this.requestUpdate())}};e_([Hc("#deleteGroupModal")],i_.prototype,"deleteGroupModal",void 0),e_([Fc({type:String})],i_.prototype,"groupId",void 0),e_([Fc({type:Boolean})],i_.prototype,"canDelete",void 0),e_([Uc()],i_.prototype,"originalOwnerName",void 0),e_([Uc()],i_.prototype,"originalDescriptionName",void 0),e_([Uc()],i_.prototype,"originalOptionsVisibleToAll",void 0),e_([Uc()],i_.prototype,"isAdmin",void 0),e_([Uc()],i_.prototype,"groupOwner",void 0),e_([Uc()],i_.prototype,"groupIsInternal",void 0),e_([Uc()],i_.prototype,"loading",void 0),e_([Uc()],i_.prototype,"groupConfig",void 0),e_([Uc()],i_.prototype,"groupConfigOwner",void 0),e_([Uc()],i_.prototype,"originalName",void 0),e_([Uc()],i_.prototype,"enableDeleteGroup",void 0),i_=e_([Dc("gr-group")],i_);const r_="/static/gerrit-theme.js";function o_(e){return e.endsWith(r_)}function s_(e){if(!(e instanceof URL))try{e=new URL(e)}catch(e){return console.warn(e),null}const t=Sf();let i=e.pathname.replace(t,"");return window.ASSETS_PATH&&e.href.includes(window.ASSETS_PATH)&&(i=e.href.replace(window.ASSETS_PATH,"")),o_(i)?"gerrit-theme":i.startsWith("/plugins")?i.split("/")[2].split(".")[0]:(console.warn("Plugin not being loaded from /plugins base path:",e.href,"— Unable to determine name."),null)}class n_{constructor(e,t,i){this.reporting=e,this.plugin=t,this.element=i,this._promises=new Map,this.reporting.trackApi(this.plugin,"attribute","constructor")}_getChangedEventName(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"-changed"}_elementHasProperty(e){return void 0!==this.element[e]}_reportValue(e,t){try{e(t)}catch(e){console.info(e)}}bind(e,t){this.reporting.trackApi(this.plugin,"attribute","bind");const i=this._getChangedEventName(e),r=e=>this._reportValue(t,e.detail.value);return this.element.addEventListener(i,r),this._elementHasProperty(e)&&this._reportValue(t,this.element[e]),()=>this.element.removeEventListener(i,r)}get(e){if(this.reporting.trackApi(this.plugin,"attribute","get"),this._elementHasProperty(e))return Promise.resolve(this.element[e]);if(!this._promises.has(e)){let t;const i=new Promise((e=>t=e)),r=this.bind(e,(e=>{t(e),r()}));this._promises.set(e,i)}return this._promises.get(e)}set(e,t){this.reporting.trackApi(this.plugin,"attribute","set"),this.element[e]=t,this.element.dispatchEvent(new CustomEvent(this._getChangedEventName(e),{detail:{value:t}}))}}var a_,l_;!function(e){e.CHANGE_ACTIONS="changeactions",e.REPLY_DIALOG="replydialog"}(a_||(a_={})),function(e){e.BEFORE_CHANGE_ACTION="before-change-action",e.LABEL_CHANGE="labelchange",e.SHOW_CHANGE="showchange",e.SUBMIT_CHANGE="submitchange",e.VIEW_CHANGE="view-change",e.SHOW_REVISION_ACTIONS="show-revision-actions",e.BEFORE_COMMIT_MSG_EDIT="before-commit-msg-edit",e.COMMIT_MSG_EDIT="commitmsgedit",e.CUSTOM_EMOJIS="custom-emojis",e.REVERT="revert",e.REVERT_SUBMISSION="revert_submission",e.POST_REVERT="postrevert",e.ADMIN_MENU_LINKS="admin-menu-links",e.SHOW_DIFF="showdiff",e.BEFORE_REPLY_SENT="before-reply-sent",e.REPLY_SENT="replysent",e.PUBLISH_EDIT="publish-edit"}(l_||(l_={}));class d_{constructor(e,t,i){this.plugin=e,this.jsApiService=t,this.reporting=Xn().reportingService,this.reporting.trackApi(this.plugin,"actions","constructor"),this.setEl(i)}setEl(e){e?this.el=e:this.reporting.error("GrChangeActionsInterface",new Error("changeActions() API is not ready"))}ensureEl(){if(!this.el){const e=this.jsApiService;this.setEl(e.getElement(a_.CHANGE_ACTIONS))}return this.el}addPrimaryActionKey(e){this.reporting.trackApi(this.plugin,"actions","addPrimaryActionKey");const t=this.ensureEl();t.primaryActionKeys.includes(e)||(t.primaryActionKeys.push(e),t.requestUpdate())}removePrimaryActionKey(e){this.reporting.trackApi(this.plugin,"actions","removePrimaryActionKey");const t=this.ensureEl();t.primaryActionKeys=t.primaryActionKeys.filter((t=>t!==e))}hideQuickApproveAction(){this.reporting.trackApi(this.plugin,"actions","hideQuickApproveAction"),this.ensureEl().hideQuickApproveAction()}setActionOverflow(e,t,i){this.reporting.trackApi(this.plugin,"actions","setActionOverflow"),this.ensureEl().setActionOverflow(e,t,i)}setActionPriority(e,t,i){this.reporting.trackApi(this.plugin,"actions","setActionPriority"),this.ensureEl().setActionPriority(e,t,i)}setActionHidden(e,t,i){this.reporting.trackApi(this.plugin,"actions","setActionHidden"),this.ensureEl().setActionHidden(e,t,i)}add(e,t){return this.reporting.trackApi(this.plugin,"actions","add"),this.ensureEl().addActionButton(e,t)}remove(e){this.reporting.trackApi(this.plugin,"actions","remove"),this.ensureEl().removeActionButton(e)}addTapListener(e,t){this.reporting.trackApi(this.plugin,"actions","addTapListener"),this.ensureEl().addEventListener(e+"-tap",t)}removeTapListener(e,t){this.reporting.trackApi(this.plugin,"actions","removeTapListener"),this.ensureEl().removeEventListener(e+"-tap",t)}setLabel(e,t){this.reporting.trackApi(this.plugin,"actions","setLabel"),this.ensureEl().setActionButtonProp(e,"label",t)}setTitle(e,t){this.reporting.trackApi(this.plugin,"actions","setTitle"),this.ensureEl().setActionButtonProp(e,"title",t)}setEnabled(e,t){this.reporting.trackApi(this.plugin,"actions","setEnabled"),this.ensureEl().setActionButtonProp(e,"enabled",t)}setIcon(e,t){this.reporting.trackApi(this.plugin,"actions","setIcon"),this.ensureEl().setActionButtonProp(e,"icon",t)}getActionDetails(e){this.reporting.trackApi(this.plugin,"actions","getActionDetails");const t=this.ensureEl();return t.getActionDetails(e)||t.getActionDetails(this.plugin.getPluginName()+"~"+e)}}class c_{constructor(e,t){this.plugin=e,this.sharedApiElement=t,this.reporting=Xn().reportingService,this.reporting.trackApi(this.plugin,"reply","constructor")}get _el(){return this.sharedApiElement.getElement(a_.REPLY_DIALOG)}getLabelValue(e){return this.reporting.trackApi(this.plugin,"reply","getLabelValue"),this._el.getLabelValue(e)}setLabelValue(e,t){this.reporting.trackApi(this.plugin,"reply","setLabelValue"),this._el.setLabelValue(e,t)}addReplyTextChangedCallback(e){this.reporting.trackApi(this.plugin,"reply","addReplyTextChangedCb");const t=this.plugin.hook("reply-text");this.addCallbackAsHookListener(t,"value-changed",((t,i)=>{e(i.detail.value,t.change)}))}addLabelValuesChangedCallback(e){this.reporting.trackApi(this.plugin,"reply","addLabelValuesChangedCb");const t=this.plugin.hook("reply-label-scores");this.addCallbackAsHookListener(t,"labels-changed",((t,i)=>{e(i.detail,t.change)}))}addCallbackAsHookListener(e,t,i){let r;e.onAttached((e=>{r=t=>i(e,t),e.content?.addEventListener(t,r)})),e.onDetached((e=>{r&&(e.content?.removeEventListener(t,r),r=void 0)}))}showMessage(e){this.reporting.trackApi(this.plugin,"reply","showMessage"),this._el.setPluginMessage(e)}}class h_{constructor(e){this.plugin=e,this.hooks={}}_getHookName(e,t){return t?e+" "+t:(this.plugin.getPluginName()||"unknownplugin").toLowerCase()+"-autogenerated-"+e}getDomHook(e,t){const i=this._getHookName(e,t);return this.hooks[i]||(this.hooks[i]=new p_(i,t)),this.hooks[i]}}class p_{constructor(e,t){this.instances=[],this.attachCallbacks=[],this.detachCallbacks=[],this.lastAttachedPromise=null,t?this.moduleName=t:(this.moduleName=e,this._createPlaceholder(e))}_createPlaceholder(e){class t extends HTMLElement{}customElements.define(e,t)}handleInstanceDetached(e){const t=this.instances.indexOf(e);-1!==t&&this.instances.splice(t,1),this.detachCallbacks.forEach((t=>t(e)))}handleInstanceAttached(e){this.instances.push(e),this.attachCallbacks.forEach((t=>t(e)))}getLastAttached(){if(this.instances.length)return Promise.resolve(this.instances.slice(-1)[0]);if(!this.lastAttachedPromise){let e;const t=new Promise((t=>{e=t,this.attachCallbacks.push(e)}));this.lastAttachedPromise=t.then((t=>{this.lastAttachedPromise=null;const i=this.attachCallbacks.indexOf(e);return-1!==i&&this.attachCallbacks.splice(i,1),t}))}return this.lastAttachedPromise}getAllAttached(){return this.instances}onAttached(e){return this.attachCallbacks.push(e),this}onDetached(e){return this.detachCallbacks.push(e),this}getModuleName(){return this.moduleName}}var u_=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let g_=class extends Ic{static get styles(){return[Nc,Iw]}render(){return dc`<dialog id="modal">
      <slot></slot>
    </dialog>`}get opened(){return this.modal.hasAttribute("open")}open(){this.modal.showModal()}close(){this.modal.close()}};u_([Hc("#modal")],g_.prototype,"modal",void 0),g_=u_([Dc("gr-plugin-popup")],g_);class m_{constructor(e,t=null){this.plugin=e,this.moduleName=t,this.openingPromise=null,this.popup=null,this.reporting=Xn().reportingService,this.reporting.trackApi(this.plugin,"popup","constructor")}_getElement(){return this.popup}appendContent(e){if(!this.popup)throw new Error("popup element not (yet) available");this.popup.appendChild(e)}open(){return this.reporting.trackApi(this.plugin,"popup","open"),this.openingPromise||(this.openingPromise=this.plugin.hook("plugin-overlay").getLastAttached().then((async e=>{const t=document.createElement("gr-plugin-popup");return this.moduleName&&(t.appendChild(document.createElement(this.moduleName)).plugin=this.plugin),this.popup=e.appendChild(t),await this.popup.updateComplete,this.popup.open(),this}))),this.openingPromise}close(){this.reporting.trackApi(this.plugin,"popup","close"),this.popup&&(this.popup.close(),this.openingPromise=null)}}class f_{constructor(e,t){this.reporting=e,this.plugin=t,this.menuLinks=[],this.reporting.trackApi(this.plugin,"admin","constructor"),this.plugin.on(l_.ADMIN_MENU_LINKS,this)}addMenuLink(e,t,i){this.reporting.trackApi(this.plugin,"admin","addMenuLink"),this.menuLinks.push({text:e,url:t,capability:i||null})}getMenuLinks(){return this.reporting.trackApi(this.plugin,"admin","getMenuLinks"),this.menuLinks.slice(0)}}class v_{constructor(e,t,i){this.reporting=e,this.pluginsModel=t,this.plugin=i,this.reporting.trackApi(this.plugin,"annotation","constructor")}setCoverageProvider(e){this.reporting.trackApi(this.plugin,"annotation","setCoverageProvider"),this.pluginsModel.coverageRegister({pluginName:this.plugin.getPluginName(),provider:e})}addTokenHoverListener(e){this.reporting.trackApi(this.plugin,"annotation","addTokenHoverListener"),this.pluginsModel.tokenHoverListenerRegister({pluginName:this.plugin.getPluginName(),listener:e})}}class b_{constructor(e,t,i){this.reporting=e,this.plugin=t,this.element=i,this.reporting.trackApi(this.plugin,"event","constructor")}onTap(e){return this.reporting.trackApi(this.plugin,"event","onTap"),this.onClick(e)}onClick(e){return this.reporting.trackApi(this.plugin,"event","onClick"),this.listen(this.element,e)}listen(e,t){const i=e=>{const i=e.composedPath();if(i&&-1!==i.indexOf(this.element)){let i=!0;try{i=t(e)}catch(e){this.reporting.error("GrEventHelper",new Error("event listener callback error"),e)}!1===i&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())}};return e.addEventListener("click",i),()=>e.removeEventListener("click",i)}}class y_{constructor(e,t,i,r=""){this.restApi=e,this.reporting=t,this.plugin=i,this.prefix=r,this.reporting.trackApi(this.plugin,"rest","constructor")}getRequestOrigin(){return`plugin:${this.plugin.getPluginName()}`}getLoggedIn(){return this.reporting.trackApi(this.plugin,"rest","getLoggedIn"),this.restApi.getLoggedIn()}getVersion(){return this.reporting.trackApi(this.plugin,"rest","getVersion"),this.restApi.getVersion(this.getRequestOrigin())}getConfig(){return this.reporting.trackApi(this.plugin,"rest","getConfig"),this.restApi.getConfig(!1,this.getRequestOrigin())}invalidateReposCache(){this.reporting.trackApi(this.plugin,"rest","invalidateReposCache"),this.restApi.invalidateReposCache()}getAccount(){return this.reporting.trackApi(this.plugin,"rest","getAccount"),this.restApi.getAccount(this.getRequestOrigin())}getRepos(e,t,i){return this.reporting.trackApi(this.plugin,"rest","getRepos"),this.restApi.getRepos(e,t,i,void 0,this.getRequestOrigin())}fetch(e,t,i,r,o){return this.reporting.trackApi(this.plugin,"rest","fetch"),this.restApi.send(e,this.prefix+t,i,r,o,this.getRequestOrigin())}send(e,t,i,r,o){return this.reporting.trackApi(this.plugin,"rest","send"),this.fetch(e,t,i,r??Ff,o).then((e=>{if(!e)throw new Error("plugin rest-api call failed");return e.status<200||e.status>=300?async function(e){return await e.text()||`${e.status}`}(e).then((e=>Promise.reject(new Error(e)))):Df(e).then((e=>e.parsed))}))}get(e){return this.reporting.trackApi(this.plugin,"rest","get"),this.send(Uu.GET,e)}post(e,t,i,r){return this.reporting.trackApi(this.plugin,"rest","post"),this.send(Uu.POST,e,t,i,r)}put(e,t,i,r){return this.reporting.trackApi(this.plugin,"rest","put"),this.send(Uu.PUT,e,t,i,r)}delete(e){return this.reporting.trackApi(this.plugin,"rest","delete"),this.fetch(Uu.DELETE,e).then((e=>204!==e.status?e.text().then((t=>t?Promise.reject(new Error(t)):Promise.reject(new Error(`${e.status}`)))):e))}}var w_;!function(e){e.DECORATE="decorate",e.REPLACE="replace"}(w_||(w_={}));class __{constructor(){this._endpoints=new Map,this._callbacks=new Map,this._dynamicPlugins=new Map,this.pluginLoaded=!1}setPluginsReady(){this.pluginLoaded=!0}onNewEndpoint(e,t){this._callbacks.has(e)||this._callbacks.set(e,[]),this._callbacks.get(e).push(t)}onDetachedEndpoint(e,t){if(this._callbacks.has(e)){const i=this._callbacks.get(e).filter((e=>e!==t));this._callbacks.set(e,i)}}_getOrCreateModuleInfo(e,t){const{endpoint:i,slot:r,type:o,moduleName:s,domHook:n}=t,a=this._endpoints.get(i).find((t=>t.plugin===e&&t.moduleName===s&&t.domHook===n&&t.slot===r));if(a)return a;{const t={moduleName:s,plugin:e,pluginUrl:e._url,type:o,domHook:n,slot:r};return this._endpoints.get(i).push(t),t}}registerModule(e,t){const i=t.endpoint,r=t.dynamicEndpoint;r&&(this._dynamicPlugins.has(r)||this._dynamicPlugins.set(r,new Set),this._dynamicPlugins.get(r).add(i)),this._endpoints.has(i)||this._endpoints.set(i,[]);const o=this._getOrCreateModuleInfo(e,t);this.pluginLoaded&&this._callbacks.has(i)&&this._callbacks.get(i).forEach((e=>e(o)))}getDynamicEndpoints(e){const t=this._dynamicPlugins.get(e);return t?Array.from(t):[]}getDetails(e){return(this._endpoints.get(e)??[]).sort(((e,t)=>e.plugin.getPluginName().localeCompare(t.plugin.getPluginName())))}}class x_{constructor(e,t){this.reporting=e,this.plugin=t,this.reporting.trackApi(this.plugin,"reporting","constructor")}reportInteraction(e,t){this.reporting.trackApi(this.plugin,"reporting","reportInteraction"),this.reporting.reportPluginInteractionLog(`${this.plugin.getPluginName()}-${e}`,t)}reportLifeCycle(e,t){this.reporting.trackApi(this.plugin,"reporting","reportLifeCycle"),this.reporting.reportPluginLifeCycleLog(`${this.plugin.getPluginName()}-${e}`,t)}}const C_={fetchPollingIntervalSeconds:60};var E_,S_,$_;!function(e){e[e.NOT_REGISTERED=0]="NOT_REGISTERED",e[e.REGISTERED=1]="REGISTERED"}(E_||(E_={}));class k_{constructor(e,t,i){this.reporting=e,this.pluginsModel=t,this.plugin=i,this.state=E_.NOT_REGISTERED,this.reporting.trackApi(this.plugin,"checks","constructor")}announceUpdate(){this.reporting.trackApi(this.plugin,"checks","announceUpdate"),this.pluginsModel.checksAnnounce(this.plugin.getPluginName())}updateResult(e,t){if(void 0===t.externalId)throw new Error("ChecksApi.updateResult() was called without externalId");this.pluginsModel.checksUpdate({pluginName:this.plugin.getPluginName(),run:e,result:t})}register(e,t){if(this.reporting.trackApi(this.plugin,"checks","register"),this.state===E_.REGISTERED)throw new Error("Only one provider can be registered per plugin.");this.state=E_.REGISTERED,this.pluginsModel.checksRegister({pluginName:this.plugin.getPluginName(),provider:e,config:t??C_})}}class A_{constructor(e,t){this.reporting=e,this.plugin=t,this.reporting.trackApi(this.plugin,"style","constructor")}insertCSSRule(e){this.reporting.trackApi(this.plugin,"style","insertCSSRule");const t=function(){const e=document.head.querySelector("style#plugin-style");if(e)return e;const t=document.createElement("style");return t.setAttribute("id","plugin-style"),document.head.appendChild(t),t}();try{t.sheet?.insertRule(e)}catch(e){console.error(`Failed to insert CSS rule for plugin ${this.plugin.getPluginName()}: ${e}`)}}}!function(e){e[e.NOT_REGISTERED=0]="NOT_REGISTERED",e[e.REGISTERED=1]="REGISTERED"}(S_||(S_={}));class R_{constructor(e,t,i){this.reporting=e,this.pluginsModel=t,this.plugin=i,this.state=S_.NOT_REGISTERED,this.reporting.trackApi(this.plugin,"suggestions","constructor")}register(e){if(this.reporting.trackApi(this.plugin,"suggestions","register"),this.state===S_.REGISTERED)throw new Error("Only one provider can be registered per plugin.");this.state=S_.REGISTERED,this.pluginsModel.suggestionsRegister({pluginName:this.plugin.getPluginName(),provider:e})}}!function(e){e[e.NOT_REGISTERED=0]="NOT_REGISTERED",e[e.REGISTERED=1]="REGISTERED"}($_||($_={}));class T_{constructor(e,t){this.pluginsModel=e,this.plugin=t,this.state=$_.NOT_REGISTERED}register(e){if(this.state===$_.REGISTERED)throw new Error("Only one publisher can be registered per plugin.");this.state=$_.REGISTERED,this.pluginsModel.changeUpdatesRegister({pluginName:this.plugin.getPluginName(),publisher:e})}}class I_{constructor(e,t,i,r,o,s){if(this.jsApi=t,this.report=i,this.restApiService=r,this.pluginsModel=o,this.pluginEndpoints=s,this._name="NULL",this.domHooks=new h_(this),!e)return this.report.error("Plugin constructor",new Error("Plugin not being loaded from /plugins base path. Unable to determine name.")),this;this._url=new URL(e),this._name=s_(this._url)??"NULL",this.report.trackApi(this,"plugin","constructor")}getPluginName(){return this._name}registerCustomComponent(e,t,i){return this.report.trackApi(this,"plugin","registerCustomComponent"),this._registerCustomComponent(e,t,i)}registerDynamicCustomComponent(e,t,i){this.report.trackApi(this,"plugin","registerDynamicCustomComponent");const r=`${e}-${this.getPluginName()}`;return this._registerCustomComponent(r,t,i,e)}_registerCustomComponent(e,t,i,r){const o=i?.replace?w_.REPLACE:w_.DECORATE,s=i?.slot??"",n=this.domHooks.getDomHook(e,t);return t=t||n.getModuleName(),this.pluginEndpoints.registerModule(this,{slot:s,endpoint:e,type:o,moduleName:t,domHook:n,dynamicEndpoint:r}),n}hook(e,t){return this.report.trackApi(this,"plugin","hook"),this.registerCustomComponent(e,void 0,t)}getServerInfo(){return this.report.trackApi(this,"plugin","getServerInfo"),this.restApiService.getConfig()}on(e,t){this.report.trackApi(this,"plugin","on"),this.jsApi.addEventCallback(e,t)}url(e){if(this.report.trackApi(this,"plugin","url"),!this._url)throw new Error("plugin url not set");const t="/plugins/"+this._name+(e||"/"),i=window.location.origin+`${Sf()}${t}`;return window.location.origin===this._url.origin?i:this._url.href.split("/plugins/"+this._name)[0]+t}screenUrl(e){this.report.trackApi(this,"plugin","screenUrl");const t=e?"/"+e:"";return`${location.origin}${Sf()}/x/${this.getPluginName()}${t}`}annotationApi(){return new v_(this.report,this.pluginsModel,this)}changeActions(){return new d_(this,this.jsApi,this.jsApi.getElement(a_.CHANGE_ACTIONS))}changeReply(){return new c_(this,this.jsApi)}checks(){return new k_(this.report,this.pluginsModel,this)}changeUpdates(){return new T_(this.pluginsModel,this)}suggestions(){return new R_(this.report,this.pluginsModel,this)}reporting(){return new x_(this.report,this)}styleApi(){return new A_(this.report,this)}admin(){return new f_(this.report,this)}restApi(e){return new y_(this.restApiService,this.report,this,e)}attributeHelper(e){return new n_(this.report,this,e)}eventHelper(e){return new b_(this.report,this,e)}popup(e){return void 0!==e&&"string"!=typeof e?(console.error(".popup(element) deprecated, use .popup(moduleName)!"),Promise.resolve(null)):new m_(this,e).open()}screen(e,t){if(this.report.trackApi(this,"plugin","screen"),!t||"string"==typeof t)return this.registerCustomComponent(this._getScreenName(e),t);console.error(".screen(pattern, callback) deprecated, use .screen(screenName, moduleName)!")}_getScreenName(e){return this.report.trackApi(this,"plugin","_getScreenName"),`${this.getPluginName()}-screen-${e}`}}class P_ extends df{constructor(){super({pluginsLoaded:!1,coveragePlugins:[],changeUpdatesPlugins:[],checksPlugins:[],suggestionsPlugins:[],tokenHighlightPlugins:[]}),this.checksAnnounceSubject$=new Dp,this.checksAnnounce$=this.checksAnnounceSubject$.asObservable(),this.checksUpdateSubject$=new Dp,this.checksUpdate$=this.checksUpdateSubject$.asObservable(),this.checksPlugins$=lf(this.state$,(e=>e.checksPlugins)),this.coveragePlugins$=lf(this.state$,(e=>e.coveragePlugins)),this.changeUpdatesPlugins$=lf(this.state$,(e=>e.changeUpdatesPlugins)),this.suggestionsPlugins$=lf(this.state$,(e=>e.suggestionsPlugins)),this.pluginsLoaded$=lf(this.state$,(e=>e.pluginsLoaded))}coverageRegister(e){const t={...this.getState()};t.coveragePlugins=[...t.coveragePlugins];const i=t.coveragePlugins.some((t=>t.pluginName===e.pluginName));i?console.warn(`${e.pluginName} tried to register twice as a coverage provider. Ignored.`):(t.coveragePlugins.push(e),this.setState(t))}getChangeUpdatesPlugins(){return this.getState().changeUpdatesPlugins}changeUpdatesRegister(e){const t={...this.getState()};t.changeUpdatesPlugins=[...t.changeUpdatesPlugins];const i=t.changeUpdatesPlugins.some((t=>t.pluginName===e.pluginName));i?console.warn(`${e.pluginName} tried to register twice as a change updates provider. Ignored.`):(t.changeUpdatesPlugins.push(e),this.setState(t))}checksRegister(e){const t={...this.getState()};t.checksPlugins=[...t.checksPlugins];const i=t.checksPlugins.some((t=>t.pluginName===e.pluginName));i?console.warn(`${e.pluginName} tried to register twice as a checks provider. Ignored.`):(t.checksPlugins.push(e),this.setState(t))}suggestionsRegister(e){const t={...this.getState()};t.suggestionsPlugins=[...t.suggestionsPlugins];const i=t.suggestionsPlugins.some((t=>t.pluginName===e.pluginName));i?console.warn(`${e.pluginName} tried to register twice as a suggestion provider. Ignored.`):(t.suggestionsPlugins.push(e),this.setState(t))}tokenHoverListenerRegister(e){const t={...this.getState()};t.tokenHighlightPlugins=[...t.tokenHighlightPlugins];const i=t.tokenHighlightPlugins.some((t=>t.pluginName===e.pluginName));i?console.warn(`${e.pluginName} tried to register twice as a hover callback. Ignored.`):(t.tokenHighlightPlugins.push(e),this.setState(t))}checksUpdate(e){const t=this.getState().checksPlugins.find((t=>t.pluginName===e.pluginName));t?this.checksUpdateSubject$.next(e):console.warn(`Plugin '${e.pluginName}' not found. checksUpdate() ignored.`)}checksAnnounce(e){const t=this.getState().checksPlugins.find((t=>t.pluginName===e));t?this.checksAnnounceSubject$.next(t):console.warn(`Plugin '${e}' not found. checksAnnounce() ignored.`)}}const N_=Sd`
  :host {
    display: block;
  }
  .main {
    margin: var(--spacing-xxl) auto;
    max-width: 50em;
  }
  .mainHeader {
    margin-left: 14em;
    padding: var(--spacing-l) 0 var(--spacing-l) var(--spacing-xxl);
  }
  .main.table,
  .mainHeader {
    margin-top: 0;
    margin-right: 0;
    margin-left: 14em;
    max-width: none;
  }
  h2.edited:after {
    color: var(--deemphasized-text-color);
    content: ' *';
  }
  .loading {
    color: var(--deemphasized-text-color);
    padding: var(--spacing-l);
  }
  @media only screen and (max-width: 70em) {
    .main {
      margin: var(--spacing-xxl) 0 var(--spacing-xxl) 15em;
    }
    .main.table {
      margin-left: 14em;
    }
  }
  @media only screen and (max-width: 53em) {
    .loading {
      padding: 0 var(--spacing-l);
    }
    .main {
      margin: var(--spacing-xxl) var(--spacing-l);
    }
    .main.table {
      margin: 0;
    }
    .mainHeader {
      margin-left: 0;
      padding: var(--spacing-m) 0 var(--spacing-m) var(--spacing-l);
    }
  }
`,O_=document.createElement("template");O_.innerHTML=`\n  <dom-module id="gr-menu-page-styles">\n    <template>\n      <style>\n      ${N_.cssText}\n      </style>\n    </template>\n  </dom-module>\n`,document.head.appendChild(O_.content);const D_={},L_={};class M_{constructor(e,t){this.waitForPluginsToLoad=e,this.reporting=t}finalize(){}addElement(e,t){D_[e]=t}getElement(e){return D_[e]}addEventCallback(e,t){L_[e]||(L_[e]=[]),L_[e].push(t)}canSubmitChange(e,t){return!this._getEventCallbacks(l_.SUBMIT_CHANGE).some((i=>{try{return!1===i(e,t)}catch(e){this.reportError(e,l_.SUBMIT_CHANGE)}return!1}))}async handleBeforeChangeAction(e,t){let i=!0;for(const r of this._getEventCallbacks(l_.BEFORE_CHANGE_ACTION))try{i=await r(e,t)&&i}catch(e){this.reportError(e,l_.BEFORE_CHANGE_ACTION)}return i}handlePublishEdit(e,t){for(const i of this._getEventCallbacks(l_.PUBLISH_EDIT))try{i(e,t)}catch(e){this.reportError(e,l_.PUBLISH_EDIT)}}_removeEventCallbacks(){for(const e of Object.values(l_))L_[e]=[]}async handleViewChange(e){await this.waitForPluginsToLoad();for(const t of this._getEventCallbacks(l_.VIEW_CHANGE))try{t(e)}catch(e){this.reportError(e,l_.VIEW_CHANGE)}}async handleShowChange(e){if(!e.change)return;await this.waitForPluginsToLoad();const t={...e.change,get mergeable(){return console.warn("Accessing change.mergeable from SHOW_CHANGE is deprecated! Use info.mergeable instead."),e.info&&e.info.mergeable}},{patchNum:i,info:r,basePatchNum:o}=e;let s,n;for(const e of Object.values(t.revisions||{}))e._number===i&&(s=e),e._number===o&&(n=e);for(const e of this._getEventCallbacks(l_.SHOW_CHANGE))try{e(t,s,r,n??Qu)}catch(e){this.reportError(e,l_.SHOW_CHANGE)}}async handleBeforeReplySent(e,t){await this.waitForPluginsToLoad();let i=!0;for(const r of this._getEventCallbacks(l_.BEFORE_REPLY_SENT))try{i=await r(e,t)&&i}catch(e){this.reportError(e,l_.BEFORE_REPLY_SENT)}return i}async handleReplySent(){await this.waitForPluginsToLoad();for(const e of this._getEventCallbacks(l_.REPLY_SENT))try{e()}catch(e){this.reportError(e,l_.REPLY_SENT)}}async handleShowRevisionActions(e){await this.waitForPluginsToLoad();const t=this._getEventCallbacks(l_.SHOW_REVISION_ACTIONS);for(const i of t)try{i(e.revisionActions,e.change)}catch(e){this.reportError(e,l_.SHOW_REVISION_ACTIONS)}}async handleBeforeCommitMessage(e,t){let i=!0;for(const r of this._getEventCallbacks(l_.BEFORE_COMMIT_MSG_EDIT))try{i=await r(e,t)&&i}catch(e){this.reportError(e,l_.BEFORE_COMMIT_MSG_EDIT)}return i}handleCommitMessage(e,t){for(const i of this._getEventCallbacks(l_.COMMIT_MSG_EDIT))try{i(e,t)}catch(e){this.reportError(e,l_.COMMIT_MSG_EDIT)}}async handleLabelChange(e){await this.waitForPluginsToLoad();for(const t of this._getEventCallbacks(l_.LABEL_CHANGE))try{t(e.change)}catch(e){this.reportError(e,l_.LABEL_CHANGE)}}modifyEmojis(e){for(const t of this._getEventCallbacks(l_.CUSTOM_EMOJIS))try{e=t(e)}catch(e){this.reportError(e,l_.CUSTOM_EMOJIS)}return e}modifyRevertMsg(e,t,i){for(const r of this._getEventCallbacks(l_.REVERT))try{t=r(e,t,i)}catch(e){this.reportError(e,l_.REVERT)}return t}modifyRevertSubmissionMsg(e,t,i){for(const r of this._getEventCallbacks(l_.REVERT_SUBMISSION))try{t=r(e,t,i)}catch(e){this.reportError(e,l_.REVERT_SUBMISSION)}return t}getAdminMenuLinks(){const e=[];for(const t of this._getEventCallbacks(l_.ADMIN_MENU_LINKS)){const i=t;e.push(...i.getMenuLinks())}return e}getReviewPostRevert(e){let t={};for(const i of this._getEventCallbacks(l_.POST_REVERT))try{const r=i(e);t=ma(r,"labels")?r:{labels:r}}catch(e){this.reportError(e,l_.POST_REVERT)}return t}async handleShowDiff(e){await this.waitForPluginsToLoad();for(const t of this._getEventCallbacks(l_.SHOW_DIFF))try{t(e.change,e.patchRange,e.fileRange)}catch(e){this.reportError(e,l_.SHOW_DIFF)}}reportError(e,t){this.reporting.error("GrJsApiInterface",new Error(`plugin event callback error for type "${t}"`),e)}_getEventCallbacks(e){return L_[e]||[]}}var F_;!function(e){e.PENDING="PENDING",e.LOADED="LOADED",e.LOAD_FAILED="LOAD_FAILED"}(F_||(F_={}));const U_=mu("plugin-loader");class B_{constructor(e,t){this.reportingService=e,this.restApiService=t,this.styles={font:Qb,form:my,material:Jy,menuPage:N_,spinner:Yc,subPage:Kw,table:pw,modal:Iw},this.pluginListLoaded=!1,this.plugins=new Map,this.loadingPromise=null,this.loadingResolver=null,this.jsApiService=new M_((()=>this.awaitPluginsLoaded()),this.reportingService),this.pluginsModel=new P_,this.awaitPluginsLoaded().finally((()=>{this.pluginsModel.updateState({pluginsLoaded:!0})})),this.pluginEndPoints=new __}finalize(){}getPluginKeyFromUrl(e){return s_(e)||`__$$__${e}`}loadPlugins(e=[],t){this.instanceId=t,this.pluginListLoaded=!0,e.forEach((e=>{const t=this.urlFor(e,window.ASSETS_PATH),i=this.getPluginKeyFromUrl(t);this.plugins.has(i)||(this.plugins.set(i,{name:i,url:t,state:F_.PENDING,plugin:null}),this.isPathEndsWith(t,".js")?this.loadJsPlugin(e):this.failToLoad(`Unrecognized plugin path ${e}`,e))})),this.awaitPluginsLoaded().then((()=>{const e=this.getPluginsByState(F_.LOADED),t=this.getPluginsByState(F_.LOAD_FAILED);this.reportingService.pluginsLoaded(e.map((e=>e.name))),this.reportingService.pluginsFailed(t.map((e=>e.name)))}))}isPathEndsWith(e,t){if(!(e instanceof URL))try{e=new URL(e)}catch(e){return this.reportingService.error("GrPluginLoader",new Error("url parse error"),e),!1}return e.pathname&&e.pathname.endsWith(t)}getPluginsByState(e){return[...this.plugins.values()].filter((t=>t.state===e))}install(e,t,i){const r=document.currentScript,o=r?.__importElement??r;if(!i&&o&&o.src&&(i=o.src),(!i||i.startsWith("data:"))&&o&&o.baseURI&&(i=o&&o.baseURI),!i)return void this.failToLoad("Failed to determine src.");if(t&&"0.1"!==t)return void this.failToLoad(`Plugin ${i} install error: only version 0.1 is supported in PolyGerrit. ${t} was given.`,i);const s=this.urlFor(i),n=this.getPlugin(s);let a=n&&n.plugin;a||(a=new I_(s,this.jsApiService,this.reportingService,this.restApiService,this.pluginsModel,this.pluginEndPoints));try{e(a),this.pluginInstalled(s,a)}catch(e){e instanceof Error?this.failToLoad(`${e.name}: ${e.message}`,i):this.reportingService.error("GrPluginLoader",new Error("plugin callback error"),e)}}arePluginsLoaded(){return!!this.pluginListLoaded&&0===this.getPluginsByState(F_.PENDING).length}checkIfCompleted(){this.arePluginsLoaded()&&(this.pluginEndPoints.setPluginsReady(),this.loadingResolver&&(this.loadingResolver(),this.loadingResolver=null,this.loadingPromise=null))}timeout(){const e=this.getPluginsByState(F_.PENDING);for(const t of e)this.updatePluginState(t.url,F_.LOAD_FAILED);this.checkIfCompleted();const t=`Timeout when loading plugins: ${e.map((e=>e.name)).join(",")}`;return ea(document,t),t}failToLoad(e,t){ea(document,`Plugin install error: ${e} from ${t}`),t&&this.updatePluginState(t,F_.LOAD_FAILED),this.checkIfCompleted()}updatePluginState(e,t){const i=this.getPluginKeyFromUrl(e);return this.plugins.has(i)?this.plugins.get(i).state=t:(console.info(`Plugin loaded separately: ${e}`),this.plugins.set(i,{name:i,url:e,state:t,plugin:null})),console.debug(`Plugin ${i} ${t}`),this.plugins.get(i)}pluginInstalled(e,t){this.updatePluginState(e,F_.LOADED).plugin=t,this.reportingService.pluginLoaded(t.getPluginName()||e),this.checkIfCompleted()}isPluginEnabled(e){const t=this.urlFor(e),i=this.getPluginKeyFromUrl(t);return this.plugins.has(i)}getPlugin(e){const t=this.urlFor(e),i=this.getPluginKeyFromUrl(t);return this.plugins.get(i)}isPluginLoaded(e){const t=this.urlFor(e),i=this.getPluginKeyFromUrl(t);return!!this.plugins.has(i)&&this.plugins.get(i).state===F_.LOADED}loadJsPlugin(e){const t=this.urlFor(e,window.ASSETS_PATH),i=this.urlFor(e);let r;t!==i&&(r=()=>this.createScriptTag(i)),this.createScriptTag(t,r)}createScriptTag(e,t){t||(t=()=>this.failToLoad(`${e} load error`,e));const i=document.createElement("script");return i.defer=!0,i.setAttribute("src",e),i.setAttribute("crossorigin","anonymous"),i.onerror=t,document.body.appendChild(i)}urlFor(e,t){return o_(e)?t&&this.instanceId?`${t}/hosts/${this.instanceId}${r_}`:window.location.origin+Sf()+r_:e.startsWith("http")?e.includes(location.host)&&t?e.replace(location.origin,t):e:(e.startsWith("/")||(e="/"+e),t?t+e:window.location.origin+Sf()+e)}awaitPluginsLoaded(){if(this.checkIfCompleted(),this.arePluginsLoaded())return Promise.resolve();if(!this.loadingPromise){let e;this.loadingPromise=Promise.race([new Promise((e=>this.loadingResolver=e)),new Promise(((t,i)=>e=window.setTimeout((()=>{i(new Error(this.timeout()))}),1e4)))]).finally((()=>{e&&clearTimeout(e)}))}return this.loadingPromise}}var H_=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let j_=class extends Ic{constructor(){super(...arguments),this.imageSize=16,this.hasAvatars=!1,this.restApiService=Xn().restApiService,this.getPluginLoader=yu(this,U_)}static get styles(){return[Sd`
        :host([hidden]) {
          display: none;
        }
        :host {
          display: inline-block;
          border-radius: 50%;
          background-size: cover;
          background-color: var(
            --avatar-background-color,
            var(--gray-background)
          );
        }
      `]}render(){return this.updateHostVisibilityAndImage(),dc``}connectedCallback(){super.connectedCallback(),Promise.all([this.restApiService.getConfig(),this.getPluginLoader().awaitPluginsLoaded()]).then((([e])=>{this.hasAvatars=Boolean(e?.plugin?.has_avatars),this.updateHostVisibilityAndImage()}))}updateHostVisibilityAndImage(){if(!this.hasAvatars||!this.account)return void(this.hidden=!0);this.hidden=!1;const e=this.buildAvatarURL(this.account);this.style.backgroundImage=e?`url("${e}")`:""}getAccounts(e){return e._account_id||e.email||e.username||e.name}buildAvatarURL(e){if(!e)return"";const t=e.avatars||[];if(0===t.length)return"";for(let e=0;e<t.length;e++)if(t[e].height===this.imageSize)return t[e].url;const i=this.getAccounts(e);return i?`${Sf()}/accounts/${encodeURIComponent(i)}/avatar?s=${this.imageSize}`:""}};H_([Fc({type:Object})],j_.prototype,"account",void 0),H_([Fc({type:Number})],j_.prototype,"imageSize",void 0),H_([Uc()],j_.prototype,"hasAvatars",void 0),j_=H_([Dc("gr-avatar")],j_);var G_=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let z_=class extends Ic{constructor(){super(...arguments),this.domHooks=new Map,this.initializedPlugins=new Map,this.reporting=Xn().reportingService,this.getPluginLoader=yu(this,U_),this.initModule=({moduleName:e,plugin:t,type:i,domHook:r,slot:o})=>{const s=t.getPluginName()+"."+e;if(this.targetPlugin&&this.targetPlugin!==t.getPluginName())return;if(this.initializedPlugins.get(s))return;let n;switch(i){case w_.DECORATE:n=this.initDecoration(e,t,o);break;case w_.REPLACE:n=this.initReplacement(e,t)}if(!n)throw Error(`unknown endpoint type ${i} used by plugin ${s}`);this.initializedPlugins.set(s,!0),n.then((e=>{r&&(r.handleInstanceAttached(e),this.domHooks.set(e,r))}))}}render(){return dc`<slot></slot>`}connectedCallback(){super.connectedCallback(),ba(this.name),this.getPluginLoader().pluginEndPoints.onNewEndpoint(this.name,this.initModule),this.getPluginLoader().awaitPluginsLoaded().then((()=>{ba(this.name);const e=this.getPluginLoader().pluginEndPoints.getDetails(this.name);for(const t of e)this.initModule(t)}))}disconnectedCallback(){for(const[e,t]of this.domHooks)t.handleInstanceDetached(e);ba(this.name),this.getPluginLoader().pluginEndPoints.onDetachedEndpoint(this.name,this.initModule),super.disconnectedCallback()}initDecoration(e,t,i){const r=document.createElement(e);return this.initProperties(r,t,this.firstElementChild).then((e=>{const t=i?this.querySelector(`gr-endpoint-slot[name=${i}]`):null;return i&&t?.parentNode?t.parentNode.insertBefore(e,t.nextSibling):this.appendChild(e),e}))}initReplacement(e,t){[...this.childNodes,...this.shadowRoot?.childNodes??[]].filter((e=>"GR-ENDPOINT-PARAM"!==e.nodeName)).filter((e=>"SLOT"!==e.nodeName)).forEach((e=>e.remove()));const i=document.createElement(e);return this.initProperties(i,t).then((e=>this.appendChild(e)))}getEndpointParams(){return Array.from(this.querySelectorAll("gr-endpoint-param"))}initProperties(e,t,i){const r=t.getPluginName();e.plugin=t,i&&(e.content=i);const o=this.getEndpointParams().map((i=>{const o=t.attributeHelper(i),s=i.name;if(s)return o.get("value").then((()=>o.bind("value",(i=>t.attributeHelper(e).set(s,i)))));this.reporting.error(`Plugin '${r}', endpoint '${this.name}'`,new Error(`Plugin '${r}', endpoint '${this.name}': param is missing a name.`))}));let s;const n=new Promise((()=>s=window.setTimeout((()=>{this.reporting.error(`Plugin '${r}', endpoint '${this.name}'`,new Error(`Plugin ${r}, endpoint ${this.name}: Timeout waiting for endpoint properties initialization`))}),1e4)));return Promise.race([n,Promise.all(o)]).then((()=>e)).finally((()=>{s&&clearTimeout(s)}))}};G_([Fc({type:String})],z_.prototype,"targetPlugin",void 0),G_([Fc({type:String})],z_.prototype,"name",void 0),z_=G_([Dc("gr-endpoint-decorator")],z_);var V_=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let W_=class extends Ic{constructor(){super(...arguments),this.name=""}willUpdate(e){e.has("value")&&Zn(this,"value-changed",{value:this.value})}};V_([Fc({type:String,reflect:!0})],W_.prototype,"name",void 0),V_([Fc({type:Object})],W_.prototype,"value",void 0),W_=V_([Dc("gr-endpoint-param")],W_);const q_=Sd`
  :host {
    position: absolute;
    display: none;
    z-index: 200;
    max-width: 600px;
    outline: none;
  }
  :host(.hovered) {
    display: block;
  }
  :host(.hide) {
    visibility: hidden;
  }
  /* You have to use a <div class="container"> in your hovercard in order
      to pick up this consistent styling. */
  #container {
    background: var(--dialog-background-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    box-shadow: var(--elevation-level-5);
  }
`,K_=document.createElement("template");K_.innerHTML=`<dom-module id="gr-hovercard-styles">\n  <template>\n    <style>\n    ${q_.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(K_.content);const Y_='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';function*X_(e){const t=window.getComputedStyle(e);if("none"===t.display||"hidden"===t.visibility)return;e.matches(Y_)&&(yield e);let i=[];i="slot"===e.localName?e.assignedNodes({flatten:!0}):[...(e.shadowRoot||e).children];for(const e of i.filter((e=>e instanceof HTMLElement||e instanceof SVGElement)))yield*X_(e)}function*J_(e){const t=window.getComputedStyle(e);if("none"===t.display||"hidden"===t.visibility)return;let i=[];i="slot"===e.localName?e.assignedNodes({flatten:!0}):[...(e.shadowRoot||e).children];for(const e of i.filter((e=>e instanceof HTMLElement||e instanceof SVGElement)).reverse())yield*J_(e);e.matches(Y_)&&(yield e)}var Q_=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const Z_="hovered",ex="hide",tx="gr-hovercard-container",ix=e=>{class t extends e{static get styles(){return[Nc,q_]}constructor(...e){super(...e),this._target=null,this._isShowing=!1,this.offset=14,this.position="right",this.container=null,this.openedByKeyboard=!1,this.reporting=Xn().reportingService,this.targetCleanups=[],this.cleanups=[],this.reload=()=>{this.dispatchEventThroughTarget("reload")},this.mouseDebounceHide=e=>{this.debounceHide({mouseEvent:e})},this.mouseDebounceShow=e=>{this.debounceShow({mouseEvent:e})},this.mouseHide=e=>{this.hide({mouseEvent:e})},this.mouseShow=e=>{this.show({mouseEvent:e})},this.focusDebounceHide=e=>{this.debounceHide({focusEvent:e})},this.debounceHide=e=>{this.cancelShowTask(),this._isShowing&&!this.isScheduledToHide&&(this.isScheduledToHide=!0,this.hideTask=ny(this.hideTask,(()=>{this.isScheduledToHide&&this.hide(e)}),500))},this.documentClickListener=e=>{e.target&&An(e.target)&&(this.contains(e.target)||this.forceHide())},this.containerClickListener=e=>{e.stopPropagation()},this.resolveDep=e=>{this._target?.dispatchEvent(new wu(e.dependency,e.callback))},this.forceHide=()=>{this.hide({keyboardEvent:new KeyboardEvent("enter")})},this.hide=e=>{if(this.cancelHideTask(),this.cancelShowTask(),this._isShowing&&(e?.keyboardEvent||!this.openedByKeyboard)){if(e?.mouseEvent){const t=e.mouseEvent;if(t.relatedTarget===this||t.target===this&&t.relatedTarget===this._target)return}this.openedByKeyboard&&this._target&&this._target.focus(),this.openedByKeyboard=!1,this._isShowing=!1,this.classList.remove(Z_),this.style.cssText="",this.topElement?.setAttribute("tabindex","-1"),this.container?.contains(this)&&this.container.removeChild(this),document.removeEventListener("click",this.documentClickListener),this.container?.removeEventListener("click",this.containerClickListener),this.reportingTimer?.end({targetId:this._target?.id,tagName:this.tagName})}},this.debounceShow=e=>{this.debounceShowBy(550,e)},this.show=async e=>{this.cancelHideTask(),this.cancelShowTask(),this.openedByKeyboard=this.openedByKeyboard||!!e?.keyboardEvent,!this._isShowing&&this.container&&(this._isShowing=!0,this.container.appendChild(this),this.classList.add(ex),this.classList.add(Z_),await new Promise((e=>{setTimeout(e,0)})),this.updatePosition(),this.classList.remove(ex),e?.keyboardEvent&&this.focus(),this.container.addEventListener("click",this.containerClickListener),document.addEventListener("click",this.documentClickListener),this.reportingTimer=this.reporting.getTimer("Show Hovercard"))},this.addEventListener("mouseenter",this.mouseShow),this.addEventListener("mouseleave",this.mouseHide),new Gg(this).addGlobal({key:Mn.ESC},(e=>this.hide({keyboardEvent:e})))}connectedCallback(){super.connectedCallback(),this._target||(this._target=this.target,this.addTargetEventListeners()),this.container=this.getContainer(),this.cleanups.push(jn(this,{key:Mn.TAB},(e=>{this.pressTab(e)}),{preventDefault:!1})),this.cleanups.push(jn(this,{key:Mn.TAB,modifiers:[Fn.SHIFT_KEY]},(e=>{this.pressShiftTab(e)}),{preventDefault:!1}))}disconnectedCallback(){this.cancelShowTask(),this.cancelHideTask();for(const e of this.cleanups)e();this.cleanups=[],super.disconnectedCallback()}addTargetEventListeners(){this._target?.addEventListener("mousemove",this.mouseDebounceShow),this._target?.addEventListener("mouseleave",this.mouseDebounceHide),this._target?.addEventListener("blur",this.focusDebounceHide),this._target?.addEventListener("click",this.mouseHide),this._target&&(this.targetCleanups.push(jn(this._target,{key:Mn.ENTER},(e=>{this.show({keyboardEvent:e})}))),this.targetCleanups.push(jn(this._target,{key:Mn.SPACE},(e=>{this.show({keyboardEvent:e})})))),this.addEventListener("request-dependency",this.resolveDep),this.addEventListener("reload",this.reload)}removeTargetEventListeners(){this._target?.removeEventListener("mousemove",this.mouseDebounceShow),this._target?.removeEventListener("mouseleave",this.mouseDebounceHide),this._target?.removeEventListener("blur",this.focusDebounceHide),this._target?.removeEventListener("click",this.mouseHide);for(const e of this.targetCleanups)e();this.targetCleanups=[],this.removeEventListener("request-dependency",this.resolveDep),this.removeEventListener("reload",this.reload)}updated(e){super.updated(e),e.has("for")&&(this.removeTargetEventListeners(),this._target=this.target,this.addTargetEventListeners())}cancelHideTask(){this.hideTask&&(this.hideTask.cancel(),this.isScheduledToHide=!1,this.hideTask=void 0)}dispatchEventThroughTarget(e,t){t||(t={}),this._target&&this._target.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))}getHost(){let e=this._target;for(;e;){if("DIALOG"===e.tagName)return e;e=e.parentNode||e.host}return document.body}getContainer(){const e=this.getHost();let t=e.querySelector(`#${tx}`);return t||(t=document.createElement("div"),t.setAttribute("id",tx),e.appendChild(t)),t}get target(){const e=this.parentNode,t=this.getRootNode();let i;return i=this.for?t.querySelector("#"+this.for):e&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE?e:t.host,i}debounceShowBy(e,t){this.cancelHideTask(),this._isShowing||this.isScheduledToShow||(this.isScheduledToShow=!0,this.showTask=ny(this.showTask,(()=>{this.isScheduledToShow&&this.show(t)}),e))}focus(e){const t=X_(this).next();t.done||t.value.focus(e)}pressTab(e){const t=On(document),i=J_(this).next();i.done||t!==i.value||(e.preventDefault(),this.forceHide())}pressShiftTab(e){const t=On(document),i=X_(this).next();i.done||t!==i.value||(e.preventDefault(),this.forceHide())}cancelShowTask(){this.showTask&&(this.showTask.cancel(),this.isScheduledToShow=!1,this.showTask=void 0)}updatePosition(){const e=new Set([this.position,"right","bottom-right","top-right","bottom","top","bottom-left","top-left","left"]);for(const t of e)if(this.updatePositionTo(t),this._isInsideViewport())return;this.updatePositionTo(this.position)}_isInsideViewport(){const e=this.getBoundingClientRect(),t=this.getHost().getBoundingClientRect();return!(e.top<t.top||e.left<t.left||e.bottom>t.bottom||e.right>t.right)}updatePositionTo(e){if(!this._target)return;this.style.cssText="";const t=this.getHost().getBoundingClientRect(),i=this._target.getBoundingClientRect(),r=this.getBoundingClientRect(),o=i.left-t.left,s=i.top-t.top;let n,a;switch(e){case"top":n=o+(i.width-r.width)/2,a=s-r.height-this.offset;break;case"bottom":n=o+(i.width-r.width)/2,a=s+i.height+this.offset;break;case"left":n=o-r.width-this.offset,a=s+(i.height-r.height)/2;break;case"right":n=o+i.width+this.offset,a=s+(i.height-r.height)/2;break;case"bottom-right":n=o+i.width+this.offset,a=s;break;case"bottom-left":n=o-r.width-this.offset,a=s;break;case"top-left":n=o-r.width-this.offset,a=s+i.height-r.height;break;case"top-right":n=o+i.width+this.offset,a=s+i.height-r.height}this.style.left=`${n}px`,this.style.top=`${a}px`}}return Q_([Hc("#container")],t.prototype,"topElement",void 0),Q_([Fc({type:Object})],t.prototype,"_target",void 0),Q_([Fc({type:Boolean})],t.prototype,"_isShowing",void 0),Q_([Fc({type:String})],t.prototype,"for",void 0),Q_([Fc({type:Number})],t.prototype,"offset",void 0),Q_([Fc({type:String})],t.prototype,"position",void 0),Q_([Fc({type:Object})],t.prototype,"container",void 0),t};function rx(e,t){return t?.name?t.name:t?.username?t.username:t?.email?t.email:e&&e.user&&"Anonymous Coward"!==e.user.anonymous_coward_name?e.user.anonymous_coward_name:"Anonymous"}function ox(e,t,i=!1){if(t?.display_name)return t.display_name;if(!t||!t.name)return rx(e,t);const r=e?.accounts?.default_display_name;return i||r===Du.FIRST_NAME?t.name.trim().split(" ")[0]:r===Du.USERNAME&&t.username?t.username:t.name}function sx(e,t){return[ox(e,t),nx(t.email),t.status?"("+t.status+")":""].filter((e=>e.length>0)).join(" ")}function nx(e){return void 0!==e?"<"+e+">":""}const ax=/(?:^|\s)@([a-zA-Z0-9.!#$%&'*+=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)(?=\s+|$)/g;function lx(e){if(void 0!==e._account_id)return e._account_id;if(e.email)return e.email;throw new Error("Account has neither _account_id nor email.")}function dx(e){return!!e?.tags?.includes(sg.SERVICE_USER)}function cx(e,t){return e?._account_id===t?._account_id}function hx(e){return e?.filter((e=>!dx(e)))||[]}function px(e){return gf(e)?lx(e):mf(e)?e.id:void fa(e,"entry must be account or group")}function ux(e,t,i){return!(!i||!t)&&![...i.reviewers[t]??[]].some((t=>px(t)===px(e)))}function gx(e,t,i){return t===i.findIndex((t=>function(e,t){return e?.avatars?.[0]?.url===t?.avatars?.[0]?.url}(e,t)))}function mx(e,t,i){return t===i.findIndex((t=>e._account_id===t._account_id))}function fx(e){return!(!e?.email&&!e?.name||!e?._account_id)}function vx(e,t){return e?._account_id?`<GERRIT_ACCOUNT_${e._account_id}>`:ox(t)}function bx(e,t,i){return e.replace(new RegExp("<GERRIT_ACCOUNT_(\\d+)>","g"),((e,r)=>{const o=Number(r),s=(t||[]).find((e=>e._account_id===o));return s?ox(i,s):`Gerrit Account ${o}`}))}const yx=(e,t,i)=>{if(!e?.labels)return NaN;const r=e.labels[i];if(!Xu(r)||!r.all)return NaN;const o=pv(r,t);return o?ma(o,"permitted_voting_range")?o.permitted_voting_range?o.permitted_voting_range.max:NaN:ma(o,"value")?0:NaN:NaN},wx=(e,t)=>{const i=e.permitted_labels?.[t];return i?Number(i[i.length-1]):0};function _x(e){if(!e)return[];let t;const i=[];for(;t=ax.exec(e);)i.push({email:t[1]});return i}function xx(e,t){if(gf(e))return{reviewer:lx(e),state:t,...e.confirmed&&{confirmed:e.confirmed}};if(mf(e))return{reviewer:decodeURIComponent(e.id),state:t,...e.confirmed&&{confirmed:e.confirmed}};throw new Error("Must be either an account or a group.")}function Cx(e){return void 0!==e._account_id}const Ex=["autogenerated:gerrit:newWipPatchSet","autogenerated:gerrit:setWorkInProgress"],Sx=["autogenerated:gerrit:setReadyForReview"],$x="current";function kx(e){return"-"===`${e}`[0]}function Ax(e){return e===Qu||kx(e)}function Rx(e){if(!e)return;(function(e){return!isNaN(Number(e))||e===Ju||e===Qu})(e)||console.error("string is not of type PatchSetNum");const t=Number(e);return isNaN(t)?e:t}function Tx(e){return"number"==typeof e}function Ix(e,t){for(const i of e)if(i._number===t)return i;e.length>0&&console.warn("no revision found")}function Px(e){return e.find((e=>e._number===Ju))}function Nx(e){const t=function(e){const t=function(e){const t=Px(e);return t&&e.find((e=>e._number===t.basePatchNum))||null}(e);return t?t._number:-1}(e),i=e=>e._number===Ju?2*t:2*(e._number-1)+1;return e.sort(((e,t)=>i(t)-i(e)))}function Ox(e){if(!e)return[];let t=[];if(e.revisions&&Object.keys(e.revisions).length){const i=e.revisions;t=Nx(Object.keys(e.revisions).map((e=>({sha:e,...i[e]})))).map((e=>({num:e._number,desc:e.description,sha:e.sha})))}return function(e,t){if(!e.messages||!e.messages.length)return t;const i=new Map;let r=!!e.work_in_progress;for(let t=0;t<e.messages.length;t++){const o=e.messages[t];o.tag&&Ex.includes(o.tag)?r=!0:o.tag&&Sx.includes(o.tag)&&(r=!1),o._revision_number&&!1!==i.get(`${o._revision_number}`)&&i.set(`${o._revision_number}`,r)}for(let e=0;e<t.length;e++)t[e].wip=i.get(`${t[e].num}`);return t}(e,t)}function Dx(e){if(!e||!e.length)return;let t=e[0].num;return t===Ju&&(t=e[1].num),va(Tx(t),"Latest patchset cannot be EDIT or PARENT."),t}function Lx(e){if(e&&e!==Qu&&e!==Ju)return 1===e?Qu:Number(e)-1}function Mx(e,t){return(t=t||[]).findIndex((t=>`${t._number}`==`${e}`))}function Fx(e){return-Number(`${e}`)}function Ux(e){return e?.substring(0,7)}function Bx(e){return e?e.startsWith("refs/heads/")?e.substring(11):e:""}function Hx(e,t){const i=(e?.parents_data??[])[t??0];return i?Ux(i.commit_id)??"":""}function jx(e,t){const i=(e?.parents_data??[])[t??0];return!i||i.is_merged_in_target_branch?"":0===t?i.change_number?`Patchset ${i.patch_set_number} of Change ${i.change_number}`:"Warning: The base commit is not known (aka reachable) in the target branch.":"Other branch"}const Gx=/\n/g,zx=/^(?:Uploaded\s*)?[Pp]atch [Ss]et \d+:\s*(.*)/;function Vx(e){if(yf(e)){if(xf(e))return ba(e.client_id),e.client_id;if(e.client_id)return e.client_id}return ba(e.id),e.id}function Wx(e,t){const i=e.path??"",r=t.path??"";if(i!==r)return i===hg.PATCHSET_LEVEL_COMMENTS?-1:r===hg.PATCHSET_LEVEL_COMMENTS?1:$g(i,r);const o=qx("number"==typeof e.patch_set?e.patch_set:void 0,"number"==typeof t.patch_set?t.patch_set:void 0);if(0!==o)return o;const s=qx(e.line??e?.range?.end_line,t.line??t?.range?.end_line);if(0!==s)return s;const n=qx(e.range?.start_line,t.range?.start_line);if(0!==n)return n;const a=qx(e.range?.end_character,t.range?.end_character);if(0!==a)return a;const l=qx(e.range?.start_character,t.range?.start_character);if(0!==l)return l;if(yf(e)!==yf(t))return yf(e)?1:-1;if(yf(e)){const i=qx(xf(e)?e.client_created_ms:void 0,xf(t)?t.client_created_ms:void 0);if(0!==i)return i}else{const i=qx(void 0!==e.updated?Wm(e.updated).getTime():void 0,void 0!==t.updated?Wm(t.updated).getTime():void 0);if(0!==i)return i}const d=Vx(e),c=Vx(t);return d.localeCompare(c)}function qx(e,t){return e===t?0:void 0===e?-1:void 0===t?1:Number.isNaN(e)?-1:Number.isNaN(t)?1:e<t?-1:1}function Kx(e,t){const i={savingState:bf.OK,client_id:$a(),client_created_ms:Date.now(),id:void 0,updated:void 0};return void 0!==e&&(i.message=e),void 0!==t&&(i.unresolved=t),i}function Yx(e){const t=function(e){return e.slice(0).sort(Wx)}(e),i=[],r={};for(const e of t){if(e.in_reply_to){const t=r[e.in_reply_to];if(t){t.comments.push(e),Vx(e)&&(r[Vx(e)]=t);continue}}if(!e.path)throw new Error('Comment missing required "path".');const t={comments:[e],patchNum:e.patch_set,commentSide:e.side??Yu.REVISION,mergeParentNum:e.parent,path:e.path,line:e.line,range:e.range,rootId:Vx(e)};wC(e)&&(t.line=Au),i.push(t),Vx(e)&&(r[Vx(e)]=t)}return i}function Xx(e){const t=e.comments.length;return e.comments[t-1]}function Jx(e){return e.comments[0]}function Qx(e){return e.path===hg.PATCHSET_LEVEL_COMMENTS}function Zx(e){return!eC(e)}function eC(e){const t=Xx(e);return void 0===t||!t.unresolved}function tC(e){return yf(Xx(e))}function iC(e){return xf(Jx(e))}function rC(e,t){return!!t?.email&&fC(e).map((e=>e.email)).includes(t.email)}function oC(e){const t=function(e){const t=e.comments.filter((e=>!yf(e)));return t[t.length-1]}(e)?.updated??Xx(e)?.updated;return void 0!==t?Wm(t):void 0}function sC(e,t){return e.parent&&e.side===Yu.PARENT?kx(t.basePatchNum)&&e.parent===Fx(t.basePatchNum):t.basePatchNum===Qu&&e.side===Yu.PARENT&&e.patch_set===t.patchNum||t.basePatchNum!==Qu&&e.side!==Yu.PARENT&&e.patch_set===t.basePatchNum}function nC(e,t){return e.side!==Yu.PARENT&&e.patch_set===t.patchNum}function aC(e,t){return sC(e,t)||nC(e,t)}function lC(e={}){const t={};for(const i of Object.keys(e))t[i]=(e[i]||[]).map((e=>({...e,path:i})));return t}function dC(e={}){const t={};for(const i of Object.keys(e))t[i]=(e[i]??[]).map((e=>({...e,savingState:bf.OK})));return t}const cC="suggestion",hC=`\`\`\`${cC}\n`,pC="provided_fix";function uC(e){return e.message?.includes(hC)??!1}function gC(e,t=0){const i=e.split(hC).slice(1);if(0===i.length)return"";const r=i[Math.min(t,i.length-1)],o=r.indexOf("\n```");return-1!==o?r.substring(0,o):r}function mC(e,t,i){const r=t.split("\n").pop();return[{fix_id:pC,description:"User suggestion",replacements:[{path:e.path,range:{start_line:e.range?.start_line??e.line,start_character:0,end_line:e.range?.end_line??e.line,end_character:r.length},replacement:i}]}]}function fC(e){return e.comments.map((e=>_x(e.message))).flat()}function vC(e,t){return t.email?e.filter((e=>fC(e).map((e=>e.email)).includes(t.email))):[]}function bC(e,t){if(!t)return;let i;for(const r of Object.keys(e))i=i||e[r].find((e=>e.id===t));return i}function yC(e){const t={message:e.message,unresolved:e.unresolved};return e.id&&(t.id=e.id),e.path&&(t.path=e.path),e.side&&(t.side=e.side),e.line&&(t.line=e.line),e.range&&(t.range=e.range),e.in_reply_to&&(t.in_reply_to=e.in_reply_to),e.updated&&(t.updated=e.updated),e.tag&&(t.tag=e.tag),e.fix_suggestions&&(t.fix_suggestions=e.fix_suggestions),t}function wC(e){return!e.line&&!e.range}function _C(e){return e.map((e=>{const t=`${e.range.start_line}-${e.range.end_line}`;return`--- START REPLACEMENT path=${e.path} range=${t}\n${e.replacement}\n--- END REPLACEMENT ---`})).join("\n\n")}function xC(e){return!!e?._account_id&&!dx(e)}function CC(e,t){return xC(e)&&!!t&&ma(t,e._account_id)}function EC(e,t,i,r){const o=e.filter(Zx).filter((e=>rC(e,i)));return o.length>0?`${vx(t,r)} mentioned you in a comment`:kC(t,r)}function SC(e,t){return`Added by ${vx(e,t)} using the hovercard menu`}function $C(e,t){return`Removed by ${vx(e,t)} using the hovercard menu`}function kC(e,t){return`${vx(e,t)} replied on the change`}function AC(e,t,i,r,o){if(o){if(cx(e,o))return-1;if(cx(t,o))return 1}const s=CC(e,i)?1:0,n=CC(t,i)?1:0;if(n-s!==0)return n-s;const a=dx(e)?-1:0,l=dx(t)?-1:0;if(l-a!==0)return l-a;let d=RC(e,r),c=RC(t,r);return d<0&&(d=10-d),c<0&&(c=10-c),c-d}function RC(e,t){if(!e||!t)return 0;const i=bv(t);return i?.all?pv(i,e)?.value??0:0}function TC(...e){let t=0;for(let i=0;i<e.length;i++)t|=1<<e[i];return t.toString(16)}function IC(e,t,i){let r=`${Sf()}/changes/${encodeURIComponent(e)}~${t}`;return i&&(r+=`/revisions/${i}`),r}function PC(e){return e?.status===Nu.NEW}function NC(e){return GC(e)?e._number:e._change_number}function OC(e,t){const i=[];return e.status===Nu.MERGED?t?.revertingChangeStatus===Nu.MERGED?[vf.MERGED,vf.REVERT_SUBMITTED]:void 0!==t?.revertingChangeStatus?[vf.MERGED,vf.REVERT_CREATED]:[vf.MERGED]:e.status===Nu.ABANDONED?[vf.ABANDONED]:(e.revert_of&&i.push(vf.REVERT),!1===e.mergeable||t&&!1===t.mergeable?i.push(vf.MERGE_CONFLICT):e.contains_git_conflicts&&i.push(vf.GIT_CONFLICT),e.work_in_progress&&i.push(vf.WIP),e.is_private&&i.push(vf.PRIVATE),t?([vf.MERGE_CONFLICT,vf.GIT_CONFLICT,vf.WIP,vf.PRIVATE].some((e=>i.includes(e)))||(e.submittable&&i.push(vf.READY_TO_SUBMIT),0===i.length&&i.push(vf.ACTIVE)),i):i)}function DC(e,t){return!(!e||!t)&&e.owner?._account_id===t._account_id}function LC(e,t){return!(!e||!t)&&(!DC(e,t)&&(e.reviewers.REVIEWER??[]).some((e=>e._account_id===t._account_id)))}function MC(e,t){return!(!e||!t)&&(e.reviewers.CC??[]).some((e=>e._account_id===t._account_id))}function FC(e,t){if(!e||!t)return!1;const i=HC(e);return i?.uploader?._account_id===t._account_id}function UC(e,t){const i=DC(e,t),r=FC(e,t),o=LC(e,t),s=MC(e,t);return i||r||o||s}function BC(e,t){return{isOwner:DC(e,t),isUploader:FC(e,t),isReviewer:LC(e,t),isCc:MC(e,t)}}function HC(e){if(e?.revisions&&e?.current_revision)return e.revisions[e.current_revision]}function jC(e,t){return Object.keys(e.revisions??[]).find((i=>e?.revisions?.[i]._number===t))}function GC(e){return void 0!==e._number}var zC;function VC(e){return e.change?{...e,view:gw.CHANGE,changeNum:e.change._number,repo:e.change.project}:{...e,view:gw.CHANGE}}function WC(e){const t=VC({...e,childView:zC.OVERVIEW});let i="";const r=[];return t.checksPatchset&&t.checksPatchset>0&&t.patchNum!==t.checksPatchset&&r.push(`checksPatchset=${t.checksPatchset}`),t.attempt&&"latest"!==t.attempt&&r.push(`attempt=${t.attempt}`),t.filter&&r.push(`filter=${t.filter}`),t.checksResultsFilter&&r.push(`checksResultsFilter=${t.checksResultsFilter}`),t.checksRunsSelected&&t.checksRunsSelected.size>0&&r.push(`checksRunsSelected=${[...t.checksRunsSelected].sort()}`),t.tab&&t.tab!==ng.FILES&&r.push(`tab=${t.tab}`),t.forceReload&&r.push("forceReload=true"),t.openReplyDialog&&r.push("openReplyDialog=true"),t.usp&&r.push(`usp=${t.usp}`),t.edit&&(i+=",edit"),t.commentId&&(i+=`/comments/${t.commentId}`),r.length>0&&(i+="?"+r.join("&")),t.messageHash&&(i+=t.messageHash),`${YC(t)}${i}`}function qC(e){const t=VC({...e,childView:zC.DIFF});let i=`/${Rf(t.diffView?.path??"")}`;t.commentId&&(i+=`comment/${t.commentId}/`);let r="";const o=[];t.checksPatchset&&t.checksPatchset>0&&t.patchNum!==t.checksPatchset&&o.push(`checksPatchset=${t.checksPatchset}`),o.length>0&&(r="?"+o.join("&"));let s="";return t.diffView?.lineNum&&(s+="#",t.diffView?.leftSide&&(s+="b"),s+=t.diffView.lineNum),`${YC(t)}${i}${r}${s}`}function KC(e){const t=VC({...e,childView:zC.DIFF,patchNum:e.patchNum??Ju}),i=`/${Rf(t.editView?.path??"")}`,r=t.editView?.lineNum,o=r?`#${r}`:"";return`${YC(t)}${i},edit${o}`}function YC(e){let t=function(e){let t="";return e.patchNum&&(t=`${e.patchNum}`),e.basePatchNum&&e.basePatchNum!==Qu&&(t=`${e.basePatchNum}..${t}`),t}(e);t.length&&(t="/"+t);let i="";return e.repo&&(i=`${Rf(e.repo)}/+/`),`${Sf()}/c/${i}${e.changeNum}${t}`}!function(e){e.OVERVIEW="OVERVIEW",e.DIFF="DIFF",e.EDIT="EDIT"}(zC||(zC={}));const XC=mu("change-view-model");class JC extends df{constructor(){super(void 0),this.changeNum$=lf(this.state$,(e=>e?.changeNum)),this.patchNum$=lf(this.state$,(e=>e?.patchNum)),this.basePatchNum$=lf(this.state$,(e=>e?.basePatchNum)),this.openReplyDialog$=lf(this.state$,(e=>e?.openReplyDialog)),this.commentId$=lf(this.state$,(e=>e?.commentId)),this.edit$=lf(this.state$,(e=>!!e?.edit)),this.editPath$=lf(this.state$,(e=>e?.editView?.path)),this.diffPath$=lf(this.state$,(e=>e?.diffView?.path)),this.diffLine$=lf(this.state$,(e=>e?.diffView?.lineNum)),this.diffLeftSide$=lf(this.state$,(e=>e?.diffView?.leftSide??!1)),this.childView$=lf(this.state$,(e=>e?.childView)),this.tab$=lf(this.state$,(e=>e?.tab?e.tab:e?.commentId?ng.COMMENT_THREADS:ng.FILES)),this.checksPatchset$=lf(this.state$,(e=>void 0===e?.checksPatchset&&e?.patchNum!==Ju?e?.patchNum:e?.checksPatchset)),this.attempt$=lf(this.state$,(e=>e?.attempt)),this.filter$=lf(this.state$,(e=>e?.filter)),this.checksResultsFilter$=lf(this.state$,(e=>e?.checksResultsFilter??"")),this.checksRunsSelected$=lf(this.state$,(e=>e?.checksRunsSelected??new Set)),this.reload=()=>{const e=this.getState();void 0!==e&&this.forceLoad(e)},this.state$.subscribe((e=>{(e?.usp||e?.forceReload||e?.openReplyDialog)&&this.updateState({usp:void 0,forceReload:void 0,openReplyDialog:void 0}),e?.checksPatchset&&e?.checksPatchset===e?.patchNum&&this.updateState({checksPatchset:void 0})})),document.addEventListener("reload",this.reload)}finalize(){document.removeEventListener("reload",this.reload)}forceLoad(e){this.setState(void 0),setTimeout((()=>this.setState({...e,forceReload:void 0})))}setState(e){e?.forceReload?this.forceLoad(e):super.setState(e)}diffUrl(e){const t=this.getState();ba(t?.changeNum),ba(t?.repo);const i=e.patchNum??t.patchNum;let r=e.basePatchNum??t.basePatchNum;return Tx(r)&&Tx(i)&&i<=r&&(r=Qu),qC({changeNum:e.changeNum??t.changeNum,repo:e.repo??t.repo,patchNum:i,basePatchNum:r,checksPatchset:e.checksPatchset??t.checksPatchset,diffView:e.diffView??t.diffView})}editUrl(e){const t=this.getState();return ba(t?.changeNum),ba(t?.repo),KC({changeNum:e.changeNum??t.changeNum,repo:e.repo??t.repo,patchNum:e.patchNum??t.patchNum,editView:e.editView??t.editView})}toggleSelectedCheckRun(e){const t=this.getState()?.checksRunsSelected??new Set,i=new Set(t);!function(e,t){e.has(t)?e.delete(t):e.add(t)}(i,e),this.updateState({checksRunsSelected:i})}}const QC=/^owner:\s?("[^"]+"|[^ ]+)$/,ZC=/^project:\s?("[^"]+"|[^ ]+)(\sstatus\s?:(open|"open"))?$/,eE=[/^\s*i?[0-9a-f]{7,40}\s*$/i,/^\s*[1-9][0-9]*\s*$/g,/[0-9a-f]{40}/];function tE(e){let t="";if(e.offset&&e.offset>0&&(t=`,${e.offset}`),e.query)return`${Sf()}/q/${Rf(e.query)}${t}`;const i=[];return e.owner&&i.push("owner:"+Rf(e.owner)),e.repo&&i.push("project:"+Rf(e.repo)),e.branch&&i.push("branch:"+Rf(e.branch)),e.topic&&i.push("topic:"+Dg(Rf(e.topic))),e.hashtag&&i.push("hashtag:"+Dg(Rf(e.hashtag.toLowerCase()))),e.statuses&&(1===e.statuses.length?i.push("status:"+Rf(e.statuses[0])):e.statuses.length>1&&i.push("("+e.statuses.map((e=>`status:${Rf(e)}`)).join(" OR ")+")")),`${Sf()}/q/${i.join("+")}${t}`}const iE=mu("search-view-model");class rE extends df{constructor(e,t,i){super(void 0),this.restApiService=e,this.userModel=t,this.getNavigation=i,this.query$=lf(this.state$,(e=>e?.query??"")),this.offset$=lf(this.state$,(e=>e?.offset??"0")),this.offsetNumber$=lf(this.offset$,(e=>{const t=Number(e);return Number.isFinite(t)?t:0})),this.changes$=lf(this.state$,(e=>e?.changes??[])),this.userId$=lf(Yh([this.query$,this.changes$]),(([e,t])=>{if(0===t.length)return;if(!QC.test(e))return;const i=lx(t[0].owner);return t.some((e=>lx(e.owner)!==i))?void 0:i})),this.repo$=lf(Yh([this.query$,this.changes$]),(([e,t])=>{if(0!==t.length&&ZC.test(e))return t[0].project})),this.loading$=lf(this.state$,(e=>e?.loading??!1)),this.reload$=ef(document,"reload").pipe(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e[e.length-1];return Mh(i)?(e.pop(),function(t){return ap(e,t,i)}):function(t){return ap(e,t)}}(void 0)),this.reloadChangesTrigger$=Yh([this.reload$,this.query$,this.offsetNumber$,this.userModel.preferenceChangesPerPage$]).pipe(ep((([e,t,i,r])=>[t,i,r]))),this.subscriptions=[this.reloadChangesTrigger$.pipe(Vp((e=>this.reloadChanges(e))),Zp((e=>this.updateState({changes:e,loading:!1})))).subscribe(),this.changes$.pipe($p((e=>1===e.length)),du(this.query$)).subscribe((([e,t])=>this.redirectSingleResult(t,e)))]}async reloadChanges([e,t,i]){return void 0===this.getState()||0===e.trim().length?[]:(this.updateState({loading:!0}),await this.restApiService.getChanges(i,e,t)??[])}redirectSingleResult(e,t){if(1===t.length)for(const i of eE)if(e.match(i))return void this.getNavigation().replaceUrl(WC({change:t[0]}))}}const oE={urlPattern:/^\/p\/(.+)\/\+\/dashboard\/(.+)/,createState:e=>{const t=e.params[0]??"",i=e.params[1]??"";return{view:gw.DASHBOARD,type:sE.REPO,project:t,dashboard:i}}};var sE;!function(e){e[e.USER=0]="USER",e[e.REPO=1]="REPO",e[e.CUSTOM=2]="CUSTOM"}(sE||(sE={}));const nE=/\${(project|repo)}/g;function aE(e){const t=e.project||void 0;if(e.sections){const i=function(e,t){return e.map((e=>{const i=t?e.query.replace(nE,t):e.query;return Rf(e.name)+"="+Rf(i)}))}(e.sections,t);e.title&&i.push("title="+Rf(e.title));const r=e.user?e.user:"";return`${Sf()}/dashboard/${r}?${i.join("&")}`}if(t){const i=Rf(t);return`${Sf()}/p/${i}/+/dashboard/${e.dashboard}`}return`${Sf()}/dashboard/${e.user||"self"}`}const lE=mu("dashboard-view-model");class dE extends df{constructor(){super(void 0)}}var cE=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let hE=class extends Ic{constructor(){super(),this.highlightAttention=!1,this.docsBaseUrl="",this.restApiService=Xn().restApiService,this.reporting=Xn().reportingService,this.getUserModel=yu(this,jf),this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getUserModel().account$),(e=>this.selfAccount=e)),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.serverConfig=e})),zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e))}static get styles(){return[Nc,Qb,Sd`
        .top,
        .attention,
        .status,
        .displayName,
        .voteable {
          padding: var(--spacing-s) var(--spacing-l);
        }
        .links {
          padding: var(--spacing-m) 0px var(--spacing-l) var(--spacing-xxl);
        }
        .top {
          display: flex;
          padding-top: var(--spacing-xl);
          min-width: 300px;
        }
        gr-avatar {
          height: 48px;
          width: 48px;
          margin-right: var(--spacing-l);
        }
        .title,
        .email {
          color: var(--deemphasized-text-color);
        }
        .action {
          border-top: 1px solid var(--border-color);
          padding: var(--spacing-s) var(--spacing-l);
          --gr-button-padding: var(--spacing-s) var(--spacing-m);
        }
        .attention {
          background-color: var(--emphasis-color);
        }
        .attention a {
          text-decoration: none;
        }
        .status gr-icon {
          font-size: 14px;
          position: relative;
          top: 2px;
        }
        gr-icon.attentionIcon {
          transform: scaleX(0.8);
        }
        gr-icon.linkIcon {
          font-size: var(--line-height-normal, 20px);
          color: var(--deemphasized-text-color);
          padding-right: 12px;
        }
        .links a {
          color: var(--link-color);
          padding: 0px 4px;
        }
        .reason {
          padding-top: var(--spacing-s);
        }
        .status .value {
          white-space: pre-wrap;
        }
        /* Make sure that users cannot break the layout with super long
           "About Me" texts. */
        div.status {
          max-height: 8em;
          overflow-y: auto;
        }
      `]}render(){return dc`
      <div class="top">
        <div class="avatar">
          <gr-avatar .account=${this.account} .imageSize=${56}></gr-avatar>
        </div>
        <div class="account">
          <h3 class="name heading-3">${this.account.name}</h3>
          <div class="email">${this.account.email}</div>
        </div>
      </div>
      ${this.renderAccountStatusPlugins()} ${this.renderAccountStatus()}
      ${this.renderDisplayName()} ${this.renderLinks()}
      ${this.renderChangeRelatedInfoAndActions()}
    `}renderChangeRelatedInfoAndActions(){if(void 0===this.change)return uc;const e=function(e,t,i){if(!e||!e.labels)return"";const r=[];for(const o of Object.keys(e.labels)){let s=yx(e,t,o);if(isNaN(s)&&i&&cx(t,i)&&(s=wx(e,o)),isNaN(s)||s<0)continue;const n=s>0?`+${s}`:`${s}`;r.push(`${o}: ${n}`)}return r.join(", ")}(this.change,this.account,this.selfAccount);return dc`
      ${e?dc`
            <div class="voteable">
              <span class="title">Voteable:</span>
              <span class="value">${e}</span>
            </div>
          `:""}
      ${this.renderNeedsAttention()} ${this.renderAddToAttention()}
      ${this.renderRemoveFromAttention()} ${this.renderReviewerOrCcActions()}
    `}renderReviewerOrCcActions(){return this.selfAccount&&(e=this.change,(t=this.account)&&e&&(MC(e,t)||e.removable_reviewers&&e.removable_reviewers.some((e=>e._account_id===t._account_id||!t._account_id&&e.email===t.email))))?dc`
      <div class="action">
        <gr-button
          class="removeReviewerOrCC"
          link
          @click=${this.handleRemoveReviewerOrCC}
        >
          Remove ${this.computeReviewerOrCCText()}
        </gr-button>
      </div>
      <div class="action">
        <gr-button
          class="changeReviewerOrCC"
          link
          @click=${this.handleChangeReviewerOrCCStatus}
        >
          ${this.computeChangeReviewerOrCCText()}
        </gr-button>
      </div>
    `:uc;var e,t}renderAccountStatusPlugins(){return dc`
      <gr-endpoint-decorator name="hovercard-status">
        <gr-endpoint-param
          name="account"
          .value=${this.account}
        ></gr-endpoint-param>
      </gr-endpoint-decorator>
    `}renderLinks(){return this.account&&(mf(e=this.account)||e._account_id)?dc` <div class="links">
      <gr-icon icon="link" class="linkIcon"></gr-icon>
      <a
        href=${Vw(this.computeOwnerChangesLink())}
        @click=${()=>{Jn(this,"link-clicked",{})}}
        @enter=${()=>{Jn(this,"link-clicked",{})}}
        >Changes</a
      >
      ·
      <a
        href=${Vw(this.computeOwnerDashboardLink())}
        @click=${()=>{Jn(this,"link-clicked",{})}}
        @enter=${()=>{Jn(this,"link-clicked",{})}}
        >Dashboard</a
      >
      <gr-endpoint-decorator name="hovercard-links">
        <gr-endpoint-param
          name="account"
          .value=${this.account}
        ></gr-endpoint-param>
      </gr-endpoint-decorator>
    </div>`:uc;var e}renderAccountStatus(){return this.account.status?dc`
      <div class="status">
        <span class="title">About me:</span>
        <span class="value">${this.account.status.trim()}</span>
      </div>
    `:uc}renderDisplayName(){return this.account.display_name?dc`
      <div class="displayName">
        <span class="title">Display name:</span>
        <span class="value">${this.account.display_name.trim()}</span>
      </div>
    `:uc}renderNeedsAttention(){if(!this.isAttentionEnabled||!this.hasUserAttention)return uc;const e=function(e,t){if(!CC(e,t))return"";const i=t[e._account_id];return i?.last_update?i.last_update:""}(this.account,this.change?.attention_set);return dc`
      <div class="attention">
        <div>
          <gr-icon
            icon="label_important"
            filled
            small
            class="attentionIcon"
          ></gr-icon>
          <span> ${this.computePronoun()} turn to take action. </span>
          <a
            href=${$f(this.docsBaseUrl,"user-attention-set.html")}
            target="_blank"
            rel="noopener noreferrer"
          >
            <gr-icon icon="help" title="read documentation"></gr-icon>
          </a>
        </div>
        <div class="reason">
          <span class="title">Reason:</span>
          <span class="value">
            ${function(e,t,i){if(!CC(t,i))return"";if(void 0===i)return"";if(void 0===t?._account_id)return"";const r=i[t._account_id];return void 0===r?.reason?"":bx(r.reason,r?.reason_account?[r.reason_account]:[],e)}(this.serverConfig,this.account,this.change?.attention_set)}
          </span>
          ${e?dc` (
                <gr-date-formatter
                  withTooltip
                  .dateStr=${e}
                ></gr-date-formatter>
                )`:""}
        </div>
      </div>
    `}renderAddToAttention(){return this.computeShowActionAddToAttentionSet()?dc`
      <div class="action">
        <gr-button
          class="addToAttentionSet"
          link
          @click=${this.handleClickAddToAttentionSet}
        >
          Add to Attention Set
        </gr-button>
      </div>
    `:uc}renderRemoveFromAttention(){return this.computeShowActionRemoveFromAttentionSet()?dc`
      <div class="action">
        <gr-button
          class="removeFromAttentionSet"
          link
          @click=${this.handleClickRemoveFromAttentionSet}
        >
          Remove from Attention Set
        </gr-button>
      </div>
    `:uc}computePronoun(){return this.account&&this.selfAccount?cx(this.account,this.selfAccount)?"Your":"Their":""}computeOwnerChangesLink(){if(this.account)return tE({owner:this.account.email||this.account.username||this.account.name||`${this.account._account_id}`})}computeOwnerDashboardLink(){if(this.account)return this.account._account_id?aE({type:sE.USER,user:this.account._account_id}):this.account.email?aE({type:sE.USER,user:this.account.email}):void 0}get isAttentionEnabled(){return!!this.highlightAttention&&!!this.change&&xC(this.account)}get hasUserAttention(){return CC(this.account,this.change?.attention_set)}getReviewerState(e){return e.reviewers[Vu.REVIEWER]?.some((e=>e._account_id===this.account._account_id))?Vu.REVIEWER:Vu.CC}computeReviewerOrCCText(){return this.change&&this.account?this.getReviewerState(this.change)===Vu.REVIEWER?"Reviewer":"CC":""}computeChangeReviewerOrCCText(){return this.change&&this.account?this.getReviewerState(this.change)===Vu.REVIEWER?"Move Reviewer to CC":"Move CC to Reviewer":""}handleChangeReviewerOrCCStatus(){ba(this.change,"change");const e=lx(this.account);Jn(this,"show-alert",{message:"Reloading page..."});const t={};t.reviewers=[{reviewer:e,state:this.getReviewerState(this.change)===Vu.CC?Vu.REVIEWER:Vu.CC}],this.restApiService.saveChangeReview(this.change._number,$x,t).then((e=>{if(!e)throw new Error("something went wrong when toggling"+this.getReviewerState(this.change));aa(this)}))}handleRemoveReviewerOrCC(){if(!this.change||!this.account?._account_id&&!this.account?.email)throw new Error("Missing change or account.");Jn(this,"show-alert",{message:"Reloading page..."}),this.restApiService.removeChangeReviewer(this.change._number,this.account?._account_id||this.account?.email).then((e=>{if(!e||!e.ok)throw new Error("something went wrong when removing user");return aa(this),e}))}computeShowActionAddToAttentionSet(){return(UC(this.change,this.selfAccount)||cx(this.account,this.selfAccount))&&this.isAttentionEnabled&&!this.hasUserAttention}computeShowActionRemoveFromAttentionSet(){return(UC(this.change,this.selfAccount)||cx(this.account,this.selfAccount))&&this.isAttentionEnabled&&this.hasUserAttention}handleClickAddToAttentionSet(){if(!this.change||!this.account._account_id)return;Jn(this,"show-alert",{message:"Reloading page...",dismissOnNavigation:!0});const e=SC(this.selfAccount,this.serverConfig);this.change.attention_set||(this.change.attention_set={}),this.change.attention_set[this.account._account_id]={account:this.account,reason:e,reason_account:this.selfAccount},Jn(this,"attention-set-updated",{}),this.reporting.reportInteraction("attention-hovercard-add",this.reportingDetails()),this.restApiService.addToAttentionSet(this.change._number,this.account._account_id,e).then((()=>{Jn(this,"hide-alert",{})})),Jn(this,"action-taken",{})}handleClickRemoveFromAttentionSet(){if(!this.change||!this.account._account_id)return;Jn(this,"show-alert",{message:"Saving attention set update ...",dismissOnNavigation:!0});const e=$C(this.selfAccount,this.serverConfig);this.change.attention_set&&delete this.change.attention_set[this.account._account_id],Jn(this,"attention-set-updated",{}),this.reporting.reportInteraction("attention-hovercard-remove",this.reportingDetails()),this.restApiService.removeFromAttentionSet(this.change._number,this.account._account_id,e).then((()=>{Jn(this,"hide-alert",{})})),Jn(this,"action-taken",{})}reportingDetails(){const e=this.account._account_id,t=this.change&&this.change.owner&&this.change.owner._account_id||-1,i=this.selfAccount&&this.selfAccount._account_id||-1,r=(this.change&&this.change.reviewers&&this.change.reviewers.REVIEWER?[...this.change.reviewers.REVIEWER]:[]).map((e=>e._account_id)).filter((e=>e!==t));return{actionByOwner:i===t,actionByReviewer:-1!==i&&r.includes(i),targetIsOwner:e===t,targetIsReviewer:r.includes(e),targetIsSelf:e===i}}};cE([Fc({type:Object})],hE.prototype,"account",void 0),cE([Uc()],hE.prototype,"selfAccount",void 0),cE([Fc({type:Object})],hE.prototype,"change",void 0),cE([Fc({type:Boolean})],hE.prototype,"highlightAttention",void 0),cE([Uc()],hE.prototype,"serverConfig",void 0),cE([Uc()],hE.prototype,"docsBaseUrl",void 0),hE=cE([Dc("gr-hovercard-account-contents")],hE);var pE=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const uE=ix(Ic);let gE=class extends uE{constructor(){super(...arguments),this.highlightAttention=!1}render(){return dc`
      <div id="container" role="tooltip" tabindex="-1">
        ${eb(this._isShowing,(()=>dc`<gr-hovercard-account-contents
              .account=${this.account}
              .change=${this.change}
              .highlightAttention=${this.highlightAttention}
              @link-clicked=${this.forceHide}
              @action-taken=${this.mouseHide}
              @attention-set-updated=${this.redirectEventToTarget}
              @hide-alert=${this.redirectEventToTarget}
              @show-alert=${this.redirectEventToTarget}
              @reload=${this.redirectEventToTarget}
            ></gr-hovercard-account-contents>`))}
      </div>
    `}redirectEventToTarget(e){this.dispatchEventThroughTarget(e.type,e.detail)}};pE([Fc({type:Object})],gE.prototype,"account",void 0),pE([Fc({type:Object})],gE.prototype,"change",void 0),pE([Fc({type:Boolean})],gE.prototype,"highlightAttention",void 0),gE=pE([Dc("gr-hovercard-account")],gE);const mE=mu("accounts-model");class fE extends df{constructor(e){super({accounts:{}}),this.restApiService=e}updateStateAccount(e,t){if(!t)return;const i={...this.getState()};i.accounts={...i.accounts,[e]:t},this.setState(i)}async getAccount(e){const t=this.getState(),i=px(e);if(ma(t.accounts,i))return{...t.accounts[i]};const r=await this.restApiService.getAccountDetails(i,(()=>{this.updateStateAccount(i,e)}));return r&&this.updateStateAccount(i,r),r??e}async fillDetails(e){return fx(e)?e:await this.getAccount(e)}}var vE=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let bE=class extends Ic{static get styles(){return[Sd`
        :host {
          display: inline-block;
          vertical-align: top;
          position: relative;
          border-radius: var(--label-border-radius);
          box-sizing: border-box;
          white-space: nowrap;
          padding-left: var(--account-label-padding-left, 0);
        }
        :host([avatarShown]:not([attentionIconShown])) {
          padding-left: var(--account-label-circle-padding-left, 0);
        }
        :host([attentionIconShown]) {
          padding-left: var(--account-label-padding-left, 0);
        }
        .rightSidePadding {
          padding-right: var(--account-label-padding-right, 0);
          /* The existence of this element will also add 2(!) flexbox gaps */
          margin-left: -6px;
        }
        .container {
          display: flex;
          align-items: center;
          gap: 3px;
        }
        :host::after {
          content: var(--account-label-suffix);
        }
        :host([deselected][selectionChipStyle]) {
          background-color: var(--background-color-primary);
          border: 1px solid var(--comment-separator-color);
          border-radius: 8px;
          color: var(--deemphasized-text-color);
        }
        :host([selected][selectionChipStyle]) {
          background-color: var(--chip-selected-background-color);
          border: 1px solid var(--chip-selected-background-color);
          border-radius: 8px;
          color: var(--chip-selected-text-color);
        }
        :host([selected]) gr-icon.attention {
          color: var(--chip-selected-text-color);
        }
        gr-avatar {
          height: calc(var(--line-height-normal) - 2px);
          width: calc(var(--line-height-normal) - 2px);
        }
        .accountStatusDecorator,
        .hovercardTargetWrapper {
          display: contents;
        }
        #attentionButton {
          /* This negates the 4px horizontal padding, which we appreciate as a
         larger click target, but which we don't want to consume space. :-) */
          margin: 0 -4px 0 -4px;
          --gr-button-padding: 0 var(--spacing-xs);
          vertical-align: top;
        }
        gr-icon.attention {
          color: var(--deemphasized-text-color);
          transform: scaleX(0.8);
        }
        .name {
          display: inline-block;
          vertical-align: top;
          overflow: hidden;
          text-overflow: ellipsis;
          max-width: var(--account-max-length, 180px);
        }
        .hasAttention .name {
          font-weight: var(--font-weight-bold);
        }
        a.ownerLink {
          text-decoration: none;
          color: var(--primary-text-color);
          display: flex;
          align-items: center;
          gap: 3px;
        }
        :host([clickable]) a.ownerLink:hover .name {
          text-decoration: underline;
        }
      `]}updated(){this.computeDetailedAccount()}async computeDetailedAccount(){if(!this.account)return;if(fx(this.account))return;const e=await this.getAccountsModel().fillDetails(this.account);!e||!fx(e)||e===this.account||this.account._account_id&&e._account_id!==this.account._account_id||(this.account={...e,...this.account})}render(){const{account:e,change:t,highlightAttention:i,forceAttention:r,config:o}=this;if(!e)return;this.attentionIconShown=r||this.hasUnforcedAttention(i,e,t),this.deselected=!this.selected;const s=!!o?.plugin?.has_avatars;return this.avatarShown=!this.hideAvatar&&s,dc`
      <div class="container">
        ${this.hideHovercard?"":dc`<gr-hovercard-account
              for="hovercardTarget"
              .account=${e}
              .change=${t}
              .highlightAttention=${i}
            ></gr-hovercard-account>`}
        ${this.attentionIconShown?dc` <gr-tooltip-content
              ?has-tooltip=${this.computeAttentionButtonEnabled(i,e,t,!1,this.selfAccount)}
              title=${this.computeAttentionIconTitle(i,e,t,r,this.selected,this.selfAccount)}
            >
              <gr-button
                id="attentionButton"
                link=""
                aria-label="Remove user from attention set"
                @click=${this.handleRemoveAttentionClick}
                ?disabled=${!this.computeAttentionButtonEnabled(i,e,t,this.selected,this.selfAccount)}
              >
                <div>
                  <gr-icon
                    icon="label_important"
                    filled
                    small
                    class="attention"
                  >
                  </gr-icon>
                </div>
              </gr-button>
            </gr-tooltip-content>`:""}
        ${this.maybeRenderLink(dc`
          <span
            class=${th({hovercardTargetWrapper:!0,hasAttention:this.attentionIconShown})}
          >
            ${this.avatarShown?dc`<gr-avatar .account=${e} imageSize="32"></gr-avatar>`:""}
            <span
              tabindex=${this.hideHovercard?"-1":"0"}
              role=${Vw(this.hideHovercard?void 0:"button")}
              id="hovercardTarget"
              class="name"
              part="gr-account-label-text"
            >
              ${this.computeName(e,this.firstName,this.config)}
            </span>
            ${this.renderAccountStatusPlugins()}
          </span>
        `)}
      </div>
    `}constructor(){super(),this.forceAttention=!1,this.firstName=!1,this.highlightAttention=!1,this.hideHovercard=!1,this.hideAvatar=!1,this.selectionChipStyle=!1,this.noStatusIcons=!1,this.selected=!1,this.deselected=!1,this.clickable=!1,this.attentionIconShown=!1,this.avatarShown=!1,this.reporting=Xn().reportingService,this.restApiService=Xn().restApiService,this.getAccountsModel=yu(this,mE),this.getConfigModel=yu(this,Qw),this.getUserModel=yu(this,jf),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.config=e)),zf(this,(()=>this.getUserModel().account$),(e=>this.selfAccount=e)),this.addEventListener("attention-set-updated",(()=>{this.change&&(this.change={...this.change})}))}maybeRenderLink(e){if(!this.clickable||!this.account)return e;const t=tE({owner:this.account.email||this.account.username||this.account.name||`${this.account._account_id}`});return t?dc`<a class="ownerLink" href=${t} tabindex="-1">${e}</a>`:e}renderAccountStatusPlugins(){if(this.account?._account_id&&!this.noStatusIcons)return dc`
      <gr-endpoint-decorator
        class="accountStatusDecorator"
        name="account-status-icon"
      >
        <gr-endpoint-param
          name="accountId"
          .value=${this.account._account_id}
        ></gr-endpoint-param>
        <span class="rightSidePadding"></span>
      </gr-endpoint-decorator>
    `}isAttentionSetEnabled(e,t,i){return e&&!!i&&!!t&&!dx(t)}hasUnforcedAttention(e,t,i){return!!(this.isAttentionSetEnabled(e,t,i)&&i&&i.attention_set&&t._account_id&&ma(i.attention_set,t._account_id))}computeName(e,t,i){return ox(i,e,t)}handleRemoveAttentionClick(e){if(!this.account||!this.change)return;if(this.selected)return;if(e.preventDefault(),e.stopPropagation(),!this.account._account_id)return;Jn(this,"show-alert",{message:"Saving attention set update ...",dismissOnNavigation:!0});const t=function(e,t){return`Removed by ${vx(e,t)} by clicking the attention icon`}(this.selfAccount,this.config);this.change.attention_set&&delete this.change.attention_set[this.account._account_id],this.change={...this.change},this.reporting.reportInteraction("attention-icon-remove",this.reportingDetails()),this.restApiService.removeFromAttentionSet(this.change._number,this.account._account_id,t).then((()=>{Jn(this,"hide-alert",{})}))}reportingDetails(){if(!this.account)return;const e=this.account._account_id,t=this.change&&this.change.owner&&this.change.owner._account_id||-1,i=this.selfAccount?._account_id||-1,r=(this.change&&this.change.reviewers&&this.change.reviewers.REVIEWER?[...this.change.reviewers.REVIEWER]:[]).map((e=>e._account_id)).filter((e=>e!==t));return{actionByOwner:i===t,actionByReviewer:-1!==i&&r.includes(i),targetIsOwner:e===t,targetIsReviewer:r.includes(e),targetIsSelf:e===i}}computeAttentionButtonEnabled(e,t,i,r,o){return!!r||!!this.hasUnforcedAttention(e,t,i)&&(UC(i,o)||cx(t,o))}computeAttentionIconTitle(e,t,i,r,o,s){const n=this.computeAttentionButtonEnabled(e,t,i,o,s),a=`Click to remove ${t._account_id===s?._account_id?"yourself":"the user"} from the attention set`;return n?a:r?'Disabled. Use "Modify" to make changes.':"Disabled. Only involved users can change."}};vE([Fc({type:Object})],bE.prototype,"account",void 0),vE([Fc({type:Object})],bE.prototype,"change",void 0),vE([Fc({type:Boolean})],bE.prototype,"forceAttention",void 0),vE([Fc({type:Boolean})],bE.prototype,"firstName",void 0),vE([Fc({type:Boolean})],bE.prototype,"highlightAttention",void 0),vE([Fc({type:Boolean})],bE.prototype,"hideHovercard",void 0),vE([Fc({type:Boolean})],bE.prototype,"hideAvatar",void 0),vE([Fc({type:Boolean,reflect:!0})],bE.prototype,"selectionChipStyle",void 0),vE([Fc({type:Boolean,reflect:!0})],bE.prototype,"noStatusIcons",void 0),vE([Fc({type:Boolean,reflect:!0})],bE.prototype,"selected",void 0),vE([Fc({type:Boolean,reflect:!0})],bE.prototype,"deselected",void 0),vE([Fc({type:Boolean,reflect:!0})],bE.prototype,"clickable",void 0),vE([Fc({type:Boolean,reflect:!0})],bE.prototype,"attentionIconShown",void 0),vE([Fc({type:Boolean,reflect:!0})],bE.prototype,"avatarShown",void 0),vE([Uc()],bE.prototype,"selfAccount",void 0),vE([Uc()],bE.prototype,"config",void 0),bE=vE([Dc("gr-account-label")],bE);var yE=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let wE=class extends Ic{constructor(){super(...arguments),this.loading=!0,this.restApiService=Xn().restApiService}connectedCallback(){super.connectedCallback(),oa("Audit Log")}static get styles(){return[Nc,pw,Sd`
        /* GenericList style centers the last column, but we don't want that here. */
        .genericList tr th:last-of-type,
        .genericList tr td:last-of-type {
          text-align: left;
        }
      `]}render(){return dc`
      <table id="list" class="genericList">
        <tbody>
          <tr class="headerRow">
            <th class="date topHeader">Date</th>
            <th class="type topHeader">Type</th>
            <th class="member topHeader">Member</th>
            <th class="by-user topHeader">By User</th>
          </tr>
          ${this.renderLoading()}
        </tbody>
        ${this.renderAuditLogTable()}
      </table>
    `}renderLoading(){if(this.loading)return dc`
      <tr id="loading" class="loadingMsg loading">
        <td>Loading...</td>
      </tr>
    `}renderAuditLogTable(){if(!this.loading)return dc`
      <tbody>
        ${this.auditLog?.map((e=>this.renderAuditLog(e)))}
      </tbody>
    `}renderAuditLog(e){return dc`
      <tr class="table">
        <td class="date">
          <gr-date-formatter withTooltip .dateStr=${e.date}>
          </gr-date-formatter>
        </td>
        <td class="type">${this.itemType(e.type)}</td>
        <td class="member">
          ${this.isGroupEvent(e)?dc`<a href=${this.computeGroupUrl(e.member)}
                >${this.getNameForGroup(e.member)}</a
              >`:dc`<gr-account-label
                  .account=${e.member}
                  clickable
                ></gr-account-label
                >${this.getIdForUser(e.member)}`}
        </td>
        <td class="by-user">
          <gr-account-label clickable .account=${e.user}></gr-account-label>
          ${this.getIdForUser(e.user)}
        </td>
      </tr>
    `}willUpdate(e){e.has("groupId")&&this.getAuditLogs()}getAuditLogs(){if(this.groupId)return this.loading=!0,this.restApiService.getGroupAuditLog(this.groupId,(e=>{ia(e)})).then((e=>{this.auditLog=e??[]})).finally((()=>{this.loading=!1}))}itemType(e){let t;switch(e){case"ADD_GROUP":case"ADD_USER":t="Added";break;case"REMOVE_GROUP":case"REMOVE_USER":t="Removed";break;default:t=""}return t}isGroupEvent(e){return function(e){return e.type===ff.ADD_GROUP||e.type===ff.REMOVE_GROUP}(e)}computeGroupUrl(e){return e?.id?iw({groupId:e.id}):""}getIdForUser(e){return e._account_id?` (${e._account_id})`:""}getNameForGroup(e){return e&&e.name?e.name:e&&e.id?decodeURIComponent(e.id):""}};yE([Fc({type:String})],wE.prototype,"groupId",void 0),yE([Uc()],wE.prototype,"auditLog",void 0),yE([Uc()],wE.prototype,"loading",void 0),wE=yE([Dc("gr-group-audit-log")],wE);var _E=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let xE=class extends Ic{static get styles(){return[Nc,Sd`
        :host {
          display: block;
          width: 30em;
        }
      `]}render(){const e=this.item??"UNKNOWN ITEM",t=this.itemTypeName??"UNKNOWN ITEM TYPE";return dc` <gr-dialog
      confirm-label="Delete ${t}"
      confirm-on-enter=""
      @confirm=${this._handleConfirmTap}
      @cancel=${this._handleCancelTap}
    >
      <div class="header" slot="header">${t} Deletion</div>
      <div class="main" slot="main">
        <label for="branchInput">
          Do you really want to delete the following ${t}?
        </label>
        <div>${e}</div>
      </div>
    </gr-dialog>`}_handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"confirm",{})}_handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"cancel",{})}};_E([Fc({type:String})],xE.prototype,"item",void 0),_E([Fc({type:String})],xE.prototype,"itemTypeName",void 0),xE=_E([Dc("gr-confirm-delete-item-dialog")],xE);var CE,EE=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e.MEMBER="member",e.INCLUDED_GROUP="includedGroup"}(CE||(CE={}));let SE=class extends Ic{constructor(){super(),this.loading=!0,this.groupOwner=!1,this.isAdmin=!1,this.restApiService=Xn().restApiService,this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.serverConfig=e})),this.queryMembers=e=>this.getAccountSuggestions(e,this.serverConfig),this.queryIncludedGroup=e=>this.getGroupSuggestions(e)}connectedCallback(){super.connectedCallback(),this.loadGroupDetails(),oa("Members")}static get styles(){return[Qb,my,Nc,Kw,pw,Iw,Sd`
        .input {
          width: 15em;
        }
        gr-autocomplete {
          width: 20em;
        }
        a {
          color: var(--primary-text-color);
          text-decoration: none;
        }
        a:hover {
          text-decoration: underline;
        }
        th {
          border-bottom: 1px solid var(--border-color);
          font-weight: var(--font-weight-medium);
          text-align: left;
        }
        .canModify #groupMemberSearchInput,
        .canModify #saveGroupMember,
        .canModify .deleteHeader,
        .canModify .deleteColumn,
        .canModify #includedGroupSearchInput,
        .canModify #saveIncludedGroups,
        .canModify .deleteIncludedHeader,
        .canModify #saveIncludedGroups {
          display: none;
        }
      `]}render(){return dc`
      <div
        class="main gr-form-styles ${this.isAdmin||this.groupOwner?"":"canModify"}"
      >
        <div id="loading" class=${this.loading?"loading":""}>
          Loading...
        </div>
        <div id="loadedContent" class=${this.loading?"loading":""}>
          <h1 id="Title" class="heading-1">${this.groupName}</h1>
          <div id="form">
            <h3 id="members" class="heading-3">Members</h3>
            <fieldset>
              <span class="value">
                <gr-autocomplete
                  id="groupMemberSearchInput"
                  .text=${this.groupMemberSearchName??""}
                  .value=${`${this.groupMemberSearchId??""}`}
                  .query=${this.queryMembers}
                  .showBlueFocusBorder=${!0}
                  placeholder="Name Or Email"
                  @text-changed=${this.handleGroupMemberTextChanged}
                  @value-changed=${this.handleGroupMemberValueChanged}
                >
                </gr-autocomplete>
              </span>
              <gr-button
                id="saveGroupMember"
                ?disabled=${!this.groupMemberSearchId}
                @click=${this.handleSavingGroupMember}
              >
                Add
              </gr-button>
              <table id="groupMembers">
                <tbody>
                  <tr class="headerRow">
                    <th class="nameHeader">Name</th>
                    <th class="emailAddressHeader">Email Address</th>
                    <th class="deleteHeader">Delete Member</th>
                  </tr>
                </tbody>
                <tbody>
                  ${this.groupMembers?.map(((e,t)=>this.renderGroupMember(e,t)))}
                </tbody>
              </table>
            </fieldset>
            <h3 id="includedGroups" class="heading-3">Included Groups</h3>
            <fieldset>
              <span class="value">
                <gr-autocomplete
                  id="includedGroupSearchInput"
                  .text=${this.includedGroupSearchName??""}
                  .value=${this.includedGroupSearchId??""}
                  .query=${this.queryIncludedGroup}
                  .showBlueFocusBorder=${!0}
                  placeholder="Group Name"
                  @text-changed=${this.handleIncludedGroupTextChanged}
                  @value-changed=${this.handleIncludedGroupValueChanged}
                >
                </gr-autocomplete>
              </span>
              <gr-button
                id="saveIncludedGroups"
                ?disabled=${!this.includedGroupSearchId}
                @click=${this.handleSavingIncludedGroups}
              >
                Add
              </gr-button>
              <table id="includedGroups">
                <tbody>
                  <tr class="headerRow">
                    <th class="groupNameHeader">Group Name</th>
                    <th class="descriptionHeader">Description</th>
                    <th class="deleteIncludedHeader">Delete Group</th>
                  </tr>
                </tbody>
                <tbody>
                  ${this.includedGroups?.map(((e,t)=>this.renderIncludedGroup(e,t)))}
                </tbody>
              </table>
            </fieldset>
          </div>
        </div>
      </div>
      <dialog id="modal" tabindex="-1">
        <gr-confirm-delete-item-dialog
          class="confirmDialog"
          .item=${this.itemName}
          .itemTypeName=${this.computeItemTypeName(this.itemType)}
          @confirm=${this.handleDeleteConfirm}
          @cancel=${this.handleConfirmDialogCancel}
        ></gr-confirm-delete-item-dialog>
      </dialog>
    `}getAccountSuggestions(e,t,i,r=!1){return this.restApiService.queryAccounts(e,15,i,r,Ff).then((e=>{if(!e)return[];const i=[];for(const r of e)i.push({name:sx(t,r),value:r._account_id?.toString()});return i}))}renderGroupMember(e,t){return dc`
      <tr>
        <td class="nameColumn">
          <gr-account-label .account=${e} clickable></gr-account-label>
        </td>
        <td>${e.email}</td>
        <td class="deleteColumn">
          <gr-button
            class="deleteMembersButton"
            data-index=${t}
            @click=${this.handleDeleteMember}
          >
            Delete
          </gr-button>
        </td>
      </tr>
    `}renderIncludedGroup(e,t){return dc`
      <tr>
        <td class="nameColumn">${this.renderIncludedGroupHref(e)}</td>
        <td>${e.description}</td>
        <td class="deleteColumn">
          <gr-button
            class="deleteIncludedGroupButton"
            data-index=${t}
            @click=${this.handleDeleteIncludedGroup}
          >
            Delete
          </gr-button>
        </td>
      </tr>
    `}renderIncludedGroupHref(e){return e.url?dc`
        <a href=${Vw(this.computeGroupUrl(e.url))} rel="noopener">
          ${e.name}
        </a>
      `:e.name}loadGroupDetails(){if(!this.groupId)return;const e=[];return this.restApiService.getGroupConfig(this.groupId,(e=>{ia(e)})).then((t=>t&&t.name?(this.groupName=t.name,e.push(this.restApiService.getIsAdmin().then((e=>{this.isAdmin=!!e}))),e.push(this.restApiService.getIsGroupOwner(this.groupName).then((e=>{this.groupOwner=!!e}))),e.push(this.restApiService.getGroupMembers(this.groupName).then((e=>{this.groupMembers=e}))),e.push(this.restApiService.getIncludedGroup(this.groupName).then((e=>{this.includedGroups=e}))),Promise.all(e).then((()=>{this.loading=!1}))):Promise.resolve()))}computeGroupUrl(e){if(e)return new RegExp("^(?:[a-z]+:)?//","i").test(e)?e:e.startsWith("#")?Sf()+e.slice(1):Sf()+e}handleSavingGroupMember(){return this.groupName?this.restApiService.saveGroupMember(this.groupName,this.groupMemberSearchId).then((e=>{e&&this.groupName&&(this.restApiService.getGroupMembers(this.groupName).then((e=>{this.groupMembers=e})),this.groupMemberSearchName="",this.groupMemberSearchId=void 0)})):Promise.reject(new Error("group name undefined"))}handleDeleteConfirm(){return this.groupName?(this.modal.close(),this.itemType===CE.MEMBER?this.restApiService.deleteGroupMember(this.groupName,this.itemId).then((e=>{204===e.status&&this.groupName&&this.restApiService.getGroupMembers(this.groupName).then((e=>{this.groupMembers=e}))})):this.itemType===CE.INCLUDED_GROUP?this.restApiService.deleteIncludedGroup(this.groupName,this.itemId).then((e=>{204!==e.status&&205!==e.status||!this.groupName||this.restApiService.getIncludedGroup(this.groupName).then((e=>{this.includedGroups=e}))})):Promise.reject(new Error("Unrecognized item type"))):Promise.reject(new Error("group name undefined"))}computeItemTypeName(e){if(void 0===e)return"";switch(e){case CE.INCLUDED_GROUP:return"Included Group";case CE.MEMBER:return"Member";default:fa(e,"unknown item type: ${itemType}")}}handleConfirmDialogCancel(){this.modal.close()}handleDeleteMember(e){if(!this.groupMembers)return;const t=e.target,i=Number(t.getAttribute("data-index")),r=this.groupMembers[i],o=r.username||r.name||r.email||r._account_id?.toString();o&&(this.itemName=o,this.itemId=r._account_id,this.itemType=CE.MEMBER,this.modal.showModal())}handleSavingIncludedGroups(){return this.groupName&&this.includedGroupSearchId?this.restApiService.saveIncludedGroup(this.groupName,this.includedGroupSearchId.replace(/\+/g," "),((e,t)=>{if(e){if(404===e.status)return void ea(this,"Group may not exist, or you may not have permission to add it");throw Error(e.statusText)}throw t})).then((e=>{e&&this.groupName&&(this.restApiService.getIncludedGroup(this.groupName).then((e=>{this.includedGroups=e})),this.includedGroupSearchName="",this.includedGroupSearchId="")})):Promise.reject(new Error("group name or includedGroupSearchId undefined"))}handleDeleteIncludedGroup(e){if(!this.includedGroups)return;const t=e.target,i=Number(t.getAttribute("data-index")),r=this.includedGroups[i],o=decodeURIComponent(r.id).replace(/\+/g," "),s=r.name||o;s&&(this.itemName=s,this.itemId=o,this.itemType=CE.INCLUDED_GROUP,this.modal.showModal())}getGroupSuggestions(e){return this.restApiService.getSuggestedGroups(e,void 0,void 0,Ff).then((e=>{const t=[];for(const[i,r]of Object.entries(e??{}))t.push({name:i,value:decodeURIComponent(r.id)});return t}))}handleGroupMemberTextChanged(e){this.loading||(this.groupMemberSearchName=e.detail.value)}handleGroupMemberValueChanged(e){this.loading||(this.groupMemberSearchId=e.detail.value)}handleIncludedGroupTextChanged(e){this.loading||(this.includedGroupSearchName=e.detail.value)}handleIncludedGroupValueChanged(e){this.loading||(this.includedGroupSearchId=e.detail.value)}};EE([Hc("#modal")],SE.prototype,"modal",void 0),EE([Fc({type:String})],SE.prototype,"groupId",void 0),EE([Uc()],SE.prototype,"groupMemberSearchId",void 0),EE([Uc()],SE.prototype,"groupMemberSearchName",void 0),EE([Uc()],SE.prototype,"includedGroupSearchId",void 0),EE([Uc()],SE.prototype,"includedGroupSearchName",void 0),EE([Uc()],SE.prototype,"loading",void 0),EE([Uc()],SE.prototype,"groupName",void 0),EE([Uc()],SE.prototype,"groupMembers",void 0),EE([Uc()],SE.prototype,"includedGroups",void 0),EE([Uc()],SE.prototype,"itemName",void 0),EE([Uc()],SE.prototype,"itemType",void 0),EE([Uc()],SE.prototype,"queryMembers",void 0),EE([Uc()],SE.prototype,"queryIncludedGroup",void 0),EE([Uc()],SE.prototype,"groupOwner",void 0),EE([Uc()],SE.prototype,"isAdmin",void 0),EE([Uc()],SE.prototype,"itemId",void 0),SE=EE([Dc("gr-group-members")],SE);var $E=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let kE=class extends Ic{constructor(){super(...arguments),this.offset=0,this.pluginsPerPage=25,this.loading=!0,this.filter="",this.restApiService=Xn().restApiService}connectedCallback(){super.connectedCallback(),oa("Plugins")}static get styles(){return[pw,Nc,Sd`
        .placeholder {
          color: var(--deemphasized-text-color);
        }
      `]}render(){return dc`
      <gr-list-view
        .filter=${this.filter}
        .itemsPerPage=${this.pluginsPerPage}
        .items=${this.plugins}
        .loading=${this.loading}
        .offset=${this.offset}
        .path=${Aw({adminView:Cw.PLUGINS})}
      >
        <table id="list" class="genericList">
          <tbody>
            <tr class="headerRow">
              <th class="name topHeader">Plugin Name</th>
              <th class="version topHeader">Version</th>
              <th class="apiVersion topHeader">API Version</th>
              <th class="status topHeader">Status</th>
            </tr>
            ${this.renderLoading()}
          </tbody>
          ${this.renderPluginListsTable()}
        </table>
      </gr-list-view>
    `}renderLoading(){if(this.loading)return dc`
      <tr id="loading" class="loadingMsg loading">
        <td>Loading...</td>
      </tr>
    `}renderPluginListsTable(){if(!this.loading)return dc`
      <tbody>
        ${this.plugins?.slice(0,this.pluginsPerPage).map((e=>this.renderPluginList(e)))}
      </tbody>
    `}renderPluginList(e){return dc`
      <tr class="table">
        <td class="name">
          ${e.index_url?dc`<a href=${this.computePluginUrl(e.index_url)}
                >${e.id}</a
              >`:e.id}
        </td>
        <td class="version">
          ${e.version?e.version:dc`<span class="placeholder">--</span>`}
        </td>
        <td class="apiVersion">
          ${e.api_version?e.api_version:dc`<span class="placeholder">--</span>`}
        </td>
        <td class="status">
          ${!0===e.disabled?"Disabled":"Enabled"}
        </td>
      </tr>
    `}willUpdate(e){e.has("params")&&this.paramsChanged()}paramsChanged(){return this.loading=!0,this.filter=this.params?.filter??"",this.offset=Number(this.params?.offset??0),this.getPlugins(this.filter,this.pluginsPerPage,this.offset)}getPlugins(e,t,i){return this.restApiService.getPlugins(e,t,i,(e=>{ia(e)})).then((e=>{this.plugins=e?Object.keys(e).map((t=>({...e[t],name:t}))):[]})).finally((()=>{this.loading=!1}))}computePluginUrl(e){return Sf()+"/"+Rf(e)}};$E([Fc({type:Object})],kE.prototype,"params",void 0),$E([Uc()],kE.prototype,"offset",void 0),$E([Uc()],kE.prototype,"plugins",void 0),$E([Uc()],kE.prototype,"pluginsPerPage",void 0),$E([Uc()],kE.prototype,"loading",void 0),$E([Uc()],kE.prototype,"filter",void 0),kE=$E([Dc("gr-plugin-list")],kE);var AE=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let RE=class extends Ic{constructor(){super(...arguments),this.tooltip=""}static get styles(){return[Nc,Sd`
        .commandContainer {
          margin-bottom: var(--spacing-m);
        }
        .commandContainer {
          background-color: var(--shell-command-background-color);
          /* Should be spacing-m larger than the :before width. */
          padding: var(--spacing-m) var(--spacing-m) var(--spacing-m)
            calc(3 * var(--spacing-m) + 0.5em);
          position: relative;
          width: 100%;
        }
        .commandContainer:before {
          content: '$';
          position: absolute;
          display: block;
          box-sizing: border-box;
          background: var(--shell-command-decoration-background-color);
          top: 0;
          bottom: 0;
          left: 0;
          /* Should be spacing-m smaller than the .commandContainer padding-left. */
          width: calc(2 * var(--spacing-m) + 0.5em);
          /* Should vertically match the padding of .commandContainer. */
          padding: var(--spacing-m);
          /* Should roughly match the height of .commandContainer without padding. */
          line-height: 26px;
        }
        .commandContainer gr-copy-clipboard::part(text-container-style) {
          border: none;
        }
      `]}render(){const e=this.label??"";return dc` <label>${e}</label>
      <div class="commandContainer">
        <gr-copy-clipboard
          .text=${this.command}
          hasTooltip
          buttonTitle=${this.tooltip}
        ></gr-copy-clipboard>
      </div>`}async focusOnCopy(){await this.updateComplete;const e=_a(this,"gr-copy-clipboard");e&&e.focusOnCopy()}};AE([Fc({type:String})],RE.prototype,"command",void 0),AE([Fc({type:String})],RE.prototype,"label",void 0),AE([Fc({type:String})],RE.prototype,"tooltip",void 0),RE=AE([Dc("gr-shell-command")],RE);const TE=Symbol("isFocusable"),IE=Symbol("privateIsFocusable"),PE=Symbol("externalTabIndex"),NE=Symbol("isUpdatingTabIndex"),OE=Symbol("updateTabIndex");function DE(e){var t,i,r;class o extends e{constructor(){super(...arguments),this[t]=!0,this[i]=null,this[r]=!1}get[TE](){return this[IE]}set[TE](e){this[TE]!==e&&(this[IE]=e,this[OE]())}connectedCallback(){super.connectedCallback(),this[OE]()}attributeChangedCallback(e,t,i){if("tabindex"===e){if(this.requestUpdate("tabIndex",Number(t??-1)),!this[NE])return this.hasAttribute("tabindex")?void(this[PE]=this.tabIndex):(this[PE]=null,void this[OE]())}else super.attributeChangedCallback(e,t,i)}[(t=IE,i=PE,r=NE,OE)](){const e=this[TE]?0:-1,t=this[PE]??e;this[NE]=!0,this.tabIndex=t,this[NE]=!1}}return zg([Fc({noAccessor:!0})],o.prototype,"tabIndex",void 0),o}const LE=Symbol("animateIndicator"),ME=DE(Ic);class FE extends ME{get selected(){return this.active}set selected(e){this.active=e}constructor(){super(),this.isTab=!0,this.active=!1,this.hasIcon=!1,this.iconOnly=!1,this.fullWidthIndicator=!1,this.internals=this.attachInternals(),this.internals.role="tab",this.addEventListener("keydown",this.handleKeydown.bind(this))}render(){const e=dc`<div class="indicator"></div>`;return dc`<div
      class="button"
      role="presentation"
      @click=${this.handleContentClick}>
      <md-focus-ring part="focus-ring" inward .control=${this}></md-focus-ring>
      <md-elevation part="elevation"></md-elevation>
      <md-ripple .control=${this}></md-ripple>
      <div
        class="content ${th(this.getContentClasses())}"
        role="presentation">
        <slot name="icon" @slotchange=${this.handleIconSlotChange}></slot>
        <slot @slotchange=${this.handleSlotChange}></slot>
        ${this.fullWidthIndicator?uc:e}
      </div>
      ${this.fullWidthIndicator?e:uc}
    </div>`}getContentClasses(){return{"has-icon":this.hasIcon,"has-label":!this.iconOnly}}updated(){this.internals.ariaSelected=String(this.active)}async handleKeydown(e){await 0,e.defaultPrevented||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.click())}handleContentClick(e){e.stopPropagation(),this.click()}[LE](e){if(!this.indicator)return;this.indicator.getAnimations().forEach((e=>{e.cancel()}));const t=this.getKeyframes(e);null!==t&&this.indicator.animate(t,{duration:250,easing:rm})}getKeyframes(e){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!this.active)return t?[{opacity:1},{transform:"none"}]:null;const i={},r=e.indicator?.getBoundingClientRect()??{},o=r.left,s=r.width,n=this.indicator.getBoundingClientRect(),a=n.left,l=s/n.width;return t||void 0===o||void 0===a||isNaN(l)?i.opacity=0:i.transform=`translateX(${(o-a).toFixed(4)}px) scaleX(${l.toFixed(4)})`,[i,{transform:"none"}]}handleSlotChange(){this.iconOnly=!1;for(const e of this.assignedDefaultNodes){const t=e.nodeType===Node.TEXT_NODE&&!!e.wholeText.match(/\S/);if(e.nodeType===Node.ELEMENT_NODE||t)return}this.iconOnly=!0}handleIconSlotChange(){this.hasIcon=this.assignedIcons.length>0}}zg([Fc({type:Boolean,reflect:!0,attribute:"md-tab"})],FE.prototype,"isTab",void 0),zg([Fc({type:Boolean,reflect:!0})],FE.prototype,"active",void 0),zg([Fc({type:Boolean})],FE.prototype,"selected",null),zg([Fc({type:Boolean,attribute:"has-icon"})],FE.prototype,"hasIcon",void 0),zg([Fc({type:Boolean,attribute:"icon-only"})],FE.prototype,"iconOnly",void 0),zg([Hc(".indicator")],FE.prototype,"indicator",void 0),zg([Uc()],FE.prototype,"fullWidthIndicator",void 0),zg([Wc({flatten:!0})],FE.prototype,"assignedDefaultNodes",void 0),zg([Vc({slot:"icon",flatten:!0})],FE.prototype,"assignedIcons",void 0);class UE extends FE{constructor(){super(...arguments),this.fullWidthIndicator=!0}}const BE=Sd`:host{--_active-indicator-color: var(--md-secondary-tab-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_active-indicator-height: var(--md-secondary-tab-active-indicator-height, 2px);--_active-label-text-color: var(--md-secondary-tab-active-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_container-color: var(--md-secondary-tab-container-color, var(--md-sys-color-surface, #fef7ff));--_container-elevation: var(--md-secondary-tab-container-elevation, 0);--_container-height: var(--md-secondary-tab-container-height, 48px);--_focus-label-text-color: var(--md-secondary-tab-focus-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-secondary-tab-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-state-layer-color: var(--md-secondary-tab-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-state-layer-opacity: var(--md-secondary-tab-hover-state-layer-opacity, 0.08);--_label-text-font: var(--md-secondary-tab-label-text-font, var(--md-sys-typescale-title-small-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-secondary-tab-label-text-line-height, var(--md-sys-typescale-title-small-line-height, 1.25rem));--_label-text-size: var(--md-secondary-tab-label-text-size, var(--md-sys-typescale-title-small-size, 0.875rem));--_label-text-weight: var(--md-secondary-tab-label-text-weight, var(--md-sys-typescale-title-small-weight, var(--md-ref-typeface-weight-medium, 500)));--_pressed-label-text-color: var(--md-secondary-tab-pressed-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_pressed-state-layer-color: var(--md-secondary-tab-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_pressed-state-layer-opacity: var(--md-secondary-tab-pressed-state-layer-opacity, 0.12);--_active-focus-icon-color: var(--md-secondary-tab-active-focus-icon-color, );--_active-focus-label-text-color: var(--md-secondary-tab-active-focus-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_active-hover-icon-color: var(--md-secondary-tab-active-hover-icon-color, );--_active-hover-label-text-color: var(--md-secondary-tab-active-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_active-hover-state-layer-color: var(--md-secondary-tab-active-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_active-hover-state-layer-opacity: var(--md-secondary-tab-active-hover-state-layer-opacity, 0.08);--_active-icon-color: var(--md-secondary-tab-active-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_active-indicator-shape: var(--md-secondary-tab-active-indicator-shape, 0);--_active-pressed-icon-color: var(--md-secondary-tab-active-pressed-icon-color, );--_active-pressed-label-text-color: var(--md-secondary-tab-active-pressed-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_active-pressed-state-layer-color: var(--md-secondary-tab-active-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_active-pressed-state-layer-opacity: var(--md-secondary-tab-active-pressed-state-layer-opacity, 0.12);--_label-text-color: var(--md-secondary-tab-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-icon-color: var(--md-secondary-tab-focus-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-icon-color: var(--md-secondary-tab-hover-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_icon-size: var(--md-secondary-tab-icon-size, 24px);--_icon-color: var(--md-secondary-tab-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-icon-color: var(--md-secondary-tab-pressed-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_container-shape-start-start: var(--md-secondary-tab-container-shape-start-start, var(--md-secondary-tab-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-start-end: var(--md-secondary-tab-container-shape-start-end, var(--md-secondary-tab-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-end: var(--md-secondary-tab-container-shape-end-end, var(--md-secondary-tab-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-start: var(--md-secondary-tab-container-shape-end-start, var(--md-secondary-tab-container-shape, var(--md-sys-shape-corner-none, 0px)))}
`,HE=Sd`:host{display:inline-flex;align-items:center;justify-content:center;outline:none;padding:0 16px;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0);vertical-align:middle;user-select:none;font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight);color:var(--_label-text-color);z-index:0;--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity);--md-elevation-level: var(--_container-elevation)}md-focus-ring{--md-focus-ring-shape: 8px}:host([active]) md-focus-ring{margin-bottom:calc(var(--_active-indicator-height) + 1px)}.button::before{background:var(--_container-color);content:"";inset:0;position:absolute;z-index:-1}.button::before,md-ripple,md-elevation{border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-end-radius:var(--_container-shape-end-end);border-end-start-radius:var(--_container-shape-end-start)}.content{position:relative;box-sizing:border-box;display:inline-flex;flex-direction:row;align-items:center;justify-content:center;height:var(--_container-height);gap:8px}.indicator{position:absolute;box-sizing:border-box;z-index:-1;transform-origin:bottom left;background:var(--_active-indicator-color);border-radius:var(--_active-indicator-shape);height:var(--_active-indicator-height);inset:auto 0 0 0;opacity:0}::slotted([slot=icon]){display:inline-flex;position:relative;writing-mode:horizontal-tb;fill:currentColor;color:var(--_icon-color);font-size:var(--_icon-size);width:var(--_icon-size);height:var(--_icon-size)}:host(:hover){color:var(--_hover-label-text-color);cursor:pointer}:host(:hover) ::slotted([slot=icon]){color:var(--_hover-icon-color)}:host(:focus){color:var(--_focus-label-text-color)}:host(:focus) ::slotted([slot=icon]){color:var(--_focus-icon-color)}:host(:active){color:var(--_pressed-label-text-color)}:host(:active) ::slotted([slot=icon]){color:var(--_pressed-icon-color)}:host([active]) .indicator{opacity:1}:host([active]){color:var(--_active-label-text-color);--md-ripple-hover-color: var(--_active-hover-state-layer-color);--md-ripple-hover-opacity: var(--_active-hover-state-layer-opacity);--md-ripple-pressed-color: var(--_active-pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_active-pressed-state-layer-opacity)}:host([active]) ::slotted([slot=icon]){color:var(--_active-icon-color)}:host([active]:hover){color:var(--_active-hover-label-text-color)}:host([active]:hover) ::slotted([slot=icon]){color:var(--_active-hover-icon-color)}:host([active]:focus){color:var(--_active-focus-label-text-color)}:host([active]:focus) ::slotted([slot=icon]){color:var(--_active-focus-icon-color)}:host([active]:active){color:var(--_active-pressed-label-text-color)}:host([active]:active) ::slotted([slot=icon]){color:var(--_active-pressed-icon-color)}:host,::slotted(*){white-space:nowrap}@media(forced-colors: active){.indicator{background:CanvasText}}
`;let jE=class extends UE{};jE.styles=[HE,BE],jE=zg([Dc("md-secondary-tab")],jE);class GE extends Ic{get activeTab(){return this.tabs.find((e=>e.active))??null}set activeTab(e){e&&this.activateTab(e)}get activeTabIndex(){return this.tabs.findIndex((e=>e.active))}set activeTabIndex(e){const t=()=>{const t=this.tabs[e];t&&this.activateTab(t)};this.slotElement?t():this.updateComplete.then(t)}get focusedTab(){return this.tabs.find((e=>e.matches(":focus-within")))}constructor(){super(),this.autoActivate=!1,this.internals=this.attachInternals(),this.internals.role="tablist",this.addEventListener("keydown",this.handleKeydown.bind(this)),this.addEventListener("keyup",this.handleKeyup.bind(this)),this.addEventListener("focusout",this.handleFocusout.bind(this))}async scrollToTab(e){await this.updateComplete;const{tabs:t}=this;if(e??=this.activeTab,!e||!t.includes(e)||!this.tabsScrollerElement)return;for(const e of this.tabs)await e.updateComplete;const i=e.offsetLeft,r=e.offsetWidth,o=this.scrollLeft,s=i-48,n=i+r-this.offsetWidth+48,a=Math.min(s,Math.max(n,o)),l=this.focusedTab?"auto":"instant";this.tabsScrollerElement.scrollTo({behavior:l,top:0,left:a})}render(){return dc`
      <div class="tabs">
        <slot
          @slotchange=${this.handleSlotChange}
          @click=${this.handleTabClick}></slot>
      </div>
      <md-divider part="divider"></md-divider>
    `}async handleTabClick(e){const t=e.target;var i;await 0,e.defaultPrevented||!((i=t)instanceof HTMLElement&&i.hasAttribute("md-tab"))||t.active||this.activateTab(t)}activateTab(e){const{tabs:t}=this,i=this.activeTab;if(t.includes(e)&&i!==e){for(const i of t)i.active=i===e;if(i){if(!this.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))){for(const e of t)e.active=e===i;return}e[LE](i)}this.updateFocusableTab(e),this.scrollToTab(e)}}updateFocusableTab(e){for(const t of this.tabs)t.tabIndex=t===e?0:-1}async handleKeydown(e){await 0;const t="ArrowLeft"===e.key,i="ArrowRight"===e.key,r="Home"===e.key,o="End"===e.key;if(e.defaultPrevented||!t&&!i&&!r&&!o)return;const{tabs:s}=this;if(s.length<2)return;let n;if(e.preventDefault(),r||o)n=r?0:s.length-1;else{const e="rtl"===getComputedStyle(this).direction?t:i,{focusedTab:r}=this;if(r){const t=this.tabs.indexOf(r);n=e?t+1:t-1,n>=s.length?n=0:n<0&&(n=s.length-1)}else n=e?0:s.length-1}const a=s[n];a.focus(),this.autoActivate?this.activateTab(a):this.updateFocusableTab(a)}handleKeyup(){this.scrollToTab(this.focusedTab??this.activeTab)}handleFocusout(){if(this.matches(":focus-within"))return;const{activeTab:e}=this;e&&this.updateFocusableTab(e)}handleSlotChange(){const e=this.tabs[0];!this.activeTab&&e&&this.activateTab(e),this.scrollToTab(this.activeTab)}}zg([Vc({flatten:!0,selector:"[md-tab]"})],GE.prototype,"tabs",void 0),zg([Fc({type:Number,attribute:"active-tab-index"})],GE.prototype,"activeTabIndex",null),zg([Fc({type:Boolean,attribute:"auto-activate"})],GE.prototype,"autoActivate",void 0),zg([Hc(".tabs")],GE.prototype,"tabsScrollerElement",void 0),zg([Hc("slot")],GE.prototype,"slotElement",void 0);const zE=Sd`:host{box-sizing:border-box;display:flex;flex-direction:column;overflow:auto;scroll-behavior:smooth;scrollbar-width:none;position:relative}:host([hidden]){display:none}:host::-webkit-scrollbar{display:none}.tabs{align-items:end;display:flex;height:100%;overflow:inherit;scroll-behavior:inherit;scrollbar-width:inherit;justify-content:space-between;width:100%}::slotted(*){flex:1}::slotted([active]){z-index:1}
`;let VE=class extends GE{};VE.styles=[zE],VE=zg([Dc("md-tabs")],VE);var WE=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let qE=class extends Ic{constructor(){super(),this.commands=[],this.loggedIn=!1,this.schemes=[],this.showKeyboardShortcutTooltips=!1,this.getUserModel=yu(this,jf),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.loggedIn=e)),zf(this,(()=>this.getUserModel().preferences$),(e=>{e?.download_scheme&&(this.selectedScheme=e.download_scheme.toLowerCase(),Jn(this,"selected-scheme-changed",{value:this.selectedScheme}))}))}static get styles(){return[Jy,Nc,Sd`
        md-tabs {
          height: 3rem;
          margin-bottom: var(--spacing-m);
        }
        md-secondary-tab {
          max-width: 15rem;
          text-transform: uppercase;
        }
        label,
        input {
          display: block;
        }
        label {
          font-weight: var(--font-weight-medium);
        }
        .schemes {
          display: flex;
          justify-content: space-between;
        }
        .description {
          margin-bottom: var(--spacing-m);
        }
        .commands {
          display: flex;
          flex-direction: column;
        }
        gr-shell-command {
          margin-bottom: var(--spacing-m);
        }
        .hidden {
          display: none;
        }
      `]}render(){return dc`
      <div class="schemes">${this.renderDownloadTabs()}</div>
      ${this.renderDescription()} ${this.renderCommands()}
    `}renderDownloadTabs(){const e=this.schemes.findIndex((e=>e===this.selectedScheme))||0;return e<0?uc:dc`
      <md-tabs
        id="downloadTabs"
        class=${this.computeShowTabs()}
        .activeTabIndex=${e}
        @change=${this.handleTabChange}
      >
        ${this.schemes.map((e=>this.renderMdSecondaryTab(e)))}
      </md-tabs>
    `}renderDescription(){if(this.description)return dc`<div class="description">${this.description}</div>`}renderMdSecondaryTab(e){return dc`
      <md-secondary-tab data-scheme=${e}>${e}</md-secondary-tab>
    `}renderCommands(){return dc`
      <div class="commands" ?hidden=${!this.schemes.length}></div>
        ${this.commands?.map(((e,t)=>this.renderShellCommand(e,t)))}
      </div>
    `}renderShellCommand(e,t){return dc`
      <gr-shell-command
        class=${this.computeClass(e.title)}
        .label=${e.title}
        .command=${e.command}
        .tooltip=${this.computeTooltip(t)}
      ></gr-shell-command>
    `}async focusOnCopy(){await this.updateComplete,await _a(this,"gr-shell-command").focusOnCopy()}handleTabChange(e){const t=e.target.activeTabIndex,i=this.schemes[t];i&&i!==this.selectedScheme&&(this.selectedScheme=i,Jn(this,"selected-scheme-changed",{value:i}),this.loggedIn&&this.getUserModel().updatePreferences({download_scheme:this.selectedScheme}))}computeTooltip(e){return e<=8&&this.showKeyboardShortcutTooltips?`Keyboard shortcut: ${e+1}`:""}computeShowTabs(){return this.schemes.length>1?"":"hidden"}computeClass(e){return"_label_"+e.replace(/[^a-z]+/gi,"").toLowerCase()}};WE([Fc({type:Array})],qE.prototype,"commands",void 0),WE([Uc()],qE.prototype,"loggedIn",void 0),WE([Fc({type:Array})],qE.prototype,"schemes",void 0),WE([Fc({type:String})],qE.prototype,"selectedScheme",void 0),WE([Fc({type:String})],qE.prototype,"description",void 0),WE([Fc({type:Boolean,attribute:"show-keyboard-shortcut-tooltips"})],qE.prototype,"showKeyboardShortcutTooltips",void 0),qE=WE([Dc("gr-download-commands")],qE);const KE=Symbol("dispatchHooks"),YE=new WeakMap,XE=fm(Py(Dy(_m(Ic))));class JE extends XE{constructor(){super(),this.selected=!1,this.icons=!1,this.showOnlySelectedIcon=!1,this.required=!1,this.value="on",this.addEventListener("click",(e=>{Em(e)&&this.input&&(this.focus(),Cm(this.input))})),function(e,...t){let i=YE.get(e);i||(i=new Set,YE.set(e,i));for(const r of t){if(i.has(r))continue;let t=!1;e.addEventListener(r,(i=>{if(t)return;i.stopImmediatePropagation();const r=Reflect.construct(i.constructor,[i.type,i]),o=new EventTarget;r[KE]=o,t=!0;const s=e.dispatchEvent(r);t=!1,s||i.preventDefault(),o.dispatchEvent(new Event("after"))}),{capture:!0}),i.add(r)}}(this,"keydown"),this.addEventListener("keydown",(e=>{!function(e,t){const i=e[KE];if(!i)throw new Error(`'${e.type}' event needs setupDispatchHooks().`);i.addEventListener("after",t)}(e,(()=>{e.defaultPrevented||"Enter"!==e.key||this.disabled||!this.input||this.input.click()}))}))}render(){return dc`
      <div class="switch ${th(this.getRenderClasses())}">
        <input
          id="switch"
          class="touch"
          type="checkbox"
          role="switch"
          aria-label=${this.ariaLabel||uc}
          ?checked=${this.selected}
          ?disabled=${this.disabled}
          ?required=${this.required}
          @input=${this.handleInput}
          @change=${this.handleChange} />

        <md-focus-ring part="focus-ring" for="switch"></md-focus-ring>
        <span class="track"> ${this.renderHandle()} </span>
      </div>
    `}getRenderClasses(){return{selected:this.selected,unselected:!this.selected,disabled:this.disabled}}renderHandle(){const e={"with-icon":this.showOnlySelectedIcon?this.selected:this.icons};return dc`
      ${this.renderTouchTarget()}
      <span class="handle-container">
        <md-ripple for="switch" ?disabled="${this.disabled}"></md-ripple>
        <span class="handle ${th(e)}">
          ${this.shouldShowIcons()?this.renderIcons():dc``}
        </span>
      </span>
    `}renderIcons(){return dc`
      <div class="icons">
        ${this.renderOnIcon()}
        ${this.showOnlySelectedIcon?dc``:this.renderOffIcon()}
      </div>
    `}renderOnIcon(){return dc`
      <slot class="icon icon--on" name="on-icon">
        <svg viewBox="0 0 24 24">
          <path
            d="M9.55 18.2 3.65 12.3 5.275 10.675 9.55 14.95 18.725 5.775 20.35 7.4Z" />
        </svg>
      </slot>
    `}renderOffIcon(){return dc`
      <slot class="icon icon--off" name="off-icon">
        <svg viewBox="0 0 24 24">
          <path
            d="M6.4 19.2 4.8 17.6 10.4 12 4.8 6.4 6.4 4.8 12 10.4 17.6 4.8 19.2 6.4 13.6 12 19.2 17.6 17.6 19.2 12 13.6Z" />
        </svg>
      </slot>
    `}renderTouchTarget(){return dc`<span class="touch"></span>`}shouldShowIcons(){return this.icons||this.showOnlySelectedIcon}handleInput(e){const t=e.target;this.selected=t.checked}handleChange(e){$y(this,e)}[Ny](){return this.selected?this.value:null}[Oy](){return String(this.selected)}formResetCallback(){this.selected=this.hasAttribute("selected")}formStateRestoreCallback(e){this.selected="true"===e}[ky](){return new sw((()=>({checked:this.selected,required:this.required})))}[Ay](){return this.input}}JE.shadowRootOptions={mode:"open",delegatesFocus:!0},zg([Fc({type:Boolean})],JE.prototype,"selected",void 0),zg([Fc({type:Boolean})],JE.prototype,"icons",void 0),zg([Fc({type:Boolean,attribute:"show-only-selected-icon"})],JE.prototype,"showOnlySelectedIcon",void 0),zg([Fc({type:Boolean})],JE.prototype,"required",void 0),zg([Fc()],JE.prototype,"value",void 0),zg([Hc("input")],JE.prototype,"input",void 0);const QE=Sd`@layer styles, hcm;@layer styles{:host{display:inline-flex;outline:none;vertical-align:top;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer}:host([disabled]){cursor:default}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--md-switch-track-height, 32px))/2) 0px}md-focus-ring{--md-focus-ring-shape-start-start: var(--md-switch-track-shape-start-start, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));--md-focus-ring-shape-start-end: var(--md-switch-track-shape-start-end, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));--md-focus-ring-shape-end-end: var(--md-switch-track-shape-end-end, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));--md-focus-ring-shape-end-start: var(--md-switch-track-shape-end-start, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)))}.switch{align-items:center;display:inline-flex;flex-shrink:0;position:relative;width:var(--md-switch-track-width, 52px);height:var(--md-switch-track-height, 32px);border-start-start-radius:var(--md-switch-track-shape-start-start, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));border-start-end-radius:var(--md-switch-track-shape-start-end, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));border-end-end-radius:var(--md-switch-track-shape-end-end, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)));border-end-start-radius:var(--md-switch-track-shape-end-start, var(--md-switch-track-shape, var(--md-sys-shape-corner-full, 9999px)))}input{appearance:none;height:max(100%,var(--md-switch-touch-target-size, 48px));outline:none;margin:0;position:absolute;width:max(100%,var(--md-switch-touch-target-size, 48px));z-index:1;cursor:inherit;top:50%;left:50%;transform:translate(-50%, -50%)}:host([touch-target=none]) input{display:none}}@layer styles{.track{position:absolute;width:100%;height:100%;box-sizing:border-box;border-radius:inherit;display:flex;justify-content:center;align-items:center}.track::before{content:"";display:flex;position:absolute;height:100%;width:100%;border-radius:inherit;box-sizing:border-box;transition-property:opacity,background-color;transition-timing-function:linear;transition-duration:67ms}.disabled .track{background-color:rgba(0,0,0,0);border-color:rgba(0,0,0,0)}.disabled .track::before,.disabled .track::after{transition:none;opacity:var(--md-switch-disabled-track-opacity, 0.12)}.disabled .track::before{background-clip:content-box}.selected .track::before{background-color:var(--md-switch-selected-track-color, var(--md-sys-color-primary, #6750a4))}.selected:hover .track::before{background-color:var(--md-switch-selected-hover-track-color, var(--md-sys-color-primary, #6750a4))}.selected:focus-within .track::before{background-color:var(--md-switch-selected-focus-track-color, var(--md-sys-color-primary, #6750a4))}.selected:active .track::before{background-color:var(--md-switch-selected-pressed-track-color, var(--md-sys-color-primary, #6750a4))}.selected.disabled .track{background-clip:border-box}.selected.disabled .track::before{background-color:var(--md-switch-disabled-selected-track-color, var(--md-sys-color-on-surface, #1d1b20))}.unselected .track::before{background-color:var(--md-switch-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-track-outline-color, var(--md-sys-color-outline, #79747e));border-style:solid;border-width:var(--md-switch-track-outline-width, 2px)}.unselected:hover .track::before{background-color:var(--md-switch-hover-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-hover-track-outline-color, var(--md-sys-color-outline, #79747e))}.unselected:focus-visible .track::before{background-color:var(--md-switch-focus-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-focus-track-outline-color, var(--md-sys-color-outline, #79747e))}.unselected:active .track::before{background-color:var(--md-switch-pressed-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-pressed-track-outline-color, var(--md-sys-color-outline, #79747e))}.unselected.disabled .track::before{background-color:var(--md-switch-disabled-track-color, var(--md-sys-color-surface-container-highest, #e6e0e9));border-color:var(--md-switch-disabled-track-outline-color, var(--md-sys-color-on-surface, #1d1b20))}}@layer hcm{@media(forced-colors: active){.selected .track::before{background:ButtonText;border-color:ButtonText}.disabled .track::before{border-color:GrayText;opacity:1}.disabled.selected .track::before{background:GrayText}}}@layer styles{.handle-container{display:flex;place-content:center;place-items:center;position:relative;transition:margin 300ms cubic-bezier(0.175, 0.885, 0.32, 1.275)}.selected .handle-container{margin-inline-start:calc(var(--md-switch-track-width, 52px) - var(--md-switch-track-height, 32px))}.unselected .handle-container{margin-inline-end:calc(var(--md-switch-track-width, 52px) - var(--md-switch-track-height, 32px))}.disabled .handle-container{transition:none}.handle{border-start-start-radius:var(--md-switch-handle-shape-start-start, var(--md-switch-handle-shape, var(--md-sys-shape-corner-full, 9999px)));border-start-end-radius:var(--md-switch-handle-shape-start-end, var(--md-switch-handle-shape, var(--md-sys-shape-corner-full, 9999px)));border-end-end-radius:var(--md-switch-handle-shape-end-end, var(--md-switch-handle-shape, var(--md-sys-shape-corner-full, 9999px)));border-end-start-radius:var(--md-switch-handle-shape-end-start, var(--md-switch-handle-shape, var(--md-sys-shape-corner-full, 9999px)));height:var(--md-switch-handle-height, 16px);width:var(--md-switch-handle-width, 16px);transform-origin:center;transition-property:height,width;transition-duration:250ms,250ms;transition-timing-function:cubic-bezier(0.2, 0, 0, 1),cubic-bezier(0.2, 0, 0, 1);z-index:0}.handle::before{content:"";display:flex;inset:0;position:absolute;border-radius:inherit;box-sizing:border-box;transition:background-color 67ms linear}.disabled .handle,.disabled .handle::before{transition:none}.selected .handle{height:var(--md-switch-selected-handle-height, 24px);width:var(--md-switch-selected-handle-width, 24px)}.handle.with-icon{height:var(--md-switch-with-icon-handle-height, 24px);width:var(--md-switch-with-icon-handle-width, 24px)}.selected:not(.disabled):active .handle,.unselected:not(.disabled):active .handle{height:var(--md-switch-pressed-handle-height, 28px);width:var(--md-switch-pressed-handle-width, 28px);transition-timing-function:linear;transition-duration:100ms}.selected .handle::before{background-color:var(--md-switch-selected-handle-color, var(--md-sys-color-on-primary, #fff))}.selected:hover .handle::before{background-color:var(--md-switch-selected-hover-handle-color, var(--md-sys-color-primary-container, #eaddff))}.selected:focus-within .handle::before{background-color:var(--md-switch-selected-focus-handle-color, var(--md-sys-color-primary-container, #eaddff))}.selected:active .handle::before{background-color:var(--md-switch-selected-pressed-handle-color, var(--md-sys-color-primary-container, #eaddff))}.selected.disabled .handle::before{background-color:var(--md-switch-disabled-selected-handle-color, var(--md-sys-color-surface, #fef7ff));opacity:var(--md-switch-disabled-selected-handle-opacity, 1)}.unselected .handle::before{background-color:var(--md-switch-handle-color, var(--md-sys-color-outline, #79747e))}.unselected:hover .handle::before{background-color:var(--md-switch-hover-handle-color, var(--md-sys-color-on-surface-variant, #49454f))}.unselected:focus-within .handle::before{background-color:var(--md-switch-focus-handle-color, var(--md-sys-color-on-surface-variant, #49454f))}.unselected:active .handle::before{background-color:var(--md-switch-pressed-handle-color, var(--md-sys-color-on-surface-variant, #49454f))}.unselected.disabled .handle::before{background-color:var(--md-switch-disabled-handle-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-switch-disabled-handle-opacity, 0.38)}md-ripple{border-radius:var(--md-switch-state-layer-shape, var(--md-sys-shape-corner-full, 9999px));height:var(--md-switch-state-layer-size, 40px);inset:unset;width:var(--md-switch-state-layer-size, 40px)}.selected md-ripple{--md-ripple-hover-color: var(--md-switch-selected-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-pressed-color: var(--md-switch-selected-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-hover-opacity: var(--md-switch-selected-hover-state-layer-opacity, 0.08);--md-ripple-pressed-opacity: var(--md-switch-selected-pressed-state-layer-opacity, 0.12)}.unselected md-ripple{--md-ripple-hover-color: var(--md-switch-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-color: var(--md-switch-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-switch-hover-state-layer-opacity, 0.08);--md-ripple-pressed-opacity: var(--md-switch-pressed-state-layer-opacity, 0.12)}}@layer hcm{@media(forced-colors: active){.unselected .handle::before{background:ButtonText}.disabled .handle::before{opacity:1}.disabled.unselected .handle::before{background:GrayText}}}@layer styles{.icons{position:relative;height:100%;width:100%}.icon{position:absolute;inset:0;margin:auto;display:flex;align-items:center;justify-content:center;fill:currentColor;transition:fill 67ms linear,opacity 33ms linear,transform 167ms cubic-bezier(0.2, 0, 0, 1);opacity:0}.disabled .icon{transition:none}.selected .icon--on,.unselected .icon--off{opacity:1}.unselected .handle:not(.with-icon) .icon--on{transform:rotate(-45deg)}.icon--off{width:var(--md-switch-icon-size, 16px);height:var(--md-switch-icon-size, 16px);color:var(--md-switch-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9))}.unselected:hover .icon--off{color:var(--md-switch-hover-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9))}.unselected:focus-within .icon--off{color:var(--md-switch-focus-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9))}.unselected:active .icon--off{color:var(--md-switch-pressed-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9))}.unselected.disabled .icon--off{color:var(--md-switch-disabled-icon-color, var(--md-sys-color-surface-container-highest, #e6e0e9));opacity:var(--md-switch-disabled-icon-opacity, 0.38)}.icon--on{width:var(--md-switch-selected-icon-size, 16px);height:var(--md-switch-selected-icon-size, 16px);color:var(--md-switch-selected-icon-color, var(--md-sys-color-on-primary-container, #21005d))}.selected:hover .icon--on{color:var(--md-switch-selected-hover-icon-color, var(--md-sys-color-on-primary-container, #21005d))}.selected:focus-within .icon--on{color:var(--md-switch-selected-focus-icon-color, var(--md-sys-color-on-primary-container, #21005d))}.selected:active .icon--on{color:var(--md-switch-selected-pressed-icon-color, var(--md-sys-color-on-primary-container, #21005d))}.selected.disabled .icon--on{color:var(--md-switch-disabled-selected-icon-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-switch-disabled-selected-icon-opacity, 0.38)}}@layer hcm{@media(forced-colors: active){.icon--off{fill:Canvas}.icon--on{fill:ButtonText}.disabled.unselected .icon--off,.disabled.selected .icon--on{opacity:1}.disabled .icon--on{fill:GrayText}}}
`;let ZE=class extends JE{};ZE.styles=[QE],ZE=zg([Dc("md-switch")],ZE);var eS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let tS=class extends Ic{get bindValue(){return this._bindValue}set bindValue(e){this._bindValue!==e&&(this._bindValue=e,this._updateValue(),void 0!==this.bindValue&&(this.nativeSelect.value=String(this.bindValue),setTimeout((()=>{this.nativeSelect.value=String(this.bindValue)}),1)),Jn(this,"bind-value-changed",{value:this.convert(this._bindValue)}))}get nativeSelect(){return this.querySelector("select")}constructor(){super(),this.addEventListener("change",(()=>{this.bindValue=this.nativeSelect.value}))}updated(e){super.updated(e),void 0===this.bindValue&&this.nativeSelect.options.length>0&&(this.bindValue=this.nativeSelect.value)}render(){return dc`<slot></slot>`}_updateValue(){void 0!==this.bindValue&&(this.nativeSelect.value=this.convert(this.bindValue)??"",setTimeout((()=>{this.nativeSelect.value=this.convert(this.bindValue)??""}),1))}convert(e){if(void 0!==e)return"string"==typeof e?e:String(e)}focus(){this.nativeSelect.focus()}};tS=eS([Dc("gr-select")],tS);var iS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let rS=class extends Ic{constructor(){super(...arguments),this.newValue="",this.disabled=!1}static get styles(){return[Jy,Nc,my,Sd`
        .wrapper {
          width: 30em;
        }
        .existingItems {
          background: var(--table-header-background-color);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
        }
        gr-button {
          float: right;
          margin-left: var(--spacing-m);
          width: 4.5em;
        }
        .row {
          align-items: center;
          display: flex;
          justify-content: space-between;
          padding: var(--spacing-m) 0;
          width: 100%;
        }
        .existingItems .row {
          padding: var(--spacing-m);
        }
        .existingItems .row:not(:first-of-type) {
          border-top: 1px solid var(--border-color);
        }
        input {
          flex-grow: 1;
        }
        .hide {
          display: none;
        }
        .placeholder {
          color: var(--deemphasized-text-color);
          padding-top: var(--spacing-m);
        }
        md-outlined-text-field {
          flex-grow: 1;
        }
      `]}render(){return dc`
      <div class="wrapper gr-form-styles">
        ${this.renderPluginOptions()}
        <div class="row ${this.disabled?"hide":""}">
          <md-outlined-text-field
            id="input"
            class="showBlueFocusBorder"
            .value=${this.newValue??""}
            ?disabled=${this.disabled}
            @input=${e=>{const t=e.target;this.newValue=t.value}}
            @keydown=${this.handleInputKeydown}
          >
          </md-outlined-text-field>
          <gr-button
            id="addButton"
            ?disabled=${!this.newValue.length}
            link
            @click=${this.handleAddTap}
            >Add</gr-button
          >
        </div>
      </div>
    `}renderPluginOptions(){return this.pluginOption?.info?.values?.length?dc`
      <div class="existingItems">
        ${this.pluginOption.info.values.map((e=>this.renderPluginOptionValue(e)))}
      </div>
    `:dc`<div class="row placeholder">None configured.</div>`}renderPluginOptionValue(e){return dc`
      <div class="row">
        <span>${e}</span>
        <gr-button
          link
          ?disabled=${this.disabled}
          @click=${()=>this.handleDelete(e)}
          >Delete</gr-button
        >
      </div>
    `}handleAddTap(e){e.preventDefault(),this.handleAdd()}handleInputKeydown(e){"Enter"===e.key&&(e.preventDefault(),this.handleAdd())}handleAdd(){this.newValue.length&&(this.dispatchChanged(this.pluginOption.info.values.concat([this.newValue])),this.newValue="")}handleDelete(e){this.dispatchChanged(this.pluginOption.info.values.filter((t=>t!==e)))}dispatchChanged(e){const{_key:t,info:i}=this.pluginOption;Zn(this,"plugin-config-option-changed",{_key:t,info:{...i,values:e},notifyPath:`${t}.values`})}};iS([Uc()],rS.prototype,"newValue",void 0),iS([Fc({type:Object})],rS.prototype,"pluginOption",void 0),iS([Fc({type:Boolean,reflect:!0})],rS.prototype,"disabled",void 0),rS=iS([Dc("gr-plugin-config-array-editor")],rS);var oS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let sS=class extends Ic{constructor(){super(...arguments),this.disabled=!1}static get styles(){return[Jy,Nc,my,Jy,Kw,Sd`
        .inherited {
          color: var(--deemphasized-text-color);
          margin-left: var(--spacing-m);
        }
        section.section:not(.ARRAY) .title {
          align-items: center;
          display: flex;
        }
        section.section.ARRAY .title {
          padding-top: var(--spacing-m);
        }
      `]}render(){const e=this.pluginData?this.computePluginConfigOptions(this.pluginData):[];return dc`
      <div class="gr-form-styles">
        <fieldset>
          <h4>${this.pluginData?.name||""}</h4>
          ${e.map((e=>this.renderOption(e)))}
        </fieldset>
      </div>
    `}renderInherited(e){return e.info.inherited_value?dc`
        <span class="inherited">
          (Inherited: ${e.info.inherited_value})
        </span>
      `:dc``}renderOption(e){return dc`
      <section class="section ${e.info.type}">
        <span class="title"> ${this.renderOptionTitle(e)} </span>
        <span class="value">
          ${this.renderOptionDetail(e)} ${this.renderInherited(e)}
        </span>
      </section>
    `}renderOptionTitle(e){const t=dc`<span>${e.info.display_name}</span>`;return e.info.description?dc` <gr-tooltip-content
      has-tooltip
      show-icon
      title=${e.info.description}
    >
      ${t}
    </gr-tooltip-content>`:t}renderOptionDetail(e){return e.info.type===Ou.ARRAY?dc`
        <gr-plugin-config-array-editor
          @plugin-config-option-changed=${this.handleArrayChange}
          .pluginOption=${e}
          ?disabled=${this.disabled||!e.info.editable}
        ></gr-plugin-config-array-editor>
      `:e.info.type===Ou.BOOLEAN?dc`
        <md-switch
          ?selected=${this.computeChecked(e.info.value)}
          @change=${this.handleBooleanChange}
          data-option-key=${e._key}
          ?disabled=${this.disabled||!e.info.editable}
        ></md-switch>
      `:e.info.type===Ou.LIST?dc`
        <gr-select
          .bindValue=${e.info.value}
          @change=${this.handleListChange}
        >
          <select
            data-option-key=${e._key}
            ?disabled=${this.disabled||!e.info.editable}
          >
            ${(e.info.permitted_values||[]).map((e=>dc`<option value=${e}>${e}</option>`))}
          </select>
        </gr-select>
      `:e.info.type===Ou.STRING||e.info.type===Ou.INT||e.info.type===Ou.LONG?dc`
        <md-outlined-text-field
          class="showBlueFocusBorder"
          .value=${e.info.value??""}
          data-option-key=${e._key}
          @input=${this.handleStringChange}
          ?disabled=${this.disabled||!e.info.editable}
        >
        </md-outlined-text-field>
      `:dc``}computePluginConfigOptions(e){const t=e.config;return Object.keys(t).map((e=>({_key:e,info:t[e]})))}computeChecked(e="false"){return JSON.parse(e)}handleStringChange(e){const t=e.target,i=t.getAttribute("data-option-key"),r=this.buildConfigChangeInfo(t.value,i);this.handleChange(r)}handleListChange(e){const t=e.target,i=t.getAttribute("data-option-key"),r=this.buildConfigChangeInfo(t.value,i);this.handleChange(r)}handleBooleanChange(e){const t=e.target,i=t.getAttribute("data-option-key"),r=this.buildConfigChangeInfo(JSON.stringify(t.selected),i);this.handleChange(r)}buildConfigChangeInfo(e,t){const i=this.pluginData.config[t];return i.value=null!==e?e:void 0,{_key:t,info:i}}handleArrayChange(e){this.handleChange(e.detail)}handleChange({_key:e,info:t}){const{name:i,config:r}=this.pluginData;Jn(this,"plugin-config-changed",{name:i,config:{...r,[e]:t}})}};function nS(e,t){if(!e)return;const i=t?.gerrit?.primary_weblink_name;if(i){const t=e.find((e=>e.name===i));if(t)return t}return function(e){const t=["gitiles","browse","gitweb","code search"];for(let i=0;i<t.length;i++){const r=e.find((e=>e.name?.toLowerCase()===t[i]));if(r)return r}}(e)}oS([Fc({type:Object})],sS.prototype,"pluginData",void 0),oS([Fc({type:Boolean,reflect:!0})],sS.prototype,"disabled",void 0),sS=oS([Dc("gr-repo-plugin-config")],sS);class aS extends Gy{computeValidity(e){return this.selectControl||(this.selectControl=document.createElement("select")),Rc(dc`<option value=${e.value}></option>`,this.selectControl),this.selectControl.value=e.value,this.selectControl.required=e.required,{validity:this.selectControl.validity,validationMessage:this.selectControl.validationMessage}}equals(e,t){return e.value===t.value&&e.required===t.required}copy({value:e,required:t}){return{value:e,required:t}}}var lS;const dS=Symbol("value"),cS=fm(Hy(Py(Dy(_m(Ic)))));class hS extends cS{get value(){return this[dS]}set value(e){this.lastUserSetValue=e,this.select(e)}get options(){return this.menu?.items??[]}get selectedIndex(){const[e,t]=(this.getSelectedOptions()??[])[0]??[];return t??-1}set selectedIndex(e){this.lastUserSetSelectedIndex=e,this.selectIndex(e)}get selectedOptions(){return(this.getSelectedOptions()??[]).map((([e])=>e))}get hasError(){return this.error||this.nativeError}constructor(){super(),this.quick=!1,this.required=!1,this.errorText="",this.label="",this.noAsterisk=!1,this.supportingText="",this.error=!1,this.menuPositioning="popover",this.clampMenuWidth=!1,this.typeaheadDelay=200,this.hasLeadingIcon=!1,this.displayText="",this.menuAlign="start",this[lS]="",this.lastUserSetValue=null,this.lastUserSetSelectedIndex=null,this.lastSelectedOption=null,this.lastSelectedOptionRecords=[],this.nativeError=!1,this.nativeErrorText="",this.focused=!1,this.open=!1,this.defaultFocus=yb,this.prevOpen=this.open,this.selectWidth=0,this.addEventListener("focus",this.handleFocus.bind(this)),this.addEventListener("blur",this.handleBlur.bind(this))}select(e){const t=this.options.find((t=>t.value===e));t&&this.selectItem(t)}selectIndex(e){const t=this.options[e];t&&this.selectItem(t)}reset(){for(const e of this.options)e.selected=e.hasAttribute("selected");this.updateValueAndDisplayText(),this.nativeError=!1,this.nativeErrorText=""}showPicker(){this.open=!0}[(lS=dS,Ly)](e){e?.preventDefault();const t=this.getErrorText();this.nativeError=!!e,this.nativeErrorText=this.validationMessage,t===this.getErrorText()&&this.field?.reannounceError()}update(e){if(this.hasUpdated||this.initUserSelection(),this.prevOpen!==this.open&&this.open){const e=this.getBoundingClientRect();this.selectWidth=e.width}this.prevOpen=this.open,super.update(e)}render(){return dc`
      <span
        class="select ${th(this.getRenderClasses())}"
        @focusout=${this.handleFocusout}>
        ${this.renderField()} ${this.renderMenu()}
      </span>
    `}async firstUpdated(e){await(this.menu?.updateComplete),this.lastSelectedOptionRecords.length||this.initUserSelection(),this.lastSelectedOptionRecords.length||this.options.length||setTimeout((()=>{this.updateValueAndDisplayText()})),super.firstUpdated(e)}getRenderClasses(){return{disabled:this.disabled,error:this.error,open:this.open}}renderField(){const e=this.ariaLabel||this.label;return Fb`
      <${this.fieldTag}
          aria-haspopup="listbox"
          role="combobox"
          part="field"
          id="field"
          tabindex=${this.disabled?"-1":"0"}
          aria-label=${e||uc}
          aria-describedby="description"
          aria-expanded=${this.open?"true":"false"}
          aria-controls="listbox"
          class="field"
          label=${this.label}
          ?no-asterisk=${this.noAsterisk}
          .focused=${this.focused||this.open}
          .populated=${!!this.displayText}
          .disabled=${this.disabled}
          .required=${this.required}
          .error=${this.hasError}
          ?has-start=${this.hasLeadingIcon}
          has-end
          supporting-text=${this.supportingText}
          error-text=${this.getErrorText()}
          @keydown=${this.handleKeydown}
          @click=${this.handleClick}>
         ${this.renderFieldContent()}
         <div id="description" slot="aria-describedby"></div>
      </${this.fieldTag}>`}renderFieldContent(){return[this.renderLeadingIcon(),this.renderLabel(),this.renderTrailingIcon()]}renderLeadingIcon(){return dc`
      <span class="icon leading" slot="start">
        <slot name="leading-icon" @slotchange=${this.handleIconChange}></slot>
      </span>
    `}renderTrailingIcon(){return dc`
      <span class="icon trailing" slot="end">
        <slot name="trailing-icon" @slotchange=${this.handleIconChange}>
          <svg height="5" viewBox="7 10 10 5" focusable="false">
            <polygon
              class="down"
              stroke="none"
              fill-rule="evenodd"
              points="7 10 12 15 17 10"></polygon>
            <polygon
              class="up"
              stroke="none"
              fill-rule="evenodd"
              points="7 15 12 10 17 15"></polygon>
          </svg>
        </slot>
      </span>
    `}renderLabel(){return dc`<div id="label">${this.displayText||dc`&nbsp;`}</div>`}renderMenu(){const e=this.label||this.ariaLabel;return dc`<div class="menu-wrapper">
      <md-menu
        id="listbox"
        .defaultFocus=${this.defaultFocus}
        role="listbox"
        tabindex="-1"
        aria-label=${e||uc}
        stay-open-on-focusout
        part="menu"
        exportparts="focus-ring: menu-focus-ring"
        anchor="field"
        style=${Bm({"--__menu-min-width":`${this.selectWidth}px`,"--__menu-max-width":this.clampMenuWidth?`${this.selectWidth}px`:void 0})}
        no-navigation-wrap
        .open=${this.open}
        .quick=${this.quick}
        .positioning=${this.menuPositioning}
        .typeaheadDelay=${this.typeaheadDelay}
        .anchorCorner=${"start"===this.menuAlign?"end-start":"end-end"}
        .menuCorner=${"start"===this.menuAlign?"start-start":"start-end"}
        @opening=${this.handleOpening}
        @opened=${this.redispatchEvent}
        @closing=${this.redispatchEvent}
        @closed=${this.handleClosed}
        @close-menu=${this.handleCloseMenu}
        @request-selection=${this.handleRequestSelection}
        @request-deselection=${this.handleRequestDeselection}>
        ${this.renderMenuContent()}
      </md-menu>
    </div>`}renderMenuContent(){return dc`<slot></slot>`}handleKeydown(e){if(this.open||this.disabled||!this.menu)return;const t=this.menu.typeaheadController,i="Space"===e.code||"ArrowDown"===e.code||"ArrowUp"===e.code||"End"===e.code||"Home"===e.code||"Enter"===e.code;if(t.isTypingAhead||!i){if(1===e.key.length){t.onKeydown(e),e.preventDefault();const{lastActiveRecord:i}=t;if(!i)return;this.labelEl?.setAttribute?.("aria-live","polite"),this.selectItem(i[1])&&this.dispatchInteractionEvents()}}else switch(e.preventDefault(),this.open=!0,e.code){case"Space":case"ArrowDown":case"Enter":this.defaultFocus=yb;break;case"End":this.defaultFocus=_b;break;case"ArrowUp":case"Home":this.defaultFocus=wb}}handleClick(){this.open=!this.open}handleFocus(){this.focused=!0}handleBlur(){this.focused=!1}handleFocusout(e){e.relatedTarget&&bb(e.relatedTarget,this)||(this.open=!1)}getSelectedOptions(){if(!this.menu)return this.lastSelectedOptionRecords=[],null;const e=this.menu.items;return this.lastSelectedOptionRecords=function(e){const t=[];for(let i=0;i<e.length;i++){const r=e[i];r.selected&&t.push([r,i])}return t}(e),this.lastSelectedOptionRecords}async getUpdateComplete(){return await(this.menu?.updateComplete),super.getUpdateComplete()}updateValueAndDisplayText(){const e=this.getSelectedOptions()??[];let t=!1;if(e.length){const[i]=e[0];t=this.lastSelectedOption!==i,this.lastSelectedOption=i,this[dS]=i.value,this.displayText=i.displayText}else t=null!==this.lastSelectedOption,this.lastSelectedOption=null,this[dS]="",this.displayText="";return t}async handleOpening(e){if(this.labelEl?.removeAttribute?.("aria-live"),this.redispatchEvent(e),this.defaultFocus!==yb)return;const t=this.menu.items,i=nb(t)?.item;let[r]=this.lastSelectedOptionRecords[0]??[null];i&&i!==r&&(i.tabIndex=-1),r=r??t[0],r&&(r.tabIndex=0,r.focus())}redispatchEvent(e){$y(this,e)}handleClosed(e){this.open=!1,this.redispatchEvent(e)}handleCloseMenu(e){const t=e.detail.reason,i=e.detail.itemPath[0];this.open=!1;let r=!1;var o;"click-selection"===t.kind||"keydown"===t.kind&&(o=t.key,Object.values(mb).some((e=>e===o)))?r=this.selectItem(i):(i.tabIndex=-1,i.blur()),r&&this.dispatchInteractionEvents()}selectItem(e){return(this.getSelectedOptions()??[]).forEach((([t])=>{e!==t&&(t.selected=!1)})),e.selected=!0,this.updateValueAndDisplayText()}handleRequestSelection(e){const t=e.target;this.lastSelectedOptionRecords.some((([e])=>e===t))||this.selectItem(t)}handleRequestDeselection(e){const t=e.target;this.lastSelectedOptionRecords.some((([e])=>e===t))&&this.updateValueAndDisplayText()}initUserSelection(){this.lastUserSetValue&&!this.lastSelectedOptionRecords.length?this.select(this.lastUserSetValue):null===this.lastUserSetSelectedIndex||this.lastSelectedOptionRecords.length?this.updateValueAndDisplayText():this.selectIndex(this.lastUserSetSelectedIndex)}handleIconChange(){this.hasLeadingIcon=this.leadingIcons.length>0}dispatchInteractionEvents(){this.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0}))}getErrorText(){return this.error?this.errorText:this.nativeErrorText}[Ny](){return this.value}formResetCallback(){this.reset()}formStateRestoreCallback(e){this.value=e}click(){this.field?.click()}[ky](){return new aS((()=>this))}[Ay](){return this.field}}hS.shadowRootOptions={...Ic.shadowRootOptions,delegatesFocus:!0},zg([Fc({type:Boolean})],hS.prototype,"quick",void 0),zg([Fc({type:Boolean})],hS.prototype,"required",void 0),zg([Fc({type:String,attribute:"error-text"})],hS.prototype,"errorText",void 0),zg([Fc()],hS.prototype,"label",void 0),zg([Fc({type:Boolean,attribute:"no-asterisk"})],hS.prototype,"noAsterisk",void 0),zg([Fc({type:String,attribute:"supporting-text"})],hS.prototype,"supportingText",void 0),zg([Fc({type:Boolean,reflect:!0})],hS.prototype,"error",void 0),zg([Fc({attribute:"menu-positioning"})],hS.prototype,"menuPositioning",void 0),zg([Fc({type:Boolean,attribute:"clamp-menu-width"})],hS.prototype,"clampMenuWidth",void 0),zg([Fc({type:Number,attribute:"typeahead-delay"})],hS.prototype,"typeaheadDelay",void 0),zg([Fc({type:Boolean,attribute:"has-leading-icon"})],hS.prototype,"hasLeadingIcon",void 0),zg([Fc({attribute:"display-text"})],hS.prototype,"displayText",void 0),zg([Fc({attribute:"menu-align"})],hS.prototype,"menuAlign",void 0),zg([Fc()],hS.prototype,"value",null),zg([Fc({type:Number,attribute:"selected-index"})],hS.prototype,"selectedIndex",null),zg([Uc()],hS.prototype,"nativeError",void 0),zg([Uc()],hS.prototype,"nativeErrorText",void 0),zg([Uc()],hS.prototype,"focused",void 0),zg([Uc()],hS.prototype,"open",void 0),zg([Uc()],hS.prototype,"defaultFocus",void 0),zg([Hc(".field")],hS.prototype,"field",void 0),zg([Hc("md-menu")],hS.prototype,"menu",void 0),zg([Hc("#label")],hS.prototype,"labelEl",void 0),zg([Vc({slot:"leading-icon",flatten:!0})],hS.prototype,"leadingIcons",void 0);class pS extends hS{constructor(){super(...arguments),this.fieldTag=Db`md-outlined-field`}}const uS=Sd`:host{--_text-field-disabled-input-text-color: var(--md-outlined-select-text-field-disabled-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-input-text-opacity: var(--md-outlined-select-text-field-disabled-input-text-opacity, 0.38);--_text-field-disabled-label-text-color: var(--md-outlined-select-text-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-label-text-opacity: var(--md-outlined-select-text-field-disabled-label-text-opacity, 0.38);--_text-field-disabled-leading-icon-color: var(--md-outlined-select-text-field-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-leading-icon-opacity: var(--md-outlined-select-text-field-disabled-leading-icon-opacity, 0.38);--_text-field-disabled-outline-color: var(--md-outlined-select-text-field-disabled-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-outline-opacity: var(--md-outlined-select-text-field-disabled-outline-opacity, 0.12);--_text-field-disabled-outline-width: var(--md-outlined-select-text-field-disabled-outline-width, 1px);--_text-field-disabled-supporting-text-color: var(--md-outlined-select-text-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-supporting-text-opacity: var(--md-outlined-select-text-field-disabled-supporting-text-opacity, 0.38);--_text-field-disabled-trailing-icon-color: var(--md-outlined-select-text-field-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-trailing-icon-opacity: var(--md-outlined-select-text-field-disabled-trailing-icon-opacity, 0.38);--_text-field-error-focus-input-text-color: var(--md-outlined-select-text-field-error-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-focus-label-text-color: var(--md-outlined-select-text-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-leading-icon-color: var(--md-outlined-select-text-field-error-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-focus-outline-color: var(--md-outlined-select-text-field-error-focus-outline-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-supporting-text-color: var(--md-outlined-select-text-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-trailing-icon-color: var(--md-outlined-select-text-field-error-focus-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_text-field-error-hover-input-text-color: var(--md-outlined-select-text-field-error-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-hover-label-text-color: var(--md-outlined-select-text-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-hover-leading-icon-color: var(--md-outlined-select-text-field-error-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-hover-outline-color: var(--md-outlined-select-text-field-error-hover-outline-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-hover-supporting-text-color: var(--md-outlined-select-text-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-hover-trailing-icon-color: var(--md-outlined-select-text-field-error-hover-trailing-icon-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-input-text-color: var(--md-outlined-select-text-field-error-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-label-text-color: var(--md-outlined-select-text-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-leading-icon-color: var(--md-outlined-select-text-field-error-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-outline-color: var(--md-outlined-select-text-field-error-outline-color, var(--md-sys-color-error, #b3261e));--_text-field-error-supporting-text-color: var(--md-outlined-select-text-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-trailing-icon-color: var(--md-outlined-select-text-field-error-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_text-field-focus-input-text-color: var(--md-outlined-select-text-field-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-focus-label-text-color: var(--md-outlined-select-text-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_text-field-focus-leading-icon-color: var(--md-outlined-select-text-field-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-focus-outline-color: var(--md-outlined-select-text-field-focus-outline-color, var(--md-sys-color-primary, #6750a4));--_text-field-focus-outline-width: var(--md-outlined-select-text-field-focus-outline-width, 3px);--_text-field-focus-supporting-text-color: var(--md-outlined-select-text-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-focus-trailing-icon-color: var(--md-outlined-select-text-field-focus-trailing-icon-color, var(--md-sys-color-primary, #6750a4));--_text-field-hover-input-text-color: var(--md-outlined-select-text-field-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-label-text-color: var(--md-outlined-select-text-field-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-leading-icon-color: var(--md-outlined-select-text-field-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-hover-outline-color: var(--md-outlined-select-text-field-hover-outline-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-outline-width: var(--md-outlined-select-text-field-hover-outline-width, 1px);--_text-field-hover-supporting-text-color: var(--md-outlined-select-text-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-hover-trailing-icon-color: var(--md-outlined-select-text-field-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-input-text-color: var(--md-outlined-select-text-field-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-input-text-font: var(--md-outlined-select-text-field-input-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-input-text-line-height: var(--md-outlined-select-text-field-input-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_text-field-input-text-size: var(--md-outlined-select-text-field-input-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_text-field-input-text-weight: var(--md-outlined-select-text-field-input-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-label-text-color: var(--md-outlined-select-text-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-label-text-font: var(--md-outlined-select-text-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-label-text-line-height: var(--md-outlined-select-text-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_text-field-label-text-populated-line-height: var(--md-outlined-select-text-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_text-field-label-text-populated-size: var(--md-outlined-select-text-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_text-field-label-text-size: var(--md-outlined-select-text-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_text-field-label-text-weight: var(--md-outlined-select-text-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-leading-icon-color: var(--md-outlined-select-text-field-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-leading-icon-size: var(--md-outlined-select-text-field-leading-icon-size, 24px);--_text-field-outline-color: var(--md-outlined-select-text-field-outline-color, var(--md-sys-color-outline, #79747e));--_text-field-outline-width: var(--md-outlined-select-text-field-outline-width, 1px);--_text-field-supporting-text-color: var(--md-outlined-select-text-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-supporting-text-font: var(--md-outlined-select-text-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-supporting-text-line-height: var(--md-outlined-select-text-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_text-field-supporting-text-size: var(--md-outlined-select-text-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_text-field-supporting-text-weight: var(--md-outlined-select-text-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-trailing-icon-color: var(--md-outlined-select-text-field-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-trailing-icon-size: var(--md-outlined-select-text-field-trailing-icon-size, 24px);--_text-field-container-shape-start-start: var(--md-outlined-select-text-field-container-shape-start-start, var(--md-outlined-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_text-field-container-shape-start-end: var(--md-outlined-select-text-field-container-shape-start-end, var(--md-outlined-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_text-field-container-shape-end-end: var(--md-outlined-select-text-field-container-shape-end-end, var(--md-outlined-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_text-field-container-shape-end-start: var(--md-outlined-select-text-field-container-shape-end-start, var(--md-outlined-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--md-outlined-field-container-shape-end-end: var(--_text-field-container-shape-end-end);--md-outlined-field-container-shape-end-start: var(--_text-field-container-shape-end-start);--md-outlined-field-container-shape-start-end: var(--_text-field-container-shape-start-end);--md-outlined-field-container-shape-start-start: var(--_text-field-container-shape-start-start);--md-outlined-field-content-color: var(--_text-field-input-text-color);--md-outlined-field-content-font: var(--_text-field-input-text-font);--md-outlined-field-content-line-height: var(--_text-field-input-text-line-height);--md-outlined-field-content-size: var(--_text-field-input-text-size);--md-outlined-field-content-weight: var(--_text-field-input-text-weight);--md-outlined-field-disabled-content-color: var(--_text-field-disabled-input-text-color);--md-outlined-field-disabled-content-opacity: var(--_text-field-disabled-input-text-opacity);--md-outlined-field-disabled-label-text-color: var(--_text-field-disabled-label-text-color);--md-outlined-field-disabled-label-text-opacity: var(--_text-field-disabled-label-text-opacity);--md-outlined-field-disabled-leading-content-color: var(--_text-field-disabled-leading-icon-color);--md-outlined-field-disabled-leading-content-opacity: var(--_text-field-disabled-leading-icon-opacity);--md-outlined-field-disabled-outline-color: var(--_text-field-disabled-outline-color);--md-outlined-field-disabled-outline-opacity: var(--_text-field-disabled-outline-opacity);--md-outlined-field-disabled-outline-width: var(--_text-field-disabled-outline-width);--md-outlined-field-disabled-supporting-text-color: var(--_text-field-disabled-supporting-text-color);--md-outlined-field-disabled-supporting-text-opacity: var(--_text-field-disabled-supporting-text-opacity);--md-outlined-field-disabled-trailing-content-color: var(--_text-field-disabled-trailing-icon-color);--md-outlined-field-disabled-trailing-content-opacity: var(--_text-field-disabled-trailing-icon-opacity);--md-outlined-field-error-content-color: var(--_text-field-error-input-text-color);--md-outlined-field-error-focus-content-color: var(--_text-field-error-focus-input-text-color);--md-outlined-field-error-focus-label-text-color: var(--_text-field-error-focus-label-text-color);--md-outlined-field-error-focus-leading-content-color: var(--_text-field-error-focus-leading-icon-color);--md-outlined-field-error-focus-outline-color: var(--_text-field-error-focus-outline-color);--md-outlined-field-error-focus-supporting-text-color: var(--_text-field-error-focus-supporting-text-color);--md-outlined-field-error-focus-trailing-content-color: var(--_text-field-error-focus-trailing-icon-color);--md-outlined-field-error-hover-content-color: var(--_text-field-error-hover-input-text-color);--md-outlined-field-error-hover-label-text-color: var(--_text-field-error-hover-label-text-color);--md-outlined-field-error-hover-leading-content-color: var(--_text-field-error-hover-leading-icon-color);--md-outlined-field-error-hover-outline-color: var(--_text-field-error-hover-outline-color);--md-outlined-field-error-hover-supporting-text-color: var(--_text-field-error-hover-supporting-text-color);--md-outlined-field-error-hover-trailing-content-color: var(--_text-field-error-hover-trailing-icon-color);--md-outlined-field-error-label-text-color: var(--_text-field-error-label-text-color);--md-outlined-field-error-leading-content-color: var(--_text-field-error-leading-icon-color);--md-outlined-field-error-outline-color: var(--_text-field-error-outline-color);--md-outlined-field-error-supporting-text-color: var(--_text-field-error-supporting-text-color);--md-outlined-field-error-trailing-content-color: var(--_text-field-error-trailing-icon-color);--md-outlined-field-focus-content-color: var(--_text-field-focus-input-text-color);--md-outlined-field-focus-label-text-color: var(--_text-field-focus-label-text-color);--md-outlined-field-focus-leading-content-color: var(--_text-field-focus-leading-icon-color);--md-outlined-field-focus-outline-color: var(--_text-field-focus-outline-color);--md-outlined-field-focus-outline-width: var(--_text-field-focus-outline-width);--md-outlined-field-focus-supporting-text-color: var(--_text-field-focus-supporting-text-color);--md-outlined-field-focus-trailing-content-color: var(--_text-field-focus-trailing-icon-color);--md-outlined-field-hover-content-color: var(--_text-field-hover-input-text-color);--md-outlined-field-hover-label-text-color: var(--_text-field-hover-label-text-color);--md-outlined-field-hover-leading-content-color: var(--_text-field-hover-leading-icon-color);--md-outlined-field-hover-outline-color: var(--_text-field-hover-outline-color);--md-outlined-field-hover-outline-width: var(--_text-field-hover-outline-width);--md-outlined-field-hover-supporting-text-color: var(--_text-field-hover-supporting-text-color);--md-outlined-field-hover-trailing-content-color: var(--_text-field-hover-trailing-icon-color);--md-outlined-field-label-text-color: var(--_text-field-label-text-color);--md-outlined-field-label-text-font: var(--_text-field-label-text-font);--md-outlined-field-label-text-line-height: var(--_text-field-label-text-line-height);--md-outlined-field-label-text-populated-line-height: var(--_text-field-label-text-populated-line-height);--md-outlined-field-label-text-populated-size: var(--_text-field-label-text-populated-size);--md-outlined-field-label-text-size: var(--_text-field-label-text-size);--md-outlined-field-label-text-weight: var(--_text-field-label-text-weight);--md-outlined-field-leading-content-color: var(--_text-field-leading-icon-color);--md-outlined-field-outline-color: var(--_text-field-outline-color);--md-outlined-field-outline-width: var(--_text-field-outline-width);--md-outlined-field-supporting-text-color: var(--_text-field-supporting-text-color);--md-outlined-field-supporting-text-font: var(--_text-field-supporting-text-font);--md-outlined-field-supporting-text-line-height: var(--_text-field-supporting-text-line-height);--md-outlined-field-supporting-text-size: var(--_text-field-supporting-text-size);--md-outlined-field-supporting-text-weight: var(--_text-field-supporting-text-weight);--md-outlined-field-trailing-content-color: var(--_text-field-trailing-icon-color)}[has-start] .icon.leading{font-size:var(--_text-field-leading-icon-size);height:var(--_text-field-leading-icon-size);width:var(--_text-field-leading-icon-size)}.icon.trailing{font-size:var(--_text-field-trailing-icon-size);height:var(--_text-field-trailing-icon-size);width:var(--_text-field-trailing-icon-size)}
`,gS=Sd`:host{color:unset;min-width:210px;display:flex}.field{cursor:default;outline:none}.select{position:relative;flex-direction:column}.icon.trailing svg,.icon ::slotted(*){fill:currentColor}.icon ::slotted(*){width:inherit;height:inherit;font-size:inherit}.icon slot{display:flex;height:100%;width:100%;align-items:center;justify-content:center}.icon.trailing :is(.up,.down){opacity:0;transition:opacity 75ms linear 75ms}.select:not(.open) .down,.select.open .up{opacity:1}.field,.select,md-menu{min-width:inherit;width:inherit;max-width:inherit;display:flex}md-menu{min-width:var(--__menu-min-width);max-width:var(--__menu-max-width, inherit)}.menu-wrapper{width:0px;height:0px;max-width:inherit}md-menu ::slotted(:not[disabled]){cursor:pointer}.field,.select{width:100%}:host{display:inline-flex}:host([disabled]){pointer-events:none}
`;let mS=class extends pS{};mS.styles=[gS,uS],mS=zg([Dc("md-outlined-select")],mS);class fS{get role(){return this.menuItemController.role}get typeaheadText(){return this.menuItemController.typeaheadText}setTypeaheadText(e){this.menuItemController.setTypeaheadText(e)}get displayText(){return null!==this.internalDisplayText?this.internalDisplayText:this.menuItemController.typeaheadText}setDisplayText(e){this.internalDisplayText=e}constructor(e,t){this.host=e,this.internalDisplayText=null,this.firstUpdate=!0,this.onClick=()=>{this.menuItemController.onClick()},this.onKeydown=e=>{this.menuItemController.onKeydown(e)},this.lastSelected=this.host.selected,this.menuItemController=new Ub(e,t),e.addController(this)}hostUpdate(){this.lastSelected!==this.host.selected&&(this.host.ariaSelected=this.host.selected?"true":"false")}hostUpdated(){this.lastSelected===this.host.selected||this.firstUpdate||(this.host.selected?this.host.dispatchEvent(new Event("request-selection",{bubbles:!0,composed:!0})):this.host.dispatchEvent(new Event("request-deselection",{bubbles:!0,composed:!0}))),this.lastSelected=this.host.selected,this.firstUpdate=!1}}const vS=fm(Ic);class bS extends vS{constructor(){super(...arguments),this.disabled=!1,this.isMenuItem=!0,this.selected=!1,this.value="",this.type="option",this.selectOptionController=new fS(this,{getHeadlineElements:()=>this.headlineElements,getSupportingTextElements:()=>this.supportingTextElements,getDefaultElements:()=>this.defaultElements,getInteractiveElement:()=>this.listItemRoot})}get typeaheadText(){return this.selectOptionController.typeaheadText}set typeaheadText(e){this.selectOptionController.setTypeaheadText(e)}get displayText(){return this.selectOptionController.displayText}set displayText(e){this.selectOptionController.setDisplayText(e)}render(){return this.renderListItem(dc`
      <md-item>
        <div slot="container">
          ${this.renderRipple()} ${this.renderFocusRing()}
        </div>
        <slot name="start" slot="start"></slot>
        <slot name="end" slot="end"></slot>
        ${this.renderBody()}
      </md-item>
    `)}renderListItem(e){return dc`
      <li
        id="item"
        tabindex=${this.disabled?-1:0}
        role=${this.selectOptionController.role}
        aria-label=${this.ariaLabel||uc}
        aria-selected=${this.ariaSelected||uc}
        aria-checked=${this.ariaChecked||uc}
        aria-expanded=${this.ariaExpanded||uc}
        aria-haspopup=${this.ariaHasPopup||uc}
        class="list-item ${th(this.getRenderClasses())}"
        @click=${this.selectOptionController.onClick}
        @keydown=${this.selectOptionController.onKeydown}
        >${e}</li
      >
    `}renderRipple(){return dc` <md-ripple
      part="ripple"
      for="item"
      ?disabled=${this.disabled}></md-ripple>`}renderFocusRing(){return dc` <md-focus-ring
      part="focus-ring"
      for="item"
      inward></md-focus-ring>`}getRenderClasses(){return{disabled:this.disabled,selected:this.selected}}renderBody(){return dc`
      <slot></slot>
      <slot name="overline" slot="overline"></slot>
      <slot name="headline" slot="headline"></slot>
      <slot name="supporting-text" slot="supporting-text"></slot>
      <slot
        name="trailing-supporting-text"
        slot="trailing-supporting-text"></slot>
    `}focus(){this.listItemRoot?.focus()}}bS.shadowRootOptions={...Ic.shadowRootOptions,delegatesFocus:!0},zg([Fc({type:Boolean,reflect:!0})],bS.prototype,"disabled",void 0),zg([Fc({type:Boolean,attribute:"md-menu-item",reflect:!0})],bS.prototype,"isMenuItem",void 0),zg([Fc({type:Boolean})],bS.prototype,"selected",void 0),zg([Fc()],bS.prototype,"value",void 0),zg([Hc(".list-item")],bS.prototype,"listItemRoot",void 0),zg([Vc({slot:"headline"})],bS.prototype,"headlineElements",void 0),zg([Vc({slot:"supporting-text"})],bS.prototype,"supportingTextElements",void 0),zg([Wc({slot:""})],bS.prototype,"defaultElements",void 0),zg([Fc({attribute:"typeahead-text"})],bS.prototype,"typeaheadText",null),zg([Fc({attribute:"display-text"})],bS.prototype,"displayText",null);let yS=class extends bS{};yS.styles=[jb],yS=zg([Dc("md-select-option")],yS);var wS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const _S={active:{value:Gu.ACTIVE,label:"Active"},readOnly:{value:Gu.READ_ONLY,label:"Read Only"},hidden:{value:Gu.HIDDEN,label:"Hidden"}},xS={mergeIfNecessary:{value:"MERGE_IF_NECESSARY",label:"Merge if necessary"},fastForwardOnly:{value:"FAST_FORWARD_ONLY",label:"Fast forward only"},rebaseAlways:{value:"REBASE_ALWAYS",label:"Rebase Always"},rebaseIfNecessary:{value:"REBASE_IF_NECESSARY",label:"Rebase if necessary"},mergeAlways:{value:"MERGE_ALWAYS",label:"Merge always"},cherryPick:{value:"CHERRY_PICK",label:"Cherry pick"}};let CS=class extends Ic{constructor(){super(),this.schemes=[],this.loading=!0,this.readOnly=!0,this.disableSaveWithoutReview=!0,this.states=Object.values(_S),this.weblinks=[],this.pluginConfigChanged=!1,this.getUserModel=yu(this,jf),this.restApiService=Xn().restApiService,this.getNavigation=yu(this,gy),this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getUserModel().preferences$),(e=>{e?.download_scheme&&(this.selectedScheme=e.download_scheme.toLowerCase())})),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.serverConfig=e))}connectedCallback(){super.connectedCallback(),oa(`${this.repo}`)}static get styles(){return[Jy,Qb,vy,my,Kw,Nc,Sd`
        .info {
          margin-bottom: var(--spacing-xl);
        }
        h2.edited:after {
          color: var(--deemphasized-text-color);
          content: ' *';
        }
        #options .repositorySettings {
          display: none;
        }
        #options .repositorySettings.showConfig {
          display: block;
        }
        gr-autogrow-textarea {
          background-color: var(--view-background-color);
          width: 100%;
        }
        gr-autogrow-textarea:focus {
          border: 2px solid var(--input-focus-border-color);
        }
      `]}render(){const e=this.hasConfigChanged();return dc`
      <div class="main gr-form-styles read-only">
        <div class="info">
          <h1 id="Title" class="heading-1">${this.repo}</h1>
          <hr />
          <div>
            <a href=${this.getWebLink()?.url??""}
              ><gr-button link ?disabled=${!this.getWebLink()?.url}
                >Browse</gr-button
              ></a
            ><a href=${this.computeChangesUrl(this.repo)}
              ><gr-button link>View Changes</gr-button></a
            >
          </div>
        </div>
        ${eb(this.loading||!this.repoConfig,(()=>dc`<div id="loading">Loading...</div>`),(()=>dc`<div id="loadedContent">
            ${this.renderDownloadCommands()}
            <h2
              id="configurations"
              class="heading-2 ${e?"edited":""}"
            >
              Configurations
            </h2>
            <div id="form">
              <fieldset>
                ${this.renderDescription()} ${this.renderRepoOptions()}
                ${this.renderPluginConfig()}
                <gr-button
                  id="saveBtn"
                  ?disabled=${this.readOnly||this.disableSaveWithoutReview||!e}
                  @click=${this.handleSaveRepoConfig}
                  >Save Changes</gr-button
                >
                <gr-button
                  id="saveReviewBtn"
                  ?disabled=${this.readOnly||!e}
                  @click=${this.handleSaveRepoConfigForReview}
                  >Save For Review</gr-button
                >
              </fieldset>
              <gr-endpoint-decorator name="repo-config">
                <gr-endpoint-param
                  name="repoName"
                  .value=${this.repo}
                ></gr-endpoint-param>
                <gr-endpoint-param
                  name="readOnly"
                  .value=${this.readOnly}
                ></gr-endpoint-param>
              </gr-endpoint-decorator>
            </div>
          </div>`))}
      </div>
    `}renderDownloadCommands(){return this.schemes.length?dc`
      <div id="downloadContent">
        <h2 id="download" class="heading-2">Download</h2>
        <fieldset>
          <gr-download-commands
            id="downloadCommands"
            .commands=${this.computeCommands()}
            .schemes=${this.schemes}
            .selectedScheme=${this.selectedScheme}
            .description=${this.computeDescription()}
            @selected-scheme-changed=${e=>{this.loading||(this.selectedScheme=e.detail.value)}}
          ></gr-download-commands>
        </fieldset>
      </div>
    `:uc}renderDescription(){return ba(this.repoConfig,"repoConfig"),dc`
      <h3 id="Description" class="heading-3">Description</h3>
      <fieldset>
        <gr-autogrow-textarea
          id="descriptionInput"
          class="description"
          autocomplete="on"
          placeholder="&lt;Insert repo description here&gt;"
          .rows=${4}
          .maxRows=${10}
          .value=${this.repoConfig.description??""}
          ?disabled=${this.readOnly}
          @input=${this.handleDescriptionInput}
        ></gr-autogrow-textarea>
      </fieldset>
    `}renderRepoOptions(){return dc`
      <h3 id="Options" class="heading-3">Repository Options</h3>
      <fieldset id="options">
        ${this.renderState()} ${this.renderSubmitType()}
        ${this.renderContentMerges()} ${this.renderNewChange()}
        ${this.renderChangeId()} ${this.renderEnableSignedPush()}
        ${this.renderRequireSignedPush()} ${this.renderRejectImplicitMerges()}
        ${this.renderUnRegisteredCc()} ${this.renderPrivateByDefault()}
        ${this.renderWorkInProgressByDefault()} ${this.renderMaxGitObjectSize()}
        ${this.renderMatchAuthoredDateWithCommitterDate()}
        ${this.renderRejectEmptyCommit()}
      </fieldset>
      <h3 id="Options" class="heading-3">Contributor Agreements</h3>
      <fieldset id="agreements">
        ${this.renderContributorAgreement()} ${this.renderUseSignedOffBy()}
      </fieldset>
    `}renderState(){return dc`
      <section>
        <span class="title">State</span>
        <span class="value">
          <md-outlined-select
            id="stateSelect"
            value=${this.repoConfig?.state??""}
            ?disabled=${this.readOnly}
            @change=${this.handleStateSelectChange}
          >
            ${this.states.map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderSubmitType(){return dc`
      <section>
        <span class="title">Submit type</span>
        <span class="value">
          <md-outlined-select
            id="submitTypeSelect"
            value=${this.repoConfig?.submit_type??""}
            ?disabled=${this.readOnly}
            @change=${this.handleSubmitTypeSelectChange}
          >
            ${this.formatSubmitTypeSelect(this.repoConfig).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderContentMerges(){return dc`
      <section>
        <span class="title">Allow content merges</span>
        <span class="value">
          <md-outlined-select
            id="contentMergeSelect"
            value=${this.repoConfig?.use_content_merge?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleContentMergeSelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.use_content_merge).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderNewChange(){return dc`
      <section>
        <span class="title">
          Create a new change for every commit not in the target branch
        </span>
        <span class="value">
          <md-outlined-select
            id="newChangeSelect"
            value=${this.repoConfig?.create_new_change_for_all_not_in_target?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleNewChangeSelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.create_new_change_for_all_not_in_target).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderChangeId(){return dc`
      <section>
        <span class="title">Require Change-Id in commit message</span>
        <span class="value">
          <md-outlined-select
            id="requireChangeIdSelect"
            value=${this.repoConfig?.require_change_id?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleRequireChangeIdSelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.require_change_id).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderEnableSignedPush(){return dc`
      <section
        id="enableSignedPushSettings"
        class="repositorySettings ${this.repoConfig?.enable_signed_push?"showConfig":""}"
      >
        <span class="title">Enable signed push</span>
        <span class="value">
          <md-outlined-select
            id="enableSignedPush"
            value=${this.repoConfig?.enable_signed_push?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleEnableSignedPushChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.enable_signed_push).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderRequireSignedPush(){return dc`
      <section
        id="requireSignedPushSettings"
        class="repositorySettings ${this.repoConfig?.require_signed_push?"showConfig":""}"
      >
        <span class="title">Require signed push</span>
        <span class="value">
          <md-outlined-select
            id="requireSignedPush"
            value=${this.repoConfig?.require_signed_push?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleRequireSignedPushChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.require_signed_push).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderRejectImplicitMerges(){return dc`
      <section>
        <span class="title">
          Reject implicit merges when changes are pushed for review</span
        >
        <span class="value">
          <md-outlined-select
            id="rejectImplicitMergesSelect"
            value=${this.repoConfig?.reject_implicit_merges?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleRejectImplicitMergeSelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.reject_implicit_merges).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderUnRegisteredCc(){return dc`
      <section>
        <span class="title">
          Enable adding unregistered users as reviewers and CCs on changes</span
        >
        <span class="value">
          <md-outlined-select
            id="unRegisteredCcSelect"
            value=${this.repoConfig?.enable_reviewer_by_email?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleUnRegisteredCcSelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.enable_reviewer_by_email).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderPrivateByDefault(){return dc`
      <section>
        <span class="title"> Set all new changes private by default</span>
        <span class="value">
          <md-outlined-select
            id="setAllnewChangesPrivateByDefaultSelect"
            value=${this.repoConfig?.private_by_default?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleSetAllNewChangesPrivateByDefaultSelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.private_by_default).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderWorkInProgressByDefault(){return dc`
      <section>
        <span class="title">
          Set new changes to "work in progress" by default</span
        >
        <span class="value">
          <md-outlined-select
            id="setAllNewChangesWorkInProgressByDefaultSelect"
            value=${this.repoConfig?.work_in_progress_by_default?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleSetAllNewChangesWorkInProgressByDefaultSelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.work_in_progress_by_default).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderMaxGitObjectSize(){return dc`
      <section>
        <span class="title">Maximum Git object size limit</span>
        <span class="value">
          <md-outlined-text-field
            id="maxGitObjSizeInput"
            class="showBlueFocusBorder"
            type="number"
            min="0"
            ?disabled=${this.readOnly}
            .value=${this.repoConfig?.max_object_size_limit?.configured_value??""}
            @input=${this.handleMaxGitObjSizeInputChanged}
          >
          </md-outlined-text-field>
          ${this.repoConfig?.max_object_size_limit?.value?`effective: ${this.repoConfig.max_object_size_limit.value} bytes`:""}
        </span>
      </section>
    `}renderMatchAuthoredDateWithCommitterDate(){return dc`
      <section>
        <span class="title"
          >Match authored date with committer date upon submit</span
        >
        <span class="value">
          <md-outlined-select
            id="matchAuthoredDateWithCommitterDateSelect"
            value=${this.repoConfig?.match_author_to_committer_date?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleMatchAuthoredDateWithCommitterDateSelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.match_author_to_committer_date).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderRejectEmptyCommit(){return dc`
      <section>
        <span class="title">Reject empty commit upon submit</span>
        <span class="value">
          <md-outlined-select
            id="rejectEmptyCommitSelect"
            value=${this.repoConfig?.reject_empty_commit?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleRejectEmptyCommitSelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.reject_empty_commit).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderContributorAgreement(){return dc`
      <section>
        <span class="title">
          Require a valid contributor agreement to upload</span
        >
        <span class="value">
          <md-outlined-select
            id="contributorAgreementSelect"
            value=${this.repoConfig?.use_contributor_agreements?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleUseContributorAgreementsChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.use_contributor_agreements).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderUseSignedOffBy(){return dc`
      <section>
        <span class="title">Require Signed-off-by in commit message</span>
        <span class="value">
          <md-outlined-select
            id="useSignedOffBySelect"
            value=${this.repoConfig?.use_signed_off_by?.configured_value??""}
            ?disabled=${this.readOnly}
            @change=${this.handleUseSignedOffBySelectChange}
          >
            ${this.formatBooleanSelect(this.repoConfig?.use_signed_off_by).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.label}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </span>
      </section>
    `}renderPluginConfig(){const e=this.computePluginData();return e.length?dc` <div
      class="pluginConfig"
      @plugin-config-changed=${this.handlePluginConfigChanged}
    >
      <h3 class="heading-3">Plugins</h3>
      ${e.map((e=>dc`
          <gr-repo-plugin-config
            .pluginData=${e}
            ?disabled=${this.readOnly}
          ></gr-repo-plugin-config>
        `))}
    </div>`:uc}willUpdate(e){e.has("repo")&&this.loadRepo(),e.has("schemesObj")&&this.computeSchemesAndDefault()}computePluginData(){if(!this.repoConfig||!this.repoConfig.plugin_config)return[];const e=this.repoConfig.plugin_config;return Object.keys(e).map((t=>({name:t,config:e[t]})))}async loadRepo(){if(!this.repo)return Promise.resolve();this.repoConfig=void 0,this.originalConfig=void 0,this.loading=!0,this.weblinks=[],this.schemesObj=void 0,this.readOnly=!0;const e=[],t=e=>{ia(e)};e.push(this.restApiService.getLoggedIn().then((e=>{if(e){const e=this.repo;if(!e)throw new Error("undefined repo");this.restApiService.getRepo(e).then((e=>{e?.web_links&&(this.weblinks=e.web_links)})),this.restApiService.getRepoAccess(e).then((t=>{t&&this.repo===e&&(this.readOnly=!t[e]?.is_owner,this.disableSaveWithoutReview=!!t[e]?.require_change_for_config_update)}))}}))),e.push((async()=>{const e=await this.restApiService.getProjectConfig(this.repo,t);e&&(e.default_submit_type&&(e.submit_type=e.default_submit_type.configured_value),e.state||(e.state=_S.active.value),void 0===e.description&&(e.description=""),void 0===e.max_object_size_limit.configured_value&&(e.max_object_size_limit.configured_value=""),this.repoConfig=e,this.originalConfig=af(e),this.loading=!1)})()),e.push((async()=>{const e=await this.restApiService.getConfig();e&&(this.schemesObj=e.download.schemes)})()),await Promise.all(e)}formatBooleanSelect(e){if(!e)return[];let t="Inherit";return void 0!==e.inherited_value&&(t=`Inherit (${e.inherited_value})`),[{label:t,value:"INHERIT"},{label:"True",value:"TRUE"},{label:"False",value:"FALSE"}]}getWebLink(){return nS(this.weblinks,this.serverConfig)}formatSubmitTypeSelect(e){if(!e)return[];const t=Object.values(xS),i=e.default_submit_type;if(!i)return t;let r="Inherit";if(i.inherited_value){r=`Inherit (${i.inherited_value})`;for(const e of t)if(e.value===i.inherited_value){r=`Inherit (${e.label})`;break}}return[{label:r,value:"INHERIT"},...t]}formatRepoConfigForSave(e){if(!e)return{};const t={};for(const i of Object.keys(e)){const r=i;if("default_submit_type"!==r)if("plugin_config"===r)t.plugin_config_values=e.plugin_config;else if("object"==typeof e[r]){const i=e[r];void 0!==i.configured_value&&(t[r]=i.configured_value)}else t[r]=e[r]}return t}async handleSaveRepoConfig(){if(!this.repoConfig||!this.repo)return Promise.reject(new Error("undefined repoConfig or repo"));await this.restApiService.saveRepoConfig(this.repo,this.formatRepoConfigForSave(this.repoConfig)),this.originalConfig=af(this.repoConfig),this.pluginConfigChanged=!1}async handleSaveRepoConfigForReview(e){if(!this.repoConfig||!this.repo)return Promise.reject(new Error("undefined repoConfig or repo"));const t=e&&e.target;return t&&(t.loading=!0),this.restApiService.saveRepoConfigForReview(this.repo,this.formatRepoConfigForSave(this.repoConfig)).then((e=>{e&&this.getNavigation().setUrl(WC({change:e}))})).finally((()=>{t&&(t.loading=!1)}))}isEdited(e,t){return e?.configured_value!==t?.configured_value}hasConfigChanged(){const{repoConfig:e,originalConfig:t}=this;return!(!e||!t)&&(t.description!==e.description||t.state!==e.state||t.submit_type!==e.submit_type||!!this.isEdited(t.use_content_merge,e.use_content_merge)||!!this.isEdited(t.create_new_change_for_all_not_in_target,e.create_new_change_for_all_not_in_target)||!!this.isEdited(t.require_change_id,e.require_change_id)||!!this.isEdited(t.enable_signed_push,e.enable_signed_push)||!!this.isEdited(t.require_signed_push,e.require_signed_push)||!!this.isEdited(t.reject_implicit_merges,e.reject_implicit_merges)||!!this.isEdited(t.enable_reviewer_by_email,e.enable_reviewer_by_email)||!!this.isEdited(t.private_by_default,e.private_by_default)||!!this.isEdited(t.work_in_progress_by_default,e.work_in_progress_by_default)||!!this.isEdited(t.max_object_size_limit,e.max_object_size_limit)||!!this.isEdited(t.match_author_to_committer_date,e.match_author_to_committer_date)||!!this.isEdited(t.reject_empty_commit,e.reject_empty_commit)||!!this.isEdited(t.use_contributor_agreements,e.use_contributor_agreements)||!!this.isEdited(t.use_signed_off_by,e.use_signed_off_by)||this.pluginConfigChanged)}computeSchemesAndDefault(){this.schemes=this.schemesObj?Object.keys(this.schemesObj).sort():[],this.schemes.length>0&&(this.selectedScheme&&this.schemes.includes(this.selectedScheme)||(this.selectedScheme=this.schemes.sort()[0]))}getSchemeInfo(){if(this.schemesObj&&this.repo&&this.selectedScheme&&ma(this.schemesObj,this.selectedScheme))return this.schemesObj[this.selectedScheme]}computeDescription(){const e=this.getSchemeInfo();return e?.description}computeCommands(){const e=this.getSchemeInfo();if(!this.repo||!e)return[];const t=e.clone_commands??{},i=[];for(const[e,r]of Object.entries(t))i.push({title:e,command:r.replace(/\${project}/gi,encodeURI(this.repo)).replace(/\${project-base-name}/gi,encodeURI(this.repo.substring(this.repo.lastIndexOf("/")+1)))});return i}computeChangesUrl(e){return e?tE({repo:e}):""}handlePluginConfigChanged({detail:{name:e,config:t}}){this.repoConfig?.plugin_config&&(this.repoConfig.plugin_config[e]=t,this.pluginConfigChanged=!0,this.requestUpdate())}handleDescriptionInput(e){if(!this.repoConfig||this.loading)return;const t=e.target.value??"";this.repoConfig.description!==t&&(this.repoConfig={...this.repoConfig,description:t},this.requestUpdate())}handleStateSelectChange(e){if(!this.repoConfig||this.loading)return;const t=e.target;this.repoConfig.state!==t.value&&(this.repoConfig={...this.repoConfig,state:t.value},this.requestUpdate())}handleSubmitTypeSelectChange(e){if(!this.repoConfig||this.loading)return;const t=e.target;this.repoConfig.submit_type!==t.value&&(this.repoConfig={...this.repoConfig,submit_type:t.value},this.requestUpdate())}handleContentMergeSelectChange(e){if(!this.repoConfig?.use_content_merge||this.loading)return;const t=e.target;this.repoConfig.use_content_merge.configured_value=t.value,this.requestUpdate()}handleNewChangeSelectChange(e){if(!this.repoConfig?.create_new_change_for_all_not_in_target||this.loading)return;const t=e.target;this.repoConfig.create_new_change_for_all_not_in_target.configured_value=t.value,this.requestUpdate()}handleRequireChangeIdSelectChange(e){if(!this.repoConfig?.require_change_id||this.loading)return;const t=e.target;this.repoConfig.require_change_id.configured_value=t.value,this.requestUpdate()}handleEnableSignedPushChange(e){if(!this.repoConfig?.enable_signed_push||this.loading)return;const t=e.target;this.repoConfig.enable_signed_push.configured_value=t.value,this.requestUpdate()}handleRequireSignedPushChange(e){if(!this.repoConfig?.require_signed_push||this.loading)return;const t=e.target;this.repoConfig.require_signed_push.configured_value=t.value,this.requestUpdate()}handleRejectImplicitMergeSelectChange(e){if(!this.repoConfig?.reject_implicit_merges||this.loading)return;const t=e.target;this.repoConfig.reject_implicit_merges.configured_value=t.value,this.requestUpdate()}handleUnRegisteredCcSelectChange(e){if(!this.repoConfig?.enable_reviewer_by_email||this.loading)return;const t=e.target;this.repoConfig.enable_reviewer_by_email.configured_value=t.value,this.requestUpdate()}handleSetAllNewChangesPrivateByDefaultSelectChange(e){if(!this.repoConfig?.private_by_default||this.loading)return;const t=e.target;this.repoConfig.private_by_default.configured_value=t.value,this.requestUpdate()}handleSetAllNewChangesWorkInProgressByDefaultSelectChange(e){if(!this.repoConfig?.work_in_progress_by_default||this.loading)return;const t=e.target;this.repoConfig.work_in_progress_by_default.configured_value=t.value,this.requestUpdate()}handleMaxGitObjSizeInputChanged(e){if(!this.repoConfig?.max_object_size_limit||this.loading)return;const t=e.target;this.repoConfig.max_object_size_limit.value=t.value,this.repoConfig.max_object_size_limit.configured_value=t.value,this.requestUpdate()}handleMatchAuthoredDateWithCommitterDateSelectChange(e){if(!this.repoConfig?.match_author_to_committer_date||this.loading)return;const t=e.target;this.repoConfig.match_author_to_committer_date.configured_value=t.value,this.requestUpdate()}handleRejectEmptyCommitSelectChange(e){if(!this.repoConfig?.reject_empty_commit||this.loading)return;const t=e.target;this.repoConfig.reject_empty_commit.configured_value=t.value,this.requestUpdate()}handleUseContributorAgreementsChange(e){if(!this.repoConfig?.use_contributor_agreements||this.loading)return;const t=e.target;this.repoConfig.use_contributor_agreements.configured_value=t.value,this.requestUpdate()}handleUseSignedOffBySelectChange(e){if(!this.repoConfig?.use_signed_off_by||this.loading)return;const t=e.target;this.repoConfig.use_signed_off_by.configured_value=t.value,this.requestUpdate()}};var ES;wS([Fc({type:String})],CS.prototype,"repo",void 0),wS([Uc()],CS.prototype,"loading",void 0),wS([Uc()],CS.prototype,"repoConfig",void 0),wS([Uc()],CS.prototype,"readOnly",void 0),wS([Uc()],CS.prototype,"disableSaveWithoutReview",void 0),wS([Uc()],CS.prototype,"states",void 0),wS([Uc()],CS.prototype,"originalConfig",void 0),wS([Uc()],CS.prototype,"selectedScheme",void 0),wS([Uc()],CS.prototype,"schemesObj",void 0),wS([Uc()],CS.prototype,"serverConfig",void 0),wS([Uc()],CS.prototype,"weblinks",void 0),wS([Uc()],CS.prototype,"pluginConfigChanged",void 0),CS=wS([Dc("gr-repo")],CS),function(e){e.ABANDON="abandon",e.ADD_PATCH_SET="addPatchSet",e.CREATE="create",e.CREATE_TAG="createTag",e.CREATE_SIGNED_TAG="createSignedTag",e.DELETE="delete",e.DELETE_CHANGES="deleteChanges",e.DELETE_OWN_CHANGES="deleteOwnChanges",e.EDIT_HASHTAGS="editHashtags",e.EDIT_TOPIC_NAME="editTopicName",e.FORGE_AUTHOR="forgeAuthor",e.FORGE_COMMITTER="forgeCommitter",e.FORGE_SERVER_AS_COMMITTER="forgeServerAsCommitter",e.OWNER="owner",e.PUSH="push",e.PUSH_MERGE="pushMerge",e.READ="read",e.REBASE="rebase",e.REVERT="revert",e.REMOVE_REVIEWER="removeReviewer",e.SUBMIT="submit",e.SUBMIT_AS="submitAs",e.TOGGLE_WIP_STATE="toggleWipState",e.VIEW_PRIVATE_CHANGES="viewPrivateChanges",e.PRIORITY="priority"}(ES||(ES={}));const SS={[ES.ABANDON]:{id:ES.ABANDON,name:"Abandon"},[ES.ADD_PATCH_SET]:{id:ES.ADD_PATCH_SET,name:"Add Patch Set"},[ES.CREATE]:{id:ES.CREATE,name:"Create Reference"},[ES.CREATE_TAG]:{id:ES.CREATE_TAG,name:"Create Annotated Tag"},[ES.CREATE_SIGNED_TAG]:{id:ES.CREATE_SIGNED_TAG,name:"Create Signed Tag"},[ES.DELETE]:{id:ES.DELETE,name:"Delete Reference"},[ES.DELETE_CHANGES]:{id:ES.DELETE_CHANGES,name:"Delete Changes"},[ES.DELETE_OWN_CHANGES]:{id:ES.DELETE_OWN_CHANGES,name:"Delete Own Changes"},[ES.EDIT_HASHTAGS]:{id:ES.EDIT_HASHTAGS,name:"Edit Hashtags"},[ES.EDIT_TOPIC_NAME]:{id:ES.EDIT_TOPIC_NAME,name:"Edit Topic Name"},[ES.FORGE_AUTHOR]:{id:ES.FORGE_AUTHOR,name:"Forge Author Identity"},[ES.FORGE_COMMITTER]:{id:ES.FORGE_COMMITTER,name:"Forge Committer Identity"},[ES.FORGE_SERVER_AS_COMMITTER]:{id:ES.FORGE_SERVER_AS_COMMITTER,name:"Forge Server Identity"},[ES.OWNER]:{id:ES.OWNER,name:"Owner"},[ES.PUSH]:{id:ES.PUSH,name:"Push"},[ES.PUSH_MERGE]:{id:ES.PUSH_MERGE,name:"Push Merge Commit"},[ES.READ]:{id:ES.READ,name:"Read"},[ES.REBASE]:{id:ES.REBASE,name:"Rebase"},[ES.REVERT]:{id:ES.REVERT,name:"Revert"},[ES.REMOVE_REVIEWER]:{id:ES.REMOVE_REVIEWER,name:"Remove Reviewer"},[ES.SUBMIT]:{id:ES.SUBMIT,name:"Submit"},[ES.SUBMIT_AS]:{id:ES.SUBMIT_AS,name:"Submit (On Behalf Of)"},[ES.TOGGLE_WIP_STATE]:{id:ES.TOGGLE_WIP_STATE,name:"Toggle Work In Progress State"},[ES.VIEW_PRIVATE_CHANGES]:{id:ES.VIEW_PRIVATE_CHANGES,name:"View Private Changes"}};function $S(e){return e?Object.keys(e).map((t=>({id:t,value:e[t]}))).sort(((e,t)=>e.id.localeCompare(t.id))):[]}var kS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const AS=[ug.BATCH,ug.INTERACTIVE],RS={ALLOW:ug.ALLOW,DENY:ug.DENY,BLOCK:ug.BLOCK},TS=[ug.ALLOW,ug.DENY,ug.BLOCK],IS=[{name:"Allow pushing (but not force pushing)",value:!1},{name:"Allow pushing with or without force",value:!0}],PS=[{name:"Block pushing with or without force",value:!1},{name:"Block force pushing",value:!0}],NS=[{name:"No Force Edit",value:!1},{name:"Force Edit",value:!0}];let OS=class extends Ic{constructor(){super(),this.editing=!1,this.deleted=!1,this.addEventListener("access-saved",(()=>this.handleAccessSaved()))}connectedCallback(){super.connectedCallback(),this.rule&&this.setupValues(),!this.originalRuleValues&&this.rule&&this.setOriginalRuleValues()}static get styles(){return[my,vy,Nc,Jy,Sd`
        :host {
          border-bottom: 1px solid var(--border-color);
          padding: var(--spacing-m);
          display: block;
        }
        #removeBtn {
          display: none;
        }
        .editing #removeBtn {
          display: flex;
        }
        #options {
          align-items: baseline;
          display: flex;
        }
        #options > * {
          margin-right: var(--spacing-m);
        }
        #mainContainer {
          align-items: baseline;
          display: flex;
          flex-wrap: nowrap;
          justify-content: space-between;
        }
        #deletedContainer.deleted {
          align-items: baseline;
          display: flex;
          justify-content: space-between;
        }
        #undoBtn,
        #force,
        #deletedContainer,
        #mainContainer.deleted {
          display: none;
        }
        #undoBtn.modified,
        #force.force {
          display: block;
        }
        .groupPath {
          color: var(--deemphasized-text-color);
        }
        gr-autogrow-textarea {
          width: 14em;
        }
      `]}render(){return dc`
      <div
        id="mainContainer"
        class="gr-form-styles ${this.computeSectionClass()}"
      >
        <div id="options">
          <md-outlined-select
            id="action"
            value=${Lg(this.rule?.value?.action)}
            ?disabled=${!this.editing}
            @change=${this.handleActionChange}
          >
            ${this.computeOptions().map((e=>dc`
                <md-select-option value=${e}>
                  <div slot="headline">${e}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
          ${this.renderMinAndMaxLabel()} ${this.renderMinAndMaxInput()}
          <a
            class="groupPath"
            href=${Vw(this.computeGroupPath(this.groupId))}
          >
            ${this.groupName}
          </a>
          <md-outlined-select
            id="force"
            class=${this.computeForce(this.rule?.value?.action)?"force":""}
            value=${Lg(this.rule?.value?.force)}
            ?disabled=${!this.editing}
            @change=${this.handleForceChange}
          >
            ${this.computeForceOptions(this.rule?.value?.action).map((e=>dc`
                <md-select-option value=${e.value}>
                  <div slot="headline">${e.name}</div>
                </md-select-option>
              `))}
          </md-outlined-select>
        </div>
        <gr-button
          link
          id="removeBtn"
          @click=${()=>{this.handleRemoveRule()}}
          >Remove</gr-button
        >
      </div>
      <div
        id="deletedContainer"
        class="gr-form-styles ${this.computeSectionClass()}"
      >
        ${this.groupName} was deleted
        <gr-button
          link
          id="undoRemoveBtn"
          @click=${()=>{this.handleUndoRemove()}}
          >Undo</gr-button
        >
      </div>
    `}renderMinAndMaxLabel(){if(this.label)return dc`
      <md-outlined-select
        id="labelMin"
        value=${Lg(this.rule?.value?.min)}
        ?disabled=${!this.editing}
        @change=${this.handleMinChange}
      >
        ${this.label.values.map((e=>dc`
            <md-select-option value=${e.value}>
              <div slot="headline">${e.value}</div>
            </md-select-option>
          `))}
      </md-outlined-select>
      <md-outlined-select
        id="labelMax"
        value=${Lg(this.rule?.value?.max)}
        ?disabled=${!this.editing}
        @change=${this.handleMaxChange}
      >
        ${this.label.values.map((e=>dc`
            <md-select-option value=${e.value}>
              <div slot="headline">${e.value}</div>
            </md-select-option>
          `))}
      </md-outlined-select>
    `}renderMinAndMaxInput(){if(this.hasRange)return dc`
      <gr-autogrow-textarea
        id="minInput"
        class="min"
        autocomplete="on"
        placeholder="Min value"
        .value=${this.rule?.value?.min?.toString()??""}
        ?disabled=${!this.editing}
        @input=${e=>{const t=e.target.value??"";this.rule?.value&&void 0!==t&&this.rule.value.min!==Number(t)&&(this.rule.value.min=Number(t),this.handleValueChange())}}
      ></gr-autogrow-textarea>
      <gr-autogrow-textarea
        id="maxInput"
        class="max"
        autocomplete="on"
        placeholder="Max value"
        .value=${this.rule?.value?.max?.toString()??""}
        ?disabled=${!this.editing}
        @input=${e=>{const t=e.target.value??"";this.rule?.value&&void 0!==t&&this.rule.value.max!==Number(t)&&(this.rule.value.max=Number(t),this.handleValueChange())}}
      ></gr-autogrow-textarea>
    `}willUpdate(e){e.has("editing")&&this.handleEditingChanged(e.get("editing"))}setupValues(){this.rule?.value||this.setDefaultRuleValues()}computeForce(e){return ES.PUSH===this.permission&&e!==RS.DENY||ES.EDIT_TOPIC_NAME===this.permission}computeGroupPath(e){if(e)return`${Sf()}/admin/groups/${Rf(e)}`}handleAccessSaved(){this.setOriginalRuleValues()}handleEditingChanged(e){e&&(this.editing||this.handleUndoChange())}computeSectionClass(){const e=[];return this.editing&&e.push("editing"),this.deleted&&e.push("deleted"),e.join(" ")}computeForceOptions(e){return this.permission===ES.PUSH?e===RS.ALLOW?IS:e===RS.BLOCK?PS:[]:this.permission===ES.EDIT_TOPIC_NAME?NS:[]}getDefaultRuleValues(){return this.permission===ES.PRIORITY?{action:AS[0]}:this.label?{action:TS[0],min:this.label.values[0].value,max:this.label.values[this.label.values.length-1].value}:this.computeForce(RS.ALLOW)?{action:TS[0],force:this.computeForceOptions(RS.ALLOW)[0].value}:{action:TS[0]}}setDefaultRuleValues(){this.rule.value=this.getDefaultRuleValues(),this.handleRuleChange()}computeOptions(){return"priority"===this.permission?AS:TS}handleRemoveRule(){this.rule?.value&&(this.rule.value.added&&Jn(this,"added-rule-removed",{}),this.deleted=!0,this.rule.value.deleted=!0,this.handleRuleChange(),Jn(this,"access-modified",{}))}handleUndoRemove(){this.rule?.value&&(this.deleted=!1,delete this.rule.value.deleted,this.handleRuleChange())}handleUndoChange(){this.originalRuleValues&&this.rule?.value&&(this.rule.value.added||(this.rule.value={...this.originalRuleValues},this.deleted=!1,delete this.rule.value.deleted,delete this.rule.value.modified,this.handleRuleChange()))}handleValueChange(){this.originalRuleValues&&this.rule?.value&&(this.rule.value.modified=!0,this.handleRuleChange(),Jn(this,"access-modified",{}))}setOriginalRuleValues(){this.rule?.value&&(this.originalRuleValues={...this.rule.value})}handleActionChange(e){const t=e.target;this.rule?.value&&void 0!==t.value&&this.rule.value.action!==t.value&&(this.rule.value.action=t.value,this.handleValueChange())}handleMinChange(e){const t=e.target;this.rule?.value&&void 0!==t.value&&this.rule.value.min!==Number(t.value)&&(this.rule.value.min=Number(t.value),this.handleValueChange())}handleMaxChange(e){const t=e.target;this.rule?.value&&void 0!==t.value&&this.rule.value.max!==Number(t.value)&&(this.rule.value.max=Number(t.value),this.handleValueChange())}handleForceChange(e){const t=e.target,i="true"===String(t.value);this.rule?.value&&void 0!==t.value&&this.rule.value.force!==i&&(this.rule.value.force=i,this.handleValueChange())}handleRuleChange(){this.requestUpdate("rule"),Jn(this,"rule-changed",{value:this.rule})}};kS([Fc({type:Boolean})],OS.prototype,"hasRange",void 0),kS([Fc({type:Object})],OS.prototype,"label",void 0),kS([Fc({type:Boolean})],OS.prototype,"editing",void 0),kS([Fc({type:String})],OS.prototype,"groupId",void 0),kS([Fc({type:String})],OS.prototype,"groupName",void 0),kS([Fc({type:String})],OS.prototype,"permission",void 0),kS([Fc({type:Object})],OS.prototype,"rule",void 0),kS([Fc({type:String})],OS.prototype,"section",void 0),kS([Uc()],OS.prototype,"deleted",void 0),kS([Uc()],OS.prototype,"originalRuleValues",void 0),OS=kS([Dc("gr-rule-editor")],OS);var DS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const LS=["QUERY LIMIT","BATCH CHANGES LIMIT"];let MS=class extends Ic{constructor(){super(),this.editing=!1,this.deleted=!1,this.restApiService=Xn().restApiService,this.query=()=>this.getGroupSuggestions(),this.addEventListener("access-saved",(()=>this.handleAccessSaved()))}connectedCallback(){super.connectedCallback(),this.setupValues()}willUpdate(e){const t=e.get("editing");null!=t&&this.handleEditingChanged(t),(e.has("permission")||e.has("labels"))&&(this.label=this.computeLabel()),e.has("permission")&&this.sortPermission(this.permission)}static get styles(){return[Nc,Jy,my,N_,Sd`
        :host {
          display: block;
          margin-bottom: var(--spacing-m);
        }
        .header {
          align-items: baseline;
          display: flex;
          justify-content: space-between;
          margin: var(--spacing-s) var(--spacing-m);
        }
        .rules {
          background: var(--table-header-background-color);
          border: 1px solid var(--border-color);
          border-bottom: 0;
        }
        .editing .rules {
          border-bottom: 1px solid var(--border-color);
        }
        .title {
          margin-bottom: var(--spacing-s);
        }
        #addRule,
        #removeBtn {
          display: none;
        }
        .right {
          display: flex;
          align-items: center;
        }
        .editing #removeBtn {
          display: block;
          margin-left: var(--spacing-xl);
        }
        .editing #addRule {
          display: block;
          padding: var(--spacing-m);
        }
        #deletedContainer,
        .deleted #mainContainer {
          display: none;
        }
        .deleted #deletedContainer {
          align-items: baseline;
          border: 1px solid var(--border-color);
          display: flex;
          justify-content: space-between;
          padding: var(--spacing-m);
        }
        #mainContainer {
          display: block;
        }
      `]}render(){if(this.section&&this.permission)return dc`
      <section
        id="permission"
        class="gr-form-styles ${this.computeSectionClass(this.editing,this.deleted)}"
      >
        <div id="mainContainer">
          <div class="header">
            <span class="title">${this.name}</span>
            <div class="right">
              ${eb(!this.permissionIsOwnerOrGlobal(this.permission.id??"",this.section),(()=>dc`
                  <md-switch
                    id="exclusiveToggle"
                    ?selected=${!!this.permission?.value.exclusive}
                    ?disabled=${!this.editing}
                    @change=${this.handleValueChange}
                  ></md-switch
                  >${this.computeExclusiveLabel(this.permission?.value)}
                `))}
              <gr-button
                link=""
                id="removeBtn"
                @click=${this.handleRemovePermission}
                >Remove</gr-button
              >
            </div>
          </div>
          <!-- end header -->
          <div class="rules">
            ${this.rules?.map(((e,t)=>dc`
                <gr-rule-editor
                  .hasRange=${this.computeHasRange(this.name)}
                  .label=${this.label}
                  .editing=${this.editing}
                  .groupId=${e.id}
                  .groupName=${this.computeGroupName(this.groups,e.id)}
                  .permission=${this.permission.id}
                  .rule=${e}
                  .section=${this.section}
                  @rule-changed=${e=>this.handleRuleChanged(e,t)}
                  @added-rule-removed=${e=>this.handleAddedRuleRemoved(t)}
                ></gr-rule-editor>
              `))}
            <div id="addRule">
              <gr-autocomplete
                id="groupAutocomplete"
                .text=${this.groupFilter??""}
                @text-changed=${e=>this.groupFilter=e.detail.value}
                .query=${this.query}
                placeholder="Add group"
                @commit=${this.handleAddRuleItem}
              >
              </gr-autocomplete>
            </div>
            <!-- end addRule -->
          </div>
          <!-- end rules -->
        </div>
        <!-- end mainContainer -->
        <div id="deletedContainer">
          <span>${this.name} was deleted</span>
          <gr-button link="" id="undoRemoveBtn" @click=${this.handleUndoRemove}
            >Undo</gr-button
          >
        </div>
        <!-- end deletedContainer -->
      </section>
    `}setupValues(){this.permission&&(this.originalExclusiveValue=!!this.permission.value.exclusive,this.requestUpdate())}handleAccessSaved(){this.setupValues()}permissionIsOwnerOrGlobal(e,t){return"owner"===e||"GLOBAL_CAPABILITIES"===t}handleEditingChanged(e){if(e&&this.permission&&this.rules&&!this.editing){this.deleted=!1,delete this.permission.value.deleted,this.groupFilter="",this.rules=this.rules.filter((e=>!e.value.added)),this.handleRulesChanged();for(const e of Object.keys(this.permission.value.rules))this.permission.value.rules[e].added&&delete this.permission.value.rules[e];this.permission.value.exclusive=this.originalExclusiveValue,Jn(this,"permission-changed",{value:this.permission}),this.requestUpdate()}}handleAddedRuleRemoved(e){this.rules&&(this.rules=this.rules.slice(0,e).concat(this.rules.slice(e+1,this.rules.length)),this.handleRulesChanged())}handleValueChange(e){this.permission&&(this.permission.value.modified=!0,this.permission.value.exclusive=e.target.selected,Jn(this,"access-modified",{}))}handleRemovePermission(){this.permission&&(this.permission.value.added&&Jn(this,"added-permission-removed",{}),this.deleted=!0,this.permission.value.deleted=!0,Jn(this,"access-modified",{}))}handleRulesChanged(){this.rules&&(this.groupsWithRules=this.computeGroupsWithRules(this.rules))}sortPermission(e){this.rules=$S(e?.value.rules),this.handleRulesChanged()}computeSectionClass(e,t){const i=[];return e&&i.push("editing"),t&&i.push("deleted"),i.join(" ")}handleUndoRemove(){this.permission&&(this.deleted=!1,delete this.permission.value.deleted)}computeLabel(){const{permission:e,labels:t}=this;if(!(t&&e&&e.value&&e.value.label))return;const i=e.value.label;return t[i]?{name:i,values:this.computeLabelValues(t[i].values)}:void 0}computeLabelValues(e){const t=[],i=Object.keys(e).sort(((e,t)=>Number(e)-Number(t)));for(const r of i){let i=e[r];i||(i=""),t.push({value:Number(r),text:i})}return t}computeGroupsWithRules(e){const t={};for(const i of e)t[i.id]=!0;return t}computeGroupName(e,t){return e&&e[t]&&e[t].name?e[t].name:t}getGroupSuggestions(){return this.restApiService.getSuggestedGroups(this.groupFilter||"",this.repo,20,Ff).then((e=>{const t=[];for(const[i,r]of Object.entries(e??{}))t.push({name:i,value:r});return t.filter((e=>this.groupsWithRules&&!this.groupsWithRules[e.value.id])).map((e=>({name:e.name,value:e.value.id})))}))}async handleAddRuleItem(e){if(!this.permission||!this.rules)return;const t=decodeURIComponent(e.detail.value).replace(/\+/g," ");this.permission.value.rules[t]={},this.rules.push({id:t,value:void 0}),this.requestUpdate(),await this.updateComplete,this.groups&&!this.groups[t]&&(this.groups[t]={name:this.groupAutocomplete.text}),this.groupAutocomplete.text="";const i=this.rules[this.rules.length-1].value;i.added=!0,this.permission.value.rules[t]=i,Jn(this,"access-modified",{}),this.requestUpdate()}computeHasRange(e){return!!e&&LS.includes(e.toUpperCase())}computeExclusiveLabel(e){return e?.exclusive?"Exclusive":"Not Exclusive"}handleRuleChanged(e,t){this.rules.splice(t,e.detail.value),this.handleRulesChanged(),this.requestUpdate()}};DS([Fc({type:String})],MS.prototype,"repo",void 0),DS([Fc({type:Object})],MS.prototype,"labels",void 0),DS([Fc({type:String})],MS.prototype,"name",void 0),DS([Fc({type:Object})],MS.prototype,"permission",void 0),DS([Fc({type:Object})],MS.prototype,"groups",void 0),DS([Fc({type:String})],MS.prototype,"section",void 0),DS([Fc({type:Boolean})],MS.prototype,"editing",void 0),DS([Uc()],MS.prototype,"label",void 0),DS([Uc()],MS.prototype,"groupFilter",void 0),DS([Uc()],MS.prototype,"query",void 0),DS([Uc()],MS.prototype,"rules",void 0),DS([Uc()],MS.prototype,"groupsWithRules",void 0),DS([Uc()],MS.prototype,"deleted",void 0),DS([Uc()],MS.prototype,"originalExclusiveValue",void 0),DS([Hc("#groupAutocomplete")],MS.prototype,"groupAutocomplete",void 0),MS=DS([Dc("gr-permission")],MS);var FS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const US="GLOBAL_CAPABILITIES";let BS=class extends Ic{constructor(){super(),this.editing=!1,this.editingRef=!1,this.deleted=!1,this.selectedIndex=0,this.handlePermissionChanged=(e,t)=>{this.permissions[t]=e.detail.value,this.requestUpdate()},this.addEventListener("access-saved",(()=>this.handleAccessSaved()))}static get styles(){return[Jy,my,Qb,Nc,Sd`
        :host {
          display: block;
          margin-bottom: var(--spacing-l);
        }
        fieldset {
          border: 1px solid var(--border-color);
        }
        .name {
          align-items: center;
          display: flex;
        }
        .header,
        #deletedContainer {
          align-items: center;
          background: var(--table-header-background-color);
          border-bottom: 1px dotted var(--border-color);
          display: flex;
          justify-content: space-between;
          min-height: 3em;
          padding: 0 var(--spacing-m);
        }
        #deletedContainer {
          border-bottom: 0;
        }
        .sectionContent {
          padding: var(--spacing-m);
        }
        #editBtn,
        .editing #editBtn.global,
        #deletedContainer,
        .deleted #mainContainer,
        #addPermission,
        #deleteBtn,
        .editingRef .name,
        .editRefInput {
          display: none;
        }
        .editing #editBtn,
        .editingRef .editRefInput {
          display: flex;
        }
        .deleted #deletedContainer {
          display: flex;
        }
        .editing #addPermission,
        #mainContainer,
        .editing #deleteBtn {
          display: block;
        }
        .editing #deleteBtn,
        #undoRemoveBtn {
          padding-right: var(--spacing-m);
        }
      `]}render(){if(!this.section)return;const e=this.computePermissions();return dc`
      <fieldset
        id="section"
        class="gr-form-styles ${this.computeSectionClass()}"
      >
        <div id="mainContainer">
          <div class="header">
            <div class="name">
              <h3 class="heading-3">${this.computeSectionName()}</h3>
              <gr-button
                id="editBtn"
                link
                class=${this.section?.id===US?"global":""}
                @click=${this.editReference}
              >
                <gr-icon id="icon" icon="edit" filled small></gr-icon>
              </gr-button>
            </div>
            <md-outlined-text-field
              class="editRefInput showBlueFocusBorder"
              .value=${this.section?.id??""}
              @input=${this.handleValueChange}
            >
            </md-outlined-text-field>
            <gr-button link id="deleteBtn" @click=${this.handleRemoveReference}
              >Remove</gr-button
            >
          </div>
          <!-- end header -->
          <div class="sectionContent">
            ${Mw(this.permissions??[],(e=>e.id),((e,t)=>this.renderPermission(e,t)))}
            <div id="addPermission">
              Add permission:
              <md-outlined-select
                id="permissionSelect"
                value=${e[this.selectedIndex]?.value.id??e[0]?.value.id??""}
                @change=${e=>{const t=e.target;this.setSelectionIndex(t.value)}}
              >
                ${Mw(e,(e=>e.value.id),(e=>dc`
                    <md-select-option value=${e.value.id}>
                      <div slot="headline">${e.value.name}</div>
                    </md-select-option>
                  `))}
              </md-outlined-select>
              <gr-button link id="addBtn" @click=${this.handleAddPermission}
                >Add</gr-button
              >
            </div>
            <!-- end addPermission -->
          </div>
          <!-- end sectionContent -->
        </div>
        <!-- end mainContainer -->
        <div id="deletedContainer">
          <span>${this.computeSectionName()} was deleted</span>
          <gr-button link="" id="undoRemoveBtn" @click=${this.handleUndoRemove}
            >Undo</gr-button
          >
        </div>
        <!-- end deletedContainer -->
      </fieldset>
    `}renderPermission(e,t){return dc`
      <gr-permission
        .name=${this.computePermissionName(e)}
        .permission=${e}
        .labels=${this.labels}
        .section=${this.section?.id}
        .editing=${this.editing}
        .groups=${this.groups}
        .repo=${this.repo}
        @added-permission-removed=${()=>{this.handleAddedPermissionRemoved(t)}}
        @permission-changed=${e=>{this.handlePermissionChanged(e,t)}}
      >
      </gr-permission>
    `}willUpdate(e){e.has("section")&&this.updateSection(),e.has("editing")&&this.handleEditingChanged(e.get("editing"))}updateSection(){this.permissions=$S(this.section.value.permissions),this.originalId=this.section.id}handleAccessSaved(){this.section&&this.updateSection()}handleValueChange(e){e&&(this.section.id=e.target.value,this.requestUpdate(),Jn(this,"section-changed",{value:this.section})),this.section&&(this.section.value.added||(this.section.value.modified=this.section.id!==this.originalId,this.requestUpdate(),Jn(this,"access-modified",{})),this.section.value.updatedId=this.section.id,this.requestUpdate())}handleEditingChanged(e){if(e&&this.section&&this.permissions&&!this.editing){this.editingRef=!1,this.deleted=!1,delete this.section.value.deleted,this.section.id=this.originalId,this.requestUpdate(),Jn(this,"section-changed",{value:this.section}),this.permissions=this.permissions.filter((e=>!e.value.added));for(const e of Object.keys(this.section.value.permissions))this.section.value.permissions[e].added&&delete this.section.value.permissions[e]}}computePermissions(){let e;const t=this.section;return t&&t.value?(e=t.id===US?$S(this.capabilities):this.computeLabelOptions().concat($S(SS)),e.filter((e=>!t.value.permissions[e.id]))):[]}handleAddedPermissionRemoved(e){this.permissions&&(delete this.section?.value.permissions[this.permissions[e].id],this.permissions=this.permissions.slice(0,e).concat(this.permissions.slice(e+1,this.permissions.length)))}computeLabelOptions(){const e=[];if(!this.labels)return[];for(const t of Object.keys(this.labels))e.push({id:"label-"+t,value:{name:`Label ${t}`,id:"label-"+t}}),e.push({id:"labelAs-"+t,value:{name:`Label ${t} (On Behalf Of)`,id:"labelAs-"+t}}),e.push({id:"removeLabel-"+t,value:{name:`Remove Label ${t}`,id:"removeLabel-"+t}});return e}computePermissionName(e){return this.section?.id===US?this.capabilities?.[e.id]?.name:SS[e.id]?SS[e.id]?.name:e.value.label?e.id.startsWith("labelAs-")?`Label ${e.value.label} (On Behalf Of)`:e.id.startsWith("removeLabel-")?`Remove Label ${e.value.label}`:`Label ${e.value.label}`:void 0}computeSectionName(){let e=this.section?.id;return e||(this.editingRef=!0,e="refs/heads/*",this.section.id=e,Jn(this,"section-changed",{value:this.section}),this.requestUpdate()),e===US?"Global Capabilities":e.startsWith("refs/")?`Reference: ${e}`:e}handleRemoveReference(){this.section&&(this.section.value.added&&Jn(this,"added-section-removed",{}),this.deleted=!0,this.section.value.deleted=!0,Jn(this,"access-modified",{}))}handleUndoRemove(){this.section&&(this.deleted=!1,delete this.section.value.deleted,this.requestUpdate())}editRefInput(){return _a(this,"md-outlined-text-field.editRefInput")}editReference(){this.editingRef=!0,this.editRefInput().focus()}isEditEnabled(){return this.canUpload||this.ownerOf&&this.ownerOf.indexOf(this.section.id)>=0}computeSectionClass(){const e=[];return this.editing&&this.section&&this.isEditEnabled()&&e.push("editing"),this.editingRef&&e.push("editingRef"),this.deleted&&e.push("deleted"),e.join(" ")}handleAddPermission(){ba(this.permissionSelect,"permissionSelect");const e=this.permissionSelect.getAttribute("value");this.setSelectionIndex(e);const t={id:e,value:{rules:{},added:!0}};(e.startsWith("label")||e.startsWith("removeLabel"))&&(t.value.label=e.replace("label-","").replace("labelAs-","").replace("removeLabel-","")),this.permissions.push(t),this.section.value.permissions[t.id]=t.value,this.requestUpdate(),Jn(this,"section-changed",{value:this.section})}setSelectionIndex(e){const t=this.computePermissions().findIndex((t=>t.value.id===e)),i=t%this.computePermissions().length;this.selectedIndex=i}};FS([Hc("#permissionSelect")],BS.prototype,"permissionSelect",void 0),FS([Fc({type:String})],BS.prototype,"repo",void 0),FS([Fc({type:Object})],BS.prototype,"capabilities",void 0),FS([Fc({type:Object})],BS.prototype,"section",void 0),FS([Fc({type:Object})],BS.prototype,"groups",void 0),FS([Fc({type:Object})],BS.prototype,"labels",void 0),FS([Fc({type:Boolean})],BS.prototype,"editing",void 0),FS([Fc({type:Boolean})],BS.prototype,"canUpload",void 0),FS([Fc({type:Array})],BS.prototype,"ownerOf",void 0),FS([Uc()],BS.prototype,"originalId",void 0),FS([Uc()],BS.prototype,"editingRef",void 0),FS([Uc()],BS.prototype,"deleted",void 0),FS([Uc()],BS.prototype,"permissions",void 0),FS([Uc()],BS.prototype,"selectedIndex",void 0),BS=FS([Dc("gr-access-section")],BS);var HS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let jS=class extends Ic{constructor(){super(...arguments),this.imageAndText=!1}static get styles(){return[Sd`
        :host {
          display: inline-block;
          vertical-align: top;
          line-height: var(--line-height-normal);
          margin-right: var(--spacing-s);
        }
        a {
          color: var(--link-color);
        }
        :host([imageAndText]) img {
          margin-right: var(--spacing-s);
        }
        img {
          vertical-align: top;
          width: var(--line-height-normal);
          height: var(--line-height-normal);
        }
      `]}render(){return this.info?.url&&this.info?.name?dc`
      <a href=${this.info.url} rel="noopener noreferrer" target="_blank">
        <gr-tooltip-content
          title=${Vw(this.info.tooltip)}
          ?has-tooltip=${void 0!==this.info.tooltip}
        >
          ${eb(this.info.image_url,(()=>dc`<img src=${this.info.image_url} />`))}${eb(!this.info.image_url||this.imageAndText,(()=>dc`<span>${this.info.name}</span>`))}
        </gr-tooltip-content>
      </a>
    `:uc}};HS([Fc({type:Object})],jS.prototype,"info",void 0),HS([Fc({type:Boolean})],jS.prototype,"imageAndText",void 0),jS=HS([Dc("gr-weblink")],jS);var GS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let zS=class extends Ic{constructor(){super(),this.canUpload=!1,this.disableSaveWithoutReview=!0,this.editing=!1,this.modified=!1,this.loading=!0,this.restApiService=Xn().restApiService,this.getNavigation=yu(this,gy),this.query=()=>this.getInheritFromSuggestions(),this.addEventListener("access-modified",(()=>this._handleAccessModified()))}static get styles(){return[Qb,N_,Kw,Nc,Sd`
        gr-button,
        #inheritsFrom,
        #editInheritFromInput,
        .editing #inheritFromName,
        .weblinks,
        .editing .invisible {
          display: none;
        }
        #inheritsFrom.show {
          display: flex;
          min-height: 2em;
          align-items: center;
        }
        gr-weblink {
          margin-right: var(--spacing-xs);
        }
        gr-access-section {
          margin-top: var(--spacing-l);
        }
        .weblinks.show,
        .referenceContainer {
          display: block;
          align-content: center;
        }
        .rightsText {
          margin-right: var(--spacing-s);
        }

        .editing gr-button,
        .admin #editBtn {
          display: inline-block;
          margin: var(--spacing-l);
        }
        .editing #editInheritFromInput {
          display: inline-block;
        }

        .topLevelButtons {
          display: flex;
        }
      `]}render(){return dc`
      <div class="main ${this.computeMainClass()}">
        <div id="loading" class=${this.loading?"loading":""}>
          Loading...
        </div>
        <div id="loadedContent" class=${this.loading?"loading":""}>
          <h3
            id="inheritsFrom"
            class="heading-3 ${this.editing||this.inheritsFrom?.id?.length?"show":""}"
          >
            <span class="rightsText">Rights Inherit From</span>
            <a
              id="inheritFromName"
              href=${this.computeParentHref()}
              rel="noopener"
            >
              ${this.inheritsFrom?.name}</a
            >
            <gr-autocomplete
              id="editInheritFromInput"
              .text=${this.inheritFromFilter??""}
              .query=${this.query}
              .showBlueFocusBorder=${!0}
              @commit=${e=>{this.handleUpdateInheritFrom(e)}}
              @text-changed=${e=>{this.handleEditInheritFromTextChanged(e),this.handleUpdateInheritFrom(e)}}
            ></gr-autocomplete>
          </h3>
          <div class="topLevelButtons">
            <div class="weblinks ${this.weblinks?.length?"show":""}">
              History:
              ${this.weblinks?.map((e=>dc`<gr-weblink .info=${e}></gr-weblink>`))}
            </div>
            <div>
              <gr-button
                id="editBtn"
                @click=${()=>{this.handleEdit()}}
                >${this.editing?"Cancel":"Edit"}</gr-button
              >
              <gr-button
                id="saveBtn"
                class=${this.ownerOf&&0===this.ownerOf.length?"invisible":""}
                primary
                ?disabled=${!this.modified||this.disableSaveWithoutReview}
                @click=${this.handleSave}
                >Save</gr-button
              >
              <gr-button
                id="saveReviewBtn"
                class=${this.canUpload?"":"invisible"}
                primary
                ?disabled=${!this.modified}
                @click=${this.handleSaveForReview}
                >Save For Review</gr-button
              >
            </div>
          </div>
          ${this.sections?.map(((e,t)=>this.renderPermissionSections(e,t)))}
          <div class="referenceContainer">
            <gr-button
              id="addReferenceBtn"
              @click=${()=>this.handleCreateSection()}
              >Add Reference</gr-button
            >
          </div>
        </div>
      </div>
    `}renderPermissionSections(e,t){return dc`
      <gr-access-section
        .capabilities=${this.capabilities}
        .section=${e}
        .labels=${this.labels}
        .canUpload=${this.canUpload}
        .editing=${this.editing}
        .ownerOf=${this.ownerOf}
        .groups=${this.groups}
        .repo=${this.repo}
        @added-section-removed=${()=>{this.handleAddedSectionRemoved(t)}}
        @section-changed=${e=>{this.handleAccessSectionChanged(e,t)}}
      ></gr-access-section>
    `}willUpdate(e){e.has("repo")&&this._repoChanged(this.repo),e.has("editing")&&(this.handleEditingChanged(e.get("editing")),this.requestUpdate())}_handleAccessModified(){this.modified=!0}_repoChanged(e){return this.loading=!0,e?this.reload(e):Promise.resolve()}reload(e){const t=e=>{ia(e)};this.editing=!1,this.sections=[];const i=this.restApiService.getRepoAccessRights(e,t).then((e=>e?(e.inherits_from?(this.inheritsFrom={...e.inherits_from},this.originalInheritsFrom={...e.inherits_from}):(this.inheritsFrom=void 0,this.originalInheritsFrom=void 0),this.inheritFromFilter=e.inherits_from?e.inherits_from.name:"",this.local=e.local,this.groups=e.groups,this.weblinks=e.config_web_links||[],this.canUpload=e.can_upload,this.disableSaveWithoutReview=!!e.require_change_for_config_update,this.ownerOf=e.owner_of||[],$S(this.local)):Promise.resolve(void 0))),r=this.restApiService.getCapabilities(t).then((e=>e||Promise.resolve(void 0))),o=this.restApiService.getRepo(e,t).then((e=>e?e.labels:Promise.resolve(void 0)));return Promise.all([i,r,o]).then((([e,t,i])=>{this.capabilities=t,this.labels=i,this.sections=e,this.loading=!1}))}handleUpdateInheritFrom(e){this.inheritsFrom={...this.inheritsFrom??{},id:e.detail.value,name:this.inheritFromFilter},this._handleAccessModified()}getInheritFromSuggestions(){return this.restApiService.getRepos(this.inheritFromFilter,50,void 0,Ff).then((e=>{const t=[];if(!e)return t;for(const i of e)t.push({name:i.name,value:i.id});return t}))}handleEdit(){this.editing=!this.editing}handleAddedSectionRemoved(e){this.sections&&(ba(this.local,"local"),delete this.local[this.sections[e].id],this.sections=this.sections.slice(0,e).concat(this.sections.slice(e+1,this.sections.length)))}handleEditingChanged(e){if(e&&!this.editing&&(this.sections&&(this.sections=this.sections.filter((e=>!e.value.added))),this.inheritsFrom&&(this.inheritsFrom=this.originalInheritsFrom?{...this.originalInheritsFrom}:void 0,this.inheritFromFilter=this.originalInheritsFrom?.name),this.local))for(const e of Object.keys(this.local))this.local[e].added&&delete this.local[e]}updateRemoveObj(e,t){let i=e.remove;for(const e of t)i[e]||(e===t[t.length-1]?"permissions"===t[t.length-2]?i[e]={rules:{}}:1===t.length?i[e]={permissions:{}}:i[e]={}:i[e]={}),i=i[e];return e}updateAddObj(e,t,i){let r=e.add;for(const e of t)r[e]||(e===t[t.length-1]?r[e]=i:r[e]={}),r=r[e];return e}recursivelyRemoveDeleted(e){if(e)for(const t of Object.keys(e)){const i=e[t];if("object"==typeof i){if(i.deleted)return void delete e[t];this.recursivelyRemoveDeleted(i)}}}recursivelyUpdateAddRemoveObj(e,t,i=[]){if(e)for(const r of Object.keys(e)){const o=e[r];if("object"==typeof o){const e=o.updatedId,s=e||r;if(o.deleted){this.updateRemoveObj(t,i.concat(r));continue}if(o.modified){this.updateRemoveObj(t,i.concat(r)),this.updateAddObj(t,i.concat(s),o),e&&e!==r&&this.recursivelyRemoveDeleted(t.add[e]);continue}if(o.added){this.updateAddObj(t,i.concat(s),o),this.recursivelyRemoveDeleted(t.add[r]);continue}this.recursivelyUpdateAddRemoveObj(o,t,i.concat(r))}}}computeAddAndRemove(){const e={add:{},remove:{}},t=this.originalInheritsFrom?Tf(this.originalInheritsFrom.id):void 0,i=this.inheritsFrom?Tf(this.inheritsFrom.id):void 0,r=t&&t!==i||!t&&i;return this.local?(this.recursivelyUpdateAddRemoveObj(this.local,e),r&&(e.parent=i),e):e}handleCreateSection(){if(!this.local)return;let e="refs/for/*";for(;this.local[e];)e=`${e}*`;const t={permissions:{},added:!0};this.sections.push({id:e,value:t}),this.local[e]=t,this.requestUpdate(),ba(this.accessSection,"accessSection"),this.accessSection.editReference()}getObjforSave(){const e=this.computeAddAndRemove();if(!Object.keys(e.add).length&&!Object.keys(e.remove).length&&!e.parent)return void ea(this,"No changes to save.");const t={add:e.add,remove:e.remove};return e.parent&&(t.parent=e.parent),t}handleSave(e){const t=this.getObjforSave();if(!t)return;const i=e&&e.target;i&&(i.loading=!0);const r=this.repo;return r?this.restApiService.setRepoAccessRights(r,t).then((()=>{this.reload(r)})).finally((()=>{this.modified=!1,i&&(i.loading=!1)})):Promise.resolve()}handleSaveForReview(e){const t=this.getObjforSave();if(!t)return;const i=e&&e.target;return i&&(i.loading=!0),this.repo?this.restApiService.setRepoAccessRightsForReview(this.repo,t).then((e=>{e&&this.getNavigation().setUrl(WC({change:e}))})).finally((()=>{this.modified=!1,i&&(i.loading=!1)})):void 0}computeMainClass(){const e=[];return(this.ownerOf&&this.ownerOf.length>0||this.canUpload)&&e.push("admin"),this.editing&&e.push("editing"),e.join(" ")}computeParentHref(){return this.inheritsFrom?.name?bw({repo:this.inheritsFrom.name,detail:vw.ACCESS}):""}handleEditInheritFromTextChanged(e){this.inheritFromFilter=e.detail.value}handleAccessSectionChanged(e,t){this.sections[t]=e.detail.value,this.requestUpdate()}};GS([Hc("gr-access-section:last-of-type")],zS.prototype,"accessSection",void 0),GS([Fc({type:String})],zS.prototype,"repo",void 0),GS([Uc()],zS.prototype,"canUpload",void 0),GS([Uc()],zS.prototype,"disableSaveWithoutReview",void 0),GS([Uc()],zS.prototype,"inheritFromFilter",void 0),GS([Uc()],zS.prototype,"ownerOf",void 0),GS([Uc()],zS.prototype,"capabilities",void 0),GS([Uc()],zS.prototype,"groups",void 0),GS([Uc()],zS.prototype,"inheritsFrom",void 0),GS([Uc()],zS.prototype,"labels",void 0),GS([Uc()],zS.prototype,"local",void 0),GS([Uc()],zS.prototype,"editing",void 0),GS([Uc()],zS.prototype,"modified",void 0),GS([Uc()],zS.prototype,"sections",void 0),GS([Uc()],zS.prototype,"weblinks",void 0),GS([Uc()],zS.prototype,"loading",void 0),zS=GS([Dc("gr-repo-access")],zS);var VS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let WS=class extends Ic{constructor(){super(),this.branch="",this.subject="",this.privateChangesEnabled=!1,this.restApiService=Xn().restApiService,this.configModel=yu(this,Qw),this.getNavigation=yu(this,gy),this.query=e=>this.getRepoBranchesSuggestions(e),zf(this,(()=>this.configModel().serverConfig$),(e=>{this.privateChangesEnabled=e?.change?.disable_private_changes??!1}))}static get styles(){return[Jy,my,vy,Nc,Sd`
        input:not([type='checkbox']),
        md-outlined-text-field,
        gr-autocomplete,
        gr-autogrow-textarea {
          width: 100%;
        }
        .value {
          width: 32em;
        }
        .hide {
          display: none;
        }
        #messageInput {
          min-width: calc(72ch + 2px + 2 * var(--spacing-m) + 0.4px);
        }
        gr-autogrow-textarea:focus {
          border: 2px solid var(--input-focus-border-color);
        }
        @media only screen and (max-width: 40em) {
          .value {
            width: 29em;
          }
        }
      `]}render(){return dc`
      <div class="gr-form-styles">
        <section class=${this.baseChange?"hide":""}>
          <span class="title">Select branch for new change</span>
          <span class="value">
            <gr-autocomplete
              id="branchInput"
              .text=${this.branch}
              .query=${this.query}
              placeholder="Destination branch"
              .showBlueFocusBorder=${!0}
              @text-changed=${e=>{this.branch=e.detail.value}}
            >
            </gr-autocomplete>
          </span>
        </section>
        <section class=${this.baseChange?"hide":""}>
          <span class="title">Provide base commit sha1 for change</span>
          <span class="value">
            <md-outlined-text-field
              id="baseCommitInput"
              class="showBlueFocusBorder"
              maxlength="40"
              placeholder="(optional)"
              .value=${this.baseCommit??""}
              @input=${e=>{const t=e.target;this.baseCommit=t.value}}
            >
            </md-outlined-text-field>
          </span>
        </section>
        <section>
          <span class="title">Enter topic for new change</span>
          <span class="value">
            <md-outlined-text-field
              id="tagNameInput"
              class="showBlueFocusBorder"
              maxlength="1024"
              placeholder="(optional)"
              .value=${this.topic??""}
              @input=${e=>{const t=e.target;this.topic=t.value}}
            >
            </md-outlined-text-field>
          </span>
        </section>
        <section id="description">
          <span class="title">Description</span>
          <span class="value">
            <gr-autogrow-textarea
              id="messageInput"
              class="message"
              autocomplete="on"
              .rows=${4}
              .maxRows=${15}
              .value=${this.subject}
              placeholder="Insert the description of the change."
              @input=${e=>{const t=e.target.value??"";this.subject=t}}
            >
            </gr-autogrow-textarea>
          </span>
        </section>
        <section class=${this.privateChangesEnabled?"hide":""}>
          <label class="title" for="privateChangeCheckBox"
            >Private change</label
          >
          <span class="value">
            <md-checkbox
              id="privateChangeCheckBox"
              ?checked=${this.formatPrivateByDefaultBoolean()}
            ></md-checkbox>
          </span>
        </section>
      </div>
    `}willUpdate(e){e.has("repoName")&&this.loadRepo(),(e.has("branch")||e.has("subject"))&&this.allowCreate()}loadRepo(){this.repoName&&this.restApiService.getProjectConfig(this.repoName,(e=>{ia(e)})).then((e=>{e&&(this.repoConfig=e)}))}allowCreate(){Jn(this,"can-create-change",{})}handleCreateChange(){if(!this.repoName||!this.branch||!this.subject)return Promise.resolve();const e=this.privateChangeCheckBox.checked;return this.restApiService.createChange(this.repoName,this.branch,this.subject,this.topic,e,!0,this.baseChange,this.baseCommit||void 0).then((e=>{e&&this.getNavigation().setUrl(WC({change:e}))}))}getRepoBranchesSuggestions(e){return this.repoName?this.restApiService.getRepoBranches(Bx(e),this.repoName,15,void 0,Ff).then((e=>{if(!e)return[];const t=[];for(const i of e)t.push({name:Bx(i.ref)});return t})):Promise.reject(new Error("missing repo name"))}formatPrivateByDefaultBoolean(){const e=this.repoConfig?.private_by_default;if(void 0===e)return!1;switch(e.configured_value){case Bu.TRUE:return!0;case Bu.FALSE:return!1;case Bu.INHERIT:return!!e.inherited_value;default:return!1}}};VS([Hc("#privateChangeCheckBox")],WS.prototype,"privateChangeCheckBox",void 0),VS([Fc({type:String})],WS.prototype,"repoName",void 0),VS([Uc()],WS.prototype,"branch",void 0),VS([Uc()],WS.prototype,"subject",void 0),VS([Uc()],WS.prototype,"topic",void 0),VS([Fc({type:String})],WS.prototype,"baseChange",void 0),VS([Uc()],WS.prototype,"baseCommit",void 0),VS([Uc()],WS.prototype,"privateChangesEnabled",void 0),VS([Uc()],WS.prototype,"repoConfig",void 0),WS=VS([Dc("gr-create-change-dialog")],WS);var qS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let KS=class extends Ic{constructor(){super(...arguments),this.active=!1,this.loading=!1,this.restApiService=Xn().restApiService,this.getNavigation=yu(this,gy)}static get styles(){return[Iw]}render(){return this.active?dc`
      <dialog tabindex="-1">
        <gr-dialog
          disabled
          ?loading=${this.loading}
          .loadingLabel=${"Creating change ..."}
          @cancel=${()=>this.deactivate()}
          .confirmLabel=${this.loading?"Please wait ...":"Failed"}
          .cancelLabel=${"Cancel"}
        >
          <div slot="header">
            <span class="main-heading">Create Change from URL</span>
          </div>
          <div slot="main">
            ${eb(this.errorMessage,(()=>this.renderError()),(()=>this.renderCreating()))}
          </div>
        </gr-dialog>
      </dialog>
    `:uc}async activate(){this.active=!0,this.createChange(),await this.updateComplete,this.active&&!1===this.modal?.open&&this.modal.showModal()}deactivate(){this.active=!1,this.modal?.close()}renderCreating(){return dc`
      <div>
        <span>
          Creating a change in repository <b>${this.repo}</b> on branch
          <b>${this.branch}</b>.
        </span>
      </div>
      <div>
        <span>
          The page will then redirect to the file editor for
          <b>${this.path}</b>
          in the newly created change.
        </span>
      </div>
    `}renderError(){return dc`<div>Error: ${this.errorMessage}</div>`}createChange(){this.repo&&this.branch&&this.path?this.loading||this.errorMessage||(this.loading=!0,this.restApiService.createChange(this.repo,this.branch,`Edit ${this.path}`).then((e=>{this.active&&(e?(this.loading=!1,this.redirectToFileEdit(e),this.deactivate()):this.errorMessage="Creating the change failed.")})).catch((()=>{this.errorMessage="Creating the change failed."})).finally((()=>{this.loading=!1}))):this.errorMessage="repo, branch and path must be set"}redirectToFileEdit(e){ba(this.path,"path");const t=KC({changeNum:e._number,repo:e.project,patchNum:1,editView:{path:this.path}});this.getNavigation().setUrl(t)}};qS([Hc("dialog")],KS.prototype,"modal",void 0),qS([Hc("gr-dialog")],KS.prototype,"grDialog",void 0),qS([Fc({type:String})],KS.prototype,"repo",void 0),qS([Fc({type:String})],KS.prototype,"branch",void 0),qS([Fc({type:String})],KS.prototype,"path",void 0),qS([Uc()],KS.prototype,"errorMessage",void 0),qS([Uc()],KS.prototype,"active",void 0),qS([Uc()],KS.prototype,"loading",void 0),KS=qS([Dc("gr-create-file-edit-dialog")],KS);var YS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let XS=class extends Ic{constructor(){super(...arguments),this.loading=!0,this.canCreateChange=!1,this.creatingChange=!1,this.editingConfig=!1,this.runningGC=!1,this.restApiService=Xn().restApiService,this.getNavigation=yu(this,gy),this.createFileEditDialogWasActivated=!1}connectedCallback(){super.connectedCallback(),oa("Repo Commands")}static get styles(){return[Qb,my,Kw,Nc,Iw,Sd`
        #form h2,
        h3 {
          margin-top: var(--spacing-xxl);
        }
        p {
          padding: var(--spacing-m) 0;
        }
      `]}render(){return dc`
      <div class="main gr-form-styles read-only">
        <h1 id="Title" class="heading-1">Repository Commands</h1>
        <div id="loading" class=${this.loading?"loading":""}>
          Loading...
        </div>
        <div id="loadedContent" class=${this.loading?"loading":""}>
          <div id="form">
            <h2 class="heading-2">Create change</h2>
            <div>
              <p>
                Creates an empty work-in-progress change that can be used to
                edit files online and send the modifications for review.
              </p>
            </div>
            <div>
              <gr-button
                ?loading=${this.creatingChange}
                @click=${()=>{this.createNewChange()}}
              >
                Create Change
              </gr-button>
            </div>
            <h2 class="heading-2">Edit repo config</h2>
            <div>
              <p>
                Creates a work-in-progress change that allows to edit the
                <code>project.config</code> file in the
                <code>refs/meta/config</code> branch and send the modifications
                for review.
              </p>
            </div>
            <div>
              <gr-button
                id="editRepoConfig"
                ?loading=${this.editingConfig}
                @click=${()=>{this.handleEditRepoConfig()}}
              >
                Edit Repo Config
              </gr-button>
            </div>
            ${this.renderRepoGarbageCollector()}
            <gr-endpoint-decorator name="repo-command">
              <gr-endpoint-param name="config" .value=${this.repoConfig}>
              </gr-endpoint-param>
              <gr-endpoint-param name="repoName" .value=${this.repo}>
              </gr-endpoint-param>
            </gr-endpoint-decorator>
          </div>
        </div>
      </div>
      <dialog id="createChangeModal" tabindex="-1">
        <gr-dialog
          id="createChangeDialog"
          confirm-label="Create"
          ?disabled=${!this.canCreateChange}
          @confirm=${()=>{this.handleCreateChange()}}
          @cancel=${()=>{this.handleCloseCreateChange()}}
        >
          <div class="header" slot="header">Create Change</div>
          <div class="main" slot="main">
            <gr-create-change-dialog
              id="createNewChangeModal"
              .repoName=${this.repo}
              @can-create-change=${()=>{this.handleCanCreateChange()}}
            ></gr-create-change-dialog>
          </div>
        </gr-dialog>
      </dialog>
      <gr-create-file-edit-dialog
        id="createFileEditDialog"
        .repo=${this.repo}
        .branch=${this.createEdit?.branch}
        .path=${this.createEdit?.path}
      ></gr-create-file-edit-dialog>
    `}renderRepoGarbageCollector(){if(this.repoConfig?.actions&&this.repoConfig?.actions.gc?.enabled)return dc`
      <h2 class="heading-2">${this.repoConfig?.actions.gc?.label}</h2>
      <gr-button
        title=${this.repoConfig?.actions.gc?.title||""}
        ?loading=${this.runningGC}
        @click=${()=>this.handleRunningGC()}
      >
        ${this.repoConfig?.actions.gc?.label}
      </gr-button>
    `}updated(e){e.has("createEdit")&&(this.createFileEditDialogWasActivated||(this.createFileEditDialog?.activate(),this.createFileEditDialogWasActivated=!0))}willUpdate(e){e.has("repo")&&this.loadRepo()}loadRepo(){this.repo&&this.restApiService.getProjectConfig(this.repo,(e=>{ia(e)})).then((e=>{e&&(this.repoConfig=e)})).finally((()=>{this.loading=!1}))}handleRunningGC(){if(this.repo)return this.runningGC=!0,this.restApiService.runRepoGC(this.repo).then((e=>{200===e?.status&&ea(this,"Garbage collection completed successfully.")})).finally((()=>{this.runningGC=!1}))}createNewChange(){ba(this.createChangeModal,"createChangeModal"),this.createChangeModal.showModal()}handleCreateChange(){ba(this.createNewChangeModal,"createNewChangeModal"),this.creatingChange=!0,this.createNewChangeModal.handleCreateChange().finally((()=>{this.creatingChange=!1})),this.handleCloseCreateChange()}handleCloseCreateChange(){ba(this.createChangeModal,"createChangeModal"),this.createChangeModal.close()}handleEditRepoConfig(){if(this.repo)return this.editingConfig=!0,this.restApiService.createChange(this.repo,"refs/meta/config","Edit Repo Config",void 0,!1,!0).then((e=>{ea(this,e?"Navigating to change":"Failed to create change."),e&&this.getNavigation().setUrl(KC({changeNum:e._number,repo:e.project,patchNum:1,editView:{path:"project.config"}}))})).finally((()=>{this.editingConfig=!1}))}handleCanCreateChange(){ba(this.createNewChangeModal,"createNewChangeModal"),this.canCreateChange=!!this.createNewChangeModal.branch&&!!this.createNewChangeModal.subject}};YS([Hc("#createChangeModal")],XS.prototype,"createChangeModal",void 0),YS([Hc("#createNewChangeModal")],XS.prototype,"createNewChangeModal",void 0),YS([Hc("#createFileEditDialog")],XS.prototype,"createFileEditDialog",void 0),YS([Fc({type:String})],XS.prototype,"repo",void 0),YS([Fc({type:Object})],XS.prototype,"createEdit",void 0),YS([Uc()],XS.prototype,"loading",void 0),YS([Uc()],XS.prototype,"repoConfig",void 0),YS([Uc()],XS.prototype,"canCreateChange",void 0),YS([Uc()],XS.prototype,"creatingChange",void 0),YS([Uc()],XS.prototype,"editingConfig",void 0),YS([Uc()],XS.prototype,"runningGC",void 0),XS=YS([Dc("gr-repo-commands")],XS);var JS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let QS=class extends Ic{constructor(){super(...arguments),this.loading=!0,this.offset=0,this.filter="",this.itemsPerPage=25,this.restApiService=Xn().restApiService}static get styles(){return[Nc,pw,Sd`
        :host {
          display: block;
          margin-bottom: var(--spacing-xxl);
        }
      `]}render(){return dc` <gr-list-view
      .filter=${this.filter}
      .itemsPerPage=${this.itemsPerPage}
      .items=${this.dashboards}
      .loading=${this.loading}
      .offset=${this.offset}
      .path=${bw({repo:this.repo,detail:vw.DASHBOARDS})}
    >
      <table id="list" class="genericList">
        <tbody id="dashboards">
          <tr class="headerRow">
            <th class="topHeader">Dashboard name</th>
            <th class="topHeader">Dashboard title</th>
            <th class="topHeader">Dashboard description</th>
            <th class="topHeader">Inherited from</th>
            <th class="topHeader">Default</th>
          </tr>
          ${eb(this.loading,(()=>dc`<tr id="loadingContainer">
              <td>Loading...</td>
            </tr>`),(()=>dc`
              ${(this.dashboards??[]).map((e=>dc`
                  <tr class="groupHeader">
                    <td colspan="5">${e.section}</td>
                  </tr>
                  ${(e.dashboards??[]).map((e=>dc`
                      <tr class="table">
                        <td class="name">
                          <a href=${this.getUrl(e.project,e.id)}
                            >${e.path}</a
                          >
                        </td>
                        <td class="title">${e.title}</td>
                        <td class="desc">${e.description}</td>
                        <td class="inherited">
                          ${this.computeInheritedFrom(e.project,e.defining_project)}
                        </td>
                        <td class="default">
                          ${this.computeIsDefault(e.is_default)}
                        </td>
                      </tr>
                    `))}
                `))}
            `))}
        </tbody>
      </table>
    </gr-list-view>`}updated(e){e.has("repo")&&this.repoChanged()}willUpdate(e){e.has("params")&&this.paramsChanged()}async paramsChanged(){const e=this.params;this.loading=!0,this.filter=e?.filter??"",this.offset=Number(e?.offset??0),await this.repoChanged(this.filter,this.offset)}repoChanged(e,t){const i=this.repo;return this.loading=!0,i?this.restApiService.getRepoDashboards(i,(e=>{ia(e)})).then((i=>{if(!i)return;let r=i.concat.apply([],i).sort(((e,t)=>e.id<t.id?-1:1));r=r.filter((t=>void 0===e||t.path.toLowerCase().includes(e.toLowerCase()))).slice(t??0,(t??0)+this.itemsPerPage);const o={};r.forEach((e=>{o[e.ref]||(o[e.ref]=[]),o[e.ref].push(e)}));const s=[];Object.keys(o).sort().forEach((e=>{s.push({section:e,dashboards:o[e]})})),this.dashboards=s,this.loading=!1})):Promise.resolve()}getUrl(e,t){return e&&t?aE({project:e,type:sE.REPO,dashboard:t}):""}computeInheritedFrom(e,t){return e===t?"":t}computeIsDefault(e){return e?"✓":""}};JS([Fc({type:String})],QS.prototype,"repo",void 0),JS([Fc({type:Object})],QS.prototype,"params",void 0),JS([Uc()],QS.prototype,"loading",void 0),JS([Uc()],QS.prototype,"dashboards",void 0),JS([Uc()],QS.prototype,"offset",void 0),JS([Uc()],QS.prototype,"filter",void 0),JS([Uc()],QS.prototype,"itemsPerPage",void 0),QS=JS([Dc("gr-repo-dashboards")],QS);var ZS=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let e$=class extends Ic{constructor(){super(...arguments),this.restApiService=Xn().restApiService}static get styles(){return[Jy,my,Nc,Sd`
        :host {
          display: inline-block;
        }
        input {
          width: 20em;
        }
        md-outlined-text-field {
          width: 20em;
        }
      `]}render(){return dc`
      <div class="gr-form-styles">
        <div id="form">
          <section id="itemNameSection">
            <span class="title">${this.detailType} name</span>
            <md-outlined-text-field
              class="showBlueFocusBorder"
              placeholder="${this.detailType} Name"
              .value=${this.itemName??""}
              @input=${e=>{const t=e.target;this.itemName=t.value}}
            >
            </md-outlined-text-field>
          </section>
          <section
            id="createEmptyCommitSection"
            ?hidden=${this.itemDetail===vw.TAGS}
          >
            <div>
              <span class="title">Point to</span>
            </div>
            <div>
              <span class="value">
                <md-outlined-select
                  id="initialCommit"
                  value=${Lg(this.createEmptyCommit??!1)}
                  @change=${e=>{const t=e.target;this.createEmptyCommit="true"===t.value}}
                >
                  <md-select-option value="false">
                    <div slot="headline">Existing Revision</div>
                  </md-select-option>
                  <md-select-option value="true">
                    <div slot="headline">Initial empty commit</div>
                  </md-select-option>
                </md-outlined-select>
              </span>
            </div>
          </section>
          <section id="itemRevisionSection" ?hidden=${!!this.createEmptyCommit}>
            <span class="title">Initial Revision</span>
            <md-outlined-text-field
              class="showBlueFocusBorder"
              placeholder="Revision (Branch or SHA-1)"
              .value=${this.itemRevision??""}
              @input=${e=>{const t=e.target;this.itemRevision=t.value}}
            >
            </md-outlined-text-field>
          </section>
          <section
            id="itemAnnotationSection"
            ?hidden=${this.itemDetail===vw.BRANCHES}
          >
            <span class="title">Annotation</span>
            <md-outlined-text-field
              class="showBlueFocusBorder"
              placeholder="Annotation (Optional)"
              .value=${this.itemAnnotation??""}
              @input=${e=>{const t=e.target;this.itemAnnotation=t.value}}
            >
            </md-outlined-text-field>
          </section>
        </div>
      </div>
    `}updated(e){e.has("itemName")&&this.updateItemName()}updateItemName(){Jn(this,"update-item-name",{})}handleCreateItem(){if(!this.repoName)throw new Error("repoName name is not set");if(!this.itemName)throw new Error("itemName name is not set");const e=this.itemRevision?this.itemRevision:"HEAD",t=!!this.createEmptyCommit;if(this.itemDetail===vw.BRANCHES){const i=t?{create_empty_commit:!0}:{revision:e};return this.restApiService.createRepoBranch(this.repoName,this.itemName,i).then((e=>{201===e.status&&(ea(this,"Branch created successfully. Reloading..."),aa(this))}))}if(this.itemDetail===vw.TAGS)return this.restApiService.createRepoTag(this.repoName,this.itemName,{revision:e,message:this.itemAnnotation||void 0}).then((e=>{201===e.status&&(ea(this,"Tag created successfully. Reloading..."),aa(this))}));throw new Error(`Invalid itemDetail: ${this.itemDetail}`)}};ZS([Fc({type:String})],e$.prototype,"detailType",void 0),ZS([Fc({type:String})],e$.prototype,"repoName",void 0),ZS([Fc({type:String})],e$.prototype,"itemDetail",void 0),ZS([Uc()],e$.prototype,"itemName",void 0),ZS([Uc()],e$.prototype,"itemRevision",void 0),ZS([Uc()],e$.prototype,"itemAnnotation",void 0),ZS([Uc()],e$.prototype,"createEmptyCommit",void 0),e$=ZS([Dc("gr-create-pointer-dialog")],e$);var t$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let i$=class extends Ic{constructor(){super(),this.isOwner=!1,this.loggedIn=!1,this.offset=0,this.itemsPerPage=25,this.loading=!0,this.newItemName=!1,this.isEditing=!1,this.restApiService=Xn().restApiService,this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.serverConfig=e))}static get styles(){return[Jy,my,pw,Nc,Iw,Sd`
        .tags td.name {
          min-width: 25em;
        }
        td.name,
        td.revision,
        td.message {
          overflow-wrap: anywhere;
        }
        td.revision.tags {
          width: 27em;
        }
        td.message,
        td.tagger {
          max-width: 15em;
        }
        .editing .editItem {
          display: inherit;
        }
        .editItem,
        .editing .editBtn,
        .canEdit .revisionNoEditing,
        .editing .revisionWithEditing,
        .revisionEdit,
        .hideItem {
          display: none;
        }
        .revisionEdit gr-button {
          margin-left: var(--spacing-m);
        }
        .editBtn {
          margin-left: var(--spacing-l);
        }
        .canEdit .revisionEdit {
          align-items: center;
          display: flex;
        }
        .deleteButton:not(.show) {
          display: none;
        }
        .tagger.hide {
          display: none;
        }
      `]}render(){return this.repo&&this.detailType?dc`
      <gr-list-view
        .createNew=${this.loggedIn}
        .filter=${this.filter}
        .itemsPerPage=${this.itemsPerPage}
        .items=${this.items}
        .loading=${this.loading}
        .offset=${this.offset}
        .path=${this.getPath()}
        @create-clicked=${()=>{this.handleCreateClicked()}}
      >
        <table id="list" class="genericList gr-form-styles">
          <tbody>
            <tr class="headerRow">
              <th class="name topHeader">Name</th>
              <th class="revision topHeader">Revision</th>
              <th
                class="message topHeader ${this.detailType===vw.BRANCHES?"hideItem":""}"
              >
                Message
              </th>
              <th
                class="tagger topHeader ${this.detailType===vw.BRANCHES?"hideItem":""}"
              >
                Tagger
              </th>
              <th class="repositoryBrowser topHeader">Repository Browser</th>
              <th class="delete topHeader"></th>
            </tr>
            <tr
              id="loading"
              class="loadingMsg ${this.loading?"loading":""}"
            >
              <td>Loading...</td>
            </tr>
          </tbody>
          <tbody class=${this.loading?"loading":""}>
            ${this.items?.slice(0,this.itemsPerPage).map(((e,t)=>this.renderItemList(e,t)))}
          </tbody>
        </table>
        <dialog id="modal" tabindex="-1">
          <gr-confirm-delete-item-dialog
            class="confirmDialog"
            .item=${this.refName}
            .itemTypeName=${this.computeItemName(this.detailType)}
            @confirm=${()=>this.handleDeleteItemConfirm()}
            @cancel=${()=>{this.handleConfirmDialogCancel()}}
          ></gr-confirm-delete-item-dialog>
        </dialog>
      </gr-list-view>
      <dialog id="createModal" tabindex="-1">
        <gr-dialog
          id="createDialog"
          ?disabled=${!this.newItemName}
          confirm-label="Create"
          @confirm=${()=>{this.handleCreateItem()}}
          @cancel=${()=>{this.handleCloseCreate()}}
        >
          <div class="header" slot="header">
            Create ${this.computeItemName(this.detailType)}
          </div>
          <div class="main" slot="main">
            <gr-create-pointer-dialog
              id="createNewModal"
              .detailType=${this.computeItemName(this.detailType)}
              .itemDetail=${this.detailType}
              .repoName=${this.repo}
              @update-item-name=${()=>{this.handleUpdateItemName()}}
            ></gr-create-pointer-dialog>
          </div>
        </gr-dialog>
      </dialog>
    `:uc}renderItemList(e,t){return dc`
      <tr class="table">
        <td class="${this.detailType} name">
          <a href=${Vw(this.computeFirstWebLink(e)?.url)}>
            ${this.stripRefs(e.ref,this.detailType)}
          </a>
        </td>
        <td
          class="${this.detailType} revision ${this.computeCanEditClass(e.ref,this.detailType,this.isOwner)}"
        >
          <span class="revisionNoEditing"> ${e.revision} </span>
          <span class="revisionEdit ${this.isEditing?"editing":""}">
            <span class="revisionWithEditing"> ${e.revision} </span>
            <gr-button
              class="editBtn"
              link
              data-index=${t}
              @click=${()=>{this.handleEditRevision(t)}}
            >
              Edit
            </gr-button>
            <md-outlined-text-field
              class="editItem showBlueFocusBorder"
              .value=${this.revisedRef??""}
              @input=${e=>{const t=e.target;this.revisedRef=t.value}}
            >
            </md-outlined-text-field>
            <gr-button
              class="cancelBtn editItem"
              link
              @click=${()=>{this.handleCancelRevision()}}
            >
              Cancel
            </gr-button>
            <gr-button
              class="saveBtn editItem"
              link
              data-index=${t}
              ?disabled=${!this.revisedRef}
              @click=${()=>{this.handleSaveRevision(t)}}
            >
              Save
            </gr-button>
          </span>
        </td>
        <td
          class="message ${this.detailType===vw.BRANCHES?"hideItem":""}"
        >
          ${e?.message?e.message?.split("-----BEGIN PGP SIGNATURE-----")[0]:""}
        </td>
        <td
          class="tagger ${this.detailType===vw.BRANCHES?"hideItem":""}"
        >
          ${this.renderTagger(e.tagger)}
        </td>
        <td class="repositoryBrowser">
          ${this.computeWeblink(e).map((e=>this.renderWeblink(e)))}
        </td>
        <td class="delete">
          <gr-button
            class="deleteButton ${e.can_delete?"show":""}"
            link
            data-index=${t}
            @click=${()=>{this.handleDeleteItem(t)}}
          >
            Delete
          </gr-button>
        </td>
      </tr>
    `}renderTagger(e){if(e)return dc`
      <div class="tagger">
        <gr-account-label .account=${e} clickable> </gr-account-label>
        (<gr-date-formatter withTooltip .dateStr=${e.date}>
        </gr-date-formatter
        >)
      </div>
    `}renderWeblink(e){return dc`<gr-weblink imageAndText .info=${e}></gr-weblink>`}willUpdate(e){e.has("params")&&this.paramsChanged()}determineIfOwner(e){return this.restApiService.getRepoAccess(e).then((t=>this.isOwner=!!t?.[e]?.is_owner))}paramsChanged(){return this.params?.repo?this.params?.detail===vw.BRANCHES||this.params?.detail===vw.TAGS?(this.repo=this.params.repo,this.getLoggedIn().then((e=>{this.loggedIn=e,e&&this.repo&&this.determineIfOwner(this.repo)})),this.detailType=this.params.detail,this.filter=this.params?.filter??"",this.offset=Number(this.params?.offset??0),this.detailType?this.getItems(this.filter,this.repo,this.itemsPerPage,this.offset,this.detailType):Promise.reject(new Error("undefined detailType"))):void 0:Promise.reject(new Error("undefined repo"))}getItems(e,t,i,r,o){if(void 0===e||!t||void 0===r)return Promise.reject(new Error("filter or repo or offset undefined"));this.loading=!0,this.items=[];const s=e=>{ia(e)};return o===vw.BRANCHES?this.restApiService.getRepoBranches(e,t,i,r,s).then((e=>{this.items=e??[],this.loading=!1})).finally((()=>{this.loading=!1})):o===vw.TAGS?this.restApiService.getRepoTags(e,t,i,r,s).then((e=>{this.items=e??[]})).finally((()=>{this.loading=!1})):Promise.reject(new Error("unknown detail type"))}getPath(){return this.repo&&this.detailType?bw({repo:this.repo,detail:this.detailType}):""}computeWeblink(e){if(!e.web_links)return[];const t=e.web_links;return t.length?t:[]}computeFirstWebLink(e){return nS(e?.web_links,this.serverConfig)}stripRefs(e,t){if(t===vw.BRANCHES)return e.replace("refs/heads/","");if(t===vw.TAGS)return e.replace("refs/tags/","");throw new Error("unknown detailType")}getLoggedIn(){return this.restApiService.getLoggedIn()}computeCanEditClass(e,t,i){return void 0===e||void 0===t?"":i&&"HEAD"===this.stripRefs(e,t)?"canEdit":""}handleEditRevision(e){this.items&&(this.revisedRef=this.items[e].revision,this.isEditing=!0)}handleCancelRevision(){this.isEditing=!1}handleSaveRevision(e){this.revisedRef&&this.repo&&this.setRepoHead(this.repo,this.revisedRef,e)}setRepoHead(e,t,i){if(this.items)return this.restApiService.setRepoHead(e,t).then((e=>{e.status<400&&(this.isEditing=!1,this.items[i].revision=t,this.getItems(this.filter,this.repo,this.itemsPerPage,this.offset,this.detailType))}))}computeItemName(e){if(void 0===e)return"";if(e===vw.BRANCHES)return"Branch";if(e===vw.TAGS)return"Tag";throw new Error("unknown detailType")}handleDeleteItemConfirm(){return ba(this.modal,"modal"),this.modal.close(),this.repo&&this.refName?this.detailType===vw.BRANCHES?this.restApiService.deleteRepoBranches(this.repo,this.refName).then((e=>{204===e.status&&this.getItems(this.filter,this.repo,this.itemsPerPage,this.offset,this.detailType)})):this.detailType===vw.TAGS?this.restApiService.deleteRepoTags(this.repo,this.refName).then((e=>{204===e.status&&this.getItems(this.filter,this.repo,this.itemsPerPage,this.offset,this.detailType)})):Promise.reject(new Error("unknown detail type")):Promise.reject(new Error("undefined repo or refName"))}handleConfirmDialogCancel(){ba(this.modal,"modal"),this.modal.close()}handleDeleteItem(e){if(!this.items)return;ba(this.modal,"modal");const t=this.stripRefs(this.items[e].ref,this.detailType);t&&(this.refName=t,this.modal.showModal())}handleCreateItem(){ba(this.createNewModal,"createNewModal"),this.createNewModal.handleCreateItem(),this.handleCloseCreate()}handleCloseCreate(){ba(this.createModal,"createModal"),this.createModal.close()}handleCreateClicked(){ba(this.createModal,"createModal"),this.createModal.showModal()}handleUpdateItemName(){ba(this.createNewModal,"createNewModal"),this.newItemName=!!this.createNewModal.itemName}};t$([Hc("#modal")],i$.prototype,"modal",void 0),t$([Hc("#createModal")],i$.prototype,"createModal",void 0),t$([Hc("#createNewModal")],i$.prototype,"createNewModal",void 0),t$([Fc({type:Object})],i$.prototype,"params",void 0),t$([Uc()],i$.prototype,"detailType",void 0),t$([Uc()],i$.prototype,"isOwner",void 0),t$([Uc()],i$.prototype,"loggedIn",void 0),t$([Uc()],i$.prototype,"offset",void 0),t$([Uc()],i$.prototype,"repo",void 0),t$([Uc()],i$.prototype,"items",void 0),t$([Uc()],i$.prototype,"itemsPerPage",void 0),t$([Uc()],i$.prototype,"loading",void 0),t$([Uc()],i$.prototype,"filter",void 0),t$([Uc()],i$.prototype,"refName",void 0),t$([Uc()],i$.prototype,"newItemName",void 0),t$([Uc()],i$.prototype,"isEditing",void 0),t$([Uc()],i$.prototype,"revisedRef",void 0),t$([Uc()],i$.prototype,"serverConfig",void 0),i$=t$([Dc("gr-repo-detail-list")],i$);var r$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let o$=class extends Ic{static get styles(){return[Jy,Nc,pw,my,Iw,Sd`
        :host {
          display: block;
          margin-bottom: var(--spacing-xxl);
        }
        .actions {
          display: flex;
          justify-content: flex-end;
          margin-bottom: var(--spacing-m);
          padding: var(--spacing-l);
        }
        .createButton {
          margin-left: var(--spacing-m);
        }
        .deleteBtn {
          --gr-button-padding: var(--spacing-s) var(--spacing-m);
        }
        div.title-flex,
        div.value-flex {
          display: flex;
          flex-direction: column;
          justify-content: center;
        }
        input {
          width: 20em;
          box-sizing: border-box;
        }
        div.gr-form-styles section {
          margin: var(--spacing-m) 0;
        }
        div.gr-form-styles span.title {
          width: 13em;
        }
        section .title gr-icon {
          vertical-align: top;
        }
        textarea {
          width: 20em;
          min-height: 100px;
          resize: vertical;
          box-sizing: border-box;
          background-color: var(--view-background-color);
          color: var(--primary-text-color);
        }
        textarea:focus {
          outline: none;
          box-shadow: none;
          border: 2px solid var(--input-focus-border-color);
          margin: -1px;
        }
        textarea::placeholder {
          color: var(--deemphasized-text-color);
        }
        gr-dialog {
          width: 36em;
        }
        gr-dialog .footer {
          width: 100%;
          display: flex;
          justify-content: flex-end;
        }
        md-outlined-text-field {
          width: 20em;
        }
      `]}constructor(){super(),this.loading=!0,this.showCreateDialog=!1,this.isProjectOwner=!1,this.disableSaveWithoutReview=!0,this.showSaveForReviewButton=!1,this.newRequirement=this.getEmptyRequirement(),this.offset=0,this.filter="",this.itemsPerPage=25,this.showDeleteDialog=!1,this.isEditing=!1,this.getNavigation=yu(this,gy),this.restApiService=Xn().restApiService,this.repo&&this.checkProjectOwner()}async checkProjectOwner(){if(this.repo)try{const e=await this.restApiService.getRepoAccessRights(this.repo);this.isProjectOwner=!!e?.is_owner,this.disableSaveWithoutReview=!!e?.require_change_for_config_update,this.showSaveForReviewButton=!0}catch(e){console.error("Failed to check project owner status:",e),this.isProjectOwner=!1}}render(){return dc`
      <gr-list-view
        .createNew=${this.isProjectOwner}
        .filter=${this.filter}
        .itemsPerPage=${this.itemsPerPage}
        .items=${this.submitRequirements}
        .loading=${this.loading}
        .offset=${this.offset}
        .path=${bw({repo:this.repo,detail:vw.SUBMIT_REQUIREMENTS})}
        @create-clicked=${()=>this.handleCreateClick()}
      >
        <table id="list" class="genericList">
          <tbody>
            <tr class="headerRow">
              <th class="topHeader">Name</th>
              <th class="topHeader">Description</th>
              <th class="topHeader">Applicability Expression</th>
              <th class="topHeader">Submittability Expression</th>
              <th class="topHeader">Override Expression</th>
              <th
                class="topHeader"
                title="Whether override is allowed in child projects"
              >
                Allow Override
              </th>
              ${eb(this.isProjectOwner,(()=>dc`<th class="topHeader"></th>`))}
            </tr>
          </tbody>
          <tbody id="submit-requirements">
            ${eb(this.loading,(()=>dc`<tr id="loadingContainer">
                <td>Loading...</td>
              </tr>`),(()=>dc` ${(this.submitRequirements??[]).map((e=>dc`
                    <tr class="table">
                      <td class="name">${e.name}</td>
                      <td class="desc">${e.description}</td>
                      <td class="applicability">
                        ${e.applicability_expression}
                      </td>
                      <td class="submittability">
                        ${e.submittability_expression}
                      </td>
                      <td class="override">${e.override_expression}</td>
                      <td class="allowOverride">
                        ${this.renderCheckmark(e.allow_override_in_child_projects)}
                      </td>
                      ${eb(this.isProjectOwner,(()=>dc`
                          <td class="actions">
                            <gr-button
                              class="editBtn"
                              link
                              @click=${()=>this.handleEditClick(e)}
                            >
                              Edit
                            </gr-button>
                            <gr-button
                              class="deleteBtn"
                              link
                              @click=${()=>this.handleDeleteClick(e)}
                            >
                              Delete
                            </gr-button>
                          </td>
                        `))}
                    </tr>
                  `))}`))}
          </tbody>
        </table>
      </gr-list-view>

      ${this.renderCreateDialog()} ${this.renderDeleteDialog()}
    `}updated(e){e.has("repo")&&(this.getSubmitRequirements(),this.checkProjectOwner())}willUpdate(e){e.has("params")&&this._paramsChanged()}async _paramsChanged(){const e=this.params;this.loading=!0,this.filter=e?.filter??"",this.offset=Number(e?.offset??0),await this.getSubmitRequirements(this.filter,this.offset)}getSubmitRequirements(e,t){const i=this.repo;return this.loading=!0,i?this.restApiService.getRepoSubmitRequirements(i,(e=>{ia(e)})).then((i=>{i&&(this.submitRequirements=i.filter((t=>void 0===e||t.name.toLowerCase().includes(e.toLowerCase()))).slice(t??0,(t??0)+this.itemsPerPage),this.loading=!1)})):Promise.resolve()}renderCheckmark(e){return e?"✓":""}handleCreateClick(){this.isEditing=!1,this.newRequirement=this.getEmptyRequirement(),ba(this.createDialog,"createDialog"),this.createDialog.showModal()}handleEditClick(e){this.isEditing=!0,this.requirementToEdit=e,this.newRequirement={name:e.name,description:e.description||"",applicability_expression:e.applicability_expression||"",submittability_expression:e.submittability_expression||"",override_expression:e.override_expression||"",allow_override_in_child_projects:e.allow_override_in_child_projects||!1},ba(this.createDialog,"createDialog"),this.createDialog.showModal()}handleCreateCancel(){ba(this.createDialog,"createDialog"),this.createDialog.close(),this.newRequirement=this.getEmptyRequirement(),this.requirementToEdit=void 0,this.isEditing=!1}handleCreateConfirm(){if(!this.repo)return;if(!this.newRequirement.name||!this.newRequirement.submittability_expression)return;const e=e=>{ia(e)};(this.isEditing&&this.requirementToEdit?this.restApiService.updateSubmitRequirement(this.repo,this.requirementToEdit.name,this.newRequirement,e):this.restApiService.createSubmitRequirement(this.repo,this.newRequirement,e)).then((()=>{this.createDialog?.close(),this.newRequirement=this.getEmptyRequirement(),this.requirementToEdit=void 0,this.isEditing=!1,this.getSubmitRequirements(this.filter,this.offset)}))}getEmptyRequirement(){return{name:"",description:"",applicability_expression:"",submittability_expression:"",override_expression:"",allow_override_in_child_projects:!1}}renderCreateDialog(){return this.isProjectOwner?dc`
      <dialog id="createDialog" tabindex="-1">
        <gr-dialog .cancelLabel=${""} .confirmLabel=${""}>
          <div class="header" slot="header">
            ${this.isEditing?"Edit":"Create"} Submit Requirement
          </div>
          <div class="main" slot="main">
            <div class="gr-form-styles">
              <div id="form">
                <section>
                  <div class="title-flex">
                    <span class="title">Name</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-outlined-text-field
                        id="name"
                        class="showBlueFocusBorder"
                        ?required=${!0}
                        ?disabled=${this.isEditing}
                        .value=${this.newRequirement.name??""}
                        @input=${e=>{this.newRequirement={...this.newRequirement,name:e.target.value}}}
                      >
                      </md-outlined-text-field>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Description</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <textarea
                        id="description"
                        .value=${this.newRequirement.description??""}
                        @input=${e=>{this.newRequirement={...this.newRequirement,description:e.target.value}}}
                        placeholder="Optional"
                      ></textarea>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Applicability Expression</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-outlined-text-field
                        id="applicability"
                        class="showBlueFocusBorder"
                        placeholder="Optional"
                        .value=${this.newRequirement.applicability_expression??""}
                        @input=${e=>{this.newRequirement={...this.newRequirement,applicability_expression:e.target.value}}}
                      >
                      </md-outlined-text-field>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Submittability Expression</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-outlined-text-field
                        id="submittability"
                        class="showBlueFocusBorder"
                        ?required=${!0}
                        .value=${this.newRequirement.submittability_expression??""}
                        @input=${e=>{this.newRequirement={...this.newRequirement,submittability_expression:e.target.value}}}
                      >
                      </md-outlined-text-field>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Override Expression</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-outlined-text-field
                        id="override"
                        class="showBlueFocusBorder"
                        placeholder="Optional"
                        .value=${this.newRequirement.override_expression??""}
                        @input=${e=>{this.newRequirement={...this.newRequirement,override_expression:e.target.value}}}
                      >
                      </md-outlined-text-field>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Allow Override in Child Projects</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-checkbox
                        id="allowOverride"
                        ?checked=${this.newRequirement.allow_override_in_child_projects}
                        @change=${e=>{this.newRequirement={...this.newRequirement,allow_override_in_child_projects:e.target.checked}}}
                      ></md-checkbox>
                    </span>
                  </div>
                </section>
              </div>
            </div>
          </div>
          <div class="footer" slot="footer">
            <gr-button @click=${this.handleCreateCancel} link>Cancel</gr-button>
            <gr-button
              class="action save-button"
              link
              primary
              ?disabled=${!this.newRequirement.name||!this.newRequirement.submittability_expression||this.disableSaveWithoutReview}
              @click=${this.handleCreateConfirm}
            >
              ${this.isEditing?"Save":"Create"}
            </gr-button>
            <gr-button
              class="action save-for-review"
              primary
              link
              ?hidden=${!this.showSaveForReviewButton}
              ?disabled=${!this.newRequirement.name||!this.newRequirement.submittability_expression}
              @click=${this.handleSaveForReview}
            >
              Save for review
            </gr-button>
          </div>
        </gr-dialog>
      </dialog>
    `:uc}async handleSaveForReview(e){if(!this.repo)return;if(!this.newRequirement.name||!this.newRequirement.submittability_expression)return;const t=e.target;t.loading=!0;const i={};this.isEditing&&this.requirementToEdit?i.update={[this.newRequirement.name]:this.newRequirement}:i.create=[this.newRequirement];const r=this.restApiService.saveRepoSubmitRequirementsForReview(this.repo,i,(e=>{ia(e)}));try{const e=await r;e&&this.getNavigation().setUrl(WC({change:e}))}finally{t.loading=!1,this.createDialog?.close(),this.newRequirement=this.getEmptyRequirement(),this.requirementToEdit=void 0,this.isEditing=!1,this.getSubmitRequirements(this.filter,this.offset)}}renderDeleteDialog(){return this.isProjectOwner?dc`
      <dialog id="deleteDialog" tabindex="-1">
        <gr-dialog .cancelLabel=${""} .confirmLabel=${""}>
          <div class="header" slot="header">Delete Submit Requirement</div>
          <div class="main" slot="main">
            Are you sure you want to delete the submit requirement
            "${this.requirementToDelete?.name}"?
          </div>
          <div class="footer" slot="footer">
            <gr-button link @click=${this.handleDeleteCancel}>Cancel</gr-button>
            <gr-button
              class="action"
              link
              ?disabled=${this.disableSaveWithoutReview}
              @click=${this.handleDeleteConfirm}
            >
              Delete
            </gr-button>
            <gr-button
              class="action"
              primary
              link
              ?hidden=${!this.showSaveForReviewButton}
              @click=${this.handleDeleteForReviewConfirm}
            >
              Delete for review
            </gr-button>
          </div>
        </gr-dialog>
      </dialog>
    `:uc}handleDeleteClick(e){this.requirementToDelete=e,ba(this.deleteDialog,"deleteDialog"),this.deleteDialog.showModal()}handleDeleteCancel(){ba(this.deleteDialog,"deleteDialog"),this.deleteDialog.close(),this.requirementToDelete=void 0}async handleDeleteForReviewConfirm(){if(!this.repo||!this.requirementToDelete)return;const e={delete:[this.requirementToDelete.name]},t=this.restApiService.saveRepoSubmitRequirementsForReview(this.repo,e,(e=>{ia(e)}));try{const e=await t;e&&this.getNavigation().setUrl(WC({change:e}))}finally{this.deleteDialog?.close(),this.requirementToDelete=void 0,this.getSubmitRequirements(this.filter,this.offset)}}handleDeleteConfirm(){this.repo&&this.requirementToDelete&&this.restApiService.deleteSubmitRequirement(this.repo,this.requirementToDelete.name,(e=>{ia(e)})).then((()=>{this.deleteDialog?.close(),this.requirementToDelete=void 0,this.getSubmitRequirements(this.filter,this.offset)}))}};r$([Fc({type:String})],o$.prototype,"repo",void 0),r$([Fc({type:Object})],o$.prototype,"params",void 0),r$([Hc("#createDialog")],o$.prototype,"createDialog",void 0),r$([Hc("#deleteDialog")],o$.prototype,"deleteDialog",void 0),r$([Uc()],o$.prototype,"loading",void 0),r$([Uc()],o$.prototype,"submitRequirements",void 0),r$([Uc()],o$.prototype,"showCreateDialog",void 0),r$([Uc()],o$.prototype,"isProjectOwner",void 0),r$([Uc()],o$.prototype,"disableSaveWithoutReview",void 0),r$([Uc()],o$.prototype,"showSaveForReviewButton",void 0),r$([Uc()],o$.prototype,"newRequirement",void 0),r$([Uc()],o$.prototype,"offset",void 0),r$([Uc()],o$.prototype,"filter",void 0),r$([Uc()],o$.prototype,"itemsPerPage",void 0),r$([Uc()],o$.prototype,"showDeleteDialog",void 0),r$([Uc()],o$.prototype,"requirementToDelete",void 0),r$([Uc()],o$.prototype,"requirementToEdit",void 0),r$([Uc()],o$.prototype,"isEditing",void 0),o$=r$([Dc("gr-repo-submit-requirements")],o$);var s$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let n$=class extends Ic{static get styles(){return[Jy,Nc,pw,my,Iw,Sd`
        :host {
          display: block;
          margin-bottom: var(--spacing-xxl);
        }
        .actions {
          display: flex;
          justify-content: flex-end;
          margin-bottom: var(--spacing-m);
          padding: var(--spacing-l);
        }
        .createButton {
          margin-left: var(--spacing-m);
        }
        .deleteBtn {
          --gr-button-padding: var(--spacing-s) var(--spacing-m);
        }
        div.title-flex,
        div.value-flex {
          display: flex;
          flex-direction: column;
          justify-content: center;
        }
        input {
          width: 20em;
          box-sizing: border-box;
        }
        div.gr-form-styles section {
          margin: var(--spacing-m) 0;
        }
        div.gr-form-styles span.title {
          width: 13em;
        }
        section .title gr-icon {
          vertical-align: top;
        }
        textarea {
          width: 20em;
          min-height: 4em;
          resize: vertical;
          box-sizing: border-box;
          background-color: var(--view-background-color);
          color: var(--primary-text-color);
        }
        textarea:focus {
          outline: none;
          box-shadow: none;
          border: 2px solid var(--input-focus-border-color);
          margin: -1px;
        }
        textarea::placeholder {
          color: var(--deemphasized-text-color);
        }
        gr-dialog .main {
          max-height: 70vh;
          overflow-y: auto;
        }
        gr-dialog .footer {
          width: 100%;
          display: flex;
          justify-content: flex-end;
        }
        gr-dialog {
          width: 36em;
        }
        .warning {
          color: var(--warning-foreground);
          margin-top: var(--spacing-s);
        }
        .warning gr-icon {
          color: var(--warning-icon-color);
          vertical-align: bottom;
          margin-right: var(--spacing-s);
        }
        td gr-icon {
          vertical-align: bottom;
          margin-left: var(--spacing-s);
        }
        md-outlined-text-field {
          max-width: 25em;
        }
        md-checkbox {
          --md-checkbox-container-size: 15px;
          --md-checkbox-icon-size: 15px;
        }
      `]}constructor(){super(),this.loading=!0,this.showCreateDialog=!1,this.isProjectOwner=!1,this.disableSaveWithoutReview=!0,this.showSaveForReviewButton=!1,this.newLabel=this.getEmptyLabel(),this.offset=0,this.filter="",this.itemsPerPage=25,this.showDeleteDialog=!1,this.isEditing=!1,this.getNavigation=yu(this,gy),this.restApiService=Xn().restApiService,this.repo&&this.checkProjectOwner()}async checkProjectOwner(){if(this.repo)try{const e=await this.restApiService.getRepoAccessRights(this.repo);this.isProjectOwner=!!e?.is_owner,this.disableSaveWithoutReview=!!e?.require_change_for_config_update,this.showSaveForReviewButton=!0}catch(e){console.error("Failed to check project owner status:",e),this.isProjectOwner=!1}}render(){return dc`
      <gr-list-view
        .createNew=${this.isProjectOwner}
        .filter=${this.filter}
        .itemsPerPage=${this.itemsPerPage}
        .items=${this.labels}
        .loading=${this.loading}
        .offset=${this.offset}
        .path=${bw({repo:this.repo,detail:vw.LABELS})}
        @create-clicked=${()=>this.handleCreateClick()}
      >
        <table id="list" class="genericList">
          <tbody>
            <tr class="headerRow">
              <th class="topHeader">Name</th>
              <th class="topHeader">Description</th>
              <th class="topHeader">Function</th>
              <th class="topHeader">Default Value</th>
              <th class="topHeader">Copy Condition</th>
              <th class="topHeader">Allow Post Submit</th>
              <th class="topHeader">Can Override</th>
              <th class="topHeader">Ignore Self Approval</th>
              <th class="topHeader">Branches</th>
              <th class="topHeader">Values</th>
              ${eb(this.isProjectOwner,(()=>dc`<th class="topHeader"></th>`))}
            </tr>
          </tbody>
          <tbody id="labels">
            ${eb(this.loading,(()=>dc`<tr id="loadingContainer">
                <td>Loading...</td>
              </tr>`),(()=>dc` ${(this.labels??[]).map((e=>dc`
                    <tr class="table">
                      <td class="name">${e.name}</td>
                      <td class="description">${e.description}</td>
                      <td class="function">
                        ${e.function}
                        ${eb(this.isFunctionDeprecated(e.function),(()=>dc`
                            <gr-icon
                              icon="warning"
                              title="This function is deprecated."
                            ></gr-icon>
                          `))}
                      </td>
                      <td class="defaultValue">${e.default_value}</td>
                      <td class="copyCondition">${e.copy_condition}</td>
                      <td class="allowPostSubmit">
                        ${this.renderCheckmark(e.allow_post_submit)}
                      </td>
                      <td class="canOverride">
                        ${this.renderCheckmark(e.can_override)}
                      </td>
                      <td class="ignoreSelfApproval">
                        ${this.renderCheckmark(e.ignore_self_approval)}
                        ${eb(e.ignore_self_approval,(()=>dc`
                            <gr-icon
                              icon="warning"
                              title="ignoreSelfApproval is deprecated."
                            ></gr-icon>
                          `))}
                      </td>
                      <td class="branches">
                        ${(e.branches??[]).join(", ")}
                      </td>
                      <td class="values">${JSON.stringify(e.values)}</td>
                      ${eb(this.isProjectOwner,(()=>dc`
                          <td class="actions">
                            <gr-button
                              class="editBtn"
                              link
                              @click=${()=>this.handleEditClick(e)}
                            >
                              Edit
                            </gr-button>
                            <gr-button
                              class="deleteBtn"
                              link
                              @click=${()=>this.handleDeleteClick(e)}
                            >
                              Delete
                            </gr-button>
                          </td>
                        `))}
                    </tr>
                  `))}`))}
          </tbody>
        </table>
      </gr-list-view>

      ${this.renderCreateDialog()} ${this.renderDeleteDialog()}
    `}updated(e){e.has("repo")&&(this.getLabels(),this.checkProjectOwner())}willUpdate(e){e.has("params")&&this.paramsChanged()}async paramsChanged(){const e=this.params;this.loading=!0,this.filter=e?.filter??"",this.offset=Number(e?.offset??0),await this.getLabels(this.filter,this.offset)}getLabels(e,t){const i=this.repo;return this.loading=!0,i?this.restApiService.getRepoLabels(i,(e=>{ia(e)})).then((i=>{i&&(this.labels=i.filter((t=>void 0===e||t.name.toLowerCase().includes(e.toLowerCase()))).slice(t??0,(t??0)+this.itemsPerPage),this.loading=!1)})):Promise.resolve()}isFunctionDeprecated(e){return!!e&&e!==og.NoBlock&&e!==og.Noop&&e!==og.PatchSetLock}renderCheckmark(e){return e?"✓":""}handleCreateClick(){this.isEditing=!1,this.newLabel=this.getEmptyLabel(),ba(this.createDialog,"createDialog"),this.createDialog.showModal()}handleEditClick(e){this.isEditing=!0,this.labelToEdit=e,this.newLabel={name:e.name,description:e.description,function:e.function,default_value:e.default_value,copy_condition:e.copy_condition,allow_post_submit:e.allow_post_submit,can_override:e.can_override,ignore_self_approval:e.ignore_self_approval,values:e.values,branches:e.branches},ba(this.createDialog,"createDialog"),this.createDialog.showModal()}handleCreateCancel(){ba(this.createDialog,"createDialog"),this.createDialog.close(),this.newLabel=this.getEmptyLabel(),this.labelToEdit=void 0,this.isEditing=!1}handleCreateConfirm(){if(!this.repo)return;if(!this.newLabel.name)return;this.isEditing&&this.labelToEdit?.copy_condition&&!this.newLabel.copy_condition&&(this.newLabel.unset_copy_condition=!0);const e=e=>{ia(e)};(this.isEditing&&this.labelToEdit?this.restApiService.updateRepoLabel(this.repo,this.labelToEdit.name,this.newLabel,e):this.restApiService.createRepoLabel(this.repo,this.newLabel.name,this.newLabel,e)).then((()=>{this.createDialog?.close(),this.newLabel=this.getEmptyLabel(),this.labelToEdit=void 0,this.isEditing=!1,this.getLabels(this.filter,this.offset)}))}getEmptyLabel(){return{name:"",description:"",function:og.NoBlock,default_value:0,copy_condition:"",allow_post_submit:!1,can_override:!0,ignore_self_approval:!1,values:{" 0":"No score","-1":"I would prefer this is not submitted as is","-2":"This shall not be submitted","+1":"Looks good to me, but someone else must approve","+2":"Looks good to me, approved"},branches:[]}}async handleSaveForReview(e){if(!this.repo)return;if(!this.newLabel.name)return;const t=e.target;t.loading=!0,this.isEditing&&this.labelToEdit?.copy_condition&&!this.newLabel.copy_condition&&(this.newLabel.unset_copy_condition=!0);const i={};if(this.isEditing&&this.labelToEdit){const e={},t=this.labelToEdit,r=this.newLabel;r.description!==t.description&&(e.description=r.description),r.function!==t.function&&(e.function=r.function),JSON.stringify(r.values)!==JSON.stringify(t.values)&&(e.values=r.values),r.default_value!==t.default_value&&(e.default_value=r.default_value),JSON.stringify(r.branches)!==JSON.stringify(t.branches)&&(e.branches=r.branches),r.can_override!==t.can_override&&(e.can_override=r.can_override),r.copy_condition!==t.copy_condition&&(e.copy_condition=r.copy_condition),r.allow_post_submit!==t.allow_post_submit&&(e.allow_post_submit=r.allow_post_submit),r.ignore_self_approval!==t.ignore_self_approval&&(e.ignore_self_approval=r.ignore_self_approval),r.unset_copy_condition&&(e.unset_copy_condition=r.unset_copy_condition),i.update={[this.newLabel.name]:e}}else i.create=[this.newLabel];const r=this.restApiService.saveRepoLabelsForReview(this.repo,i,(e=>{ia(e)}));try{const e=await r;e&&this.getNavigation().setUrl(WC({change:e}))}finally{t.loading=!1,this.createDialog?.close(),this.newLabel=this.getEmptyLabel(),this.labelToEdit=void 0,this.isEditing=!1,await this.getLabels(this.filter,this.offset)}}renderCreateDialog(){return this.isProjectOwner?dc`
      <dialog id="createDialog" tabindex="-1">
        <gr-dialog .cancelLabel=${""} .confirmLabel=${""}>
          <div class="header" slot="header">
            ${this.isEditing?"Edit":"Create"} Label
          </div>
          <div class="main" slot="main">
            <div class="gr-form-styles">
              <div id="form">
                <section>
                  <div class="title-flex">
                    <span class="title">Name</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-outlined-text-field
                        id="name"
                        class="showBlueFocusBorder"
                        ?required=${!0}
                        ?disabled=${this.isEditing}
                        .value=${this.newLabel.name??""}
                        @input=${e=>{const t=e.target;this.newLabel={...this.newLabel,name:t.value}}}
                      >
                      </md-outlined-text-field>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Description</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-outlined-text-field
                        id="description"
                        class="showBlueFocusBorder"
                        .value=${this.newLabel.description??""}
                        @input=${e=>{const t=e.target;this.newLabel={...this.newLabel,description:t.value}}}
                      >
                      </md-outlined-text-field>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Function</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <gr-dropdown-list
                        .items=${Object.values(og).map((e=>({text:e,value:e})))}
                        .value=${this.newLabel.function??""}
                        @value-change=${e=>{const t=e.detail.value;this.newLabel={...this.newLabel,function:t||void 0}}}
                      ></gr-dropdown-list>
                      ${eb(this.isFunctionDeprecated(this.newLabel.function),(()=>dc`
                          <div class="warning">
                            <gr-icon icon="warning"></gr-icon>
                            This function is deprecated.
                          </div>
                        `))}
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Default Value</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-outlined-text-field
                        id="defaultValue"
                        class="showBlueFocusBorder"
                        type="number"
                        .value=${this.newLabel.default_value?.toString()??""}
                        @input=${e=>{const t=e.target;this.newLabel={...this.newLabel,default_value:Number(t.value)}}}
                      >
                      </md-outlined-text-field>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Copy Condition</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-outlined-text-field
                        id="copyCondition"
                        class="showBlueFocusBorder"
                        .value=${this.newLabel.copy_condition??""}
                        @input=${e=>{const t=e.target;this.newLabel={...this.newLabel,copy_condition:t.value}}}
                      >
                      </md-outlined-text-field>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Can Override</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-checkbox
                        id="canOverride"
                        ?checked=${this.newLabel.can_override??!1}
                        @change=${e=>{this.newLabel={...this.newLabel,can_override:e.target.checked}}}
                      ></md-checkbox>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Allow Post Submit</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-checkbox
                        id="allowPostSubmit"
                        ?checked=${this.newLabel.allow_post_submit??!1}
                        @change=${e=>{this.newLabel={...this.newLabel,allow_post_submit:e.target.checked}}}
                      ></md-checkbox>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Ignore Self Approval</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <md-checkbox
                        id="ignoreSelfApproval"
                        ?checked=${this.newLabel.ignore_self_approval??!1}
                        @change=${e=>{this.newLabel={...this.newLabel,ignore_self_approval:e.target.checked}}}
                      ></md-checkbox>
                      ${eb(this.newLabel.ignore_self_approval,(()=>dc`
                          <div class="warning">
                            <gr-icon icon="warning"></gr-icon>
                            ignoreSelfApproval is deprecated.
                          </div>
                        `))}
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Branches</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <textarea
                        id="branches"
                        rows="2"
                        .value=${(this.newLabel.branches??[]).join("\n")}
                        @change=${e=>{const t=e.target;this.newLabel={...this.newLabel,branches:t.value.split("\n").map((e=>e.trim())).filter(Boolean)}}}
                      ></textarea>
                    </span>
                  </div>
                </section>
                <section>
                  <div class="title-flex">
                    <span class="title">Values</span>
                  </div>
                  <div class="value-flex">
                    <span class="value">
                      <textarea
                        id="values"
                        .value=${JSON.stringify(this.newLabel.values,null,2)}
                        @change=${e=>{const t=e.target;try{this.newLabel={...this.newLabel,values:JSON.parse(t.value)}}catch(e){ta(this,"Invalid JSON")}}}
                      ></textarea>
                    </span>
                  </div>
                </section>
              </div>
            </div>
          </div>
          <div class="footer" slot="footer">
            <gr-button @click=${this.handleCreateCancel} link>Cancel</gr-button>
            <gr-button
              class="action save-button"
              link
              primary
              ?disabled=${!this.newLabel.name||this.disableSaveWithoutReview}
              @click=${this.handleCreateConfirm}
            >
              ${this.isEditing?"Save":"Create"}
            </gr-button>
            <gr-button
              class="action save-for-review"
              primary
              link
              ?hidden=${!this.showSaveForReviewButton}
              ?disabled=${!this.newLabel.name}
              @click=${this.handleSaveForReview}
            >
              Save for review
            </gr-button>
          </div>
        </gr-dialog>
      </dialog>
    `:uc}renderDeleteDialog(){return this.isProjectOwner?dc`
      <dialog id="deleteDialog" tabindex="-1">
        <gr-dialog .cancelLabel=${""} .confirmLabel=${""}>
          <div class="header" slot="header">Delete Label</div>
          <div class="main" slot="main">
            Are you sure you want to delete the label
            "${this.labelToDelete?.name}"?
          </div>
          <div class="footer" slot="footer">
            <gr-button link @click=${this.handleDeleteCancel}>Cancel</gr-button>
            <gr-button
              class="action"
              link
              ?disabled=${this.disableSaveWithoutReview}
              @click=${this.handleDeleteConfirm}
            >
              Delete
            </gr-button>
            <gr-button
              class="action"
              primary
              link
              ?hidden=${!this.showSaveForReviewButton}
              @click=${this.handleDeleteForReviewConfirm}
            >
              Delete for review
            </gr-button>
          </div>
        </gr-dialog>
      </dialog>
    `:uc}handleDeleteClick(e){this.labelToDelete=e,ba(this.deleteDialog,"deleteDialog"),this.deleteDialog.showModal()}handleDeleteCancel(){ba(this.deleteDialog,"deleteDialog"),this.deleteDialog.close(),this.labelToDelete=void 0}async handleDeleteForReviewConfirm(){if(!this.repo||!this.labelToDelete)return;const e={delete:[this.labelToDelete.name]},t=this.restApiService.saveRepoLabelsForReview(this.repo,e,(e=>{ia(e)}));try{const e=await t;e&&this.getNavigation().setUrl(WC({change:e}))}finally{this.deleteDialog?.close(),this.labelToDelete=void 0,await this.getLabels(this.filter,this.offset)}}handleDeleteConfirm(){this.repo&&this.labelToDelete&&this.restApiService.deleteRepoLabel(this.repo,this.labelToDelete.name,{},(e=>{ia(e)})).then((()=>{this.deleteDialog?.close(),this.labelToDelete=void 0,this.getLabels(this.filter,this.offset)}))}};s$([Fc({type:String})],n$.prototype,"repo",void 0),s$([Fc({type:Object})],n$.prototype,"params",void 0),s$([Hc("#createDialog")],n$.prototype,"createDialog",void 0),s$([Hc("#deleteDialog")],n$.prototype,"deleteDialog",void 0),s$([Uc()],n$.prototype,"loading",void 0),s$([Uc()],n$.prototype,"labels",void 0),s$([Uc()],n$.prototype,"showCreateDialog",void 0),s$([Uc()],n$.prototype,"isProjectOwner",void 0),s$([Uc()],n$.prototype,"disableSaveWithoutReview",void 0),s$([Uc()],n$.prototype,"showSaveForReviewButton",void 0),s$([Uc()],n$.prototype,"newLabel",void 0),s$([Uc()],n$.prototype,"offset",void 0),s$([Uc()],n$.prototype,"filter",void 0),s$([Uc()],n$.prototype,"itemsPerPage",void 0),s$([Uc()],n$.prototype,"showDeleteDialog",void 0),s$([Uc()],n$.prototype,"labelToDelete",void 0),s$([Uc()],n$.prototype,"labelToEdit",void 0),s$([Uc()],n$.prototype,"isEditing",void 0),n$=s$([Dc("gr-repo-labels")],n$);var a$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let l$=class extends Ic{constructor(){super(),this.nameChanged=!1,this.repoConfig={create_empty_commit:!0,permissions_only:!1,name:"",branches:[]},this.repoCreated=!1,this.defaultBranch="master",this.restApiService=Xn().restApiService,this.getNavigation=yu(this,gy),this.configModel=yu(this,Qw),this.query=e=>this.getRepoSuggestions(e),this.queryGroups=e=>this.getGroupSuggestions(e),zf(this,(()=>this.configModel().serverConfig$),(e=>{this.defaultBranch=Bx(e?.gerrit?.default_branch??"master")}))}static get styles(){return[Jy,my,Nc,Sd`
        :host {
          display: inline-block;
        }
        div.title-flex,
        div.value-flex {
          display: flex;
          flex-direction: column;
          justify-content: center;
        }
        div.gr-form-styles section {
          margin: var(--spacing-m) 0;
        }
        div.gr-form-styles span.title {
          width: 13em;
        }
        section .title gr-icon {
          vertical-align: top;
        }
        section .value gr-autocomplete {
          display: block;
          width: 20em;
        }
        md-outlined-text-field {
          width: 20em;
        }
      `]}render(){return dc`
      <div class="gr-form-styles">
        <div id="form">
          <section>
            <div class="title-flex">
              <span class="title">Repository Name</span>
            </div>
            <div class="value-flex">
              <span class="value">
                <md-outlined-text-field
                  id="repoNameInput"
                  class="showBlueFocusBorder"
                  autocomplete="on"
                  .value=${Lg(this.repoConfig.name)}
                  @input=${this.handleNameInput}
                >
                </md-outlined-text-field>
              </span>
            </div>
          </section>
          <section>
            <div class="title-flex">
              <span class="title">
                <gr-tooltip-content
                  has-tooltip
                  title="Only serve as a parent repository for other repositories
                  to inheright access rights and configs.
                  If 'true', then you cannot push code to this repo.
                  It will only have a 'refs/meta/config' branch."
                >
                  Parent Repo Only <gr-icon icon="info"></gr-icon>
                </gr-tooltip-content>
              </span>
            </div>
            <div class="value-flex">
              <span class="value">
                <md-checkbox
                  id="parentRepo"
                  ?checked=${this.repoConfig.permissions_only}
                  @change=${this.handlePermissionsOnlyChangeChanged}
                ></md-checkbox>
              </span>
            </div>
          </section>
          <section ?hidden=${!!this.repoConfig.permissions_only}>
            <div class="title-flex">
              <span class="title">Default Branch</span>
            </div>
            <div class="value-flex">
              <span class="value">
                <md-outlined-text-field
                  id="defaultBranchNameInput"
                  class="showBlueFocusBorder"
                  placeholder=${`Optional, defaults to '${this.defaultBranch}'`}
                  .value=${Lg(this.selectedDefaultBranch)}
                  @input=${e=>{const t=e.target;this.selectedDefaultBranch=t.value}}
                >
                </md-outlined-text-field>
              </span>
            </div>
          </section>
          <section>
            <div class="title-flex">
              <span class="title">
                <gr-tooltip-content
                  has-tooltip
                  title="For inheriting access rights and repository configuration"
                >
                  Parent Repository <gr-icon icon="info"></gr-icon>
                </gr-tooltip-content>
              </span>
            </div>
            <div class="value-flex">
              <span class="value">
                <gr-autocomplete
                  id="rightsInheritFromInput"
                  .text=${Lg(this.repoConfig.parent)}
                  .query=${this.query}
                  .placeholder=${"Optional, defaults to 'All-Projects'"}
                  .showBlueFocusBorder=${!0}
                  @text-changed=${this.handleRightsTextChanged}
                >
                </gr-autocomplete>
              </span>
            </div>
          </section>
          <section>
            <div class="title-flex">
              <span class="title">
                <gr-tooltip-content
                  has-tooltip
                  title="When the project is created, the 'Owner' access right is automatically assigned to this group."
                >
                  Owner Group <gr-icon icon="info"></gr-icon>
                </gr-tooltip-content>
              </span>
            </div>
            <div class="value-flex">
              <span class="value">
                <gr-autocomplete
                  id="ownerInput"
                  .text=${Lg(this.repoOwner)}
                  .value=${Lg(this.repoOwnerId)}
                  .query=${this.queryGroups}
                  .placeholder=${"Optional"}
                  .showBlueFocusBorder=${!0}
                  @text-changed=${this.handleOwnerTextChanged}
                  @value-changed=${this.handleOwnerValueChanged}
                >
                </gr-autocomplete>
              </span>
            </div>
          </section>
          <section>
            <div class="title-flex">
              <span class="title">
                <gr-tooltip-content
                  has-tooltip
                  title="Choose 'false', if you want to import an existing repo, 'true' otherwise."
                >
                  Create Empty Commit <gr-icon icon="info"></gr-icon>
                </gr-tooltip-content>
              </span>
            </div>
            <div class="value-flex">
              <span class="value">
                <md-checkbox
                  id="initialCommit"
                  ?checked=${this.repoConfig.create_empty_commit}
                  @change=${this.handleCreateEmptyCommitChangeChanged}
                ></md-checkbox>
              </span>
            </div>
          </section>
        </div>
      </div>
    `}focus(){this.input?.focus()}async handleCreateRepo(){this.selectedDefaultBranch&&(this.repoConfig.branches=[this.selectedDefaultBranch]),this.repoOwnerId&&(this.repoConfig.owners=[this.repoOwnerId]);const e=await this.restApiService.createRepo(this.repoConfig);return 201===e.status&&(this.repoCreated=!0,this.getNavigation().setUrl(bw({repo:this.repoConfig.name}))),e}async getRepoSuggestions(e){const t=await this.restApiService.getSuggestedRepos(e,void 0,Ff),i=[];for(const[e,r]of Object.entries(t??{}))i.push({name:e,value:r.id});return i}async getGroupSuggestions(e){const t=await this.restApiService.getSuggestedGroups(e,void 0,void 0,Ff),i=[];for(const[e,r]of Object.entries(t??{}))i.push({name:e,value:decodeURIComponent(r.id)});return i}handleRightsTextChanged(e){this.repoConfig={...this.repoConfig,parent:e.detail.value}}handleOwnerTextChanged(e){this.repoOwner=e.detail.value}handleOwnerValueChanged(e){this.repoOwnerId=e.detail.value}handleNameInput(e){const t=e.target;this.repoConfig.name=t.value,this.nameChanged=!!t.value,Jn(this,"new-repo-name",{}),this.requestUpdate()}handleCreateEmptyCommitChangeChanged(){this.repoConfig={...this.repoConfig,create_empty_commit:!this.repoConfig.create_empty_commit}}handlePermissionsOnlyChangeChanged(){this.repoConfig={...this.repoConfig,permissions_only:!this.repoConfig.permissions_only}}};a$([Hc("#repoNameInput")],l$.prototype,"input",void 0),a$([Fc({type:Boolean})],l$.prototype,"nameChanged",void 0),a$([Uc()],l$.prototype,"repoConfig",void 0),a$([Uc()],l$.prototype,"selectedDefaultBranch",void 0),a$([Uc()],l$.prototype,"repoCreated",void 0),a$([Uc()],l$.prototype,"repoOwner",void 0),a$([Uc()],l$.prototype,"repoOwnerId",void 0),a$([Uc()],l$.prototype,"defaultBranch",void 0),l$=a$([Dc("gr-create-repo-dialog")],l$);var d$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let c$=class extends Ic{constructor(){super(...arguments),this.query=()=>Promise.resolve([]),this.text="",this.placeholder="",this.disabled=!1,this._handleTriggerClick=e=>{e.stopPropagation(),ba(this.autocomplete),this.autocomplete.focus()}}static get styles(){return Sd`
      :host {
        display: block;
        width: 12em;
      }
      #container {
        background: var(--chip-background-color);
        border-radius: 1em;
        padding: var(--spacing-m);
      }
      #header {
        color: var(--deemphasized-text-color);
        font-weight: var(--font-weight-medium);
        font-size: var(--font-size-small);
      }
      #body {
        display: flex;
      }
      #trigger {
        color: var(--deemphasized-text-color);
        cursor: pointer;
        padding-left: var(--spacing-s);
      }
      #trigger:hover {
        color: var(--primary-text-color);
      }
    `}render(){return dc`
      <div id="container">
        <div id="header">${this.label}</div>
        <div id="body">
          <gr-autocomplete
            id="autocomplete"
            threshold="0"
            .query=${this.query}
            ?disabled=${this.disabled}
            .placeholder=${this.placeholder}
            borderless=""
          ></gr-autocomplete>
          <div id="trigger" @click=${this._handleTriggerClick}>▼</div>
        </div>
      </div>
    `}willUpdate(e){e.has("text")&&Jn(this,"text-changed",{value:this.text})}setText(e){ba(this.autocomplete),this.autocomplete.setText(e)}clear(){this.setText("")}};d$([Hc("#autocomplete")],c$.prototype,"autocomplete",void 0),d$([Fc({type:Object})],c$.prototype,"query",void 0),d$([Fc({type:String})],c$.prototype,"text",void 0),d$([Fc({type:String})],c$.prototype,"label",void 0),d$([Fc({type:String})],c$.prototype,"placeholder",void 0),d$([Fc({type:Boolean})],c$.prototype,"disabled",void 0),c$=d$([Dc("gr-labeled-autocomplete")],c$);var h$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let p$=class extends Ic{constructor(){super(),this.branchDisabled=!1,this.query=()=>Promise.resolve([]),this.repoQuery=()=>Promise.resolve([]),this.restApiService=Xn().restApiService,this.query=e=>this.getRepoBranchesSuggestions(e),this.repoQuery=e=>this.getRepoSuggestions(e)}connectedCallback(){super.connectedCallback(),this.repo&&(ba(this.repoInput,"repoInput"),this.repoInput.setText(this.repo)),this.branchDisabled=!this.repo}static get styles(){return[Nc,Sd`
        :host {
          display: block;
        }
        gr-labeled-autocomplete {
          display: inline-block;
        }
        gr-icon {
          margin-bottom: var(--spacing-l);
        }
      `]}render(){return dc`
      <div>
        <gr-labeled-autocomplete
          id="repoInput"
          label="Repository"
          placeholder="Select repo"
          .query=${this.repoQuery}
          @commit=${e=>{this.repoCommitted(e)}}
        >
        </gr-labeled-autocomplete>
        <gr-icon icon="chevron_right"></gr-icon>
        <gr-labeled-autocomplete
          id="branchInput"
          label="Branch"
          placeholder="Select branch"
          ?disabled=${this.branchDisabled}
          .query=${this.query}
          @commit=${e=>{this.branchCommitted(e)}}
        >
        </gr-labeled-autocomplete>
      </div>
    `}willUpdate(e){e.has("repo")&&this.repoChanged()}getRepoBranchesSuggestions(e){return this.repo?this.restApiService.getRepoBranches(Bx(e),this.repo,15,void 0,Ff).then((e=>this.branchResponseToSuggestions(e))):Promise.resolve([])}branchResponseToSuggestions(e){return e?e.filter((e=>"HEAD"!==e.ref)).map((e=>{const t=Bx(e.ref);return{name:t,value:t}})):[]}getRepoSuggestions(e){return this.restApiService.getRepos(e,15,void 0,Ff).then((e=>this.repoResponseToSuggestions(e)))}repoResponseToSuggestions(e){return e?e.map((e=>({name:e.name,value:Tf(e.id)}))):[]}repoCommitted(e){this.repo=e.detail.value,Jn(this,"repo-changed",{value:e.detail.value})}branchCommitted(e){this.branch=e.detail.value,Jn(this,"branch-changed",{value:e.detail.value})}repoChanged(){ba(this.branchInput,"branchInput"),this.branchInput.clear(),this.branchDisabled=!this.repo}};h$([Hc("#repoInput")],p$.prototype,"repoInput",void 0),h$([Hc("#branchInput")],p$.prototype,"branchInput",void 0),h$([Fc({type:String})],p$.prototype,"repo",void 0),h$([Fc({type:String})],p$.prototype,"branch",void 0),h$([Uc()],p$.prototype,"branchDisabled",void 0),p$=h$([Dc("gr-repo-branch-picker")],p$);var u$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let g$=class extends Ic{constructor(){super(),this.offset=0,this.newRepoName=!1,this.createNewCapability=!1,this.repos=[],this.reposPerPage=25,this.loading=!0,this.filter="",this.loggedIn=!1,this.canCreateChange=!1,this.branch="",this.restApiService=Xn().restApiService,this.getUserModel=yu(this,jf),this.pickerConfirm=()=>{ba(this.createModal,"createModal"),ba(this.createChangeModal,"createChangeModal"),this.createModal.close(),this.createChangeModal.showModal()},zf(this,(()=>this.getUserModel().capabilities$),(e=>this.createNewCapability=e?.createProject??!1)),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.loggedIn=e))}connectedCallback(){super.connectedCallback(),oa("Repos"),this.maybeOpenCreateModal(this.params)}static get styles(){return[pw,Nc,Iw,Sd`
        .genericList tr td:last-of-type {
          text-align: left;
        }
        .genericList tr th:last-of-type {
          text-align: left;
        }
        .readOnly {
          text-align: center;
        }
        .changesLink,
        .name,
        .repositoryBrowser,
        .readOnly {
          white-space: nowrap;
        }
        @media screen and (max-width: 50em) {
          #repoBranchPicker {
            height: 90vh;
          }
        }
      `]}render(){return dc`
      <gr-list-view
        .createNew=${this.createNewCapability}
        .filter=${this.filter}
        .itemsPerPage=${this.reposPerPage}
        .items=${this.repos}
        .loading=${this.loading}
        .offset=${this.offset}
        .path=${Aw({adminView:Cw.REPOS})}
        @create-clicked=${()=>this.handleCreateClicked()}
      >
        <gr-button
          id="createChangeButton"
          slot="createNewContainer"
          ?hidden=${!this.loggedIn}
          primary
          link
          @click=${()=>this.createNewChange()}
        >
          Create Change
        </gr-button>
        <table id="list" class="genericList">
          <tbody>
            <tr class="headerRow">
              <th class="name topHeader">Repository Name</th>
              <th class="repositoryBrowser topHeader">Repository Browser</th>
              <th class="changesLink topHeader">Changes</th>
              <th class="topHeader readOnly">Read only</th>
              <th class="description topHeader">Repository Description</th>
            </tr>
            <tr
              id="loading"
              class="loadingMsg ${this.computeLoadingClass(this.loading)}"
            >
              <td>Loading...</td>
            </tr>
          </tbody>
          <tbody class=${this.computeLoadingClass(this.loading)}>
            ${this.renderRepoList()}
          </tbody>
        </table>
      </gr-list-view>
      <dialog id="createRepoModal" tabindex="-1">
        <gr-dialog
          id="createDialog"
          class="confirmDialog"
          ?disabled=${!this.newRepoName}
          confirm-label="Create"
          @confirm=${()=>this.handleCreateRepo()}
          @cancel=${()=>this.handleCloseCreate()}
        >
          <div class="header" slot="header">Create Repository</div>
          <div class="main" slot="main">
            <gr-create-repo-dialog
              id="createNewModal"
              @new-repo-name=${()=>this.handleNewRepoName()}
            ></gr-create-repo-dialog>
          </div>
        </gr-dialog>
      </dialog>
      <dialog id="createModal" tabindex="-1">
        <gr-dialog
          id="repoBranchPicker"
          confirm-label="Next"
          @confirm=${this.pickerConfirm}
          @cancel=${()=>{ba(this.createModal,"createModal"),this.createModal.close(),this.repo="",this.branch=""}}
          ?disabled=${!(this.repo&&this.branch)}
        >
          <div class="header" slot="header">Create change</div>
          <div class="main" slot="main">
            <gr-repo-branch-picker
              .repo=${this.repo}
              .branch=${this.branch}
              @repo-changed=${e=>{this.repo=e.detail.value}}
              @branch-changed=${e=>{this.branch=e.detail.value}}
            ></gr-repo-branch-picker>
          </div>
        </gr-dialog>
      </dialog>
      <dialog id="createChangeModal" tabindex="-1">
        <gr-dialog
          id="createChangeDialog"
          confirm-label="Create"
          ?disabled=${!this.canCreateChange}
          @confirm=${()=>{this.handleCreateChange()}}
          @cancel=${()=>{this.handleCloseCreateChange()}}
        >
          <div class="header" slot="header">Create Change</div>
          <div class="main" slot="main">
            <gr-create-change-dialog
              id="createNewChangeModal"
              .repoName=${this.repo}
              .branch=${this.branch}
              @can-create-change=${()=>{this.handleCanCreateChange()}}
            ></gr-create-change-dialog>
          </div>
        </gr-dialog>
      </dialog>
    `}renderRepoList(){return this.repos.slice(0,this.reposPerPage).map((e=>this.renderRepo(e)))}renderRepo(e){return dc`
      <tr class="table">
        <td class="name">
          <a href=${bw({repo:e.name})}>${e.name}</a>
        </td>
        <td class="repositoryBrowser">${this.renderWebLinks(e)}</td>
        <td class="changesLink">
          <a href=${tE({repo:e.name})}>view all</a>
        </td>
        <td class="readOnly">
          ${e.state===Gu.READ_ONLY?"Y":""}
        </td>
        <td class="description">${e.description}</td>
      </tr>
    `}renderWebLinks(e){return(e.web_links?e.web_links:[]).map((e=>this.renderWebLink(e)))}renderWebLink(e){return dc`<gr-weblink imageAndText .info=${e}></gr-weblink>`}willUpdate(e){e.has("params")&&this._paramsChanged()}async _paramsChanged(){const e=this.params;return this.loading=!0,this.filter=e?.filter??"",this.offset=Number(e?.offset??0),await this.getRepos()}maybeOpenCreateModal(e){e?.openCreateModal&&this.createModal?.showModal()}async getRepos(){this.repos=[];const e=this.filter,t=await this.restApiService.getRepos(this.filter,this.reposPerPage,this.offset);if(e===this.filter&&t)return this.repos=t,this.loading=!1,t}async refreshReposList(){return this.restApiService.invalidateReposCache(),await this.getRepos()}async handleCreateRepo(){await(this.createNewModal?.handleCreateRepo()),await this.refreshReposList()}handleCloseCreate(){this.createRepoModal?.close()}handleCreateClicked(){this.createRepoModal?.showModal(),this.createNewModal?.focus()}computeLoadingClass(e){return e?"loading":""}handleNewRepoName(){this.createNewModal&&(this.newRepoName=this.createNewModal.nameChanged)}createNewChange(){ba(this.createModal,"createModal"),ba(this.createNewChangeModal,"createNewChangeModal"),this.createModal.showModal()}handleCreateChange(){ba(this.createNewChangeModal,"createNewChangeModal"),this.createNewChangeModal.handleCreateChange(),this.handleCloseCreateChange()}handleCloseCreateChange(){ba(this.createChangeModal,"createChangeModal"),this.createChangeModal.close(),this.repo="",this.branch=""}handleCanCreateChange(){ba(this.createNewChangeModal,"createNewChangeModal"),this.canCreateChange=!!this.createNewChangeModal.branch&&!!this.createNewChangeModal.subject}};function*m$(e,t){if(void 0!==e){let i=0;for(const r of e)yield t(r,i++)}}u$([Hc("#createModal")],g$.prototype,"createModal",void 0),u$([Hc("#createChangeModal")],g$.prototype,"createChangeModal",void 0),u$([Hc("#createNewModal")],g$.prototype,"createNewModal",void 0),u$([Hc("#createRepoModal")],g$.prototype,"createRepoModal",void 0),u$([Hc("#createNewChangeModal")],g$.prototype,"createNewChangeModal",void 0),u$([Fc({type:Object})],g$.prototype,"params",void 0),u$([Uc()],g$.prototype,"offset",void 0),u$([Uc()],g$.prototype,"newRepoName",void 0),u$([Uc()],g$.prototype,"createNewCapability",void 0),u$([Uc()],g$.prototype,"repos",void 0),u$([Uc()],g$.prototype,"reposPerPage",void 0),u$([Uc()],g$.prototype,"loading",void 0),u$([Uc()],g$.prototype,"filter",void 0),u$([Uc()],g$.prototype,"loggedIn",void 0),u$([Uc()],g$.prototype,"canCreateChange",void 0),u$([Uc()],g$.prototype,"repo",void 0),u$([Uc()],g$.prototype,"branch",void 0),g$=u$([Dc("gr-repo-list")],g$);var f$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let v$=class extends Ic{constructor(){super(),this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.serverInfo=e}))}static get styles(){return[pw,Nc,Sd`
        .genericList tr td:last-of-type {
          text-align: left;
        }
        .genericList tr th:last-of-type {
          text-align: left;
        }
        .placeholder {
          color: var(--deemphasized-text-color);
        }
      `]}connectedCallback(){super.connectedCallback(),oa("Server Info")}render(){return dc`
      <main class="gr-form-styles read-only">
        <table id="list" class="genericList">
          <tbody>
            <tr class="headerRow">
              <th class="metadataName topHeader">Name</th>
              <th class="metadataValue topHeader">Value</th>
              <th class="metadataWebLinks topHeader">Links</th>
              <th class="metadataDescription topHeader">Description</th>
            </tr>
          </tbody>
          ${this.renderServerInfoTable()}
        </table>
      </main>
    `}renderServerInfoTable(){return dc`
      <tbody>
        ${m$(this.getServerInfoAsMetadataInfos(),(e=>this.renderServerInfo(e)))}
      </tbody>
    `}renderServerInfo(e){return dc`
      <tr class="table">
        <td class="metadataName">${e.name}</td>
        <td class="metadataValue">
          ${e.value?e.value:dc`<span class="placeholder">--</span>`}
        </td>
        <td class="metadataWebLinks">
          ${e.web_links?m$(e.web_links,(e=>this.renderWebLink(e))):""}
        </td>
        <td class="metadataDescription">
          ${e.description?e.description:""}
        </td>
      </tr>
    `}renderWebLink(e){return dc`<p><gr-weblink imageAndText .info=${e}></gr-weblink></p>`}getServerInfoAsMetadataInfos(){let e=new Array;const t=this.createAccountVisibilityMetadata();return t&&e.push(t),this.serverInfo?.metadata&&(e=e.concat(this.serverInfo.metadata)),e}createAccountVisibilityMetadata(){if(this.serverInfo?.accounts?.visibility){const e={name:"accounts.visibility",value:this.serverInfo.accounts.visibility,description:"Controls visibility of other users' dashboard pages and completion suggestions to web users.",web_links:new Array};if(this.serverInfo?.gerrit?.doc_url){const t={name:"Documentation",url:this.serverInfo.gerrit.doc_url+"config-gerrit.html#accounts.visibility"};e.web_links.push(t)}return e}}};f$([Uc()],v$.prototype,"serverInfo",void 0),v$=f$([Dc("gr-server-info")],v$);const b$=document.createElement("template"),y$=Sd`
  .navStyles ul {
    padding: var(--spacing-l) 0;
  }
  .navStyles li {
    border-bottom: 1px solid transparent;
    border-top: 1px solid transparent;
    display: block;
    padding: 0 var(--spacing-xl);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .navStyles li a {
    display: block;
    /* overflow and text-overflow are not inherited, must repeat them */
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .navStyles .subsectionItem {
    padding-left: var(--spacing-xxl);
  }
  .navStyles .hideSubsection {
    display: none;
  }
  .navStyles li.sectionTitle {
    padding: 0 var(--spacing-xxl) 0 var(--spacing-l);
  }
  .navStyles li.sectionTitle:not(:first-child) {
    margin-top: var(--spacing-l);
  }
  .navStyles .title {
    font-weight: var(--font-weight-medium);
    margin: var(--spacing-s) 0;
  }
  .navStyles .selected {
    background-color: var(--view-background-color);
    border-bottom: 1px solid var(--border-color);
    border-top: 1px solid var(--border-color);
    font-weight: var(--font-weight-medium);
  }
  .navStyles a {
    color: var(--primary-text-color);
    display: inline-block;
    margin: var(--spacing-s) 0;
  }
`;b$.innerHTML=`<dom-module id="gr-page-nav-styles">\n  <template>\n    <style>\n    ${y$.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(b$.content);var w$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const _$=/^[\da-f]{40}$/;let x$=class extends Ic{constructor(){super(),this.canDeleteCapability=!1,this.reloading=!1,this.restApiService=Xn().restApiService,this.getPluginLoader=yu(this,U_),this.getAdminViewModel=yu(this,Rw),this.getGroupViewModel=yu(this,rw),this.getRepoViewModel=yu(this,yw),this.getRouterModel=yu(this,mw),this.getNavigation=yu(this,gy),this.addEventListener("reload",(()=>window.location.reload())),zf(this,(()=>this.getAdminViewModel().state$),(e=>{this.adminViewState=e,this.needsReload()&&this.reload()})),zf(this,(()=>this.getGroupViewModel().state$),(e=>{this.groupViewState=e,this.needsReload()&&this.reload()})),zf(this,(()=>this.getRepoViewModel().state$),(e=>{this.repoViewState=e,this.needsReload()&&this.reload()})),zf(this,(()=>this.getRouterModel().routerView$),(e=>{this.view=e,this.needsReload()&&this.reload()}))}connectedCallback(){super.connectedCallback(),this.reload()}static get styles(){return[Nc,N_,y$,Sd`
        .breadcrumbText {
          /* Same as dropdown trigger so chevron spacing is consistent. */
          padding: 5px 4px;
        }
        gr-icon {
          margin: 0 var(--spacing-xs);
        }
        .breadcrumb {
          align-items: center;
          display: flex;
        }
        .mainHeader {
          align-items: baseline;
          border-bottom: 1px solid var(--border-color);
          display: flex;
        }
        .selectText {
          display: none;
        }
        .selectText.show {
          display: inline-block;
        }
        .main.breadcrumbs:not(.table) {
          margin-top: var(--spacing-l);
        }
      `]}render(){return this.isAdminView()?dc`
      <gr-page-nav class="navStyles">
        <ul class="sectionContent">
          ${this.filteredLinks?.map((e=>this.renderAdminNav(e)))}
        </ul>
      </gr-page-nav>
      ${this.renderSubsectionLinks()} ${this.renderRepoList()}
      ${this.renderGroupList()} ${this.renderPluginList()}
      ${this.renderRepoMain()} ${this.renderGroup()}
      ${this.renderGroupMembers()} ${this.renderGroupAuditLog()}
      ${this.renderRepoDetailList()} ${this.renderRepoCommands()}
      ${this.renderRepoAccess()} ${this.renderRepoDashboards()}
      ${this.renderRepoSubmitRequirements()} ${this.renderRepoLabels()}
      ${this.renderServerInfo()}
    `:uc}renderAdminNav(e){return dc`
      <li class="sectionTitle ${this.computeSelectedClass(e.view)}">
        <a class="title" href=${this.computeLinkURL(e)} rel="noopener"
          >${e.name}</a
        >
      </li>
      ${e.children?.map((e=>this.renderAdminNavChild(e)))}
      ${this.renderAdminNavSubsection(e)}
    `}renderAdminNavChild(e){return dc`
      <li class=${this.computeSelectedClass(e.view)}>
        <a href=${this.computeLinkURL(e)} rel="noopener">${e.name}</a>
      </li>
    `}renderAdminNavSubsection(e){return e.subsection?dc`
      <!--If a section has a subsection, render that.-->
      <li class=${this.computeSelectedClass(e.subsection.view)}>
        ${this.renderAdminNavSubsectionUrl(e.subsection)}
      </li>
      <!--Loop through the links in the sub-section.-->
      ${e.subsection?.children?.map((e=>this.renderAdminNavSubsectionChild(e)))}
    `:uc}renderAdminNavSubsectionUrl(e){return e.url?dc`
      <a class="title" href=${this.computeLinkURL(e)} rel="noopener">
        ${e.name}</a
      >
    `:dc`${e.name}`}renderAdminNavSubsectionChild(e){return dc`
      <li
        class="subsectionItem ${this.computeSelectedClass(e.view,e.detailType)}"
      >
        <a href=${this.computeLinkURL(e)}>${e.name}</a>
      </li>
    `}renderSubsectionLinks(){return this.subsectionLinks?.length?dc`
      <section class="mainHeader">
        <span class="breadcrumb">
          <span class="breadcrumbText">${this.breadcrumbParentName}</span>
          <gr-icon icon="chevron_right"></gr-icon>
        </span>
        <gr-dropdown-list
          id="pageSelect"
          value=${Vw(this.computeSelectValue())}
          .items=${this.subsectionLinks}
          @value-change=${this.handleSubsectionChange}
        >
        </gr-dropdown-list>
      </section>
    `:uc}renderRepoList(){return this.view!==gw.ADMIN||this.adminViewState?.adminView!==Cw.REPOS?uc:dc`
      <div class="main table">
        <gr-repo-list
          class="table"
          .params=${this.adminViewState}
        ></gr-repo-list>
      </div>
    `}renderGroupList(){return this.view!==gw.ADMIN||this.adminViewState?.adminView!==Cw.GROUPS?uc:dc`
      <div class="main table">
        <gr-admin-group-list class="table" .params=${this.adminViewState}>
        </gr-admin-group-list>
      </div>
    `}renderPluginList(){return this.view!==gw.ADMIN||this.adminViewState?.adminView!==Cw.PLUGINS?uc:dc`
      <div class="main table">
        <gr-plugin-list
          class="table"
          .params=${this.adminViewState}
        ></gr-plugin-list>
      </div>
    `}renderRepoMain(){return this.view!==gw.REPO||(this.repoViewState?.detail??vw.GENERAL)!==vw.GENERAL?uc:dc`
      <div class="main breadcrumbs">
        <gr-repo .repo=${this.repoViewState?.repo}></gr-repo>
      </div>
    `}renderGroup(){return this.view!==gw.GROUP||void 0!==this.groupViewState?.detail?uc:dc`
      <div class="main breadcrumbs">
        <gr-group
          .groupId=${this.groupViewState?.groupId}
          .canDelete=${this.canDeleteCapability}
          @name-changed=${e=>{this.updateGroupName(e)}}
        ></gr-group>
      </div>
    `}renderGroupMembers(){return this.view!==gw.GROUP||this.groupViewState?.detail!==tw.MEMBERS?uc:dc`
      <div class="main breadcrumbs">
        <gr-group-members
          .groupId=${this.groupViewState?.groupId}
        ></gr-group-members>
      </div>
    `}renderGroupAuditLog(){return this.view!==gw.GROUP||this.groupViewState?.detail!==tw.LOG?uc:dc`
      <div class="main table breadcrumbs">
        <gr-group-audit-log
          class="table"
          .groupId=${this.groupViewState?.groupId}
        ></gr-group-audit-log>
      </div>
    `}renderRepoDetailList(){if(this.view!==gw.REPO)return uc;const e=this.repoViewState?.detail;return e!==vw.BRANCHES&&e!==vw.TAGS?uc:dc`
      <div class="main table breadcrumbs">
        <gr-repo-detail-list
          class="table"
          .params=${this.repoViewState}
        ></gr-repo-detail-list>
      </div>
    `}renderRepoCommands(){return this.view!==gw.REPO||this.repoViewState?.detail!==vw.COMMANDS?uc:dc`
      <div class="main breadcrumbs">
        <gr-repo-commands
          .repo=${this.repoViewState.repo}
          .createEdit=${this.repoViewState.createEdit}
        ></gr-repo-commands>
      </div>
    `}renderRepoAccess(){return this.view!==gw.REPO||this.repoViewState?.detail!==vw.ACCESS?uc:dc`
      <div class="main breadcrumbs">
        <gr-repo-access .repo=${this.repoViewState.repo}></gr-repo-access>
      </div>
    `}renderRepoDashboards(){return this.view!==gw.REPO||this.repoViewState?.detail!==vw.DASHBOARDS?uc:dc`
      <div class="main table breadcrumbs">
        <gr-repo-dashboards
          .repo=${this.repoViewState.repo}
          .params=${this.repoViewState}
        ></gr-repo-dashboards>
      </div>
    `}renderRepoSubmitRequirements(){return this.view!==gw.REPO||this.repoViewState?.detail!==vw.SUBMIT_REQUIREMENTS?uc:dc`
      <div class="main table breadcrumbs">
        <gr-repo-submit-requirements
          .repo=${this.repoViewState.repo}
          .params=${this.repoViewState}
        ></gr-repo-submit-requirements>
      </div>
    `}renderRepoLabels(){return this.view!==gw.REPO||this.repoViewState?.detail!==vw.LABELS?uc:dc`
      <div class="main table breadcrumbs">
        <gr-repo-labels
          .repo=${this.repoViewState.repo}
          .params=${this.repoViewState}
        ></gr-repo-labels>
      </div>
    `}renderServerInfo(){return this.view!==gw.ADMIN||this.adminViewState?.adminView!==Cw.SERVER_INFO?uc:dc`
      <div class="main table">
        <gr-server-info class="table"></gr-server-info>
      </div>
    `}willUpdate(e){e.has("groupId")&&this.computeGroupName()}async reload(){try{this.reloading=!0,this.subsectionLinks=[];const e=[this.restApiService.getAccount(),this.getPluginLoader().awaitPluginsLoaded()],t=(await Promise.all(e))[0];if(t){const e=await this.restApiService.getAccountCapabilities(["deleteGroup"]);this.canDeleteCapability=!!e?.deleteGroup}let i;if(this.repoName)i={repoName:this.repoName};else if(this.groupId){const e=await this.restApiService.getIsAdmin(),t=await this.restApiService.getIsGroupOwner(this.groupName);i={groupId:this.groupId,groupName:this.groupName,groupIsInternal:this.groupIsInternal,isAdmin:e,groupOwner:t}}const r=await Sw(t,(()=>this.restApiService.getAccountCapabilities().then((e=>{if(!e)throw new Error("getAccountCapabilities returns undefined");return e}))),(()=>this.getPluginLoader().jsApiService.getAdminMenuLinks()),i);if(this.filteredLinks=r.links,this.breadcrumbParentName=r.expandedSection?r.expandedSection.name:"",!r.expandedSection)return;this.subsectionLinks=[r.expandedSection].concat(r.expandedSection.children??[]).map((e=>({text:e.detailType?e.name:"Home",value:e.view+(e.detailType??""),view:e.view,url:e.url,detailType:e.detailType,parent:this.groupId??this.repoName})))}finally{this.reloading=!1}}getDetailView(){return this.view===gw.REPO?this.repoViewState?.detail:this.view===gw.GROUP?this.groupViewState?.detail:void 0}computeSelectValue(){return`${this.view}${this.getDetailView()??""}`}selectedIsCurrentPage(e){return!!this.view&&e.parent===(this.repoName??this.groupId)&&e.view===this.view&&e.detailType===this.getDetailView()}handleSubsectionChange(e){if(!this.subsectionLinks)return;const t=this.subsectionLinks.find((t=>t.value===e.detail.value));this.selectedIsCurrentPage(t)||void 0!==t.url&&(this.reloading||this.getNavigation().setUrl(t.url))}isAdminView(){return this.view===gw.ADMIN||this.view===gw.GROUP||this.view===gw.REPO}needsReload(){if(!this.isAdminView())return!1;let e=!1;const t=this.view===gw.REPO?this.repoViewState?.repo:void 0;t!==this.repoName&&(this.repoName=t,e=!0);const i=this.view===gw.GROUP?this.groupViewState?.groupId:void 0;return i!==this.groupId&&(this.groupId=i,e=!0),!this.breadcrumbParentName||this.view===gw.GROUP&&this.groupViewState?.groupId||this.view===gw.REPO&&this.repoViewState?.repo||(e=!0),e}computeLinkURL(e){return e?.url||""}computeSelectedClass(e,t){return this.view?this.view===gw.GROUP&&e===gw.GROUP?this.groupViewState?.detail||t?this.groupViewState?.detail===t?"selected":"":"selected":this.view===gw.REPO&&e===gw.REPO?this.repoViewState?.detail||t?this.repoViewState?.detail===t?"selected":"":"selected":this.view===gw.ADMIN&&e===this.adminViewState?.adminView?"selected":"":""}async computeGroupName(){if(!this.groupId)return;const e=await this.restApiService.getGroupConfig(this.groupId);e&&e.name&&(this.groupName=e.name,this.groupIsInternal=!!e.id.match(_$),await this.reload())}async updateGroupName(e){this.groupName=e.detail.name,await this.reload()}};w$([Uc()],x$.prototype,"view",void 0),w$([Uc()],x$.prototype,"adminViewState",void 0),w$([Uc()],x$.prototype,"groupViewState",void 0),w$([Uc()],x$.prototype,"repoViewState",void 0),w$([Uc()],x$.prototype,"canDeleteCapability",void 0),w$([Uc()],x$.prototype,"breadcrumbParentName",void 0),w$([Uc()],x$.prototype,"repoName",void 0),w$([Uc()],x$.prototype,"groupId",void 0),w$([Uc()],x$.prototype,"groupIsInternal",void 0),w$([Uc()],x$.prototype,"groupName",void 0),w$([Uc()],x$.prototype,"subsectionLinks",void 0),w$([Uc()],x$.prototype,"filteredLinks",void 0),x$=w$([Dc("gr-admin-view")],x$);const C$=mu("documentation-view-model");class E$ extends df{constructor(){super(void 0)}}var S$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let $$=class extends Ic{constructor(){super(),this.loading=!0,this.filter="",this.restApiService=Xn().restApiService,this.getViewModel=yu(this,C$),zf(this,(()=>this.getViewModel().state$),(e=>{this.filter=e?.filter??"",void 0!==e&&this.getDocumentationSearches()}))}connectedCallback(){super.connectedCallback(),oa("Documentation Search")}static get styles(){return[Nc,pw]}render(){return dc` <gr-list-view
      .filter=${this.filter}
      .offset=${0}
      .loading=${this.loading}
      .path=${`${Sf()}/Documentation`}
    >
      <table id="list" class="genericList">
        <tbody>
          <tr class="headerRow">
            <th class="name topHeader">Name</th>
            <th class="name topHeader"></th>
            <th class="name topHeader"></th>
          </tr>
          <tr id="loading" class="loadingMsg ${this.loading?"loading":""}">
            <td>Loading...</td>
          </tr>
        </tbody>
        <tbody class=${this.loading?"loading":""}>
          ${this.documentationSearches?.map((e=>this.renderDocumentationList(e)))}
        </tbody>
      </table>
    </gr-list-view>`}renderDocumentationList(e){return dc`
      <tr class="table">
        <td class="name">
          <a href=${this.computeSearchUrl(e.url)}>${e.title}</a>
        </td>
        <td></td>
        <td></td>
      </tr>
    `}getDocumentationSearches(){const e=this.filter;return this.loading=!0,this.documentationSearches=[],this.restApiService.getDocumentationSearches(e).then((t=>{e===this.filter&&t&&(this.documentationSearches=t)})).finally((()=>{this.loading=!1}))}computeSearchUrl(e){return e?`${Sf()}/${e}`:""}};S$([Uc()],$$.prototype,"documentationSearches",void 0),S$([Uc()],$$.prototype,"loading",void 0),S$([Uc()],$$.prototype,"filter",void 0),$$=S$([Dc("gr-documentation-search")],$$);var k$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let A$=class extends Ic{constructor(){super(...arguments),this.getShortcutsService=yu(this,Bg)}static get styles(){return[Nc,Sd`
        button {
          background-color: transparent;
          cursor: pointer;
        }
        :host([hidden]) {
          visibility: hidden;
          display: block !important;
        }
      `]}render(){return dc`
      <button
        role="checkbox"
        title=${this.getShortcutsService().createTitle(pu.TOGGLE_CHANGE_STAR,hu.ACTIONS)}
        aria-label=${this.change?.starred?"Unstar this change":"Star this change"}
        @click=${this.handleClick}
      >
        <gr-icon
          icon="star"
          small
          ?filled=${!!this.change?.starred}
          class=${this.change?.starred?"active":""}
        ></gr-icon>
      </button>
    `}handleClick(e){e.stopPropagation(),this.toggleStar()}toggleStar(){ba(this.change,"change");const e=!this.change.starred;this.change.starred=e,this.requestUpdate("change"),Jn(this,"toggle-star",{change:this.change,starred:e})}};k$([Fc({type:Object})],A$.prototype,"change",void 0),A$=k$([Dc("gr-change-star")],A$);var R$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let T$=class extends Ic{constructor(){super(...arguments),this.text="",this.limit=25}static get styles(){return[Sd`
        :host {
          white-space: nowrap;
        }
      `]}render(){return this.tooltip||this.tooLong()?dc` <gr-tooltip-content
        has-tooltip
        .title=${this.renderTooltip()}
      >
        ${this.renderText()}
      </gr-tooltip-content>`:this.renderText()}renderText(){return this.tooLong()?this.text.substr(0,this.limit-1)+"…":this.text}renderTooltip(){return this.tooLong()?`${this.text}${this.tooltip?` (${this.tooltip})`:""}`:this.tooltip?this.tooltip:""}tooLong(){return!!this.limit&&!!this.text&&this.text.length>this.limit}};R$([Fc({type:String})],T$.prototype,"text",void 0),R$([Fc({type:Number})],T$.prototype,"limit",void 0),R$([Fc({type:String})],T$.prototype,"tooltip",void 0),T$=R$([Dc("gr-limited-text")],T$);var I$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let P$=class extends Ic{static get styles(){return[Sd`
        :host {
          display: block;
          overflow: hidden;
        }
        .container {
          align-items: center;
          background-color: var(--background-color-primary);
          /** round */
          border-radius: var(--account-chip-border-radius, 20px);
          border: 1px solid var(--border-color);
          display: inline-flex;
          padding: 0 1px;
          /* Any outermost circular icon would fit neatly in the border-radius
             and won't need padding, but the exact outermost elements will
             depend on account state and the context gr-account-chip is used.
             So, these values are passed down to gr-account-label and any
             outermost elements will use the value and then override it. */
          --account-label-padding-left: 6px;
          --account-label-padding-right: 6px;
          --account-label-circle-padding-left: 0;
          --account-label-circle-padding-right: 0;
        }
        :host:focus {
          border-color: transparent;
          box-shadow: none;
          outline: none;
        }
        :host:focus .container,
        :host:focus gr-button {
          background: #ccc;
        }
        :host([disabled]) {
          opacity: 0.6;
          pointer-events: none;
        }
        gr-icon {
          font-size: 1.2rem;
        }
        gr-icon[icon='close'] {
          margin-top: var(--spacing-xxs);
        }
        .container gr-account-label::part(gr-account-label-text) {
          color: var(--deemphasized-text-color);
        }
        .container.disliked {
          border: 1px solid var(--vote-outline-disliked);
        }
        .container.recommended {
          border: 1px solid var(--vote-outline-recommended);
        }
        .container.disliked,
        .container.recommended {
          --account-label-padding-right: var(--spacing-xs);
          --account-label-circle-padding-right: var(--spacing-xs);
        }
        .container.closeShown {
          --account-label-padding-right: 3px;
          --account-label-circle-padding-right: 3px;
        }
        gr-button.remove::part(md-text-button),
        gr-button.remove:hover::part(md-text-button),
        gr-button.remove:focus::part(md-text-button) {
          border-top-width: 0;
          border-right-width: 0;
          border-bottom-width: 0;
          border-left-width: 0;
          color: var(--deemphasized-text-color);
          font-weight: var(--font-weight-normal);
          height: 0.6em;
          line-height: 10px;
          /* This cancels most of the --account-label-padding-horizontal. */
          margin-left: -4px;
          padding: 0 2px 0 1px;
          text-decoration: none;
        }
      `]}render(){return dc`<div
      class=${th({...this.computeVoteClasses(),container:!0,closeShown:this.removable})}
      ?draggable=${this.draggable}
    >
      <div>
        <gr-account-label
          .account=${this.account}
          .change=${this.change}
          ?forceAttention=${this.forceAttention}
          ?highlightAttention=${this.highlightAttention}
          clickable
        >
        </gr-account-label>
      </div>
      <slot name="vote-chip"></slot>
      <gr-button
        id="remove"
        link=""
        ?hidden=${!this.removable}
        aria-label="Remove"
        class="remove"
        @click=${this.handleRemoveTap}
      >
        <gr-icon icon="close"></gr-icon>
      </gr-button>
    </div>`}constructor(){super(),this.forceAttention=!1,this.disabled=!1,this.removable=!1,this.draggable=!1,this.highlightAttention=!1,this.restApiService=Xn().restApiService,this.getHasAvatars().then((e=>{this.showAvatar=e}))}handleRemoveTap(e){e.preventDefault(),this.account&&Jn(this,"remove-account",{account:this.account})}getHasAvatars(){return this.restApiService.getConfig().then((e=>Promise.resolve(!!(e&&e.plugin&&e.plugin.has_avatars))))}computeVoteClasses(){if(!this.label||!this.account||!uv(this.label,this.account))return{};const e=lv(this.label,this.vote?.value);return[ov.APPROVED,ov.RECOMMENDED].includes(e)?{recommended:!0}:[ov.REJECTED,ov.DISLIKED].includes(e)?{disliked:!0}:{}}};I$([Fc({type:Object})],P$.prototype,"account",void 0),I$([Fc({type:Object})],P$.prototype,"change",void 0),I$([Fc({type:Boolean})],P$.prototype,"forceAttention",void 0),I$([Fc({type:Boolean,reflect:!0})],P$.prototype,"disabled",void 0),I$([Fc({type:Boolean,reflect:!0})],P$.prototype,"removable",void 0),I$([Fc({type:Boolean,reflect:!0})],P$.prototype,"draggable",void 0),I$([Fc({type:Boolean})],P$.prototype,"highlightAttention",void 0),I$([Fc({type:Boolean,reflect:!0})],P$.prototype,"showAvatar",void 0),I$([Fc({type:Object})],P$.prototype,"vote",void 0),I$([Fc({type:Object})],P$.prototype,"label",void 0),P$=I$([Dc("gr-account-chip")],P$);var N$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let O$=class extends Ic{constructor(){super(...arguments),this.label="",this.mutable=!1,this.showAllReviewers=!0,this.deleteButtonDisabled=!1,this.restApiService=Xn().restApiService,this.reporting=Xn().reportingService}static get styles(){return[Nc,Qb,Jc,Sd`
        .hidden {
          display: none;
        }
        /* Note that most of the .voteChip styles are coming from the
         gr-voting-styles include. */
        .voteChip {
          display: flex;
          justify-content: center;
          margin-right: var(--spacing-s);
          padding: 1px;
        }
        gr-tooltip-content {
          display: block;
        }
        gr-button {
          vertical-align: top;
        }
        gr-button::part(md-text-button) {
          height: var(--line-height-normal);
          width: var(--line-height-normal);
          padding: 0;
        }
        gr-button[disabled] gr-icon {
          color: var(--border-color);
        }
        gr-icon {
          font-size: calc(var(--line-height-normal) - 2px);
        }
        .reviewer-row {
          padding-top: var(--spacing-s);
        }
        .reviewer-row:first-of-type {
          padding-top: 0;
        }
        .reviewer-row gr-account-chip,
        .reviewer-row gr-tooltip-content {
          display: inline-block;
          vertical-align: top;
        }
        .reviewer-row .no-votes {
          color: var(--deemphasized-text-color);
          margin-left: var(--spacing-xs);
        }
        gr-vote-chip {
          --gr-vote-chip-width: 14px;
          --gr-vote-chip-height: 14px;
        }
      `]}render(){const e=this.labelInfo;if(e)return dc`<div>
      ${this.computeVoters(e).map((e=>this.renderReviewerVote(e)))}
    </div>`}renderReviewerVote(e){const t=this.labelInfo;if(!t)return;const i=Xu(t)?pv(t,e):void 0,r=!uv(t,e)||Xu(t)&&dv(t,i);return dc`<div class="reviewer-row">
      <gr-account-chip
        .account=${e}
        .change=${this.change}
        .vote=${i}
        .label=${t}
      >
        <gr-vote-chip
          slot="vote-chip"
          .vote=${i}
          .label=${t}
          circle-shape
        ></gr-vote-chip
      ></gr-account-chip>
      ${r?this.renderVoteAbility(e):dc`${this.renderRemoveVote(e,i)}`}
    </div>`}renderVoteAbility(e){if(this.labelInfo&&Xu(this.labelInfo)){const t=pv(this.labelInfo,e);if(t?.permitted_voting_range){const{min:e,max:i}=t.permitted_voting_range;return dc`<span class="no-votes"
          >Can vote ${hv(e)}/${hv(i)}</span
        >`}}return dc`<span class="no-votes">No votes</span>`}renderRemoveVote(e,t){const i=e._account_id,r=this.canDeleteVote(e,this.mutable,this.change,t);if(i&&r)return dc`<gr-tooltip-content has-tooltip title="Remove vote">
      <gr-button
        link
        aria-label="Remove vote"
        @click=${()=>this.onDeleteVote(i)}
        ?disabled=${this.deleteButtonDisabled}
        class="deleteBtn"
      >
        <gr-icon icon="delete" filled></gr-icon>
      </gr-button>
    </gr-tooltip-content>`}computeVoters(e){const t=this.change?.reviewers.REVIEWER??[];return t.concat(this.change?.reviewers.CC??[]).filter((i=>this.showAllReviewers&&Xu(e)&&t.includes(i)?gv(e,i):uv(e,i))).sort(((e,t)=>AC(e,t,this.change?.attention_set,this.change?.labels,this.account)))}canDeleteVote(e,t,i,r){if(!(t&&i&&r&&r.value&&i.removable_labels))return!1;const o=i.removable_labels[this.label]?.[hv(r.value)];return!!o&&o.find((t=>t._account_id===e?._account_id))}async onDeleteVote(e){if(this.change&&e){this.deleteButtonDisabled=!0;try{(await this.restApiService.deleteVote(this.change._number,e,this.label)).ok&&this.change&&aa(this)}catch(e){this.reporting.error("Delete vote",e)}finally{this.deleteButtonDisabled=!1}}}};N$([Fc({type:Object})],O$.prototype,"labelInfo",void 0),N$([Fc({type:String})],O$.prototype,"label",void 0),N$([Fc({type:Object})],O$.prototype,"change",void 0),N$([Fc({type:Object})],O$.prototype,"account",void 0),N$([Fc({type:Boolean})],O$.prototype,"mutable",void 0),N$([Fc({type:Boolean})],O$.prototype,"showAllReviewers",void 0),N$([Uc()],O$.prototype,"deleteButtonDisabled",void 0),O$=N$([Dc("gr-label-info")],O$);const D$=Sd`
  gr-icon.check_circle,
  gr-icon.published_with_changes {
    color: var(--success-foreground);
  }
  gr-icon.block,
  gr-icon.error {
    color: var(--deemphasized-text-color);
  }
  gr-icon.cancel {
    color: var(--error-foreground);
  }
`;var L$;function M$(e,t,i,r,o){for(let s=0;;){let n=e.indexOf(t,s);if(-1===n)break;s=n+t.length;let a=i;0!==n&&"-"===e[n-1]&&(--n,a=!i),o.push({start:n,end:s,isPassing:a,explanation:r})}}!function(e){e.UNKNOWN="UNKNOWN",e.PASSING="PASSING",e.FAILING="FAILING"}(L$||(L$={}));var F$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const U$=ix(Ic);let B$=class extends U${constructor(){super(...arguments),this.mutable=!1,this.expanded=!1,this.restApiService=Xn().restApiService}static get styles(){return[Qb,D$,U$.styles||[],Sd`
        #container {
          min-width: 356px;
          max-width: 356px;
          padding: var(--spacing-xl) 0 var(--spacing-m) 0;
        }
        section.label {
          display: table-row;
        }
        .label-title {
          min-width: 10em;
          padding-top: var(--spacing-s);
        }
        .label-value {
          padding-top: var(--spacing-s);
        }
        .label-title,
        .label-value {
          display: table-cell;
          vertical-align: top;
        }
        .row {
          display: flex;
        }
        .title {
          color: var(--deemphasized-text-color);
          margin-right: var(--spacing-m);
        }
        div.section {
          margin: 0 var(--spacing-xl) var(--spacing-m) var(--spacing-xl);
          display: flex;
          align-items: center;
        }
        div.sectionIcon {
          flex: 0 0 30px;
        }
        div.sectionIcon gr-icon {
          position: relative;
        }
        .section.condition > .sectionContent {
          background-color: var(--gray-background);
          padding: var(--spacing-m);
          flex-grow: 1;
        }
        .button ~ .condition {
          margin-top: var(--spacing-m);
        }
        .expression {
          color: var(--gray-foreground);
        }
        .expression .failing.atom {
          border-bottom: 2px solid var(--error-foreground);
        }
        .expression .passing.atom {
          border-bottom: 2px solid var(--success-foreground);
        }
        .button gr-icon {
          color: inherit;
        }
        div.button {
          border-top: 1px solid var(--border-color);
          margin-top: var(--spacing-m);
          padding: var(--spacing-m) var(--spacing-xl) 0;
        }
        gr-formatted-text {
          overflow-wrap: anywhere;
        }
      `]}render(){if(this.requirement)return dc` <div id="container" role="tooltip" tabindex="-1">
      <div class="section">
        <div class="sectionIcon">${this.renderStatus(this.requirement)}</div>
        <div class="sectionContent">
          <h3 class="name heading-3">
            <span>${this.requirement.name}</span>
          </h3>
        </div>
      </div>
      <div class="section">
        <div class="sectionIcon">
          <gr-icon class="small" icon="info"></gr-icon>
        </div>
        <div class="sectionContent">
          <div class="row">
            <div class="title">Status</div>
            <div>${this.requirement.status}</div>
          </div>
        </div>
      </div>
      ${this.renderLabelSection()}${this.renderDescription()}
      ${this.renderShowHideConditionButton()}${this.renderConditionSection()}
      ${this.renderVotingButtons()}
    </div>`}renderStatus(e){const t=_v(e);return dc`<gr-icon
      class=${t.icon}
      icon=${t.icon}
      ?filled=${!!t.filled}
      role="img"
      aria-label=${e.status.toLowerCase()}
    ></gr-icon>`}renderDescription(){let e=this.requirement?.description;if(this.requirement?.status===tg.ERROR){const t=this.change?.submit_records?.filter((e=>e.rule_name===this.requirement?.name));1===t?.length&&t[0].error_message&&(e=t[0].error_message)}if(e)return dc`<div class="section description">
      <div class="sectionIcon">
        <gr-icon icon="description"></gr-icon>
      </div>
      <div class="sectionContent">
        <gr-formatted-text
          .markdown=${!0}
          .content=${e}
        ></gr-formatted-text>
      </div>
    </div>`}renderLabelSection(){if(!this.requirement)return;const e=wv(this.requirement,{extractFromSubmittability:!0,extractFromOverride:"onlyIfOverridden"}),t=this.change?.labels??{},i=[];for(const r of Object.keys(t))if(e.includes(r)){const e=t[r],o=(this.change?.reviewers.REVIEWER??[]).some((t=>gv(e,t)));(fv(e)||o)&&i.push(r)}if(0===i.length)return;const r=i.length>=2;return dc` <div class="section">
      <div class="sectionIcon"></div>
      <div class="row">
        <div>${i.map((e=>this.renderLabel(e,r)))}</div>
      </div>
    </div>`}renderLabel(e,t){const i=this.change?.labels??{};return dc`
      ${t?dc`<div>${e} votes</div>`:""}
      <gr-label-info
        .change=${this.change}
        .account=${this.account}
        .mutable=${this.mutable}
        .label=${e}
        .labelInfo=${i[e]}
      ></gr-label-info>
    `}renderShowHideConditionButton(){const e=this.expanded?"Hide Conditions":"View Conditions",t=this.expanded?"expand_less":"expand_more";return dc` <div class="button">
      <gr-button
        link=""
        id="toggleConditionsButton"
        @click=${e=>this.toggleConditionsVisibility()}
      >
        ${e}
        <gr-icon .icon=${t}></gr-icon>
      </gr-button>
    </div>`}renderVotingButtons(){if(!this.requirement)return;if(!this.account)return;if(this.change?.status===Nu.MERGED)return;const e=wv(this.requirement,{extractFromSubmittability:!0,extractFromOverride:!1}).map((e=>this.renderLabelVote(e,"submittability"))),t=wv(this.requirement,{extractFromSubmittability:!1,extractFromOverride:"onlyIfOverridden"}).map((e=>this.renderLabelVote(e,"override")));return e.concat(t)}renderLabelVote(e,t){if(!this.account)return;const i=this.change?.permitted_labels?.[e];if(!i||i.length<1)return;const r=Number(i[i.length-1]);if(r<=0)return;const o=pv((this.change?.labels??{})[e],this.account);return o?.value!==r?dc` <div class="button quickApprove">
      <gr-button
        link=""
        @click=${t=>this.quickApprove(e,r)}
      >
        ${this.computeVoteButtonName(e,r,t)}
      </gr-button>
    </div>`:void 0}computeVoteButtonName(e,t,i){return"override"===i?`Override (${e})`:`Vote ${e} +${t}`}quickApprove(e,t){ba(this.change,"change");const i={drafts:_g.PUBLISH_ALL_REVISIONS,labels:{[e]:t}};return this.restApiService.saveChangeReview(this.change._number,this.change.current_revision,i).then((()=>{aa(this)}))}renderConditionSection(){if(this.expanded)return dc`
      ${this.renderCondition("Submit condition",this.requirement?.submittability_expression_result)}
      ${this.renderCondition("Application condition",this.requirement?.applicability_expression_result)}
      ${this.renderCondition("Override condition",this.requirement?.override_expression_result)}
    `}getClassFromAtomStatus(e){switch(e){case L$.PASSING:return"passing atom";case L$.FAILING:return"failing atom";default:return"atom"}}getTitleFromPart(e){let t=this.getTitleFromAtomStatus(e.atomStatus);return e.atomExplanation&&(t+=`: ${e.atomExplanation}`),t}getTitleFromAtomStatus(e){switch(e){case L$.PASSING:return"Atom evaluates to True";case L$.FAILING:return"Atom evaluates to False";default:return"Atom value is unknown"}}renderCondition(e,t){return t?.expression?dc`
      <div class="section condition">
        <div class="sectionContent">
          ${e}:<br />
          <span class="expression">
            ${function(e){const t=[];return e.passing_atoms?.forEach((i=>M$(e.expression,i,!0,e.atom_explanations?.[i]??"",t))),e.failing_atoms?.forEach((i=>M$(e.expression,i,!1,e.atom_explanations?.[i]??"",t))),t.sort(((e,t)=>e.start-t.start)),function(e,t){const i=[];let r=0;for(const{start:o,end:s,isPassing:n,explanation:a}of t)o<r||(o>r&&i.push({value:e.slice(r,o),isAtom:!1}),i.push({value:e.slice(o,s),isAtom:!0,atomStatus:n?L$.PASSING:L$.FAILING,atomExplanation:a}),r=s);return r<e.length&&i.push({value:e.slice(r),isAtom:!1}),i}(e.expression,t)}(t).map((e=>e.isAtom?dc`<span
                    class=${this.getClassFromAtomStatus(e.atomStatus)}
                    title=${this.getTitleFromPart(e)}
                    >${e.value}</span
                  >`:e.value))}
          </span>
        </div>
      </div>
    `:""}toggleConditionsVisibility(){this.expanded=!this.expanded}};var H$,j$;function G$(e,t){const i=function(e,t){return Object.values(t).filter((e=>!1!==e.enabled&&void 0!==e.link)).flatMap((t=>{const i=new RegExp(t.match,"g"),r=[];let o;for(;null!==(o=i.exec(e));){const e=z$(o[0],t),i=V$(o[0],e),s=W$(o[0],e),n=i,a=o[0].length-s,l=e.length-s;r.push({replacedTextStartPosition:o.index+n,replacedTextEndPosition:o.index+a,replacementText:e.substring(n,l)})}return r}))}(e,t);return function(e,t){const i=[...t].sort(((e,t)=>t.replacedTextEndPosition!==e.replacedTextEndPosition?t.replacedTextEndPosition-e.replacedTextEndPosition:e.replacedTextStartPosition-t.replacedTextStartPosition)),r=[];let o=e.length;for(const e of i)e.replacedTextEndPosition<=o&&(r.push(e),o=e.replacedTextStartPosition);return r.reduce(((e,t)=>e.substring(0,t.replacedTextStartPosition).concat(t.replacementText).concat(e.substring(t.replacedTextEndPosition))),e)}(e,i)}function z$(e,t){const i=t.link.startsWith("/")?`${Sf()}${t.link}`:t.link,r=new RegExp(t.match,"g");return e.replace(r,(o=i,s=t.text??"$&",`${t.prefix??""}<a href="${o}" rel="noopener noreferrer" target="_blank">${s}</a>${t.suffix??""}`));var o,s}function V$(e,t){let i=0;for(;i<e.length&&i<t.length;++i)if(e[i]!==t[i])return i;return i}function W$(e,t){let i=e.length;for(let r=t.length;0!==i&&0!==r;--i,--r)if(e[i]!==t[r])return e.length-1-i;return e.length-i}F$([Fc({type:Object})],B$.prototype,"requirement",void 0),F$([Fc({type:Object})],B$.prototype,"change",void 0),F$([Fc({type:Object})],B$.prototype,"account",void 0),F$([Fc({type:Boolean})],B$.prototype,"mutable",void 0),F$([Fc({type:Boolean})],B$.prototype,"expanded",void 0),B$=F$([Dc("gr-submit-requirement-hovercard")],B$),function(e){e[e.INIT=0]="INIT",e[e.REQUEST=1]="REQUEST"}(H$||(H$={})),new RegExp('<span class="([^"]*?)">'),new RegExp("</span>"),function(e){e[e.OPENING=0]="OPENING",e[e.CLOSING=1]="CLOSING"}(j$||(j$={}));var q$=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let K$=class extends Ic{constructor(){super(),this.isSlotAssigned=!1,this.positionBelow=!1,this.hoverCardText="Press c to comment",this.invisible=!0,this.addEventListener("mousedown",(e=>this.handleMouseDown(e)))}render(){return dc`
      <slot
        name="selectionActionBox"
        ?invisible=${this.invisible}
        @slotchange=${this.handleSlotChange}
      >
        <gr-tooltip
          id="tooltip"
          text=${this.hoverCardText}
          ?position-below=${this.positionBelow}
        ></gr-tooltip>
      </slot>
    `}handleSlotChange(){const e=this.slotElement.assignedNodes({flatten:!0});this.isSlotAssigned=e.length>0}createRenderRoot(){return this}async placeAbove(e){if(!this.tooltip)return;await this.tooltip.updateComplete;const t=this.getTargetBoundingRect(e),i=this.tooltip.getBoundingClientRect(),r=this.getParentBoundingClientRect();null!==r&&(this.style.top=t.top-r.top-i.height-6+"px",this.style.left=t.left-r.left+(t.width-i.width)/2+"px",this.invisible=!1,Jn(this,"selection-action-box-visible",{}))}async placeBelow(e){if(!this.tooltip)return;await this.tooltip.updateComplete;const t=this.getTargetBoundingRect(e),i=this.tooltip.getBoundingClientRect(),r=this.getParentBoundingClientRect();null!==r&&(this.style.top=t.top-r.top+i.height-6+"px",this.style.left=t.left-r.left+(t.width-i.width)/2+"px",this.invisible=!1,Jn(this,"selection-action-box-visible",{}))}getParentBoundingClientRect(){return this.parentElement?this.parentElement.getBoundingClientRect():null!==this.parentNode?this.parentNode.host.getBoundingClientRect():null}getTargetBoundingRect(e){let t;if(e instanceof Text){const i=document.createRange();i.selectNode(e),t=i.getBoundingClientRect(),i.detach()}else t=e.getBoundingClientRect();return t}handleMouseDown(e){this.isSlotAssigned||0===e.button&&(e.preventDefault(),e.stopPropagation(),Jn(this,"create-comment-requested",{}))}};q$([Hc("#tooltip")],K$.prototype,"tooltip",void 0),q$([Uc()],K$.prototype,"isSlotAssigned",void 0),q$([Hc("slot")],K$.prototype,"slotElement",void 0),q$([Fc({type:Boolean})],K$.prototype,"positionBelow",void 0),q$([Fc({type:String})],K$.prototype,"hoverCardText",void 0),q$([Uc()],K$.prototype,"invisible",void 0),K$=q$([Dc("gr-selection-action-box")],K$);const Y$=/[\uD800-\uDBFF][\uDC00-\uDFFF]/;function X$(e){return e instanceof Comment?0:J$(e.textContent||"")}function J$(e){return[...e].length}function Q$(e,t,i,r){const o=[].slice.apply(e.childNodes);let s,n;for(const e of o)if(s=X$(e),s<=t)t-=s;else{if(n=Math.min(i,s-t),e instanceof Text?rk(e,t,n,r):e instanceof Element&&Q$(e,t,n,r),!(n<i))break;i-=n,t=0}}function Z$(e,t){let i;return e instanceof Text||"HL"!==e.tagName?(i=document.createElement("HL"),i.className=t,e.parentElement&&e.parentElement.replaceChild(i,e),i.appendChild(e)):(i=e,i.classList.add(t)),i}function ek(e,t,i,r){return X$(e)===t&&r||0===t&&!r||(r?tk(e,t):e=tk(e,t)),Z$(e,i)}function tk(e,t){if(e instanceof Text)return ik(e,t);const i=e.cloneNode(!1);e.parentElement&&e.parentElement.insertBefore(i,e.nextSibling);let r=e.firstChild;for(;r&&(X$(r)<=t||0===X$(r));)t-=X$(r),r=r.nextSibling;for(r&&X$(r)>t&&i.appendChild(tk(r,t));r&&r.nextSibling;)i.appendChild(r.nextSibling);return i}function ik(e,t){if(e.textContent?.match(Y$)){const i=Array.from(e.textContent),r=i.splice(t),o=e.parentNode;e.textContent=i.join("");const s=document.createTextNode(r.join(""));return o&&o.insertBefore(s,e.nextSibling),s}return e.splitText(t)}function rk(e,t,i,r){const o=X$(e);0===t&&o===i?Z$(e,r):0===t?ek(e,i,r,!0):t+i===o?ek(e,t,r,!1):ek(ik(e,t),i,r,!0)}const ok={annotateElement:Q$,annotateWithElement:function(e,t,i,r){const o=r.tagName,s=r.attributes||{};let n;if(e instanceof Element)n=Array.from(e.childNodes);else{if(!(e instanceof Text))return;n=[e],e=e.parentNode}const a=[];for(let e of n){const r=X$(e);if(t>0&&r<=t)t-=r;else if(t>0&&(e=tk(e,t),t=0),X$(e)>i&&tk(e,i),a.push(e),!(i-=X$(e)))break}const l=document.createElement(o),d=_;for(let[e,t]of Object.entries(s))t&&(d&&(t=d(t,e,"attribute",l)),l.setAttribute(e,t));for(const t of a)e.replaceChild(l,t),l.appendChild(t)}},sk=/[\uD800-\uDBFF][\uDC00-\uDFFF]/;function nk(e){const t=ak(e.startContainer),i=e.startOffset+lk(t,e.startContainer),r=ak(e.endContainer);return{startContainer:t,startOffset:i,endContainer:r,endOffset:e.endOffset+lk(r,e.endContainer)}}function ak(e){if(!e.parentElement)return e;let t;for(t=e instanceof Element?e:e.parentElement;t&&!t.classList.contains("contentText");){if(null===t.parentElement)return e;t=t.parentElement}return t||e}function lk(e,t){let i=0,r=[e];for(;r.length;){const e=r.pop();if(e===t)break;if(e?.childNodes&&0!==e.childNodes.length){const t=[];for(const i of e.childNodes)t.push(i);t.reverse(),r=r.concat(t)}else i+=dk(e)}return i}function dk(e){return e&&e.textContent&&e.nodeType!==Node.COMMENT_NODE?e.textContent.replace(sk,"_").length:0}function ck(e,t){return t?.responsive_mode?t.responsive_mode:e?.line_wrapping?"FULL_RESPONSIVE":"NONE"}function hk(e){return"FULL_RESPONSIVE"===e||"SHRINK_ONLY"===e}function pk(e){return e.end_line-e.start_line>10}function uk(e){return vk(mk(e))}function gk(e){return"number"!=typeof e?0:e}function mk(e){for(;e;){if(e instanceof Element){if(e.classList.contains("lineNum"))return e;if(e.classList.contains("section"))return null}e=e.assignedSlot??e.host??e.previousSibling??e.parentNode??void 0}return null}function fk(e){return e.classList.contains($u.RIGHT)?$u.RIGHT:$u.LEFT}function vk(e){if(!e)return null;const t=e.getAttribute("data-value");if(!t)return null;if(t===Au)return Au;if(t===Ru)return Ru;const i=Number(t);return Number.isInteger(i)?i:null}function bk(e){const t=e.getAttribute("diff-side");if(t){if(t!==$u.LEFT&&t!==$u.RIGHT)throw Error(`unexpected value for side: ${t}`);return t}console.warn("comment thread without side")}function yk(e){if(!xk(e))return;const t=bk(e),i=function(e){const t=e.getAttribute("line-num");if(t===Ru)return t;if(!t||t===Au)return Au;const i=Number(t);if(isNaN(i))throw new Error(`cannot parse line number: ${t}`);if(i<1)throw new Error(`line number smaller than 1: ${i}`);return i}(e),r=function(e){const t=e.getAttribute("range");if(!t)return;const i=JSON.parse(t);return i.start_line?i:void 0}(e);return t&&i?{side:t,line:i,range:r,rootId:e.rootId}:void 0}var wk;function _k(e,t){return e.side!==t.side?e.side===$u.RIGHT?1:-1:e.line!==t.line?e.line===Au&&t.line!==Au?-1:e.line!==Au&&t.line===Au?1:e.line===Ru&&t.line!==Ru?-1:e.line!==Ru&&t.line===Ru?1:e.line-t.line:e.rootId!==t.rootId?e.rootId?t.rootId?e.rootId>t.rootId?1:-1:1:-1:e.range&&t.range?JSON.stringify(e.range)>JSON.stringify(t.range)?1:-1:e.range?1:t.range?-1:0}function xk(e){return!!e&&e.nodeType===Node.ELEMENT_NODE&&e.classList.contains("comment-thread")}!function(e){e.YES="YES",e.NO="NO",e.UNDECIDED="UNDECIDED"}(wk||(wk={}));class Ck{constructor(){this.handleCommentThreadMouseenter=e=>{this.toggleRangeElHighlight(e.detail,!0)},this.handleCommentThreadMouseleave=e=>{this.toggleRangeElHighlight(e.detail,!1)},this.handleRangeCommentRequest=e=>{e.stopPropagation(),ba(this.selectedRange,"selectedRange");const{side:t,range:i}=this.selectedRange;this.createRangeComment(t,i)}}init(e,t){this.cleanup(),this.diffTable=e,this.diffBuilder=t,e.addEventListener("comment-thread-mouseleave",this.handleCommentThreadMouseleave),e.addEventListener("comment-thread-mouseenter",this.handleCommentThreadMouseenter),e.addEventListener("create-comment-requested",this.handleRangeCommentRequest)}cleanup(){this.selectionChangeTask?.cancel(),this.diffTable&&(this.diffTable.removeEventListener("comment-thread-mouseleave",this.handleCommentThreadMouseleave),this.diffTable.removeEventListener("comment-thread-mouseenter",this.handleCommentThreadMouseenter),this.diffTable.removeEventListener("create-comment-requested",this.handleRangeCommentRequest))}handleSelectionChange(e,t){null!==e&&(this.selectionChangeTask=ny(this.selectionChangeTask,(()=>this.handleSelection(e,t)),10))}toggleRangeElHighlight(e,t=!1){const i=e?.rootId;if(!i)return;if(!this.diffTable)return;const r=`.${t?"range":"rangeHoverHighlight"}.${Nn(i)}`,o=this.diffTable.querySelectorAll(r);for(const e of o)e.classList.toggle("rangeHoverHighlight",t)}getNormalizedRange(e){if(e instanceof Range)return this.normalizeRange(e);const t=e.rangeCount;if(0===t)return null;if(1===t)return this.normalizeRange(e.getRangeAt(0));{const i=this.normalizeRange(e.getRangeAt(0)),r=this.normalizeRange(e.getRangeAt(t-1));return{start:i.start,end:r.end}}}normalizeRange(e){const t=nk(e);return this.fixTripleClickSelection({start:this.normalizeSelectionSide(t.startContainer,t.startOffset),end:this.normalizeSelectionSide(t.endContainer,t.endOffset)},e)}fixTripleClickSelection(e,t){if(!e.start)return e;const i=e.start,r=e.end,o=!r&&0===t.endOffset&&t.endContainer instanceof HTMLElement&&"TD"===t.endContainer.nodeName&&(t.endContainer.classList.contains("left")||t.endContainer.classList.contains("right")),s=r&&0===i.column&&0===r.column&&r.line===i.line+1,n=t.cloneContents().querySelector(".contentText"),a=n&&this.getLength(n)||0;return a&&(s||o)&&(e.end={node:i.node,column:a,side:i.side,line:i.line}),e}normalizeSelectionSide(e,t){let i;if(!this.diffTable)return null;if(!this.diffBuilder)return null;if(!e||!this.diffTable.contains(e))return null;const r=mk(e);if(!r)return null;const o=fk(r);if(!o)return null;const s=uk(r);if("number"!=typeof s)return null;const n=this.diffBuilder.getContentTdByLineEl(r);if(!n)return null;const a=n.querySelector(".contentText");if(n.contains(e)){const r=n.querySelector(".comment-thread");r?.contains(e)?(i=this.getLength(a),e=a):i=this.convertOffsetToColumn(e,t)}else e=a,i=0;return{node:e,side:o,line:s,column:i}}positionActionBox(e,t,i){if(t>1)return e.positionBelow=!1,void e.placeAbove(i);e.positionBelow=!0,e.placeBelow(i)}isRangeValid(e){if(!(e&&e.start&&e.start.node&&e.end))return!1;const t=e.start,i=e.end;return!(t.side!==i.side||i.line<t.line||t.line===i.line&&t.column===i.column)}handleSelection(e,t){if(!e)return;if(!this.diffTable)return;const i=this.getNormalizedRange(e);if(!this.isRangeValid(i))return void this.removeActionBox();const r=e instanceof Range?e:e.getRangeAt(0),o=i.start,s=i.end;if(o.line===s.line-1&&0===s.column){const e=r.cloneContents().querySelector(".contentText");return void(t&&0===this.getLength(e)&&this.createRangeComment(o.side,{start_line:o.line,start_character:0,end_line:o.line,end_character:o.column}))}const n={start_line:o.line,start_character:o.column,end_line:s.line,end_character:s.column},a=o.side;this.selectedRange={range:n,side:a},this.diffBuilder?.diffModel.fireRangeSelectedEvent(a,n,t);let l=this.diffTable.querySelector("gr-selection-action-box");l||(l=document.createElement("gr-selection-action-box"),this.diffTable.appendChild(l));const d=this.diffBuilder?.diffModel.getState().actionHoverCardText;d&&l.setAttribute("hoverCardText",d),o.line===s.line?this.positionActionBox(l,o.line,r):o.node instanceof Text?(o.column&&this.positionActionBox(l,o.line,o.node.splitText(o.column)),o.node.parentElement.normalize()):o.node instanceof HTMLElement&&o.node.classList.contains("content")&&(o.node.firstChild instanceof Element||o.node.firstChild instanceof Text)?this.positionActionBox(l,o.line,o.node.firstChild):o.node instanceof Element||o.node instanceof Text?this.positionActionBox(l,o.line,o.node):(console.warn("Failed to position comment action box."),this.removeActionBox())}createRangeComment(e,t){ba(this.diffBuilder,"diffBuilder"),this.diffBuilder?.diffModel.createCommentOnRange(t,e),this.removeActionBox()}removeActionBox(){this.selectedRange=void 0;const e=this.diffTable?.querySelector("gr-selection-action-box");e&&(Jn(e,"selection-action-box-removed",{}),e.remove())}convertOffsetToColumn(e,t){if(e instanceof Element&&e.classList.contains("content"))return t;for(;e.previousSibling||!e.parentElement?.classList.contains("content");)e.previousSibling?(e=e.previousSibling,t+=this.getLength(e)):e=e.parentElement;return t}getLength(e){return null===e?0:e instanceof Element&&e.classList.contains("content")?this.getLength(_a(e,".contentText")):X$(e)}}function Ek(e){return e===$u.LEFT?$u.RIGHT:$u.LEFT}function Sk(e,t){let i=[];for(const r of e.content)r.skip?i=i.concat(Array(r.skip).fill("")):r.ab?i=i.concat(r.ab):t===$u.LEFT&&r.a?i=i.concat(r.a):t===$u.RIGHT&&r.b&&(i=i.concat(r.b));return i}function $k(e){return e?e.content.reduce(((e,t)=>t.ab?e+t.ab.length:e+Math.max(t.a?.length??0,t.b?.length??0)),0):0}function kk(e){return!!e?.meta_a?.content_type.startsWith("image/")||!!e?.meta_b?.content_type.startsWith("image/")}const Ak={COMMENT:"selected-comment",LEFT:"selected-left",RIGHT:"selected-right",BLAME:"selected-blame"};function Rk(e){return e===$u.LEFT?Ak.LEFT:Ak.RIGHT}class Tk{constructor(){this.handleDown=e=>{const t=e.target;if(!(t instanceof Element))return;const i=Pn(t,"comment-thread",this.diffTable);if(i&&xk(i))return void this.setClasses([Ak.COMMENT,Rk(bk(i))]);if(In(t,"blame",this.diffTable))return void this.setClasses([Ak.BLAME]);const r=mk(t);r&&this.setClasses([Rk(fk(r))])},this.handleCopy=e=>{const t=e.composedPath()[0];if(!(t instanceof Element))return;if(t instanceof HTMLTextAreaElement)return;if(!In(t,"diff-row",this.diffTable))return;if(!this.diffTable)return;if(this.diffTable.classList.contains(Ak.COMMENT))return;const i=mk(t);if(!i)return;const r=fk(i),o=this.getSelectedText(r);if(o&&e.clipboardData){e.clipboardData.setData("Text",o),e.preventDefault();const t=this.getSelectionInfo(r);t&&Jn(this.diffTable,"copy-info",{side:r,range:t,length:o.length})}}}init(e,t){this.cleanup(),this.diff=e,this.diffTable=t,this.diffTable.classList.add(Ak.RIGHT),this.diffTable.addEventListener("copy",this.handleCopy),this.diffTable.addEventListener("mousedown",this.handleDown)}cleanup(){this.diffTable&&(this.diffTable.removeEventListener("copy",this.handleCopy),this.diffTable.removeEventListener("mousedown",this.handleDown))}setClasses(e){if(this.diffTable){for(const t of Object.values(Ak))e.includes(t)||this.diffTable.classList.remove(t);for(const t of e)this.diffTable.classList.contains(t)||this.diffTable.classList.add(t)}}getSelection(){const e=function(){let e=[document.body];const t=new Set;for(;e.length;){const i=e.pop();if(!i||!i.querySelectorAll)continue;[...i.querySelectorAll("gr-diff")].forEach((e=>t.add(e)));const r=[...i.querySelectorAll("*")].filter(kn).map((e=>e.shadowRoot));e=e.concat(r),kn(i)&&e.push(i.shadowRoot)}return[...t]}();if(!e.length)return document.getSelection();const t=e.find((e=>{if(!e?.shadowRoot?.getSelection)return!1;const t=e.shadowRoot.getSelection();return t&&"None"!==t.type}));return t?.shadowRoot?.getSelection?t.shadowRoot.getSelection():document.getSelection()}getSelectedText(e){if(!this.diff)return"";const t=this.getSelectionInfo(e);return t?function(e,t,i,r,o,s){const n=Sk(e,s).slice(t-1,r);return n.length&&(n[n.length-1]=n[n.length-1].substring(0,o),n[0]=n[0].substring(i)),n.join("\n")}(this.diff,t.start_line,t.start_column,t.end_line,t.end_column,e):""}getSelectionInfo(e){if(!this.diff)return;const t=this.getSelection();if(!t||1!==t.rangeCount)return;const i=nk(t.getRangeAt(0)),r=mk(i.startContainer);if(!r)return;const o=mk(i.endContainer),s=!o&&0===i.endOffset&&"TD"===i.endContainer.nodeName&&i.endContainer instanceof HTMLTableCellElement&&(i.endContainer.classList.contains("left")||i.endContainer.classList.contains("right")),n=r.getAttribute("data-value");if(!n)return;const a=Number(n);let l;if(s)l=a+1;else if(o){const e=o.getAttribute("data-value");e&&(l=Number(e))}return void 0===l&&(l=Sk(this.diff,e).length),{start_line:a,end_line:l,start_column:i.startOffset,end_column:i.endOffset}}}const Ik=document.createElement("template"),Pk=Sd`
  .contentText {
    color: var(--syntax-default-color);
  }
  .gr-syntax-attr {
    color: var(--syntax-attr-color);
  }
  .gr-syntax-attribute {
    color: var(--syntax-attribute-color);
  }
  .gr-syntax-built_in {
    color: var(--syntax-built_in-color);
  }
  .gr-syntax-bullet {
    color: var(--syntax-bullet-color);
  }
  .gr-syntax-code {
    color: var(--syntax-code-color);
  }
  .gr-syntax-comment {
    color: var(--syntax-comment-color);
  }
  .gr-syntax-doctag {
    font-weight: var(--syntax-doctag-weight);
  }
  .gr-syntax-formula {
    color: var(--syntax-formula-color);
  }
  .gr-syntax-function {
    color: var(--syntax-function-color);
  }
  .gr-syntax-link {
    color: var(--syntax-link-color);
  }
  .gr-syntax-literal {
    /* XML/HTML Attribute */
    color: var(--syntax-literal-color);
  }
  .gr-syntax-meta {
    color: var(--syntax-meta-color);
  }
  .gr-syntax-meta-keyword {
    color: var(--syntax-meta-keyword-color);
  }
  .gr-syntax-keyword,
  .gr-syntax-name {
    color: var(--syntax-keyword-color);
  }
  .gr-syntax-number {
    color: var(--syntax-number-color);
  }
  .gr-syntax-params {
    color: var(--syntax-params-color);
  }
  .gr-syntax-property {
    color: var(--syntax-property-color);
  }
  .gr-syntax-quote {
    color: var(--syntax-quote-color);
  }
  .gr-syntax-regexp {
    color: var(--syntax-regexp-color);
  }
  .gr-syntax-section {
    color: var(--syntax-section-color);
  }
  .gr-syntax-selector-attr {
    color: var(--syntax-selector-attr-color);
  }
  .gr-syntax-selector-class {
    color: var(--syntax-selector-class-color);
  }
  .gr-syntax-selector-id {
    color: var(--syntax-selector-id-color);
  }
  .gr-syntax-selector-pseudo {
    color: var(--syntax-selector-pseudo-color);
  }
  .gr-syntax-string {
    color: var(--syntax-string-color);
  }
  .gr-syntax-strong {
    color: var(--syntax-strong-color);
  }
  .gr-syntax-tag {
    color: var(--syntax-tag-color);
  }
  .gr-syntax-template-tag {
    color: var(--syntax-template-tag-color);
  }
  .gr-syntax-template-variable {
    color: var(--syntax-template-variable-color);
  }
  .gr-syntax-title {
    color: var(--syntax-title-color);
  }
  .gr-syntax-title.function_ {
    color: var(--syntax-title-function-color);
  }
  .gr-syntax-type {
    color: var(--syntax-type-color);
  }
  .gr-syntax-variable {
    color: var(--syntax-variable-color);
  }
  .gr-syntax-variable.language_ {
    color: var(--syntax-variable-language-color);
  }
`;Ik.innerHTML=`<dom-module id="gr-syntax-theme">\n  <template>\n    <style>\n    ${Pk.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(Ik.content);const Nk=document.createElement("template"),Ok=Sd`
  gr-diff-text hl.rangeHighlight {
    background-color: var(--diff-highlight-range-color);
  }
  gr-diff-text hl.rangeHoverHighlight {
    background-color: var(--diff-highlight-range-hover-color);
  }
`;Nk.innerHTML=`<dom-module id="gr-ranged-comment-theme">\n  <template>\n    <style>\n    ${Ok.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(Nk.content);var Dk=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let Lk=class extends Ic{static get styles(){return[Sd`
        .row {
          color: var(--gr-range-header-color);
          display: flex;
          font-family: var(--font-family, ''), 'Roboto Mono';
          font-size: var(--font-size-small, 12px);
          font-weight: var(--code-hint-font-weight, 500);
          line-height: var(--line-height-small, 16px);
          justify-content: flex-end;
          padding: var(--spacing-s) var(--spacing-l);
        }
        .icon {
          color: var(--gr-range-header-color);
          font-size: var(--line-height-small, 16px);
          margin-right: var(--spacing-s);
        }
      `]}render(){const e=this.icon??"";return dc` <div class="row">
      <gr-icon
        class="icon"
        icon=${e}
        ?filled=${!!this.filled}
        aria-hidden="true"
      ></gr-icon>
      <slot></slot>
    </div>`}};Dk([Fc({type:String})],Lk.prototype,"icon",void 0),Dk([Fc({type:Boolean})],Lk.prototype,"filled",void 0),Lk=Dk([Dc("gr-range-header")],Lk);var Mk=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let Fk=class extends Ic{static get styles(){return[Ok,Nc,Sd`
        .row {
          display: flex;
          --gr-range-header-color: var(--ranged-comment-hint-text-color);
        }
        gr-range-header {
          flex-grow: 1;
        }
      `]}render(){if(!this.range)return uc;const e=`Long comment range ${this.range.start_line} - ${this.range.end_line}`;return dc`
      <div class="rangeHighlight row">
        <gr-range-header icon="mode_comment" filled>${e}</gr-range-header>
      </div>
    `}};Mk([Fc({type:Object})],Fk.prototype,"range",void 0),Fk=Mk([Dc("gr-ranged-comment-hint")],Fk);const Uk=nn`
<custom-style>
  <style is="custom-style">
    [hidden] {
      display: none !important;
    }
  </style>
</custom-style>
<custom-style>
  <style is="custom-style">
    html {

      --layout: {
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
      };

      --layout-inline: {
        display: -ms-inline-flexbox;
        display: -webkit-inline-flex;
        display: inline-flex;
      };

      --layout-horizontal: {
        @apply --layout;

        -ms-flex-direction: row;
        -webkit-flex-direction: row;
        flex-direction: row;
      };

      --layout-horizontal-reverse: {
        @apply --layout;

        -ms-flex-direction: row-reverse;
        -webkit-flex-direction: row-reverse;
        flex-direction: row-reverse;
      };

      --layout-vertical: {
        @apply --layout;

        -ms-flex-direction: column;
        -webkit-flex-direction: column;
        flex-direction: column;
      };

      --layout-vertical-reverse: {
        @apply --layout;

        -ms-flex-direction: column-reverse;
        -webkit-flex-direction: column-reverse;
        flex-direction: column-reverse;
      };

      --layout-wrap: {
        -ms-flex-wrap: wrap;
        -webkit-flex-wrap: wrap;
        flex-wrap: wrap;
      };

      --layout-wrap-reverse: {
        -ms-flex-wrap: wrap-reverse;
        -webkit-flex-wrap: wrap-reverse;
        flex-wrap: wrap-reverse;
      };

      --layout-flex-auto: {
        -ms-flex: 1 1 auto;
        -webkit-flex: 1 1 auto;
        flex: 1 1 auto;
      };

      --layout-flex-none: {
        -ms-flex: none;
        -webkit-flex: none;
        flex: none;
      };

      --layout-flex: {
        -ms-flex: 1 1 0.000000001px;
        -webkit-flex: 1;
        flex: 1;
        -webkit-flex-basis: 0.000000001px;
        flex-basis: 0.000000001px;
      };

      --layout-flex-2: {
        -ms-flex: 2;
        -webkit-flex: 2;
        flex: 2;
      };

      --layout-flex-3: {
        -ms-flex: 3;
        -webkit-flex: 3;
        flex: 3;
      };

      --layout-flex-4: {
        -ms-flex: 4;
        -webkit-flex: 4;
        flex: 4;
      };

      --layout-flex-5: {
        -ms-flex: 5;
        -webkit-flex: 5;
        flex: 5;
      };

      --layout-flex-6: {
        -ms-flex: 6;
        -webkit-flex: 6;
        flex: 6;
      };

      --layout-flex-7: {
        -ms-flex: 7;
        -webkit-flex: 7;
        flex: 7;
      };

      --layout-flex-8: {
        -ms-flex: 8;
        -webkit-flex: 8;
        flex: 8;
      };

      --layout-flex-9: {
        -ms-flex: 9;
        -webkit-flex: 9;
        flex: 9;
      };

      --layout-flex-10: {
        -ms-flex: 10;
        -webkit-flex: 10;
        flex: 10;
      };

      --layout-flex-11: {
        -ms-flex: 11;
        -webkit-flex: 11;
        flex: 11;
      };

      --layout-flex-12: {
        -ms-flex: 12;
        -webkit-flex: 12;
        flex: 12;
      };

      /* alignment in cross axis */

      --layout-start: {
        -ms-flex-align: start;
        -webkit-align-items: flex-start;
        align-items: flex-start;
      };

      --layout-center: {
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
      };

      --layout-end: {
        -ms-flex-align: end;
        -webkit-align-items: flex-end;
        align-items: flex-end;
      };

      --layout-baseline: {
        -ms-flex-align: baseline;
        -webkit-align-items: baseline;
        align-items: baseline;
      };

      /* alignment in main axis */

      --layout-start-justified: {
        -ms-flex-pack: start;
        -webkit-justify-content: flex-start;
        justify-content: flex-start;
      };

      --layout-center-justified: {
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
      };

      --layout-end-justified: {
        -ms-flex-pack: end;
        -webkit-justify-content: flex-end;
        justify-content: flex-end;
      };

      --layout-around-justified: {
        -ms-flex-pack: distribute;
        -webkit-justify-content: space-around;
        justify-content: space-around;
      };

      --layout-justified: {
        -ms-flex-pack: justify;
        -webkit-justify-content: space-between;
        justify-content: space-between;
      };

      --layout-center-center: {
        @apply --layout-center;
        @apply --layout-center-justified;
      };

      /* self alignment */

      --layout-self-start: {
        -ms-align-self: flex-start;
        -webkit-align-self: flex-start;
        align-self: flex-start;
      };

      --layout-self-center: {
        -ms-align-self: center;
        -webkit-align-self: center;
        align-self: center;
      };

      --layout-self-end: {
        -ms-align-self: flex-end;
        -webkit-align-self: flex-end;
        align-self: flex-end;
      };

      --layout-self-stretch: {
        -ms-align-self: stretch;
        -webkit-align-self: stretch;
        align-self: stretch;
      };

      --layout-self-baseline: {
        -ms-align-self: baseline;
        -webkit-align-self: baseline;
        align-self: baseline;
      };

      /* multi-line alignment in main axis */

      --layout-start-aligned: {
        -ms-flex-line-pack: start;  /* IE10 */
        -ms-align-content: flex-start;
        -webkit-align-content: flex-start;
        align-content: flex-start;
      };

      --layout-end-aligned: {
        -ms-flex-line-pack: end;  /* IE10 */
        -ms-align-content: flex-end;
        -webkit-align-content: flex-end;
        align-content: flex-end;
      };

      --layout-center-aligned: {
        -ms-flex-line-pack: center;  /* IE10 */
        -ms-align-content: center;
        -webkit-align-content: center;
        align-content: center;
      };

      --layout-between-aligned: {
        -ms-flex-line-pack: justify;  /* IE10 */
        -ms-align-content: space-between;
        -webkit-align-content: space-between;
        align-content: space-between;
      };

      --layout-around-aligned: {
        -ms-flex-line-pack: distribute;  /* IE10 */
        -ms-align-content: space-around;
        -webkit-align-content: space-around;
        align-content: space-around;
      };

      /*******************************
                Other Layout
      *******************************/

      --layout-block: {
        display: block;
      };

      --layout-invisible: {
        visibility: hidden !important;
      };

      --layout-relative: {
        position: relative;
      };

      --layout-fit: {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      };

      --layout-scroll: {
        -webkit-overflow-scrolling: touch;
        overflow: auto;
      };

      --layout-fullbleed: {
        margin: 0;
        height: 100vh;
      };

      /* fixed position */

      --layout-fixed-top: {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
      };

      --layout-fixed-right: {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
      };

      --layout-fixed-bottom: {
        position: fixed;
        right: 0;
        bottom: 0;
        left: 0;
      };

      --layout-fixed-left: {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
      };

    }
  </style>
</custom-style>`;Uk.setAttribute("style","display: none;"),document.head.appendChild(Uk.content);var Bk=document.createElement("style");Bk.textContent="[hidden] { display: none !important; }",document.head.appendChild(Bk);const Hk=nn`
<custom-style>
  <style is="custom-style">
    html {

      /* Material Design color palette for Google products */

      --google-red-100: #f4c7c3;
      --google-red-300: #e67c73;
      --google-red-500: #db4437;
      --google-red-700: #c53929;

      --google-blue-100: #c6dafc;
      --google-blue-300: #7baaf7;
      --google-blue-500: #4285f4;
      --google-blue-700: #3367d6;

      --google-green-100: #b7e1cd;
      --google-green-300: #57bb8a;
      --google-green-500: #0f9d58;
      --google-green-700: #0b8043;

      --google-yellow-100: #fce8b2;
      --google-yellow-300: #f7cb4d;
      --google-yellow-500: #f4b400;
      --google-yellow-700: #f09300;

      --google-grey-100: #f5f5f5;
      --google-grey-300: #e0e0e0;
      --google-grey-500: #9e9e9e;
      --google-grey-700: #616161;

      /* Material Design color palette from online spec document */

      --paper-red-50: #ffebee;
      --paper-red-100: #ffcdd2;
      --paper-red-200: #ef9a9a;
      --paper-red-300: #e57373;
      --paper-red-400: #ef5350;
      --paper-red-500: #f44336;
      --paper-red-600: #e53935;
      --paper-red-700: #d32f2f;
      --paper-red-800: #c62828;
      --paper-red-900: #b71c1c;
      --paper-red-a100: #ff8a80;
      --paper-red-a200: #ff5252;
      --paper-red-a400: #ff1744;
      --paper-red-a700: #d50000;

      --paper-pink-50: #fce4ec;
      --paper-pink-100: #f8bbd0;
      --paper-pink-200: #f48fb1;
      --paper-pink-300: #f06292;
      --paper-pink-400: #ec407a;
      --paper-pink-500: #e91e63;
      --paper-pink-600: #d81b60;
      --paper-pink-700: #c2185b;
      --paper-pink-800: #ad1457;
      --paper-pink-900: #880e4f;
      --paper-pink-a100: #ff80ab;
      --paper-pink-a200: #ff4081;
      --paper-pink-a400: #f50057;
      --paper-pink-a700: #c51162;

      --paper-purple-50: #f3e5f5;
      --paper-purple-100: #e1bee7;
      --paper-purple-200: #ce93d8;
      --paper-purple-300: #ba68c8;
      --paper-purple-400: #ab47bc;
      --paper-purple-500: #9c27b0;
      --paper-purple-600: #8e24aa;
      --paper-purple-700: #7b1fa2;
      --paper-purple-800: #6a1b9a;
      --paper-purple-900: #4a148c;
      --paper-purple-a100: #ea80fc;
      --paper-purple-a200: #e040fb;
      --paper-purple-a400: #d500f9;
      --paper-purple-a700: #aa00ff;

      --paper-deep-purple-50: #ede7f6;
      --paper-deep-purple-100: #d1c4e9;
      --paper-deep-purple-200: #b39ddb;
      --paper-deep-purple-300: #9575cd;
      --paper-deep-purple-400: #7e57c2;
      --paper-deep-purple-500: #673ab7;
      --paper-deep-purple-600: #5e35b1;
      --paper-deep-purple-700: #512da8;
      --paper-deep-purple-800: #4527a0;
      --paper-deep-purple-900: #311b92;
      --paper-deep-purple-a100: #b388ff;
      --paper-deep-purple-a200: #7c4dff;
      --paper-deep-purple-a400: #651fff;
      --paper-deep-purple-a700: #6200ea;

      --paper-indigo-50: #e8eaf6;
      --paper-indigo-100: #c5cae9;
      --paper-indigo-200: #9fa8da;
      --paper-indigo-300: #7986cb;
      --paper-indigo-400: #5c6bc0;
      --paper-indigo-500: #3f51b5;
      --paper-indigo-600: #3949ab;
      --paper-indigo-700: #303f9f;
      --paper-indigo-800: #283593;
      --paper-indigo-900: #1a237e;
      --paper-indigo-a100: #8c9eff;
      --paper-indigo-a200: #536dfe;
      --paper-indigo-a400: #3d5afe;
      --paper-indigo-a700: #304ffe;

      --paper-blue-50: #e3f2fd;
      --paper-blue-100: #bbdefb;
      --paper-blue-200: #90caf9;
      --paper-blue-300: #64b5f6;
      --paper-blue-400: #42a5f5;
      --paper-blue-500: #2196f3;
      --paper-blue-600: #1e88e5;
      --paper-blue-700: #1976d2;
      --paper-blue-800: #1565c0;
      --paper-blue-900: #0d47a1;
      --paper-blue-a100: #82b1ff;
      --paper-blue-a200: #448aff;
      --paper-blue-a400: #2979ff;
      --paper-blue-a700: #2962ff;

      --paper-light-blue-50: #e1f5fe;
      --paper-light-blue-100: #b3e5fc;
      --paper-light-blue-200: #81d4fa;
      --paper-light-blue-300: #4fc3f7;
      --paper-light-blue-400: #29b6f6;
      --paper-light-blue-500: #03a9f4;
      --paper-light-blue-600: #039be5;
      --paper-light-blue-700: #0288d1;
      --paper-light-blue-800: #0277bd;
      --paper-light-blue-900: #01579b;
      --paper-light-blue-a100: #80d8ff;
      --paper-light-blue-a200: #40c4ff;
      --paper-light-blue-a400: #00b0ff;
      --paper-light-blue-a700: #0091ea;

      --paper-cyan-50: #e0f7fa;
      --paper-cyan-100: #b2ebf2;
      --paper-cyan-200: #80deea;
      --paper-cyan-300: #4dd0e1;
      --paper-cyan-400: #26c6da;
      --paper-cyan-500: #00bcd4;
      --paper-cyan-600: #00acc1;
      --paper-cyan-700: #0097a7;
      --paper-cyan-800: #00838f;
      --paper-cyan-900: #006064;
      --paper-cyan-a100: #84ffff;
      --paper-cyan-a200: #18ffff;
      --paper-cyan-a400: #00e5ff;
      --paper-cyan-a700: #00b8d4;

      --paper-teal-50: #e0f2f1;
      --paper-teal-100: #b2dfdb;
      --paper-teal-200: #80cbc4;
      --paper-teal-300: #4db6ac;
      --paper-teal-400: #26a69a;
      --paper-teal-500: #009688;
      --paper-teal-600: #00897b;
      --paper-teal-700: #00796b;
      --paper-teal-800: #00695c;
      --paper-teal-900: #004d40;
      --paper-teal-a100: #a7ffeb;
      --paper-teal-a200: #64ffda;
      --paper-teal-a400: #1de9b6;
      --paper-teal-a700: #00bfa5;

      --paper-green-50: #e8f5e9;
      --paper-green-100: #c8e6c9;
      --paper-green-200: #a5d6a7;
      --paper-green-300: #81c784;
      --paper-green-400: #66bb6a;
      --paper-green-500: #4caf50;
      --paper-green-600: #43a047;
      --paper-green-700: #388e3c;
      --paper-green-800: #2e7d32;
      --paper-green-900: #1b5e20;
      --paper-green-a100: #b9f6ca;
      --paper-green-a200: #69f0ae;
      --paper-green-a400: #00e676;
      --paper-green-a700: #00c853;

      --paper-light-green-50: #f1f8e9;
      --paper-light-green-100: #dcedc8;
      --paper-light-green-200: #c5e1a5;
      --paper-light-green-300: #aed581;
      --paper-light-green-400: #9ccc65;
      --paper-light-green-500: #8bc34a;
      --paper-light-green-600: #7cb342;
      --paper-light-green-700: #689f38;
      --paper-light-green-800: #558b2f;
      --paper-light-green-900: #33691e;
      --paper-light-green-a100: #ccff90;
      --paper-light-green-a200: #b2ff59;
      --paper-light-green-a400: #76ff03;
      --paper-light-green-a700: #64dd17;

      --paper-lime-50: #f9fbe7;
      --paper-lime-100: #f0f4c3;
      --paper-lime-200: #e6ee9c;
      --paper-lime-300: #dce775;
      --paper-lime-400: #d4e157;
      --paper-lime-500: #cddc39;
      --paper-lime-600: #c0ca33;
      --paper-lime-700: #afb42b;
      --paper-lime-800: #9e9d24;
      --paper-lime-900: #827717;
      --paper-lime-a100: #f4ff81;
      --paper-lime-a200: #eeff41;
      --paper-lime-a400: #c6ff00;
      --paper-lime-a700: #aeea00;

      --paper-yellow-50: #fffde7;
      --paper-yellow-100: #fff9c4;
      --paper-yellow-200: #fff59d;
      --paper-yellow-300: #fff176;
      --paper-yellow-400: #ffee58;
      --paper-yellow-500: #ffeb3b;
      --paper-yellow-600: #fdd835;
      --paper-yellow-700: #fbc02d;
      --paper-yellow-800: #f9a825;
      --paper-yellow-900: #f57f17;
      --paper-yellow-a100: #ffff8d;
      --paper-yellow-a200: #ffff00;
      --paper-yellow-a400: #ffea00;
      --paper-yellow-a700: #ffd600;

      --paper-amber-50: #fff8e1;
      --paper-amber-100: #ffecb3;
      --paper-amber-200: #ffe082;
      --paper-amber-300: #ffd54f;
      --paper-amber-400: #ffca28;
      --paper-amber-500: #ffc107;
      --paper-amber-600: #ffb300;
      --paper-amber-700: #ffa000;
      --paper-amber-800: #ff8f00;
      --paper-amber-900: #ff6f00;
      --paper-amber-a100: #ffe57f;
      --paper-amber-a200: #ffd740;
      --paper-amber-a400: #ffc400;
      --paper-amber-a700: #ffab00;

      --paper-orange-50: #fff3e0;
      --paper-orange-100: #ffe0b2;
      --paper-orange-200: #ffcc80;
      --paper-orange-300: #ffb74d;
      --paper-orange-400: #ffa726;
      --paper-orange-500: #ff9800;
      --paper-orange-600: #fb8c00;
      --paper-orange-700: #f57c00;
      --paper-orange-800: #ef6c00;
      --paper-orange-900: #e65100;
      --paper-orange-a100: #ffd180;
      --paper-orange-a200: #ffab40;
      --paper-orange-a400: #ff9100;
      --paper-orange-a700: #ff6500;

      --paper-deep-orange-50: #fbe9e7;
      --paper-deep-orange-100: #ffccbc;
      --paper-deep-orange-200: #ffab91;
      --paper-deep-orange-300: #ff8a65;
      --paper-deep-orange-400: #ff7043;
      --paper-deep-orange-500: #ff5722;
      --paper-deep-orange-600: #f4511e;
      --paper-deep-orange-700: #e64a19;
      --paper-deep-orange-800: #d84315;
      --paper-deep-orange-900: #bf360c;
      --paper-deep-orange-a100: #ff9e80;
      --paper-deep-orange-a200: #ff6e40;
      --paper-deep-orange-a400: #ff3d00;
      --paper-deep-orange-a700: #dd2c00;

      --paper-brown-50: #efebe9;
      --paper-brown-100: #d7ccc8;
      --paper-brown-200: #bcaaa4;
      --paper-brown-300: #a1887f;
      --paper-brown-400: #8d6e63;
      --paper-brown-500: #795548;
      --paper-brown-600: #6d4c41;
      --paper-brown-700: #5d4037;
      --paper-brown-800: #4e342e;
      --paper-brown-900: #3e2723;

      --paper-grey-50: #fafafa;
      --paper-grey-100: #f5f5f5;
      --paper-grey-200: #eeeeee;
      --paper-grey-300: #e0e0e0;
      --paper-grey-400: #bdbdbd;
      --paper-grey-500: #9e9e9e;
      --paper-grey-600: #757575;
      --paper-grey-700: #616161;
      --paper-grey-800: #424242;
      --paper-grey-900: #212121;

      --paper-blue-grey-50: #eceff1;
      --paper-blue-grey-100: #cfd8dc;
      --paper-blue-grey-200: #b0bec5;
      --paper-blue-grey-300: #90a4ae;
      --paper-blue-grey-400: #78909c;
      --paper-blue-grey-500: #607d8b;
      --paper-blue-grey-600: #546e7a;
      --paper-blue-grey-700: #455a64;
      --paper-blue-grey-800: #37474f;
      --paper-blue-grey-900: #263238;

      /* opacity for dark text on a light background */
      --dark-divider-opacity: 0.12;
      --dark-disabled-opacity: 0.38; /* or hint text or icon */
      --dark-secondary-opacity: 0.54;
      --dark-primary-opacity: 0.87;

      /* opacity for light text on a dark background */
      --light-divider-opacity: 0.12;
      --light-disabled-opacity: 0.3; /* or hint text or icon */
      --light-secondary-opacity: 0.7;
      --light-primary-opacity: 1.0;

    }

  </style>
</custom-style>
`;Hk.setAttribute("style","display: none;"),document.head.appendChild(Hk.content);const jk=nn`
<custom-style>
  <style is="custom-style">
    html {
      /*
       * You can use these generic variables in your elements for easy theming.
       * For example, if all your elements use \`--primary-text-color\` as its main
       * color, then switching from a light to a dark theme is just a matter of
       * changing the value of \`--primary-text-color\` in your application.
       */
      --primary-text-color: var(--light-theme-text-color);
      --primary-background-color: var(--light-theme-background-color);
      --secondary-text-color: var(--light-theme-secondary-color);
      --disabled-text-color: var(--light-theme-disabled-color);
      --divider-color: var(--light-theme-divider-color);
      --error-color: var(--paper-deep-orange-a700);

      /*
       * Primary and accent colors. Also see color.js for more colors.
       */
      --primary-color: var(--paper-indigo-500);
      --light-primary-color: var(--paper-indigo-100);
      --dark-primary-color: var(--paper-indigo-700);

      --accent-color: var(--paper-pink-a200);
      --light-accent-color: var(--paper-pink-a100);
      --dark-accent-color: var(--paper-pink-a400);


      /*
       * Material Design Light background theme
       */
      --light-theme-background-color: #ffffff;
      --light-theme-base-color: #000000;
      --light-theme-text-color: var(--paper-grey-900);
      --light-theme-secondary-color: #737373;  /* for secondary text and icons */
      --light-theme-disabled-color: #9b9b9b;  /* disabled/hint text */
      --light-theme-divider-color: #dbdbdb;

      /*
       * Material Design Dark background theme
       */
      --dark-theme-background-color: var(--paper-grey-900);
      --dark-theme-base-color: #ffffff;
      --dark-theme-text-color: #ffffff;
      --dark-theme-secondary-color: #bcbcbc;  /* for secondary text and icons */
      --dark-theme-disabled-color: #646464;  /* disabled/hint text */
      --dark-theme-divider-color: #3c3c3c;

      /*
       * Deprecated values because of their confusing names.
       */
      --text-primary-color: var(--dark-theme-text-color);
      --default-primary-color: var(--primary-color);
    }
  </style>
</custom-style>`;if(jk.setAttribute("style","display: none;"),document.head.appendChild(jk.content),!window.polymerSkipLoadingFontRoboto){const e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.crossOrigin="anonymous",e.href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,300,300italic,400italic,500,500italic,700,700italic",document.head.appendChild(e)}const Gk=nn`<custom-style>
  <style is="custom-style">
    html {

      /* Shared Styles */
      --paper-font-common-base: {
        font-family: 'Roboto', 'Noto', sans-serif;
        -webkit-font-smoothing: antialiased;
      };

      --paper-font-common-code: {
        font-family: 'Roboto Mono', 'Consolas', 'Menlo', monospace;
        -webkit-font-smoothing: antialiased;
      };

      --paper-font-common-expensive-kerning: {
        text-rendering: optimizeLegibility;
      };

      --paper-font-common-nowrap: {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      };

      /* Material Font Styles */

      --paper-font-display4: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 112px;
        font-weight: 300;
        letter-spacing: -.044em;
        line-height: 120px;
      };

      --paper-font-display3: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 56px;
        font-weight: 400;
        letter-spacing: -.026em;
        line-height: 60px;
      };

      --paper-font-display2: {
        @apply --paper-font-common-base;

        font-size: 45px;
        font-weight: 400;
        letter-spacing: -.018em;
        line-height: 48px;
      };

      --paper-font-display1: {
        @apply --paper-font-common-base;

        font-size: 34px;
        font-weight: 400;
        letter-spacing: -.01em;
        line-height: 40px;
      };

      --paper-font-headline: {
        @apply --paper-font-common-base;

        font-size: 24px;
        font-weight: 400;
        letter-spacing: -.012em;
        line-height: 32px;
      };

      --paper-font-title: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 20px;
        font-weight: 500;
        line-height: 28px;
      };

      --paper-font-subhead: {
        @apply --paper-font-common-base;

        font-size: 16px;
        font-weight: 400;
        line-height: 24px;
      };

      --paper-font-body2: {
        @apply --paper-font-common-base;

        font-size: 14px;
        font-weight: 500;
        line-height: 24px;
      };

      --paper-font-body1: {
        @apply --paper-font-common-base;

        font-size: 14px;
        font-weight: 400;
        line-height: 20px;
      };

      --paper-font-caption: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 12px;
        font-weight: 400;
        letter-spacing: 0.011em;
        line-height: 20px;
      };

      --paper-font-menu: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 13px;
        font-weight: 500;
        line-height: 24px;
      };

      --paper-font-button: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 14px;
        font-weight: 500;
        letter-spacing: 0.018em;
        line-height: 24px;
        text-transform: uppercase;
      };

      --paper-font-code2: {
        @apply --paper-font-common-code;

        font-size: 14px;
        font-weight: 700;
        line-height: 20px;
      };

      --paper-font-code1: {
        @apply --paper-font-common-code;

        font-size: 14px;
        font-weight: 500;
        line-height: 20px;
      };

    }

  </style>
</custom-style>`;Gk.setAttribute("style","display: none;"),document.head.appendChild(Gk.content);const zk=document.createElement("template");zk.setAttribute("style","display: none;"),zk.innerHTML="<dom-module id=\"paper-item-shared-styles\">\n  <template>\n    <style>\n      :host, .paper-item {\n        display: block;\n        position: relative;\n        min-height: var(--paper-item-min-height, 48px);\n        padding: 0px 16px;\n      }\n\n      .paper-item {\n        @apply --paper-font-subhead;\n        border:none;\n        outline: none;\n        background: white;\n        width: 100%;\n        text-align: left;\n      }\n\n      :host([hidden]), .paper-item[hidden] {\n        display: none !important;\n      }\n\n      :host(.iron-selected), .paper-item.iron-selected {\n        font-weight: var(--paper-item-selected-weight, bold);\n\n        @apply --paper-item-selected;\n      }\n\n      :host([disabled]), .paper-item[disabled] {\n        color: var(--paper-item-disabled-color, var(--disabled-text-color));\n\n        @apply --paper-item-disabled;\n      }\n\n      :host(:focus), .paper-item:focus {\n        position: relative;\n        outline: 0;\n\n        @apply --paper-item-focused;\n      }\n\n      :host(:focus):before, .paper-item:focus:before {\n        @apply --layout-fit;\n\n        background: currentColor;\n        content: '';\n        opacity: var(--dark-divider-opacity);\n        pointer-events: none;\n\n        @apply --paper-item-focused-before;\n      }\n    </style>\n  </template>\n</dom-module>",document.head.appendChild(zk.content);const Vk={properties:{focused:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},disabled:{type:Boolean,value:!1,notify:!0,observer:"_disabledChanged",reflectToAttribute:!0},_oldTabIndex:{type:String},_boundFocusBlurHandler:{type:Function,value:function(){return this._focusBlurHandler.bind(this)}}},observers:["_changedControlState(focused, disabled)"],ready:function(){this.addEventListener("focus",this._boundFocusBlurHandler,!0),this.addEventListener("blur",this._boundFocusBlurHandler,!0)},_focusBlurHandler:function(e){this._setFocused("focus"===e.type)},_disabledChanged:function(e,t){this.setAttribute("aria-disabled",e?"true":"false"),this.style.pointerEvents=e?"none":"",e?(this._oldTabIndex=this.getAttribute("tabindex"),this._setFocused(!1),this.tabIndex=-1,this.blur()):void 0!==this._oldTabIndex&&(null===this._oldTabIndex?this.removeAttribute("tabindex"):this.setAttribute("tabindex",this._oldTabIndex))},_changedControlState:function(){this._controlStateChanged&&this._controlStateChanged()}};var Wk={"U+0008":"backspace","U+0009":"tab","U+001B":"esc","U+0020":"space","U+007F":"del"},qk={8:"backspace",9:"tab",13:"enter",27:"esc",33:"pageup",34:"pagedown",35:"end",36:"home",32:"space",37:"left",38:"up",39:"right",40:"down",46:"del",106:"*"},Kk={shift:"shiftKey",ctrl:"ctrlKey",alt:"altKey",meta:"metaKey"},Yk=/[a-z0-9*]/,Xk=/U\+/,Jk=/^arrow/,Qk=/^space(bar)?/,Zk=/^escape$/;function eA(e,t){var i="";if(e){var r=e.toLowerCase();" "===r||Qk.test(r)?i="space":Zk.test(r)?i="esc":1==r.length?t&&!Yk.test(r)||(i=r):i=Jk.test(r)?r.replace("arrow",""):"multiply"==r?"*":r}return i}function tA(e,t){return i=t,r=e.hasModifiers,(i.key?eA(i.key,r):i.detail&&i.detail.key?eA(i.detail.key,r):(s="",(o=i.keyIdentifier)&&(o in Wk?s=Wk[o]:Xk.test(o)?(o=parseInt(o.replace("U+","0x"),16),s=String.fromCharCode(o).toLowerCase()):s=o.toLowerCase()),s||function(e){var t="";return Number(e)&&(t=e>=65&&e<=90?String.fromCharCode(32+e):e>=112&&e<=123?"f"+(e-112+1):e>=48&&e<=57?String(e-48):e>=96&&e<=105?String(e-96):qk[e]),t}(i.keyCode)||""))===e.key&&(!e.hasModifiers||!!t.shiftKey==!!e.shiftKey&&!!t.ctrlKey==!!e.ctrlKey&&!!t.altKey==!!e.altKey&&!!t.metaKey==!!e.metaKey);var i,r,o,s}function iA(e){return e.trim().split(" ").map((function(e){return function(e){return 1===e.length?{combo:e,key:e,event:"keydown"}:e.split("+").reduce((function(e,t){var i=t.split(":"),r=i[0],o=i[1];return r in Kk?(e[Kk[r]]=!0,e.hasModifiers=!0):(e.key=r,e.event=o||"keydown"),e}),{combo:e.split(":").shift()})}(e)}))}const rA={properties:{keyEventTarget:{type:Object,value:function(){return this}},stopKeyboardEventPropagation:{type:Boolean,value:!1},_boundKeyHandlers:{type:Array,value:function(){return[]}},_imperativeKeyBindings:{type:Object,value:function(){return{}}}},observers:["_resetKeyEventListeners(keyEventTarget, _boundKeyHandlers)"],keyBindings:{},registered:function(){this._prepKeyBindings()},attached:function(){this._listenKeyEventListeners()},detached:function(){this._unlistenKeyEventListeners()},addOwnKeyBinding:function(e,t){this._imperativeKeyBindings[e]=t,this._prepKeyBindings(),this._resetKeyEventListeners()},removeOwnKeyBindings:function(){this._imperativeKeyBindings={},this._prepKeyBindings(),this._resetKeyEventListeners()},keyboardEventMatchesKeys:function(e,t){for(var i=iA(t),r=0;r<i.length;++r)if(tA(i[r],e))return!0;return!1},_collectKeyBindings:function(){var e=this.behaviors.map((function(e){return e.keyBindings}));return-1===e.indexOf(this.keyBindings)&&e.push(this.keyBindings),e},_prepKeyBindings:function(){for(var e in this._keyBindings={},this._collectKeyBindings().forEach((function(e){for(var t in e)this._addKeyBinding(t,e[t])}),this),this._imperativeKeyBindings)this._addKeyBinding(e,this._imperativeKeyBindings[e]);for(var t in this._keyBindings)this._keyBindings[t].sort((function(e,t){var i=e[0].hasModifiers;return i===t[0].hasModifiers?0:i?-1:1}))},_addKeyBinding:function(e,t){iA(e).forEach((function(e){this._keyBindings[e.event]=this._keyBindings[e.event]||[],this._keyBindings[e.event].push([e,t])}),this)},_resetKeyEventListeners:function(){this._unlistenKeyEventListeners(),this.isAttached&&this._listenKeyEventListeners()},_listenKeyEventListeners:function(){this.keyEventTarget&&Object.keys(this._keyBindings).forEach((function(e){var t=this._keyBindings[e],i=this._onKeyBindingEvent.bind(this,t);this._boundKeyHandlers.push([this.keyEventTarget,e,i]),this.keyEventTarget.addEventListener(e,i)}),this)},_unlistenKeyEventListeners:function(){for(var e,t,i,r;this._boundKeyHandlers.length;)t=(e=this._boundKeyHandlers.pop())[0],i=e[1],r=e[2],t.removeEventListener(i,r)},_onKeyBindingEvent:function(e,t){if(this.stopKeyboardEventPropagation&&t.stopPropagation(),!t.defaultPrevented)for(var i=0;i<e.length;i++){var r=e[i][0],o=e[i][1];if(tA(r,t)&&(this._triggerKeyHandler(r,o,t),t.defaultPrevented))return}},_triggerKeyHandler:function(e,t,i){var r=Object.create(e);r.keyboardEvent=i;var o=new CustomEvent(e.event,{detail:r,cancelable:!0});this[t].call(this,o),o.defaultPrevented&&i.preventDefault()}},oA={properties:{pressed:{type:Boolean,readOnly:!0,value:!1,reflectToAttribute:!0,observer:"_pressedChanged"},toggles:{type:Boolean,value:!1,reflectToAttribute:!0},active:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},pointerDown:{type:Boolean,readOnly:!0,value:!1},receivedFocusFromKeyboard:{type:Boolean,readOnly:!0},ariaActiveAttribute:{type:String,value:"aria-pressed",observer:"_ariaActiveAttributeChanged"}},listeners:{down:"_downHandler",up:"_upHandler",tap:"_tapHandler"},observers:["_focusChanged(focused)","_activeChanged(active, ariaActiveAttribute)"],keyBindings:{"enter:keydown":"_asyncClick","space:keydown":"_spaceKeyDownHandler","space:keyup":"_spaceKeyUpHandler"},_mouseEventRe:/^mouse/,_tapHandler:function(){this.toggles?this._userActivate(!this.active):this.active=!1},_focusChanged:function(e){this._detectKeyboardFocus(e),e||this._setPressed(!1)},_detectKeyboardFocus:function(e){this._setReceivedFocusFromKeyboard(!this.pointerDown&&e)},_userActivate:function(e){this.active!==e&&(this.active=e,this.fire("change"))},_downHandler:function(e){this._setPointerDown(!0),this._setPressed(!0),this._setReceivedFocusFromKeyboard(!1)},_upHandler:function(){this._setPointerDown(!1),this._setPressed(!1)},_spaceKeyDownHandler:function(e){var t=e.detail.keyboardEvent,i=Yr(t).localTarget;this.isLightDescendant(i)||(t.preventDefault(),t.stopImmediatePropagation(),this._setPressed(!0))},_spaceKeyUpHandler:function(e){var t=e.detail.keyboardEvent,i=Yr(t).localTarget;this.isLightDescendant(i)||(this.pressed&&this._asyncClick(),this._setPressed(!1))},_asyncClick:function(){this.async((function(){this.click()}),1)},_pressedChanged:function(e){this._changedButtonState()},_ariaActiveAttributeChanged:function(e,t){t&&t!=e&&this.hasAttribute(t)&&this.removeAttribute(t)},_activeChanged:function(e,t){this.toggles?this.setAttribute(this.ariaActiveAttribute,e?"true":"false"):this.removeAttribute(this.ariaActiveAttribute),this._changedButtonState()},_controlStateChanged:function(){this.disabled?this._setPressed(!1):this._changedButtonState()},_changedButtonState:function(){this._buttonStateChanged&&this._buttonStateChanged()}},sA=[rA,oA];function nA(e,t,i){return Math.max(t,Math.min(e,i))}function aA(e,t){let i,r;return e.width/e.height>t.width/t.height?(i=Math.min(t.width,e.width),r=e.height*(i/e.width)):(r=Math.min(t.height,e.height),i=e.width*(r/e.height)),{top:(t.height-r)/2,left:(t.width-i)/2,width:i,height:r,scale:i/e.width}}function lA(e,t){return{origin:{x:e.dimensions.width<=t.width?nA(e.origin.x,0,t.width-e.dimensions.width):(t.width-e.dimensions.width)/2,y:e.dimensions.height<=t.height?nA(e.origin.y,0,t.height-e.dimensions.height):(t.height-e.dimensions.height)/2},dimensions:e.dimensions}}As({_template:nn`
    <style include="paper-item-shared-styles">
      :host {
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --paper-font-subhead;

        @apply --paper-item;
      }
    </style>
    <slot></slot>
`,is:"paper-item",behaviors:[[sA,Vk,{hostAttributes:{role:"option",tabindex:"0"}}]]});class dA{constructor(){this.center={x:0,y:0},this.frameSize={width:0,height:0},this.bounds={width:0,height:0},this.scale=1,this.unscaledFrame={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.scaledFrame={origin:{x:0,y:0},dimensions:{width:0,height:0}}}getCenter(){return{...this.center}}getUnscaledFrame(){return{origin:{...this.unscaledFrame.origin},dimensions:{...this.unscaledFrame.dimensions}}}getScaledFrame(){return{origin:{...this.scaledFrame.origin},dimensions:{...this.scaledFrame.dimensions}}}requestCenter(e){this.center={...e},this.ensureFrameInBounds()}setFrameSize(e){e.width<=0||e.height<=0||(this.frameSize={...e},this.ensureFrameInBounds())}setBounds(e){e.width<=0||e.height<=0||(this.bounds={...e},this.ensureFrameInBounds())}setScale(e){!e||e<=0||(this.scale=e,this.ensureFrameInBounds())}ensureFrameInBounds(){const e=this.center.x*this.scale,t=this.center.y*this.scale,i={width:this.bounds.width*this.scale,height:this.bounds.height*this.scale},r={width:this.frameSize.width/this.scale,height:this.frameSize.height/this.scale},o={origin:{x:e-this.frameSize.width/2,y:t-this.frameSize.height/2},dimensions:this.frameSize},s={origin:{x:this.center.x-r.width/2,y:this.center.y-r.height/2},dimensions:r};this.unscaledFrame=lA(o,i),this.scaledFrame=lA(s,this.bounds),this.center={x:this.scaledFrame.origin.x+this.scaledFrame.dimensions.width/2,y:this.scaledFrame.origin.y+this.scaledFrame.dimensions.height/2}}}var cA=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let hA=class extends Ic{constructor(){super(...arguments),this.frameRect={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.contentStyle={},this.contentTransformStyle={},this.frameStyle={},this.dragging=!1,this.contentBounds={width:0,height:0},this.imageBounds={width:0,height:0},this.scale=1,this.grabOffset={x:0,y:0},this.resizeObserver=new ResizeObserver((e=>{for(const t of e)t.target===this.contentBox&&(this.contentBounds={width:t.contentRect.width,height:t.contentRect.height}),t.target===this.contentTransform&&(this.imageBounds={width:t.contentRect.width,height:t.contentRect.height}),this.updateScale()}))}static get styles(){return[Sd`
        :host {
          --background-color: var(--overview-image-background-color, #000);
          --frame-color: var(--overview-image-frame-color, #f00);
          display: flex;
        }
        * {
          box-sizing: border-box;
        }
        ::slotted(*) {
          display: block;
        }
        .content-box {
          border: 1px solid var(--background-color);
          background-color: var(--background-color);
          width: 100%;
          position: relative;
        }
        .content {
          position: absolute;
          cursor: pointer;
        }
        .content-transform {
          position: absolute;
          transform-origin: top left;
          will-change: transform;
        }
        .frame {
          border: 1px solid var(--frame-color);
          position: absolute;
          will-change: transform;
        }
      `]}render(){return dc`
      <div class="content-box">
        <div
          class="content"
          style=${Bm({...this.contentStyle})}
          @mousemove=${this.maybeDragFrame}
          @mousedown=${this.clickOverview}
          @mouseup=${this.releaseFrame}
        >
          <div
            class="content-transform"
            style=${Bm(this.contentTransformStyle)}
          >
            <slot></slot>
          </div>
          <div
            class="frame"
            style=${Bm({...this.frameStyle,cursor:this.dragging?"grabbing":"grab"})}
            @mousedown=${this.grabFrame}
          ></div>
        </div>
      </div>
    `}connectedCallback(){super.connectedCallback(),this.isConnected&&(this.overlay=document.createElement("div"),this.overlay.style.position="fixed",this.overlay.style.top="0",this.overlay.style.left="0",this.overlay.style.width="calc(100vw - 20px)",this.overlay.style.height="calc(100vh - 20px)",this.overlay.style.zIndex="10000",this.overlay.style.display="none",this.overlay.addEventListener("mousemove",(e=>this.maybeDragFrame(e))),this.overlay.addEventListener("mouseleave",(e=>{"none"!==this.overlay?.style.display&&this.releaseFrame(e)})),this.overlay.addEventListener("mouseup",(e=>this.releaseFrame(e))),document.body.appendChild(this.overlay))}disconnectedCallback(){this.overlay&&(document.body.removeChild(this.overlay),this.overlay=void 0),super.disconnectedCallback()}firstUpdated(){this.resizeObserver.observe(this.contentBox),this.resizeObserver.observe(this.contentTransform)}updated(e){e.has("frameRect")&&this.updateFrameStyle()}clickOverview(e){if(1!==e.buttons)return;e.preventDefault(),this.dragging=!0,this.openOverlay();const t=this.content.getBoundingClientRect();this.notifyNewCenter({x:(e.clientX-t.left)/this.scale,y:(e.clientY-t.top)/this.scale})}grabFrame(e){if(1!==e.buttons)return;e.preventDefault(),e.stopPropagation(),this.dragging=!0,this.openOverlay();const t=this.frame.getBoundingClientRect(),i=t.x+t.width/2,r=t.y+t.height/2;this.grabOffset={x:e.clientX-i,y:e.clientY-r}}maybeDragFrame(e){if(e.preventDefault(),!this.dragging)return;const t=this.content.getBoundingClientRect(),i={x:(e.clientX-t.left-this.grabOffset.x)/this.scale,y:(e.clientY-t.top-this.grabOffset.y)/this.scale};this.notifyNewCenter(i)}releaseFrame(e){e.preventDefault(),Jn(this,"image-diff-action",{type:this.dragging?"overview-frame-dragged":"overview-image-clicked"}),this.dragging=!1,this.closeOverlay(),this.grabOffset={x:0,y:0}}openOverlay(){this.overlay&&(this.overlay.style.display="block",this.overlay.style.cursor="grabbing")}closeOverlay(){this.overlay&&(this.overlay.style.display="none",this.overlay.style.cursor="")}updateScale(){const e=aA(this.imageBounds,this.contentBounds);this.scale=e.scale,this.contentStyle={...this.contentStyle,top:`${e.top}px`,left:`${e.left}px`,width:`${e.width}px`,height:`${e.height}px`},this.contentTransformStyle={transform:`scale(${this.scale})`},this.updateFrameStyle()}updateFrameStyle(){const e=this.frameRect.origin.x*this.scale,t=this.frameRect.origin.y*this.scale,i=this.frameRect.dimensions.width*this.scale,r=this.frameRect.dimensions.height*this.scale;this.frameStyle={...this.frameStyle,transform:`translate(${e}px, ${t}px)`,width:`${i}px`,height:`${r}px`}}notifyNewCenter(e){Jn(this,"center-updated",{...e})}};cA([Fc({type:Object})],hA.prototype,"frameRect",void 0),cA([Uc()],hA.prototype,"contentStyle",void 0),cA([Uc()],hA.prototype,"contentTransformStyle",void 0),cA([Uc()],hA.prototype,"frameStyle",void 0),cA([Uc()],hA.prototype,"dragging",void 0),cA([Hc(".content-box")],hA.prototype,"contentBox",void 0),cA([Hc(".content")],hA.prototype,"content",void 0),cA([Hc(".content-transform")],hA.prototype,"contentTransform",void 0),cA([Hc(".frame")],hA.prototype,"frame",void 0),hA=cA([Dc("gr-overview-image")],hA);var pA=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let uA=class extends Ic{constructor(){super(...arguments),this.scale=1,this.frameRect={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.imageStyles={}}static get styles(){return[Sd`
        :host {
          display: block;
        }
        ::slotted(*) {
          display: block;
        }
        #clip {
          position: relative;
          width: 100%;
          height: 100%;
          overflow: hidden;
        }
        #transform {
          position: absolute;
          transform-origin: top left;
          will-change: transform;
        }
      `]}render(){return dc`
      <div id="clip">
        <div id="transform" style=${Bm(this.imageStyles)}>
          <slot></slot>
        </div>
      </div>
    `}updated(e){(e.has("scale")||e.has("frameRect"))&&this.updateImageStyles()}updateImageStyles(){const{x:e,y:t}=this.frameRect.origin;this.imageStyles={"image-rendering":this.scale>=1?"pixelated":"auto",transform:`translate(${-e}px, ${-t}px) scale(${this.scale})`}}};pA([Fc({type:Number})],uA.prototype,"scale",void 0),pA([Fc({type:Object})],uA.prototype,"frameRect",void 0),pA([Uc()],uA.prototype,"imageStyles",void 0),uA=pA([Dc("gr-zoomed-image")],uA);class gA extends Ic{render(){return dc`
      <md-elevation part="elevation"></md-elevation>
      <div class="background"></div>
      <slot></slot>
      <div class="outline"></div>
    `}}const mA=Sd`:host{--_container-color: var(--md-filled-card-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_container-elevation: var(--md-filled-card-container-elevation, 0);--_container-shadow-color: var(--md-filled-card-container-shadow-color, var(--md-sys-color-shadow, #000));--_container-shape: var(--md-filled-card-container-shape, var(--md-sys-shape-corner-medium, 12px))}
`,fA=Sd`:host{border-radius:var(--_container-shape);box-sizing:border-box;display:flex;flex-direction:column;position:relative;z-index:0}md-elevation,.background,.outline{border-radius:inherit;inset:0;pointer-events:none;position:absolute}.background{background:var(--_container-color);z-index:-1}.outline{border:1px solid rgba(0,0,0,0);z-index:1}md-elevation{z-index:-1;--md-elevation-level: var(--_container-elevation);--md-elevation-shadow-color: var(--_container-shadow-color)}slot{border-radius:inherit}
`;let vA=class extends gA{};vA.styles=[fA,mA],vA=zg([Dc("md-filled-card")],vA);const bA=fm(Ic);class yA extends bA{constructor(){super(...arguments),this.size="medium",this.label="",this.lowered=!1}render(){const{ariaLabel:e}=this;return dc`
      <button
        class="fab ${th(this.getRenderClasses())}"
        aria-label=${e||uc}>
        <md-elevation part="elevation"></md-elevation>
        <md-focus-ring part="focus-ring"></md-focus-ring>
        <md-ripple class="ripple"></md-ripple>
        ${this.renderTouchTarget()} ${this.renderIcon()} ${this.renderLabel()}
      </button>
    `}getRenderClasses(){const e=!!this.label;return{lowered:this.lowered,small:"small"===this.size&&!e,large:"large"===this.size&&!e,extended:e}}renderTouchTarget(){return dc`<div class="touch-target"></div>`}renderLabel(){return this.label?dc`<span class="label">${this.label}</span>`:""}renderIcon(){const{ariaLabel:e}=this;return dc`<span class="icon">
      <slot
        name="icon"
        aria-hidden=${e||this.label?"true":uc}>
        <span></span>
      </slot>
    </span>`}}yA.shadowRootOptions={mode:"open",delegatesFocus:!0},zg([Fc({reflect:!0})],yA.prototype,"size",void 0),zg([Fc()],yA.prototype,"label",void 0),zg([Fc({type:Boolean})],yA.prototype,"lowered",void 0);class wA extends yA{constructor(){super(...arguments),this.variant="surface"}getRenderClasses(){return{...super.getRenderClasses(),primary:"primary"===this.variant,secondary:"secondary"===this.variant,tertiary:"tertiary"===this.variant}}}zg([Fc()],wA.prototype,"variant",void 0);const _A=Sd`:host{--_container-color: var(--md-fab-container-color, var(--md-sys-color-surface-container-high, #ece6f0));--_container-elevation: var(--md-fab-container-elevation, 3);--_container-height: var(--md-fab-container-height, 56px);--_container-shadow-color: var(--md-fab-container-shadow-color, var(--md-sys-color-shadow, #000));--_container-width: var(--md-fab-container-width, 56px);--_focus-container-elevation: var(--md-fab-focus-container-elevation, 3);--_focus-icon-color: var(--md-fab-focus-icon-color, var(--md-sys-color-primary, #6750a4));--_hover-container-elevation: var(--md-fab-hover-container-elevation, 4);--_hover-icon-color: var(--md-fab-hover-icon-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-color: var(--md-fab-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_hover-state-layer-opacity: var(--md-fab-hover-state-layer-opacity, 0.08);--_icon-color: var(--md-fab-icon-color, var(--md-sys-color-primary, #6750a4));--_icon-size: var(--md-fab-icon-size, 24px);--_lowered-container-color: var(--md-fab-lowered-container-color, var(--md-sys-color-surface-container-low, #f7f2fa));--_lowered-container-elevation: var(--md-fab-lowered-container-elevation, 1);--_lowered-focus-container-elevation: var(--md-fab-lowered-focus-container-elevation, 1);--_lowered-hover-container-elevation: var(--md-fab-lowered-hover-container-elevation, 2);--_lowered-pressed-container-elevation: var(--md-fab-lowered-pressed-container-elevation, 1);--_pressed-container-elevation: var(--md-fab-pressed-container-elevation, 3);--_pressed-icon-color: var(--md-fab-pressed-icon-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-color: var(--md-fab-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_pressed-state-layer-opacity: var(--md-fab-pressed-state-layer-opacity, 0.12);--_focus-label-text-color: var(--md-fab-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_hover-label-text-color: var(--md-fab-hover-label-text-color, var(--md-sys-color-primary, #6750a4));--_label-text-color: var(--md-fab-label-text-color, var(--md-sys-color-primary, #6750a4));--_label-text-font: var(--md-fab-label-text-font, var(--md-sys-typescale-label-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-fab-label-text-line-height, var(--md-sys-typescale-label-large-line-height, 1.25rem));--_label-text-size: var(--md-fab-label-text-size, var(--md-sys-typescale-label-large-size, 0.875rem));--_label-text-weight: var(--md-fab-label-text-weight, var(--md-sys-typescale-label-large-weight, var(--md-ref-typeface-weight-medium, 500)));--_large-container-height: var(--md-fab-large-container-height, 96px);--_large-container-width: var(--md-fab-large-container-width, 96px);--_large-icon-size: var(--md-fab-large-icon-size, 36px);--_pressed-label-text-color: var(--md-fab-pressed-label-text-color, var(--md-sys-color-primary, #6750a4));--_primary-container-color: var(--md-fab-primary-container-color, var(--md-sys-color-primary-container, #eaddff));--_primary-focus-icon-color: var(--md-fab-primary-focus-icon-color, var(--md-sys-color-on-primary-container, #21005d));--_primary-focus-label-text-color: var(--md-fab-primary-focus-label-text-color, var(--md-sys-color-on-primary-container, #21005d));--_primary-hover-icon-color: var(--md-fab-primary-hover-icon-color, var(--md-sys-color-on-primary-container, #21005d));--_primary-hover-label-text-color: var(--md-fab-primary-hover-label-text-color, var(--md-sys-color-on-primary-container, #21005d));--_primary-hover-state-layer-color: var(--md-fab-primary-hover-state-layer-color, var(--md-sys-color-on-primary-container, #21005d));--_primary-icon-color: var(--md-fab-primary-icon-color, var(--md-sys-color-on-primary-container, #21005d));--_primary-label-text-color: var(--md-fab-primary-label-text-color, var(--md-sys-color-on-primary-container, #21005d));--_primary-pressed-icon-color: var(--md-fab-primary-pressed-icon-color, var(--md-sys-color-on-primary-container, #21005d));--_primary-pressed-label-text-color: var(--md-fab-primary-pressed-label-text-color, var(--md-sys-color-on-primary-container, #21005d));--_primary-pressed-state-layer-color: var(--md-fab-primary-pressed-state-layer-color, var(--md-sys-color-on-primary-container, #21005d));--_secondary-container-color: var(--md-fab-secondary-container-color, var(--md-sys-color-secondary-container, #e8def8));--_secondary-focus-icon-color: var(--md-fab-secondary-focus-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_secondary-focus-label-text-color: var(--md-fab-secondary-focus-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_secondary-hover-icon-color: var(--md-fab-secondary-hover-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_secondary-hover-label-text-color: var(--md-fab-secondary-hover-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_secondary-hover-state-layer-color: var(--md-fab-secondary-hover-state-layer-color, var(--md-sys-color-on-secondary-container, #1d192b));--_secondary-icon-color: var(--md-fab-secondary-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_secondary-label-text-color: var(--md-fab-secondary-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_secondary-pressed-icon-color: var(--md-fab-secondary-pressed-icon-color, var(--md-sys-color-on-secondary-container, #1d192b));--_secondary-pressed-label-text-color: var(--md-fab-secondary-pressed-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b));--_secondary-pressed-state-layer-color: var(--md-fab-secondary-pressed-state-layer-color, var(--md-sys-color-on-secondary-container, #1d192b));--_small-container-height: var(--md-fab-small-container-height, 40px);--_small-container-width: var(--md-fab-small-container-width, 40px);--_small-icon-size: var(--md-fab-small-icon-size, 24px);--_tertiary-container-color: var(--md-fab-tertiary-container-color, var(--md-sys-color-tertiary-container, #ffd8e4));--_tertiary-focus-icon-color: var(--md-fab-tertiary-focus-icon-color, var(--md-sys-color-on-tertiary-container, #31111d));--_tertiary-focus-label-text-color: var(--md-fab-tertiary-focus-label-text-color, var(--md-sys-color-on-tertiary-container, #31111d));--_tertiary-hover-icon-color: var(--md-fab-tertiary-hover-icon-color, var(--md-sys-color-on-tertiary-container, #31111d));--_tertiary-hover-label-text-color: var(--md-fab-tertiary-hover-label-text-color, var(--md-sys-color-on-tertiary-container, #31111d));--_tertiary-hover-state-layer-color: var(--md-fab-tertiary-hover-state-layer-color, var(--md-sys-color-on-tertiary-container, #31111d));--_tertiary-icon-color: var(--md-fab-tertiary-icon-color, var(--md-sys-color-on-tertiary-container, #31111d));--_tertiary-label-text-color: var(--md-fab-tertiary-label-text-color, var(--md-sys-color-on-tertiary-container, #31111d));--_tertiary-pressed-icon-color: var(--md-fab-tertiary-pressed-icon-color, var(--md-sys-color-on-tertiary-container, #31111d));--_tertiary-pressed-label-text-color: var(--md-fab-tertiary-pressed-label-text-color, var(--md-sys-color-on-tertiary-container, #31111d));--_tertiary-pressed-state-layer-color: var(--md-fab-tertiary-pressed-state-layer-color, var(--md-sys-color-on-tertiary-container, #31111d));--_container-shape-start-start: var(--md-fab-container-shape-start-start, var(--md-fab-container-shape, var(--md-sys-shape-corner-large, 16px)));--_container-shape-start-end: var(--md-fab-container-shape-start-end, var(--md-fab-container-shape, var(--md-sys-shape-corner-large, 16px)));--_container-shape-end-end: var(--md-fab-container-shape-end-end, var(--md-fab-container-shape, var(--md-sys-shape-corner-large, 16px)));--_container-shape-end-start: var(--md-fab-container-shape-end-start, var(--md-fab-container-shape, var(--md-sys-shape-corner-large, 16px)));--_large-container-shape-start-start: var(--md-fab-large-container-shape-start-start, var(--md-fab-large-container-shape, var(--md-sys-shape-corner-extra-large, 28px)));--_large-container-shape-start-end: var(--md-fab-large-container-shape-start-end, var(--md-fab-large-container-shape, var(--md-sys-shape-corner-extra-large, 28px)));--_large-container-shape-end-end: var(--md-fab-large-container-shape-end-end, var(--md-fab-large-container-shape, var(--md-sys-shape-corner-extra-large, 28px)));--_large-container-shape-end-start: var(--md-fab-large-container-shape-end-start, var(--md-fab-large-container-shape, var(--md-sys-shape-corner-extra-large, 28px)));--_small-container-shape-start-start: var(--md-fab-small-container-shape-start-start, var(--md-fab-small-container-shape, var(--md-sys-shape-corner-medium, 12px)));--_small-container-shape-start-end: var(--md-fab-small-container-shape-start-end, var(--md-fab-small-container-shape, var(--md-sys-shape-corner-medium, 12px)));--_small-container-shape-end-end: var(--md-fab-small-container-shape-end-end, var(--md-fab-small-container-shape, var(--md-sys-shape-corner-medium, 12px)));--_small-container-shape-end-start: var(--md-fab-small-container-shape-end-start, var(--md-fab-small-container-shape, var(--md-sys-shape-corner-medium, 12px)));cursor:pointer}:host([size=small][touch-target=wrapper]){margin:max(0px,48px - var(--_small-container-height))}.fab{cursor:inherit}.fab .icon ::slotted(*){color:var(--_icon-color)}.fab:focus{color:var(--_focus-icon-color)}.fab:hover{color:var(--_hover-icon-color)}.fab:active{color:var(--_pressed-icon-color)}.fab.primary{background-color:var(--_primary-container-color);--md-ripple-hover-color: var(--_primary-hover-state-layer-color);--md-ripple-pressed-color: var(--_primary-pressed-state-layer-color)}.fab.primary .icon ::slotted(*){color:var(--_primary-icon-color)}.fab.primary:focus{color:var(--_primary-focus-icon-color)}.fab.primary:hover{color:var(--_primary-hover-icon-color)}.fab.primary:active{color:var(--_primary-pressed-icon-color)}.fab.primary .label{color:var(--_primary-label-text-color)}.fab:hover .fab.primary .label{color:var(--_primary-hover-label-text-color)}.fab:focus .fab.primary .label{color:var(--_primary-focus-label-text-color)}.fab:active .fab.primary .label{color:var(--_primary-pressed-label-text-color)}.fab.secondary{background-color:var(--_secondary-container-color);--md-ripple-hover-color: var(--_secondary-hover-state-layer-color);--md-ripple-pressed-color: var(--_secondary-pressed-state-layer-color)}.fab.secondary .icon ::slotted(*){color:var(--_secondary-icon-color)}.fab.secondary:focus{color:var(--_secondary-focus-icon-color)}.fab.secondary:hover{color:var(--_secondary-hover-icon-color)}.fab.secondary:active{color:var(--_secondary-pressed-icon-color)}.fab.secondary .label{color:var(--_secondary-label-text-color)}.fab:hover .fab.secondary .label{color:var(--_secondary-hover-label-text-color)}.fab:focus .fab.secondary .label{color:var(--_secondary-focus-label-text-color)}.fab:active .fab.secondary .label{color:var(--_secondary-pressed-label-text-color)}.fab.tertiary{background-color:var(--_tertiary-container-color);--md-ripple-hover-color: var(--_tertiary-hover-state-layer-color);--md-ripple-pressed-color: var(--_tertiary-pressed-state-layer-color)}.fab.tertiary .icon ::slotted(*){color:var(--_tertiary-icon-color)}.fab.tertiary:focus{color:var(--_tertiary-focus-icon-color)}.fab.tertiary:hover{color:var(--_tertiary-hover-icon-color)}.fab.tertiary:active{color:var(--_tertiary-pressed-icon-color)}.fab.tertiary .label{color:var(--_tertiary-label-text-color)}.fab:hover .fab.tertiary .label{color:var(--_tertiary-hover-label-text-color)}.fab:focus .fab.tertiary .label{color:var(--_tertiary-focus-label-text-color)}.fab:active .fab.tertiary .label{color:var(--_tertiary-pressed-label-text-color)}.fab.extended slot span{padding-inline-start:4px}.fab.small{width:var(--_small-container-width);height:var(--_small-container-height)}.fab.small .icon ::slotted(*){width:var(--_small-icon-size);height:var(--_small-icon-size);font-size:var(--_small-icon-size)}.fab.small,.fab.small .ripple{border-start-start-radius:var(--_small-container-shape-start-start);border-start-end-radius:var(--_small-container-shape-start-end);border-end-start-radius:var(--_small-container-shape-end-start);border-end-end-radius:var(--_small-container-shape-end-end)}.fab.small md-focus-ring{--md-focus-ring-shape-start-start: var(--_small-container-shape-start-start);--md-focus-ring-shape-start-end: var(--_small-container-shape-start-end);--md-focus-ring-shape-end-end: var(--_small-container-shape-end-end);--md-focus-ring-shape-end-start: var(--_small-container-shape-end-start)}
`,xA=Sd`@media(forced-colors: active){.fab{border:1px solid ButtonText}.fab.extended{padding-inline-start:15px;padding-inline-end:19px}md-focus-ring{--md-focus-ring-outward-offset: 3px}}
`,CA=Sd`:host{--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity);display:inline-flex;-webkit-tap-highlight-color:rgba(0,0,0,0)}:host([size=medium][touch-target=wrapper]){margin:max(0px,48px - var(--_container-height))}:host([size=large][touch-target=wrapper]){margin:max(0px,48px - var(--_large-container-height))}.fab,.icon,.icon ::slotted(*){display:flex}.fab{align-items:center;justify-content:center;vertical-align:middle;padding:0;position:relative;height:var(--_container-height);transition-property:background-color;border-width:0px;outline:none;z-index:0;text-transform:inherit;--md-elevation-level: var(--_container-elevation);--md-elevation-shadow-color: var(--_container-shadow-color);background-color:var(--_container-color);--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-pressed-color: var(--_pressed-state-layer-color)}.fab.extended{width:inherit;box-sizing:border-box;padding-inline-start:16px;padding-inline-end:20px}.fab:not(.extended){width:var(--_container-width)}.fab.large{width:var(--_large-container-width);height:var(--_large-container-height)}.fab.large .icon ::slotted(*){width:var(--_large-icon-size);height:var(--_large-icon-size);font-size:var(--_large-icon-size)}.fab.large,.fab.large .ripple{border-start-start-radius:var(--_large-container-shape-start-start);border-start-end-radius:var(--_large-container-shape-start-end);border-end-start-radius:var(--_large-container-shape-end-start);border-end-end-radius:var(--_large-container-shape-end-end)}.fab.large md-focus-ring{--md-focus-ring-shape-start-start: var(--_large-container-shape-start-start);--md-focus-ring-shape-start-end: var(--_large-container-shape-start-end);--md-focus-ring-shape-end-end: var(--_large-container-shape-end-end);--md-focus-ring-shape-end-start: var(--_large-container-shape-end-start)}.fab:focus{--md-elevation-level: var(--_focus-container-elevation)}.fab:hover{--md-elevation-level: var(--_hover-container-elevation)}.fab:active{--md-elevation-level: var(--_pressed-container-elevation)}.fab.lowered{background-color:var(--_lowered-container-color);--md-elevation-level: var(--_lowered-container-elevation)}.fab.lowered:focus{--md-elevation-level: var(--_lowered-focus-container-elevation)}.fab.lowered:hover{--md-elevation-level: var(--_lowered-hover-container-elevation)}.fab.lowered:active{--md-elevation-level: var(--_lowered-pressed-container-elevation)}.fab .label{color:var(--_label-text-color)}.fab:hover .fab .label{color:var(--_hover-label-text-color)}.fab:focus .fab .label{color:var(--_focus-label-text-color)}.fab:active .fab .label{color:var(--_pressed-label-text-color)}.label{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight)}.fab.extended .icon ::slotted(*){margin-inline-end:12px}.ripple{overflow:hidden}.ripple,md-elevation{z-index:-1}.touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}:host([touch-target=none]) .touch-target{display:none}md-elevation,.fab{transition-duration:280ms;transition-timing-function:cubic-bezier(0.2, 0, 0, 1)}.fab,.ripple{border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end)}md-focus-ring{--md-focus-ring-shape-start-start: var(--_container-shape-start-start);--md-focus-ring-shape-start-end: var(--_container-shape-start-end);--md-focus-ring-shape-end-end: var(--_container-shape-end-end);--md-focus-ring-shape-end-start: var(--_container-shape-end-start)}.icon ::slotted(*){width:var(--_icon-size);height:var(--_icon-size);font-size:var(--_icon-size)}
`;let EA=class extends wA{};EA.styles=[CA,_A,xA],EA=zg([Dc("md-fab")],EA);class SA extends Ic{render(){return dc`<slot></slot>`}connectedCallback(){super.connectedCallback(),"false"!==this.getAttribute("aria-hidden")?this.setAttribute("aria-hidden","true"):this.removeAttribute("aria-hidden")}}const $A=Sd`:host{font-size:var(--md-icon-size, 24px);width:var(--md-icon-size, 24px);height:var(--md-icon-size, 24px);color:inherit;font-variation-settings:inherit;font-weight:400;font-family:var(--md-icon-font, Material Symbols Outlined);display:inline-flex;font-style:normal;place-items:center;place-content:center;line-height:1;overflow:hidden;letter-spacing:normal;text-transform:none;user-select:none;white-space:nowrap;word-wrap:normal;flex-shrink:0;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale}::slotted(svg){fill:currentColor}::slotted(*){height:100%;width:100%}
`;let kA=class extends SA{};function AA(e,t=!0){return t&&"rtl"===getComputedStyle(e).getPropertyValue("direction").trim()}kA.styles=[$A],kA=zg([Dc("md-icon")],kA);const RA=fm(_m(Ic));class TA extends RA{get name(){return this.getAttribute("name")??""}set name(e){this.setAttribute("name",e)}get form(){return this[ym].form}get labels(){return this[ym].labels}constructor(){super(),this.disabled=!1,this.softDisabled=!1,this.flipIconInRtl=!1,this.href="",this.download="",this.target="",this.ariaLabelSelected="",this.toggle=!1,this.selected=!1,this.type="submit",this.value="",this.flipIcon=AA(this,this.flipIconInRtl),this.addEventListener("click",this.handleClick.bind(this))}willUpdate(){this.href&&(this.disabled=!1,this.softDisabled=!1)}render(){const e=this.href?Db`div`:Db`button`,{ariaLabel:t,ariaHasPopup:i,ariaExpanded:r}=this,o=t&&this.ariaLabelSelected,s=this.toggle?this.selected:uc;let n=uc;return this.href||(n=o&&this.selected?this.ariaLabelSelected:t),Fb`<${e}
        class="icon-button ${th(this.getRenderClasses())}"
        id="button"
        aria-label="${n||uc}"
        aria-haspopup="${!this.href&&i||uc}"
        aria-expanded="${!this.href&&r||uc}"
        aria-pressed="${s}"
        aria-disabled=${!this.href&&this.softDisabled||uc}
        ?disabled="${!this.href&&this.disabled}"
        @click="${this.handleClickOnChild}">
        ${this.renderFocusRing()}
        ${this.renderRipple()}
        ${this.selected?uc:this.renderIcon()}
        ${this.selected?this.renderSelectedIcon():uc}
        ${this.href?this.renderLink():this.renderTouchTarget()}
  </${e}>`}renderLink(){const{ariaLabel:e}=this;return dc`
      <a
        class="link"
        id="link"
        href="${this.href}"
        download="${this.download||uc}"
        target="${this.target||uc}"
        aria-label="${e||uc}">
        ${this.renderTouchTarget()}
      </a>
    `}getRenderClasses(){return{"flip-icon":this.flipIcon,selected:this.toggle&&this.selected}}renderIcon(){return dc`<span class="icon"><slot></slot></span>`}renderSelectedIcon(){return dc`<span class="icon icon--selected"
      ><slot name="selected"><slot></slot></slot
    ></span>`}renderTouchTarget(){return dc`<span class="touch"></span>`}renderFocusRing(){return dc`<md-focus-ring
      part="focus-ring"
      for=${this.href?"link":"button"}></md-focus-ring>`}renderRipple(){const e=!this.href&&(this.disabled||this.softDisabled);return dc`<md-ripple
      for=${this.href?"link":uc}
      ?disabled="${e}"></md-ripple>`}connectedCallback(){this.flipIcon=AA(this,this.flipIconInRtl),super.connectedCallback()}handleClick(e){if(!this.href&&this.softDisabled)return e.stopImmediatePropagation(),void e.preventDefault()}async handleClickOnChild(e){await 0,!this.toggle||this.disabled||this.softDisabled||e.defaultPrevented||(this.selected=!this.selected,this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0})))}}xm(TA),TA.formAssociated=!0,TA.shadowRootOptions={mode:"open",delegatesFocus:!0},zg([Fc({type:Boolean,reflect:!0})],TA.prototype,"disabled",void 0),zg([Fc({type:Boolean,attribute:"soft-disabled",reflect:!0})],TA.prototype,"softDisabled",void 0),zg([Fc({type:Boolean,attribute:"flip-icon-in-rtl"})],TA.prototype,"flipIconInRtl",void 0),zg([Fc()],TA.prototype,"href",void 0),zg([Fc()],TA.prototype,"download",void 0),zg([Fc()],TA.prototype,"target",void 0),zg([Fc({attribute:"aria-label-selected"})],TA.prototype,"ariaLabelSelected",void 0),zg([Fc({type:Boolean})],TA.prototype,"toggle",void 0),zg([Fc({type:Boolean,reflect:!0})],TA.prototype,"selected",void 0),zg([Fc()],TA.prototype,"type",void 0),zg([Fc({reflect:!0})],TA.prototype,"value",void 0),zg([Uc()],TA.prototype,"flipIcon",void 0);const IA=Sd`:host{display:inline-flex;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0);height:var(--_container-height);width:var(--_container-width);justify-content:center}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--_container-height))/2) max(0px,(48px - var(--_container-width))/2)}md-focus-ring{--md-focus-ring-shape-start-start: var(--_container-shape-start-start);--md-focus-ring-shape-start-end: var(--_container-shape-start-end);--md-focus-ring-shape-end-end: var(--_container-shape-end-end);--md-focus-ring-shape-end-start: var(--_container-shape-end-start)}:host(:is([disabled],[soft-disabled])){pointer-events:none}.icon-button{place-items:center;background:none;border:none;box-sizing:border-box;cursor:pointer;display:flex;place-content:center;outline:none;padding:0;position:relative;text-decoration:none;user-select:none;z-index:0;flex:1;border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end)}.icon ::slotted(*){font-size:var(--_icon-size);height:var(--_icon-size);width:var(--_icon-size);font-weight:inherit}md-ripple{z-index:-1;border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end)}.flip-icon .icon{transform:scaleX(-1)}.icon{display:inline-flex}.link{display:grid;height:100%;outline:none;place-items:center;position:absolute;width:100%}.touch{position:absolute;height:max(48px,100%);width:max(48px,100%)}:host([touch-target=none]) .touch{display:none}@media(forced-colors: active){:host(:is([disabled],[soft-disabled])){--_disabled-icon-color: GrayText;--_disabled-icon-opacity: 1}}
`,PA=Sd`:host{--_disabled-icon-color: var(--md-icon-button-disabled-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-icon-opacity: var(--md-icon-button-disabled-icon-opacity, 0.38);--_icon-size: var(--md-icon-button-icon-size, 24px);--_selected-focus-icon-color: var(--md-icon-button-selected-focus-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-icon-color: var(--md-icon-button-selected-hover-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-state-layer-color: var(--md-icon-button-selected-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-state-layer-opacity: var(--md-icon-button-selected-hover-state-layer-opacity, 0.08);--_selected-icon-color: var(--md-icon-button-selected-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-icon-color: var(--md-icon-button-selected-pressed-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-state-layer-color: var(--md-icon-button-selected-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-state-layer-opacity: var(--md-icon-button-selected-pressed-state-layer-opacity, 0.12);--_state-layer-height: var(--md-icon-button-state-layer-height, 40px);--_state-layer-shape: var(--md-icon-button-state-layer-shape, var(--md-sys-shape-corner-full, 9999px));--_state-layer-width: var(--md-icon-button-state-layer-width, 40px);--_focus-icon-color: var(--md-icon-button-focus-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-icon-color: var(--md-icon-button-hover-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-icon-button-hover-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-opacity: var(--md-icon-button-hover-state-layer-opacity, 0.08);--_icon-color: var(--md-icon-button-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-icon-color: var(--md-icon-button-pressed-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-state-layer-color: var(--md-icon-button-pressed-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-state-layer-opacity: var(--md-icon-button-pressed-state-layer-opacity, 0.12);--_container-shape-start-start: 0;--_container-shape-start-end: 0;--_container-shape-end-end: 0;--_container-shape-end-start: 0;--_container-height: 0;--_container-width: 0;height:var(--_state-layer-height);width:var(--_state-layer-width)}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--_state-layer-height))/2) max(0px,(48px - var(--_state-layer-width))/2)}md-focus-ring{--md-focus-ring-shape-start-start: var(--_state-layer-shape);--md-focus-ring-shape-start-end: var(--_state-layer-shape);--md-focus-ring-shape-end-end: var(--_state-layer-shape);--md-focus-ring-shape-end-start: var(--_state-layer-shape)}.standard{background-color:rgba(0,0,0,0);color:var(--_icon-color);--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity)}.standard:hover{color:var(--_hover-icon-color)}.standard:focus{color:var(--_focus-icon-color)}.standard:active{color:var(--_pressed-icon-color)}.standard:is(:disabled,[aria-disabled=true]){color:var(--_disabled-icon-color)}md-ripple{border-radius:var(--_state-layer-shape)}.standard:is(:disabled,[aria-disabled=true]){opacity:var(--_disabled-icon-opacity)}.selected{--md-ripple-hover-color: var(--_selected-hover-state-layer-color);--md-ripple-hover-opacity: var(--_selected-hover-state-layer-opacity);--md-ripple-pressed-color: var(--_selected-pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_selected-pressed-state-layer-opacity)}.selected:not(:disabled,[aria-disabled=true]){color:var(--_selected-icon-color)}.selected:not(:disabled,[aria-disabled=true]):hover{color:var(--_selected-hover-icon-color)}.selected:not(:disabled,[aria-disabled=true]):focus{color:var(--_selected-focus-icon-color)}.selected:not(:disabled,[aria-disabled=true]):active{color:var(--_selected-pressed-icon-color)}
`;let NA=class extends TA{getRenderClasses(){return{...super.getRenderClasses(),standard:!0}}};NA.styles=[IA,PA],NA=zg([Dc("md-icon-button")],NA);class OA extends yy{renderBackground(){return dc` <div class="background"></div> `}renderStateLayer(){return dc` <div class="state-layer"></div> `}renderIndicator(){return dc`<div class="active-indicator"></div>`}}const DA=Sd`@layer styles{:host{--_active-indicator-color: var(--md-filled-field-active-indicator-color, var(--md-sys-color-on-surface-variant, #49454f));--_active-indicator-height: var(--md-filled-field-active-indicator-height, 1px);--_bottom-space: var(--md-filled-field-bottom-space, 16px);--_container-color: var(--md-filled-field-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_content-color: var(--md-filled-field-content-color, var(--md-sys-color-on-surface, #1d1b20));--_content-font: var(--md-filled-field-content-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_content-line-height: var(--md-filled-field-content-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_content-size: var(--md-filled-field-content-size, var(--md-sys-typescale-body-large-size, 1rem));--_content-space: var(--md-filled-field-content-space, 16px);--_content-weight: var(--md-filled-field-content-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_disabled-active-indicator-color: var(--md-filled-field-disabled-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-active-indicator-height: var(--md-filled-field-disabled-active-indicator-height, 1px);--_disabled-active-indicator-opacity: var(--md-filled-field-disabled-active-indicator-opacity, 0.38);--_disabled-container-color: var(--md-filled-field-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-opacity: var(--md-filled-field-disabled-container-opacity, 0.04);--_disabled-content-color: var(--md-filled-field-disabled-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-content-opacity: var(--md-filled-field-disabled-content-opacity, 0.38);--_disabled-label-text-color: var(--md-filled-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-filled-field-disabled-label-text-opacity, 0.38);--_disabled-leading-content-color: var(--md-filled-field-disabled-leading-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-content-opacity: var(--md-filled-field-disabled-leading-content-opacity, 0.38);--_disabled-supporting-text-color: var(--md-filled-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-filled-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-content-color: var(--md-filled-field-disabled-trailing-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-content-opacity: var(--md-filled-field-disabled-trailing-content-opacity, 0.38);--_error-active-indicator-color: var(--md-filled-field-error-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-content-color: var(--md-filled-field-error-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-active-indicator-color: var(--md-filled-field-error-focus-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-focus-content-color: var(--md-filled-field-error-focus-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-label-text-color: var(--md-filled-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-content-color: var(--md-filled-field-error-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-supporting-text-color: var(--md-filled-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-content-color: var(--md-filled-field-error-focus-trailing-content-color, var(--md-sys-color-error, #b3261e));--_error-hover-active-indicator-color: var(--md-filled-field-error-hover-active-indicator-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-content-color: var(--md-filled-field-error-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-filled-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-content-color: var(--md-filled-field-error-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-state-layer-color: var(--md-filled-field-error-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-state-layer-opacity: var(--md-filled-field-error-hover-state-layer-opacity, 0.08);--_error-hover-supporting-text-color: var(--md-filled-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-content-color: var(--md-filled-field-error-hover-trailing-content-color, var(--md-sys-color-on-error-container, #410e0b));--_error-label-text-color: var(--md-filled-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-content-color: var(--md-filled-field-error-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-supporting-text-color: var(--md-filled-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-content-color: var(--md-filled-field-error-trailing-content-color, var(--md-sys-color-error, #b3261e));--_focus-active-indicator-color: var(--md-filled-field-focus-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_focus-active-indicator-height: var(--md-filled-field-focus-active-indicator-height, 3px);--_focus-content-color: var(--md-filled-field-focus-content-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-filled-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-content-color: var(--md-filled-field-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-supporting-text-color: var(--md-filled-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-content-color: var(--md-filled-field-focus-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-active-indicator-color: var(--md-filled-field-hover-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-active-indicator-height: var(--md-filled-field-hover-active-indicator-height, 1px);--_hover-content-color: var(--md-filled-field-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-filled-field-hover-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-leading-content-color: var(--md-filled-field-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-filled-field-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-state-layer-opacity: var(--md-filled-field-hover-state-layer-opacity, 0.08);--_hover-supporting-text-color: var(--md-filled-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-content-color: var(--md-filled-field-hover-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-color: var(--md-filled-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-filled-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-filled-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-populated-line-height: var(--md-filled-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-filled-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-filled-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-filled-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-content-color: var(--md-filled-field-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-space: var(--md-filled-field-leading-space, 16px);--_supporting-text-color: var(--md-filled-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-filled-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-leading-space: var(--md-filled-field-supporting-text-leading-space, 16px);--_supporting-text-line-height: var(--md-filled-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-filled-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-top-space: var(--md-filled-field-supporting-text-top-space, 4px);--_supporting-text-trailing-space: var(--md-filled-field-supporting-text-trailing-space, 16px);--_supporting-text-weight: var(--md-filled-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_top-space: var(--md-filled-field-top-space, 16px);--_trailing-content-color: var(--md-filled-field-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-space: var(--md-filled-field-trailing-space, 16px);--_with-label-bottom-space: var(--md-filled-field-with-label-bottom-space, 8px);--_with-label-top-space: var(--md-filled-field-with-label-top-space, 8px);--_with-leading-content-leading-space: var(--md-filled-field-with-leading-content-leading-space, 12px);--_with-trailing-content-trailing-space: var(--md-filled-field-with-trailing-content-trailing-space, 12px);--_container-shape-start-start: var(--md-filled-field-container-shape-start-start, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-filled-field-container-shape-start-end, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-filled-field-container-shape-end-end, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-start: var(--md-filled-field-container-shape-end-start, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-none, 0px)))}.background,.state-layer{border-radius:inherit;inset:0;pointer-events:none;position:absolute}.background{background:var(--_container-color)}.state-layer{visibility:hidden}.field:not(.disabled):hover .state-layer{visibility:visible}.label.floating{position:absolute;top:var(--_with-label-top-space)}.field:not(.with-start) .label-wrapper{margin-inline-start:var(--_leading-space)}.field:not(.with-end) .label-wrapper{margin-inline-end:var(--_trailing-space)}.active-indicator{inset:auto 0 0 0;pointer-events:none;position:absolute;width:100%;z-index:1}.active-indicator::before,.active-indicator::after{border-bottom:var(--_active-indicator-height) solid var(--_active-indicator-color);inset:auto 0 0 0;content:"";position:absolute;width:100%}.active-indicator::after{opacity:0;transition:opacity 150ms cubic-bezier(0.2, 0, 0, 1)}.focused .active-indicator::after{opacity:1}.field:not(.with-start) .content ::slotted(*){padding-inline-start:var(--_leading-space)}.field:not(.with-end) .content ::slotted(*){padding-inline-end:var(--_trailing-space)}.field:not(.no-label) .content ::slotted(:not(textarea)){padding-bottom:var(--_with-label-bottom-space);padding-top:calc(var(--_with-label-top-space) + var(--_label-text-populated-line-height))}.field:not(.no-label) .content ::slotted(textarea){margin-bottom:var(--_with-label-bottom-space);margin-top:calc(var(--_with-label-top-space) + var(--_label-text-populated-line-height))}:hover .active-indicator::before{border-bottom-color:var(--_hover-active-indicator-color);border-bottom-width:var(--_hover-active-indicator-height)}.active-indicator::after{border-bottom-color:var(--_focus-active-indicator-color);border-bottom-width:var(--_focus-active-indicator-height)}:hover .state-layer{background:var(--_hover-state-layer-color);opacity:var(--_hover-state-layer-opacity)}.disabled .active-indicator::before{border-bottom-color:var(--_disabled-active-indicator-color);border-bottom-width:var(--_disabled-active-indicator-height);opacity:var(--_disabled-active-indicator-opacity)}.disabled .background{background:var(--_disabled-container-color);opacity:var(--_disabled-container-opacity)}.error .active-indicator::before{border-bottom-color:var(--_error-active-indicator-color)}.error:hover .active-indicator::before{border-bottom-color:var(--_error-hover-active-indicator-color)}.error:hover .state-layer{background:var(--_error-hover-state-layer-color);opacity:var(--_error-hover-state-layer-opacity)}.error .active-indicator::after{border-bottom-color:var(--_error-focus-active-indicator-color)}.resizable .container{bottom:var(--_focus-active-indicator-height);clip-path:inset(var(--_focus-active-indicator-height) 0 0 0)}.resizable .container>*{top:var(--_focus-active-indicator-height)}}@layer hcm{@media(forced-colors: active){.disabled .active-indicator::before{border-color:GrayText;opacity:1}}}
`;let LA=class extends OA{};LA.styles=[xy,DA],LA=zg([Dc("md-filled-field")],LA);class MA extends hS{constructor(){super(...arguments),this.fieldTag=Db`md-filled-field`}}const FA=Sd`:host{--_text-field-active-indicator-color: var(--md-filled-select-text-field-active-indicator-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-active-indicator-height: var(--md-filled-select-text-field-active-indicator-height, 1px);--_text-field-container-color: var(--md-filled-select-text-field-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_text-field-disabled-active-indicator-color: var(--md-filled-select-text-field-disabled-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-active-indicator-height: var(--md-filled-select-text-field-disabled-active-indicator-height, 1px);--_text-field-disabled-active-indicator-opacity: var(--md-filled-select-text-field-disabled-active-indicator-opacity, 0.38);--_text-field-disabled-container-color: var(--md-filled-select-text-field-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-container-opacity: var(--md-filled-select-text-field-disabled-container-opacity, 0.04);--_text-field-disabled-input-text-color: var(--md-filled-select-text-field-disabled-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-input-text-opacity: var(--md-filled-select-text-field-disabled-input-text-opacity, 0.38);--_text-field-disabled-label-text-color: var(--md-filled-select-text-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-label-text-opacity: var(--md-filled-select-text-field-disabled-label-text-opacity, 0.38);--_text-field-disabled-leading-icon-color: var(--md-filled-select-text-field-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-leading-icon-opacity: var(--md-filled-select-text-field-disabled-leading-icon-opacity, 0.38);--_text-field-disabled-supporting-text-color: var(--md-filled-select-text-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-supporting-text-opacity: var(--md-filled-select-text-field-disabled-supporting-text-opacity, 0.38);--_text-field-disabled-trailing-icon-color: var(--md-filled-select-text-field-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-trailing-icon-opacity: var(--md-filled-select-text-field-disabled-trailing-icon-opacity, 0.38);--_text-field-error-active-indicator-color: var(--md-filled-select-text-field-error-active-indicator-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-active-indicator-color: var(--md-filled-select-text-field-error-focus-active-indicator-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-input-text-color: var(--md-filled-select-text-field-error-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-focus-label-text-color: var(--md-filled-select-text-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-leading-icon-color: var(--md-filled-select-text-field-error-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-focus-supporting-text-color: var(--md-filled-select-text-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-trailing-icon-color: var(--md-filled-select-text-field-error-focus-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_text-field-error-hover-active-indicator-color: var(--md-filled-select-text-field-error-hover-active-indicator-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-hover-input-text-color: var(--md-filled-select-text-field-error-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-hover-label-text-color: var(--md-filled-select-text-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-hover-leading-icon-color: var(--md-filled-select-text-field-error-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-hover-state-layer-color: var(--md-filled-select-text-field-error-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-hover-state-layer-opacity: var(--md-filled-select-text-field-error-hover-state-layer-opacity, 0.08);--_text-field-error-hover-supporting-text-color: var(--md-filled-select-text-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-hover-trailing-icon-color: var(--md-filled-select-text-field-error-hover-trailing-icon-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-input-text-color: var(--md-filled-select-text-field-error-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-label-text-color: var(--md-filled-select-text-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-leading-icon-color: var(--md-filled-select-text-field-error-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-supporting-text-color: var(--md-filled-select-text-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-trailing-icon-color: var(--md-filled-select-text-field-error-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_text-field-focus-active-indicator-color: var(--md-filled-select-text-field-focus-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_text-field-focus-active-indicator-height: var(--md-filled-select-text-field-focus-active-indicator-height, 3px);--_text-field-focus-input-text-color: var(--md-filled-select-text-field-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-focus-label-text-color: var(--md-filled-select-text-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_text-field-focus-leading-icon-color: var(--md-filled-select-text-field-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-focus-supporting-text-color: var(--md-filled-select-text-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-focus-trailing-icon-color: var(--md-filled-select-text-field-focus-trailing-icon-color, var(--md-sys-color-primary, #6750a4));--_text-field-hover-active-indicator-color: var(--md-filled-select-text-field-hover-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-active-indicator-height: var(--md-filled-select-text-field-hover-active-indicator-height, 1px);--_text-field-hover-input-text-color: var(--md-filled-select-text-field-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-label-text-color: var(--md-filled-select-text-field-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-leading-icon-color: var(--md-filled-select-text-field-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-hover-state-layer-color: var(--md-filled-select-text-field-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-state-layer-opacity: var(--md-filled-select-text-field-hover-state-layer-opacity, 0.08);--_text-field-hover-supporting-text-color: var(--md-filled-select-text-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-hover-trailing-icon-color: var(--md-filled-select-text-field-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-input-text-color: var(--md-filled-select-text-field-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-input-text-font: var(--md-filled-select-text-field-input-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-input-text-line-height: var(--md-filled-select-text-field-input-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_text-field-input-text-size: var(--md-filled-select-text-field-input-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_text-field-input-text-weight: var(--md-filled-select-text-field-input-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-label-text-color: var(--md-filled-select-text-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-label-text-font: var(--md-filled-select-text-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-label-text-line-height: var(--md-filled-select-text-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_text-field-label-text-populated-line-height: var(--md-filled-select-text-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_text-field-label-text-populated-size: var(--md-filled-select-text-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_text-field-label-text-size: var(--md-filled-select-text-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_text-field-label-text-weight: var(--md-filled-select-text-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-leading-icon-color: var(--md-filled-select-text-field-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-leading-icon-size: var(--md-filled-select-text-field-leading-icon-size, 24px);--_text-field-supporting-text-color: var(--md-filled-select-text-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-supporting-text-font: var(--md-filled-select-text-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-supporting-text-line-height: var(--md-filled-select-text-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_text-field-supporting-text-size: var(--md-filled-select-text-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_text-field-supporting-text-weight: var(--md-filled-select-text-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-trailing-icon-color: var(--md-filled-select-text-field-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-trailing-icon-size: var(--md-filled-select-text-field-trailing-icon-size, 24px);--_text-field-container-shape-start-start: var(--md-filled-select-text-field-container-shape-start-start, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_text-field-container-shape-start-end: var(--md-filled-select-text-field-container-shape-start-end, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_text-field-container-shape-end-end: var(--md-filled-select-text-field-container-shape-end-end, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_text-field-container-shape-end-start: var(--md-filled-select-text-field-container-shape-end-start, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--md-filled-field-active-indicator-color: var(--_text-field-active-indicator-color);--md-filled-field-active-indicator-height: var(--_text-field-active-indicator-height);--md-filled-field-container-color: var(--_text-field-container-color);--md-filled-field-container-shape-end-end: var(--_text-field-container-shape-end-end);--md-filled-field-container-shape-end-start: var(--_text-field-container-shape-end-start);--md-filled-field-container-shape-start-end: var(--_text-field-container-shape-start-end);--md-filled-field-container-shape-start-start: var(--_text-field-container-shape-start-start);--md-filled-field-content-color: var(--_text-field-input-text-color);--md-filled-field-content-font: var(--_text-field-input-text-font);--md-filled-field-content-line-height: var(--_text-field-input-text-line-height);--md-filled-field-content-size: var(--_text-field-input-text-size);--md-filled-field-content-weight: var(--_text-field-input-text-weight);--md-filled-field-disabled-active-indicator-color: var(--_text-field-disabled-active-indicator-color);--md-filled-field-disabled-active-indicator-height: var(--_text-field-disabled-active-indicator-height);--md-filled-field-disabled-active-indicator-opacity: var(--_text-field-disabled-active-indicator-opacity);--md-filled-field-disabled-container-color: var(--_text-field-disabled-container-color);--md-filled-field-disabled-container-opacity: var(--_text-field-disabled-container-opacity);--md-filled-field-disabled-content-color: var(--_text-field-disabled-input-text-color);--md-filled-field-disabled-content-opacity: var(--_text-field-disabled-input-text-opacity);--md-filled-field-disabled-label-text-color: var(--_text-field-disabled-label-text-color);--md-filled-field-disabled-label-text-opacity: var(--_text-field-disabled-label-text-opacity);--md-filled-field-disabled-leading-content-color: var(--_text-field-disabled-leading-icon-color);--md-filled-field-disabled-leading-content-opacity: var(--_text-field-disabled-leading-icon-opacity);--md-filled-field-disabled-supporting-text-color: var(--_text-field-disabled-supporting-text-color);--md-filled-field-disabled-supporting-text-opacity: var(--_text-field-disabled-supporting-text-opacity);--md-filled-field-disabled-trailing-content-color: var(--_text-field-disabled-trailing-icon-color);--md-filled-field-disabled-trailing-content-opacity: var(--_text-field-disabled-trailing-icon-opacity);--md-filled-field-error-active-indicator-color: var(--_text-field-error-active-indicator-color);--md-filled-field-error-content-color: var(--_text-field-error-input-text-color);--md-filled-field-error-focus-active-indicator-color: var(--_text-field-error-focus-active-indicator-color);--md-filled-field-error-focus-content-color: var(--_text-field-error-focus-input-text-color);--md-filled-field-error-focus-label-text-color: var(--_text-field-error-focus-label-text-color);--md-filled-field-error-focus-leading-content-color: var(--_text-field-error-focus-leading-icon-color);--md-filled-field-error-focus-supporting-text-color: var(--_text-field-error-focus-supporting-text-color);--md-filled-field-error-focus-trailing-content-color: var(--_text-field-error-focus-trailing-icon-color);--md-filled-field-error-hover-active-indicator-color: var(--_text-field-error-hover-active-indicator-color);--md-filled-field-error-hover-content-color: var(--_text-field-error-hover-input-text-color);--md-filled-field-error-hover-label-text-color: var(--_text-field-error-hover-label-text-color);--md-filled-field-error-hover-leading-content-color: var(--_text-field-error-hover-leading-icon-color);--md-filled-field-error-hover-state-layer-color: var(--_text-field-error-hover-state-layer-color);--md-filled-field-error-hover-state-layer-opacity: var(--_text-field-error-hover-state-layer-opacity);--md-filled-field-error-hover-supporting-text-color: var(--_text-field-error-hover-supporting-text-color);--md-filled-field-error-hover-trailing-content-color: var(--_text-field-error-hover-trailing-icon-color);--md-filled-field-error-label-text-color: var(--_text-field-error-label-text-color);--md-filled-field-error-leading-content-color: var(--_text-field-error-leading-icon-color);--md-filled-field-error-supporting-text-color: var(--_text-field-error-supporting-text-color);--md-filled-field-error-trailing-content-color: var(--_text-field-error-trailing-icon-color);--md-filled-field-focus-active-indicator-color: var(--_text-field-focus-active-indicator-color);--md-filled-field-focus-active-indicator-height: var(--_text-field-focus-active-indicator-height);--md-filled-field-focus-content-color: var(--_text-field-focus-input-text-color);--md-filled-field-focus-label-text-color: var(--_text-field-focus-label-text-color);--md-filled-field-focus-leading-content-color: var(--_text-field-focus-leading-icon-color);--md-filled-field-focus-supporting-text-color: var(--_text-field-focus-supporting-text-color);--md-filled-field-focus-trailing-content-color: var(--_text-field-focus-trailing-icon-color);--md-filled-field-hover-active-indicator-color: var(--_text-field-hover-active-indicator-color);--md-filled-field-hover-active-indicator-height: var(--_text-field-hover-active-indicator-height);--md-filled-field-hover-content-color: var(--_text-field-hover-input-text-color);--md-filled-field-hover-label-text-color: var(--_text-field-hover-label-text-color);--md-filled-field-hover-leading-content-color: var(--_text-field-hover-leading-icon-color);--md-filled-field-hover-state-layer-color: var(--_text-field-hover-state-layer-color);--md-filled-field-hover-state-layer-opacity: var(--_text-field-hover-state-layer-opacity);--md-filled-field-hover-supporting-text-color: var(--_text-field-hover-supporting-text-color);--md-filled-field-hover-trailing-content-color: var(--_text-field-hover-trailing-icon-color);--md-filled-field-label-text-color: var(--_text-field-label-text-color);--md-filled-field-label-text-font: var(--_text-field-label-text-font);--md-filled-field-label-text-line-height: var(--_text-field-label-text-line-height);--md-filled-field-label-text-populated-line-height: var(--_text-field-label-text-populated-line-height);--md-filled-field-label-text-populated-size: var(--_text-field-label-text-populated-size);--md-filled-field-label-text-size: var(--_text-field-label-text-size);--md-filled-field-label-text-weight: var(--_text-field-label-text-weight);--md-filled-field-leading-content-color: var(--_text-field-leading-icon-color);--md-filled-field-supporting-text-color: var(--_text-field-supporting-text-color);--md-filled-field-supporting-text-font: var(--_text-field-supporting-text-font);--md-filled-field-supporting-text-line-height: var(--_text-field-supporting-text-line-height);--md-filled-field-supporting-text-size: var(--_text-field-supporting-text-size);--md-filled-field-supporting-text-weight: var(--_text-field-supporting-text-weight);--md-filled-field-trailing-content-color: var(--_text-field-trailing-icon-color)}[has-start] .icon.leading{font-size:var(--_text-field-leading-icon-size);height:var(--_text-field-leading-icon-size);width:var(--_text-field-leading-icon-size)}.icon.trailing{font-size:var(--_text-field-trailing-icon-size);height:var(--_text-field-trailing-icon-size);width:var(--_text-field-trailing-icon-size)}
`;let UA=class extends MA{};UA.styles=[gS,FA],UA=zg([Dc("md-filled-select")],UA);class BA{constructor(){this.libraries=new Map}_getPath(e){const t=this._getLibRoot();return t?t+e:null}getLibrary(e){if(!this.libraries.has(e)){const t=(e.checkPresent&&e.checkPresent()?Promise.resolve():this._loadScript(this._getPath(e.src))).then((()=>e.configureCallback?e.configureCallback():void 0));this.libraries.set(e,t)}return this.libraries.get(e)}_getLibRoot(){return window.STATIC_RESOURCE_PATH?window.STATIC_RESOURCE_PATH+"/":"/"}_loadScript(e){return new Promise(((t,i)=>{const r=document.createElement("script");if(!e)return void i(new Error("Unable to load blank script url."));const o=setTimeout((()=>i(new Error(`Timeout loading script: ${e}`))),2e3);r.setAttribute("crossorigin","anonymous"),r.setAttribute("src",e),r.onload=e=>{clearTimeout(o),t(e)},r.onerror=e=>{clearTimeout(o),i(e)},document.head.appendChild(r)}))}}const HA={src:"bower_components/resemblejs/resemble.js",checkPresent:()=>void 0!==window.resemble,configureCallback:()=>(window.resemble.outputSettings({errorColor:{red:255,green:0,blue:255},errorType:"flat",transparency:0,largeImageThreshold:0}),window.resemble)};var jA,GA=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let zA=jA=class extends Ic{constructor(){super(...arguments),this.baseUrl="",this.revisionUrl="",this.automaticBlink=!1,this.baseSelected=!1,this.scaledSelected=!0,this.followMouse=!1,this.scale=1,this.checkerboardSelected=!0,this.backgroundColor="",this.automaticBlinkShown=!1,this.zoomedImageStyle={},this.imageSize={width:0,height:0},this.magnifierSize={width:0,height:0},this.magnifierFrame={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.overviewFrame={origin:{x:0,y:0},dimensions:{width:0,height:0}},this.zoomLevels=["fit",1,1.25,1.5,1.75,2],this.grabbing=!1,this.canHighlightDiffs=!1,this.showHighlight=!1,this.ownsMouseDown=!1,this.centerOnDown={x:0,y:0},this.pointerOnDown={x:0,y:0},this.frameConstrainer=new dA,this.resizeObserver=new ResizeObserver((e=>{for(const t of e)t.target===this.imageArea&&(this.magnifierSize={width:t.contentRect.width,height:t.contentRect.height})})),this.colorPickerCallbacks=[this.createColorPickerCallback("#fff"),this.createColorPickerCallback("#000"),this.createColorPickerCallback("#aaa")]}createColorPickerCallback(e){return{color:e,callback:()=>this.pickColor(e)}}static get styles(){return[Jy,Sd`
        :host {
          display: grid;
          grid-template-rows: 1fr auto;
          grid-template-columns: 1fr auto;
          width: 100%;
          height: 100%;
          box-sizing: border-box;
          text-align: initial !important;
          font-size: var(--font-size-normal);
          --image-border-width: 2px;
        }
        .imageArea {
          grid-row-start: 1;
          grid-column-start: 1;
          box-sizing: border-box;
          flex-grow: 1;
          overflow: hidden;
          display: flex;
          flex-direction: column;
          align-items: center;
          margin: var(--spacing-m);
          padding: var(--image-border-width);
          max-height: 100%;
          position: relative;
        }
        #spacer {
          visibility: hidden;
        }
        gr-zoomed-image {
          border: var(--image-border-width) solid;
          margin: calc(-1 * var(--image-border-width));
          box-sizing: content-box;
          position: absolute;
          overflow: hidden;
          cursor: pointer;
        }
        gr-zoomed-image.base {
          border-color: var(--base-image-border-color, rgb(255, 205, 210));
        }
        gr-zoomed-image.revision {
          border-color: var(--revision-image-border-color, rgb(170, 242, 170));
        }
        md-icon[filled] {
          font-variation-settings: 'FILL' 1;
        }
        #automatic-blink-button {
          position: absolute;
          right: var(--spacing-xl);
          bottom: var(--spacing-xl);
          opacity: 0;
          transition: opacity 200ms ease;
          --md-sys-color-primary-container: var(
            --primary-button-background-color
          );
          --md-sys-color-on-primary-container: #ffffff;
          --md-fab-container-shape: 50px;
        }
        #automatic-blink-button.show,
        #automatic-blink-button:focus-visible {
          opacity: 1;
        }
        .checkerboard {
          --square-size: var(--checkerboard-square-size, 10px);
          --square-color: var(--checkerboard-square-color, #808080);
          background-color: var(--checkerboard-background-color, #aaaaaa);
          background-image: linear-gradient(
              45deg,
              var(--square-color) 25%,
              transparent 25%
            ),
            linear-gradient(-45deg, var(--square-color) 25%, transparent 25%),
            linear-gradient(45deg, transparent 75%, var(--square-color) 75%),
            linear-gradient(-45deg, transparent 75%, var(--square-color) 75%);
          background-size: calc(var(--square-size) * 2)
            calc(var(--square-size) * 2);
          background-position: 0 0, 0 var(--square-size),
            var(--square-size) calc(-1 * var(--square-size)),
            calc(-1 * var(--square-size)) 0;
        }
        .dimensions {
          grid-row-start: 2;
          justify-self: center;
          align-self: center;
          background: var(--primary-button-background-color);
          color: var(--primary-button-text-color);
          font-family: var(--font-family);
          font-size: var(--font-size-small);
          line-height: var(--line-height-small);
          border-radius: var(--border-radius, 4px);
          margin: var(--spacing-s);
          padding: var(--spacing-xxs) var(--spacing-s);
        }
        .controls {
          font-family: var(--header-font-family);
          box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
            0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
          grid-column-start: 2;
          flex-grow: 0;
          display: flex;
          flex-direction: column;
          align-self: flex-start;
          margin: var(--spacing-m);
          padding-bottom: var(--spacing-xl);
          --md-sys-color-surface-container-highest: var(
            --card-surface-container-highest
          );
        }
        md-text-button {
          padding: var(--spacing-m);
          font: var(--image-diff-button-font);
          text-transform: var(--image-diff-button-text-transform, uppercase);
          outline: 1px solid transparent;
          border: 1px solid var(--primary-button-background-color);
          --md-text-button-container-shape: 0;
        }
        md-text-button.unelevated {
          background-color: var(--primary-button-background-color);
          --md-sys-color-primary: var(--primary-button-text-color);
        }
        md-text-button.outlined {
          --md-sys-color-primary: var(--primary-button-background-color);
        }
        #version-switcher {
          display: flex;
          align-items: center;
          margin: var(--spacing-xl) var(--spacing-xl) var(--spacing-m);
          /* Start a stacking context to contain FAB below. */
          z-index: 0;
        }
        #version-switcher md-text-button {
          flex-grow: 1;
          margin: 0;
          /*
            The floating action button below overlaps part of the version buttons.
            This min-width ensures the button text still appears somewhat balanced.
          */
          min-width: 7rem;
        }
        #version-switcher md-fab {
          /* Round button overlaps Base and Revision buttons. */
          z-index: 1;
          margin: 0 -12px;
          /* Styled as an outlined button. */
          color: var(--primary-button-background-color);
          border: 1px solid var(--primary-button-background-color);
          border-radius: 50%;
          box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
            0 1px 5px 0 rgba(0, 0, 0, 0.12);
          --md-sys-color-primary-container: var(--primary-background-color);
          --md-sys-color-on-primary-container: var(
            --primary-button-background-color
          );
          --md-fab-container-shape: 50px;
          --md-fab-container-height: 40px;
          --md-fab-container-width: 40px;
        }
        #version-explanation {
          color: var(--deemphasized-text-color);
          text-align: center;
          margin: var(--spacing-xl) var(--spacing-xl) var(--spacing-m);
        }
        #highlight-changes {
          margin: var(--spacing-m) var(--spacing-xl);
        }
        gr-overview-image {
          min-width: 200px;
          min-height: 150px;
          margin-top: var(--spacing-m);
        }
        #zoom-control {
          margin: var(--spacing-m) var(--spacing-xl) 0;
        }
        md-filled-select::part(field) {
          cursor: pointer;
        }
        md-filled-select {
          --md-sys-color-surface-container: var(--select-surface-container);
          --md-sys-color-surface-container-highest: var(
            --select-surface-container-highest
          );
          --md-sys-color-on-surface: var(--select-on-surface);
          --md-sys-color-on-surface-variant: var(--select-on-surface-variant);
          --md-sys-color-primary: var(--select-primary);
          --md-sys-color-secondary-container: var(--select-secondary-container);
          --md-sys-color-on-secondary-container: var(
            --select-on-secondary-container
          );
        }
        #follow-mouse {
          margin: var(--spacing-m) var(--spacing-xl);
        }
        .color-picker {
          margin: var(--spacing-m) var(--spacing-xl) 0;
        }
        .color-picker .label {
          margin-bottom: var(--spacing-s);
        }
        .color-picker .options {
          display: flex;
          /* Ignore selection border for alignment, for visual balance. */
          margin-left: -3px;
        }
        .color-picker-button {
          border-width: 2px;
          border-style: solid;
          border-color: transparent;
          border-radius: 50%;
          width: 24px;
          height: 24px;
          padding: 1px;
        }
        .color-picker-button.selected {
          border-color: var(--primary-button-background-color);
        }
        .color-picker-button:focus-within:not(.selected) {
          /* Not an actual outline, as those do not follow border-radius. */
          border-color: var(--outline-color-focus);
        }
        .color-picker-button .color {
          display: flex;
          border: 1px solid var(--border-color);
          border-radius: 50%;
          width: 100%;
          height: 100%;
          box-sizing: border-box;
        }
        #source-plus-highlight-container {
          position: relative;
        }
        #source-plus-highlight-container img {
          position: absolute;
          top: 0;
          left: 0;
        }
        .highlight-changes,
        .follow-mouse {
          display: flex;
          align-items: center;
        }
      `]}renderColorPickerButton(e,t){const i=e===this.backgroundColor&&!this.checkerboardSelected;return dc`
      <div
        class=${th({"color-picker-button":!0,selected:i})}
      >
        <md-icon-button
          class="color"
          touch-target="none"
          style=${Bm({backgroundColor:e})}
          @click=${t}
        ></md-icon-button>
      </div>
    `}renderCheckerboardButton(){return dc`
      <div
        class=${th({"color-picker-button":!0,selected:this.checkerboardSelected})}
      >
        <md-icon-button
          class="color checkerboard"
          touch-target="none"
          @click=${this.pickCheckerboard}
        ></md-icon-button>
      </div>
    `}render(){const e=this.baseSelected?this.baseUrl:this.revisionUrl,t=dc`
      <img
        id="source-image"
        src=${e}
        class=${th({checkerboard:this.checkerboardSelected})}
        style=${Bm({backgroundColor:this.checkerboardSelected?"":this.backgroundColor})}
        @load=${this.updateSizes}
      />
    `,i=dc`
      <div id="source-plus-highlight-container">
        ${t}
        <img
          id="highlight-image"
          style=${Bm({opacity:this.showHighlight?"1":"0","pointer-events":this.showHighlight?"auto":"none"})}
          src=${Vw(this.diffHighlightSrc)}
        />
      </div>
    `,r=dc`
      <div id="version-explanation">
        This file is being ${this.revisionUrl?"added":"deleted"}.
      </div>
    `,o={left:!0,unelevated:this.baseSelected,outlined:!this.baseSelected},s={right:!0,unelevated:!this.baseSelected,outlined:this.baseSelected},n=dc`
      <div id="version-switcher">
        <md-text-button
          class=${th(o)}
          touch-target="none"
          @click=${this.selectBase}
        >
          Base
        </md-text-button>
        <md-fab
          mini
          title=${this.baseSelected?"switch to Revision version":"switch to Base version"}
          variant="primary"
          touch-target="none"
          @click=${this.manualBlink}
        >
          <md-icon slot="icon" filled>swap_horiz</md-icon>
        </md-fab>
        <md-text-button
          class=${th(s)}
          touch-target="none"
          @click=${this.selectRevision}
        >
          Revision
        </md-text-button>
      </div>
    `,a=dc`
      ${this.baseUrl&&this.revisionUrl?n:r}
    `,l=this.diffHighlightSrc?dc`
          <label class="highlight-changes">
            <md-checkbox
              id="highlight-changes"
              ?checked=${this.showHighlight}
              @change=${this.showHighlightChanged}
            >
            </md-checkbox>
            Highlight differences
          </label>
        `:"",d=dc`
      <gr-overview-image
        .frameRect=${this.overviewFrame}
        @center-updated=${this.onOverviewCenterUpdated}
      >
        <img
          src=${e}
          class=${th({checkerboard:this.checkerboardSelected})}
          style=${Bm({backgroundColor:this.checkerboardSelected?"":this.backgroundColor})}
        />
      </gr-overview-image>
    `,c=dc`
      <md-filled-select
        id="zoom-control"
        label="Zoom"
        @change=${this.zoomControlChanged}
      >
        ${this.zoomLevels.map((e=>dc`
            <md-select-option
              ?selected=${"fit"===e}
              value=${e}
            >
              <div slot="headline">
                ${"fit"===e?"Fit":100*e+"%"}
              </div>
            </md-select-option>
          `))}
      </md-filled-select>
    `,h=dc`
      <label class="follow-mouse">
        <md-checkbox
          id="follow-mouse"
          ?checked=${this.followMouse}
          @change=${this.followMouseChanged}
        >
        </md-checkbox>
        Magnifier follows mouse
      </label>
    `,p=dc`
      <div class="color-picker">
        <div class="label">Background</div>
        <div class="options">
          ${this.renderCheckerboardButton()}
          ${this.colorPickerCallbacks.map((({color:e,callback:t})=>this.renderColorPickerButton(e,t)))}
        </div>
      </div>
    `,u=Math.max(this.scale,1),g=this.imageSize.width*u,m=this.imageSize.height*u,f=dc`
      <div
        id="spacer"
        style=${Bm({width:`${g}px`,height:`${m}px`})}
      ></div>
    `,v=dc`
      <md-fab
        id="automatic-blink-button"
        class=${th({show:this.automaticBlinkShown})}
        title="Automatic blink"
        variant="primary"
        touch-target="none"
        @click=${this.toggleAutomaticBlink}
      >
        <md-icon slot="icon" filled
          >${this.automaticBlink?"pause":"play_arrow"}</md-icon
        >
      </md-fab>
    `;return dc`
      <div
        class="imageArea"
        @mousemove=${this.mousemoveImageArea}
        @mouseleave=${this.mouseleaveImageArea}
      >
        <gr-zoomed-image
          class=${th({base:this.baseSelected,revision:!this.baseSelected})}
          style=${Bm({...this.zoomedImageStyle,cursor:this.grabbing?"grabbing":"pointer"})}
          .scale=${this.scale}
          .frameRect=${this.magnifierFrame}
          @mousedown=${this.mousedownMagnifier}
          @mouseup=${this.mouseupMagnifier}
          @mousemove=${this.mousemoveMagnifier}
          @mouseleave=${this.mouseleaveMagnifier}
          @dragstart=${this.dragstartMagnifier}
        >
          ${i}
        </gr-zoomed-image>
        ${this.baseUrl&&this.revisionUrl?v:""} ${f}
      </div>

      <div class="dimensions">
        ${this.imageSize.width} x ${this.imageSize.height}
      </div>

      <md-filled-card class="controls">
        ${a} ${l} ${d} ${c}
        ${this.scaledSelected?"":h} ${p}
      </md-filled-card>
    `}firstUpdated(){this.resizeObserver.observe(this.imageArea,{box:"content-box"}),jA.libLoader.getLibrary(HA).then((()=>{this.canHighlightDiffs=!0,this.computeDiffImage()}))}update(e){this.baseUrl||(this.baseSelected=!1),this.revisionUrl||(this.baseSelected=!0),this.updateSizes(),super.update(e)}updated(e){(e.has("baseUrl")&&this.baseSelected||e.has("revisionUrl")&&!this.baseSelected)&&this.frameConstrainer.requestCenter({x:0,y:0}),e.has("automaticBlink")&&this.updateAutomaticBlink(),this.canHighlightDiffs&&(e.has("baseUrl")||e.has("revisionUrl"))&&this.computeDiffImage()}computeDiffImage(){this.baseUrl&&this.revisionUrl&&window.resemble(this.baseUrl).compareTo(this.revisionUrl).ignoreNothing().onComplete((e=>{this.diffHighlightSrc=e.getImageDataUrl()}))}fireAction(e){Jn(this,"image-diff-action",e)}selectBase(){this.baseUrl&&(this.baseSelected=!0,this.fireAction({type:"version-switcher-clicked",button:"base"}))}selectRevision(){this.revisionUrl&&(this.baseSelected=!1,this.fireAction({type:"version-switcher-clicked",button:"revision"}))}manualBlink(){this.toggleImage(),this.fireAction({type:"version-switcher-clicked",button:"switch"})}toggleImage(){this.baseUrl&&this.revisionUrl&&(this.baseSelected=!this.baseSelected)}toggleAutomaticBlink(){this.automaticBlink=!this.automaticBlink,this.fireAction({type:"automatic-blink-changed",value:this.automaticBlink})}updateAutomaticBlink(){this.automaticBlink?(this.toggleImage(),this.setBlinkInterval()):this.clearBlinkInterval()}setBlinkInterval(){this.clearBlinkInterval(),this.automaticBlinkTimer=setInterval((()=>{this.toggleImage()}),1e3)}clearBlinkInterval(){this.automaticBlinkTimer&&(clearInterval(this.automaticBlinkTimer),this.automaticBlinkTimer=void 0)}showHighlightChanged(){this.toggleHighlight("controls")}toggleHighlight(e){this.showHighlight=!this.showHighlight,this.fireAction({type:"highlight-changes-changed",value:this.showHighlight,source:e})}zoomControlChanged(e){const t=e.target.value;if(!t)return;"fit"===t&&(this.scaledSelected=!0,this.fireAction({type:"zoom-level-changed",scale:"fit"}));const i=Number(t);Number.isFinite(i)&&i>0&&(this.scaledSelected=!1,this.scale=i,this.fireAction({type:"zoom-level-changed",scale:i})),this.updateSizes()}followMouseChanged(){this.followMouse=!this.followMouse,this.fireAction({type:"follow-mouse-changed",value:this.followMouse})}pickColor(e){this.checkerboardSelected=!1,this.backgroundColor=e,this.fireAction({type:"background-color-changed",value:e})}pickCheckerboard(){this.checkerboardSelected=!0,this.fireAction({type:"background-color-changed",value:"checkerboard"})}mousemoveImageArea(e){this.automaticBlinkButton&&this.updateAutomaticBlinkVisibility(e),this.mousemoveMagnifier(e)}updateAutomaticBlinkVisibility(e){const t=this.automaticBlinkButton.getBoundingClientRect(),i=t.left+(t.right-t.left)/2,r=t.top+(t.bottom-t.top)/2,o=Math.abs(i-e.clientX),s=Math.abs(r-e.clientY);this.automaticBlinkShown=o<350&&s<350}mouseleaveImageArea(){this.automaticBlinkShown=!1}mousedownMagnifier(e){1===e.buttons&&(this.ownsMouseDown=!0,this.centerOnDown=this.frameConstrainer.getCenter(),this.pointerOnDown={x:e.clientX,y:e.clientY})}mouseupMagnifier(e){if(!this.ownsMouseDown)return;if(this.grabbing=!1,this.ownsMouseDown=!1,e.shiftKey&&this.diffHighlightSrc)return void this.toggleHighlight("magnifier");const t=e.clientX-this.pointerOnDown.x,i=e.clientY-this.pointerOnDown.y;Math.max(Math.abs(t),Math.abs(i))<5?(this.toggleImage(),this.fireAction({type:"magnifier-clicked"})):this.fireAction({type:"magnifier-dragged"})}mousemoveMagnifier(e){1===e.buttons&&this.ownsMouseDown?this.handleMagnifierDrag(e):this.followMouse&&this.handleFollowMouse(e)}handleMagnifierDrag(e){this.grabbing=!0;const t=e.clientX-this.pointerOnDown.x,i=e.clientY-this.pointerOnDown.y;this.frameConstrainer.requestCenter({x:this.centerOnDown.x-t/this.scale,y:this.centerOnDown.y-i/this.scale}),this.updateFrames()}handleFollowMouse(e){const t=this.imageArea.getBoundingClientRect(),i=e.clientX-t.left,r=e.clientY-t.top,o=i/t.width,s=r/t.height;this.frameConstrainer.requestCenter({x:this.imageSize.width*o,y:this.imageSize.height*s}),this.updateFrames()}mouseleaveMagnifier(){this.ownsMouseDown&&(this.grabbing=!1,this.ownsMouseDown=!1,this.fireAction({type:"magnifier-dragged"}))}dragstartMagnifier(e){e.preventDefault()}onOverviewCenterUpdated(e){this.frameConstrainer.requestCenter({x:e.detail.x,y:e.detail.y}),this.updateFrames()}updateFrames(){this.magnifierFrame=this.frameConstrainer.getUnscaledFrame(),this.overviewFrame=this.frameConstrainer.getScaledFrame()}updateSizes(){if(!this.sourceImage||!this.sourceImage.complete)return;if(this.imageSize={width:this.sourceImage.naturalWidth||0,height:this.sourceImage.naturalHeight||0},this.frameConstrainer.setBounds(this.imageSize),this.scaledSelected){const e=aA(this.imageSize,this.magnifierSize);this.scale=Math.min(e.scale,1)}this.frameConstrainer.setScale(this.scale);const e={width:this.imageSize.width*this.scale,height:this.imageSize.height*this.scale},t=Math.min(this.magnifierSize.width,e.width),i=Math.min(this.magnifierSize.height,e.height);this.frameConstrainer.setFrameSize({width:t,height:i}),this.updateFrames(),this.zoomedImageStyle={...this.zoomedImageStyle,width:`${t}px`,height:`${i}px`}}};zA.libLoader=new BA,GA([Fc({type:String})],zA.prototype,"baseUrl",void 0),GA([Fc({type:String})],zA.prototype,"revisionUrl",void 0),GA([Fc({type:Boolean})],zA.prototype,"automaticBlink",void 0),GA([Uc()],zA.prototype,"baseSelected",void 0),GA([Uc()],zA.prototype,"scaledSelected",void 0),GA([Uc()],zA.prototype,"followMouse",void 0),GA([Uc()],zA.prototype,"scale",void 0),GA([Uc()],zA.prototype,"checkerboardSelected",void 0),GA([Uc()],zA.prototype,"backgroundColor",void 0),GA([Uc()],zA.prototype,"automaticBlinkShown",void 0),GA([Uc()],zA.prototype,"zoomedImageStyle",void 0),GA([Hc(".imageArea")],zA.prototype,"imageArea",void 0),GA([Hc("gr-zoomed-image")],zA.prototype,"zoomedImage",void 0),GA([Hc("#source-image")],zA.prototype,"sourceImage",void 0),GA([Hc("#automatic-blink-button")],zA.prototype,"automaticBlinkButton",void 0),GA([Uc()],zA.prototype,"magnifierSize",void 0),GA([Uc()],zA.prototype,"magnifierFrame",void 0),GA([Uc()],zA.prototype,"overviewFrame",void 0),GA([Uc()],zA.prototype,"grabbing",void 0),GA([Uc()],zA.prototype,"canHighlightDiffs",void 0),GA([Uc()],zA.prototype,"diffHighlightSrc",void 0),GA([Uc()],zA.prototype,"showHighlight",void 0),zA=jA=GA([Dc("gr-image-viewer")],zA);var VA=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const WA=/^image\/(bmp|gif|x-icon|jpeg|jpg|png|tiff|webp)$/;class qA extends Ic{constructor(){super(...arguments),this.automaticBlink=!1,this.columnCount=0}createRenderRoot(){return this}render(){return dc`
      <tbody class="gr-diff image-diff">
        <tr class="gr-diff">
          <td class="gr-diff" colspan=${this.columnCount}>
            <gr-image-viewer
              class="gr-diff"
              .baseUrl=${YA(this.baseImage)}
              .revisionUrl=${YA(this.revisionImage)}
              .automaticBlink=${this.automaticBlink}
            >
            </gr-image-viewer>
          </td>
        </tr>
      </tbody>
    `}}VA([Fc()],qA.prototype,"baseImage",void 0),VA([Fc()],qA.prototype,"revisionImage",void 0),VA([Fc()],qA.prototype,"automaticBlink",void 0),VA([Fc()],qA.prototype,"columnCount",void 0);class KA extends Ic{constructor(){super(...arguments),this.columnCount=0}createRenderRoot(){return this}render(){return dc`
      <tbody class="gr-diff image-diff">
        ${this.renderImagePairRow()} ${this.renderImageLabelRow()}
      </tbody>
      ${this.renderEndpoint()}
    `}renderEndpoint(){return dc`
      <tbody class="gr-diff endpoint">
        <tr class="gr-diff">
          <td class="gr-diff" colspan=${this.columnCount}>
            <gr-endpoint-decorator class="gr-diff" name="image-diff">
              ${this.renderEndpointParam("baseImage",this.baseImage)}
              ${this.renderEndpointParam("revisionImage",this.revisionImage)}
            </gr-endpoint-decorator>
          </td>
        </tr>
      </tbody>
    `}renderEndpointParam(e,t){return t?dc`
      <gr-endpoint-param class="gr-diff" name=${e} .value=${t}>
      </gr-endpoint-param>
    `:uc}renderImagePairRow(){return dc`
      <tr class="gr-diff">
        <td class="gr-diff left lineNum blank"></td>
        <td class="gr-diff left">${this.renderImage($u.LEFT)}</td>
        <td class="gr-diff right lineNum blank"></td>
        <td class="gr-diff right">${this.renderImage($u.RIGHT)}</td>
      </tr>
    `}renderImage(e){const t=e===$u.LEFT?this.baseImage:this.revisionImage;if(!t)return uc;const i=e===$u.LEFT?this.baseError:this.revisionError;if(i)return i;const r=YA(t);return r?dc`
      <img
        class="gr-diff ${e}"
        src=${r}
        @load=${this.handleLoad}
        @error=${t=>this.handleError(t,e)}
      >
      </img>
    `:uc}handleLoad(){this.requestUpdate()}handleError(e,t){const i=`[Image failed to load] ${e.type}`;t===$u.LEFT&&(this.baseError=i),t===$u.RIGHT&&(this.revisionError=i)}renderImageLabelRow(){return dc`
      <tr class="gr-diff">
        <td class="gr-diff left lineNum blank"></td>
        <td class="gr-diff left">
          <label class="gr-diff">
            ${this.renderName(this.baseImage?._name??"")}
            <span class="gr-diff label">${this.imageLabel($u.LEFT)}</span>
          </label>
        </td>
        <td class="gr-diff right lineNum blank"></td>
        <td class="gr-diff right">
          <label class="gr-diff">
            ${this.renderName(this.revisionImage?._name??"")}
            <span class="gr-diff label"> ${this.imageLabel($u.RIGHT)} </span>
          </label>
        </td>
      </tr>
    `}renderName(e){return this.baseImage&&this.revisionImage&&this.baseImage._name!==this.revisionImage._name?dc`
      <span class="gr-diff name">${e}</span><br class="gr-diff" />
    `:uc}imageLabel(e){const t=e===$u.LEFT?this.baseImage:this.revisionImage,i=e===$u.LEFT?this.baseImageEl:this.revisionImageEl;if(t){const e=t.type??t._expectedType;return i?.naturalWidth&&i.naturalHeight?`${i?.naturalWidth}×${i.naturalHeight} ${e}`:e}return"No image"}}function YA(e){return e?.type&&WA.test(e.type)?`data:${e.type};base64,${e.body}`:""}VA([Fc()],KA.prototype,"baseImage",void 0),VA([Fc()],KA.prototype,"revisionImage",void 0),VA([Fc()],KA.prototype,"columnCount",void 0),VA([Hc("img.left")],KA.prototype,"baseImageEl",void 0),VA([Hc("img.right")],KA.prototype,"revisionImageEl",void 0),VA([Uc()],KA.prototype,"baseError",void 0),VA([Uc()],KA.prototype,"revisionError",void 0),customElements.define("gr-diff-image-new",qA),customElements.define("gr-diff-image-old",KA);class XA{constructor(e,t=0,i=0){this.type=e,this.beforeNumber=t,this.afterNumber=i,this.hasIntralineInfo=!1,this.highlights=[],this.text=""}lineNumber(e){return e===$u.LEFT?this.beforeNumber:this.afterNumber}}XA.Type=Iu,XA.File=Au;const JA=new XA(Iu.BLANK);var QA;function ZA(e,t,i,r){if(0===e.length)return[];t=Math.max(t,0),i=Math.max(i,t),r=Math.max(r??i,t);let o=[],s=e,n=[];if(i-t>3&&r-t>3){if(t&&([o,s]=tR(s,t,t)),i&&r){let e=0,t=0;if(o.length>0){const i=o[0].lineRange.left.start_line;e=o[o.length-1].lineRange.left.end_line-i+1;const r=o[0].lineRange.right.start_line;t=o[o.length-1].lineRange.right.end_line-r+1}[s,n]=tR(s,i-e,r-t)}}else[s,n]=[[],s];const a=[...o];return s.length&&a.push(new iR({type:QA.CONTEXT_CONTROL,contextGroups:[...s]})),a.push(...n),a}function eR(e,t,i){let r,o;if(e.skip)t-e.lineRange.left.start_line<e.lineRange.right.end_line-t?o=e:r=e;else{const s=[],n=[];for(const r of e.lines)r.beforeNumber&&"number"==typeof r.beforeNumber&&r.beforeNumber<t||r.afterNumber&&"number"==typeof r.afterNumber&&r.afterNumber<i?s.push(r):n.push(r);s.length&&(r=s.length===e.lines.length?e:e.cloneWithLines(s)),n.length&&(o=n.length===e.lines.length?e:e.cloneWithLines(n))}return{beforeSplit:r,afterSplit:o}}function tR(e,t,i){if(0===e.length)return[[],[]];const r=e[0].lineRange.left.start_line+t,o=e[0].lineRange.right.start_line+i;let s=!1;const n=[],a=[];for(const t of e)if(s)a.push(t);else if(t.type!==QA.DELTA||t.ignoredWhitespaceOnly){const e=t.lineRange.left.end_line<r||t.lineRange.right.end_line<o,i=r<=t.lineRange.left.start_line||o<=t.lineRange.right.start_line;if(e)n.push(t);else if(i)a.push(t);else{const{beforeSplit:e,afterSplit:i}=eR(t,r,o);e&&n.push(e),i&&a.push(i),s=!0}}else n.push(t);return[n,a]}!function(e){e.BOTH="both",e.CONTEXT_CONTROL="contextControl",e.DELTA="delta"}(QA||(QA={}));class iR{constructor(e){switch(this.dueToRebase=!1,this.ignoredWhitespaceOnly=!1,this.keyLocation=!1,this.lines=[],this.adds=[],this.removes=[],this.contextGroups=[],this.lineRange={[$u.LEFT]:{start_line:0,end_line:0},[$u.RIGHT]:{start_line:0,end_line:0}},this.type=e.type,e.type){case QA.BOTH:case QA.DELTA:if(this.moveDetails=e.moveDetails,this.dueToRebase=e.dueToRebase??!1,this.ignoredWhitespaceOnly=e.ignoredWhitespaceOnly??!1,this.keyLocation=e.keyLocation??!1,e.skip&&e.lines)throw new Error("Cannot set skip and lines");if(this.skip=e.skip,void 0!==e.skip)this.lineRange={left:{start_line:e.offsetLeft,end_line:e.offsetLeft+e.skip-1},right:{start_line:e.offsetRight,end_line:e.offsetRight+e.skip-1}};else{ba(e.lines),va(e.lines.length>0,"diff group must have lines");for(const t of e.lines)this.addLine(t)}break;case QA.CONTEXT_CONTROL:if(this.contextGroups=e.contextGroups,this.contextGroups.length>0){const e=this.contextGroups[0],t=this.contextGroups[this.contextGroups.length-1];this.lineRange={left:{start_line:e.lineRange.left.start_line,end_line:t.lineRange.left.end_line},right:{start_line:e.lineRange.right.start_line,end_line:t.lineRange.right.end_line}}}break;default:throw new Error(`Unknown group type: ${this.type}`)}}cloneWithLines(e){if(this.type!==QA.BOTH&&this.type!==QA.DELTA)throw new Error("Cannot clone context group with lines");return new iR({type:this.type,lines:e,dueToRebase:this.dueToRebase,ignoredWhitespaceOnly:this.ignoredWhitespaceOnly})}addLine(e){if(this.lines.push(e),!(this.type!==QA.BOTH&&this.type!==QA.CONTEXT_CONTROL||e.type!==Iu.ADD&&e.type!==Iu.REMOVE))throw Error("Cannot add delta line to a non-delta group.");e.type===Iu.ADD?this.adds.push(e):e.type===Iu.REMOVE&&this.removes.push(e),this._updateRangeWithNewLine(e)}getSideBySidePairs(){if(this.type===QA.BOTH||this.type===QA.CONTEXT_CONTROL)return this.lines.map((e=>({left:e,right:e})));const e=[];let t=0,i=0;for(;t<this.removes.length||i<this.adds.length;)e.push({left:this.removes[t]||JA,right:this.adds[i]||JA}),t++,i++;return e}getUnifiedPairs(){return this.lines.map((e=>{if(e.type===Iu.ADD)return{left:JA,right:e};if(e.type===Iu.REMOVE){if(this.ignoredWhitespaceOnly)return;return{left:e,right:JA}}return{left:e,right:e}})).filter(cf)}hasSkipGroup(){return void 0!==this.skip||this.contextGroups?.some((e=>void 0!==e.skip))}hasNonCommonDeltaGroup(){return this.contextGroups?.some((e=>e.type===QA.DELTA&&!e.ignoredWhitespaceOnly))}containsLine(e,t){if("number"!=typeof t)return this.lines[0]?.beforeNumber===t;const i=this.lineRange[e];return i.start_line<=t&&t<=i.end_line}startLine(e){return this.type===QA.CONTEXT_CONTROL||void 0!==this.skip?e===$u.LEFT?this.lineRange.left.start_line:this.lineRange.right.start_line:this.lines[0].lineNumber(e)}_updateRangeWithNewLine(e){"number"==typeof e.beforeNumber&&"number"==typeof e.afterNumber&&(e.type!==Iu.ADD&&e.type!==Iu.BOTH||((0===this.lineRange.right.start_line||e.afterNumber<this.lineRange.right.start_line)&&(this.lineRange.right.start_line=e.afterNumber),e.afterNumber>this.lineRange.right.end_line&&(this.lineRange.right.end_line=e.afterNumber)),e.type!==Iu.REMOVE&&e.type!==Iu.BOTH||((0===this.lineRange.left.start_line||e.beforeNumber<this.lineRange.left.start_line)&&(this.lineRange.left.start_line=e.beforeNumber),e.beforeNumber>this.lineRange.left.end_line&&(this.lineRange.left.end_line=e.beforeNumber)))}isTotal(){return!(this.type!==QA.DELTA||this.adds.length&&this.removes.length||!this.adds.length&&!this.removes.length)}id(){return`${this.type} ${this.startLine($u.LEFT)}  ${this.startLine($u.RIGHT)}`}}const rR=nn`
<custom-style>
  <style is="custom-style">
    html {

      --shadow-transition: {
        transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1);
      };

      --shadow-none: {
        box-shadow: none;
      };

      /* from http://codepen.io/shyndman/pen/c5394ddf2e8b2a5c9185904b57421cdb */

      --shadow-elevation-2dp: {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
                    0 1px 5px 0 rgba(0, 0, 0, 0.12),
                    0 3px 1px -2px rgba(0, 0, 0, 0.2);
      };

      --shadow-elevation-3dp: {
        box-shadow: 0 3px 4px 0 rgba(0, 0, 0, 0.14),
                    0 1px 8px 0 rgba(0, 0, 0, 0.12),
                    0 3px 3px -2px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-4dp: {
        box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14),
                    0 1px 10px 0 rgba(0, 0, 0, 0.12),
                    0 2px 4px -1px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-6dp: {
        box-shadow: 0 6px 10px 0 rgba(0, 0, 0, 0.14),
                    0 1px 18px 0 rgba(0, 0, 0, 0.12),
                    0 3px 5px -1px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-8dp: {
        box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14),
                    0 3px 14px 2px rgba(0, 0, 0, 0.12),
                    0 5px 5px -3px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-12dp: {
        box-shadow: 0 12px 16px 1px rgba(0, 0, 0, 0.14),
                    0 4px 22px 3px rgba(0, 0, 0, 0.12),
                    0 6px 7px -4px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-16dp: {
        box-shadow: 0 16px 24px 2px rgba(0, 0, 0, 0.14),
                    0  6px 30px 5px rgba(0, 0, 0, 0.12),
                    0  8px 10px -5px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-24dp: {
        box-shadow: 0 24px 38px 3px rgba(0, 0, 0, 0.14),
                    0 9px 46px 8px rgba(0, 0, 0, 0.12),
                    0 11px 15px -7px rgba(0, 0, 0, 0.4);
      };
    }
  </style>
</custom-style>`;rR.setAttribute("style","display: none;"),document.head.appendChild(rR.content);const oR=nn`
<dom-module id="paper-material-styles">
  <template>
    <style>
      html {
        --paper-material: {
          display: block;
          position: relative;
        };
        --paper-material-elevation-1: {
          @apply --shadow-elevation-2dp;
        };
        --paper-material-elevation-2: {
          @apply --shadow-elevation-4dp;
        };
        --paper-material-elevation-3: {
          @apply --shadow-elevation-6dp;
        };
        --paper-material-elevation-4: {
          @apply --shadow-elevation-8dp;
        };
        --paper-material-elevation-5: {
          @apply --shadow-elevation-16dp;
        };
      }
      .paper-material {
        @apply --paper-material;
      }
      .paper-material[elevation="1"] {
        @apply --paper-material-elevation-1;
      }
      .paper-material[elevation="2"] {
        @apply --paper-material-elevation-2;
      }
      .paper-material[elevation="3"] {
        @apply --paper-material-elevation-3;
      }
      .paper-material[elevation="4"] {
        @apply --paper-material-elevation-4;
      }
      .paper-material[elevation="5"] {
        @apply --paper-material-elevation-5;
      }

      /* Duplicate the styles because of https://github.com/webcomponents/shadycss/issues/193 */
      :host {
        --paper-material: {
          display: block;
          position: relative;
        };
        --paper-material-elevation-1: {
          @apply --shadow-elevation-2dp;
        };
        --paper-material-elevation-2: {
          @apply --shadow-elevation-4dp;
        };
        --paper-material-elevation-3: {
          @apply --shadow-elevation-6dp;
        };
        --paper-material-elevation-4: {
          @apply --shadow-elevation-8dp;
        };
        --paper-material-elevation-5: {
          @apply --shadow-elevation-16dp;
        };
      }
      :host(.paper-material) {
        @apply --paper-material;
      }
      :host(.paper-material[elevation="1"]) {
        @apply --paper-material-elevation-1;
      }
      :host(.paper-material[elevation="2"]) {
        @apply --paper-material-elevation-2;
      }
      :host(.paper-material[elevation="3"]) {
        @apply --paper-material-elevation-3;
      }
      :host(.paper-material[elevation="4"]) {
        @apply --paper-material-elevation-4;
      }
      :host(.paper-material[elevation="5"]) {
        @apply --paper-material-elevation-5;
      }
    </style>
  </template>
</dom-module>`;oR.setAttribute("style","display: none;"),document.head.appendChild(oR.content);var sR={distance:function(e,t,i,r){var o=e-i,s=t-r;return Math.sqrt(o*o+s*s)},now:window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now};function nR(e){this.element=e,this.width=this.boundingRect.width,this.height=this.boundingRect.height,this.size=Math.max(this.width,this.height)}function aR(e){this.element=e,this.color=window.getComputedStyle(e).color,this.wave=document.createElement("div"),this.waveContainer=document.createElement("div"),this.wave.style.backgroundColor=this.color,this.wave.classList.add("wave"),this.waveContainer.classList.add("wave-container"),Yr(this.waveContainer).appendChild(this.wave),this.resetInteractionState()}nR.prototype={get boundingRect(){return this.element.getBoundingClientRect()},furthestCornerDistanceFrom:function(e,t){var i=sR.distance(e,t,0,0),r=sR.distance(e,t,this.width,0),o=sR.distance(e,t,0,this.height),s=sR.distance(e,t,this.width,this.height);return Math.max(i,r,o,s)}},aR.MAX_RADIUS=300,aR.prototype={get recenters(){return this.element.recenters},get center(){return this.element.center},get mouseDownElapsed(){var e;return this.mouseDownStart?(e=sR.now()-this.mouseDownStart,this.mouseUpStart&&(e-=this.mouseUpElapsed),e):0},get mouseUpElapsed(){return this.mouseUpStart?sR.now()-this.mouseUpStart:0},get mouseDownElapsedSeconds(){return this.mouseDownElapsed/1e3},get mouseUpElapsedSeconds(){return this.mouseUpElapsed/1e3},get mouseInteractionSeconds(){return this.mouseDownElapsedSeconds+this.mouseUpElapsedSeconds},get initialOpacity(){return this.element.initialOpacity},get opacityDecayVelocity(){return this.element.opacityDecayVelocity},get radius(){var e=this.containerMetrics.width*this.containerMetrics.width,t=this.containerMetrics.height*this.containerMetrics.height,i=1.1*Math.min(Math.sqrt(e+t),aR.MAX_RADIUS)+5,r=1.1-i/aR.MAX_RADIUS*.2,o=this.mouseInteractionSeconds/r,s=i*(1-Math.pow(80,-o));return Math.abs(s)},get opacity(){return this.mouseUpStart?Math.max(0,this.initialOpacity-this.mouseUpElapsedSeconds*this.opacityDecayVelocity):this.initialOpacity},get outerOpacity(){var e=.3*this.mouseUpElapsedSeconds,t=this.opacity;return Math.max(0,Math.min(e,t))},get isOpacityFullyDecayed(){return this.opacity<.01&&this.radius>=Math.min(this.maxRadius,aR.MAX_RADIUS)},get isRestingAtMaxRadius(){return this.opacity>=this.initialOpacity&&this.radius>=Math.min(this.maxRadius,aR.MAX_RADIUS)},get isAnimationComplete(){return this.mouseUpStart?this.isOpacityFullyDecayed:this.isRestingAtMaxRadius},get translationFraction(){return Math.min(1,this.radius/this.containerMetrics.size*2/Math.sqrt(2))},get xNow(){return this.xEnd?this.xStart+this.translationFraction*(this.xEnd-this.xStart):this.xStart},get yNow(){return this.yEnd?this.yStart+this.translationFraction*(this.yEnd-this.yStart):this.yStart},get isMouseDown(){return this.mouseDownStart&&!this.mouseUpStart},resetInteractionState:function(){this.maxRadius=0,this.mouseDownStart=0,this.mouseUpStart=0,this.xStart=0,this.yStart=0,this.xEnd=0,this.yEnd=0,this.slideDistance=0,this.containerMetrics=new nR(this.element)},draw:function(){var e,t,i;this.wave.style.opacity=this.opacity,e=this.radius/(this.containerMetrics.size/2),t=this.xNow-this.containerMetrics.width/2,i=this.yNow-this.containerMetrics.height/2,this.waveContainer.style.webkitTransform="translate("+t+"px, "+i+"px)",this.waveContainer.style.transform="translate3d("+t+"px, "+i+"px, 0)",this.wave.style.webkitTransform="scale("+e+","+e+")",this.wave.style.transform="scale3d("+e+","+e+",1)"},downAction:function(e){var t=this.containerMetrics.width/2,i=this.containerMetrics.height/2;this.resetInteractionState(),this.mouseDownStart=sR.now(),this.center?(this.xStart=t,this.yStart=i,this.slideDistance=sR.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)):(this.xStart=e?e.detail.x-this.containerMetrics.boundingRect.left:this.containerMetrics.width/2,this.yStart=e?e.detail.y-this.containerMetrics.boundingRect.top:this.containerMetrics.height/2),this.recenters&&(this.xEnd=t,this.yEnd=i,this.slideDistance=sR.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)),this.maxRadius=this.containerMetrics.furthestCornerDistanceFrom(this.xStart,this.yStart),this.waveContainer.style.top=(this.containerMetrics.height-this.containerMetrics.size)/2+"px",this.waveContainer.style.left=(this.containerMetrics.width-this.containerMetrics.size)/2+"px",this.waveContainer.style.width=this.containerMetrics.size+"px",this.waveContainer.style.height=this.containerMetrics.size+"px"},upAction:function(e){this.isMouseDown&&(this.mouseUpStart=sR.now())},remove:function(){Yr(Yr(this.waveContainer).parentNode).removeChild(this.waveContainer)}},As({_template:nn`
    <style>
      :host {
        display: block;
        position: absolute;
        border-radius: inherit;
        overflow: hidden;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;

        /* See PolymerElements/paper-behaviors/issues/34. On non-Chrome browsers,
         * creating a node (with a position:absolute) in the middle of an event
         * handler "interrupts" that event handler (which happens when the
         * ripple is created on demand) */
        pointer-events: none;
      }

      :host([animating]) {
        /* This resolves a rendering issue in Chrome (as of 40) where the
           ripple is not properly clipped by its parent (which may have
           rounded corners). See: http://jsbin.com/temexa/4

           Note: We only apply this style conditionally. Otherwise, the browser
           will create a new compositing layer for every ripple element on the
           page, and that would be bad. */
        -webkit-transform: translate(0, 0);
        transform: translate3d(0, 0, 0);
      }

      #background,
      #waves,
      .wave-container,
      .wave {
        pointer-events: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      #background,
      .wave {
        opacity: 0;
      }

      #waves,
      .wave {
        overflow: hidden;
      }

      .wave-container,
      .wave {
        border-radius: 50%;
      }

      :host(.circle) #background,
      :host(.circle) #waves {
        border-radius: 50%;
      }

      :host(.circle) .wave-container {
        overflow: hidden;
      }
    </style>

    <div id="background"></div>
    <div id="waves"></div>
`,is:"paper-ripple",behaviors:[rA],properties:{initialOpacity:{type:Number,value:.25},opacityDecayVelocity:{type:Number,value:.8},recenters:{type:Boolean,value:!1},center:{type:Boolean,value:!1},ripples:{type:Array,value:function(){return[]}},animating:{type:Boolean,readOnly:!0,reflectToAttribute:!0,value:!1},holdDown:{type:Boolean,value:!1,observer:"_holdDownChanged"},noink:{type:Boolean,value:!1},_animating:{type:Boolean},_boundAnimate:{type:Function,value:function(){return this.animate.bind(this)}}},get target(){return this.keyEventTarget},keyBindings:{"enter:keydown":"_onEnterKeydown","space:keydown":"_onSpaceKeydown","space:keyup":"_onSpaceKeyup"},attached:function(){11==Yr(this).parentNode.nodeType?this.keyEventTarget=Yr(this).getOwnerRoot().host:this.keyEventTarget=Yr(this).parentNode;var e=this.keyEventTarget;this.listen(e,"up","uiUpAction"),this.listen(e,"down","uiDownAction")},detached:function(){this.unlisten(this.keyEventTarget,"up","uiUpAction"),this.unlisten(this.keyEventTarget,"down","uiDownAction"),this.keyEventTarget=null},get shouldKeepAnimating(){for(var e=0;e<this.ripples.length;++e)if(!this.ripples[e].isAnimationComplete)return!0;return!1},simulatedRipple:function(){this.downAction(null),this.async((function(){this.upAction()}),1)},uiDownAction:function(e){this.noink||this.downAction(e)},downAction:function(e){this.holdDown&&this.ripples.length>0||(this.addRipple().downAction(e),this._animating||(this._animating=!0,this.animate()))},uiUpAction:function(e){this.noink||this.upAction(e)},upAction:function(e){this.holdDown||(this.ripples.forEach((function(t){t.upAction(e)})),this._animating=!0,this.animate())},onAnimationComplete:function(){this._animating=!1,this.$.background.style.backgroundColor="",this.fire("transitionend")},addRipple:function(){var e=new aR(this);return Yr(this.$.waves).appendChild(e.waveContainer),this.$.background.style.backgroundColor=e.color,this.ripples.push(e),this._setAnimating(!0),e},removeRipple:function(e){var t=this.ripples.indexOf(e);t<0||(this.ripples.splice(t,1),e.remove(),this.ripples.length||this._setAnimating(!1))},animate:function(){if(this._animating){var e,t;for(e=0;e<this.ripples.length;++e)(t=this.ripples[e]).draw(),this.$.background.style.opacity=t.outerOpacity,t.isOpacityFullyDecayed&&!t.isRestingAtMaxRadius&&this.removeRipple(t);this.shouldKeepAnimating||0!==this.ripples.length?window.requestAnimationFrame(this._boundAnimate):this.onAnimationComplete()}},animateRipple:function(){return this.animate()},_onEnterKeydown:function(){this.uiDownAction(),this.async(this.uiUpAction,1)},_onSpaceKeydown:function(){this.uiDownAction()},_onSpaceKeyup:function(){this.uiUpAction()},_holdDownChanged:function(e,t){void 0!==t&&(e?this.downAction():this.upAction())}});const lR={properties:{noink:{type:Boolean,observer:"_noinkChanged"},_rippleContainer:{type:Object}},_buttonStateChanged:function(){this.focused&&this.ensureRipple()},_downHandler:function(e){oA._downHandler.call(this,e),this.pressed&&this.ensureRipple(e)},ensureRipple:function(e){if(!this.hasRipple()){this._ripple=this._createRipple(),this._ripple.noink=this.noink;var t=this._rippleContainer||this.root;if(t&&Yr(t).appendChild(this._ripple),e){var i=Yr(this._rippleContainer||this),r=Yr(e).rootTarget;i.deepContains(r)&&this._ripple.uiDownAction(e)}}},getRipple:function(){return this.ensureRipple(),this._ripple},hasRipple:function(){return Boolean(this._ripple)},_createRipple:function(){return document.createElement("paper-ripple")},_noinkChanged:function(e){this.hasRipple()&&(this._ripple.noink=e)}},dR={properties:{elevation:{type:Number,reflectToAttribute:!0,readOnly:!0}},observers:["_calculateElevation(focused, disabled, active, pressed, receivedFocusFromKeyboard)","_computeKeyboardClass(receivedFocusFromKeyboard)"],hostAttributes:{role:"button",tabindex:"0",animated:!0},_calculateElevation:function(){var e=1;this.disabled?e=0:this.active||this.pressed?e=4:this.receivedFocusFromKeyboard&&(e=3),this._setElevation(e)},_computeKeyboardClass:function(e){this.toggleClass("keyboard-focus",e)},_spaceKeyDownHandler:function(e){oA._spaceKeyDownHandler.call(this,e),this.hasRipple()&&this.getRipple().ripples.length<1&&this._ripple.uiDownAction()},_spaceKeyUpHandler:function(e){oA._spaceKeyUpHandler.call(this,e),this.hasRipple()&&this._ripple.uiUpAction()}},cR=[sA,Vk,lR,dR],hR=nn`
  <style include="paper-material-styles">
    /* Need to specify the same specificity as the styles imported from paper-material. */
    :host {
      @apply --layout-inline;
      @apply --layout-center-center;
      position: relative;
      box-sizing: border-box;
      min-width: 5.14em;
      margin: 0 0.29em;
      background: transparent;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
      -webkit-tap-highlight-color: transparent;
      font: inherit;
      text-transform: uppercase;
      outline-width: 0;
      border-radius: 3px;
      -moz-user-select: none;
      -ms-user-select: none;
      -webkit-user-select: none;
      user-select: none;
      cursor: pointer;
      z-index: 0;
      padding: 0.7em 0.57em;

      @apply --paper-font-common-base;
      @apply --paper-button;
    }

    :host([elevation="1"]) {
      @apply --paper-material-elevation-1;
    }

    :host([elevation="2"]) {
      @apply --paper-material-elevation-2;
    }

    :host([elevation="3"]) {
      @apply --paper-material-elevation-3;
    }

    :host([elevation="4"]) {
      @apply --paper-material-elevation-4;
    }

    :host([elevation="5"]) {
      @apply --paper-material-elevation-5;
    }

    :host([hidden]) {
      display: none !important;
    }

    :host([raised].keyboard-focus) {
      font-weight: bold;
      @apply --paper-button-raised-keyboard-focus;
    }

    :host(:not([raised]).keyboard-focus) {
      font-weight: bold;
      @apply --paper-button-flat-keyboard-focus;
    }

    :host([disabled]) {
      background: none;
      color: #a8a8a8;
      cursor: auto;
      pointer-events: none;

      @apply --paper-button-disabled;
    }

    :host([disabled][raised]) {
      background: #eaeaea;
    }


    :host([animated]) {
      @apply --shadow-transition;
    }

    paper-ripple {
      color: var(--paper-button-ink-color);
    }
  </style>

  <slot></slot>`;hR.setAttribute("strip-whitespace",""),As({_template:hR,is:"paper-button",behaviors:[cR],properties:{raised:{type:Boolean,reflectToAttribute:!0,value:!1,observer:"_calculateElevation"}},_calculateElevation:function(){this.raised?dR._calculateElevation.apply(this):this._setElevation(0)}});class pR{constructor(e){this.isBinary=!1,this.groups=[],this.context=e.context,this.keyLocations=e.keyLocations??{left:{},right:{}},this.isBinary=e.isBinary??!1,this.diffRangesToFocus=e.diffRangesToFocus}process(e){return this.groups=[],this.groups.push(this.makeGroup("LOST")),this.groups.push(this.makeGroup("FILE")),this.processChunks(e),this.groups}processChunks(e){if(this.isBinary)return;const t={lineNums:{left:0,right:0},chunkIndex:0};for(e=this.splitCommonChunksWithKeyLocations(e);t.chunkIndex<e.length;){const i=this.processNext(t,e);for(const e of i.groups)this.groups.push(e);t.lineNums.left+=i.lineDelta.left,t.lineNums.right+=i.lineDelta.right,t.chunkIndex=i.newChunkIndex}}processNext(e,t){const i=this.firstUncollapsibleChunkIndex(t,e);if(i===e.chunkIndex){const i=t[e.chunkIndex];return{lineDelta:{left:this.linesLeft(i).length,right:this.linesRight(i).length},groups:[this.chunkToGroup(i,e.lineNums.left+1,e.lineNums.right+1)],newChunkIndex:e.chunkIndex+1}}return this.processCollapsibleChunks(e,t,i)}linesLeft(e){return e.ab||e.a||[]}linesRight(e){return e.ab||e.b||[]}firstUncollapsibleChunkIndex(e,t){let i=t.chunkIndex,r=t.lineNums.left,o=t.lineNums.right;for(;i<e.length&&this.isCollapsibleChunk(e[i],r,o);)r+=this.chunkLength(e[i],$u.LEFT),o+=this.chunkLength(e[i],$u.RIGHT),i++;return i}isCollapsibleChunk(e,t,i){const r=e.ab||e.common||e.skip,o=this.isChunkOutsideOfFocusRange(e,t,i);return r&&!e.keyLocation||o}isChunkOutsideOfFocusRange(e,t,i){if(!this.diffRangesToFocus)return!1;const r=this.linesLeft(e).length,o=this.linesRight(e).length,s=this.diffRangesToFocus.left.some((e=>this.hasAnyOverlap({start:t,end:t+r},e))),n=this.diffRangesToFocus.right.some((e=>this.hasAnyOverlap({start:i,end:i+o},e)));return!s&&!n}hasAnyOverlap(e,t){return Math.max(e.start,t.start)<=Math.min(e.end,t.end)}processCollapsibleChunks(e,t,i){const r=t.slice(e.chunkIndex,i),o=r.reduce(((e,t)=>e+this.chunkLength(t,$u.LEFT)),0),s=r.reduce(((e,t)=>e+this.chunkLength(t,$u.RIGHT)),0);let n=this.chunksToGroups(r,e.lineNums.left+1,e.lineNums.right+1);const a=!!n.find((e=>e.skip)),l=!!n.find((e=>e.type===QA.DELTA&&!e.ignoredWhitespaceOnly));if(-1!==this.context||a||l){const r=this.context>0?this.context:0;n=ZA(n,0===e.chunkIndex?0:r,o-(i===t.length?0:this.context),s-(i===t.length?0:this.context))}return{lineDelta:{left:o,right:s},groups:n,newChunkIndex:i}}chunkLength(e,t){return e.skip||e.common||e.ab?this.commonChunkLength(e):t===$u.LEFT?this.linesLeft(e).length:this.linesRight(e).length}commonChunkLength(e){return e.skip?e.skip:(console.assert(!!e.ab||!!e.common),console.assert(!e.a||!!e.b&&e.a.length===e.b.length,"common chunk needs same number of a and b lines: ",e),this.linesLeft(e).length)}chunksToGroups(e,t,i){return e.map((e=>{const r=this.chunkToGroup(e,t,i);return t+=this.chunkLength(e,$u.LEFT),i+=this.chunkLength(e,$u.RIGHT),r}))}chunkToGroup(e,t,i){const r=e.ab||e.skip?QA.BOTH:QA.DELTA,o=this.linesFromChunk(e,t,i),s={moveDetails:e.move_details,dueToRebase:!!e.due_to_rebase,ignoredWhitespaceOnly:!!e.common,keyLocation:!!e.keyLocation};return void 0!==e.skip?new iR({type:r,skip:e.skip,offsetLeft:t,offsetRight:i,...s}):new iR({type:r,lines:o,...s})}linesFromChunk(e,t,i){if(e.ab)return e.ab.map(((e,r)=>this.lineFromRow(Iu.BOTH,t,i,e,r)));let r=[];return e.a&&(r=r.concat(this.linesFromRows(Iu.REMOVE,e.a,t,e.edit_a))),e.b&&(r=r.concat(this.linesFromRows(Iu.ADD,e.b,i,e.edit_b))),r}linesFromRows(e,t,i,r){const o=r?this.convertIntralineInfos(t,r):void 0;return t.map(((t,r)=>this.lineFromRow(e,i,i,t,r,o)))}lineFromRow(e,t,i,r,o,s){const n=new XA(e);return n.text=r,e!==Iu.ADD&&(n.beforeNumber=t+o),e!==Iu.REMOVE&&(n.afterNumber=i+o),s?(n.hasIntralineInfo=!0,n.highlights=s.filter((e=>e.contentIndex===o))):n.hasIntralineInfo=!1,n}makeGroup(e){const t=new XA(Iu.BOTH);return t.beforeNumber=e,t.afterNumber=e,new iR({type:QA.BOTH,lines:[t]})}splitCommonChunksWithKeyLocations(e){const t=[];let i=1,r=1;for(const o of e){if(!o.ab&&!o.skip&&!o.common){o.a&&(i+=o.a.length),o.b&&(r+=o.b.length),t.push(o);continue}if(o.common&&o.a.length!==o.b.length)throw new Error("DiffContent with common=true must always have equal length");const e=this.commonChunkLength(o),s=this.findChunkEndsAtKeyLocations(e,i,r);if(i+=e,r+=e,o.skip)t.push({...o,skip:o.skip,keyLocation:!1});else if(o.ab)t.push(...this.splitAtChunkEnds(o.ab,s).map((({lines:e,keyLocation:t})=>({...o,ab:e,keyLocation:t}))));else if(o.common){const e=this.splitAtChunkEnds(o.a,s),i=this.splitAtChunkEnds(o.b,s);t.push(...e.map((({lines:e,keyLocation:t},r)=>({...o,a:e,b:i[r].lines,keyLocation:t}))))}}return t}findChunkEndsAtKeyLocations(e,t,i){const r=[];let o=0;for(let s=0;s<e;s++)(this.keyLocations[$u.LEFT][t+s]||this.keyLocations[$u.RIGHT][i+s])&&(s>o&&(r.push({offset:s,keyLocation:!1}),o=s),r.push({offset:s+1,keyLocation:!0}));return e>o&&r.push({offset:e,keyLocation:!1}),r}splitAtChunkEnds(e,t){const i=[];let r=0;for(const{offset:o,keyLocation:s}of t)r!==o&&(i.push({lines:e.slice(r,o),keyLocation:s}),r=o);return i}convertIntralineInfos(e,t){const i=e.map((e=>J$(e)+1));let r=0,o=0;const s=[];for(const[e,n]of t){let t=i[r],a=0;for(;a<e;)o!==t?(o++,a++):(o=0,t=i[++r]);let l={contentIndex:r,startIndex:o};for(a=0;t&&a<n;)o!==t?(o++,a++):(o=0,t=i[++r],s.push(l),l={contentIndex:r,startIndex:o});l.endIndex=o,s.push(l)}return s}}const uR={blame:!1,leftNumber:!1,leftSign:!1,leftContent:!1,rightNumber:!1,rightSign:!1,rightContent:!1},gR=mu("diff-model");class mR extends df{constructor(e){super({diffPrefs:{context:10,cursor_blink_rate:0,font_size:12,ignore_whitespace:"IGNORE_NONE",line_length:100,line_wrapping:!1,show_line_endings:!0,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8},renderPrefs:{},comments:[],groups:[],showFullContext:wk.UNDECIDED,layers:[],blameInfo:[]}),this.eventTarget=e,this.diff$=lf(this.state$.pipe($p((e=>void 0!==e.diff))),(e=>e.diff)),this.syntaxTreeRight$=lf(this.diff$,(e=>e.meta_b?.syntax_tree)),this.lineCountLeft$=lf(this.diff$,(e=>function(e,t){return e?.content&&t?e.content.reduce(((e,i)=>{const r=t===$u.LEFT?i.a:i.b;return e+(r?.length??i.ab?.length??i.skip??0)}),0):0}(e,$u.LEFT))),this.baseImage$=lf(this.state$,(e=>e.baseImage)),this.revisionImage$=lf(this.state$,(e=>e.revisionImage)),this.path$=lf(this.state$,(e=>e.path)),this.blameInfo$=lf(this.state$,(e=>e.blameInfo)),this.renderPrefs$=lf(this.state$,(e=>e.renderPrefs)),this.viewMode$=lf(this.renderPrefs$,(e=>e.view_mode??Su.SIDE_BY_SIDE)),this.columnsToShow$=lf(Yh([this.blameInfo$,this.renderPrefs$]),(([e,t])=>{const i=!!t.hide_left_side,r=!!t.show_sign_col,o=t.view_mode===Su.UNIFIED;return{blame:e.length>0,leftNumber:!i||o,leftSign:!i&&r&&!o,leftContent:!i&&!o,rightNumber:!0,rightSign:r&&!o,rightContent:!0}})),this.columnCount$=lf(this.columnsToShow$,(e=>Object.values(e).filter((e=>e)).length)),this.diffPrefs$=lf(this.state$,(e=>e.diffPrefs)),this.layers$=lf(this.state$,(e=>e.layers)),this.showFullContext$=lf(this.state$,(e=>e.showFullContext)),this.actionHoverCardText$=lf(this.state$,(e=>e.actionHoverCardText)),this.context$=lf(this.state$,(e=>{return t=e.diffPrefs.context,(i=e.showFullContext)===wk.YES?-1:void 0===t||i===wk.NO&&-1===t?10:t;var t,i})),this.responsiveMode$=lf(this.state$,(e=>ck(e.diffPrefs,e.renderPrefs))),this.errorMessage$=lf(this.state$,(e=>e.errorMessage)),this.comments$=lf(this.state$,(e=>e.comments??[])),this.groups$=lf(this.state$,(e=>e.groups??[])),this.loading$=lf(this.state$,(e=>0===(e.groups??[]).length||void 0===e.diff)),this.lineLength$=lf(this.state$,(e=>function(e,t){if(t===hg.COMMIT_MESSAGE)return 72;const i=e.line_length;return Number.isInteger(i)&&i>0?i:100}(e.diffPrefs,e.path))),this.keyLocations$=lf(this.state$,(e=>function(e,t){const i={left:{},right:{}};e&&(i[e.side][e.lineNum]=!0);for(const e of t)i[e.side][e.line]=!0,e.range?.start_line&&(i[e.side][e.range.start_line]=!0);return i}(e.lineOfInterest,e.comments??[]))),this.diffRangesToFocus$=lf(this.state$,(e=>e.diffRangesToFocus)),this.subscriptions=[this.processDiff()]}processDiff(){return Yh([this.diff$,this.context$,this.renderPrefs$,this.diffRangesToFocus$]).pipe(du(this.keyLocations$),lp(1),ep((([[e,t,i,r],o])=>{const s={context:t,keyLocations:o,isBinary:!(!kk(e)&&!e.binary),diffRangesToFocus:r};return i?.num_lines_rendered_at_once&&(s.asyncThreshold=i.num_lines_rendered_at_once),new pR(s).process(e.content)}))).subscribe((e=>{this.updateState({groups:e})}))}replaceGroup(e,t){va(e.type===QA.CONTEXT_CONTROL,"gr-diff can only replace context control groups");const i=[...this.getState().groups],r=i.indexOf(e);if(-1===r)throw new Error("cannot find context control group");i.splice(r,1,...t),this.updateState({groups:i})}selectLine(e,t){const i=this.getState().path;if(!i)return;const r={number:e,side:t,path:i};Jn(this.eventTarget,"line-selected",r)}createCommentOnLine(e,t){const i={side:t,lineNum:e,range:void 0};Jn(this.eventTarget,"create-comment",i)}createCommentOnRange(e,t){const i={side:t,lineNum:e.end_line,range:e};Jn(this.eventTarget,"create-comment",i)}fireRangeSelectedEvent(e,t,i){const r={side:e,lineNum:t.end_line,range:t,isMouseUp:i};Jn(this.eventTarget,"range-selected",r)}}var fR=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};function vR(e,t){const i=t?.find((({range:t})=>t.start_line<e&&t.end_line>e));if(!i)return[];const r=vR(e,i?.children);return[i].concat(r)}function bR(e,t=0){const i=yR(e,t),r=wR(e,t);return i&&!r?"above":!i&&r?"below":"both"}function yR(e,t=0){if(e?.type!==QA.CONTEXT_CONTROL)return!1;const i=e.lineRange.left.start_line,r=!!e.contextGroups[0].skip;return i>1&&!r||t===e.lineRange.left.end_line-i+1}function wR(e,t=0){if(e?.type!==QA.CONTEXT_CONTROL)return!1;const i=e.lineRange.left.end_line,r=!!e.contextGroups[e.contextGroups.length-1].skip;return i<t&&!r}class _R extends Ic{static get styles(){return[Sd`
        :host {
          display: flex;
          justify-content: center;
          flex-direction: column;
          position: relative;
        }

        :host([showConfig='above']) {
          justify-content: flex-end;
          margin-top: calc(-1px - var(--line-height-normal) - var(--spacing-s));
          margin-bottom: var(--gr-context-controls-margin-bottom);
          height: calc(var(--line-height-normal) + var(--spacing-s));
          .horizontalFlex {
            align-items: end;
          }
        }

        :host([showConfig='below']) {
          justify-content: flex-start;
          margin-top: 1px;
          margin-bottom: calc(
            0px - var(--line-height-normal) - var(--spacing-s)
          );
          .horizontalFlex {
            align-items: start;
          }
        }

        :host([showConfig='both']) {
          margin-top: calc(0px - var(--line-height-normal) - var(--spacing-s));
          margin-bottom: calc(
            0px - var(--line-height-normal) - var(--spacing-s)
          );
          height: calc(
            2 * var(--line-height-normal) + 2 * var(--spacing-s) +
              var(--divider-height)
          );
          .horizontalFlex {
            align-items: center;
          }
        }

        .contextControlButton {
          background-color: var(--default-button-background-color);
          font: var(--context-control-button-font, inherit);
        }

        paper-button {
          text-transform: none;
          align-items: center;
          background-color: var(--background-color);
          font-family: inherit;
          margin: var(--margin, 0);
          min-width: var(--border, 0);
          color: var(--diff-context-control-color);
          border: solid var(--border-color);
          border-width: 1px;
          border-radius: var(--border-radius);
          padding: var(--spacing-s) var(--spacing-l);
        }

        paper-button:hover {
          /* same as defined in gr-button */
          background: rgba(0, 0, 0, 0.12);
        }
        paper-button:focus-visible {
          /* paper-button sets this to 0, thus preventing focus-based styling. */
          outline-width: 1px;
        }

        .aboveBelowButtons {
          display: flex;
          flex-direction: column;
          justify-content: center;
          margin-left: var(--spacing-m);
          position: relative;
        }
        .aboveBelowButtons:first-child {
          margin-left: 0;
          /* Places a default background layer behind the "all button" that can have opacity */
          background-color: var(--default-button-background-color);
        }

        .horizontalFlex {
          display: flex;
          justify-content: center;
          align-items: var(
            --gr-context-controls-horizontal-align-items,
            center
          );
        }

        .aboveButton {
          border-bottom-width: 0;
          border-bottom-right-radius: 0;
          border-bottom-left-radius: 0;
          padding: var(--spacing-xxs) var(--spacing-l);
        }
        .belowButton {
          border-top-width: 0;
          border-top-left-radius: 0;
          border-top-right-radius: 0;
          padding: var(--spacing-xxs) var(--spacing-l);
          margin-top: calc(var(--divider-height) + 2 * var(--spacing-xxs));
        }
        .belowButton:first-child {
          margin-top: 0;
        }
        .breadcrumbTooltip {
          white-space: nowrap;
        }
        .unrelatedChanges {
          color: var(--primary-button-text-color);
          background-color: var(--primary-button-background-color);

          &:hover {
            // TODO(anuragpathak): Update hover colors as per specification.
            color: var(--primary-button-text-color);
            background-color: var(--primary-button-background-color);
          }
        }
      `]}constructor(){super(),this.showConfig="both",this.lineCountLeft=0,this.getDiffModel=yu(this,gR),this.expandButtonsHover=new Dp,this.setupButtonHoverHandler(),zf(this,(()=>this.getDiffModel().syntaxTreeRight$),(e=>this.syntaxTreeRight=e)),zf(this,(()=>this.getDiffModel().renderPrefs$),(e=>this.renderPreferences=e)),zf(this,(()=>this.getDiffModel().lineCountLeft$),(e=>{this.lineCountLeft=e,this.updateShowConfig()}))}willUpdate(e){e.has("group")&&this.updateShowConfig()}updateShowConfig(){this.showConfig=bR(this.group,this.lineCountLeft)}showBoth(){return"both"===this.showConfig}showAbove(){return this.showBoth()||"above"===this.showConfig}showBelow(){return this.showBoth()||"below"===this.showConfig}setupButtonHoverHandler(){zf(this,(()=>this.expandButtonsHover.pipe(Vp((e=>"leave"===e.eventType?gp:Zh(e).pipe(function(e,t){void 0===t&&(t=Dh);var i=pp(500)?500-t.now():Math.abs(500);return function(e){return e.lift(new yp(i,t))}}()))))),(({buttonType:e,linesToExpand:t})=>{Jn(this,"diff-context-button-hovered",{buttonType:e,linesToExpand:t})}))}numLines(){ba(this.group);const e=this.group.lineRange.left;return e.end_line-e.start_line+1}createExpandAllButtonContainer(){return dc` <div class="aboveBelowButtons fullExpansion">
      ${this.createContextButton(Tu.ALL,this.numLines())}
    </div>`}createContextButton(e,t,i){if(!this.group)return;let r="",o=[],s="",n="contextControlButton showContext ";e===Tu.ALL?(this.group.hasNonCommonDeltaGroup()?(r="+ Unrelated changes",s="Show unrelated changes",n+=" unrelatedChanges "):(r=`+${Ig(t,"common line")}`,s=`Show ${Ig(t,"common line")}`),n+=this.showBoth()?"centeredButton":this.showAbove()?"aboveButton":"belowButton",this.group?.hasSkipGroup()&&(r+=" (too large)"),o.push(...this.group.contextGroups)):e===Tu.ABOVE?(o=ZA(this.group.contextGroups,t,this.numLines()),r=`+${t}`,n+="aboveButton",s=`Show ${Ig(t,"line")} above`):e===Tu.BELOW?(o=ZA(this.group.contextGroups,0,this.numLines()-t),r=`+${t}`,n+="belowButton",s=`Show ${Ig(t,"line")} below`):e===Tu.BLOCK_ABOVE?(o=ZA(this.group.contextGroups,t,this.numLines()),r="+Block",n+="aboveButton",s="Show block above"):e===Tu.BLOCK_BELOW&&(o=ZA(this.group.contextGroups,0,this.numLines()-t),r="+Block",n+="belowButton",s="Show block below");const a=this.createExpansionHandler(t,e,o),l=i=>{this.expandButtonsHover.next({eventType:i,buttonType:e,linesToExpand:t})};let d=dc` <paper-button
      class=${n}
      aria-label=${s}
      @click=${a}
      @mouseenter=${()=>l("enter")}
      @mouseleave=${()=>l("leave")}
    >
      <span class="showContext">${r}</span>
    </paper-button>`;return i&&(d=dc`<gr-tooltip-content
        class="breadcrumbTooltip"
        has-tooltip
        title=${i.title}
        ?position-below=${i.positionBelow}
      >
        ${d}
      </gr-tooltip-content>`),d}createExpansionHandler(e,t,i){return r=>{ba(this.group),r.stopPropagation(),t===Tu.ALL&&this.group?.hasSkipGroup()?Jn(this,"content-load-needed",{lineRange:this.group.lineRange}):(Jn(this,"diff-context-expanded",{numLines:this.numLines(),buttonType:t,expandedLines:e}),Jn(this,"diff-context-expanded-internal-new",{contextGroup:this.group,groups:i,numLines:this.numLines(),buttonType:t,expandedLines:e}))}}showPartialLinks(){return this.numLines()>10}createPartialExpansionButtons(){if(!this.showPartialLinks()||this.group?.hasNonCommonDeltaGroup())return;let e,t;return this.showAbove()&&(e=this.createContextButton(Tu.ABOVE,10)),this.showBelow()&&(t=this.createContextButton(Tu.BELOW,10)),e||t?dc` <div class="aboveBelowButtons partialExpansion">
          ${e} ${t}
        </div>`:void 0}createBlockExpansionButtons(){if(ba(this.group,"group"),!this.showPartialLinks()||!this.renderPreferences?.use_block_expansion||this.group?.hasSkipGroup()||this.group?.hasNonCommonDeltaGroup())return;let e,t;return this.showAbove()&&(e=this.createBlockButton(Tu.BLOCK_ABOVE,this.group.lineRange.right.start_line-1)),this.showBelow()&&(t=this.createBlockButton(Tu.BLOCK_BELOW,this.group.lineRange.right.end_line+1)),e||t?dc` <div class="aboveBelowButtons blockExpansion">
        ${e} ${t}
      </div>`:void 0}createBlockButtonTooltip(e,t,i){const r=t.length?t.map((e=>e.name||"(anonymous)")).join(" > "):`${i} common lines`;return{title:r,positionBelow:e!==Tu.BLOCK_ABOVE}}createBlockButton(e,t){if(void 0===this.syntaxTreeRight)return;const i=vR(t,this.syntaxTreeRight);let r=this.numLines();if(i.length){const{range:o}=i[i.length-1],s=e===Tu.BLOCK_ABOVE?o.end_line:o.start_line,n=Math.abs(s-t);n<this.numLines()&&(r=n)}const o=this.createBlockButtonTooltip(e,i,r);return this.createContextButton(e,r,o)}render(){return this.group?dc`
      <div class="horizontalFlex">
        ${this.createExpandAllButtonContainer()}
        ${this.createPartialExpansionButtons()}
        ${this.createBlockExpansionButtons()}
      </div>
    `:uc}}fR([Fc({type:Object})],_R.prototype,"group",void 0),fR([Fc({type:String,reflect:!0})],_R.prototype,"showConfig",void 0),fR([Uc()],_R.prototype,"syntaxTreeRight",void 0),fR([Uc()],_R.prototype,"renderPreferences",void 0),fR([Uc()],_R.prototype,"lineCountLeft",void 0),customElements.define("gr-context-controls",_R);var xR=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};class CR extends Ic{constructor(){super(),this.addTableWrapperForTesting=!1,this.viewMode=Su.SIDE_BY_SIDE,this.columns=uR,this.columnCount=0,this.lineCountLeft=0,this.getDiffModel=yu(this,gR),zf(this,(()=>this.getDiffModel().viewMode$),(e=>this.viewMode=e)),zf(this,(()=>this.getDiffModel().columnsToShow$),(e=>this.columns=e)),zf(this,(()=>this.getDiffModel().columnCount$),(e=>this.columnCount=e)),zf(this,(()=>this.getDiffModel().lineCountLeft$),(e=>this.lineCountLeft=e))}createRenderRoot(){return this}renderPaddingRow(e){if(!yR(this.group,this.lineCountLeft)&&"above"===e)return;if(!wR(this.group,this.lineCountLeft)&&"below"===e)return;const t=this.isSideBySide()?"side-by-side":"unified",i=this.isSideBySide()?QA.CONTEXT_CONTROL:void 0;return dc`
      <tr
        class=${["contextBackground",t,e].join(" ")}
        left-type=${Vw(i)}
        right-type=${Vw(i)}
      >
        ${eb(this.columns.blame,(()=>dc`<td class="blame" data-line-number="0"></td>`))}
        ${eb(this.columns.leftNumber,(()=>dc`<td class="contextLineNum"></td>`))}
        ${eb(this.columns.leftSign,(()=>dc`<td class="sign"></td>`))}
        ${eb(this.columns.leftContent,(()=>dc`<td></td>`))}
        ${eb(this.columns.rightNumber,(()=>dc`<td class="contextLineNum"></td>`))}
        ${eb(this.columns.rightSign,(()=>dc`<td class="sign"></td>`))}
        ${eb(this.columns.rightContent,(()=>dc`<td></td>`))}
      </tr>
    `}isSideBySide(){return this.viewMode!==Su.UNIFIED}createContextControlRow(){let e=this.columnCount;this.columns.blame&&e--;const t=bR(this.group,this.lineCountLeft);return dc`
      <tr class=${["dividerRow",`show-${t}`].join(" ")}>
        ${eb(this.columns.blame,(()=>dc`<td class="blame" data-line-number="0"></td>`))}
        <td class="dividerCell" colspan=${e}>
          <gr-context-controls .group=${this.group}> </gr-context-controls>
        </td>
      </tr>
    `}render(){if(this.group?.type!==QA.CONTEXT_CONTROL)return;const e=dc`
      ${this.renderPaddingRow("above")} ${this.createContextControlRow()}
      ${this.renderPaddingRow("below")}
    `;return this.addTableWrapperForTesting?dc`<table>
        ${e}
      </table>`:e}}xR([Fc({type:Object})],CR.prototype,"group",void 0),xR([Uc()],CR.prototype,"addTableWrapperForTesting",void 0),xR([Uc()],CR.prototype,"viewMode",void 0),xR([Uc()],CR.prototype,"columns",void 0),xR([Uc()],CR.prototype,"columnCount",void 0),xR([Uc()],CR.prototype,"lineCountLeft",void 0),customElements.define("gr-context-controls-section",CR);const ER=()=>new SR;let SR=class{};const $R=new WeakMap,kR=Zc(class extends Qv{render(e){return uc}update(e,[t]){const i=t!==this.G;return i&&void 0!==this.G&&this.rt(void 0),(i||this.lt!==this.ct)&&(this.G=t,this.ht=e.options?.host,this.rt(this.ct=e.element)),uc}rt(e){if(this.isConnected||(e=void 0),"function"==typeof this.G){const t=this.ht??globalThis;let i=$R.get(t);void 0===i&&(i=new WeakMap,$R.set(t,i)),void 0!==i.get(this.G)&&this.G.call(this.ht,void 0),i.set(this.G,e),void 0!==e&&this.G.call(this.ht,e)}else this.G.value=e}get lt(){return"function"==typeof this.G?$R.get(this.ht??globalThis)?.get(this.G):this.G?.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});var AR=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const RR=/[\uD800-\uDBFF][\uDC00-\uDFFF]/;class TR extends Ic{constructor(){super(...arguments),this.text="",this.isResponsive=!1,this.tabSize=2,this.lineLimit=80,this.textOffset=0,this.columnPos=0,this.pieces=[]}createRenderRoot(){return this}render(){this.textOffset=0,this.columnPos=0,this.pieces=[];const e=this.text.split("\t");for(let t=0;t<e.length;t++){const i=e[t].split(RR);for(let e=0;e<i.length;e++)this.renderSegment(i[e]),e<i.length-1&&this.renderSurrogatePair();t<e.length-1&&this.renderTab()}if(this.textOffset!==this.text.length)throw new Error("unfinished");return this.pieces}renderSegment(e){let t=0;for(;t<e.length;){const i=Math.min(e.length,t+this.lineLimit-this.columnPos);this.renderString(e.substring(t,i)),t=i,t<e.length&&this.columnPos===this.lineLimit&&this.renderLineBreak()}}renderString(e){if(0!==e.length&&(this.pieces.push(e),this.textOffset+=e.length,this.columnPos+=e.length,this.columnPos>this.lineLimit))throw new Error("over line limit")}renderTab(){let e=this.tabSize-this.columnPos%this.tabSize;this.columnPos+e>this.lineLimit&&(this.renderLineBreak(),e=this.tabSize);const t=dc`<span
      class="tab"
      style=${Bm({"tab-size":`${e}`})}
      >${"\t"}</span
    >`;this.pieces.push(t),this.textOffset+=1,this.columnPos+=e}renderSurrogatePair(){this.columnPos===this.lineLimit&&this.renderLineBreak(),this.pieces.push(this.text.substring(this.textOffset,this.textOffset+2)),this.textOffset+=2,this.columnPos+=1}renderLineBreak(){this.isResponsive?this.pieces.push(dc`<wbr></wbr>`):this.pieces.push(dc`<span class="br"></span>`),this.columnPos=0}}AR([Fc({type:String})],TR.prototype,"text",void 0),AR([Fc({type:Boolean})],TR.prototype,"isResponsive",void 0),AR([Fc({type:Number})],TR.prototype,"tabSize",void 0),AR([Fc({type:Number})],TR.prototype,"lineLimit",void 0),customElements.define("gr-diff-text",TR);var IR=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const PR=ix(Ic);let NR=class extends PR{static get styles(){return[PR.styles??[],Sd`
        #container {
          padding: var(--spacing-l);
        }
      `]}render(){return dc`
      <div id="container" role="tooltip" tabindex="-1">
        <slot></slot>
      </div>
    `}};NR=IR([Dc("gr-hovercard")],NR);var OR=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};class DR extends Ic{constructor(){super(),this.contentLeftRef=ER(),this.contentRightRef=ER(),this.contentCellLeftRef=ER(),this.contentCellRightRef=ER(),this.lineNumberLeftRef=ER(),this.lineNumberRightRef=ER(),this.blameCellRef=ER(),this.tableRowRef=ER(),this.left$=new Up(void 0),this.right$=new Up(void 0),this.unifiedDiff=!1,this.tabSize=2,this.lineLength=80,this.hideFileCommentButton=!1,this.layers=[],this.addTableWrapperForTesting=!1,this.leftComments=[],this.rightComments=[],this.columns=uR,this.layersApplied=!1,this.getDiffModel=yu(this,gR),zf(this,(()=>Yh([this.left$,this.getDiffModel().comments$]).pipe(ep((([e,t])=>t.filter((t=>t.line===e?.lineNumber($u.LEFT)&&t.side===$u.LEFT)))),xp(sf))),(e=>this.leftComments=e)),zf(this,(()=>Yh([this.right$,this.getDiffModel().comments$]).pipe(ep((([e,t])=>t.filter((t=>t.line===e?.lineNumber($u.RIGHT)&&t.side===$u.RIGHT)))),xp(sf))),(e=>this.rightComments=e)),zf(this,(()=>this.getDiffModel().columnsToShow$),(e=>this.columns=e)),zf(this,(()=>this.getDiffModel().blameInfo$),(e=>{const t=this.left?.lineNumber($u.LEFT);this.blameInfo=function(e,t){if("number"==typeof t)return e.find((e=>e.ranges.find((e=>e.start<=t&&t<=e.end))))}(e,t)}))}willUpdate(e){e.has("left")&&this.left$.next(this.left),e.has("right")&&this.right$.next(this.right)}createRenderRoot(){return this}updated(){this.layersApplied?this.updateComplete.then((()=>{this.layersApplied=!1,this.requestUpdate()})):(this.updateLayers($u.LEFT),this.updateLayers($u.RIGHT))}async updateLayers(e){const t=this.line(e),i=this.contentRef(e).value,r=this.lineNumberRef(e).value;if(t&&i&&r){await(i?.updateComplete);for(const o of this.layers)"function"==typeof o.annotate&&o.annotate(i,r,t,e);this.layersApplied=!0}}render(){if(!this.left||!this.right)return;const e=this.unifiedDiff?["unified"]:["side-by-side"],t=this.unifiedType();this.unifiedDiff&&t&&e.push(t);const i=dc`
      <tr
        ${kR(this.tableRowRef)}
        class=${["diff-row",...e].join(" ")}
        left-type=${Vw(this.getType($u.LEFT))}
        right-type=${Vw(this.getType($u.RIGHT))}
        tabindex="-1"
        aria-labelledby=${this.ariaLabelIds()}
      >
        ${this.renderBlameCell()} ${this.renderLineNumberCell($u.LEFT)}
        ${this.renderSignCell($u.LEFT)} ${this.renderContentCell($u.LEFT)}
        ${this.renderLineNumberCell($u.RIGHT)}
        ${this.renderSignCell($u.RIGHT)} ${this.renderContentCell($u.RIGHT)}
      </tr>
      ${this.renderPostLineSlot($u.LEFT)}
      ${this.renderPostLineSlot($u.RIGHT)}
    `;return this.addTableWrapperForTesting?dc`<table>
        ${i}
      </table>`:i}ariaLabelIds(){const e=[];return e.push(this.lineNumberId($u.LEFT)),this.unifiedDiff||e.push(this.contentId($u.LEFT)),e.push(this.lineNumberId($u.RIGHT)),this.unifiedDiff||e.push(this.contentId($u.RIGHT)),this.unifiedDiff&&e.push(this.contentId(this.unifiedSide())),e.filter((e=>!!e)).join(" ")}lineNumberId(e){const t=this.lineNumber(e);return t?`${e}-button-${t}`:""}unifiedSide(){return this.line($u.RIGHT)?.type===Iu.BLANK?$u.LEFT:$u.RIGHT}contentId(e){const t=this.lineNumber(e);return t?`${e}-content-${t}`:""}getTableRow(){return this.tableRowRef.value}getLineNumberCell(e){return this.lineNumberRef(e).value}getContentCell(e){return this.contentCellRef(e)?.value}getBlameCell(){return this.blameCellRef.value}renderBlameCell(){return this.columns.blame?dc`
      <td
        ${kR(this.blameCellRef)}
        class="blame"
        data-line-number=${this.left?.beforeNumber??0}
      >${this.renderBlameElement()}</td>
    `:uc}renderBlameElement(){const e=this.left?.beforeNumber,t=this.blameInfo;if(!e||!t)return;const i=[];t.ranges.some((t=>t.start===e))&&i.push("startOfRange");const r=new Date(1e3*t.time).toLocaleDateString(),o=t.author.split(" ")[0],s=`${Sf()}/q/${t.id}`;return dc`<span class=${i.join(" ")}
        ><a href=${s} class="blameDate">${r}</a
        ><span class="blameAuthor"> ${o}</span
        ><gr-hovercard>
          <span class="blameHoverCard">
            Commit ${t.id}<br />
            Author: ${t.author}<br />
            Date: ${r}<br />
            <br />
            ${t.commit_msg}
          </span>
        </gr-hovercard
      ></span>`}renderLineNumberCell(e){if(!this.columns.leftNumber&&e===$u.LEFT)return uc;if(!this.columns.rightNumber&&e===$u.RIGHT)return uc;const t=this.line(e),i=this.lineNumber(e),r=t?.type===Iu.BLANK;if(!t||!i||r||this.layersApplied){const t=r?"blankLineNum":"";return dc`<td
        ${kR(this.lineNumberRef(e))}
        class=${[e,t].join(" ")}
      ></td>`}return dc`<td
      ${kR(this.lineNumberRef(e))}
      class=${[e,"lineNum"].join(" ")}
      data-value=${i}
    >
      ${this.renderLineNumberButton(t,i,e)}
    </td>`}renderLineNumberButton(e,t,i){if((!this.hideFileCommentButton||t!==Au)&&t!==Ru)return dc`
      <button
        id=${this.lineNumberId(i)}
        class=${["lineNumButton",i].join(" ")}
        tabindex="-1"
        data-value=${t}
        aria-label=${Vw(this.computeLineNumberAriaLabel(e,t))}
        @click=${()=>this.getDiffModel().createCommentOnLine(t,i)}
        @mouseenter=${()=>Jn(this,"line-mouse-enter",{lineNum:t,side:i})}
        @mouseleave=${()=>Jn(this,"line-mouse-leave",{lineNum:t,side:i})}
      >${t===Au?"FILE":t.toString()}</button>
    `}computeLineNumberAriaLabel(e,t){if(t===Au)return"Add file comment";if(!(t===Ru||"number"==typeof t&&t<=0))switch(e.type){case Iu.REMOVE:return`${t} removed`;case Iu.ADD:return`${t} added`;case Iu.BOTH:case Iu.BLANK:return`${t} unmodified`}}renderContentCell(e){if(!this.columns.leftContent&&e===$u.LEFT)return uc;if(!this.columns.rightContent&&e===$u.RIGHT)return uc;let t=this.line(e);this.unifiedDiff&&t?.type===Iu.BLANK&&(e=$u.LEFT,t=this.line($u.LEFT));const i=this.lineNumber(e);ba(t,"line");const r=[t.type,e];return t.type!==Iu.BLANK&&r.push("content"),t.hasIntralineInfo||r.push("no-intraline-info"),t.beforeNumber===Au&&r.push("file"),t.beforeNumber===Ru&&r.push("lost"),dc`
      <td
        ${kR(this.contentCellRef(e))}
        class=${r.join(" ")}
        @click=${()=>{i&&this.getDiffModel().selectLine(i,e)}}
        @mouseenter=${()=>{i&&Jn(this,"line-mouse-enter",{lineNum:i,side:e})}}
        @mouseleave=${()=>{i&&Jn(this,"line-mouse-leave",{lineNum:i,side:e})}}
      >${this.renderText(e)}${this.renderLostMessage(e)}${this.renderThreadGroup(e)}</td>
    `}renderSignCell(e){if(!this.columns.leftSign&&e===$u.LEFT)return uc;if(!this.columns.rightSign&&e===$u.RIGHT)return uc;const t=this.line(e);ba(t,"line");const i=t.type===Iu.BLANK,r=t.type===Iu.ADD&&e===$u.RIGHT,o=t.type===Iu.REMOVE&&e===$u.LEFT,s=["sign",e];i&&s.push("blank"),r&&s.push("add"),o&&s.push("remove"),t.hasIntralineInfo||s.push("no-intraline-info");const n=r?"+":o?"-":"";return dc`<td class=${s.join(" ")}>${n}</td>`}renderLostMessage(e){return this.lineNumber(e)!==Ru||0===this.getComments(e).length?uc:dc`<div class="lost-message"
      ><gr-icon icon="info"></gr-icon
      ><span>Original comment position not found in this patchset</span
    ></div>`}renderThreadGroup(e){return this.lineNumber(e)&&(0!==this.getComments(e).length||this.unifiedDiff&&0!==this.getComments(Ek(e)).length)?dc`<div class="thread-group" data-side=${e}>
      ${this.renderSlot(e)}
      ${eb(this.unifiedDiff,(()=>this.renderSlot(Ek(e))))}
    </div>`:uc}renderSlot(e){const t=this.lineNumber(e);return t?0===this.getComments(e).length?uc:dc`
      ${this.renderRangedCommentHints(e)}
      <slot name="${e}-${t}"></slot>
    `:uc}renderRangedCommentHints(e){const t=this.getComments(e).map((e=>e.range)).filter(cf).filter(pk);return t.map((e=>dc`
          <gr-ranged-comment-hint .range=${e}></gr-ranged-comment-hint>
        `))}contentRef(e){return e===$u.LEFT?this.contentLeftRef:this.contentRightRef}contentCellRef(e){return e===$u.LEFT?this.contentCellLeftRef:this.contentCellRightRef}lineNumberRef(e){return e===$u.LEFT?this.lineNumberLeftRef:this.lineNumberRightRef}lineNumber(e){return this.line(e)?.lineNumber(e)}line(e){return e===$u.LEFT?this.left:this.right}getComments(e){return e===$u.LEFT?this.leftComments:this.rightComments}getType(e){if(!this.unifiedDiff)return e===$u.LEFT?this.left?.type:e===$u.RIGHT?this.right?.type:void 0}unifiedType(){return this.left?.type===Iu.BLANK?this.right?.type:this.left?.type}renderText(e){const t=this.line(e);if("number"!=typeof this.lineNumber(e))return;const i=this.layersApplied?"":dc`<gr-diff-text
          ${kR(this.contentRef(e))}
          data-side=${Vw(e)}
          .text=${t?.text??""}
          .tabSize=${this.tabSize}
          .lineLimit=${this.lineLength}
          .isResponsive=${hk(this.responsiveMode)}
        ></gr-diff-text>`;return dc`<div
        class="contentText"
        data-side=${Vw(e)}
        id=${this.contentId(e)}
      >${i}</div>`}renderPostLineSlot(e){const t=this.lineNumber(e);return t&&Number.isInteger(t)?dc`<slot name="post-${e}-line-${t}"></slot>`:uc}}OR([Fc({type:Object})],DR.prototype,"left",void 0),OR([Fc({type:Object})],DR.prototype,"right",void 0),OR([Fc({type:Object})],DR.prototype,"responsiveMode",void 0),OR([Fc({type:Boolean})],DR.prototype,"unifiedDiff",void 0),OR([Fc({type:Number})],DR.prototype,"tabSize",void 0),OR([Fc({type:Number})],DR.prototype,"lineLength",void 0),OR([Fc({type:Boolean})],DR.prototype,"hideFileCommentButton",void 0),OR([Fc({type:Object})],DR.prototype,"layers",void 0),OR([Uc()],DR.prototype,"addTableWrapperForTesting",void 0),OR([Uc()],DR.prototype,"leftComments",void 0),OR([Uc()],DR.prototype,"rightComments",void 0),OR([Uc()],DR.prototype,"columns",void 0),OR([Uc()],DR.prototype,"blameInfo",void 0),customElements.define("gr-diff-row",DR);var LR,MR=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};class FR extends Ic{constructor(){super(),this.layers=[],this.lineLength=100,this.columns=uR,this.addTableWrapperForTesting=!1,this.viewMode=Su.SIDE_BY_SIDE,this.getDiffModel=yu(this,gR),zf(this,(()=>this.getDiffModel().lineLength$),(e=>this.lineLength=e)),zf(this,(()=>this.getDiffModel().viewMode$),(e=>this.viewMode=e)),zf(this,(()=>this.getDiffModel().diff$),(e=>this.diff=e)),zf(this,(()=>this.getDiffModel().renderPrefs$),(e=>this.renderPrefs=e)),zf(this,(()=>this.getDiffModel().diffPrefs$),(e=>this.diffPrefs=e)),zf(this,(()=>this.getDiffModel().layers$),(e=>this.layers=e)),zf(this,(()=>this.getDiffModel().columnsToShow$),(e=>this.columns=e))}createRenderRoot(){return this}async getUpdateComplete(){const e=await super.getUpdateComplete(),t=[...this.diffRows??[]];return await Promise.all(t.map((e=>e.updateComplete))),e}render(){if(!this.group)return;const e=[];e.push("section"),e.push(this.group.type),this.group.isTotal()&&e.push("total"),this.group.dueToRebase&&e.push("dueToRebase"),this.group.moveDetails&&e.push("dueToMove"),this.group.ignoredWhitespaceOnly&&e.push("ignoredWhitespaceOnly");const t=this.getLinePairs(),i=ck(this.diffPrefs,this.renderPrefs),r=!1===this.diffPrefs?.show_file_comment_button||!1===this.renderPrefs?.show_file_comment_button,o=dc`
      <tbody class=${e.join(" ")}>
        ${this.renderContextControls()} ${this.renderMoveControls()}
        ${t.map((e=>{const t=`left-${e.left.lineNumber($u.LEFT)}`,o=`right-${e.right.lineNumber($u.RIGHT)}`;return dc`
            <gr-diff-row
              class="${t} ${o}"
              .left=${e.left}
              .right=${e.right}
              .layers=${this.layers}
              .lineLength=${this.diffPrefs?.line_length??80}
              .tabSize=${this.diffPrefs?.tab_size??2}
              .unifiedDiff=${this.isUnifiedDiff()}
              .responsiveMode=${i}
              .hideFileCommentButton=${r}
            >
            </gr-diff-row>
          `}))}
      </tbody>
    `;return this.addTableWrapperForTesting?dc`<table>
        ${o}
      </table>`:o}isUnifiedDiff(){return this.viewMode===Su.UNIFIED}getLinePairs(){return this.group?this.group.type===QA.CONTEXT_CONTROL?[]:this.isUnifiedDiff()?this.group.getUnifiedPairs():this.group.getSideBySidePairs():[]}getDiffRows(){return[...this.querySelectorAll("gr-diff-row")]}renderContextControls(){if(this.group?.type===QA.CONTEXT_CONTROL)return dc`
      <gr-context-controls-section .group=${this.group}>
      </gr-context-controls-section>
    `}findRow(e,t){return this.querySelector(`gr-diff-row.${e}-${t}`)??void 0}renderMoveControls(){if(!this.group?.moveDetails)return;const e=this.group.adds.length>0,t=dc`<td></td>`,i=dc`
      <td class="moveHeader">
        <gr-range-header icon="move_item">
          ${this.renderMoveDescription(e)}
        </gr-range-header>
      </td>
    `;return dc`
      <tr class=${["moveControls",e?"movedIn":"movedOut"].join(" ")}>
        ${eb(this.columns.blame,(()=>dc`<td class="blame"></td>`))}
        ${eb(this.columns.leftNumber,(()=>dc`<td class="moveControlsLineNumCol"></td>`))}
        ${eb(this.columns.leftSign,(()=>dc`<td class="sign"></td>`))}
        ${eb(this.columns.leftContent,(()=>e?t:i))}
        ${eb(this.columns.rightNumber,(()=>dc`<td class="moveControlsLineNumCol"></td>`))}
        ${eb(this.columns.rightSign,(()=>dc`<td class="sign"></td>`))}
        ${eb(this.columns.rightContent,(()=>e||this.isUnifiedDiff()?i:t))}
      </tr>
    `}renderMoveDescription(e){if(this.group?.moveDetails?.range){const{changed:t,range:i}=this.group.moveDetails,r=e?$u.LEFT:$u.RIGHT;return dc`
        <div>
          <span>${`Moved ${t?"and changed ":""}${e?"from":"to"} lines `}</span>
          ${this.renderMovedLineAnchor(i.start,r)}
          <span> - </span>
          ${this.renderMovedLineAnchor(i.end,r)}
        </div>
      `}return dc`
      <div>
        <span>${e?"Moved in":"Moved out"}</span>
      </div>
    `}renderMovedLineAnchor(e,t){return dc`<a href=${`#${e}`} @click=${i=>{i.preventDefault(),this.handleMovedLineAnchorClick(i.target,t,e)}}>${e}</a>`}handleMovedLineAnchorClick(e,t,i){e&&Jn(e,"moved-link-clicked",{lineNum:i,side:t})}}function UR(e,t=!0){const i=function(e){return e===LR.SYMLINK?"symlink":e===LR.REGULAR_FILE?"regular":e===LR.EXECUTABLE_FILE?"executable":e===LR.GITLINK?"gitlink":""}(e),r=e?.toString(8);return`${i}${t&&i?` (${r})`:""}`}function BR(e){if(!e)return e;for(const t of Object.values(LR)){const i=t?.toString(8);if(e.includes(i))return e.replace(i,`${UR(t)}`)}return e}function HR(e){const t=e.lastIndexOf(".");return-1===t?"":e.substring(t+1)}function jR(e,t=!0){if(!e)return(t?"+/-":"")+"0 B";const i=Math.floor(Math.log(Math.abs(e))/Math.log(1024));return`${t&&e>0?"+":""}${parseFloat((e/Math.pow(1024,i)).toFixed(1))} ${["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"][i]}`}MR([Gc("gr-diff-row")],FR.prototype,"diffRows",void 0),MR([Fc({type:Object})],FR.prototype,"group",void 0),MR([Uc()],FR.prototype,"diff",void 0),MR([Uc()],FR.prototype,"renderPrefs",void 0),MR([Uc()],FR.prototype,"diffPrefs",void 0),MR([Uc()],FR.prototype,"layers",void 0),MR([Uc()],FR.prototype,"lineLength",void 0),MR([Uc()],FR.prototype,"columns",void 0),MR([Uc()],FR.prototype,"addTableWrapperForTesting",void 0),MR([Uc()],FR.prototype,"viewMode",void 0),customElements.define("gr-diff-section",FR),function(e){e[e.SYMLINK=40960]="SYMLINK",e[e.REGULAR_FILE=33188]="REGULAR_FILE",e[e.EXECUTABLE_FILE=33261]="EXECUTABLE_FILE",e[e.GITLINK=57344]="GITLINK"}(LR||(LR={}));var GR=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};class zR extends Ic{createRenderRoot(){return this}constructor(){super(),this.diffPrefs={context:10,cursor_blink_rate:0,font_size:12,ignore_whitespace:"IGNORE_NONE",line_length:100,line_wrapping:!1,show_line_endings:!0,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8},this.renderPrefs={},this.viewMode=Su.SIDE_BY_SIDE,this.groups=[],this.showFullContext=wk.UNDECIDED,this.responsiveMode="NONE",this.loading=!0,this.columns=uR,this.columnCount=0,this.binaryDiffHint="",this.getDiffModel=yu(this,gR),zf(this,(()=>this.getDiffModel().diff$),(e=>this.diff=e)),zf(this,(()=>this.getDiffModel().baseImage$),(e=>this.baseImage=e)),zf(this,(()=>this.getDiffModel().revisionImage$),(e=>this.revisionImage=e)),zf(this,(()=>this.getDiffModel().diffPrefs$),(e=>this.diffPrefs=e)),zf(this,(()=>this.getDiffModel().renderPrefs$),(e=>this.renderPrefs=e)),zf(this,(()=>this.getDiffModel().columnsToShow$),(e=>this.columns=e)),zf(this,(()=>this.getDiffModel().columnCount$),(e=>this.columnCount=e)),zf(this,(()=>this.getDiffModel().viewMode$),(e=>this.viewMode=e)),zf(this,(()=>this.getDiffModel().showFullContext$),(e=>this.showFullContext=e)),zf(this,(()=>this.getDiffModel().errorMessage$),(e=>this.errorMessage=e)),zf(this,(()=>this.getDiffModel().groups$),(e=>this.groups=e)),zf(this,(()=>this.getDiffModel().loading$),(e=>this.loading=e)),zf(this,(()=>this.getDiffModel().responsiveMode$),(e=>this.responsiveMode=e))}async getUpdateComplete(){const e=await super.getUpdateComplete(),t=[...this.diffSections??[]];return await Promise.all(t.map((e=>e.updateComplete))),e}updated(){this.diffSections?.length&&this.fireRenderContent()}async fireRenderContent(){await this.updateComplete,Jn(this,"render-content",{}),Jn(this,"render",{})}render(){return Jn(this.diffTable,"render-start",{}),dc`
      ${this.renderHeader()} ${this.renderContainer()}
      ${this.renderNewlineWarning()} ${this.renderLoadingError()}
    `}renderHeader(){const e=this.computeDiffHeaderItems();return 0===e.length?uc:dc`
      <div id="diffHeader">
        ${e.map((e=>dc`<div>${e}</div>`))}
      </div>
    `}renderContainer(){const e={diffContainer:!0,unified:this.viewMode===Su.UNIFIED,sideBySide:this.viewMode===Su.SIDE_BY_SIDE,canComment:!!this.renderPrefs.can_comment},t={responsive:hk(this.responsiveMode)},i=!!this.diff?.binary,r=kk(this.diff),o=Dn()&&!window.getSelection().getComposedRanges;return dc`
      <div class=${th(e)}>
        <table
          id="diffTable"
          class=${th(t)}
          contenteditable=${o?"true":"false"}
        >
          ${this.renderColumns()}
          ${eb(!this.showWarning(),(()=>Mw(this.groups,(e=>e.id()),(e=>this.renderSectionElement(e)))))}
          ${eb(r,(()=>this.renderImageDiff()))}
          ${eb(!r&&i,(()=>this.renderBinaryDiff()))}
        </table>
        ${eb(this.showNoChangeMessage(),(()=>dc`
            <div class="whitespace-change-only-message">
              This file only contains whitespace changes. Modify the whitespace
              setting to see the changes.
            </div>
          `))}
        ${eb(this.showWarning(),(()=>this.renderSizeWarning()))}
      </div>
    `}renderNewlineWarning(){const e=this.computeNewlineWarning();return e?dc`<div class="newlineWarning">${e}</div>`:uc}renderLoadingError(){return this.errorMessage?dc`<div id="loadingError">${this.errorMessage}</div>`:uc}renderSizeWarning(){return this.showWarning()?dc`
      <div id="sizeWarning">
        <p>
          Prevented render because "Whole file" is enabled and this diff is very
          large (about ${$k(this.diff)} lines).
        </p>
        <gr-button @click=${this.collapseContext}>
          Render With Limited Context
        </gr-button>
        <gr-button @click=${this.handleFullBypass}>
          Render Anyway (may be slow)
        </gr-button>
      </div>
    `:uc}showNoChangeMessage(){return!this.loading&&this.diff&&!this.diff.binary&&"IGNORE_NONE"!==this.diffPrefs.ignore_whitespace&&0===$k(this.diff)}showWarning(){return-1===this.diffPrefs?.context&&this.showFullContext===wk.UNDECIDED&&$k(this.diff)>=1e4}computeDiffHeaderItems(){return(this.diff?.diff_header??[]).filter((e=>!(e.startsWith("diff --git ")||e.startsWith("index ")||e.startsWith("+++ ")||e.startsWith("--- ")||"Binary files differ"===e))).map(BR)}handleFullBypass(){this.getDiffModel().updateState({showFullContext:wk.YES})}collapseContext(){this.getDiffModel().updateState({showFullContext:wk.NO})}computeNewlineWarning(){const e=[];if(this.renderPrefs.show_newline_warning_left&&e.push("No newline at end of left file."),this.renderPrefs.show_newline_warning_right&&e.push("No newline at end of right file."),e.length)return e.join(" — ")}renderImageDiff(){return eb(this.renderPrefs.use_new_image_diff_ui,(()=>this.renderImageDiffNew()),(()=>this.renderImageDiffOld()))}renderImageDiffNew(){const e=!!this.renderPrefs?.image_diff_prefs?.automatic_blink;return dc`
      <gr-diff-image-new
        .automaticBlink=${e}
        .baseImage=${this.baseImage??void 0}
        .revisionImage=${this.revisionImage??void 0}
        .columnCount=${this.columnCount}
      ></gr-diff-image-new>
    `}renderImageDiffOld(){return dc`
      <gr-diff-image-old
        .baseImage=${this.baseImage??void 0}
        .revisionImage=${this.revisionImage??void 0}
        .columnCount=${this.columnCount}
      ></gr-diff-image-old>
    `}renderBinaryDiff(){return dc`
      <tbody class="binary-diff">
        <tr>
          <td colspan=${this.columnCount}>
            <span>Difference in binary files.${this.binaryDiffHint}</span>
          </td>
        </tr>
      </tbody>
    `}renderSectionElement(e){const t=`left-${e.startLine($u.LEFT)}`,i=`right-${e.startLine($u.RIGHT)}`;return this.diff?.binary&&e.startLine($u.LEFT)===Ru?uc:dc`
      <gr-diff-section
        class="${t} ${i}"
        .group=${e}
      ></gr-diff-section>
    `}renderColumns(){const e=4*(this.diffPrefs??{context:10,cursor_blink_rate:0,font_size:12,ignore_whitespace:"IGNORE_NONE",line_length:100,line_wrapping:!1,show_line_endings:!0,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8}).font_size;return dc`
      <colgroup>
        ${eb(this.columns.blame,(()=>dc`<col class="blame" />`))}
        ${eb(this.columns.leftNumber,(()=>dc`<col class="left" width=${e} />`))}
        ${eb(this.columns.leftSign,(()=>dc`<col class="left sign" />`))}
        ${eb(this.columns.leftContent,(()=>dc`<col class="left" />`))}
        ${eb(this.columns.rightNumber,(()=>dc`<col class="right" width=${e} />`))}
        ${eb(this.columns.rightSign,(()=>dc`<col class="right sign" />`))}
        ${eb(this.columns.rightContent,(()=>dc`<col class="right" />`))}
      </colgroup>
    `}}function VR(e){return t=>WR(e)===WR(t)}function WR(e){return e.id?e.id:`${e.side}-${function(e){return`${e.start_line??0}-${e.start_character??0}-${e.end_line??0}-${e.end_character??0}`}(e.range)}`}GR([Hc("#diffTable")],zR.prototype,"diffTable",void 0),GR([Gc("gr-diff-section")],zR.prototype,"diffSections",void 0),GR([Uc()],zR.prototype,"diff",void 0),GR([Uc()],zR.prototype,"baseImage",void 0),GR([Uc()],zR.prototype,"revisionImage",void 0),GR([Uc()],zR.prototype,"diffPrefs",void 0),GR([Uc()],zR.prototype,"renderPrefs",void 0),GR([Uc()],zR.prototype,"viewMode",void 0),GR([Uc()],zR.prototype,"groups",void 0),GR([Uc()],zR.prototype,"showFullContext",void 0),GR([Uc()],zR.prototype,"errorMessage",void 0),GR([Uc()],zR.prototype,"responsiveMode",void 0),GR([Uc()],zR.prototype,"loading",void 0),GR([Uc()],zR.prototype,"columns",void 0),GR([Uc()],zR.prototype,"columnCount",void 0),GR([Fc({type:String})],zR.prototype,"binaryDiffHint",void 0),customElements.define("gr-diff-element",zR);class qR{constructor(){this.knownRanges=[],this.listeners=[],this.rangesMap={left:{},right:{}}}annotate(e,t,i){let r=[];(i.type===Iu.REMOVE||i.type===Iu.BOTH&&e.getAttribute("data-side")!==$u.RIGHT)&&(r=this.getRangesForLine(i,$u.LEFT)),(i.type===Iu.ADD||i.type===Iu.BOTH&&e.getAttribute("data-side")!==$u.LEFT)&&(r=this.getRangesForLine(i,$u.RIGHT));for(const t of r)ok.annotateElement(e,t.start,t.end-t.start,(t.longRange?"range":"range rangeHighlight")+` ${Nn(t.id)}`)}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}notifyUpdateRange(e,t,i){for(const r of this.listeners)r(e,t,i)}updateRanges(e){for(const t of e)this.knownRanges.some(VR(t))||this.addRange(t);for(const t of this.knownRanges)e.some(VR(t))||this.removeRange(t);this.knownRanges=[...e]}addRange(e){const{side:t,range:i}=e,r=pk(i);this.updateRangesMap({side:t,range:i,operation:(t,i,o)=>{i!==o&&t.push({start:i,end:o,id:WR(e),longRange:r})}})}removeRange(e){const{side:t,range:i}=e;this.updateRangesMap({side:t,range:i,operation:t=>{const i=t.findIndex((t=>WR(e)===t.id));i>-1&&t.splice(i,1)}})}updateRangesMap(e){const{side:t,range:i,operation:r}=e,o=this.rangesMap[t]||(this.rangesMap[t]={});for(let e=i.start_line;e<=i.end_line;e++)r(o[e]||(o[e]=[]),e===i.start_line?i.start_character:0,e===i.end_line?i.end_character:-1);this.notifyUpdateRange(i.start_line,i.end_line,t)}getRangesForLine(e,t){const i=t===$u.LEFT?e.beforeNumber:e.afterNumber;return"number"!=typeof i?[]:(this.rangesMap[t][i]||[]).map((t=>((t={...t}).end=-1===t.end?e.text.length:t.end,t.start>t.end&&t.start<e.text.length&&(t.end=e.text.length),t)))}}const KR=Sd`
  :host {
    font-family: var(--monospace-font-family, ''), 'Roboto Mono';
    font-size: var(--font-size, var(--font-size-code, 12px));
    /* usually 16px = 12px + 4px */
    line-height: calc(
      var(--font-size, var(--font-size-code, 12px)) + var(--spacing-s, 4px)
    );
  }

  gr-diff-image-new,
  gr-diff-image-old,
  gr-diff-section,
  gr-context-controls-section,
  gr-diff-row {
    display: contents;
  }
`,YR=Sd`
  gr-diff-element div.diffContainer {
    max-width: var(--diff-max-width, none);
    font-family: var(--monospace-font-family);
  }
  gr-diff-element table {
    border-collapse: collapse;
    table-layout: fixed;
  }
  gr-diff-element table.responsive {
    width: 100%;
  }
  gr-diff-element div#diffHeader {
    background-color: var(--table-header-background-color);
    border-bottom: 1px solid var(--border-color);
    color: var(--link-color);
    padding: var(--spacing-m) 0 var(--spacing-m) 48px;
  }
  gr-diff-element table#diffTable:focus {
    outline: none;
  }
  gr-diff-element div#loadingError,
  gr-diff-element div#sizeWarning {
    display: block;
    margin: var(--spacing-l) auto;
    max-width: 60em;
    text-align: center;
  }
  gr-diff-element div#loadingError {
    color: var(--error-text-color);
  }
  gr-diff-element div#sizeWarning gr-button {
    margin: var(--spacing-l);
  }
  gr-diff-element div.newlineWarning {
    color: var(--deemphasized-text-color);
    text-align: center;
  }
  gr-diff-element div.newlineWarning.hidden {
    display: none;
  }
  gr-diff-element div.whitespace-change-only-message {
    background-color: var(--diff-context-control-background-color);
    border: 1px solid var(--diff-context-control-border-color);
    text-align: center;
  }
  gr-diff-element {
    /* for gr-selection-action-box positioning */
    position: relative;
    /* Firefox requires a block to position child elements absolutely */
    display: block;
  }
  gr-diff-element gr-selection-action-box {
    /* Needs z-index to appear above wrapped content, since it's inserted
       into DOM before it. */
    z-index: 120;
    position: absolute;
  }
  gr-diff-element gr-selection-action-box slot[invisible] {
    visibility: hidden;
  }
  gr-diff-element gr-selection-action-box gr-tooltip {
    position: absolute;
    width: 22ch;
    cursor: pointer;
  }
`,XR=Sd`
  :host(.disable-context-control-buttons) gr-diff-section tbody.section {
    border-right: none;
  }
  /* Context controls break up the table visually, so we set the right
     border on individual sections to leave a gap for the divider.

     Also taken into account for max-width calculations in SHRINK_ONLY mode
     (check GrDiff.updatePreferenceStyles). */
  gr-diff-section tbody.section {
    border-right: 1px solid var(--border-color);
  }
  gr-diff-section tbody.section.contextControl {
    /* Divider inside this section must not have border; we set borders on
       the padding rows below. */
    border-right-width: 0;
  }
  gr-diff-section tr.moveControls td.moveHeader a {
    color: inherit;
  }
  gr-diff-section tbody.contextControl {
    display: table-row-group;
    background-color: transparent;
    border: none;
    --divider-height: var(--spacing-s);
    --divider-border: 1px;
  }
  /* TODO: Is this still used? */
  gr-diff-section tbody.contextControl gr-button gr-icon {
    /* should match line-height of gr-button */
    font-size: var(--line-height-mono, 18px);
  }
  gr-diff-section tbody.contextControl td:not(.lineNumButton) {
    text-align: center;
  }
  /* Option to add side borders (left and right) to the line number column. */
  gr-diff-section tr.moveControls td.moveControlsLineNumCol {
    box-shadow: var(--line-number-box-shadow, unset);
  }
`,JR=Sd`
  /* Hide the actual context control buttons */
  :host(.disable-context-control-buttons)
    gr-diff-section
    tbody.contextControl
    gr-context-controls-section
    gr-context-controls {
    display: none;
  }
  /* Maintain a small amount of padding at the edges of diff chunks */
  :host(.disable-context-control-buttons)
    gr-diff-section
    tbody.contextControl
    gr-context-controls-section
    tr.contextBackground {
    height: var(--spacing-s);
    border-right: none;
  }
  gr-context-controls-section tr.contextBackground {
    /* One line of background behind the context expanders which they can
       render on top of, plus some padding. */
    height: calc(var(--line-height-normal) + var(--spacing-s));
  }
  /* Padding rows behind context controls. The diff is styled to be cut
     into two halves by the negative space of the divider on which the
     context control buttons are anchored. */
  gr-context-controls-section tr.contextBackground {
    border-right: 1px solid var(--border-color);
  }
  gr-context-controls-section tr.contextBackground.above {
    border-bottom: 1px solid var(--border-color);
  }
  gr-context-controls-section tr.contextBackground.below {
    border-top: 1px solid var(--border-color);
  }
  gr-context-controls-section tr.contextBackground td.contextLineNum {
    color: var(--deemphasized-text-color);
    padding: 0 var(--spacing-m);
    text-align: right;
  }
  /* Option to add side borders (left and right) to the line number column. */
  gr-context-controls-section tr.contextBackground td.contextLineNum {
    box-shadow: var(--line-number-box-shadow, unset);
  }
  /* Padding rows behind context controls. Styled as a continuation of the
     line gutters and code area. */
  gr-context-controls-section tr.contextBackground td.contextLineNum {
    background-color: var(--diff-blank-background-color);
  }
  gr-context-controls-section tr.contextBackground > td:not(.contextLineNum) {
    background-color: var(--view-background-color);
  }
  gr-context-controls-section td.dividerCell {
    vertical-align: top;
  }
  gr-context-controls-section tr.dividerRow.show-both td.dividerCell {
    height: var(--divider-height);
  }
  gr-context-controls-section tr.dividerRow.show-above td.dividerCell {
    height: 0;
  }
`,QR=Sd`
  gr-diff-row td.content div.thread-group {
    display: block;
    max-width: var(--content-width, 80ch);
    white-space: normal;
    background-color: var(--diff-blank-background-color);
  }
  gr-diff-row tr.target-row td.blame {
    background: var(--diff-selection-background-color);
  }
  gr-diff-row td.content.lost div {
    background-color: var(--info-background);
  }
  gr-diff-row td.content.lost div.lost-message {
    font-family: var(--font-family, 'Roboto');
    font-size: var(--font-size-normal, 14px);
    line-height: var(--line-height-normal);
    padding: var(--spacing-s) 0;
  }
  gr-diff-row td.content.lost div.lost-message gr-icon {
    padding: 0 var(--spacing-s) 0 var(--spacing-m);
    color: var(--blue-700);
  }
  gr-diff-row td.blame {
    padding: 0 var(--spacing-m);
    white-space: pre;
  }
  gr-diff-row td.blame > span {
    opacity: 0.6;
  }
  gr-diff-row td.blame > span.startOfRange {
    opacity: 1;
  }
  gr-diff-row td.blame .blameDate {
    font-family: var(--monospace-font-family);
    color: var(--link-color);
    text-decoration: none;
  }
  gr-diff-row td.content div.contentText gr-diff-text:empty:after,
  gr-diff-row td.content div.contentText:empty:after {
    /* Newline, to ensure empty lines are one line-height tall. */
    content: '\\A';
  }
  /* Option to add side borders (left and right) to the line number column. */
  gr-diff-row td.lineNum,
  gr-diff-row td.blankLineNum {
    box-shadow: var(--line-number-box-shadow, unset);
  }
  gr-diff-row td.lineNum,
  gr-diff-row td.blankLineNum {
    /* Enforces background whenever lines wrap */
    background-color: var(--diff-blank-background-color);
  }
  gr-diff-row td.lineNum button.lineNumButton {
    display: block;
    width: 100%;
    height: 100%;
    background-color: var(--diff-blank-background-color);
    box-shadow: var(--line-number-box-shadow, unset);
  }
  gr-diff-row td.lineNum {
    vertical-align: top;
  }
  /* The only way to focus this (clicking) will apply our own focus
     styling, so this default styling is not needed and distracting. */
  gr-diff-row td.lineNum button.lineNumButton:focus {
    outline: none;
  }
  gr-diff-row tr.diff-row {
    outline: none;
  }
  gr-diff-row
    tr.diff-row.target-row.target-side-left
    td.lineNum
    button.lineNumButton.left,
  gr-diff-row
    tr.diff-row.target-row.target-side-right
    td.lineNum
    button.lineNumButton.right,
  gr-diff-row tr.diff-row.target-row.unified td.lineNum button.lineNumButton {
    color: var(--primary-text-color);
  }
  /* Preparing selected line cells with position relative so it allows a
     positioned overlay with 'position: absolute'. */
  gr-diff-row tr.target-row td {
    position: relative;
  }
  /* Defines an overlay to the selected line for drawing an outline without
     blocking user interaction (e.g. text selection). */
  gr-diff-row tr.target-row td::before {
    border-width: 0;
    border-style: solid;
    border-color: var(--focused-line-outline-color);
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    user-select: none;
    content: ' ';
  }
  /* The outline for the selected content cell should be the same in all
     cases. */
  gr-diff-row tr.target-row.target-side-left td.left.content::before,
  gr-diff-row tr.target-row.target-side-right td.right.content::before,
  gr-diff-row tr.unified.target-row td.content::before {
    border-width: 1px 1px 1px 0;
  }
  /* The outline for the sign cell should be always be contiguous
     top/bottom. */
  gr-diff-row tr.target-row.target-side-left td.left.sign::before,
  gr-diff-row tr.target-row.target-side-right td.right.sign::before {
    border-width: 1px 0;
  }
  /* For side-by-side we need to select the correct line number to
     "visually close" the outline. */
  gr-diff-row
    tr.side-by-side.target-row.target-side-left
    td.left.lineNum::before,
  gr-diff-row
    tr.side-by-side.target-row.target-side-right
    td.right.lineNum::before {
    border-width: 1px 0 1px 1px;
  }
  /* For unified diff we always start the overlay from the left cell. */
  gr-diff-row tr.unified.target-row td.left:not(.content)::before {
    border-width: 1px 0 1px 1px;
  }
  /* For unified diff we should continue the top/bottom border in right
     line number column. */
  gr-diff-row tr.unified.target-row td.right:not(.content)::before {
    border-width: 1px 0;
  }
  gr-diff-row td.content {
    background-color: var(--diff-blank-background-color);
  }
  /* The file line, which has no contentText, add some margin before the
     first comment. We cannot add padding the container because we only
     want it if there is at least one comment thread, and the slotting
     makes :empty not work as expected. */
  gr-diff-row td.content.file slot:first-child::slotted(.comment-thread) {
    display: block;
    margin-top: var(--spacing-xs);
  }
  gr-diff-row td.content div.contentText {
    background-color: var(--view-background-color);
  }
  gr-diff-row td.blank {
    background-color: var(--diff-blank-background-color);
  }
  gr-diff-element div.canComment gr-diff-row td.lineNum button.lineNumButton {
    cursor: pointer;
  }
  gr-diff-row td.sign {
    min-width: 1ch;
    width: 1ch;
    background-color: var(--view-background-color);
  }
  gr-diff-row td.sign.blank {
    background-color: var(--diff-blank-background-color);
  }
  gr-diff-row td.content {
    /* Set min width since setting width on table cells still allows them
       to shrink. Do not set max width because CJK
       (Chinese-Japanese-Korean) glyphs have variable width. */
    min-width: var(--content-width, 80ch);
    width: var(--content-width, 80ch);
  }
  /* If there are no intraline info, consider everything changed */
  gr-diff-row td.content.add div.contentText .intraline,
  gr-diff-row td.content.add.no-intraline-info div.contentText,
  gr-diff-row td.sign.add.no-intraline-info,
  gr-diff-section tbody.delta.total gr-diff-row td.content.add div.contentText {
    background-color: var(--dark-add-highlight-color);
    &:has(.is-out-of-focus-range) {
      background-color: transparent;
      .intraline {
        background-color: transparent;
      }
    }
  }
  gr-diff-row td.content.add div.contentText,
  gr-diff-row td.sign.add {
    background-color: var(--light-add-highlight-color);
    &:has(.is-out-of-focus-range) {
      background-color: transparent;
      .intraline {
        background-color: transparent;
      }
    }
  }
  /* If there are no intraline info, consider everything changed */
  gr-diff-row td.content.remove div.contentText .intraline,
  gr-diff-row td.content.remove.no-intraline-info div.contentText,
  gr-diff-section
    tbody.delta.total
    gr-diff-row
    td.content.remove
    div.contentText,
  gr-diff-row td.sign.remove.no-intraline-info {
    background-color: var(--dark-remove-highlight-color);
    &:has(.is-out-of-focus-range) {
      background-color: transparent;
    }
  }
  gr-diff-row td.content.remove div.contentText,
  gr-diff-row td.sign.remove {
    background-color: var(--light-remove-highlight-color);
    &:has(.is-out-of-focus-range) {
      background-color: transparent;
    }
  }
  gr-diff-element table.responsive gr-diff-row td.content div.contentText {
    white-space: break-spaces;
    word-break: break-all;
  }
  gr-diff-row td.lineNum button.lineNumButton,
  td.content {
    vertical-align: top;
    white-space: pre;
  }
  gr-diff-row td.lineNum button.lineNumButton {
    color: var(--deemphasized-text-color);
    padding: 0 var(--spacing-m);
    text-align: right;
  }
  gr-diff-element table.responsive gr-diff-row td.blame {
    overflow: hidden;
    width: 200px;
  }
  /** Support the line length indicator **/
  gr-diff-element table.responsive gr-diff-row td.content div.contentText {
    /* Same strategy as in
       https://stackoverflow.com/questions/1179928/how-can-i-put-a-vertical-line-down-the-center-of-a-div
       */
    background-image: linear-gradient(
      var(--line-length-indicator-color),
      var(--line-length-indicator-color)
    );
    background-size: 1px 100%;
    background-position: var(--line-limit-marker) 0;
    background-repeat: no-repeat;
  }
  gr-diff-row td.lineNum.COVERED button.lineNumButton {
    color: var(
      --coverage-covered-line-num-color,
      var(--deemphasized-text-color)
    );
    background-color: var(--coverage-covered, #e0f2f1);
  }
  gr-diff-row td.lineNum.NOT_COVERED button.lineNumButton {
    color: var(
      --coverage-covered-line-num-color,
      var(--deemphasized-text-color)
    );
    background-color: var(--coverage-not-covered, #ffd1a4);
  }
  gr-diff-row td.lineNum.PARTIALLY_COVERED button.lineNumButton {
    color: var(
      --coverage-covered-line-num-color,
      var(--deemphasized-text-color)
    );
    background: linear-gradient(
      to right bottom,
      var(--coverage-not-covered, #ffd1a4) 0%,
      var(--coverage-not-covered, #ffd1a4) 50%,
      var(--coverage-covered, #e0f2f1) 50%,
      var(--coverage-covered, #e0f2f1) 100%
    );
  }
`,ZR=Sd`
  gr-diff-section
    tbody.ignoredWhitespaceOnly
    gr-diff-row
    td.sign.no-intraline-info,
  gr-diff-section
    tbody.ignoredWhitespaceOnly
    gr-diff-row
    td.content.add
    div.contentText
    .intraline,
  gr-diff-section
    tbody.delta.total.ignoredWhitespaceOnly
    gr-diff-row
    td.content.add
    div.contentText,
  gr-diff-section
    tbody.ignoredWhitespaceOnly
    gr-diff-row
    td.content.add
    div.contentText,
  gr-diff-section
    tbody.ignoredWhitespaceOnly
    gr-diff-row
    td.content.remove
    div.contentText
    .intraline,
  gr-diff-section
    tbody.delta.total.ignoredWhitespaceOnly
    gr-diff-row
    td.content.remove
    div.contentText,
  gr-diff-section
    tbody.ignoredWhitespaceOnly
    gr-diff-row
    td.content.remove
    div.contentText {
    background-color: var(--view-background-color);
  }
`,eT=Sd`
  gr-diff-section tbody.dueToMove gr-diff-row .sign.add,
  gr-diff-section tbody.dueToMove gr-diff-row td.content.add div.contentText,
  gr-diff-section tbody.dueToMove tr.moveControls.movedIn .sign.right,
  gr-diff-section tbody.dueToMove tr.moveControls.movedIn td.moveHeader,
  gr-diff-section tbody.delta.total.dueToMove td.content.add div.contentText {
    background-color: var(--diff-moved-in-background);
  }

  gr-diff-section tbody.dueToMove .sign.remove,
  gr-diff-section tbody.dueToMove td.content.remove div.contentText,
  gr-diff-section tbody.dueToMove tr.moveControls.movedOut td.moveHeader,
  gr-diff-section tbody.dueToMove tr.moveControls.movedOut .sign.left,
  gr-diff-section
    tbody.delta.total.dueToMove
    td.content.remove
    div.contentText {
    background-color: var(--diff-moved-out-background);
  }

  gr-diff-section tbody.delta.dueToMove tr.movedIn td.moveHeader {
    --gr-range-header-color: var(--diff-moved-in-label-color);
  }
  gr-diff-section tbody.delta.dueToMove tr.movedOut td.moveHeader {
    --gr-range-header-color: var(--diff-moved-out-label-color);
  }
`,tT=Sd`
  gr-diff-section
    tbody.dueToRebase
    gr-diff-row
    td.content.add
    div.contentText
    .intraline,
  gr-diff-section
    tbody.delta.total.dueToRebase
    gr-diff-row
    td.content.add
    div.contentText {
    background-color: var(--dark-rebased-add-highlight-color);
  }
  gr-diff-section tbody.dueToRebase gr-diff-row td.content.add div.contentText {
    background-color: var(--light-rebased-add-highlight-color);
  }
  gr-diff-section
    tbody.dueToRebase
    gr-diff-row
    td.content.remove
    div.contentText
    .intraline,
  gr-diff-section
    tbody.delta.total.dueToRebase
    gr-diff-row
    td.content.remove
    div.contentText {
    background-color: var(--dark-rebased-remove-highlight-color);
  }
  gr-diff-section
    tbody.dueToRebase
    gr-diff-row
    td.content.remove
    div.contentText {
    background-color: var(--light-rebased-remove-highlight-color);
  }
`,iT=Sd`
  /* by default do not allow selecting anything */
  gr-context-controls-section .contextLineNum,
  gr-diff-row td.lineNum button.lineNumButton,
  gr-diff-row tr.diff-row,
  gr-diff-row td.content,
  gr-diff-section tbody.contextControl,
  gr-diff-row td.blame,
  #diffHeader {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  /* selected-left */
  gr-diff-element.selected-left:not(.selected-comment)
    gr-diff-row
    tr.side-by-side
    td.left
    + td.content
    div.contentText,
  gr-diff-element.selected-left:not(.selected-comment)
    gr-diff-row
    tr.unified
    td.left.lineNum
    ~ td.content:not(.both)
    div.contentText {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }
  /* selected-right */
  gr-diff-element.selected-right:not(.selected-comment)
    gr-diff-row
    tr.side-by-side
    td.right
    + td.content
    div.contentText,
  gr-diff-element.selected-right:not(.selected-comment)
    gr-diff-row
    tr.unified
    td.right.lineNum
    ~ td.content
    div.contentText {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }
  /* selected-comment */
  gr-diff-element.selected-left.selected-comment
    gr-diff-row
    tr.side-by-side
    td.left
    + td.content
    div.thread-group
    .message,
  gr-diff-element.selected-left.selected-comment
    ::slotted(.comment-thread[diff-side='left']),
  gr-diff-element.selected-right.selected-comment
    gr-diff-row
    tr.side-by-side
    td.right
    + td.content
    div.thread-group
    .message
    :not(.collapsedContent),
  gr-diff-element.selected-right.selected-comment
    ::slotted(.comment-thread[diff-side='right']),
  gr-diff-element.selected-comment
    gr-diff-row
    tr.unified
    td.content
    div.thread-group
    .message
    :not(.collapsedContent) {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }
  /* selected-blame */
  gr-diff-element.selected-blame gr-diff-row td.blame {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }
`,rT=Sd`
  /* The background color for tokens of the "token-highlight-layer". */
  gr-diff-text hl.token-highlight {
    background-color: var(--token-highlighting-color, #fffd54);
  }
  /* We do not want token highlighting to override the "rangeHighlight"
    color, so let's make sure that there are no "rangeHighlight" element
    parents that wrap the "token-highlight" element.
  */
  gr-diff-text hl.rangeHighlight hl.token-highlight {
    background-color: transparent;
  }
  /* Describes two states of semantic tokens: whenever a token has a
     definition that can be navigated to (navigable) and whenever
     the token is actually clickable to perform this navigation. */
  gr-diff-text .semantic-token.navigable {
    text-decoration-style: dotted;
    text-decoration-line: underline;
  }
  gr-diff-text .semantic-token.navigable.clickable {
    text-decoration-style: solid;
    cursor: pointer;
  }
  gr-diff-text .br:after {
    /* Line feed */
    content: '\\A';
  }
  gr-diff-text .tab {
    display: inline-block;
  }
  gr-diff-text .tab-indicator:before {
    color: var(--diff-tab-indicator-color);
    /* >> character */
    content: '\\00BB';
    position: absolute;
  }
  gr-diff-text .special-char-indicator {
    /* spacing so elements don't collide */
    padding-right: var(--spacing-m);
  }
  gr-diff-text .special-char-indicator:before {
    color: var(--diff-tab-indicator-color);
    content: '•';
    position: absolute;
  }
  gr-diff-text .special-char-warning {
    /* spacing so elements don't collide */
    padding-right: var(--spacing-m);
  }
  gr-diff-text .special-char-warning:before {
    color: var(--warning-foreground);
    content: '!';
    position: absolute;
  }
  /* Is defined after other background-colors, such that this
     rule wins in case of same specificity. */
  td.content div.contentText gr-diff-text .trailing-whitespace,
  td.content div.contentText gr-diff-text .trailing-whitespace .intraline {
    border-radius: var(--border-radius, 4px);
    background-color: var(--diff-trailing-whitespace-indicator);
  }
`,oT=Sd`
  gr-image-viewer {
    width: 100%;
    height: 100%;
    max-width: var(--image-viewer-max-width, 95vw);
    max-height: var(--image-viewer-max-height, 90vh);
    /* Defined by paper-styles default-theme and used in various
       components. background-color-secondary is a compromise between
       fairly light in light theme (where we ideally would want
       background-color-primary) yet slightly offset against the app
       background in dark mode, where drop shadows e.g. around paper-card
       are almost invisible. */
    --primary-background-color: var(--background-color-secondary);
  }
  tbody.image-diff .gr-diff {
    text-align: center;
  }
  tbody.image-diff img {
    box-shadow: var(--elevation-level-1);
    max-width: 50em;
  }
  tbody.image-diff button.right.lineNumButton {
    border-left: 1px solid var(--border-color);
  }
  tbody.image-diff label {
    font-family: var(--font-family);
    font-style: italic;
  }
  .image-diff td.content {
    background-color: var(--diff-blank-background-color);
  }
`,sT=Sd`
  gr-diff-element tbody.binary-diff td {
    font-family: var(--font-family);
    font-style: italic;
    text-align: center;
    padding: var(--spacing-s) 0;
  }
`,nT=new Map([[ku.COVERED,"Covered by tests."],[ku.NOT_COVERED,"Not covered by tests."],[ku.PARTIALLY_COVERED,"Partially covered by tests."],[ku.NOT_INSTRUMENTED,"Not instrumented by any tests."]]);class aT{constructor(e){this.side=e,this.coverageRanges=[],this.lastLineNumber=0,this.index=0,this.annotated=!1,this.listeners=[]}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}setRanges(e){const t=this.coverageRanges;0===t.length&&0===e.length||(this.coverageRanges=e,this.annotated&&this.notify([...t,...e]))}notify(e){const t=function(e){if(e.sort(((e,t)=>e.start-t.start)),e.length<=1)return e;const t=[];t.push(e[0]);for(let i=1;i<e.length;i++){const r=e[i],o=t[t.length-1];o.end<r.start?t.push(r):o.end<r.end&&(o.end=r.end)}return t}(e.map((e=>({start:e.code_range.start_line,end:e.code_range.end_line+1}))));for(const e of t)for(const t of this.listeners)t(e.start,e.end-1,this.side)}annotate(e,t){if(!this.side||!t||!t.classList.contains(this.side))return;let i;const r=t.getAttribute("data-value");if(r&&(i=Number(r)),i&&!(i<1))for(i<this.lastLineNumber&&(this.index=0),this.lastLineNumber=i,this.annotated=!0;this.index<this.coverageRanges.length;){const e=this.coverageRanges[this.index];if(!(this.lastLineNumber>e.code_range.end_line)){if(this.lastLineNumber<e.code_range.start_line)return;return t.classList.add(e.type),void(t.title=nT.get(e.type)||"")}this.index++}}}class lT{constructor(){this.annotated=!1,this.listeners=[]}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}setRanges(e){(this.previousUnfocusedRanges||e)&&(this.diffRangesToFocus=e,this.annotated&&this.notify({left:[...this.previousUnfocusedRanges?.left??[],...e?.left??[]],right:[...this.previousUnfocusedRanges?.right??[],...e?.right??[]]}),this.previousUnfocusedRanges=void 0)}notify(e){for(const t of e.left)for(const e of this.listeners)e(t.start,t.end,$u.LEFT);for(const t of e.right)for(const e of this.listeners)e(t.start,t.end,$u.RIGHT)}annotate(e,t,i,r){if(this.annotated=!0,!t||!e||!this.diffRangesToFocus)return;let o=-1;const s=t.getAttribute("data-value");if(s&&(o=Number(s)),!o||o<1)return;let n=[];r===$u.LEFT?n=this.diffRangesToFocus.left:r===$u.RIGHT&&(n=this.diffRangesToFocus.right),n.some((e=>o>=e.start&&o<=e.end))||(e.classList.add("is-out-of-focus-range"),this.updateUnfocusedRanges(o,r))}updateUnfocusedRanges(e,t){this.previousUnfocusedRanges={left:t===$u.LEFT?this.addToRange(e,this.previousUnfocusedRanges?.left):this.previousUnfocusedRanges?.left??[],right:t===$u.RIGHT?this.addToRange(e,this.previousUnfocusedRanges?.right):this.previousUnfocusedRanges?.right??[]}}addToRange(e,t){const i=[];t&&i.push(...t);let r=i.pop();return r?r.end+1===e?(r={start:r.start,end:e},i.push(r)):i.push(r,{start:e,end:e}):i.push({start:e,end:e}),i}}const dT="function"==typeof window.ShadowRoot.prototype.getSelection,cT="function"==typeof window.InputEvent.prototype.getTargetRanges,hT="diffTable";let pT=!1,uT=null;function gT(){return uT}Dn()&&!dT&&cT&&(window.addEventListener("selectionchange",(()=>{if(!pT){pT=!0;const e=On(document,!0);e&&e.id===hT&&document.execCommand("indent"),pT=!1}}),!0),window.addEventListener("beforeinput",(e=>{if(pT){const t=e;if("function"!=typeof t.getTargetRanges)return;const i=t.getTargetRanges()[0],r=new Range;r.setStart(i.startContainer,i.startOffset),r.setEnd(i.endContainer,i.endOffset),uT=r,e.preventDefault(),e.stopImmediatePropagation()}else{const t=On(document,!0);t&&t.id===hT&&(e.preventDefault(),e.stopImmediatePropagation())}}),!0),window.addEventListener("selectstart",(e=>{uT=null}),!0));var mT=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const fT=/\s+$/;class vT extends Ic{get loading(){return this._loading}set loading(e){if(this._loading===e)return;const t=this._loading;this._loading=e,Jn(this,"loading-changed",{value:this._loading}),this.requestUpdate("loading",t)}static get styles(){return[Nc,Pk,Ok,KR,YR,XR,JR,QR,ZR,eT,tT,iT,rT,oT,sT]}constructor(){super(),this.noAutoRender=!1,this.renderPrefs={},this.hidden=!1,this.coverageRanges=[],this.lineWrapping=!1,this.viewMode=Su.SIDE_BY_SIDE,this.binaryDiffHint="",this._loading=!0,this.loggedIn=!1,this.errorMessage=null,this.blame=null,this.showNewlineWarningLeft=!1,this.showNewlineWarningRight=!1,this.useNewImageDiffUi=!1,this.diffSelection=new Tk,this.highlights=new Ck,this.diffModel=new mR(this),this.layers=[],this.layersInternal=[],this.coverageLayerLeft=new aT($u.LEFT),this.coverageLayerRight=new aT($u.RIGHT),this.focusLayer=new lT,this.highlightLayer=new qR,this.groups=[],this.context=3,this.handleSelectionChange=()=>{const e=qn(this.shadowRoot,gT());this.highlights.handleSelectionChange(e,!1)},this.handleMouseUp=()=>{const e=qn(this.shadowRoot,gT());this.highlights.handleSelectionChange(e,!0)},this.commentThreadRedispatcher=(e,t)=>{if(!xk(e))return;const i=yk(e);i&&Jn(e,t,i)},this.commentThreadEnterRedispatcher=e=>{this.commentThreadRedispatcher(e.target,"comment-thread-mouseenter")},this.commentThreadLeaveRedispatcher=e=>{this.commentThreadRedispatcher(e.target,"comment-thread-mouseleave")},this.onDiffContextExpanded=e=>{this.diffModel.replaceGroup(e.detail.contextGroup,e.detail.groups)},bu(this,gR,(()=>this.diffModel)),zf(this,(()=>this.diffModel.context$),(e=>this.context=e)),zf(this,(()=>this.diffModel.groups$),(e=>this.groups=e)),this.addEventListener("moved-link-clicked",(e=>{this.diffModel.selectLine(e.detail.lineNum,e.detail.side)})),this.addEventListener("diff-context-expanded-internal-new",this.onDiffContextExpanded),this.layerUpdateListener=(e,t,i)=>this.requestRowUpdates(e,t,i),this.layersInternalInit()}connectedCallback(){super.connectedCallback(),this.loggedIn&&this.addSelectionListeners(),this.diff&&this.diffElement&&this.diffSelection.init(this.diff,this.diffElement),this.diffElement&&this.highlights.init(this.diffElement,this),this.observeNodes()}disconnectedCallback(){this.nodeObserver&&(this.nodeObserver.disconnect(),this.nodeObserver=void 0),this.removeSelectionListeners(),this.diffSelection.cleanup(),this.highlights.cleanup(),super.disconnectedCallback()}willUpdate(e){if((e.has("diff")||e.has("path")||e.has("renderPrefs")||e.has("viewMode")||e.has("loggedIn")||e.has("useNewImageDiffUi")||e.has("showNewlineWarningLeft")||e.has("showNewlineWarningRight")||e.has("prefs")||e.has("lineOfInterest")||e.has("diffRangesToFocus")||e.has("actionHoverCardText"))&&this.diff&&this.prefs){const e={...this.renderPrefs??{}};void 0===e.view_mode&&(e.view_mode=this.viewMode),void 0===e.can_comment&&(e.can_comment=this.loggedIn),void 0===e.use_new_image_diff_ui&&(e.use_new_image_diff_ui=this.useNewImageDiffUi),void 0===e.show_newline_warning_left&&(e.show_newline_warning_left=this.showNewlineWarningLeft),void 0===e.show_newline_warning_right&&(e.show_newline_warning_right=this.showNewlineWarningRight),this.diffModel.updateState({diff:this.diff,path:this.path,renderPrefs:e,diffPrefs:this.prefs,lineOfInterest:this.lineOfInterest,diffRangesToFocus:this.diffRangesToFocus})}e.has("baseImage")&&this.diffModel.updateState({baseImage:this.baseImage}),e.has("revisionImage")&&this.diffModel.updateState({revisionImage:this.revisionImage}),(e.has("path")||e.has("lineWrapping")||e.has("viewMode")||e.has("useNewImageDiffUi")||e.has("prefs"))&&this.prefsChanged(),e.has("layers")&&this.layersChanged(),e.has("blame")&&this.diffModel.updateState({blameInfo:this.blame??[]}),e.has("renderPrefs")&&this.renderPrefsChanged(),e.has("loggedIn")&&(this.loggedIn&&this.isConnected?this.addSelectionListeners():this.removeSelectionListeners()),e.has("coverageRanges")&&this.updateCoverageRanges(this.coverageRanges),e.has("lineOfInterest")&&this.lineOfInterestChanged(),e.has("diffRangesToFocus")&&this.updateFocusRanges(this.diffRangesToFocus),e.has("actionHoverCardText")&&this.actionHoverCardText&&this.diffModel.updateState({actionHoverCardText:this.actionHoverCardText}),e.has("highlightRange")&&this.updateHighlightLayer(this.diffModel.getState().comments)}async getUpdateComplete(){const e=await super.getUpdateComplete();return await(this.diffElement?.updateComplete),e}updated(e){e.has("diff")&&this.diffChanged(),e.has("groups")&&this.groups?.length>0&&(this.loading=!1)}render(){return dc`<gr-diff-element
      .binaryDiffHint=${this.binaryDiffHint}
    ></gr-diff-element>`}addSelectionListeners(){document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("mouseup",this.handleMouseUp)}removeSelectionListeners(){document.removeEventListener("selectionchange",this.handleSelectionChange),document.removeEventListener("mouseup",this.handleMouseUp)}getCursorStops(){if(this.hidden&&this.noAutoRender)return[];const e=this.getLineNumberRows();return this.loading&&e.push(new Vb),e}isRangeSelected(){return!!this.highlights.selectedRange}getSelectedRange(){if(this.highlights.selectedRange&&this.path)return{text_range:{start_line:this.highlights.selectedRange.range.start_line,start_column:this.highlights.selectedRange.range.start_character,end_line:this.highlights.selectedRange.range.end_line,end_column:this.highlights.selectedRange.range.end_character},file_path:this.path,side:this.highlights.selectedRange.side}}selectLine(e){const t=Number(e.getAttribute("data-value")),i=e.classList.contains("left")?$u.LEFT:$u.RIGHT;this.diffModel.selectLine(t,i)}addDraftAtLine(e,t){this.diffModel.createCommentOnLine(e,t)}createRangeComment(){const e=this.highlights.selectedRange;ba(e,"no range selected");const{side:t,range:i}=e;this.diffModel.createCommentOnRange(i,t)}isShowFullContext(){return this.diffModel.getState().showFullContext===wk.YES}lineOfInterestChanged(){if(this.loading)return;if(!this.lineOfInterest)return;const e=this.lineOfInterest.lineNum;"number"==typeof e&&this.unhideLine(e,this.lineOfInterest.side)}prefsChanged(){this.prefs&&(this.updatePreferenceStyles(),(!Number.isInteger(this.prefs.tab_size)||this.prefs.tab_size<=0)&&this.handlePreferenceError("tab size"),(!Number.isInteger(this.prefs.line_length)||this.prefs.line_length<=0)&&this.handlePreferenceError("diff width"))}updatePreferenceStyles(){ba(this.prefs,"prefs");const e="/COMMIT_MSG"===this.path?72:this.prefs.line_length,t="SIDE_BY_SIDE"===this.viewMode,i=ck(this.prefs,this.renderPrefs),r=hk(i),o=`${e}ch`;if(this.style.setProperty("--line-limit-marker","FULL_RESPONSIVE"===i?o:"-1px"),this.style.setProperty("--content-width",r?"none":o),"SHRINK_ONLY"===i){const e=`${t?2:1} * ${o}`,i=`2 * ${s=this.prefs,4*s.font_size}px`,r="1px",n=t&&this.renderPrefs?.show_sign_col?"2ch":"0ch",a="2px";this.style.setProperty("--diff-max-width",`calc(${e} + ${i} + ${n} + ${r} + ${a})`)}else this.style.setProperty("--diff-max-width","none");var s;this.prefs.font_size&&this.style.setProperty("--font-size",`${this.prefs.font_size}px`)}renderPrefsChanged(){this.classList.toggle("disable-context-control-buttons",!!this.renderPrefs.disable_context_control_buttons),this.classList.toggle("hide-line-length-indicator",!!this.renderPrefs.hide_line_length_indicator),this.classList.toggle("with-sign-col",!!this.renderPrefs.show_sign_col),this.prefs&&this.updatePreferenceStyles()}diffChanged(){this.loading=!0,this.diff&&this.diffElement&&(this.diffSelection.init(this.diff,this.diffElement),this.highlights.init(this.diffElement,this))}observeNodes(){this.nodeObserver||(this.nodeObserver=new MutationObserver((()=>this.processNodes())),this.nodeObserver.observe(this,{childList:!0}),this.processNodes())}processNodes(){const e=[...this.childNodes].filter(xk),t=e.map(yk).filter(cf).sort(_k);this.diffModel.updateState({comments:t}),this.updateHighlightLayer(t);for(const t of e)t.addEventListener("mouseenter",this.commentThreadEnterRedispatcher),t.addEventListener("mouseleave",this.commentThreadLeaveRedispatcher)}updateHighlightLayer(e){const t=e.filter((e=>!!e.range)).map((e=>({range:e.range,side:e.side,id:e.rootId})));this.highlightRange&&t.push({...this.highlightRange,id:`hl-${WR(this.highlightRange)}`}),this.highlightLayer.updateRanges(t)}toggleAllContext(){const e=this.diffModel.getState().showFullContext;this.diffModel.updateState({showFullContext:e===wk.YES?wk.NO:wk.YES})}updateCoverageRanges(e){this.coverageLayerLeft.setRanges(e.filter((e=>e?.side===$u.LEFT))),this.coverageLayerRight.setRanges(e.filter((e=>e?.side===$u.RIGHT)))}updateFocusRanges(e){this.focusLayer.setRanges(e)}layersChanged(){const e=[...this.layersInternal,...this.layers];for(const t of e)t.removeListener?.(this.layerUpdateListener),t.addListener?.(this.layerUpdateListener);this.diffModel.updateState({layers:e})}layersInternalInit(){this.layersInternal=[this.createTrailingWhitespaceLayer(),this.createIntralineLayer(),this.createTabIndicatorLayer(),this.createSpecialCharacterIndicatorLayer(),this.highlightLayer,this.coverageLayerLeft,this.coverageLayerRight,this.focusLayer],this.layersChanged()}getContentTdByLineEl(e){if(!e)return;const t=vk(e);if(!t)return;const i=fk(e);return this.getContentTdByLine(t,i)}unhideLine(e,t){ba(this.prefs,"prefs");const i=this.findGroup(t,e);if(!i)return;if(i.type!==QA.CONTEXT_CONTROL)return;const r=i.lineRange[t],o=e-r.start_line,s=[],n=ZA(i.contextGroups,0,o-1-this.context);n[0].type===QA.CONTEXT_CONTROL&&s.push(n.shift()),s.push(...ZA(n,o+1+this.context,r.end_line-r.start_line+1)),this.diffModel.replaceGroup(i,s)}handlePreferenceError(e){throw ea(this,`The value of the '${e}' user preference is invalid. Fix in diff preferences`),Error(`Invalid preference value: ${e}`)}createIntralineLayer(){return{annotate(e,t,i){for(const t of i.highlights){if(t.startIndex===t.endIndex)continue;const r=void 0===t.endIndex?J$(i.text):t.endIndex;ok.annotateElement(e,t.startIndex,r-t.startIndex,"intraline")}}}}createTabIndicatorLayer(){const e=()=>this.prefs?.show_tabs;return{annotate(t,i,r){e()&&bT(t,r,"\t","tab-indicator")}}}createSpecialCharacterIndicatorLayer(){return{annotate(e,t,i){bT(e,i,"­","special-char-indicator"),bT(e,i,/[\u202A-\u202E\u2066-\u2069]/,"special-char-warning")}}}createTrailingWhitespaceLayer(){const e=()=>this.prefs?.show_whitespace_errors;return{annotate(t,i,r){if(!e())return;const o=r.text.match(fT);if(o){const e=J$(r.text.substr(0,o.index)),i=J$(o[0]);ok.annotateElement(t,e,i,"trailing-whitespace")}}}}getContentTdByLine(e,t){if(!t)return;const i=this.findRow(t,e);return i?.getContentCell(t)}getLineElByNumber(e,t){if(!t)return;const i=this.findRow(t,e);return i?.getLineNumberCell(t)}findRow(e,t){const i=this.findGroup(e,t);if(!i)return;const r=this.findSection(i);return r?r.findRow(e,t):void 0}getDiffRows(){return this.diffElement?[...this.diffElement.diffSections??[]].map((e=>e.getDiffRows())).flat():[]}getLineNumberRows(){return this.getDiffRows().map((e=>e.getTableRow())).filter(cf)}getLineNumEls(e){return this.getDiffRows().map((t=>t.getLineNumberCell(e))).filter(cf)}requestRowUpdates(e,t,i){const r=this.getGroupsByLineRange(e,t,i);for(const e of r){const t=this.findSection(e);for(const e of t?.getDiffRows()??[])e.requestUpdate()}}findSection(e){if(!this.diffElement)return;const t=`left-${e.startLine($u.LEFT)}`,i=`right-${e.startLine($u.RIGHT)}`;return this.diffElement.querySelector(`gr-diff-section.${t}.${i}`)??void 0}findGroup(e,t){return this.groups.find((i=>i.containsLine(e,t)))}getGroupsByLineRange(e,t,i){const r=this.groups.findIndex((t=>t.containsLine(i,e)));if(-1===r)return[];let o=this.groups.findIndex((e=>e.containsLine(i,t)));return-1===o&&(o=this.groups.length-1),this.groups.slice(r,o+1).filter((e=>e.lines.length>0))}}function bT(e,t,i,r){const o=t.text.split(i);if(o&&!(o.length<2))for(let t=0,i=0;t<o.length-1;t++)i+=o[t].length,ok.annotateElement(e,i,1,r),i++}mT([Hc("gr-diff-element")],vT.prototype,"diffTable",void 0),mT([Hc("gr-diff-element")],vT.prototype,"diffElement",void 0),mT([Fc({type:Boolean})],vT.prototype,"noAutoRender",void 0),mT([Fc({type:String})],vT.prototype,"path",void 0),mT([Fc({type:Object})],vT.prototype,"prefs",void 0),mT([Fc({type:Object})],vT.prototype,"renderPrefs",void 0),mT([Fc({type:Boolean,reflect:!0})],vT.prototype,"hidden",void 0),mT([Fc({type:Boolean})],vT.prototype,"noRenderOnPrefsChange",void 0),mT([Fc({type:String})],vT.prototype,"actionHoverCardText",void 0),mT([Fc({type:Object})],vT.prototype,"highlightRange",void 0),mT([Fc({type:Array})],vT.prototype,"coverageRanges",void 0),mT([Fc({type:Boolean})],vT.prototype,"lineWrapping",void 0),mT([Fc({type:String})],vT.prototype,"viewMode",void 0),mT([Fc({type:Object})],vT.prototype,"lineOfInterest",void 0),mT([Fc({type:Object})],vT.prototype,"diffRangesToFocus",void 0),mT([Fc({type:String})],vT.prototype,"binaryDiffHint",void 0),mT([Fc({type:Boolean})],vT.prototype,"loggedIn",void 0),mT([Fc({type:Object})],vT.prototype,"diff",void 0),mT([Fc({type:Object})],vT.prototype,"baseImage",void 0),mT([Fc({type:Object})],vT.prototype,"revisionImage",void 0),mT([Fc({type:String})],vT.prototype,"errorMessage",void 0),mT([Fc({type:Array})],vT.prototype,"blame",void 0),mT([Fc({type:Boolean})],vT.prototype,"showNewlineWarningLeft",void 0),mT([Fc({type:Boolean})],vT.prototype,"showNewlineWarningRight",void 0),mT([Fc({type:Boolean})],vT.prototype,"useNewImageDiffUi",void 0),mT([Uc()],vT.prototype,"diffLength",void 0),mT([Fc({type:Array})],vT.prototype,"layers",void 0),mT([Uc()],vT.prototype,"groups",void 0),mT([Uc()],vT.prototype,"context",void 0),customElements.define("gr-diff",vT);const yT=new Map([["application/dart","dart"],["application/json","json"],["application/x-powershell","powershell"],["application/typescript","typescript"],["application/xml","xml"],["application/xquery","xquery"],["application/x-epp","epp"],["application/x-erb","erb"],["text/css","css"],["text/html","html"],["text/javascript","js"],["text/jsx","jsx"],["text/tsx","jsx"],["text/x-c","cpp"],["text/x-c++src","cpp"],["text/x-clojure","clojure"],["text/x-cmake","cmake"],["text/x-coffeescript","coffeescript"],["text/x-common-lisp","lisp"],["text/x-crystal","crystal"],["text/x-csharp","csharp"],["text/x-csrc","cpp"],["text/x-d","d"],["text/x-diff","diff"],["text/x-django","django"],["text/x-dockerfile","dockerfile"],["text/x-ebnf","ebnf"],["text/x-elm","elm"],["text/x-erlang","erlang"],["text/x-fortran","fortran"],["text/x-fsharp","fsharp"],["text/x-gfm","markdown"],["text/x-gherkin","gherkin"],["text/x-gn","gn"],["text/x-go","go"],["text/x-groovy","groovy"],["text/x-haml","haml"],["text/x-handlebars","handlebars"],["text/x-haskell","haskell"],["text/x-haxe","haxe"],["text/x-iecst","iecst"],["text/x-ini","ini"],["text/x-java","java"],["text/x-julia","julia"],["text/x-kotlin","kotlin"],["text/x-latex","latex"],["text/x-less","less"],["text/x-lua","lua"],["text/x-markdown","markdown"],["text/x-mathematica","mathematica"],["text/x-nginx-conf","nginx"],["text/x-nix","nix"],["text/x-nsis","nsis"],["text/x-objectivec","objectivec"],["text/x-ocaml","ocaml"],["text/x-perl","perl"],["text/x-pgsql","pgsql"],["text/x-php","php"],["text/x-properties","properties"],["text/x-protobuf","protobuf"],["text/x-puppet","puppet"],["text/x-python","python"],["text/x-q","q"],["text/x-qml","qml"],["text/x-ruby","ruby"],["text/x-rustsrc","rust"],["text/x-scala","scala"],["text/x-scss","scss"],["text/x-scheme","scheme"],["text/x-shell","shell"],["text/x-soy","soy"],["text/x-spreadsheet","excel"],["text/x-sh","bash"],["text/x-sql","sql"],["text/x-swift","swift"],["text/x-systemverilog","sv"],["text/x-tcl","tcl"],["text/x-toml","toml"],["text/x-torque","torque"],["text/x-twig","twig"],["text/x-vb","vb"],["text/x-verilog","v"],["text/x-vhdl","vhdl"],["text/x-vue","vue"],["text/x-yaml","yaml"],["text/vbscript","vbscript"]]),wT=new Set(["attr","attribute","built_in","bullet","code","comment","doctag","emphasis","formula","function","keyword","link","literal","meta","meta-keyword","name","number","params","property","quote","regexp","section","selector-attr","selector-class","selector-id","selector-pseudo","selector-tag","string","strong","tag","template-tag","template-variable","title","title function_","type","variable","variable language_"]);class _T{constructor(e,t){this.getHighlightService=e,this.getReportingService=t,this.enabled=!0,this.leftRanges=[],this.rightRanges=[],this.listeners=[]}setEnabled(e){this.enabled=e}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}annotate(e,t,i){if(!this.enabled)return;if("number"!=typeof i.beforeNumber)return;if("number"!=typeof i.afterNumber)return;let r;if(i.type===Iu.REMOVE||i.type===Iu.BOTH&&e.getAttribute("data-side")!==$u.RIGHT?r=$u.LEFT:i.type!==Iu.ADD&&e.getAttribute("data-side")===$u.LEFT||(r=$u.RIGHT),!r)return;const o=r===$u.LEFT,s=o?i.beforeNumber:i.afterNumber;va("number"==typeof s,"lineNumber must be a number");const n=o?this.leftRanges:this.rightRanges,a=n[s-1]?.ranges??[];for(const t of a)wT.has(t.className)&&0!==t.length&&Q$(e,t.start,t.length,"gr-syntax gr-syntax-"+t.className)}_getLanguage(e){if(e)return e.language??yT.get(e.content_type)}async process(e){if(this.diff=e,this.leftRanges=[],this.rightRanges=[],this.leftPromise&&this.leftPromise.cancel(),this.rightPromise&&this.rightPromise.cancel(),this.leftPromise=void 0,this.rightPromise=void 0,!this.enabled||!this.diff)return;const t=this._getLanguage(this.diff.meta_a),i=this._getLanguage(this.diff.meta_b);let r="",o="";for(const e of this.diff.content){const t=[...e.a??[],...e.ab??[]];for(const e of t)r+=e+"\n";const i=[...e.b??[],...e.ab??[]];for(const e of i)o+=e+"\n";const s=e.skip??0;s>0&&(r+="\n".repeat(s),o+="\n".repeat(s))}r=r.trimEnd(),o=o.trimEnd();try{this.leftPromise=this.highlight(t,r),this.rightPromise=this.highlight(i,o),this.leftRanges=await this.leftPromise,this.rightRanges=await this.rightPromise,this.notify()}catch(e){e.isCanceled||this.getReportingService().error("Diff Syntax Layer",e),this.leftRanges=[],this.rightRanges=[]}}highlight(e,t){return function(e){let t,i=!1;const r=new Promise(((r,o)=>{t=o,e.then((e=>{i||r(e),i=!0}),(e=>{i||o(e),i=!0}))}));return r.cancel=()=>{i||(t({isCanceled:!0}),i=!0)},r}(this.getHighlightService().highlight(e,t))}notify(){const e=[...this.leftRanges].reverse(),t=this.leftRanges.findIndex((e=>e.ranges.length>0)),i=this.leftRanges.length-1-e.findIndex((e=>e.ranges.length>0)),r=[...this.rightRanges].reverse(),o=this.rightRanges.findIndex((e=>e.ranges.length>0)),s=this.rightRanges.length-1-r.findIndex((e=>e.ranges.length>0));for(const e of this.listeners)t>-1&&e(t+1,i+1,$u.LEFT),o>-1&&e(o+1,s+1,$u.RIGHT)}}function xT(e){return!!e?._account_id}const CT=`${window.STATIC_RESOURCE_PATH??""}/bower_components/highlightjs/highlight.min.js`,ET=`${window.STATIC_RESOURCE_PATH??""}/workers/syntax-worker.js`,ST=mu("highlight-service");class $T{constructor(e){this.reporting=e,this.poolIdle=new Set,this.poolBusy=new Set,this.queueForWorker=[],this.queueForResult=new Map;for(let e=0;e<3;e++)this.addWorker()}createWorker(){return function(e){if(!e.startsWith("http"))throw new Error(`Worker URL '${e}' does not start with 'http'.`);return new Worker(function(e){const t=`importScripts("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}(e))}(Af(ET))}addWorker(){const e=this.createWorker();this.poolBusy.add(e),e.onmessage=t=>{this.handleResult(e,t.data)};const t={type:H$.INIT,url:Af(CT)};e.postMessage(t)}moveIdleToBusy(){const e=this.poolIdle.values().next().value;return this.poolIdle.delete(e),this.poolBusy.add(e),e}moveBusyToIdle(e){this.poolBusy.delete(e),this.poolIdle.add(e);const t=this.queueForWorker.shift();t&&t()}async requestWorker(){if(this.poolIdle.size>0){const e=this.moveIdleToBusy();return Promise.resolve(e)}return await new Promise((e=>this.queueForWorker.push(e))),this.requestWorker()}handleResult(e,t){this.moveBusyToIdle(e),t.error&&this.reporting.error("Diff Syntax Layer",new Error(`syntax worker failed: ${t.error}`));const i=this.queueForResult.get(e);this.queueForResult.delete(e),i&&i(t.ranges??[])}async highlight(e,t){if(!e||!t)return[];if(t.length>5e5)return[];const i=await this.requestWorker();if(!i)return[];const r={type:H$.REQUEST,language:e,code:t},o=new Promise((e=>{this.queueForResult.set(i,e)}));return i.postMessage(r),await o}finalize(){for(const e of this.poolIdle)e?.terminate();this.poolIdle.clear();for(const e of this.poolBusy)e?.terminate();this.poolBusy.clear(),this.queueForResult.clear(),this.queueForWorker.length=0}}const kT="0 (vote reset)",AT=/^(-?)([A-Za-z0-9-]+?)([+-]\d+)?[.:]?$/;function RT(e){return e.filter((e=>e.tag===ag.TAG_REVERT)).map((e=>function(e){const t=e.message.match(/^Created a revert of this change as .*?(I[0-9a-f]{40})$/)?.[1];if(!t)throw new Error("revert changeId not found");return t}(e)))}function TT(e,t){if(!e||!e.message||!t)return[];const i=e.message.split("\n",1)[0],r=zx;if(!i.match(r))return[];const o=i.split(r)[1];return o?o.split(" ").map((e=>e.match(AT))).filter((e=>e&&4===e.length&&ma(t,e[2]))).map((e=>{const t=e?.[2];return{label:t,value:"-"===e?.[1]?kT:e?.[3]}})):[]}function IT(e){return!(!e.updates||!e.updates.length)}class PT{constructor(e){this.batch=null,this.updateItems=null,this._lastState={},this.result={...e}}_filterRemovedMessages(){this.result.messages=this.result.messages.filter((e=>e.tag!==ag.TAG_DELETE_REVIEWER))}_startBatch(e){return this.updateItems={},{author:e.updated_by,date:e.updated,type:"REVIEWER_UPDATE",tag:ag.TAG_REVIEWER_UPDATE}}_completeBatch(e){const t=[];for(const[e,i]of Object.entries(this.updateItems??{}))this._lastState[e]!==i.state&&(this._lastState[e]=i.state,t.push(i));t.length&&(e.updates=t)}_groupUpdates(){const e=this.result.reviewer_updates.reduce(((e,t)=>{this.batch||(this.batch=this._startBatch(t));const i=Wm(t.updated).getTime(),r=Wm(this.batch.date).getTime(),o=lx(t.reviewer);(i-r>6e3||t.updated_by._account_id!==this.batch.author._account_id)&&(this._completeBatch(this.batch),IT(this.batch)&&e.push(this.batch),this.batch=this._startBatch(t));const s=this.updateItems;return s[o]={reviewer:t.reviewer,state:t.state},this._lastState[o]&&(s[o].prev_state=this._lastState[o]),e}),[]),t=this.batch;return this._completeBatch(t),IT(t)&&e.push(t),this.result.reviewer_updates=e,e}_getUpdateMessage(e,t){return"REMOVED"!==e&&e?"REMOVED"===t?e?`Removed from ${e.toLowerCase()}: `:"Removed : ":`Moved from ${e.toLowerCase()} to ${t.toLowerCase()}: `:`Added to ${t.toLowerCase()}: `}_groupUpdatesByMessage(e){return e.reduce(((e,t)=>{const i=this._getUpdateMessage(t.prev_state,t.state);return e[i]||(e[i]=[]),e[i].push(t.reviewer),e}),{})}_formatUpdates(){const e=this.result.reviewer_updates;for(const t of e){const e=this._groupUpdatesByMessage(t.updates),i=[];for(const[t,r]of Object.entries(e))i.push({message:t,reviewers:r});t.updates=i}}_advanceUpdates(){const e=this.result.reviewer_updates,t=this.result.messages;t.forEach(((i,r)=>{const o=Wm(i.date).getTime(),s=r===t.length-1?null:Wm(t[r+1].date).getTime();for(const t of e){const e=Wm(t.date).getTime();if(e>=o&&(!s||e<s)){const e=Wm(t.date).getTime()-500;t.date=new Date(e).toISOString().replace("T"," ").replace("Z","000000")}if(s&&e>s)break}}))}static parse(e){if(!e||!function(e){return!!(e.messages&&e.reviewer_updates&&e.reviewer_updates.length)}(e))return e;const t=new PT(e);return t._filterRemovedMessages(),t._groupUpdates(),t._formatUpdates(),t._advanceUpdates(),t.result}}var NT;function OT(e,t,i,r){if(!t)return i&&e in r[i]?NT.MODIFIED:NT.SAME;if(!i||!(e in r[i]))return NT.MODIFIED;const o=r[i][e].new_sha;return t.new_sha&&o?t.new_sha===o?NT.SAME:NT.MODIFIED:NT.UNKNOWN}function DT(e,t){return e&&t&&t.changeNum===e._number?{...e,submittable:t.submittable,submit_requirements:t.submitRequirements}:e}!function(e){e.UNKNOWN="UNKNOWN",e.SAME="SAME",e.MODIFIED="MODIFIED"}(NT||(NT={}));const LT={loadingStatus:of.NOT_LOADED},MT=mu("change-model");class FT extends df{selectRevision(e){return lf(Yh([this.revisions$,e]),(([e,t])=>{if(e&&t&&t!==Qu)return Object.values(e).find((e=>e._number===t))}))}constructor(e,t,i,r,o,s,n){super(LT),this.navigation=e,this.viewModel=t,this.restApiService=i,this.userModel=r,this.pluginLoader=o,this.reporting=s,this.flagsService=n,this.reloadSubmittabilityTrigger$=new Up(void 0),this.change$=lf(this.state$,(e=>e.change)),this.submittabilityInfo$=lf(this.state$,(e=>e.submittabilityInfo)),this.submittable$=lf(this.state$,(e=>e.submittabilityInfo?.submittable)),this.submitRequirements$=lf(this.state$,(e=>e.submittabilityInfo?.submitRequirements)),this.changeLoadingStatus$=lf(this.state$,(e=>e.loadingStatus)),this.loading$=lf(this.changeLoadingStatus$,(e=>e===of.LOADING)),this.reviewedFiles$=lf(this.state$,(e=>e?.reviewedFiles)),this.mergeable$=lf(this.state$,(e=>e.mergeable)),this.branch$=lf(this.change$,(e=>e?.branch)),this.changeNum$=lf(this.change$,(e=>e?._number)),this.changeId$=lf(this.change$,(e=>e?.change_id)),this.repo$=lf(this.change$,(e=>e?.project)),this.topic$=lf(this.change$,(e=>e?.topic)),this.status$=lf(this.change$,(e=>e?.status)),this.labels$=lf(this.change$,(e=>e?.labels)),this.attentionSet$=lf(this.change$,(e=>e?.attention_set)),this.owner$=lf(this.change$,(e=>e?.owner)),this.revisions$=lf(this.change$,(e=>Nx(Object.values(e?.revisions||{})))),this.patchsets$=lf(this.change$,(e=>Ox(e))),this.latestPatchNum$=lf(this.patchsets$,(e=>Dx(e))),this.latestPatchNumWithEdit$=lf(this.patchsets$,(e=>function(e){if(e&&e.length)return e[0].num}(e))),this.latestUploader$=lf(this.change$,(e=>e?.revisions[e.current_revision]?.uploader)),this.latestCommitter$=lf(this.change$,(e=>e?.revisions[e.current_revision]?.commit?.committer)),this.revisionUpdatedFiles$=lf(this.change$.pipe(Vp((e=>e?Qm([Promise.resolve(e),this.restApiService.getAllRevisionFiles(e._number)]):Zh([e,void 0])))),(([e,t])=>function(e,t){if(!e||!t)return;const i={},r={},o=new Set;for(const[s,n]of Object.entries(e.revisions))r[s]=n._number,i[n._number]=s,Object.keys(t[s]??{}).forEach((e=>o.add(e)));const s={};for(const[e,n]of Object.entries(t)){s[e]={};const a=r[e],l=1===a?void 0:i[a-1];for(const i of o){const r=n[i];s[e][i]=OT(i,r,l,t)}}return s}(e,t))),this.isViewCurrent=!1,this.patchNum$=lf(Yh([this.viewModel.state$,this.state$,this.latestPatchNumWithEdit$]).pipe($p((([e,t,i])=>{const r=t.change?._number,o=e?.changeNum;return void 0===r||r===o}))),(([e,t,i])=>e?.patchNum||i)),this.editMode$=lf(Yh([this.viewModel.edit$,this.patchNum$]),(([e,t])=>!!e||t===Ju)),this.basePatchNum$=lf(Yh([this.viewModel.state$,this.state$,this.userModel.state$]).pipe($p((([e,t,i])=>{const r=t.change?._number,o=e?.changeNum;return void 0===r||r===o})),du(this.viewModel.basePatchNum$,this.patchNum$,this.change$,this.userModel.preferences$)),(([e,t,i,r,o])=>function(e,t,i,r){return e&&e!==Qu?e:i&&t?(r.default_base_for_merges,wg.FIRST_PARENT,Qu):Qu}(t,i,r,o))),this.revision$=this.selectRevision(this.patchNum$),this.baseRevision$=this.selectRevision(this.basePatchNum$),this.latestRevision$=this.selectRevision(this.latestPatchNum$),this.latestRevisionWithEdit$=this.selectRevision(this.latestPatchNumWithEdit$),this.change$.subscribe((e=>{const t=this.pluginLoader.pluginsModel.getChangeUpdatesPlugins();for(const e of t)e.publisher.unsubscribe();if(e)for(const i of t)i.publisher.subscribe(e.project,e._number,(()=>this.throttledShowUpdateChangeNotification()))})),this.isOwner$=lf(Yh([this.change$,this.userModel.account$]),(([e,t])=>DC(e,t))),this.isUploader$=lf(Yh([this.change$,this.userModel.account$]),(([e,t])=>FC(e,t))),this.messages$=lf(this.change$,(e=>e?.messages)),this.revertingChangeIds$=lf(this.messages$,(e=>RT(e??[]))),this.subscriptions=[this.loadChange(),this.loadSubmittabilityInfo(),this.loadMergeable(),this.loadReviewedFiles(),this.setOverviewTitle(),this.setDiffTitle(),this.setEditTitle(),this.reportChangeReload(),this.fireShowChange(),this.refuseEditForOpenChange(),this.refuseEditForClosedChange(),this.change$.subscribe((e=>this.change=e)),this.submittabilityInfo$.subscribe((e=>this.submittabilityInfo=e)),this.patchNum$.subscribe((e=>this.patchNum=e)),this.basePatchNum$.subscribe((e=>this.basePatchNum=e)),this.latestPatchNum$.subscribe((e=>this.latestPatchNum=e)),this.viewModel.childView$.subscribe((e=>{this.isViewCurrent=e===zC.OVERVIEW}))],this.throttledShowUpdateChangeNotification=dy((()=>this.showRefreshChangeNotification()),6e4)}reportChangeReload(){return this.changeLoadingStatus$.subscribe((e=>{e===of.LOADING&&this.reporting.time(ua.CHANGE_RELOAD),e!==of.LOADED&&e!==of.NOT_LOADED||this.reporting.timeEnd(ua.CHANGE_RELOAD)}))}fireShowChange(){return Yh([this.change$,this.basePatchNum$,this.patchNum$,this.mergeable$]).pipe($p((([e,t,i,r])=>!!e&&!!t&&!!i&&void 0!==r))).subscribe((([e,t,i,r])=>{this.pluginLoader.jsApiService.handleShowChange({change:e,basePatchNum:t,patchNum:i,info:{mergeable:r??null}})}))}refuseEditForOpenChange(){return Yh([this.revisions$,this.patchNum$,this.status$]).pipe($p((([e,t,i])=>i===Nu.NEW&&e.length>0&&t===Ju))).subscribe((([e])=>{Px(e)||(ea(document,"Change edit not found. Please create a change edit."),this.navigateToChangeResetReload())}))}refuseEditForClosedChange(){return Yh([this.revisions$,this.viewModel.edit$,this.patchNum$,this.status$]).pipe($p((([e,t,i,r])=>(r===Nu.ABANDONED||r===Nu.MERGED)&&e.length>0&&(i===Ju||t)))).subscribe((([e])=>{Px(e)||(ea(document,"Change edits cannot be created if change is merged or abandoned. Redirecting to non edit mode."),this.navigateToChangeResetReload())}))}setOverviewTitle(){return Yh([this.viewModel.childView$,this.change$]).pipe($p((([e,t])=>e===zC.OVERVIEW)),ep((([e,t])=>t)),$p(cf)).subscribe((e=>{oa(`${e.subject} (${e._number})`)}))}setDiffTitle(){return Yh([this.viewModel.childView$,this.viewModel.diffPath$]).pipe($p((([e,t])=>e===zC.DIFF)),ep((([e,t])=>t)),$p(cf)).subscribe((e=>{oa(Rg(e))}))}setEditTitle(){return Yh([this.viewModel.childView$,this.viewModel.editPath$]).pipe($p((([e,t])=>e===zC.EDIT)),ep((([e,t])=>t)),$p(cf)).subscribe((e=>{oa(`Editing ${Rg(e)}`)}))}loadReviewedFiles(){return Yh([this.patchNum$,this.changeNum$,this.userModel.loggedIn$]).pipe(Vp((([e,t,i])=>t&&e&&i?Qh(this.fetchReviewedFiles(e,t)):(this.updateStateReviewedFiles([]),Zh(void 0))))).subscribe()}loadMergeable(){return this.change$.pipe(Vp((e=>void 0===e?._number?Zh(void 0):void 0!==e.mergeable?Zh(e.mergeable):e.status===Nu.MERGED||e.status===Nu.ABANDONED?Zh(!1):Qh(this.restApiService.getMergeable(e._number).then((e=>e?.mergeable??!1)))))).subscribe((e=>this.updateState({mergeable:e})))}reloadSubmittability(){this.reloadSubmittabilityTrigger$.next()}loadSubmittabilityInfo(){return Yh([this.viewModel.changeNum$,this.reloadSubmittabilityTrigger$]).pipe(ep((([e,t])=>e)),Vp((e=>e?Qh(this.restApiService.getSubmittabilityInfo(e)):Zh(void 0)))).subscribe((e=>{if(!this.flagsService.isEnabled(da.ASYNC_SUBMIT_REQUIREMENTS))return;const t=DT(this.change,e);this.updateState({change:t,submittabilityInfo:e})}))}loadChange(){return this.viewModel.changeNum$.pipe(Vp((e=>(this.updateStateLoading(e),Qm([this.restApiService.getChangeDetail(e),this.restApiService.getChangeEdit(e)])))),du(this.viewModel.patchNum$),ep((([[e,t],i])=>function(e,t,i){return e&&t?(ba(t.commit.commit,"edit.commit.commit"),e.revisions||(e.revisions={}),e.revisions[t.commit.commit]={_number:Ju,basePatchNum:t.base_patch_set_number,commit:t.commit,fetch:t.fetch},void 0===i&&(e.current_revision=t.commit.commit),e):e}(e,t,i))),Gh((e=>{throw this.updateState({loadingStatus:of.NOT_LOADED}),e}))).subscribe((e=>{this.updateStateChange(e??void 0)}))}updateStateReviewedFiles(e){this.updateState({reviewedFiles:e})}updateStateFileReviewed(e,t){const i=this.getState();if(void 0===i.reviewedFiles)return void ea(document,"Updating status failed. Reviewed files not loaded yet.");const r=[...i.reviewedFiles];r.includes(e)&&t||(r.includes(e)||t)&&(t?r.push(e):r.splice(r.indexOf(e),1),this.updateState({reviewedFiles:r}))}fetchReviewedFiles(e,t){return this.restApiService.getReviewedFiles(t,e).then((i=>{t===this.change?._number&&e===this.patchNum&&this.updateStateReviewedFiles(i??[])}))}setReviewedFilesStatus(e,t,i,r){return this.restApiService.saveFileReviewed(e,t,i,r).then((()=>{e===this.change?._number&&t===this.patchNum&&this.updateStateFileReviewed(i,r)})).catch((()=>{ea(document,"Couldn’t change file review status.")}))}getChange(){return this.getState().change}navigateToDiff(e,t=this.patchNum,i=this.basePatchNum){if(!t)return;const r=this.viewModel.diffUrl({diffView:e,patchNum:t,basePatchNum:i});r&&this.navigation.setUrl(r)}changeUrl(e=!1){if(!this.change)return;const t=this.latestPatchNum===this.patchNum;return WC({change:this.change,patchNum:t&&this.basePatchNum===Qu?void 0:this.patchNum,basePatchNum:this.basePatchNum,openReplyDialog:e})}navigateToChange(e=!1){const t=this.changeUrl(e);t&&this.navigation.setUrl(t)}navigateToChangeResetReload(){if(!this.change)return;const e=WC({change:this.change,forceReload:!0});e&&this.navigation.setUrl(e)}navigateToEdit(e){if(!this.patchNum)return;const t=this.viewModel.editUrl({editView:e,patchNum:this.patchNum});t&&this.navigation.setUrl(t)}async showRefreshChangeNotification(){const e=this.change;if(!e)return;const t=await this.getChangeUpdateToastMessage(e);t&&e===this.change&&this.isViewCurrent&&Jn(document,"show-alert",{message:t,dismissOnNavigation:!0,showDismiss:!0,action:"Reload",callback:()=>this.navigateToChangeResetReload()})}async getChangeUpdateToastMessage(e){const t=await this.fetchChangeUpdates(e);let i=null;return t.isLatest?t.newStatus===Nu.MERGED?i="This change has been merged":t.newStatus===Nu.ABANDONED?i="This change has been abandoned":t.newStatus===Nu.NEW?i="This change has been restored":t.newMessages&&(i="There are new messages on this change",t.newMessages.author?.name&&(i+=` from ${t.newMessages.author.name}`)):i="A newer patch set has been uploaded",i}async fetchChangeUpdates(e,t=!1){const i=e.current_revision_number,r=await this.restApiService.getChange(e._number,void 0,t?TC(uf.MESSAGES,uf.ALL_REVISIONS,uf.REVIEWER_UPDATES):void 0);if(!r)throw new Error("Change request failed.");const o=t?PT.parse(r):r;return{isLatest:o.current_revision_number<=i,newStatus:e.status!==o.status?o.status:null,newMessages:(e.messages||[]).length<(o.messages||[]).length?o.messages[o.messages.length-1]:void 0}}updateStateLoading(e){this.updateState({change:void 0,loadingStatus:e?of.LOADING:of.NOT_LOADED})}updateStateChange(e){this.change&&e?._number!==this.change?._number||(e?(e=function(e){if(!e?.revisions)return e;const t={...e,revisions:{...e.revisions}};for(const e of Object.keys(t.revisions)){const i=t.revisions[e];i?.commit&&!i.commit.commit&&(t.revisions[e]={...i,commit:{...i.commit,commit:e}})}return t}(e),this.flagsService.isEnabled(da.ASYNC_SUBMIT_REQUIREMENTS)&&(e=DT(e,this.submittabilityInfo)),this.updateState({change:e,loadingStatus:of.LOADED})):this.updateState({change:void 0,loadingStatus:of.NOT_LOADED}))}}const UT=mu("suggestions-service");var BT;!function(e){e.GET_AI_FIX_FOR_CHECK="GET_AI_FIX_FOR_CHECK",e.GET_AI_FIX_FOR_COMMENT="GET_AI_FIX_FOR_COMMENT",e.FIX_FOR_REVIEWER_COMMENT="FIX_FOR_REVIEWER_COMMENT"}(BT||(BT={}));var HT=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let jT=class extends Ic{constructor(){super(),this.previewed=!1,this.editable=!1,this.layers=[],this.hasEdit=!1,this.renderPrefs={disable_context_control_buttons:!0,show_file_comment_button:!1,hide_line_length_indicator:!0},this.reporting=Xn().reportingService,this.getChangeModel=yu(this,MT),this.restApiService=Xn().restApiService,this.getUserModel=yu(this,jf),this.getNavigation=yu(this,gy),this.syntaxLayer=new _T(yu(this,ST),(()=>Xn().reportingService)),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getChangeModel().revisions$),(e=>this.hasEdit=Object.values(e).some((e=>e._number===Ju)))),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getUserModel().diffPreferences$),(e=>{e&&(this.diffPrefs=e,this.syntaxLayer.setEnabled(!!this.diffPrefs.syntax_highlighting))})),zf(this,(()=>this.getChangeModel().repo$),(e=>this.repo=e))}static get styles(){return[Sd`
        :host {
          display: block;
        }
        .buttons {
          text-align: right;
        }
        .diff-container {
          border: 1px solid var(--border-color);
          border-top: none;
          max-height: 70vh;
          overflow-y: auto;
        }
        #edit-textarea {
          width: 100%;
          height: 200px;
        }
        /*
         * On some operating systems (e.g. macOS), scrollbars are hidden by
         * default and only appear when scrolling. The following rules force
         * the scrollbar to be visible when the content overflows.
         *
         * This is only enabled for devices with a mouse, because it would be
         * obtrusive on touch devices.
         */
        @media (pointer: fine) {
          .diff-container::-webkit-scrollbar,
          .diff-container::-webkit-scrollbar-corner {
            background: transparent;
            height: 12px;
            width: 12px;
          }
          .diff-container::-webkit-scrollbar-button {
            height: 0;
            width: 0;
          }
          .diff-container::-webkit-scrollbar-thumb {
            background: content-box currentColor;
            border: 2px solid transparent;
            border-radius: 8px;
            color: var(--deemphasized-text-color);
            min-height: 48px;
            min-width: 48px;
          }
        }
        code {
          max-width: var(--gr-formatted-text-prose-max-width, none);
          background-color: var(--background-color-secondary);
          border: 1px solid var(--border-color);
          border-top: 0;
          display: block;
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-code);
          line-height: var(--line-height-mono);
          margin-bottom: var(--spacing-m);
          padding: var(--spacing-xxs) var(--spacing-s);
          overflow-x: auto;
          /* Pre will preserve whitespace and line breaks but not wrap */
          white-space: pre;
          border-bottom-left-radius: var(--border-radius);
          border-bottom-right-radius: var(--border-radius);
        }
      `]}updated(e){(e.has("fixSuggestionInfo")||e.has("changeNum")||e.has("patchSet"))&&this.fetchFixPreview()}render(){return this.fixSuggestionInfo?dc`
      ${eb(this.previewLoadedFor,(()=>this.renderDiff()),(()=>dc`<code>${this.codeText}</code>`))}
      ${eb(this.editable,(()=>this.renderTextarea()))}
    `:uc}renderTextarea(){const e=_C(this.fixSuggestionInfo?.replacements??[]);return dc`<gr-textarea
      id="edit-textarea"
      .value=${e}
    ></gr-textarea>`}renderDiff(){if(!this.preview)return;const e=this.preview.preview;return this.syntaxLayer.process(e),dc`<div class="diff-container">
      <gr-diff
        .prefs=${this.overridePartialDiffPrefs()}
        .path=${this.preview.filepath}
        .diff=${e}
        .layers=${this.layers}
        .renderPrefs=${this.renderPrefs}
        .viewMode=${Su.UNIFIED}
      ></gr-diff>
    </div>`}async fetchFixPreview(){if(!this.changeNum||!this.patchSet||!this.fixSuggestionInfo)return;this.reporting.time(ua.PREVIEW_FIX_LOAD);const e=await this.restApiService.getFixPreview(this.changeNum,this.patchSet,this.fixSuggestionInfo.replacements);if(!e)return;const t=Object.keys(e).map((t=>({filepath:t,preview:e[t]})));return this.reporting.timeEnd(ua.PREVIEW_FIX_LOAD,{uuid:this.uuid,commentId:this.commentId??""}),t.length>0&&(this.preview=t[0],this.previewLoadedFor=this.fixSuggestionInfo,this.previewed=!0,Jn(this,"preview-loaded",{previewLoadedFor:this.fixSuggestionInfo})),e}reset(){this.textarea&&this.fixSuggestionInfo&&(this.textarea.value=_C(this.fixSuggestionInfo.replacements))}getEditedContent(){return this.textarea?.value}async applyFix(){const e=this.changeNum,t=this.patchSet,i=this.fixSuggestionInfo;if(!e||!t||!i)return;let r;this.reporting.time(ua.APPLY_FIX_LOAD);let o="",s="";try{r=await this.restApiService.applyFixSuggestion(e,t,i.replacements,this.latestPatchNum,Ff)}catch(e){e instanceof Error&&(o=e.message,s=o.match(/\b\d{3}\b/)?.[0]||""),ta(this,`Applying Fix failed.\n${o}`)}finally{this.reporting.timeEnd(ua.APPLY_FIX_LOAD,{method:"1-click",description:i.description,fileExtension:HR(i?.replacements?.[0].path??""),commentId:this.commentId??"",success:r?.ok??!1,status:r?.status??s,errorText:o})}r?.ok&&void 0!==t&&t!==Ju&&(this.getNavigation().setUrl(WC({changeNum:e,repo:this.repo,patchNum:Ju,basePatchNum:t,forceReload:!this.hasEdit})),Jn(this,"reload-diff",{path:i.replacements[0].path}),Jn(this,"apply-user-suggestion",{fixSuggestion:i.description.includes(BT.GET_AI_FIX_FOR_COMMENT)?i:void 0}))}overridePartialDiffPrefs(){if(this.diffPrefs)return{...this.diffPrefs,context:0,line_length:Math.min(this.diffPrefs.line_length,100),line_wrapping:!0}}};HT([Hc("#edit-textarea")],jT.prototype,"textarea",void 0),HT([Fc({type:String})],jT.prototype,"codeText",void 0),HT([Fc({type:Object})],jT.prototype,"fixSuggestionInfo",void 0),HT([Fc({type:Boolean,attribute:"previewed",reflect:!0})],jT.prototype,"previewed",void 0),HT([Fc({type:String})],jT.prototype,"uuid",void 0),HT([Fc({type:Number})],jT.prototype,"patchSet",void 0),HT([Fc({type:String})],jT.prototype,"commentId",void 0),HT([Fc({type:Boolean,reflect:!0})],jT.prototype,"editable",void 0),HT([Uc()],jT.prototype,"layers",void 0),HT([Uc()],jT.prototype,"previewLoadedFor",void 0),HT([Uc()],jT.prototype,"repo",void 0),HT([Uc()],jT.prototype,"hasEdit",void 0),HT([Uc()],jT.prototype,"changeNum",void 0),HT([Uc()],jT.prototype,"preview",void 0),HT([Uc()],jT.prototype,"diffPrefs",void 0),HT([Uc()],jT.prototype,"latestPatchNum",void 0),HT([Uc()],jT.prototype,"renderPrefs",void 0),jT=HT([Dc("gr-suggestion-diff-preview")],jT);const GT={comment:void 0,commentedText:void 0},zT=mu("diff-model");class VT extends df{constructor(e){super(GT),this.restApiService=e,this.comment$=lf(this.state$.pipe($p(cf)),(e=>e.comment)),this.commentedText$=lf(this.state$.pipe($p(cf)),(e=>e.commentedText))}async getCommentedCode(e,t){if(ba(e,"comment"),ba(t,"changeNum"),e.path===hg.PATCHSET_LEVEL_COMMENTS)return;const i=await this.restApiService.getFileContent(t,e.path,e.patch_set);va(!!i&&i.ok&&!!i.content,"file content for comment not found");const r=function(e,t){t.path===hg.COMMIT_MESSAGE&&(e="\n".repeat(6)+e);const i=e.split("\n");if(t.range){const e=t.range;return i.slice(e.start_line-1,e.end_line).join("\n")}return i[t.line-1]}(i.content,e);return va(!!r,"file content for comment not found"),this.updateState({commentedText:r}),r}}var WT=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let qT=class extends Ic{constructor(){super(),this.docsBaseUrl="",this.applyingFix=!1,this.previewLoaded=!1,this.isChangeMerged=!1,this.isChangeAbandoned=!1,this.loggedIn=!1,this.getConfigModel=yu(this,Qw),this.getChangeModel=yu(this,MT),this.getCommentModel=yu(this,zT),this.getUserModel=yu(this,jf),zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getCommentModel().comment$),(e=>this.comment=e)),zf(this,(()=>this.getCommentModel().commentedText$),(e=>this.commentedText=e)),zf(this,(()=>this.getChangeModel().status$),(e=>this.isChangeMerged=e===Nu.MERGED)),zf(this,(()=>this.getChangeModel().status$),(e=>this.isChangeAbandoned=e===Nu.ABANDONED)),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.loggedIn=e))}static get styles(){return[Sd`
        .header {
          background-color: var(--background-color-primary);
          border: 1px solid var(--border-color);
          padding: var(--spacing-xs) var(--spacing-xl);
          display: flex;
          align-items: center;
          border-top-left-radius: var(--border-radius);
          border-top-right-radius: var(--border-radius);
        }
        .header .title {
          flex: 1;
        }
        .copyButton {
          margin-right: var(--spacing-l);
        }
      `]}render(){if(!this.textContent||!this.comment||!this.commentedText)return uc;const e=this.textContent,t=mC(this.comment,this.commentedText,e);return dc`<div class="header">
        <div class="title">
          <span>Suggested edit</span>
          <a
            href=${$f(this.docsBaseUrl,"user-suggest-edits.html")}
            target="_blank"
            rel="noopener noreferrer"
            ><gr-icon icon="help" title="read documentation"></gr-icon
          ></a>
        </div>
        <div class="copyButton">
          <gr-copy-clipboard
            hideInput=""
            text=${e}
            multiline
            copyTargetName="Suggested edit"
            buttonTitle="Copy Suggested edit to clipboard"
          ></gr-copy-clipboard>
        </div>
        <div>
          <gr-button
            secondary
            flatten
            class="action show-fix"
            @click=${this.handleShowFix}
          >
            Show Edit
          </gr-button>
          <gr-button
            secondary
            flatten
            .loading=${this.applyingFix}
            .disabled=${this.isApplyEditDisabled()}
            class="action show-fix"
            @click=${this.handleApplyFix}
            .title=${this.computeApplyEditTooltip()}
          >
            Apply Edit
          </gr-button>
        </div>
      </div>
      <gr-suggestion-diff-preview
        .patchSet=${this.comment?.patch_set}
        .commentId=${this.comment?.id}
        .fixSuggestionInfo=${t[0]}
        .codeText=${e}
        @preview-loaded=${()=>this.previewLoaded=!0}
      ></gr-suggestion-diff-preview>`}updated(e){super.updated(e),e.has("commentedText")&&this.commentedText&&(this.previewLoaded=!1)}handleShowFix(){this.textContent&&Jn(this,"open-user-suggest-preview",{code:this.textContent})}async handleApplyFix(){this.textContent&&(this.applyingFix=!0,await(this.suggestionDiffPreview?.applyFix()),this.applyingFix=!1)}isApplyEditDisabled(){return void 0===this.comment?.patch_set||!!this.isChangeMerged||!!this.isChangeAbandoned||!this.loggedIn||this.comment?.path===hg.COMMIT_MESSAGE&&this.comment?.patch_set!==this.latestPatchNum||!this.previewLoaded}computeApplyEditTooltip(){return void 0===this.comment?.patch_set?"":this.isChangeMerged?"Change is already merged":this.isChangeAbandoned?"Change is abandoned":this.previewLoaded?this.loggedIn?this.comment?.path===hg.COMMIT_MESSAGE&&this.comment?.patch_set!==this.latestPatchNum?"You cannot apply a commit message edit from a previous patch set":"":"You must be logged in to apply a fix":"Fix is still loading ..."}};WT([Hc("gr-suggestion-diff-preview")],qT.prototype,"suggestionDiffPreview",void 0),WT([Uc()],qT.prototype,"docsBaseUrl",void 0),WT([Uc()],qT.prototype,"applyingFix",void 0),WT([Uc()],qT.prototype,"latestPatchNum",void 0),WT([Uc()],qT.prototype,"comment",void 0),WT([Uc()],qT.prototype,"previewLoaded",void 0),WT([Uc()],qT.prototype,"commentedText",void 0),WT([Uc()],qT.prototype,"isChangeMerged",void 0),WT([Uc()],qT.prototype,"isChangeAbandoned",void 0),WT([Uc()],qT.prototype,"loggedIn",void 0),qT=WT([Dc("gr-user-suggestion-fix")],qT),function(e){var t={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:g,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,nptable:g,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?\\?>\\n*|<![A-Z][\\s\\S]*?>\\n*|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>\\n*|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=\\h*\\n)[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=\\h*\\n)[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:g,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading| {0,3}>|<\/?(?:tag)(?: +|\n|\/?>)|<(?:script|pre|style|!--))[^\n]+)*)/,text:/^[^\n]+/};function i(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||b.defaults,this.rules=t.normal,this.options.pedantic?this.rules=t.pedantic:this.options.gfm&&(this.options.tables?this.rules=t.tables:this.rules=t.gfm)}t._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,t._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,t.def=c(t.def).replace("label",t._label).replace("title",t._title).getRegex(),t.bullet=/(?:[*+-]|\d+\.)/,t.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,t.item=c(t.item,"gm").replace(/bull/g,t.bullet).getRegex(),t.list=c(t.list).replace(/bull/g,t.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+t.def.source+")").getRegex(),t._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",t._comment=/<!--(?!-?>)[\s\S]*?-->/,t.html=c(t.html,"i").replace("comment",t._comment).replace("tag",t._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),t.paragraph=c(t.paragraph).replace("hr",t.hr).replace("heading",t.heading).replace("lheading",t.lheading).replace("tag",t._tag).getRegex(),t.blockquote=c(t.blockquote).replace("paragraph",t.paragraph).getRegex(),t.normal=m({},t),t.gfm=m({},t.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\n? *\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),t.gfm.paragraph=c(t.paragraph).replace("(?!","(?!"+t.gfm.fences.source.replace("\\1","\\2")+"|"+t.list.source.replace("\\1","\\3")+"|").getRegex(),t.tables=m({},t.gfm,{nptable:/^ *([^|\n ].*\|.*)\n *([-:]+ *\|[-| :]*)(?:\n((?:.*[^>\n ].*(?:\n|$))*)\n*|$)/,table:/^ *\|(.+)\n *\|?( *[-:]+[-| :]*)(?:\n((?: *[^>\n ].*(?:\n|$))*)\n*|$)/}),t.pedantic=m({},t.normal,{html:c("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",t._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/}),i.rules=t,i.lex=function(e,t){return new i(t).lex(e)},i.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},i.prototype.token=function(e,i){var r,o,s,n,a,l,d,c,h,p,u,g,m,b,y,w;for(e=e.replace(/^ +$/gm,"");e;)if((s=this.rules.newline.exec(e))&&(e=e.substring(s[0].length),s[0].length>1&&this.tokens.push({type:"space"})),s=this.rules.code.exec(e))e=e.substring(s[0].length),s=s[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?s:v(s,"\n")});else if(s=this.rules.fences.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"code",lang:s[2],text:s[3]||""});else if(s=this.rules.heading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:s[1].length,text:s[2]});else if(i&&(s=this.rules.nptable.exec(e))&&(l={type:"table",header:f(s[1].replace(/^ *| *\| *$/g,"")),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3]?s[3].replace(/\n$/,"").split("\n"):[]}).header.length===l.align.length){for(e=e.substring(s[0].length),u=0;u<l.align.length;u++)/^ *-+: *$/.test(l.align[u])?l.align[u]="right":/^ *:-+: *$/.test(l.align[u])?l.align[u]="center":/^ *:-+ *$/.test(l.align[u])?l.align[u]="left":l.align[u]=null;for(u=0;u<l.cells.length;u++)l.cells[u]=f(l.cells[u],l.header.length);this.tokens.push(l)}else if(s=this.rules.hr.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"hr"});else if(s=this.rules.blockquote.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"blockquote_start"}),s=s[0].replace(/^ *> ?/gm,""),this.token(s,i),this.tokens.push({type:"blockquote_end"});else if(s=this.rules.list.exec(e)){for(e=e.substring(s[0].length),d={type:"list_start",ordered:b=(n=s[2]).length>1,start:b?+n:"",loose:!1},this.tokens.push(d),c=[],r=!1,m=(s=s[0].match(this.rules.item)).length,u=0;u<m;u++)p=(l=s[u]).length,~(l=l.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(p-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+p+"}","gm"),"")),this.options.smartLists&&u!==m-1&&(n===(a=t.bullet.exec(s[u+1])[0])||n.length>1&&a.length>1||(e=s.slice(u+1).join("\n")+e,u=m-1)),o=r||/\n\n(?!\s*$)/.test(l),u!==m-1&&(r="\n"===l.charAt(l.length-1),o||(o=r)),o&&(d.loose=!0),w=void 0,(y=/^\[[ xX]\] /.test(l))&&(w=" "!==l[1],l=l.replace(/^\[[ xX]\] +/,"")),h={type:"list_item_start",task:y,checked:w,loose:o},c.push(h),this.tokens.push(h),this.token(l,!1),this.tokens.push({type:"list_item_end"});if(d.loose)for(m=c.length,u=0;u<m;u++)c[u].loose=!0;this.tokens.push({type:"list_end"})}else if(s=this.rules.html.exec(e))e=e.substring(s[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===s[1]||"script"===s[1]||"style"===s[1]),text:s[0]});else if(i&&(s=this.rules.def.exec(e)))e=e.substring(s[0].length),s[3]&&(s[3]=s[3].substring(1,s[3].length-1)),g=s[1].toLowerCase().replace(/\s+/g," "),this.tokens.links[g]||(this.tokens.links[g]={href:s[2],title:s[3]});else if(i&&(s=this.rules.table.exec(e))&&(l={type:"table",header:f(s[1].replace(/^ *| *\| *$/g,"")),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3]?s[3].replace(/(?: *\| *)?\n$/,"").split("\n"):[]}).header.length===l.align.length){for(e=e.substring(s[0].length),u=0;u<l.align.length;u++)/^ *-+: *$/.test(l.align[u])?l.align[u]="right":/^ *:-+: *$/.test(l.align[u])?l.align[u]="center":/^ *:-+ *$/.test(l.align[u])?l.align[u]="left":l.align[u]=null;for(u=0;u<l.cells.length;u++)l.cells[u]=f(l.cells[u].replace(/^ *\| *| *\| *$/g,""),l.header.length);this.tokens.push(l)}else if(s=this.rules.lheading.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"heading",depth:"="===s[2]?1:2,text:s[1]});else if(i&&(s=this.rules.paragraph.exec(e)))e=e.substring(s[0].length),this.tokens.push({type:"paragraph",text:"\n"===s[1].charAt(s[1].length-1)?s[1].slice(0,-1):s[1]});else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),this.tokens.push({type:"text",text:s[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var r={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:g,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(href(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,strong:/^__([^\s])__(?!_)|^\*\*([^\s])\*\*(?!\*)|^__([^\s][\s\S]*?[^\s])__(?!_)|^\*\*([^\s][\s\S]*?[^\s])\*\*(?!\*)/,em:/^_([^\s_])_(?!_)|^\*([^\s*"<\[])\*(?!\*)|^_([^\s][\s\S]*?[^\s_])_(?!_|[^\s.])|^_([^\s_][\s\S]*?[^\s])_(?!_|[^\s.])|^\*([^\s"<\[][\s\S]*?[^\s*])\*(?!\*)|^\*([^\s*"<\[][\s\S]*?[^\s])\*(?!\*)/,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:g,text:/^(`+|[^`])[\s\S]*?(?=[\\<!\[`*]|\b_| {2,}\n|$)/};function o(e,t){if(this.options=t||b.defaults,this.links=e,this.rules=r.normal,this.renderer=this.options.renderer||new s,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.pedantic?this.rules=r.pedantic:this.options.gfm&&(this.options.breaks?this.rules=r.breaks:this.rules=r.gfm)}function s(e){this.options=e||b.defaults}function n(){}function a(e){this.tokens=[],this.token=null,this.options=e||b.defaults,this.options.renderer=this.options.renderer||new s,this.renderer=this.options.renderer,this.renderer.options=this.options}function l(e,t){if(t){if(l.escapeTest.test(e))return e.replace(l.escapeReplace,(function(e){return l.replacements[e]}))}else if(l.escapeTestNoEncode.test(e))return e.replace(l.escapeReplaceNoEncode,(function(e){return l.replacements[e]}));return e}function d(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,(function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}function c(e,t){return e=e.source||e,t=t||"",{replace:function(t,i){return i=(i=i.source||i).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(t,i),this},getRegex:function(){return new RegExp(e,t)}}}function h(e,t,i){if(e){try{var r=decodeURIComponent(d(i)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return null}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return null}t&&!u.test(i)&&(i=function(e,t){return p[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?p[" "+e]=e+"/":p[" "+e]=v(e,"/",!0)),e=p[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}(t,i));try{i=encodeURI(i).replace(/%25/g,"%")}catch(e){return null}return i}r._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,r._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,r._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,r.autolink=c(r.autolink).replace("scheme",r._scheme).replace("email",r._email).getRegex(),r._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,r.tag=c(r.tag).replace("comment",t._comment).replace("attribute",r._attribute).getRegex(),r._label=/(?:\[[^\[\]]*\]|\\[\[\]]?|`[^`]*`|[^\[\]\\])*?/,r._href=/\s*(<(?:\\[<>]?|[^\s<>\\])*>|(?:\\[()]?|\([^\s\x00-\x1f\\]*\)|[^\s\x00-\x1f()\\])*?)/,r._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,r.link=c(r.link).replace("label",r._label).replace("href",r._href).replace("title",r._title).getRegex(),r.reflink=c(r.reflink).replace("label",r._label).getRegex(),r.normal=m({},r),r.pedantic=m({},r.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/,link:c(/^!?\[(label)\]\((.*?)\)/).replace("label",r._label).getRegex(),reflink:c(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",r._label).getRegex()}),r.gfm=m({},r.normal,{escape:c(r.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:c(r.text).replace("]|","~]|").replace("|$","|https?://|ftp://|www\\.|[a-zA-Z0-9.!#$%&'*+/=?^_`{\\|}~-]+@|$").getRegex()}),r.gfm.url=c(r.gfm.url).replace("email",r.gfm._extended_email).getRegex(),r.breaks=m({},r.gfm,{br:c(r.br).replace("{2,}","*").getRegex(),text:c(r.gfm.text).replace("{2,}","*").getRegex()}),o.rules=r,o.output=function(e,t,i){return new o(t,i).output(e)},o.prototype.output=function(e){for(var t,i,r,s,n,a,d="";e;)if(n=this.rules.escape.exec(e))e=e.substring(n[0].length),d+=n[1];else if(n=this.rules.autolink.exec(e))e=e.substring(n[0].length),r="@"===n[2]?"mailto:"+(i=l(this.mangle(n[1]))):i=l(n[1]),d+=this.renderer.link(r,null,i);else if(this.inLink||!(n=this.rules.url.exec(e))){if(n=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(n[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(n[0])&&(this.inLink=!1),!this.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?this.inRawBlock=!0:this.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(this.inRawBlock=!1),e=e.substring(n[0].length),d+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):l(n[0]):n[0];else if(n=this.rules.link.exec(e))e=e.substring(n[0].length),this.inLink=!0,r=n[2],this.options.pedantic?(t=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r))?(r=t[1],s=t[3]):s="":s=n[3]?n[3].slice(1,-1):"",r=r.trim().replace(/^<([\s\S]*)>$/,"$1"),d+=this.outputLink(n,{href:o.escapes(r),title:o.escapes(s)}),this.inLink=!1;else if((n=this.rules.reflink.exec(e))||(n=this.rules.nolink.exec(e))){if(e=e.substring(n[0].length),t=(n[2]||n[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){d+=n[0].charAt(0),e=n[0].substring(1)+e;continue}this.inLink=!0,d+=this.outputLink(n,t),this.inLink=!1}else if(n=this.rules.strong.exec(e))e=e.substring(n[0].length),d+=this.renderer.strong(this.output(n[4]||n[3]||n[2]||n[1]));else if(n=this.rules.em.exec(e))e=e.substring(n[0].length),d+=this.renderer.em(this.output(n[6]||n[5]||n[4]||n[3]||n[2]||n[1]));else if(n=this.rules.code.exec(e))e=e.substring(n[0].length),d+=this.renderer.codespan(l(n[2].trim(),!0));else if(n=this.rules.br.exec(e))e=e.substring(n[0].length),d+=this.renderer.br();else if(n=this.rules.del.exec(e))e=e.substring(n[0].length),d+=this.renderer.del(this.output(n[1]));else if(n=this.rules.text.exec(e))e=e.substring(n[0].length),this.inRawBlock?d+=this.renderer.text(n[0]):d+=this.renderer.text(l(this.smartypants(n[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else{if("@"===n[2])r="mailto:"+(i=l(n[0]));else{do{a=n[0],n[0]=this.rules._backpedal.exec(n[0])[0]}while(a!==n[0]);i=l(n[0]),r="www."===n[1]?"http://"+i:i}e=e.substring(n[0].length),d+=this.renderer.link(r,null,i)}return d},o.escapes=function(e){return e?e.replace(o.rules._escapes,"$1"):e},o.prototype.outputLink=function(e,t){var i=t.href,r=t.title?l(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(i,r,this.output(e[1])):this.renderer.image(i,r,l(e[1]))},o.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},o.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,i="",r=e.length,o=0;o<r;o++)t=e.charCodeAt(o),Math.random()>.5&&(t="x"+t.toString(16)),i+="&#"+t+";";return i},s.prototype.code=function(e,t,i){if(this.options.highlight){var r=this.options.highlight(e,t);null!=r&&r!==e&&(i=!0,e=r)}return t?'<pre><code class="'+this.options.langPrefix+l(t,!0)+'">'+(i?e:l(e,!0))+"</code></pre>\n":"<pre><code>"+(i?e:l(e,!0))+"</code></pre>"},s.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},s.prototype.html=function(e){return e},s.prototype.heading=function(e,t,i){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+i.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},s.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},s.prototype.list=function(e,t,i){var r=t?"ol":"ul";return"<"+r+(t&&1!==i?' start="'+i+'"':"")+">\n"+e+"</"+r+">\n"},s.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},s.prototype.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},s.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},s.prototype.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},s.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},s.prototype.tablecell=function(e,t){var i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+">\n"},s.prototype.strong=function(e){return"<strong>"+e+"</strong>"},s.prototype.em=function(e){return"<em>"+e+"</em>"},s.prototype.codespan=function(e){return"<code>"+e+"</code>"},s.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},s.prototype.del=function(e){return"<del>"+e+"</del>"},s.prototype.link=function(e,t,i){if(null===(e=h(this.options.sanitize,this.options.baseUrl,e)))return i;var r='<a href="'+l(e)+'"';return t&&(r+=' title="'+t+'"'),r+">"+i+"</a>"},s.prototype.image=function(e,t,i){if(null===(e=h(this.options.sanitize,this.options.baseUrl,e)))return i;var r='<img src="'+e+'" alt="'+i+'"';return t&&(r+=' title="'+t+'"'),r+(this.options.xhtml?"/>":">")},s.prototype.text=function(e){return e},n.prototype.strong=n.prototype.em=n.prototype.codespan=n.prototype.del=n.prototype.text=function(e){return e},n.prototype.link=n.prototype.image=function(e,t,i){return""+i},n.prototype.br=function(){return""},a.parse=function(e,t){return new a(t).parse(e)},a.prototype.parse=function(e){this.inline=new o(e.links,this.options),this.inlineText=new o(e.links,m({},this.options,{renderer:new n})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},a.prototype.next=function(){return this.token=this.tokens.pop()},a.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},a.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},a.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,d(this.inlineText.output(this.token.text)));case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,i,r,o="",s="";for(i="",e=0;e<this.token.header.length;e++)i+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(i),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],i="",r=0;r<t.length;r++)i+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});s+=this.renderer.tablerow(i)}return this.renderer.table(o,s);case"blockquote_start":for(s="";"blockquote_end"!==this.next().type;)s+=this.tok();return this.renderer.blockquote(s);case"list_start":s="";for(var n=this.token.ordered,a=this.token.start;"list_end"!==this.next().type;)s+=this.tok();return this.renderer.list(s,n,a);case"list_item_start":s="";var l=this.token.loose;for(this.token.task&&(s+=this.renderer.checkbox(this.token.checked));"list_item_end"!==this.next().type;)s+=l||"text"!==this.token.type?this.tok():this.parseText();return this.renderer.listitem(s);case"html":return this.renderer.html(this.token.text);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},l.escapeTest=/[&<>"']/,l.escapeReplace=/[&<>"']/g,l.replacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},l.escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,l.escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g;var p={},u=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function g(){}function m(e){for(var t,i,r=1;r<arguments.length;r++)for(i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}function f(e,t){var i=e.replace(/\|/g,(function(e,t,i){for(var r=!1,o=t;--o>=0&&"\\"===i[o];)r=!r;return r?"|":" |"})).split(/ \|/),r=0;if(i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(/\\\|/g,"|");return i}function v(e,t,i){if(0===e.length)return"";for(var r=0;r<e.length;){var o=e.charAt(e.length-r-1);if(o!==t||i){if(o===t||!i)break;r++}else r++}return e.substr(0,e.length-r)}function b(e,t,r){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(r||"function"==typeof t){r||(r=t,t=null);var o,s,n=(t=m({},b.defaults,t||{})).highlight,d=0;try{o=i.lex(e,t)}catch(e){return r(e)}s=o.length;var c=function(e){if(e)return t.highlight=n,r(e);var i;try{i=a.parse(o,t)}catch(t){e=t}return t.highlight=n,e?r(e):r(null,i)};if(!n||n.length<3)return c();if(delete t.highlight,!s)return c();for(;d<o.length;d++)!function(e){"code"!==e.type?--s||c():n(e.text,e.lang,(function(t,i){return t?c(t):null==i||i===e.text?--s||c():(e.text=i,e.escaped=!0,void(--s||c()))}))}(o[d])}else try{return t&&(t=m({},b.defaults,t)),a.parse(i.lex(e,t),t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(t||b.defaults).silent)return"<p>An error occurred:</p><pre>"+l(e.message+"",!0)+"</pre>";throw e}}g.exec=g,b.options=b.setOptions=function(e){return m(b.defaults,e),b},b.getDefaults=function(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:new s,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tables:!0,xhtml:!1}},b.defaults=b.getDefaults(),b.Parser=a,b.parser=a.parse,b.Renderer=s,b.TextRenderer=n,b.Lexer=i,b.lexer=i.lex,b.InlineLexer=o,b.inlineLexer=o.output,b.parse=b,"undefined"!=typeof module&&"object"==typeof exports?module.exports=b:"function"==typeof define&&define.amd?define((function(){return b})):e.marked=b}(window||("undefined"!=typeof window?window:global));const KT=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var YT=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};window.marked||(window.marked=KT);let XT=class extends Ic{constructor(){super(...arguments),this.markdown=null,this.breaks=!1,this.pedantic=!1,this.renderer=null,this.sanitize=!1,this.sanitizer=void 0,this.smartypants=!1,this.callback=null}render(){return dc`
      <slot name="markdown-html">
        <div id="content" slot="markdown-html"></div>
      </slot>
    `}connectedCallback(){super.connectedCallback(),this.renderMarkdown()}updated(e){["markdown","breaks","pedantic","renderer","sanitize","sanitizer","smartypants","callback"].some((t=>e.has(t)))&&this.renderMarkdown()}firstUpdated(){this.renderMarkdown()}renderMarkdown(){if(!this.isConnected||!this.outputElement.length)return;if(!this.markdown)return void(this.outputElement[0].innerHTML="");const e=new window.marked.Renderer;this.renderer&&this.renderer(e);const t={renderer:e,highlight:this.highlight.bind(this),breaks:this.breaks,sanitize:this.sanitize,sanitizer:this.sanitizer,pedantic:this.pedantic,smartypants:this.smartypants},i=window.marked(this.markdown,t,this.callback);this.outputElement[0].innerHTML=i,this.dispatchEvent(new CustomEvent("marked-render-complete",{bubbles:!0,composed:!0}))}highlight(e,t){const i=new CustomEvent("syntax-highlight",{detail:{code:e,lang:t},bubbles:!0,composed:!0});return this.dispatchEvent(i),i.detail.code||e}};XT.styles=Sd`
    :host {
      display: block;
    }
  `,YT([Fc({type:String})],XT.prototype,"markdown",void 0),YT([Fc({type:Boolean})],XT.prototype,"breaks",void 0),YT([Fc({type:Boolean})],XT.prototype,"pedantic",void 0),YT([Fc({type:Function})],XT.prototype,"renderer",void 0),YT([Fc({type:Boolean})],XT.prototype,"sanitize",void 0),YT([Fc({type:Function})],XT.prototype,"sanitizer",void 0),YT([Fc({type:Boolean})],XT.prototype,"smartypants",void 0),YT([Fc({type:Function})],XT.prototype,"callback",void 0),YT([Vc({flatten:!0,slot:"markdown-html"})],XT.prototype,"outputElement",void 0),XT=YT([Dc("gr-marked-element")],XT);var JT=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const QT=/^data:image\/(bmp|gif|x-icon|jpeg|jpg|png|tiff|webp);base64,/;let ZT=class extends Ic{static get styles(){return[Sd`
        a {
          color: var(--link-color);
        }
        p,
        ul,
        code,
        blockquote {
          margin: 0 0 var(--spacing-m) 0;
          max-width: var(--gr-formatted-text-prose-max-width, none);
        }
        p:last-child,
        ul:last-child,
        blockquote:last-child,
        pre:last-child,
        pre.plaintext {
          margin: 0;
        }
        blockquote {
          border-left: var(--spacing-xxs) solid
            var(--comment-quote-marker-color);
          padding: 0 var(--spacing-m);
        }
        code {
          background-color: var(--background-color-secondary);
          border: var(--spacing-xxs) solid var(--border-color);
          display: block;
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-code);
          line-height: var(--line-height-mono);
          margin: var(--spacing-m) 0;
          padding: var(--spacing-xxs) var(--spacing-s);
          overflow-x: auto;
          /* Pre will preserve whitespace and line breaks but not wrap */
          white-space: pre;
        }
        /* Non-multiline code elements need display:inline to shrink and not take
         a whole row */
        :not(pre) > code {
          display: inline;
        }
        li {
          margin-left: var(--spacing-xl);
        }
        gr-account-chip {
          display: inline;
        }
        .plaintext {
          font: inherit;
          white-space: var(--linked-text-white-space, pre-wrap);
          word-wrap: var(--linked-text-word-wrap, break-word);
        }
        .markdown-html {
          /* code overrides white-space to pre, everything else should wrap as
           normal. */
          white-space: normal;
          /* prose will automatically wrap but inline <code> blocks won't and we
           should overflow in that case rather than wrapping or leaking out */
          overflow-x: auto;
        }
      `]}constructor(){super(),this.content="",this.markdown=!1,this.repoCommentLinks={},this.getConfigModel=yu(this,Qw),this.MARKDOWN_LIMIT=1e5,this.allowMarkdownBase64ImagesInComments=!1,this.markedRenderComplete=()=>{this.convertEmailsToAccountChips(),this.convertCodeToSuggestions()},zf(this,(()=>this.getConfigModel().repoCommentLinks$),(e=>{this.repoCommentLinks=e,this.repoCommentLinks.ALWAYS_LINK_HTTP={match:"(https?://((?!&(gt|lt|quot|apos);)\\S)+[\\w/~\\)-])",link:"$1",enabled:!0};const t=["com","org","net","edu","gov","co","jp","de","uk","fr","us","io"].join("|");this.repoCommentLinks.ALWAYS_LINK_SCHEMELESS={match:`(?<=\\s|^|[('":[])((?:[\\w-]+\\.)+(?:${t})(?=.*?/)(?:[/?#][^\\s'"]*))(?=\\s|$|[)'"!?.,])`,link:"http://$1",enabled:!0}})),zf(this,(()=>this.getConfigModel().allowMarkdownBase64ImagesInComments$),(e=>{this.allowMarkdownBase64ImagesInComments=e}))}render(){return dc`
      <gr-endpoint-decorator name="formatted-text-endpoint">
        ${this.markdown&&this.content.length<this.MARKDOWN_LIMIT?this.renderAsMarkdown():this.renderAsPlaintext()}
      </gr-endpoint-decorator>
    `}renderAsPlaintext(){const e=G$(zl(this.content).toString(),this.repoCommentLinks);return dc`
      <pre class="plaintext">${hd(e)}</pre>
    `}renderAsMarkdown(){const e=e=>G$(e,Object.fromEntries(Object.entries(this.repoCommentLinks).filter((([e,t])=>!t.match.includes("\\*"))))),t=e=>`<p>${G$(e,Object.fromEntries(Object.entries(this.repoCommentLinks).filter((([e,t])=>t.match.includes("\\*")))))}</p>`,i=this.allowMarkdownBase64ImagesInComments;return dc`
      <gr-marked-element
        .markdown=${this.escapeAllButBlockQuotes(this.content)}
        .breaks=${!0}
        .renderer=${function(r){r.link=(e,t,i)=>(e.startsWith("https://")||e.startsWith("mailto:")||e.startsWith("http://")||e.startsWith("/")||(e=`https://${e}`),`<a\n          href="${e}"\n          ${If(e)?"":'target="_blank" rel="noopener noreferrer"'}\n          ${t?`title="${t}"`:""}\n          >${i}</a\n        >`),r.image=(e,t,r)=>i&&QT.test(e)?`<img src="${e}" alt="${r}" ${t?`title="${t}"`:""} />`:`![${r}](${e})`,r.codespan=e=>{return`<code>${t=e,t.replace(/&#x27;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}</code>`;var t},r.code=(e,t)=>t===cC?`<mark>${e}</mark>`:`<pre><code>${e}</code></pre>`,r.paragraph=t,r.text=e}}
        .callback=${(e,t)=>function(e){return cd.sanitize(e)}(t)}
      >
        <div class="markdown-html" slot="markdown-html"></div>
      </gr-marked-element>
    `}escapeAllButBlockQuotes(e){for(e=zl(e).toString();;){const t=e.replace(/(^|\n)((?:\s{0,3}&gt;)*\s{0,3})&gt;/g,"$1$2>");if(t===e)break;e=t}return e}updated(){this.removeEventListener("marked-render-complete",this.markedRenderComplete),this.addEventListener("marked-render-complete",this.markedRenderComplete)}convertEmailsToAccountChips(){for(const e of this.renderRoot.querySelectorAll('a[href^="mailto"]')){const t=e.previousSibling;if("#text"===t?.nodeName&&t?.textContent?.match(/(^|\s)@$/)){const i=document.createElement("gr-account-chip");i.account={email:e.textContent},i.removable=!1,t.textContent=t.textContent.slice(0,-1),e.parentNode?.replaceChild(i,e)}}}convertCodeToSuggestions(){this.renderRoot.querySelectorAll("mark").forEach(((e,t)=>{const i=document.createElement("gr-user-suggestion-fix");this.content.includes("\t")?i.textContent=gC(this.content,t):i.textContent=e.textContent??"",e.parentNode?.replaceChild(i,e)}))}};JT([Fc({type:String})],ZT.prototype,"content",void 0),JT([Fc({type:Boolean})],ZT.prototype,"markdown",void 0),JT([Uc()],ZT.prototype,"repoCommentLinks",void 0),JT([Uc()],ZT.prototype,"MARKDOWN_LIMIT",void 0),JT([Uc()],ZT.prototype,"allowMarkdownBase64ImagesInComments",void 0),ZT=JT([Dc("gr-formatted-text")],ZT);var eI=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const tI=ix(Ic);let iI=class extends tI{static get styles(){return[Qb,tI.styles||[],Sd`
        #container {
          min-width: 300px;
          max-width: 300px;
          padding: var(--spacing-xl) 0 var(--spacing-m) 0;
        }
        .row {
          display: flex;
        }
        .title {
          color: var(--deemphasized-text-color);
          margin-right: var(--spacing-m);
        }
        div.section {
          margin: 0 var(--spacing-xl) var(--spacing-m) var(--spacing-xl);
          display: flex;
          align-items: flex-start;
        }
        div.sectionIcon {
          flex: 0 0 30px;
        }
        div.sectionIcon gr-icon {
          position: relative;
          font-size: 20px;
        }
      `]}render(){return dc` <div id="container" role="tooltip" tabindex="-1">
      <div class="section">
        <div class="sectionContent">
          <h3 class="name heading-3">
            <span>${this.labelName}</span>
          </h3>
        </div>
      </div>
      <div class="section">
        <div class="sectionIcon">
          <gr-icon icon="info" class="small"></gr-icon></span>
        </div>
        <div class="sectionContent">
          <div class="row">
            <div class="title">Status</div>
            <div>
              <slot name="label-info"></slot>
            </div>
          </div>
        </div>
      </div>
      ${this.renderDescription()}
    </div>`}renderDescription(){const e=this.labelInfo?.description;if(e)return dc`<div class="section description">
      <div class="sectionIcon">
        <gr-icon icon="description"></gr-icon>
      </div>
      <div class="sectionContent">
        <gr-formatted-text
          .markdown=${!0}
          .content=${e}
        ></gr-formatted-text>
      </div>
    </div>`}};eI([Fc()],iI.prototype,"labelName",void 0),eI([Fc({type:Object})],iI.prototype,"labelInfo",void 0),iI=eI([Dc("gr-trigger-vote-hovercard")],iI);var rI=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let oI=class extends Ic{constructor(){super(...arguments),this.disableHovercards=!1}static get styles(){return Sd`
      :host {
        display: block;
      }
      .container {
        box-sizing: border-box;
        border: 1px solid var(--border-color);
        border-radius: calc(var(--border-radius) + 2px);
        background-color: var(--background-color-primary);
        display: flex;
        padding: 0;
        padding-left: var(--spacing-s);
        padding-right: var(--spacing-xxs);
        align-items: center;
      }
      .label {
        padding-right: var(--spacing-s);
        font-weight: var(--font-weight-medium);
      }
      gr-vote-chip {
        --gr-vote-chip-width: 14px;
        --gr-vote-chip-height: 14px;
        margin-right: 0px;
        margin-left: var(--spacing-xs);
      }
      gr-vote-chip:first-of-type {
        margin-left: 0px;
      }
    `}render(){if(this.labelInfo)return dc`
      <div class="container">
        ${this.renderHovercard()}
        <span class="label">${this.label}</span>
        ${this.renderVotes()}
      </div>
    `}renderHovercard(){if(!this.disableHovercards&&this.label)return dc`<gr-trigger-vote-hovercard
      .labelName=${this.label}
      .labelInfo=${this.labelInfo}
    >
      <gr-label-info
        slot="label-info"
        .change=${this.change}
        .account=${this.account}
        .mutable=${!!this.mutable}
        .label=${this.label}
        .labelInfo=${this.labelInfo}
        .showAllReviewers=${!1}
      ></gr-label-info>
    </gr-trigger-vote-hovercard>`}renderVotes(){const{labelInfo:e}=this;if(e)return this.displayValue?dc`<gr-vote-chip
        .displayValue=${this.displayValue}
        .label=${e}
      ></gr-vote-chip>`:Xu(e)?mv(e).filter((t=>!dv(e,t))).map((t=>dc`<gr-vote-chip
          .vote=${t}
          .label=${e}
        ></gr-vote-chip>`)):Zu(e)?[dc`<gr-vote-chip .label=${e}></gr-vote-chip>`]:dc``}};var sI;rI([Fc()],oI.prototype,"label",void 0),rI([Fc({type:Object})],oI.prototype,"labelInfo",void 0),rI([Fc({type:Object})],oI.prototype,"change",void 0),rI([Fc({type:Object})],oI.prototype,"account",void 0),rI([Fc()],oI.prototype,"displayValue",void 0),rI([Fc({type:Boolean})],oI.prototype,"mutable",void 0),rI([Fc({type:Boolean,attribute:"disable-hovercards"})],oI.prototype,"disableHovercards",void 0),oI=rI([Dc("gr-trigger-vote")],oI),function(e){e.OK="OK",e.ERROR="ERROR",e.NOT_LOGGED_IN="NOT_LOGGED_IN"}(sI||(sI={}));const nI="useful",aI="not-useful";var lI,dI,cI,hI,pI;function uI(e){if(void 0===e)return{name:"open_in_new"};switch(e){case hI.EXTERNAL:return{name:"open_in_new"};case hI.IMAGE:return{name:"image",filled:!0};case hI.HISTORY:return{name:"history"};case hI.DOWNLOAD:return{name:"download"};case hI.DOWNLOAD_MOBILE:return{name:"system_update"};case hI.HELP_PAGE:return{name:"help"};case hI.REPORT_BUG:return{name:"bug_report",filled:!0};case hI.CODE:return{name:"code"};case hI.FILE_PRESENT:return{name:"file_present"};case hI.VIEW_TIMELINE:return{name:"view_timeline"};default:return{name:"open_in_new"}}}function gI(e){if(void 0===e)return"Link to details";switch(e){case hI.EXTERNAL:return"Link to details";case hI.IMAGE:return"Link to image";case hI.HISTORY:return"Link to result history";case hI.DOWNLOAD:case hI.DOWNLOAD_MOBILE:return"Download";case hI.HELP_PAGE:return"Link to help page";case hI.REPORT_BUG:return"Link for reporting a problem";case hI.CODE:return"Link to code";case hI.FILE_PRESENT:return"Link to file";default:return"Link to details"}}function mI(e,t,i){const r=e.codePointers?.[0];ba(r,"code pointer required for conversion to comment");const o={...Kx(t,i),path:r.path,patch_set:e.patchset,side:Yu.REVISION};return r.range?.start_line>0&&r.range?.end_line>0&&r.range?.start_character>=0&&r.range?.end_character>=0&&(o.range=r.range),r.range?.end_line>0?o.line=r.range.end_line:r.range?.start_line>0&&(o.line=r.range.start_line),o}function fI(e,t){if(!t?.patchset)return;if(!t?.fixes)return;const i=t.fixes.map((e=>vI(e,t?.checkName))).filter(cf);if(0===i.length)return;const r={patchNum:t.patchset,fixSuggestions:i,onCloseFixPreviewCallbacks:[]};return{name:"Show Fix",callback:()=>{Jn(e,"open-fix-preview",r)}}}function vI(e,t){if(!e?.replacements||!t)return;const i=e.replacements.map(bI).filter(cf);return 0!==i.length?{description:[e.description,`Fix provided by ${t}`].filter(Boolean).join(" - "),fix_id:pC,replacements:i}:void 0}function bI(e){if(e?.path&&e?.range&&void 0!==e?.replacement&&Number.isInteger(e.range.start_line)&&Number.isInteger(e.range.end_line)&&Number.isInteger(e.range.start_character)&&Number.isInteger(e.range.end_character))return e}function yI(e){return AI(e,dI.ERROR)?dI.ERROR:AI(e,dI.WARNING)?dI.WARNING:AI(e,dI.INFO)?dI.INFO:AI(e,dI.SUCCESS)?dI.SUCCESS:void 0}function wI(e){switch(e){case dI.ERROR:return{name:"error",filled:!0};case dI.INFO:return{name:"info"};case dI.WARNING:return{name:"warning",filled:!0};case dI.SUCCESS:case lI.COMPLETED:return{name:"check_circle"};case lI.RUNNABLE:return{name:""};case lI.RUNNING:return{name:"timelapse"};case lI.SCHEDULED:return{name:"pending_actions"};default:fa(e,`Unsupported category/status: ${e}`)}}function _I(e){switch(e){case lI.COMPLETED:return"Completed";case lI.RUNNABLE:return"Not run";case lI.RUNNING:return"Running";case lI.SCHEDULED:return"Scheduled";default:fa(e,`Unsupported status: ${e}`)}}function xI(e){if(e)return CI(e).filter((t=>!t.disabled&&t.name===function(e){switch(e){case lI.COMPLETED:return pI.RERUN;case lI.RUNNABLE:return pI.RUN;case lI.RUNNING:case lI.SCHEDULED:return;default:fa(e,`Unsupported status: ${e}`)}}(e.status)))[0]}function CI(e){return e?.actions?e.actions.map((t=>function(e,t){let i=e.name.toLowerCase();return t!==lI.COMPLETED||"run"!==i&&"re-run"!==i||(i=pI.RERUN),{...e,name:i}}(t,e.status))):[]}function EI(e){if(e.status!==lI.COMPLETED)return wI(e.status);return wI(e.worstCategory||e.status)}function SI(e){return e.status===lI.RUNNING||e.status===lI.SCHEDULED}function $I(e){return e.status===lI.COMPLETED||e.status===lI.RUNNING||e.status===lI.SCHEDULED}function kI(e){return e.status===lI.COMPLETED&&0===(e.results??[]).length}function AI(e,t){return RI(e,t).length>0}function RI(e,t){return(e.results??[]).filter((e=>e.category===t))}function TI(e,t){const i=II(t.worstCategory)-II(e.worstCategory);return 0!==i?i:PI(t.status)-PI(e.status)}function II(e){if(!e)return-1;switch(e){case dI.SUCCESS:return 0;case dI.INFO:return 1;case dI.WARNING:return 2;case dI.ERROR:return 3}}function PI(e){switch(e){case lI.COMPLETED:return 0;case lI.RUNNABLE:return 1;case lI.RUNNING:return 2;case lI.SCHEDULED:return 3;default:fa(e,`Unsupported status: ${e}`)}}!function(e){e.RUNNABLE="RUNNABLE",e.RUNNING="RUNNING",e.SCHEDULED="SCHEDULED",e.COMPLETED="COMPLETED"}(lI||(lI={})),function(e){e.SUCCESS="SUCCESS",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}(dI||(dI={})),function(e){e.GRAY="gray",e.YELLOW="yellow",e.PINK="pink",e.PURPLE="purple",e.CYAN="cyan",e.BROWN="brown"}(cI||(cI={})),function(e){e.EXTERNAL="external",e.IMAGE="image",e.HISTORY="history",e.DOWNLOAD="download",e.DOWNLOAD_MOBILE="download_mobile",e.HELP_PAGE="help_page",e.REPORT_BUG="report_bug",e.CODE="code",e.FILE_PRESENT="file_present",e.VIEW_TIMELINE="view_timeline"}(hI||(hI={})),function(e){e.RERUN="rerun",e.RUN="run"}(pI||(pI={}));const NI="all",OI="latest";function DI(e){return"string"==typeof e?e===NI||e===OI:"number"==typeof e&&e>=0}function LI(e){if(void 0===e)return;if(null===e)return;if(""===e)return;if(DI(e))return e;const t=Number(e);return DI(t)?t:void 0}function MI(e){return e===OI?"Latest Attempt":e===NI?"All Attempts":`Attempt ${e}`}function FI(e,t){return UI(e.attempt,t.attempt)}function UI(e,t){return e===t?0:void 0===e?-1:void 0===t?1:e===OI?-1:t===OI?1:e===NI?-1:t===NI?1:(va("number"==typeof e,`unexpected attempt ${e}`),va("number"==typeof t,`unexpected attempt ${t}`),e-t)}function BI(e){return{...e,pluginName:"fake",internalRunId:"fake",isSingleAttempt:!1,isLatestAttempt:!1,attemptDetails:[],worstCategory:yI(e),results:(e.results??[]).map(HI)}}function HI(e){return{...e,internalResultId:"fake"}}function jI(e){return(e?.links??[]).filter((e=>e.primary))}function GI(e){return jI(e).find((e=>e.icon===hI.EXTERNAL))}function zI(e){const t=GI(e);return jI(e).filter((e=>e!==t))}function VI(e){const t=!!e?.message,i=(e?.links??[]).length>1,r=(e?.codePointers??[]).length>0,o=(e?.fixes??[]).length>0;return t||i||r||o}var WI=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let qI=class extends Ic{constructor(){super(...arguments),this.text="",this.links=[],this.reporting=Xn().reportingService}static get styles(){return[Qb,Nc,Sd`
        :host {
          display: inline-block;
          position: relative;
          white-space: nowrap;
        }
        .checksChip {
          color: var(--chip-color);
          cursor: pointer;
          display: inline-block;
          margin-right: var(--spacing-s);
          padding: var(--spacing-xxs) var(--spacing-m) var(--spacing-xxs)
            var(--spacing-s);
          border-radius: 12px;
          border: 1px solid gray;
          /* centered position of 20px chips in 24px line-height inline flow */
          vertical-align: top;
          position: relative;
          top: 2px;
        }
        .checksChip.hoverFullLength {
          position: absolute;
          z-index: 1;
          display: none;
        }
        .checksChip.hoverFullLength .text {
          max-width: 500px;
        }
        :host(:hover) .checksChip.hoverFullLength {
          display: inline-block;
        }
        .checksChip .text {
          display: inline-block;
          max-width: 120px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          vertical-align: top;
        }
        gr-icon {
          font-size: var(--line-height-small);
        }
        .checksChip a gr-icon.launch {
          color: var(--link-color);
        }
        .checksChip.error {
          color: var(--error-foreground);
          border-color: var(--error-foreground);
          background: var(--error-background);
        }
        .checksChip.error:hover {
          background: var(--error-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.error:focus-within {
          background: var(--error-background-focus);
        }
        .checksChip.error gr-icon {
          color: var(--error-foreground);
        }
        .checksChip.warning {
          border-color: var(--warning-foreground);
          background: var(--warning-background);
        }
        .checksChip.warning:hover {
          background: var(--warning-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.warning:focus-within {
          background: var(--warning-background-focus);
        }
        .checksChip.warning gr-icon {
          color: var(--warning-foreground);
        }
        .checksChip.info {
          border-color: var(--info-foreground);
          background: var(--info-background);
        }
        .checksChip.info:hover {
          background: var(--info-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.info:focus-within {
          background: var(--info-background-focus);
        }
        .checksChip.info gr-icon {
          color: var(--info-foreground);
        }
        .checksChip.check_circle {
          border-color: var(--success-foreground);
          background: var(--success-background);
        }
        .checksChip.check_circle:hover {
          background: var(--success-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.check_circle:focus-within {
          background: var(--success-background-focus);
        }
        .checksChip.check_circle gr-icon {
          color: var(--success-foreground);
        }
        .checksChip.timelapse,
        .checksChip.scheduled {
          border-color: var(--gray-foreground);
          background: var(--gray-background);
        }
        .checksChip.timelapse:hover,
        .checksChip.pending_actions:hover {
          background: var(--gray-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .checksChip.timelapse:focus-within,
        .checksChip.pending_actions:focus-within {
          background: var(--gray-background-focus);
        }
        .checksChip.timelapse gr-icon,
        .checksChip.pending_actions gr-icon {
          color: var(--gray-foreground);
        }
      `]}render(){if(!this.text)return;if(!this.statusOrCategory)return;const e=wI(this.statusOrCategory),t=this.computeAriaLabel(),i=`checksChip font-small ${e.name}`,r=`${i} hoverFullLength`;return dc`
      ${this.text.length>15?dc` ${this.renderChip(r,t,e)}`:""}
      ${this.renderChip(i,t,e)}
    `}computeAriaLabel(){if(!this.statusOrCategory)return"";const e=function(e){switch(e){case dI.ERROR:return"error";case dI.INFO:return"info";case dI.WARNING:return"warning";case dI.SUCCESS:return"success";case lI.COMPLETED:return"completed";case lI.RUNNABLE:return"runnable";case lI.RUNNING:return"running";case lI.SCHEDULED:return"scheduled";default:fa(e,`Unsupported category/status: ${e}`)}}(this.statusOrCategory),t=(i=this.statusOrCategory)===lI.COMPLETED||i===lI.RUNNABLE||i===lI.SCHEDULED||i===lI.RUNNING?"run":"result";var i;const r=Number(this.text);if(!isNaN(r)){const i=r>1?"s":"";return`${this.text} ${e} ${t}${i}`}return`${e} for check ${this.text}`}renderChip(e,t,i){return dc`
      <div class=${e} role="link" tabindex="0" aria-label=${t}>
        <gr-icon icon=${i.name} ?filled=${!!i.filled}></gr-icon>
        ${this.renderLinks()}
        <div class="text">${this.text}</div>
      </div>
    `}renderLinks(){return this.links.map((e=>dc`
        <a
          href=${e}
          target="_blank"
          rel="noopener noreferrer"
          @click=${this.onLinkClick}
          @keydown=${this.onLinkKeyDown}
          aria-label="Link to check details"
          ><gr-icon icon="open_in_new" class="launch"></gr-icon
        ></a>
      `))}onLinkKeyDown(e){e.stopPropagation()}onLinkClick(e){e.stopPropagation(),this.reporting.reportInteraction(ga.CHECKS_CHIP_LINK_CLICKED,{text:this.text,status:this.statusOrCategory})}};WI([Fc()],qI.prototype,"statusOrCategory",void 0),WI([Fc()],qI.prototype,"text",void 0),WI([Fc({type:Array})],qI.prototype,"links",void 0),qI=WI([Dc("gr-checks-chip")],qI);var KI,YI=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e.INFO="info",e.WARNING="warning",e.CHECK="check",e.UNDEFINED=""}(KI||(KI={}));let XI=class extends Ic{constructor(){super(...arguments),this.icon="",this.iconFilled=!1,this.styleType=KI.UNDEFINED,this.reporting=Xn().reportingService}static get styles(){return[Nc,Qb,Sd`
        .summaryChip {
          color: var(--chip-color);
          cursor: pointer;
          display: inline-block;
          padding: var(--spacing-xxs) var(--spacing-m) var(--spacing-xxs)
            var(--spacing-s);
          margin-right: var(--spacing-s);
          border-radius: 12px;
          border: 1px solid gray;
          vertical-align: top;
          /* centered position of 20px chips in 24px line-height inline flow */
          vertical-align: top;
          position: relative;
          top: 2px;
        }
        gr-icon {
          font-size: var(--line-height-small);
        }
        .summaryChip.info {
          border-color: var(--info-foreground);
          background: var(--info-background);
        }
        button.summaryChip.info:hover {
          background: var(--info-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .summaryChip.info:focus-within {
          background: var(--info-background-focus);
        }
        .summaryChip.info gr-icon {
          color: var(--info-foreground);
        }
        .summaryChip.warning {
          border-color: var(--warning-foreground);
          background: var(--warning-background);
        }
        button.summaryChip.warning:hover {
          background: var(--warning-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .summaryChip.warning:focus-within {
          background: var(--warning-background-focus);
        }
        .summaryChip.warning gr-icon {
          color: var(--warning-foreground);
        }
        .summaryChip.check {
          border-color: var(--gray-foreground);
          background: var(--gray-background);
        }
        button.summaryChip.check:hover {
          background: var(--gray-background-hover);
          box-shadow: var(--elevation-level-1);
        }
        .summaryChip.check:focus-within {
          background: var(--gray-background-focus);
        }
        .summaryChip.check gr-icon {
          color: var(--gray-foreground);
        }
      `]}render(){const e=`summaryChip font-small ${this.styleType}`;return this.clickable?dc`<button class=${e} @click=${this.handleClick}>
        ${this.renderIconAndSlot()}
      </button>`:dc`<span class=${e}>${this.renderIconAndSlot()}</span>`}renderIconAndSlot(){return dc` ${this.icon&&dc`<gr-icon ?filled=${this.iconFilled} icon=${this.icon}></gr-icon>`}
      <slot></slot>`}handleClick(e){e.stopPropagation(),e.preventDefault(),this.reporting.reportInteraction("comment chip click",{category:this.category}),na(this,ng.COMMENT_THREADS,!0,{commentTab:this.category})}};YI([Fc()],XI.prototype,"icon",void 0),YI([Fc({type:Boolean})],XI.prototype,"iconFilled",void 0),YI([Fc()],XI.prototype,"styleType",void 0),YI([Fc()],XI.prototype,"category",void 0),YI([Fc({type:Boolean})],XI.prototype,"clickable",void 0),XI=YI([Dc("gr-summary-chip")],XI);var JI,QI=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let ZI=JI=class extends Ic{static get styles(){return[Sd`
        gr-avatar {
          box-sizing: border-box;
          vertical-align: top;
          height: var(--avatar-size, 16px);
          width: var(--avatar-size, 16px);
          border: solid 1px var(--stack-border-color, transparent);
        }
        gr-avatar:not(:first-child) {
          margin-left: calc((var(--avatar-size, 16px) / -2));
        }
      `]}constructor(){super(),this.accounts=[],this.detailedAccounts=[],this.imageSize=16,this.enableHover=!1,this.forceFetch=!1,this.getAccountsModel=yu(this,mE),this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.config=e))}updated(e){e.has("accounts")&&(this.forceFetch&&this.accounts.length>0&&this.accounts.some((e=>!fx(e)))?Promise.all(this.accounts.map((e=>this.getAccountsModel().fillDetails(e)))).then((e=>{this.detailedAccounts=e.filter((e=>cf(e)&&fx(e)))})):this.detailedAccounts=this.accounts)}render(){const e=this.forceFetch?this.detailedAccounts.filter(mx):this.detailedAccounts.filter((e=>!!e?.avatars?.[0]?.url)).filter(gx);return!this.config?.plugin?.has_avatars||0===e.length||e.length>JI.MAX_STACK?dc`<slot name="fallback"></slot>`:e.map((e=>dc`<gr-avatar
          .account=${e}
          .imageSize=${this.imageSize}
          aria-label=${ox(this.config,e)}
        >
          ${eb(this.enableHover,(()=>dc`<gr-hovercard-account
                .account=${e}
              ></gr-hovercard-account>`))}
        </gr-avatar>`))}};var eP;ZI.MAX_STACK=4,QI([Fc({type:Array})],ZI.prototype,"accounts",void 0),QI([Uc()],ZI.prototype,"detailedAccounts",void 0),QI([Fc({type:Number})],ZI.prototype,"imageSize",void 0),QI([Fc({type:Boolean})],ZI.prototype,"enableHover",void 0),QI([Fc({type:Boolean})],ZI.prototype,"forceFetch",void 0),QI([Uc()],ZI.prototype,"config",void 0),ZI=JI=QI([Dc("gr-avatar-stack")],ZI),function(e){e.UNRESOLVED="unresolved",e.DRAFTS="drafts",e.SHOW_ALL="show all",e.MENTIONS="mentions"}(eP||(eP={}));var tP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let iP=class extends Ic{constructor(){super(),this.commentsLoading=!1,this.draftCount=0,this.mentionCount=0,this.showCommentCategoryName=!1,this.clickableChips=!1,this.emptyWhenNoComments=!1,this.showAvatarForResolved=!1,this.getUserModel=yu(this,jf),zf(this,(()=>this.getUserModel().account$),(e=>this.selfAccount=e))}static get styles(){return[Yc,Sd`
        /* The basics of .loadingSpin are defined in shared styles. */
        .loadingSpin {
          width: calc(var(--line-height-normal) - 2px);
          height: calc(var(--line-height-normal) - 2px);
          display: inline-block;
          vertical-align: top;
          position: relative;
          /* Making up for the 2px reduced height above. */
          top: 1px;
        }
        .zeroState {
          color: var(--deemphasized-text-color);
        }
        gr-avatar-stack {
          --avatar-size: var(--line-height-small, 16px);
          --stack-border-color: var(--warning-background);
        }
        .unresolvedIcon {
          font-size: var(--line-height-small);
          color: var(--warning-foreground);
        }
      `]}render(){const e=this.commentThreads??[],t=e.filter(eC).length,i=e.filter(Zx),r=i.length,o=this.getAccounts(i),s=this.showAvatarForResolved?this.getAccounts(e.filter(eC)):void 0;return dc`
      ${eb(this.commentsLoading,(()=>dc`<span class="loadingSpin"></span>`))}
      ${this.renderZeroState(t,r)}
      ${this.renderDraftChip()} ${this.renderMentionChip()}
      ${this.renderUnresolvedCommentsChip(r,o)}
      ${this.renderResolvedCommentsChip(t,s)}
    `}renderZeroState(e,t){return this.emptyWhenNoComments||e||this.draftCount||t?uc:this.commentsLoading?dc`<span class="zeroState"> Loading comments...</span>`:dc`<span class="zeroState"> No comments</span>`}renderMentionChip(){return this.mentionCount?dc` <gr-summary-chip
      class="mentionSummary"
      styleType=${KI.WARNING}
      category=${eP.MENTIONS}
      icon="alternate_email"
      .clickable=${this.clickableChips}
    >
      ${Ig(this.mentionCount,"mention")}</gr-summary-chip
    >`:uc}renderDraftChip(){return this.draftCount?dc` <gr-summary-chip
      styleType=${KI.INFO}
      category=${eP.DRAFTS}
      icon="rate_review"
      iconFilled
      .clickable=${this.clickableChips}
      title=${this.showCommentCategoryName?uc:Ig(this.draftCount,"draft")}
    >
      ${this.showCommentCategoryName?Ig(this.draftCount,"draft"):this.draftCount}</gr-summary-chip
    >`:uc}renderUnresolvedCommentsChip(e,t){return e?dc` <gr-summary-chip
      styleType=${KI.WARNING}
      category=${eP.UNRESOLVED}
      ?hidden=${!e}
      .clickable=${this.clickableChips}
      title=${this.showCommentCategoryName?uc:`${e} unresolved`}
    >
      <gr-avatar-stack .accounts=${t} imageSize="32">
        <gr-icon
          slot="fallback"
          icon="chat_bubble"
          filled
          class="unresolvedIcon"
        >
        </gr-icon>
      </gr-avatar-stack>
      ${this.showCommentCategoryName?`${e} unresolved`:`${e}`}</gr-summary-chip
    >`:uc}renderResolvedCommentsChip(e,t){return e?t?dc` <gr-summary-chip
        styleType=${KI.CHECK}
        category=${eP.SHOW_ALL}
        .clickable=${this.clickableChips}
        title=${this.showCommentCategoryName?uc:`${e} resolved`}
        icon="mark_chat_read"
        ><gr-avatar-stack .accounts=${t} imageSize="32">
          <gr-icon
            slot="fallback"
            icon="chat_bubble"
            filled
            class="unresolvedIcon"
          >
          </gr-icon> </gr-avatar-stack
        >${this.showCommentCategoryName?`${e} resolved`:`${e}`}</gr-summary-chip
      >`:dc` <gr-summary-chip
      styleType=${KI.CHECK}
      category=${eP.SHOW_ALL}
      .clickable=${this.clickableChips}
      icon="mark_chat_read"
      title=${this.showCommentCategoryName?uc:`${e} resolved`}
      >${this.showCommentCategoryName?`${e} resolved`:`${e}`}</gr-summary-chip
    >`:uc}getAccounts(e){return e.map(Jx).map((e=>e?.author??this.selfAccount)).filter(cf)}};var rP;function oP(e,t){return{pluginName:e.pluginName,attempt:e.attempt,patchset:e.patchset,isLatestAttempt:e.isLatestAttempt,checkName:e.checkName,labelName:e.labelName,status:e.status,statusLink:e.statusLink,statusDescription:e.statusDescription,startedTimestamp:e.startedTimestamp,scheduledTimestamp:e.scheduledTimestamp,finishedTimestamp:e.finishedTimestamp,checkLink:e.checkLink,checkDescription:e.checkDescription,actions:e.actions,attemptDetails:e.attemptDetails,worstCategory:e.worstCategory,...t}}tP([Fc({type:Object})],iP.prototype,"commentThreads",void 0),tP([Fc({type:Boolean})],iP.prototype,"commentsLoading",void 0),tP([Fc({type:Number})],iP.prototype,"draftCount",void 0),tP([Fc({type:Number})],iP.prototype,"mentionCount",void 0),tP([Fc({type:Boolean})],iP.prototype,"showCommentCategoryName",void 0),tP([Fc({type:Boolean})],iP.prototype,"clickableChips",void 0),tP([Fc({type:Boolean})],iP.prototype,"emptyWhenNoComments",void 0),tP([Fc({type:Boolean})],iP.prototype,"showAvatarForResolved",void 0),tP([Uc()],iP.prototype,"selfAccount",void 0),iP=tP([Dc("gr-comments-summary")],iP),function(e){e.LATEST="LATEST",e.SELECTED="SELECTED"}(rP||(rP={}));const sP=mu("checks-model");function nP(e,t){return[...e,...t.runs.reduce(((e,t)=>{const i=t.results?.map((e=>oP(t,e)))??[];return e.concat(i??[])}),[])]}class aP extends df{constructor(e,t,i,r){super({pluginStateLatest:{},pluginStateSelected:{}}),this.changeViewModel=e,this.changeModel=t,this.reporting=i,this.pluginsModel=r,this.providers={},this.reloadSubjects={},this.checkToPluginMap=new Map,this.documentVisibilityChange$=new Up(void 0),this.reporting.time(ua.CHECKS_LOAD),this.checksSelectedPatchsetNumber$=lf(this.changeViewModel.checksPatchset$,(e=>e)),this.checksSelectedAttemptNumber$=lf(this.changeViewModel.attempt$,(e=>e??OI)),this.runFilterRegexp$=lf(this.changeViewModel.filter$,(e=>e??"")),this.checksLatest$=lf(this.state$,(e=>e.pluginStateLatest)),this.checksSelected$=lf(Yh([this.state$,this.changeViewModel.checksPatchset$]),(([e,t])=>{const i=t?rP.SELECTED:rP.LATEST;return this.getPluginState(e,i)})),this.aPluginHasRegistered$=lf(this.checksLatest$,(e=>Object.keys(e).length>0)),this.firstLoadCompleted$=lf(this.checksLatest$,(e=>{const t=Object.values(e);return 0!==t.length&&!t.some((e=>e.loading||e.firstTimeLoad))})),this.someProvidersAreLoadingFirstTime$=lf(this.checksLatest$,(e=>Object.values(e).some((e=>e.loading&&e.firstTimeLoad)))),this.someProvidersAreLoadingLatest$=lf(this.checksLatest$,(e=>Object.values(e).some((e=>e.loading)))),this.someProvidersAreLoadingSelected$=lf(this.checksSelected$,(e=>Object.values(e).some((e=>e.loading)))),this.errorMessageLatest$=lf(this.checksLatest$,(e=>Object.values(e).find((e=>void 0!==e.errorMessage))?.errorMessage)),this.errorMessagesLatest$=lf(this.checksLatest$,(e=>{const t={};for(const i of Object.values(e))void 0!==i.errorMessage&&(t[i.pluginName]=i.errorMessage);return t})),this.loginCallbackLatest$=lf(this.checksLatest$,(e=>Object.values(e).find((e=>void 0!==e.loginCallback))?.loginCallback)),this.topLevelActionsLatest$=lf(this.checksLatest$,(e=>Object.values(e).reduce(((e,t)=>[...e,...t.actions]),[]))),this.topLevelMessagesLatest$=lf(this.checksLatest$,(e=>Object.values(e).map((e=>e.summaryMessage)).filter((e=>!!e)))),this.topLevelActionsSelected$=lf(this.checksSelected$,(e=>Object.values(e).reduce(((e,t)=>[...e,...t.actions]),[]))),this.topLevelLinksSelected$=lf(this.checksSelected$,(e=>Object.values(e).reduce(((e,t)=>[...e,...t.links]),[]))),this.allRunsLatestPatchset$=lf(this.checksLatest$,(e=>Object.values(e).reduce(((e,t)=>[...e,...t.runs]),[]))),this.allRunsSelectedPatchset$=lf(this.checksSelected$,(e=>Object.values(e).reduce(((e,t)=>[...e,...t.runs]),[]))),this.allRunsLatestPatchsetLatestAttempt$=lf(this.allRunsLatestPatchset$,(e=>e.filter((e=>e.isLatestAttempt)))),this.checkToPluginMap$=lf(this.checksLatest$,(e=>{const t=new Map;for(const[i,r]of Object.entries(e))for(const e of r.runs)t.set(e.checkName,i);return t})),this.allResultsSelected$=lf(this.checksSelected$,(e=>Object.values(e).reduce(nP,[]).filter((e=>void 0!==e)))),this.allResultsLatest$=lf(this.checksLatest$,(e=>Object.values(e).reduce(nP,[]).filter((e=>void 0!==e)))),this.allResults$=lf(Yh([this.checksSelectedPatchsetNumber$,this.changeModel.latestPatchNum$,this.allResultsSelected$,this.allResultsLatest$]),(([e,t,i,r])=>e&&e!==t?[...i,...r]:r)),this.subscriptions=[this.changeModel.changeNum$.subscribe((e=>this.changeNum=e)),this.changeModel.latestPatchNum$.subscribe((e=>this.latestPatchNum=e)),this.pluginsModel.checksPlugins$.subscribe((e=>{for(const t of e)this.register(t)})),this.pluginsModel.checksAnnounce$.subscribe((e=>this.reload(e.pluginName))),this.pluginsModel.checksUpdate$.subscribe((e=>this.updateResult(e))),this.checkToPluginMap$.subscribe((e=>{this.checkToPluginMap=e})),this.firstLoadCompleted$.pipe($p((e=>!!e)),Rp(1),du(this.checksLatest$)).subscribe((([e,t])=>this.reportStats(t)))],this.visibilityChangeListener=()=>{this.documentVisibilityChange$.next(void 0)},document.addEventListener("visibilitychange",this.visibilityChangeListener)}reportStats(e){const t={providerCount:0,providerErrorCount:0,providerLoginCount:0,providerActionCount:0,providerLinkCount:0,errorCount:0,warningCount:0,infoCount:0,successCount:0,runnableCount:0,scheduledCount:0,runningCount:0,completedCount:0,errorWithFixCount:0,errorWithoutFixCount:0,errorWithoutFixWithCodePointersCount:0,warningWithFixCount:0,warningWithoutFixCount:0},i=Object.values(e);for(const e of i){t.providerCount++,e.errorMessage&&t.providerErrorCount++,e.loginCallback&&t.providerLoginCount++,e.actions?.length&&t.providerActionCount++,e.links?.length&&t.providerLinkCount++;for(const i of e.runs){i.status===lI.RUNNABLE&&t.runnableCount++,i.status===lI.SCHEDULED&&t.scheduledCount++,i.status===lI.RUNNING&&t.runningCount++,i.status===lI.COMPLETED&&t.completedCount++;for(const e of i.results??[])e.category===dI.ERROR&&(t.errorCount++,e.fixes?.[0]?t.errorWithFixCount++:(t.errorWithoutFixCount++,e.codePointers?.length&&t.errorWithoutFixWithCodePointersCount++)),e.category===dI.WARNING&&(t.warningCount++,e.fixes?.[0]?t.warningWithFixCount++:t.warningWithoutFixCount++),e.category===dI.INFO&&t.infoCount++,e.category===dI.SUCCESS&&t.successCount++}}this.reporting.timeEnd(ua.CHECKS_LOAD,t),this.reporting.reportInteraction(ga.CHECKS_STATS,t)}finalize(){document.removeEventListener("visibilitychange",this.visibilityChangeListener),super.finalize()}updateStateSetProvider(e,t){const i={...this.getState()};this.getPluginState(i,t)[e]={pluginName:e,loading:!1,firstTimeLoad:!0,runs:[],actions:[],links:[]},this.setState(i)}getPluginState(e,t=rP.LATEST){return t===rP.LATEST?(e.pluginStateLatest={...e.pluginStateLatest},e.pluginStateLatest):(e.pluginStateSelected={...e.pluginStateSelected},e.pluginStateSelected)}updateStateSetLoading(e,t){const i={...this.getState()},r=this.getPluginState(i,t);r[e]={...r[e],loading:!0},this.setState(i)}updateStateSetError(e,t,i){const r={...this.getState()},o=this.getPluginState(r,i);o[e]={...o[e],loading:!1,firstTimeLoad:!1,errorMessage:t,loginCallback:void 0,runs:[],actions:[]},this.setState(r)}updateStateSetNotLoggedIn(e,t,i){const r={...this.getState()},o=this.getPluginState(r,i);o[e]={...o[e],loading:!1,firstTimeLoad:!1,errorMessage:void 0,loginCallback:t,runs:[],actions:[]},this.setState(r)}updateStateSetResults(e,t,i=[],r=[],o,s){const n=function(e){const t=new Map;for(const i of e){const e=t.get(i.checkName),r={attempt:i.attempt??0,icon:EI(BI(i))};if(void 0!==e){if(!i.attempt||!e.latestAttempt)throw new Error('If multiple run attempts are provided, then each run must have the "attempt" property set.');e.isSingleAttempt=!1,"all"!==e.latestAttempt&&"latest"!==e.latestAttempt&&i.attempt>e.latestAttempt&&(e.latestAttempt=i.attempt),e.attempts.push(r)}else t.set(i.checkName,{latestAttempt:i.attempt??0,isSingleAttempt:!0,attempts:[r]})}return t}(t=t.filter((e=>!!e.checkName&&!!e.status)));for(const e of n.values())e.attempts.sort(FI);const a={...this.getState()},l=this.getPluginState(a,s),d=l[e];l[e]={...d,loading:!1,firstTimeLoad:!d.loading&&d.firstTimeLoad,errorMessage:void 0,loginCallback:void 0,runs:t.map((t=>{const i=`${t.checkName}-${t.change}-${t.patchset}-${t.attempt}`,r=n.get(t.checkName);return ba(r,"attemptInfo"),{...t,attempt:t.attempt??0,pluginName:e,internalRunId:i,isLatestAttempt:r.latestAttempt===(t.attempt??0),isSingleAttempt:r.isSingleAttempt,attemptDetails:r.attempts,worstCategory:yI(t),results:(t.results??[]).map(((e,t)=>({...e,internalResultId:`${i}-${t}`})))}})),actions:[...i],links:[...r],summaryMessage:o},this.setState(a)}updateStateUpdateResult(e,t,i,r){const o={...this.getState()},s=this.getPluginState(o,r);let n=!1;const a=s[e].runs.map((e=>{if(e.change!==t.change)return e;if(e.patchset!==t.patchset)return e;if(e.attempt!==t.attempt)return e;if(e.checkName!==t.checkName)return e;let r=!1;const o=(e.results??[]).map((e=>e.externalId&&e.externalId===i.externalId?(n=!0,r=!0,{...i,internalResultId:e.internalResultId}):e));return r&&((e={...e,results:o}).worstCategory=yI(e)),e}));n&&(s[e]={...s[e],runs:a},this.setState(o))}updateStateSetPatchset(e){const t=this.changeViewModel.getState()?.patchNum??this.latestPatchNum,i=this.changeViewModel.getState()?.checksPatchset??t;e<=0||e===i||this.changeViewModel.updateState({checksPatchset:e,attempt:OI})}updateStateSetAttempt(e){this.changeViewModel.updateState({attempt:e})}updateStateSetRunFilter(e){this.changeViewModel.updateState({filter:e})}reload(e){this.reloadSubjects[e].next()}reloadAll(){for(const e of Object.keys(this.providers))this.reload(e)}reloadForCheck(e){if(!e)return;const t=this.checkToPluginMap.get(e);t&&this.reload(t)}updateResult(e){const{pluginName:t,run:i,result:r}=e;this.updateStateUpdateResult(t,i,r,rP.LATEST),this.updateStateUpdateResult(t,i,r,rP.SELECTED)}triggerAction(e,t,i){if(!e?.callback)return;if(!this.changeNum)return;const r=t?.patchset??this.latestPatchNum;if(!r)return;this.reporting.reportInteraction(ga.CHECKS_ACTION_TRIGGERED,{checkName:t?.checkName,actionName:e.name,context:i});const o=e.callback(this.changeNum,r,t?.attempt,t?.externalId,t?.checkName,e.name);var s;o?.then&&(ea(document,`Triggering action '${e.name}' ...`),Qh(o).pipe((s=Fh(5e3),function(e){return e.lift(new Kp(s))})).subscribe((e=>{e.errorMessage||e.message?ea(document,`${e.message??e.errorMessage}`):Jn(document,"hide-alert",{}),e.shouldReload&&this.reloadForCheck(t?.checkName)})))}register(e){const{pluginName:t,provider:i,config:r}=e;this.providers[t]?console.warn(`Plugin '${t}' was trying to register twice as a Checks UI provider. Ignored.`):(this.providers[t]=i,this.reloadSubjects[t]=new Up(void 0),this.updateStateSetProvider(t,rP.LATEST),this.updateStateSetProvider(t,rP.SELECTED),this.initFetchingOfData(t,r,rP.LATEST),this.initFetchingOfData(t,r,rP.SELECTED))}initFetchingOfData(e,t,i){const r=1e3*(t?.fetchPollingIntervalSeconds??60);var o,s;this.subscriptions.push(Yh([this.changeModel.change$,i===rP.LATEST?this.changeModel.latestPatchNum$:this.checksSelectedPatchsetNumber$,this.reloadSubjects[e],0===r?Qh([0]):Fh(0,r),this.documentVisibilityChange$]).pipe((o=t=>!!this.providers[e],void 0===s&&(s=!1),function(e){return e.lift(new Xp(o,s))}),$p((e=>"hidden"!==document.visibilityState)),function(e,t,i){return void 0===t&&(t=Dh),void 0===i&&(i=iu),function(e){return e.lift(new ru(500,t,i.leading,i.trailing))}}(0,void 0,{leading:!0,trailing:!0}),Vp((([t,r])=>{if(!t||!r)return Zh(this.empty());if("number"!=typeof r)return Zh(this.empty());ba(t.revisions,"change.revisions");const o=function(e,t){for(const[i,r]of Object.entries(e))if(r._number===t)return i}(t.revisions,r);if(!o)return Zh(this.empty());const s={changeNumber:t?._number,patchsetNumber:r,patchsetSha:o,repo:t.project,commitMessage:HC(t)?.commit?.message,changeInfo:t};return this.fetchResults(e,s,i)})),Gh((t=>(this.reporting.error(`checks-model crash for ${e}`,t),Zh(this.createErrorResponse(e,t)))))).subscribe((t=>{switch(t.responseCode){case sI.ERROR:{const r=t.errorMessage??"-";this.reporting.reportExecution(pa.CHECKS_API_ERROR,{plugin:e,message:r}),this.updateStateSetError(e,r,i);break}case sI.NOT_LOGGED_IN:ba(t.loginCallback,"loginCallback"),this.reporting.reportExecution(pa.CHECKS_API_NOT_LOGGED_IN,{plugin:e}),this.updateStateSetNotLoggedIn(e,t.loginCallback,i);break;case sI.OK:this.updateStateSetResults(e,t.runs??[],t.actions??[],t.links??[],t.summaryMessage,i)}})))}empty(){return{responseCode:sI.OK,runs:[]}}createErrorResponse(e,t){return{responseCode:sI.ERROR,errorMessage:`Error message from plugin '${e}': ${JSON.stringify(t)}`}}fetchResults(e,t,i){this.updateStateSetLoading(e,i);const r=this.reporting.getTimer("ChecksPluginFetch");return Qh(this.providers[e].fetch(t).then((t=>(r.end({pluginName:e}),t)))).pipe((o=16e3,void 0===s&&(s=Dh),function(e,t,i){return void 0===i&&(i=Dh),function(r){var o=pp(e),s=o?+e-i.now():Math.abs(e);return r.lift(new au(s,o,t,i))}}(o,fp(new nu),s))).pipe(Gh((t=>Zh(this.createErrorResponse(e,t)))));var o,s}}var lP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let dP=class extends Ic{constructor(){super(...arguments),this.eventTarget=null,this.context="unknown",this.clicked=!1,this.getChecksModel=yu(this,sP)}connectedCallback(){super.connectedCallback(),ba(this.action,"action")}static get styles(){return[Sd`
        :host {
          display: inline-block;
          white-space: nowrap;
        }
        :host([icon*='thumb']) gr-button {
          display: block;
          --gr-button-padding: 0 var(--spacing-s);
        }
        gr-button {
          --gr-button-padding: var(--spacing-s) var(--spacing-m);
        }
        gr-tooltip-content {
          text-transform: none;
          text-align: center;
          white-space: normal;
        }
      `]}willUpdate(e){this.action.name===nI?this.icon="thumb_up":this.action.name===aI?this.icon="thumb_down":this.icon=void 0}render(){return this.action.tooltip?dc`
      <gr-tooltip-content
        has-tooltip
        ?position-below=${!0}
        .maxWidth=${"200px"}
        title=${this.action.tooltip}
      >
        ${this.renderButton()}
      </gr-tooltip-content>
    `:this.renderButton()}renderName(){return this.icon?dc`
      <gr-icon ?filled=${this.clicked} icon=${this.icon}></gr-icon>
    `:dc`${this.action.name}`}renderButton(){return dc`
      <gr-button
        link
        ?disabled=${!!this.action.disabled}
        class="action"
        @click=${e=>this.handleClick(e)}
      >
        ${this.renderName()}
      </gr-button>
    `}handleClick(e){this.action.name===nI||this.action.name===aI?this.clicked=!0:e.stopPropagation(),this.getChecksModel().triggerAction(this.action,this.runOrResult,this.context)}};lP([Fc({type:Object})],dP.prototype,"action",void 0),lP([Fc({type:Object})],dP.prototype,"eventTarget",void 0),lP([Fc({type:Object})],dP.prototype,"runOrResult",void 0),lP([Fc({type:String})],dP.prototype,"context",void 0),lP([Fc({type:String,reflect:!0})],dP.prototype,"icon",void 0),lP([Uc()],dP.prototype,"clicked",void 0),dP=lP([Dc("gr-checks-action")],dP);class cP extends Gy{computeValidity(e){this.radioElement||(this.radioElement=document.createElement("input"),this.radioElement.type="radio",this.radioElement.name="group");let t=!1,i=!1;for(const{checked:r,required:o}of e)o&&(t=!0),r&&(i=!0);return this.radioElement.checked=i,this.radioElement.required=t,{validity:{valueMissing:t&&!i},validationMessage:this.radioElement.validationMessage}}equals(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){const r=e[i],o=t[i];if(r.checked!==o.checked||r.required!==o.required)return!1}return!0}copy(e){return e.map((({checked:e,required:t})=>({checked:e,required:t})))}}class hP{get controls(){const e=this.host.getAttribute("name");return e&&this.root&&this.host.isConnected?Array.from(this.root.querySelectorAll(`[name="${e}"]`)):[this.host]}constructor(e){this.host=e,this.focused=!1,this.root=null,this.handleFocusIn=()=>{this.focused=!0,this.updateTabIndices()},this.handleFocusOut=()=>{this.focused=!1,this.updateTabIndices()},this.handleKeyDown=e=>{const t="ArrowDown"===e.key,i="ArrowUp"===e.key,r="ArrowLeft"===e.key,o="ArrowRight"===e.key;if(!(r||o||t||i))return;const s=this.controls;if(!s.length)return;e.preventDefault();const n="rtl"===getComputedStyle(this.host).direction?r||t:o||t,a=s.indexOf(this.host);let l=n?a+1:a-1;for(;l!==a;){l>=s.length?l=0:l<0&&(l=s.length-1);const e=s[l];if(!e.hasAttribute("disabled")){for(const t of s)t!==e&&(t.checked=!1,t.tabIndex=-1,t.blur());e.checked=!0,e.tabIndex=0,e.focus(),e.dispatchEvent(new Event("change",{bubbles:!0}));break}n?l++:l--}}}hostConnected(){this.root=this.host.getRootNode(),this.host.addEventListener("keydown",this.handleKeyDown),this.host.addEventListener("focusin",this.handleFocusIn),this.host.addEventListener("focusout",this.handleFocusOut),this.host.checked&&this.uncheckSiblings(),queueMicrotask((()=>{this.updateTabIndices()}))}hostDisconnected(){this.host.removeEventListener("keydown",this.handleKeyDown),this.host.removeEventListener("focusin",this.handleFocusIn),this.host.removeEventListener("focusout",this.handleFocusOut),queueMicrotask((()=>{this.updateTabIndices(),this.root=null}))}handleCheckedChange(){this.host.checked&&(this.uncheckSiblings(),this.updateTabIndices())}uncheckSiblings(){for(const e of this.controls)e!==this.host&&(e.checked=!1)}updateTabIndices(){const e=this.controls,t=e.find((e=>e.checked));if(t||this.focused){const i=t||this.host;i.tabIndex=0;for(const t of e)t!==i&&(t.tabIndex=-1)}else for(const t of e)t.tabIndex=0}}var pP;const uP=Symbol("checked");let gP=0;const mP=Py(Dy(_m(DE(Ic))));class fP extends mP{get checked(){return this[uP]}set checked(e){const t=this.checked;t!==e&&(this[uP]=e,this.requestUpdate("checked",t),this.selectionController.handleCheckedChange())}constructor(){super(),this.maskId="cutout"+ ++gP,this[pP]=!1,this.required=!1,this.value="on",this.selectionController=new hP(this),this.addController(this.selectionController),this[ym].role="radio",this.addEventListener("click",this.handleClick.bind(this)),this.addEventListener("keydown",this.handleKeydown.bind(this))}render(){const e={checked:this.checked};return dc`
      <div class="container ${th(e)}" aria-hidden="true">
        <md-ripple
          part="ripple"
          .control=${this}
          ?disabled=${this.disabled}></md-ripple>
        <md-focus-ring part="focus-ring" .control=${this}></md-focus-ring>
        <svg class="icon" viewBox="0 0 20 20">
          <mask id="${this.maskId}">
            <rect width="100%" height="100%" fill="white" />
            <circle cx="10" cy="10" r="8" fill="black" />
          </mask>
          <circle
            class="outer circle"
            cx="10"
            cy="10"
            r="10"
            mask="url(#${this.maskId})" />
          <circle class="inner circle" cx="10" cy="10" r="5" />
        </svg>

        <div class="touch-target"></div>
      </div>
    `}updated(){this[ym].ariaChecked=String(this.checked)}async handleClick(e){this.disabled||(await 0,e.defaultPrevented||(Em(e)&&this.focus(),this.checked=!0,this.dispatchEvent(new Event("change",{bubbles:!0})),this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0}))))}async handleKeydown(e){await 0," "!==e.key||e.defaultPrevented||this.click()}[(pP=uP,Ny)](){return this.checked?this.value:null}[Oy](){return String(this.checked)}formResetCallback(){this.checked=this.hasAttribute("checked")}formStateRestoreCallback(e){this.checked="true"===e}[ky](){return new cP((()=>this.selectionController?this.selectionController.controls:[this]))}[Ay](){return this.container}}zg([Fc({type:Boolean})],fP.prototype,"checked",null),zg([Fc({type:Boolean})],fP.prototype,"required",void 0),zg([Fc()],fP.prototype,"value",void 0),zg([Hc(".container")],fP.prototype,"container",void 0);const vP=Sd`@layer{:host{display:inline-flex;height:var(--md-radio-icon-size, 20px);outline:none;position:relative;vertical-align:top;width:var(--md-radio-icon-size, 20px);-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;--md-ripple-hover-color: var(--md-radio-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-radio-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-radio-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-pressed-opacity: var(--md-radio-pressed-state-layer-opacity, 0.12)}:host([disabled]){cursor:default}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--md-radio-icon-size, 20px))/2)}.container{display:flex;height:100%;place-content:center;place-items:center;width:100%}md-focus-ring{height:44px;inset:unset;width:44px}.checked{--md-ripple-hover-color: var(--md-radio-selected-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-hover-opacity: var(--md-radio-selected-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-radio-selected-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-opacity: var(--md-radio-selected-pressed-state-layer-opacity, 0.12)}.touch-target{height:48px;position:absolute;width:48px}:host([touch-target=none]) .touch-target{display:none}md-ripple{border-radius:50%;height:var(--md-radio-state-layer-size, 40px);inset:unset;width:var(--md-radio-state-layer-size, 40px)}.icon{fill:var(--md-radio-icon-color, var(--md-sys-color-on-surface-variant, #49454f));inset:0;position:absolute}.outer.circle{transition:fill 50ms linear}.inner.circle{opacity:0;transform-origin:center;transition:opacity 50ms linear}.checked .icon{fill:var(--md-radio-selected-icon-color, var(--md-sys-color-primary, #6750a4))}.checked .inner.circle{animation:inner-circle-grow 300ms cubic-bezier(0.05, 0.7, 0.1, 1);opacity:1}@keyframes inner-circle-grow{from{transform:scale(0)}to{transform:scale(1)}}:host([disabled]) .circle{animation-duration:0s;transition-duration:0s}:host(:hover) .icon{fill:var(--md-radio-hover-icon-color, var(--md-sys-color-on-surface, #1d1b20))}:host(:focus-within) .icon{fill:var(--md-radio-focus-icon-color, var(--md-sys-color-on-surface, #1d1b20))}:host(:active) .icon{fill:var(--md-radio-pressed-icon-color, var(--md-sys-color-on-surface, #1d1b20))}:host([disabled]) .icon{fill:var(--md-radio-disabled-unselected-icon-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-radio-disabled-unselected-icon-opacity, 0.38)}:host(:hover) .checked .icon{fill:var(--md-radio-selected-hover-icon-color, var(--md-sys-color-primary, #6750a4))}:host(:focus-within) .checked .icon{fill:var(--md-radio-selected-focus-icon-color, var(--md-sys-color-primary, #6750a4))}:host(:active) .checked .icon{fill:var(--md-radio-selected-pressed-icon-color, var(--md-sys-color-primary, #6750a4))}:host([disabled]) .checked .icon{fill:var(--md-radio-disabled-selected-icon-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-radio-disabled-selected-icon-opacity, 0.38)}}@layer hcm{@media(forced-colors: active){.icon{fill:CanvasText}:host([disabled]) .icon{fill:GrayText;opacity:1}}}
`;let bP=class extends fP{};bP.styles=[vP],bP=zg([Dc("md-radio")],bP);var yP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const wP={HELP_REVIEW:{id:"help_review",label:"Help me with review",prompt:'\nYou are a highly experienced code reviewer specializing in Git patches. Your\ntask is to analyze the provided Git patch (`patch`) and provide comprehensive\nfeedback.  Focus on identifying potential bugs, inconsistencies, security\nvulnerabilities, and areas for improvement in code style and readability.\nYour response should be detailed and constructive, offering specific suggestions\nfor remediation where applicable. Prioritize clarity and conciseness in your\nfeedback.\n\n# Step by Step Instructions\n\n1.  Read the provided `patch` carefully.  Understand the changes it introduces to the codebase.\n\n2.  Analyze the `patch` for potential issues:\n    * **Functionality:** Does the code work as intended? Are there any bugs or unexpected behavior?\n    * **Security:** Are there any security vulnerabilities introduced by the patch?\n    * **Style:** Does the code adhere to the project\'s coding style guidelines? Is it readable and maintainable?\n    * **Consistency:** Are there any inconsistencies with existing code or design patterns?\n    * **Testing:** Does the patch include sufficient tests to cover the changes?\n\n3.  Formulate concise and constructive feedback for each identified issue.  Provide specific suggestions for remediation where possible.\n\n4.  Summarize your findings in a clear and organized manner.  Prioritize critical issues over minor ones.\n\n5.  Review the feedback written so far. Is the feedback comprehensive and sufficiently detailed?\nIf not, go back to step 2, focusing on any areas that require further analysis or clarification.\n If yes, proceed to step 6.\n\n6.  Output the complete review.\n\n\nPatch: \n"""\n{{patch}}\n"""\nIMPORTANT NOTE: Start directly with the output, do not output any delimiters.\nTake a Deep Breath, read the instructions again, read the inputs again. Each instruction is crucial and must be executed with utmost care and attention to detail.\n\nReview:\n'},IMPROVE_COMMIT_MESSAGE:{id:"improve_commit_message",label:"Improve commit message",prompt:'\nYou are a Git commit message expert, tasked with improving the quality and clarity of commit messages.\nYour goal is to generate a well-structured and informative commit message based on a provided Git patch. \nThe commit message must adhere to a specific style guide, focusing on conciseness, clarity, and a professional tone.\nYou will use the patch\'s diff to understand the changes, summarizing complex diffs and focusing on the intent and impact of the changes.\nYou should paraphrase any provided bug summaries to explain the problem that was fixed.\nYour output must be a single Markdown code block containing only the complete commit message (title and body), \nformatted according to the provided specifications.\n\n# Step by Step Instructions\n\n1. **Analyze the Patch:** Carefully examine the provided `patch` to understand the changes made to the codebase. \nIdentify the key modifications, focusing on their intent and impact. Summarize complex changes concisely.\n\n2. **Review Existing Commit Message:** Read the commit message included in the `patch`. Note its strengths and weaknesses.  \nIdentify areas for improvement in clarity, conciseness, and adherence to the style guide.\n\n3. **Refine the Title:** Craft a concise and informative commit title (under 60 characters) using sentence case and the imperative mood. \nThe title should accurately reflect the primary change implemented in the patch.\n\n4. **Develop the Body:** Write a detailed body for the commit message, explaining the "what" and "why" of the changes.\n Use the information gathered in Step 1 to describe the intent and impact of the modifications.  \n Structure the body using paragraphs, blank lines, and bullet points as needed for clarity. Wrap lines to approximately 72 characters.\n\n5. **Ensure Style Compliance:** Verify that the commit message (title and body) adheres to all requirements outlined in the provided\n"Commit Message Requirements" section.  This includes checking for sentence case, imperative mood, line wrapping, and the exclusion of testing information.\n\n6. **Format the Output:**  Enclose the complete commit message (title and body) within a single Markdown code block.\n Ensure there is one blank line separating the title and the body.\n\n7. **Review and Iterate (Loop Instruction):** Review the complete commit message. Is it clear, concise, and informative? \nDoes it accurately reflect the changes made in the patch and adhere to the style guide? If not, return to Step 3 or Step 4 to make improvements.  If satisfied, proceed to Step 8.\n\n8. **Output the Commit Message:** Output the final, formatted commit message as a single Markdown code block.\n\n\nPatch: \n"""\n{{patch}}\n"""\nIMPORTANT NOTE: Start directly with the output, do not output any delimiters.\nTake a Deep Breath, read the instructions again, read the inputs again. Each instruction is crucial and must be executed with utmost care and attention to detail.\n\nCommit Message:\n'},PATCH_ONLY:{id:"patch_only",label:"Just patch content",prompt:"{{patch}}"}},_P=[{label:"3 lines (default)",value:3},{label:"10 lines",value:10},{label:"25 lines",value:25},{label:"50 lines",value:50},{label:"100 lines",value:100}];let xP=class extends Ic{constructor(){super(),this.loading=!1,this.selectedTemplate="HELP_REVIEW",this.context=3,this.promptContent="",this.getChangeModel=yu(this,MT),this.restApiService=Xn().restApiService,zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getChangeModel().patchNum$),(e=>this.patchNum=e))}static get styles(){return[Qb,Nc,Iw,Jy,Sd`
        :host {
          display: block;
          padding: var(--spacing-m) 0;
        }
        section {
          display: flex;
          padding: var(--spacing-m) var(--spacing-xl);
        }
        .flexContainer {
          display: flex;
          justify-content: space-between;
          padding-top: var(--spacing-m);
        }
        .footer {
          justify-content: flex-end;
        }
        .info-text {
          font-size: var(--font-size-small);
          color: var(--deactivated-text-color);
          max-width: 420px;
        }
        .closeButtonContainer {
          align-items: flex-end;
          display: flex;
          flex: 0;
          justify-content: flex-end;
        }
        .content {
          width: 100%;
        }
        .options-bar {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: var(--spacing-m);
        }
        .template-selector {
        }
        .template-options {
          display: flex;
          flex-direction: column;
          gap: var(--spacing-s);
        }
        .template-option {
          display: flex;
          align-items: center;
          gap: var(--spacing-m);
          margin-bottom: 0.5em;
        }
        textarea {
          width: 550px;
          height: 300px;
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          padding: var(--spacing-s);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          resize: vertical;
        }
        .toolbar {
          display: flex;
          gap: var(--spacing-s);
          margin-top: var(--spacing-s);
          justify-content: space-between;
          align-items: center;
        }
        .context-selector {
          display: flex;
          align-items: center;
          gap: var(--spacing-s);
        }
      `]}render(){return dc`
      <section>
        <h3 class="heading-3">Copy AI Prompt (experimental)</h3>
      </section>
      ${eb(this.loading,(()=>dc` <div class="loading">Loading patch ...</div>`),(()=>dc` <section class="flexContainer">
          <div class="content">
            ${eb(1===this.getNumParents(),(()=>dc`<div class="options-bar">
                  <div class="template-selector">
                    <div class="template-options">
                      ${Object.entries(wP).map((([e,t])=>dc`
                          <label class="template-option">
                            <md-radio
                              name="template"
                              .value=${e}
                              ?checked=${this.selectedTemplate===e}
                              @change=${e=>{const t=e.target;this.selectedTemplate=t.value}}
                            >
                            </md-radio>
                            ${t.label}
                          </label>
                        `))}
                    </div>
                  </div>
                  <div class="context-selector">
                    <md-outlined-select
                      label="Context"
                      value=${this.context.toString()}
                      @change=${e=>{const t=e.target;this.context=Number(t.value)}}
                    >
                      ${_P.map((e=>dc`<md-select-option
                            .value=${e.value.toString()}
                          >
                            <div slot="headline">${e.label}</div>
                          </md-select-option>`))}
                    </md-outlined-select>
                  </div>
                </div>
                <textarea
                  .value=${this.promptContent}
                  readonly
                  placeholder="Patch content will appear here..."
                ></textarea>
                <div class="toolbar">
                  <div class="info-text">
                    You can paste this prompt in an AI Model if your project
                    code can be shared with AI. We recommend a thinking model.
                    You can also use it for an AI Agent as context (a reference
                    to a git change).
                  </div>
                  <gr-button @click=${this.handleCopyPatch}>
                    <gr-icon icon="content_copy" small></gr-icon>
                    Copy Prompt
                  </gr-button>
                </div>`),(()=>dc`
                <div class="info-text">
                  This change has multiple parents. Currently, the "Create AI
                  Review Prompt" feature does not support multiple parents.
                </div>
              `))}
          </div>
        </section>`))}
      <section class="footer">
        <span class="closeButtonContainer">
          <gr-button
            id="closeButton"
            link
            @click=${e=>{this.handleCloseTap(e)}}
            >Close</gr-button
          >
        </span>
      </section>
    `}firstUpdated(e){super.firstUpdated(e),this.getAttribute("role")||this.setAttribute("role","dialog")}willUpdate(e){(e.has("patchContent")||e.has("selectedTemplate"))&&this.updatePromptContent(),e.has("context")&&this.loadPatchContent()}open(){1===this.getNumParents()&&this.loadPatchContent()}getNumParents(){return this.change?.revisions[this.change.current_revision].commit?.parents.length}async loadPatchContent(){if(!this.change||!this.patchNum)return;this.loading=!0;const e=await this.restApiService.getPatchContent(this.change._number,this.patchNum,this.context);this.loading=!1,e?this.patchContent=e:ta(this,"Failed to get patch content")}updatePromptContent(){if(!this.patchContent)return void(this.promptContent="");const e=wP[this.selectedTemplate];this.promptContent=e.prompt.replace("{{patch}}",this.patchContent)}async handleCopyPatch(e){e.preventDefault(),e.stopPropagation(),this.promptContent&&await Sa(this.promptContent,"AI Prompt")}handleCloseTap(e){e.preventDefault(),e.stopPropagation(),Jn(this,"close",{})}};yP([Hc("#closeButton")],xP.prototype,"closeButton",void 0),yP([Uc()],xP.prototype,"change",void 0),yP([Uc()],xP.prototype,"patchNum",void 0),yP([Uc()],xP.prototype,"patchContent",void 0),yP([Uc()],xP.prototype,"loading",void 0),yP([Uc()],xP.prototype,"selectedTemplate",void 0),yP([Uc()],xP.prototype,"context",void 0),yP([Uc()],xP.prototype,"promptContent",void 0),xP=yP([Dc("gr-ai-prompt-dialog")],xP);class CP{constructor(e,t,i,r){this._comments=lC(e),this._drafts=lC(t),this._portedComments=i||{},this._portedDrafts=r||{}}get drafts(){return this._drafts}getPaths(e){const t=[this._comments,this.drafts],i={};for(const r of t)for(const[t,o]of Object.entries(r))o.some((t=>!e||aC(t,e)))&&(i[t]=!0);return i}getAllPublishedComments(e){return this.getAllComments(!1,e)}getAllComments(e,t){const i=this.getPaths(),r={};for(const o of Object.keys(i))r[o]=this.getAllCommentsForPath(o,t,e);return r}getAllDrafts(e){const t=this.getPaths(),i={};for(const r of Object.keys(t))i[r]=this.getAllDraftsForPath(r,e);return i}getAllCommentsForPath(e,t,i){let r=this._comments[e]||[];if(i){const t=this.getAllDraftsForPath(e);r=r.concat(t)}return t&&(r=r.filter((e=>e.patch_set===t))),r.map((e=>({...e})))}getAllCommentsForFile(e,t){let i=this.getAllCommentsForPath(e.path,e.patchNum,t);return e.basePath&&(i=i.concat(this.getAllCommentsForPath(e.basePath,e.patchNum,t))),i}getAllDraftsForPath(e,t){let i=this._drafts[e]||[];return t&&(i=i.filter((e=>e.patch_set===t))),i}getAllDraftsForFile(e){let t=this.getAllDraftsForPath(e.path,e.patchNum);return e.basePath&&(t=t.concat(this.getAllDraftsForPath(e.basePath,e.patchNum))),t}getCommentsForPath(e,t){let i=[],r=[];this._comments&&this._comments[e]&&(i=this._comments[e]),this.drafts&&this.drafts[e]&&(r=this.drafts[e]);const o=i.concat(r).filter((e=>aC(e,t))).map((e=>({...e})));return o}_getPortedCommentThreads(e,t){const i=this._portedComments[e.path]||[];return i.push(...this._portedDrafts[e.path]||[]),e.basePath&&(i.push(...this._portedComments[e.basePath]||[]),i.push(...this._portedDrafts[e.basePath]||[])),i.length?Yx(this.getAllCommentsForFile(e,!0)).filter((e=>{const r=i.find((t=>e.comments.some((e=>Vx(t)===Vx(e)))));if(!r)return!1;const o=e.comments.find((e=>Vx(e)===Vx(r)));return!(aC(o,t)||e.commentSide===Yu.PARENT&&(t.basePatchNum!==Qu||e.mergeParentNum)||!Zx(e)&&!tC(e)||((o.line&&!r.line||o.range&&!r.range)&&(e.rangeInfoLost=!0),e.patchNum=t.patchNum,e.range=r.range,e.line=r.line,e.ported=!0,0))})):[]}getThreadsBySideForFile(e,t){const i=Yx(this.getCommentsForFile(e,t));return i.push(...this._getPortedCommentThreads(e,t)),i}getCommentsForFile(e,t){const i=this.getCommentsForPath(e.path,t);return e.basePath&&i.push(...this.getCommentsForPath(e.basePath,t)),i}_commentObjToArray(e){return Object.keys(e).reduce(((t,i)=>(e[i].forEach((e=>t.push({...e}))),t)),[])}computeCommentThreads(e,t=!1){let i=[];i=hf(e)?this.getAllCommentsForFile(e):this._commentObjToArray(this.getAllPublishedComments(e.patchNum));let r=Yx(i);return t&&(r=r.filter((e=>!Qx(e)))),r}computeDraftCount(e){if(e&&hf(e))return this.getAllDraftsForFile(e).length;const t=this.getAllDrafts(e&&e.patchNum);return this._commentObjToArray(t).length}computePortedDraftCount(e,t){return this.getThreadsBySideForFile({path:t},e).filter((e=>tC(e)&&e.ported)).length}computeDraftCountForFile(e,t){if(void 0===e||void 0===t)return 0;const i=t=>t?this.computeDraftCount({patchNum:e.basePatchNum,path:t})+this.computeDraftCount({patchNum:e.patchNum,path:t})+this.computePortedDraftCount({patchNum:e.patchNum,basePatchNum:e.basePatchNum},t):0;return i(t.__path)+i(t.old_path)}computeCommentsThreads(e,t,i){const r=this.getThreadsBySideForFile({path:t},e);return i?.old_path&&r.push(...this.getThreadsBySideForFile({path:i.old_path},e)),r}computeCommentsString(e,t,i,r){if(!t)return"";if(!e)return"";const o=this.computeCommentsThreads(e,t,i),s=o.filter((e=>!tC(e))).length,n=o.reduce(((e,t)=>(Zx(t)&&(e+=1),e)),0),a=Ig(s,"comment"),l=0===n?"":`${n} unresolved`,d=r&&"U"===i?.status?"no changes":"";return a+(a&&l?" ":"")+(l?`(${l})`:"")+(d?`(${d})`:"")}computeUnresolvedNum(e,t){let i=[],r=[];hf(e)?(i=this.getAllCommentsForFile(e),r=this.getAllDraftsForFile(e)):i=this._commentObjToArray(this.getAllPublishedComments(e.patchNum)),i=i.concat(r);let o=Yx(i).filter(Zx);return t&&(o=o.filter((e=>!Qx(e)))),o.length}getAllThreadsForChange(){return Yx(this._commentObjToArray(this.getAllComments(!0)))}}const EP={comments:void 0,drafts:void 0,portedComments:void 0,portedDrafts:void 0,discardedDrafts:[]};function SP(e,t){const i={...e};va(!!t.path,"draft without path"),va(yf(t),"draft is not a draft"),i.drafts={...i.drafts};const r=i.drafts;r[t.path]?r[t.path]=[...r[t.path]]:r[t.path]=[];const o=r[t.path].findIndex((e=>Vx(e)===Vx(t)));return-1!==o?r[t.path][o]=t:r[t.path].push(t),i}function $P(e,t){let i=0;const r={};for(const[o,s]of Object.entries(e))for(const e of s)e.id&&t.has(e.id)?++i:(o in r||(r[o]=[]),r[o].push(e));return{drafts:r,removedCnt:i}}const kP=mu("comments-model");class AP extends df{thread$(e){return lf(this.threads$,(t=>t.find((t=>t.rootId===e))))}constructor(e,t,i,r,o,s){super(EP),this.changeViewModel=e,this.changeModel=t,this.accountsModel=i,this.restApiService=r,this.reporting=o,this.navigation=s,this.commentsLoading$=lf(this.state$,(e=>void 0===e.comments||void 0===e.drafts)),this.comments$=lf(this.state$,(e=>e.comments)),this.drafts$=lf(this.state$,(e=>e.drafts)),this.draftsLoading$=lf(this.drafts$,(e=>void 0===e)),this.draftsArray$=lf(this.drafts$,(e=>Object.values(e??{}).flat())),this.draftsSaved$=lf(this.draftsArray$,(e=>e.filter((e=>!xf(e))))),this.draftsCount$=lf(this.draftsSaved$,(e=>e.length)),this.portedComments$=lf(this.state$,(e=>e.portedComments)),this.discardedDrafts$=lf(this.state$,(e=>e.discardedDrafts)),this.savingInProgress$=lf(this.draftsArray$,(e=>e.some(wf))),this.savingError$=lf(this.draftsArray$,(e=>e.some(_f))),this.patchsetLevelDrafts$=lf(this.draftsArray$,(e=>e.filter((e=>e.path===hg.PATCHSET_LEVEL_COMMENTS&&!e.in_reply_to)))),this.mentionedUsersInDrafts$=this.draftsArray$.pipe(Vp((e=>{const t=[];for(const i of e)t.push(..._x(i.message));const i=t.filter(((e,i)=>i===t.findIndex((t=>px(t)===px(e)))));return 0===i.length?Zh(i):Qm(i.map((e=>Qh(this.accountsModel.fillDetails(e)))))})),ep((e=>e.filter(cf))),xp(sf),zp(1)),this.mentionedUsersInUnresolvedDrafts$=this.draftsArray$.pipe(Vp((e=>{const t=[],i=e.filter((e=>e.unresolved));for(const e of i)t.push(..._x(e.message));const r=t.filter(((e,i)=>i===t.findIndex((t=>px(t)===px(e)))));return 0===r.length?Zh(r):Qm(r.map((e=>Qh(this.accountsModel.fillDetails(e)))))})),ep((e=>e.filter(cf))),xp(sf),zp(1)),this.changeComments$=lf(this.state$,(e=>new CP(e.comments,e.drafts,e.portedComments,e.portedDrafts))),this.threads$=lf(this.changeComments$,(e=>e.getAllThreadsForChange())),this.threadsSaved$=lf(this.threads$,(e=>e.filter((e=>!iC(e))))),this.draftThreadsSaved$=lf(this.threads$,(e=>e.filter((e=>!iC(e)&&tC(e))))),this.numPendingDraftRequests=0,this.drafts={},this.discardedDrafts=[],this.threadsWithUnappliedSuggestions$=lf(Yh([this.threads$,this.changeModel.latestPatchNum$]),(([e,t])=>e.filter((e=>Zx(e)&&function(e){const t=Jx(e);return!!t&&(uC(t)||void 0!==t.fix_suggestions?.[0])}(e)&&Jx(e)?.patch_set===t)))),this.commentedPaths$=lf(Yh([this.changeComments$,this.changeModel.basePatchNum$,this.changeModel.patchNum$]),(([e,t,i])=>{if(!i)return[];const r=e.getPaths({basePatchNum:t,patchNum:i});return Object.keys(r)})),this.reloadAllComments$=new Up(void 0),this.subscriptions.push(this.savingInProgress$.subscribe((e=>{e?this.navigation.blockNavigation("draft comment still saving"):this.navigation.releaseNavigation("draft comment still saving")}))),this.subscriptions.push(this.savingError$.subscribe((e=>{e?this.navigation.blockNavigation("draft comment failed to save"):this.navigation.releaseNavigation("draft comment failed to save")}))),this.subscriptions.push(this.discardedDrafts$.subscribe((e=>this.discardedDrafts=e))),this.subscriptions.push(this.drafts$.subscribe((e=>this.drafts=e??{}))),this.subscriptions.push(Yh([this.draftsLoading$,this.patchsetLevelDrafts$,this.changeModel.latestPatchNum$]).subscribe((([e,t,i])=>{var r;e||t.length>0||!i||this.addNewDraft((r=i,{...Kx("",!1),patch_set:r,path:hg.PATCHSET_LEVEL_COMMENTS}))}))),this.subscriptions.push(Yh([this.changeViewModel.changeNum$,this.reloadAllComments$]).pipe(Vp((([e,t])=>(this.changeNum=e,this.setState({...EP}),e?Qm([this.restApiService.getDiffComments(e),this.restApiService.getDiffDrafts(e)]):Zh([void 0,void 0,void 0]))))).subscribe((([e,t])=>{this.modifyState((i=>(i=function(e,t){const i={...e};return sf(t,i.comments)?e:(i.comments=lC(t)||{},i)}(i,e),function(e,t){if(sf(t,e.drafts))return e;const i={...e};return i.drafts=lC(t),i}(i,t))))}))),this.subscriptions.push(Yh([this.changeModel.changeNum$,this.changeModel.patchNum$]).pipe(Vp((([e,t])=>{if(this.changeNum=e,!e)return Zh([void 0,void 0]);const i=t??$x;return Qm([this.restApiService.getPortedComments(e,i),this.restApiService.getPortedDrafts(e,i)])}))).subscribe((([e,t])=>this.modifyState((i=>(i=function(e,t){if(sf(t,e.portedComments))return e;const i={...e};return i.portedComments=t||{},i}(i,e),function(e,t){if(sf(t,e.portedDrafts))return e;const i={...e};return i.portedDrafts=t||{},i}(i,t))))))),this.subscriptions.push(Yh([this.comments$,this.changeModel.latestPatchNum$]).subscribe((([e,t])=>{this.reportCommentStats(e,t)}))),this.subscriptions.push(Yh([this.threadsSaved$,this.changeModel.latestPatchNum$]).subscribe((([e,t])=>{this.reportThreadsStats(e,t)})))}reloadAllComments(){this.reloadAllComments$.next(void 0)}modifyState(e){this.setState(e({...this.getState()}))}setState(e){const t=new Set;if(e.comments&&Object.values(e.comments).flatMap((e=>e)).forEach((e=>t.add(e.id))),e.drafts){const i=$P(e.drafts,t);e.drafts=i.drafts,0!==i.removedCnt&&this.reporting.reportExecution(pa.PUBLISHED_DRAFTS_DEDUPLICATED,{message:`Detected ${i.removedCnt} drafts that are also published comments`,count:i.removedCnt})}e.portedDrafts&&(e.portedDrafts=$P(e.portedDrafts,t).drafts),super.setState(e)}reportCommentStats(e,t){if(!e||!t)return;const i=Object.values(e).flat();if(0===i.length)return;const r=i.filter((e=>e.patch_set===t)),o=i.filter((e=>e.unresolved)),s=r.filter((e=>e.unresolved)),n=e=>(e.fix_suggestions?.length??0)>0,a={countLatest:r.length,countLatestWithFix:r.filter(n).length,countLatestWithUserFix:r.filter(uC).length,countLatestUnresolved:s.length,countLatestUnresolvedWithFix:s.filter(n).length,countLatestUnresolvedWithUserFix:s.filter(uC).length,countAll:i.length,countAllUnresolved:o.length,countAllWithFix:i.filter(n).length,countAllUnresolvedWithFix:o.filter(n).length,countAllWithUserFix:i.filter(uC).length,countAllUnresolvedWithUserFix:i.filter((e=>e.unresolved&&uC(e))).length};this.reporting.reportInteraction(ga.COMMENTS_STATS,a,{deduping:ca.EVENT_ONCE_PER_CHANGE})}reportThreadsStats(e,t){if(!e||!t)return;if(0===e.length)return;const i=e.filter((e=>Jx(e)?.patch_set===t)),r=e.filter(Zx),o=i.filter(Zx),s=e=>(Jx(e)?.fix_suggestions?.length??0)>0,n=e=>{const t=Jx(e);return t&&uC(t)},a={countLatest:i.length,countLatestWithFix:i.filter(s).length,countLatestWithUserFix:i.filter(n).length,countLatestUnresolved:o.length,countLatestUnresolvedWithFix:o.filter(s).length,countLatestUnresolvedWithUserFix:o.filter(n).length,countAll:e.length,countAllUnresolved:r.length,countAllWithFix:e.filter(s).length,countAllUnresolvedWithFix:r.filter(s).length,countAllWithUserFix:e.filter(n).length,countAllUnresolvedWithUserFix:r.filter(n).length};this.reporting.reportInteraction(ga.THREADS_STATS,a,{deduping:ca.EVENT_ONCE_PER_CHANGE})}async restoreDraft(e){const t=this.discardedDrafts?.find((t=>Vx(t)===e));if(!t)throw new Error("discarded draft not found");const i={...t,...Kx()};await this.saveDraft(i),this.modifyState((t=>function(e,t){const i={...e},r=[...i.discardedDrafts],o=r.findIndex((e=>Vx(e)===t));if(-1===o)throw new Error("discarded draft not found");return r.splice(o,1),i.discardedDrafts=r,i}(t,e)))}addNewDraft(e){va(xf(e),"draft must be new"),this.modifyState((t=>SP(t,e)))}async saveDraft(e,t=!0){ba(this.changeNum,"change number"),ba(e.patch_set,"patchset number of comment draft"),va(!!e.message?.trim(),"cannot save empty draft"),va(!wf(e),"saving already in progress");const i={...e,savingState:bf.SAVING};this.modifyState((e=>SP(e,i)));const r=this.changeNum;this.report(ga.SAVE_COMMENT,e),t&&this.showStartRequest();const o=xf(e)?ua.DRAFT_CREATE:ua.DRAFT_UPDATE,s=this.reporting.getTimer(o);let n;try{const t=await this.restApiService.saveDiffDraft(r,e.patch_set,yC(e));if(r!==this.changeNum)return e;if(!t.ok)throw new Error("request failed");n=(await Df(t)).parsed}catch(i){t&&this.handleFailedDraftRequest();const r={...e,savingState:bf.ERROR};return this.modifyState((e=>SP(e,r))),r}const a={...e,id:n.id,updated:n.updated,savingState:bf.OK};return s.end({id:a.id}),t&&this.showEndRequest(),this.modifyState((e=>SP(e,a))),this.report(ga.COMMENT_SAVED,a),a}async discardDraft(e){const t=this.lookupDraft(e);if(ba(t,`draft not found by id ${e}`),ba(t.patch_set,"patchset number of comment draft"),va(!wf(t),"saving already in progress"),this.modifyState((e=>function(e,t){const i={...e};va(!!t.path,"draft without path"),va(yf(t),"draft is not a draft"),i.drafts={...i.drafts};const r=i.drafts,o=(r[t.path]||[]).findIndex((e=>Vx(e)===Vx(t)));if(-1===o)return e;const s=r[t.path][o];return r[t.path]=[...r[t.path]],r[t.path].splice(o,1),function(e,t){const i={...e};return i.discardedDrafts=[...i.discardedDrafts,t],i}(i,s)}(e,t))),t.id){if(!t.message?.trim())throw new Error("empty draft");ba(this.changeNum,"change number");const i=this.changeNum;this.report(ga.DISCARD_COMMENT,t),this.showStartRequest();const r=this.reporting.getTimer(ua.DRAFT_DISCARD),o=await this.restApiService.deleteDiffDraft(i,t.patch_set,{id:t.id});if(r.end({id:t.id}),i!==this.changeNum)throw new Error("change changed");if(!o.ok)throw this.handleFailedDraftRequest(),await this.restoreDraft(e),new Error(`Failed to discard draft comment: ${JSON.stringify(o)}`);this.showEndRequest()}t.message?.trim()&&Jn(document,"show-alert",{message:"Draft Discarded",action:"Undo",callback:()=>this.restoreDraft(e)}),this.report(ga.COMMENT_DISCARDED,t)}async deleteComment(e,t,i){ba(t.patch_set,"comment.patch_set"),va(!yf(t),"Admin deletion is only for published comments.");const r=await this.restApiService.deleteComment(e,t.patch_set,t.id,i);r&&this.modifyState((e=>function(e,t){if(!t.path||!e.comments)return e;const i=[...e.comments[t.path]];for(let r=0;r<i.length;++r)if(i[r].id===t.id)return i[r]={...i[r],...t},{...e,comments:{...e.comments,[t.path]:i}};throw new Error("Comment to be updated does not exist")}(e,r)))}report(e,t){const i=function(e){return{id:e?.id,message_length:e?.message?.trim().length,in_reply_to:e?.in_reply_to,unresolved:e?.unresolved,path_length:e?.path?.length,line:e?.range?.start_line??e?.line,unsaved:xf(e)}}(t);this.reporting.reportInteraction(e,i)}showStartRequest(){this.numPendingDraftRequests+=1,this.updateRequestToast()}showEndRequest(){this.numPendingDraftRequests-=1,this.updateRequestToast()}handleFailedDraftRequest(){this.numPendingDraftRequests-=1,this.updateRequestToast(!0)}updateRequestToast(e){if(0===this.numPendingDraftRequests&&!e)return void Jn(document,"hide-alert",{});const t=function(e,t){return t?"Unable to save draft":0===e?"All changes saved":void 0}(this.numPendingDraftRequests,e);t&&(this.draftToastTask=ny(this.draftToastTask,(()=>ea(document.body,t)),200))}lookupDraft(e){return Object.values(this.drafts).flat().find((t=>Vx(t)===e))}}const RP=mu("flows-model");class TP extends df{constructor(e){super({flows:[],loading:!0}),this.changeModel=e,this.flows$=this.state$.pipe(ep((e=>e.flows))),this.loading$=this.state$.pipe(ep((e=>e.loading))),this.reload$=new Up(void 0),this.restApiService=Xn().restApiService,this.flagService=Xn().flagsService,this.subscriptions.push(this.changeModel.changeNum$.subscribe((e=>{this.changeNum=e}))),this.subscriptions.push(Yh([this.changeModel.changeNum$,this.reload$]).pipe(Vp((([e])=>e&&this.flagService.isEnabled(da.SHOW_FLOWS_TAB)?(this.setState({...this.getState(),loading:!0}),Qh(this.restApiService.listFlows(e)).pipe(Gh((e=>(this.setState({...this.getState(),errorMessage:`Failed to load flows: ${e}`,loading:!1}),Zh([])))))):Zh([])))).subscribe((e=>{this.setState({...this.getState(),flows:e??[],loading:!1})})))}reload(){this.reload$.next()}async deleteFlow(e){this.changeNum&&(await this.restApiService.deleteFlow(this.changeNum,e),this.reload())}async createFlow(e){this.changeNum&&(await this.restApiService.createFlow(this.changeNum,e),this.reload())}}var IP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};function PP(e,t){Gn(e)||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),t())}const NP=new Map;NP.set(dI.ERROR,7),NP.set(dI.WARNING,2),NP.set(dI.INFO,2),NP.set(dI.SUCCESS,2),NP.set(lI.RUNNING,2);let OP=class extends Ic{constructor(){super(),this.commentsLoading=!0,this.mentionCount=0,this.runs=[],this.showChecksSummary=!1,this.someProvidersAreLoading=!1,this.errorMessages={},this.actions=[],this.messages=[],this.draftCount=0,this.flows=[],this.showAllChips=new Map,this.getCommentsModel=yu(this,kP),this.getUserModel=yu(this,jf),this.getChecksModel=yu(this,sP),this.getChangeModel=yu(this,MT),this.getFlowsModel=yu(this,RP),this.reporting=Xn().reportingService,zf(this,(()=>this.getChecksModel().allRunsLatestPatchsetLatestAttempt$),(e=>this.runs=e)),zf(this,(()=>this.getChecksModel().aPluginHasRegistered$),(e=>this.showChecksSummary=e)),zf(this,(()=>this.getChecksModel().someProvidersAreLoadingFirstTime$),(e=>this.someProvidersAreLoading=e)),zf(this,(()=>this.getChecksModel().errorMessagesLatest$),(e=>this.errorMessages=e)),zf(this,(()=>this.getChecksModel().loginCallbackLatest$),(e=>this.loginCallback=e)),zf(this,(()=>this.getChecksModel().topLevelActionsLatest$),(e=>this.actions=e)),zf(this,(()=>this.getChecksModel().topLevelMessagesLatest$),(e=>this.messages=e)),zf(this,(()=>this.getCommentsModel().draftsCount$),(e=>this.draftCount=e)),zf(this,(()=>this.getCommentsModel().threadsSaved$),(e=>this.commentThreads=e)),zf(this,(()=>this.getUserModel().account$),(e=>this.selfAccount=e)),zf(this,(()=>this.getCommentsModel().commentsLoading$),(e=>this.commentsLoading=e)),zf(this,(()=>Yh([this.getUserModel().account$,this.getCommentsModel().threadsSaved$])),(([e,t])=>{if(!e||!e.email)return;const i=vC(t,e).filter(Zx);this.mentionCount=i.length})),zf(this,(()=>this.getFlowsModel().flows$),(e=>this.flows=e))}static get styles(){return[Nc,Iw,Yc,Sd`
        :host {
          display: block;
          color: var(--deemphasized-text-color);
          max-width: 625px;
          margin-bottom: var(--spacing-m);
        }
        .zeroState {
          color: var(--deemphasized-text-color);
        }
        .loading.zeroState {
          margin-right: var(--spacing-m);
        }
        div.info,
        div.error,
        .login {
          display: flex;
          color: var(--primary-text-color);
          padding: 0 var(--spacing-s);
          margin: var(--spacing-xs) 0;
          width: 490px;
        }
        div.info {
          background-color: var(--info-background);
        }
        div.error {
          background-color: var(--error-background);
        }
        div.info gr-icon,
        div.error gr-icon {
          font-size: 16px;
          position: relative;
          top: 4px;
          margin-right: var(--spacing-s);
        }
        div.info gr-icon {
          color: var(--info-foreground);
        }
        div.error gr-icon {
          color: var(--error-foreground);
        }
        div.info .right,
        div.error .right {
          overflow: hidden;
        }
        div.info .right .message,
        div.error .right .message {
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }
        .login {
          justify-content: space-between;
          background: var(--info-background);
        }
        .login gr-icon {
          color: var(--info-foreground);
        }
        .login gr-button {
          margin: -4px var(--spacing-s);
        }
        table.info {
          width: 100%;
        }
        td.key {
          padding-right: var(--spacing-l);
          padding-bottom: var(--spacing-s);
          line-height: calc(var(--line-height-normal) + var(--spacing-s));
          width: 70px;
        }
        td.value {
          padding-right: var(--spacing-l);
          padding-bottom: var(--spacing-s);
          line-height: calc(var(--line-height-normal) + var(--spacing-s));
        }
        .value-content {
          display: flex;
          align-items: center;
          justify-content: space-between;
        }
        /* The basics of .loadingSpin are defined in shared styles. */
        .loadingSpin {
          width: calc(var(--line-height-normal) - 2px);
          height: calc(var(--line-height-normal) - 2px);
          display: inline-block;
          vertical-align: top;
          position: relative;
          /* Making up for the 2px reduced height above. */
          top: 1px;
        }
        .actions {
          margin-left: calc(0px - var(--spacing-m));
          line-height: var(--line-height-normal);
        }
        .actions gr-checks-action,
        .actions gr-dropdown {
          vertical-align: top;
          --gr-button-padding: 0 var(--spacing-m);
        }
        .actions #moreMessage {
          display: none;
        }
        .summaryMessage {
          line-height: var(--line-height-normal);
          color: var(--primary-text-color);
        }
      `]}renderActions(){const e=(this.actions??[]).filter((e=>e.summary)).slice(0,2);if(0===e.length)return;const t=e.slice(0,2),i=e.slice(2).map((e=>({...e,id:e.name}))),r=i.filter((e=>e.disabled)).map((e=>e.id));return dc`
      <div class="actions">
        ${t.map(this.renderAction)}
        ${this.renderOverflow(i,r)}
      </div>
    `}renderAction(e){if(e)return dc`<gr-checks-action
      context="summary"
      .action=${e}
    ></gr-checks-action>`}handleAction(e){this.getChecksModel().triggerAction(e.detail,void 0,"summary-dropdown")}renderOverflow(e,t=[]){if(0!==e.length)return dc`
      <gr-dropdown
        id="moreActions"
        link=""
        vertical-offset="32"
        horizontal-align="right"
        @tap-item=${this.handleAction}
        .items=${e}
        .disabledIds=${t}
      >
        <gr-icon icon="more_vert" aria-labelledby="moreMessage"></gr-icon>
        <span id="moreMessage">More</span>
      </gr-dropdown>
    `}renderSummaryMessage(){return this.messages.map((e=>dc`
        <div class="info">
          <div class="left">
            <gr-icon icon="info" filled></gr-icon>
          </div>
          <div class="right">
            <gr-formatted-text
              class="message"
              .markdown=${!0}
              .content=${e}
            ></gr-formatted-text>
          </div>
        </div>
      `))}renderErrorMessages(){return Object.entries(this.errorMessages).map((([e,t])=>dc`
          <div class="error zeroState">
            <div class="left">
              <gr-icon icon="error" filled></gr-icon>
            </div>
            <div class="right">
              <div class="message" title=${t}>
                Error while fetching results for ${e}: ${t}
              </div>
            </div>
          </div>
        `))}renderChecksLogin(){if(this.loginCallback)return dc`
      <div class="login">
        <div class="left">
          <gr-icon icon="info"></gr-icon>
          Not logged in
        </div>
        <div class="right">
          <gr-button @click=${this.loginCallback} link>Sign In</gr-button>
        </div>
      </div>
    `}renderChecksZeroState(){if(Object.keys(this.errorMessages).length>0)return;if(this.loginCallback)return;if(this.runs.some($I))return;const e=this.someProvidersAreLoading?"Loading results":"No results";return dc`<span role="status" class="loading zeroState">${e}</span>`}renderChecksChipForCategory(e){const t=this.runs.filter((t=>!!AI(t,e)||e===dI.SUCCESS&&kI(t))),i=this.runs.some(SI),r=this.runs.some((e=>AI(e,dI.WARNING))),o=this.runs.some((e=>AI(e,dI.ERROR)));return e===dI.SUCCESS&&(i||o||r||t.length>3)||e===dI.INFO&&(i||o||t.length>3)?this.renderChecksChipsCollapsed(t,e,(t=>RI(t,e))):this.renderChecksChipsExpanded(t,e)}renderChecksChipRunning(){const e=this.runs.filter(SI).sort(TI);return this.renderChecksChipsExpanded(e,lI.RUNNING)}renderChecksChipsExpanded(e,t){if(0===e.length)return;let i=this.showAllChips.get(t)?999:NP.get(t)??2;i===e.length-1&&(i=e.length);const r=e.length-i;return dc`${e.slice(0,i).map((e=>this.renderChecksChipDetailed(e,t)))}${this.renderChecksChipPlusMore(t,r)}`}renderChecksChipsCollapsed(e,t,i){const r=e.reduce(((e,t)=>e+(i(t).length||1)),0);if(0===r)return;const o=()=>this.onChipClick({statusOrCategory:t});return dc`<gr-checks-chip
      .statusOrCategory=${t}
      .text=${`${r}`}
      @click=${o}
      @keydown=${e=>PP(e,o)}
    ></gr-checks-chip>`}renderChecksChipPlusMore(e,t){if(t<=0)return;if(!0===this.showAllChips.get(e))return;const i=()=>{this.showAllChips.set(e,!0),this.requestUpdate()};return dc`<gr-checks-chip
      .statusOrCategory=${e}
      .text="+ ${t} more"
      @click=${i}
      @keydown=${e=>PP(e,i)}
    ></gr-checks-chip>`}renderChecksChipDetailed(e,t){const i=[];e.statusLink&&i.push(e.statusLink);const r=`${e.checkName}`,o={checkName:e.checkName,statusOrCategory:t};t===lI.RUNNING&&e.status===lI.SCHEDULED&&(t=lI.SCHEDULED);const s=()=>this.onChipClick(o);return dc`<gr-checks-chip
      .statusOrCategory=${t}
      .text=${r}
      .links=${i}
      @click=${s}
      @keydown=${e=>PP(e,s)}
    ></gr-checks-chip>`}onChipClick(e){this.reporting.reportInteraction(ga.CHECKS_CHIP_CLICKED,{statusOrCategory:e.statusOrCategory,checkName:e.checkName,...BC(this.getChangeModel().getChange(),this.selfAccount)}),na(this,ng.CHECKS,!1,{checksTab:e})}handleOpenAiPromptDialog(){ba(this.aiPromptModal,"aiPromptModal"),this.aiPromptModal.showModal(),this.aiPromptDialog?.open()}handleAiPromptDialogClose(){ba(this.aiPromptModal,"aiPromptModal"),this.aiPromptModal.close()}render(){return dc`
      <div>
        <table class="info">
          <tr>
            <td class="key">Comments</td>
            <td class="value">
              <div class="value-content">
                <gr-comments-summary
                  .commentsLoading=${this.commentsLoading}
                  .commentThreads=${this.commentThreads}
                  .draftCount=${this.draftCount}
                  .mentionCount=${this.mentionCount}
                  showCommentCategoryName
                  clickableChips
                ></gr-comments-summary>
                <gr-button link @click=${this.handleOpenAiPromptDialog}
                  >Create AI Review Prompt</gr-button
                >
              </div>
            </td>
          </tr>
          ${this.renderChecksSummary()} ${this.renderFlowsSummary()}
        </table>
      </div>
      <dialog id="aiPromptModal" tabindex="-1">
        <gr-ai-prompt-dialog
          id="aiPromptDialog"
          @close=${this.handleAiPromptDialogClose}
        ></gr-ai-prompt-dialog>
      </dialog>
    `}getFlowOverallStatus(e){return e.stages.some((e=>e.state===Ku.FAILED||e.state===Ku.TERMINATED))?Ku.FAILED:e.stages.some((e=>e.state===Ku.PENDING||e.state===Ku.TERMINATED))?Ku.PENDING:e.stages.every((e=>e.state===Ku.DONE))?Ku.DONE:Ku.PENDING}renderFlowsSummary(){if(0===this.flows.length)return uc;const e=()=>na(this,ng.FLOWS,!0),t=this.flows.filter((e=>this.getFlowOverallStatus(e)===Ku.FAILED)).length,i=this.flows.filter((e=>this.getFlowOverallStatus(e)===Ku.PENDING)).length,r=this.flows.filter((e=>this.getFlowOverallStatus(e)===Ku.DONE)).length;return dc`
      <tr>
        <td class="key">Flows</td>
        <td class="value">
          <div class="flowsSummary">
            ${t>0?dc`<gr-checks-chip
                  .statusOrCategory=${dI.ERROR}
                  .text=${`${t}`}
                  @click=${e}
                  @keydown=${t=>PP(t,e)}
                ></gr-checks-chip>`:""}
            ${i>0?dc`<gr-checks-chip
                  .statusOrCategory=${lI.RUNNING}
                  .text=${`${i}`}
                  @click=${e}
                  @keydown=${t=>PP(t,e)}
                ></gr-checks-chip>`:""}
            ${r>0?dc`<gr-checks-chip
                  .statusOrCategory=${dI.SUCCESS}
                  .text=${`${r}`}
                  @click=${e}
                  @keydown=${t=>PP(t,e)}
                ></gr-checks-chip>`:""}
          </div>
        </td>
      </tr>
    `}renderChecksSummary(){const e=this.runs.some((e=>kI(e)||function(e){return(e.results??[]).length>0}(e))),t=this.runs.some(SI);return this.showChecksSummary?dc` <tr>
      <td class="key">Checks</td>
      <td class="value">
        <div class="checksSummary">
          ${this.renderChecksZeroState()}${this.renderChecksChipForCategory(dI.ERROR)}${this.renderChecksChipForCategory(dI.WARNING)}${this.renderChecksChipForCategory(dI.INFO)}${this.renderChecksChipForCategory(dI.SUCCESS)}${e&&t?dc`<br />`:""}${this.renderChecksChipRunning()}
          ${eb(this.someProvidersAreLoading,(()=>dc`<span class="loadingSpin"></span>`))}
          ${this.renderErrorMessages()} ${this.renderChecksLogin()}
          ${this.renderSummaryMessage()} ${this.renderActions()}
        </div>
      </td>
    </tr>`:uc}};function DP(e,t){Jn(e,"run-selected",{checkName:t})}function LP(e,t){return e===OI?t.isLatestAttempt:e===NI||e===(t.attempt??0)}function MP(e,t){const i=e.filter((e=>AI(e,dI.ERROR))).filter((e=>e.labelName&&t.includes(e.labelName))),r=i.reduce(((e,t)=>e+RI(t,dI.ERROR).length),0);return{errorRuns:i,errorRunsCount:r}}function FP(e,t){const i=e.filter((e=>e.isLatestAttempt)).filter((e=>e.status===lI.RUNNING||e.status===lI.SCHEDULED)).filter((e=>e.labelName&&t.includes(e.labelName)));return{runningRuns:i,runningRunsCount:i.length}}IP([Uc()],OP.prototype,"commentsLoading",void 0),IP([Uc()],OP.prototype,"commentThreads",void 0),IP([Uc()],OP.prototype,"mentionCount",void 0),IP([Uc()],OP.prototype,"selfAccount",void 0),IP([Uc()],OP.prototype,"runs",void 0),IP([Uc()],OP.prototype,"showChecksSummary",void 0),IP([Uc()],OP.prototype,"someProvidersAreLoading",void 0),IP([Uc()],OP.prototype,"errorMessages",void 0),IP([Uc()],OP.prototype,"loginCallback",void 0),IP([Uc()],OP.prototype,"actions",void 0),IP([Uc()],OP.prototype,"messages",void 0),IP([Uc()],OP.prototype,"draftCount",void 0),IP([Uc()],OP.prototype,"flows",void 0),IP([Hc("#aiPromptModal")],OP.prototype,"aiPromptModal",void 0),IP([Hc("#aiPromptDialog")],OP.prototype,"aiPromptDialog",void 0),OP=IP([Dc("gr-change-summary")],OP);var UP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let BP=class extends Ic{constructor(){super(),this.labels=[],this.showRunning=!1,this.runs=[],this.getChecksModel=yu(this,sP),zf(this,(()=>this.getChecksModel().allRunsLatestPatchsetLatestAttempt$),(e=>this.runs=e))}render(){const{errorRuns:e,errorRunsCount:t}=MP(this.runs,this.labels);if(t>0)return this.renderChecksCategoryChip(e,t,dI.ERROR);if(!this.showRunning)return uc;const{runningRuns:i,runningRunsCount:r}=FP(this.runs,this.labels);return r>0?this.renderChecksCategoryChip(i,r,lI.RUNNING):uc}renderChecksCategoryChip(e,t,i){if(0===t)return;const r=[];return 1===e.length&&e[0].statusLink&&r.push(e[0].statusLink),dc`<gr-checks-chip
      .text=${`${t}`}
      .links=${r}
      .statusOrCategory=${i}
      @click=${()=>{na(this,ng.CHECKS,!1,{checksTab:{statusOrCategory:i}})}}
    ></gr-checks-chip>`}};UP([Fc({type:Array})],BP.prototype,"labels",void 0),UP([Fc({type:Boolean})],BP.prototype,"showRunning",void 0),UP([Uc()],BP.prototype,"runs",void 0),BP=UP([Dc("gr-checks-chip-for-label")],BP);var HP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let jP=class extends Ic{static get styles(){return[Qb,D$,Sd`
        :host([suppress-title]) .metadata-title {
          display: none;
        }
        .metadata-title {
          color: var(--deemphasized-text-color);
          padding-left: var(--metadata-horizontal-padding);
          margin: 0 0 var(--spacing-s);
          padding-top: var(--spacing-s);
        }
        gr-icon {
          font-size: var(--line-height-normal, 20px);
        }
        .requirements,
        section.trigger-votes {
          margin-left: var(--spacing-l);
        }
        .trigger-votes {
          padding-top: var(--spacing-s);
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-s);
          /* Setting max-width as defined in Submit Requirements design,
           *  to wrap overflowed items to next row.
           */
          max-width: 390px;
        }
        gr-limited-text.name {
          font-weight: var(--font-weight-medium);
        }
        table {
          border-collapse: collapse;
          border-spacing: 0;
        }
        td {
          padding: var(--spacing-s);
          white-space: nowrap;
          vertical-align: top;
        }
        .votes {
          display: flex;
          flex-flow: column;
          row-gap: var(--spacing-s);
        }
        .votes-line {
          display: flex;
          flex-flow: wrap;
        }
        gr-vote-chip {
          margin-right: var(--spacing-s);
        }
        gr-checks-chip-for-label {
          /* .checksChip has top: 2px, this is canceling it */
          margin-top: -2px;
        }
      `]}constructor(){super(),this.disableHovercards=!1,this.disableEndpoints=!1,this.runs=[],this.getChecksModel=yu(this,sP),zf(this,(()=>this.getChecksModel().allRunsLatestPatchsetLatestAttempt$),(e=>this.runs=e))}render(){return dc`${this.renderSubmitRequirements()}${this.renderTriggerVotes()}`}renderSubmitRequirements(){const e=function(e){let t=[];for(const i of Ev){const r=e.filter((e=>e.name===i));t=t.concat(r)}const i=e.filter((e=>!Ev.includes(e.name)));return t.concat(i)}(Cv(this.change)),t=(e,t)=>`${t}-${e.name}`;return dc` <h3
        class="metadata-title heading-3"
        id="submit-requirements-caption"
      >
        Submit Requirements
        ${0===e.length?"(Loading...)":""}
      </h3>
      ${eb(0!==e.length,(()=>dc`<table
            class="requirements"
            aria-labelledby="submit-requirements-caption"
          >
            <thead hidden>
              <tr>
                <th>Status</th>
                <th>Name</th>
                <th>Votes</th>
              </tr>
            </thead>
            <tbody>
              ${Mw(e,t,((e,t)=>this.renderRequirement(e,t)))}
            </tbody>
          </table>
          ${this.disableHovercards?"":e.map(((e,t)=>dc`
                  <gr-submit-requirement-hovercard
                    for="requirement-${t}-${Pg(e.name)}"
                    .requirement=${e}
                    .change=${this.change}
                    .account=${this.account}
                    .mutable=${this.mutable??!1}
                  ></gr-submit-requirement-hovercard>
                `))}`))}`}renderRequirement(e,t){const i=dc`
     <td>${this.renderStatus(e)}</td>
        <td class="name">
          <gr-limited-text
            class="name"
            .text=${e.name}
          ></gr-limited-text>
        </td>
        <td>
          ${this.renderEndpoint(e,this.renderVoteCell(e))}
        </td>
      </tr>
    `;return this.disableHovercards?dc`<tr>
        ${i}
      </tr>`:dc`<tr
        id="requirement-${t}-${Pg(e.name)}"
        role="button"
        tabindex="0"
      >
        ${i}
      </tr>`}renderEndpoint(e,t){if(this.disableEndpoints)return dc`<div class="votes-cell">${t}</div>`;const i=this.computeEndpointName(e.name);return dc`<gr-endpoint-decorator class="votes-cell" name=${i}>
      <gr-endpoint-param
        name="change"
        .value=${this.change}
      ></gr-endpoint-param>
      <gr-endpoint-param
        name="requirement"
        .value=${e}
      ></gr-endpoint-param>
      ${t}
    </gr-endpoint-decorator>`}renderStatus(e){const t=_v(e);return dc`<gr-icon
      class=${t.icon}
      ?filled=${!!t.filled}
      .icon=${t.icon}
      role="img"
      aria-label=${e.status.toLowerCase()}
    ></gr-icon>`}renderVoteCell(e){if(e.status===tg.ERROR)return dc`<span class="error">Error</span>`;const t=wv(e,{extractFromSubmittability:!0,extractFromOverride:"onlyIfOverridden"}),i=this.change?.labels??{},r=Object.keys(i).filter((e=>t.includes(e)));if(0===r.length){const t=Mg(e.status.toLowerCase());return this.renderChecks(e)||dc`${t}`}if(r.every((e=>!fv(i[e]))))return this.renderChecks(e)||dc`No votes`;const o=r.filter((e=>fv(i[e])));return dc`<div class="votes">
      ${m$(o,(t=>dc`<div class="votes-line">
            ${this.renderLabelVote(t,i)}
            ${this.renderVoteCountHelpLabel(e,t,i)}
            ${this.renderOverrideLabels(e,t,o.length>1)}
            ${this.renderChecks(e,t)}
          </div>`))}
    </div> `}renderVoteCountHelpLabel(e,t,i){if(e.status!==tg.UNSATISFIED)return uc;const r=i[t];if(!function(e){return Xu(e)?mv(e).some((t=>lv(e,t.value)===ov.APPROVED)):!!Zu(e)&&lv(e)===ov.APPROVED}(r)||function(e){return Xu(e)?mv(e).some((t=>lv(e,t.value)===ov.REJECTED)):!!Zu(e)&&lv(e)===ov.REJECTED}(r))return uc;const o=function(e){const t=new RegExp("label[0-9]*:([\\w-]+)[^,]*,count>?=?([0-9])","g"),i=[];let r;for(;null!==(r=t.exec(e));)r[2]&&!isNaN(Number(r[2]))&&i.push({label:r[1],count:Number(r[2])});return i}(e.submittability_expression_result.expression).find((e=>e.label===t))?.count;return o&&1!==o?dc`Requires ${o} votes`:uc}renderLabelVote(e,t){const i=t[e];return Xu(i)?mv(i).filter((e=>!dv(i,e))).map((e=>dc`<gr-vote-chip
            .vote=${e}
            .label=${i}
            .more=${(i.all??[]).filter((t=>t.value===e.value)).length>1}
          ></gr-vote-chip>`)):Zu(i)?[dc`<gr-vote-chip .label=${i}></gr-vote-chip>`]:dc``}renderOverrideLabels(e,t,i){if(i||e.status===tg.OVERRIDDEN)return wv(e,{extractFromSubmittability:i,extractFromOverride:"onlyIfOverridden"}).filter((e=>e===t)).filter((e=>{const t=this.change?.labels??{};return t[e]&&fv(t[e])})).map((e=>dc`<span class="overrideLabel">${e}</span>`))}renderChecks(e,t){const i=t?[t]:e?wv(e):[];if(0===i.length)return;const{errorRunsCount:r}=MP(this.runs,i),{runningRunsCount:o}=FP(this.runs,i);return r<=0&&o<=0?void 0:dc`<gr-checks-chip-for-label
      .labels=${i}
      .showRunning=${!0}
    ></gr-checks-chip-for-label>`}renderTriggerVotes(){const e=this.change?.labels??{},t=Nv(this.change).filter((t=>fv(e[t])));if(t.length)return dc`<h3 class="metadata-title heading-3">
        ${this.computeTriggerVotesTitle()}
      </h3>
      <section class="trigger-votes">
        ${t.map((t=>dc`<gr-trigger-vote
              .label=${t}
              .labelInfo=${e[t]}
              .change=${this.change}
              .account=${this.account}
              .mutable=${this.mutable??!1}
              .disableHovercards=${this.disableHovercards}
            ></gr-trigger-vote>`))}
      </section>`}computeTriggerVotesTitle(){return 0===Cv(this.change).length?"Label Votes":"Trigger Votes"}computeEndpointName(e){return`submit-requirement-${Pg(e.split("~")[0]).toLowerCase()}`}};HP([Fc({type:Object})],jP.prototype,"change",void 0),HP([Fc({type:Object})],jP.prototype,"account",void 0),HP([Fc({type:Boolean})],jP.prototype,"mutable",void 0),HP([Fc({type:Boolean,attribute:"disable-hovercards"})],jP.prototype,"disableHovercards",void 0),HP([Fc({type:Boolean,attribute:"disable-endpoints"})],jP.prototype,"disableEndpoints",void 0),HP([Uc()],jP.prototype,"runs",void 0),jP=HP([Dc("gr-submit-requirements")],jP);var GP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const zP=ix(Ic);let VP=class extends zP{static get styles(){return[zP.styles||[],Sd`
        #container {
          padding: var(--spacing-xl);
          padding-left: var(--spacing-s);
        }
      `]}render(){return dc`<div id="container" role="tooltip" tabindex="-1">
      <gr-submit-requirements
        .change=${this.change}
        disable-hovercards
        suppress-title
        disable-endpoints
      ></gr-submit-requirements>
    </div>`}};GP([Fc({type:Object})],VP.prototype,"change",void 0),VP=GP([Dc("gr-submit-requirement-dashboard-hovercard")],VP);var WP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let qP=class extends Ic{constructor(){super(...arguments),this.flat=!1,this.tooltipText="",this.resolveWeblinks=[]}static get styles(){return[Nc,Sd`
        .chip {
          border-radius: var(--border-radius);
          background-color: var(--chip-background-color);
          padding: 0 var(--spacing-m);
          white-space: nowrap;
        }
        :host(.merged) .chip {
          background-color: var(--status-merged);
          color: var(--status-merged);
        }
        :host(.abandoned) .chip {
          background-color: var(--status-abandoned);
          color: var(--status-abandoned);
          text-decoration: line-through;
        }
        :host(.wip) .chip {
          background-color: var(--status-wip);
          color: var(--status-wip);
        }
        :host(.private) .chip {
          background-color: var(--status-private);
          color: var(--status-private);
        }
        :host(.merge-conflict) .chip,
        :host(.git-conflict) .chip {
          background-color: var(--status-conflict);
          color: var(--status-conflict);
        }
        :host(.active) .chip {
          background-color: var(--status-active);
          --status-text-color: black;
          color: var(--status-active);
        }
        :host(.ready-to-submit) .chip {
          background-color: var(--status-ready);
          color: var(--status-ready);
        }
        :host(.revert) .chip {
          background-color: var(--status-revert);
          color: var(--status-revert);
        }
        :host(.revert-created) .chip {
          background-color: var(--status-revert-created);
          color: var(--status-revert-created);
        }
        :host(.revert-submitted) .chip {
          background-color: var(--status-revert-created);
          color: var(--status-revert-created);
        }
        .status-link {
          text-decoration: none;
        }
        :host(.custom) .chip {
          background-color: var(--status-custom);
          color: var(--status-custom);
        }
        :host([flat]) .chip {
          background-color: transparent;
          padding: 0;
        }
        :host(:not([flat])) .chip,
        :host(:not([flat])) .chip gr-icon {
          color: var(--status-text-color);
        }
      `]}render(){return dc`
      <gr-tooltip-content
        has-tooltip
        position-below
        .title=${this.tooltipText}
        .maxWidth=${"40em"}
      >
        ${this.renderStatusLink()}
      </gr-tooltip-content>
    `}renderStatusLink(){return this.hasStatusLink()?dc`
      <a class="status-link" href=${this.getStatusLink()}>
        <div class="chip" aria-label="Label: ${this.status}">
          ${this.computeStatusString()}
          ${this.showResolveIcon()?dc`<gr-icon icon="edit" filled small></gr-icon>`:""}
        </div>
      </a>
    `:dc`
        <div class="chip" aria-label="Label: ${this.status}">
          ${this.computeStatusString()}
        </div>
      `}willUpdate(e){e.has("status")&&this.updateChipDetails(e.get("status"))}computeStatusString(){return this.status!==vf.WIP||this.flat?this.status??"":"Work in Progress"}toClassName(e){return e?e.toLowerCase().replace(/\s/g,"-"):""}hasStatusLink(){return(this.status===vf.REVERT_SUBMITTED||this.status===vf.REVERT_CREATED)&&void 0!==this.revertedChange||!(this.status!==vf.MERGE_CONFLICT||!this.resolveWeblinks?.length)}getStatusLink(){return this.revertedChange?tE({query:`${this.revertedChange._number}`}):this.status===vf.MERGE_CONFLICT&&this.resolveWeblinks?.length?this.resolveWeblinks[0].url??"":""}showResolveIcon(){return this.status===vf.MERGE_CONFLICT&&!!this.resolveWeblinks?.length}updateChipDetails(e){switch(e&&this.classList.remove(this.toClassName(e)),this.classList.add(this.toClassName(this.status)),this.status){case vf.WIP:this.tooltipText="This change isn't ready to be reviewed or submitted. It will not appear on dashboards unless you are in the attention set, and email notifications will be silenced until the review is started.";break;case vf.PRIVATE:this.tooltipText='This change is only visible to its owner and current reviewers (or anyone with "View Private Changes" permission).';break;case vf.MERGE_CONFLICT:this.tooltipText='This change has merge conflicts. Rebase on the upstream branch (e.g. "git pull --rebase"). Upload a new patchset after resolving all merge conflicts.';break;case vf.GIT_CONFLICT:this.tooltipText="A file contents of the change contain git conflict markersto indicate the conflicts.";break;default:this.tooltipText=""}}};WP([Fc({type:Boolean,reflect:!0})],qP.prototype,"flat",void 0),WP([Fc({type:String})],qP.prototype,"status",void 0),WP([Uc()],qP.prototype,"tooltipText",void 0),WP([Fc({type:Object})],qP.prototype,"revertedChange",void 0),WP([Fc({type:Object})],qP.prototype,"resolveWeblinks",void 0),qP=WP([Dc("gr-change-status")],qP);var KP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let YP=class extends Ic{static get styles(){return[D$,Sd`
        :host {
          display: inline-block;
        }
        gr-change-status {
          display: inline-block;
        }
        gr-icon.commentIcon {
          color: var(--warning-foreground);
        }
        .unsatisfied {
          color: var(--primary-text-color);
        }
        /* Used to hide the leading separator comma for statuses. */
        .comma:first-of-type {
          display: none;
        }
      `]}render(){const e=this.renderCommentIcon();return dc`${this.renderChangeStatus()} ${e}`}renderChangeStatus(){if(!this.change)return;const e=OC(this.change);return e.length>0?e.map((e=>dc`<span class="comma">, </span
            ><gr-change-status flat .status=${e}></gr-change-status>`)):this.renderActiveStatus()}renderActiveStatus(){const e=Cv(this.change);if(!e.length)return dc`n/a`;const t=e.length;if(e.filter((e=>e.status===tg.SATISFIED||e.status===tg.OVERRIDDEN)).length===t)return this.renderState(xv(tg.SATISFIED),"Ready");const i=e.filter((e=>e.status===tg.UNSATISFIED)).length;return this.renderState(xv(tg.UNSATISFIED),this.renderSummary(i))}renderState(e,t){return dc`<span class=${e.icon} role="button" tabindex="0">
      <gr-submit-requirement-dashboard-hovercard .change=${this.change}>
      </gr-submit-requirement-dashboard-hovercard>
      <gr-icon
        class=${e.icon}
        icon=${e.icon}
        ?filled=${!!e.filled}
        role="img"
      ></gr-icon>
      ${t}</span
    >`}renderSummary(e){return dc`<span class="unsatisfied">${e} missing</span>`}renderCommentIcon(){if(this.change?.unresolved_comment_count)return dc`<gr-icon
      class="commentIcon"
      icon="chat_bubble"
      small
      filled
      .title=${Ig(this.change?.unresolved_comment_count,"unresolved comment")}
    ></gr-icon>`}};KP([Fc({type:Object})],YP.prototype,"change",void 0),YP=KP([Dc("gr-change-list-column-requirements-summary")],YP);var XP=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let JP=class extends Ic{static get styles(){return[D$,Nc,Sd`
        .container {
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .container.not-applicable {
          background-color: var(--table-header-background-color);
          height: calc(var(--line-height-normal) + var(--spacing-m));
        }
      `]}render(){return dc`<div
      class="container ${this.computeClass()}"
      title=${Vw(this.computeLabelTitle())}
    >
      ${this.renderContent()}
    </div>`}renderContent(){if(!this.labelName)return;const e=this.getRequirement(this.labelName);if(0===e.length)return this.renderTriggerVote();const t=e[0];return t.status===tg.UNSATISFIED?this.renderUnsatisfiedState(t):this.renderStatusIcon(t.status)}renderTriggerVote(){if(!this.labelName||!this.isTriggerVote(this.labelName))return;const e=(this.change?.labels??{})[this.labelName];if(Xu(e)){const t=this.getSortedVotes(this.labelName);if(t.length>0){const i=t[0];return dc`<gr-vote-chip
          .vote=${i}
          .label=${e}
          tooltip-with-who-voted
        ></gr-vote-chip>`}}return Zu(e)?dc`<gr-vote-chip .label=${e}></gr-vote-chip>`:void 0}renderUnsatisfiedState(e){const t=wv(e,{extractFromSubmittability:!0,extractFromOverride:"onlyIfOverridden"}),i=this.change?.labels??{},r=Object.keys(i).filter((e=>t.includes(e)));let o,s;for(const e of r){const t=this.getSortedVotes(e).sort(((e,t)=>(e.value??0)-(t.value??0)));if(0===t.length)break;(!o||(o.value??0)>(t[0].value??0))&&(o=t[0],s=i[e])}return void 0===o?this.renderStatusIcon(e.status):dc`<gr-vote-chip
        .vote=${o}
        .label=${s}
        tooltip-with-who-voted
      ></gr-vote-chip>`}renderStatusIcon(e){const t=xv(e);return dc`
      <gr-icon
        class=${t.icon}
        icon=${t.icon}
        ?filled=${!!t.filled}
      ></gr-icon>
    `}computeClass(){return this.labelName?0!==this.getRequirement(this.labelName).length||this.isTriggerVote(this.labelName)?"":"not-applicable":""}computeLabelTitle(){if(!this.labelName)return;const e=this.getRequirement(this.labelName);if(0===e.length)return this.isTriggerVote(this.labelName)?void 0:"Requirement not applicable";const t=e[0];if(t.status===tg.UNSATISFIED){const e=wv(t,{extractFromSubmittability:!0,extractFromOverride:"onlyIfOverridden"}),i=this.change?.labels??{},r=Object.keys(i).filter((t=>e.includes(t)));return 0===r.length?Mg(t.status.toLowerCase()):r.every((e=>!fv(i[e])))?"No votes":void 0}return Mg(t.status.toLowerCase())}getRequirement(e){const t=Cv(this.change).filter((t=>t.name===e));return t.length>1?t.filter((e=>!e.is_legacy)):t}getSortedVotes(e){const t=(this.change?.labels??{})[e];return Xu(t)?mv(t).filter((e=>!dv(t,e))):[]}isTriggerVote(e){return Nv(this.change).includes(e)}};XP([Fc({type:Object})],JP.prototype,"change",void 0),XP([Fc()],JP.prototype,"labelName",void 0),JP=XP([Dc("gr-change-list-column-requirement")],JP);const QP=Sd`
  td {
    border-top: 1px solid var(--border-color);
  }
  gr-change-list-item[selected],
  gr-change-list-item:focus {
    background-color: var(--selection-background-color);
  }
  gr-change-list-item[highlight] {
    background-color: var(--line-item-highlight-color);
  }
  gr-change-list-item[highlight][selected],
  gr-change-list-item[highlight]:focus {
    background-color: var(--line-item-highlight-selection-color);
  }
  gr-change-list-item:last-child,
  tr.noChanges {
    --last-border-bottom: 1px solid var(--border-color);
    --last-border-radius: 4px;
  }
  td {
    border-bottom: var(--last-border-bottom);
  }
  td:first-child {
    border-bottom-left-radius: var(--last-border-radius);
  }
  td:last-child {
    border-bottom-right-radius: var(--last-border-radius);
  }
  .groupTitle td,
  .cell {
    vertical-align: middle;
  }
  .groupTitle td:not(.label):not(.endpoint):not(.star),
  .cell:not(.label):not(.endpoint):not(.star) {
    padding-right: 8px;
  }
  .groupTitle td {
    color: var(--deemphasized-text-color);
    font-weight: var(--font-weight-medium);
    font-family: var(--header-font-family);
    text-align: left;
  }
  .groupGap {
    height: 10px;
  }
  .groupHeader td {
    background-color: var(--section-header-background-color);
    border-top: 1px solid var(--border-color);
  }
  .groupHeader td:first-child {
    border-top-left-radius: 4px;
  }
  .groupHeader td:last-child {
    border-top-right-radius: 4px;
  }
  .groupHeader {
    font-size: var(--font-size-h2);
    font-weight: var(--font-weight-h2);
    line-height: var(--line-height-h2);
  }
  .groupContent {
    background-color: var(--background-color-primary);
  }
  .groupHeader a {
    color: var(--primary-text-color);
    text-decoration: none;
  }
  .groupHeader a:hover {
    text-decoration: underline;
  }
  .groupTitle td,
  .cell {
    padding: var(--spacing-s) 0;
  }
  .groupHeader .cell {
    padding: var(--spacing-xs) 0;
  }
  .star {
    padding: 0 var(--spacing-s) 0 0;
  }
  .owner {
    --account-max-length: 100px;
  }
  td:first-child {
    border-left: 1px solid var(--border-color);
  }
  td:last-child {
    border-right: 1px solid var(--border-color);
  }
  .branch,
  .star,
  .label,
  .number,
  .owner,
  .updated,
  .submitted,
  .waiting,
  .size,
  .status,
  .repo {
    white-space: nowrap;
  }
  .leftPadding {
    width: var(--spacing-l);
  }
  .reviewers div {
    overflow: hidden;
  }
  .label,
  .endpoint {
    border-left: 1px solid var(--border-color);
  }
  .groupTitle td.label,
  .label {
    text-align: center;
    width: 3rem;
  }
  .truncatedRepo {
    display: none;
  }
  @media only screen and (max-width: 150em) {
    .branch {
      overflow: hidden;
      max-width: 18rem;
      text-overflow: ellipsis;
    }
    .truncatedRepo {
      display: inline-block;
    }
    .fullRepo {
      display: none;
    }
  }
  @media only screen and (max-width: 100em) {
    .branch {
      max-width: 10rem;
    }
  }
  @media only screen and (max-width: 50em) {
    :host {
      font-family: var(--header-font-family);
      font-size: var(--font-size-h3);
      font-weight: var(--font-weight-h3);
      line-height: var(--line-height-h3);
    }
    gr-change-list-item {
      flex-wrap: wrap;
      justify-content: space-between;
      padding: var(--spacing-xs) var(--spacing-m);
      border-top: 1px solid var(--border-color);
    }
    gr-change-list-item[selected],
    gr-change-list-item:focus td {
      background-color: var(--view-background-color);
      border: none;
    }
    gr-change-list-item:hover {
      background-color: var(--view-background-color);
    }
    td.cell,
    .groupHeader td.cell {
      border-left: none;
      border-right: none;
      border-radius: 0px;
    }
    .cell {
      align-items: center;
      display: flex;
      border: none;
    }
    .groupTitle,
    .leftPadding,
    .selection,
    .status,
    .repo,
    .branch,
    .updated,
    .submitted,
    .waiting,
    .label,
    .groupHeader .star,
    .noChanges .star {
      display: none;
    }
    .groupHeader .cell,
    .noChanges .cell {
      padding-left: var(--spacing-m);
    }
    .subject {
      margin-bottom: var(--spacing-xs);
      width: calc(100% - 2em);
    }
    .owner,
    .size {
      max-width: none;
    }
    .noChanges .cell {
      display: block;
      height: auto;
    }
  }
`,ZP=document.createElement("template");ZP.innerHTML=`<dom-module id="gr-change-list-styles">\n  <template>\n    <style>\n    ${QP.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(ZP.content);const eN=mu("bulk-actions-model");var tN;!function(e){e.NOT_SYNCED="NOT_SYNCED",e.LOADING="LOADING",e.LOADED="LOADED"}(tN||(tN={}));const iN={loadingState:tN.NOT_SYNCED,selectedChangeNums:[],selectableChangeNums:[],allChanges:new Map};class rN extends df{constructor(e){super(iN),this.restApiService=e,this.selectedChangeNums$=lf(this.state$,(e=>e.selectedChangeNums)),this.totalChangeCount$=lf(this.state$,(e=>e.allChanges.size)),this.loadingState$=lf(this.state$,(e=>e.loadingState)),this.selectedChanges$=lf(this.state$,(e=>{const t=[];for(const i of e.selectedChangeNums){const r=e.allChanges.get(i);r&&t.push(r)}return t}))}toggleSelectedChangeNum(e){this.getState().selectedChangeNums.includes(e)?this.removeSelectedChangeNum(e):this.addSelectedChangeNum(e)}addSelectedChangeNum(e){const t=this.getState();if(!t.selectableChangeNums.includes(e))throw new Error(`Trying to add change ${e} that is not part of bulk-actions model`);const i=[...t.selectedChangeNums];i.push(e),this.setState({...t,selectedChangeNums:i})}removeSelectedChangeNum(e){const t=this.getState();if(!t.selectableChangeNums.includes(e))throw new Error(`Trying to remove change ${e} that is not part of bulk-actions model`);const i=[...t.selectedChangeNums],r=i.findIndex((t=>t===e));-1!==r&&(i.splice(r,1),this.updateState({selectedChangeNums:i}))}clearSelectedChangeNums(){this.updateState({selectedChangeNums:[]})}selectAll(){const e=this.getState();this.updateState({selectedChangeNums:Array.from(e.allChanges.keys())})}abandonChanges(e,t){const i=this.getState();return i.selectedChangeNums.map((r=>{if(!i.allChanges.get(r))throw new Error("invalid change id");const o=i.allChanges.get(r);return o.status===Nu.ABANDONED?Promise.resolve(new Response):this.restApiService.executeChangeAction(NC(o),o.actions.abandon.method,"/abandon",void 0,{message:e??""},(()=>t&&t(NC(o))))}))}voteChanges(e){const t=this.getState();return t.selectedChangeNums.map((i=>{const r=t.allChanges.get(i);if(!r)throw new Error("invalid change id");return this.restApiService.saveChangeReview(NC(r),"current",e,(()=>{throw new Error}))}))}addReviewers(e,t){const i=this.getState();return i.selectedChangeNums.map((e=>i.allChanges.get(e))).map((i=>{const r=[Vu.REVIEWER,Vu.CC].flatMap((t=>this.getNewReviewersToChange(i,t,e)));if(0===r.length)return Promise.resolve(void 0);const o=r.filter((e=>e.state===Vu.REVIEWER)).map((e=>({user:e.reviewer,reason:t}))),s={reviewers:r,ignore_automatic_attention_set_rules:!0,add_to_attention_set:o};return this.restApiService.saveChangeReview(NC(i),"current",s)}))}addHashtags(e){return this.getState().selectedChangeNums.map((t=>this.restApiService.setChangeHashtag(t,{add:e},Ff).then((e=>{va(!!e,"setChangeHastag returned undefined");const i=this.getState(),r={...i,allChanges:new Map(i.allChanges)};return r.allChanges.set(t,{...r.allChanges.get(t),hashtags:e}),this.setState(r),e}))))}async sync(e){const t=new Map(e.map((e=>[NC(e),e])));let i=this.getState();const r=i.selectedChangeNums.filter((e=>t.has(e))),o=e.map((e=>NC(e)));if(this.updateState({loadingState:tN.LOADING,selectedChangeNums:r,selectableChangeNums:o,allChanges:new Map}),0===e.length)return;const s=!this.hasSubmitRequirements(e[0]),n=await this.restApiService.getDetailedChangesWithActions(e.map((e=>NC(e))),s);if(i=this.getState(),!sf(o,i.selectableChangeNums))return;const a=new Map;for(const e of n??[])a.set(e._number,{...e,submit_requirements:s?e.submit_requirements:t.get(e._number)?.submit_requirements});this.setState({...i,loadingState:tN.LOADED,allChanges:a})}hasSubmitRequirements(e){return GC(e)&&void 0!==e.submit_requirements}getNewReviewersToChange(e,t,i){return i.get(t)?.filter((i=>!e.reviewers[t]?.includes(i))).map((e=>({state:t,reviewer:px(e)})))??[]}}var oN,sN,nN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e[e.XS=10]="XS",e[e.SMALL=50]="SMALL",e[e.MEDIUM=250]="MEDIUM",e[e.LARGE=1e3]="LARGE"}(oN||(oN={})),function(e){e.NOT_APPLICABLE="NOT_APPLICABLE",e.APPROVED="APPROVED",e.POSITIVE="POSITIVE",e.NEUTRAL="NEUTRAL",e.NEGATIVE="NEGATIVE",e.REJECTED="REJECTED"}(sN||(sN={}));let aN=class extends Ic{constructor(){super(),this.showNumber=!1,this.globalIndex=0,this.selected=!1,this.checked=!1,this.reporting=Xn().reportingService,this.getPluginLoader=yu(this,U_),this.getBulkActionsModel=yu(this,eN),this.getConfigModel=yu(this,Qw),this.getNavigation=yu(this,gy),this.getUserModel=yu(this,jf),this.isLoggedIn=!1,this.onItemClick=e=>{this.change&&e.composedPath()[0]===this&&this.getNavigation().setUrl(WC({change:this.change}))},zf(this,(()=>this.getBulkActionsModel().selectedChangeNums$),(e=>{this.updateCheckedState(e)})),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.isLoggedIn=e)),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.config=e}))}connectedCallback(){super.connectedCallback(),this.getPluginLoader().awaitPluginsLoaded().then((()=>{this.dynamicCellEndpoints=this.getPluginLoader().pluginEndPoints.getDynamicEndpoints("change-list-item-cell")})),this.addEventListener("click",this.onItemClick)}disconnectedCallback(){this.removeEventListener("click",this.onItemClick)}willUpdate(e){this.selected&&e.has("selected")&&this.focus(),e.has("change")&&this.updateCheckedState(this.getBulkActionsModel().getState().selectedChangeNums)}updateCheckedState(e){this.change?this.checked=e.includes(this.change._number):this.checked=!1}static get styles(){return[vy,Nc,D$,QP,Jy,Sd`
        :host {
          display: table-row;
          color: var(--primary-text-color);
        }
        :host(:focus) {
          outline: none;
        }
        :host([checked]),
        :host(:hover) {
          background-color: var(--hover-background-color);
        }
        .container {
          position: relative;
        }
        .content {
          overflow: hidden;
          position: absolute;
          text-overflow: ellipsis;
          white-space: nowrap;
          width: 100%;
        }
        .content a {
          display: block;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          width: 100%;
        }
        .reviewers,
        .requirements {
          white-space: nowrap;
        }
        .reviewers {
          --account-max-length: 70px;
        }
        .spacer {
          height: 0;
          overflow: hidden;
        }
        .size gr-tooltip-content {
          margin: -0.4rem -0.6rem;
          max-width: 2.5rem;
          padding: var(--spacing-m) var(--spacing-l);
        }
        .size span {
          border-radius: var(--border-radius);
          color: var(--dashboard-size-text);
          font-size: var(--font-size-small);
          /* To set height and width of span, it has to be inline block */
          display: inline-block;
          height: 20px;
          width: 20px;
          text-align: center;
          vertical-align: top;
        }
        .size span.size-xs {
          background-color: var(--dashboard-size-xs);
          color: var(--dashboard-size-xs-text);
        }
        .size span.size-s {
          background-color: var(--dashboard-size-s);
        }
        .size span.size-m {
          background-color: var(--dashboard-size-m);
        }
        .size span.size-l {
          background-color: var(--dashboard-size-l);
        }
        .size span.size-xl {
          background-color: var(--dashboard-size-xl);
          color: var(--dashboard-size-xl-text);
        }
        a {
          color: inherit;
          cursor: pointer;
          text-decoration: none;
        }
        /* The subject cell needs a separate rule for these reasons:
           1. :hover does not propagate to absolutely positioned children.
           2. .strikethrough for abandoned changes must be respected.
           3. We don't want the "spacer" and the &nbsp; to be underlined.
        */
        .cell:not(.subject) a:hover,
        .cell.subject a:hover .content:not(.strikethrough) {
          text-decoration: underline;
        }
        .strikethrough {
          color: var(--deemphasized-text-color);
          text-decoration: line-through;
        }
        .comma,
        .placeholder {
          color: var(--deemphasized-text-color);
        }
        .cell.selection input {
          vertical-align: middle;
        }
        .selectionLabel {
          padding: 10px;
          margin: -10px;
          display: block;
        }
        .cell.label {
          font-weight: var(--font-weight-normal);
        }
        .cell.label gr-icon {
          vertical-align: top;
        }
        /* Requirement child needs whole area */
        .cell.requirement {
          padding: 0;
          margin: 0;
        }
        md-checkbox {
          --md-checkbox-container-size: 15px;
          --md-checkbox-icon-size: 15px;
        }
        @media only screen and (max-width: 50em) {
          :host {
            display: flex;
          }
        }
      `]}render(){const e=this.computeChangeURL();return dc`
      <td aria-hidden="true" class="cell leftPadding"></td>
      ${this.renderCellSelectionBox()} ${this.renderCellStar()}
      ${this.renderCellNumber(e)} ${this.renderCellSubject(e)}
      ${this.renderCellOwner()} ${this.renderCellReviewers()}
      ${this.renderCellRepo()} ${this.renderCellBranch()}
      ${this.renderCellUpdated()} ${this.renderCellSubmitted()}
      ${this.renderCellWaiting()} ${this.renderCellSize()}
      ${this.renderCellRequirements()}
      ${this.labelNames?.map((e=>this.renderChangeLabels(e)))}
      ${this.dynamicCellEndpoints?.map((e=>this.renderChangePluginEndpoint(e)))}
    `}renderCellSelectionBox(){if(this.isLoggedIn)return dc`
      <td class="cell selection">
        <label class="selectionLabel">
          <md-checkbox
            ?checked=${this.checked}
            @change=${this.toggleCheckbox}
          ></md-checkbox>
        </label>
      </td>
    `}renderCellStar(){if(this.isLoggedIn)return dc`
      <td class="cell star">
        <gr-change-star .change=${this.change}></gr-change-star>
      </td>
    `}renderCellNumber(e){if(this.showNumber)return dc`
      <td class="cell number">
        <a href=${e}>${this.change?._number}</a>
      </td>
    `}renderCellSubject(e){if(!this.computeIsColumnHidden(dg.SUBJECT))return dc`
      <td class="cell subject">
        <a
          title=${Vw(this.change?.subject)}
          href=${e}
          @click=${this.handleChangeClick}
        >
          <div class="container">
            <div
              class=${th({content:!0,strikethrough:this.change?.status===Nu.ABANDONED})}
            >
              ${this.change?.subject}
            </div>
            <div class="spacer">${this.change?.subject}</div>
            <span>&nbsp;</span>
          </div>
        </a>
      </td>
    `}renderCellOwner(){if(!this.computeIsColumnHidden(dg.OWNER))return dc`
      <td class="cell owner">
        <gr-account-label
          highlightAttention
          clickable
          .change=${this.change}
          .account=${this.change?.owner}
        ></gr-account-label>
      </td>
    `}renderCellReviewers(){if(!this.computeIsColumnHidden(dg.REVIEWERS))return dc`
      <td class="cell reviewers">
        <div>
          ${this.computePrimaryReviewers().map(((e,t)=>this.renderChangeReviewers(e,t)))}
          ${this.computeAdditionalReviewersCount()?dc`<span title=${this.computeAdditionalReviewersTitle()}
                >+${this.computeAdditionalReviewersCount()}</span
              >`:""}
        </div>
      </td>
    `}renderChangeReviewers(e,t){return dc`
      <gr-account-label
        clickable
        hideAvatar
        firstName
        highlightAttention
        .change=${this.change}
        .account=${e}
      ></gr-account-label
      ><span ?hidden=${this.computeCommaHidden(t)} aria-hidden="true"
        >,
      </span>
    `}renderCellRepo(){if(this.computeIsColumnHidden(dg.REPO))return;const e=this.change?.project??"";return dc`
      <td class="cell repo">
        <a class="fullRepo" href=${this.computeRepoUrl()}> ${e} </a>
        <a class="truncatedRepo" href=${this.computeRepoUrl()} title=${e}>
          ${Tg(e,2)}
        </a>
      </td>
    `}renderCellBranch(){if(!this.computeIsColumnHidden(dg.BRANCH))return dc`
      <td class="cell branch">
        <a href=${this.computeRepoBranchURL()}> ${this.change?.branch} </a>
        ${this.renderChangeBranch()}
      </td>
    `}renderChangeBranch(){if(this.change?.topic)return dc`
      (<a href=${this.computeTopicURL()}
        ><!--
      --><gr-limited-text .limit=${50} .text=${this.change.topic}>
        </gr-limited-text
        ><!--
    --></a
      >)
    `}renderCellUpdated(){if(!this.computeIsColumnHidden(dg.UPDATED))return dc`
      <td class="cell updated">
        <gr-date-formatter
          withTooltip
          .dateStr=${this.formatDate(this.change?.updated)}
        ></gr-date-formatter>
      </td>
    `}renderCellSubmitted(){if(!this.computeIsColumnHidden("Submitted"))return dc`
      <td class="cell submitted">
        <gr-date-formatter
          withTooltip
          .dateStr=${this.formatDate(this.change?.submitted)}
        ></gr-date-formatter>
      </td>
    `}renderCellWaiting(){if(!this.computeIsColumnHidden(Sg))return dc`
      <td class="cell waiting">
        <gr-date-formatter
          withTooltip
          forceRelative
          relativeOptionNoAgo
          .dateStr=${this.computeWaiting()}
        ></gr-date-formatter>
      </td>
    `}renderCellSize(){if(!this.computeIsColumnHidden(dg.SIZE))return dc`
      <td class="cell size">
        <gr-tooltip-content has-tooltip title=${this.computeSizeTooltip()}>
          ${this.renderChangeSize()}
        </gr-tooltip-content>
      </td>
    `}renderChangeSize(){const e=this.computeChangeSize();return e?dc`
      <span class="size-${e.toLowerCase()}">${e}</span>
    `:dc`<span class="placeholder">--</span>`}renderCellRequirements(){if(!this.computeIsColumnHidden(dg.STATUS))return dc`
      <td class="cell status requirements">
        <gr-change-list-column-requirements-summary .change=${this.change}>
        </gr-change-list-column-requirements-summary>
      </td>
    `}renderChangeLabels(e){return dc` <td class="cell label requirement">
      <gr-change-list-column-requirement
        .change=${this.change}
        .labelName=${e}
      >
      </gr-change-list-column-requirement>
    </td>`}renderChangePluginEndpoint(e){return dc`
      <td class="cell endpoint">
        <gr-endpoint-decorator name=${e}>
          <gr-endpoint-param name="change" .value=${this.change}>
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      </td>
    `}computeChangeURL(){return this.change?WC({change:this.change,usp:this.usp}):""}computeRepoUrl(){return this.change?tE({repo:this.change.project,statuses:["open"]}):""}computeRepoBranchURL(){return this.change?tE({branch:this.change.branch,repo:this.change.project}):""}computeTopicURL(){return this.change?.topic?tE({topic:this.change.topic}):""}toggleCheckbox(){ba(this.change,"change"),this.checked=!this.checked,this.triggerSelectionCallback?.(this.globalIndex),this.getBulkActionsModel().toggleSelectedChangeNum(this.change._number)}computeSizeTooltip(){return!this.change||this.change.insertions+this.change.deletions===0||isNaN(this.change.insertions+this.change.deletions)?"Size unknown":`added ${this.change.insertions}, removed ${this.change.deletions} lines`}hasAttention(e){return!!(this.change&&this.change.attention_set&&e._account_id)&&ma(this.change.attention_set,e._account_id)}computeReviewers(){if(!this.change?.reviewers||!this.change?.reviewers.REVIEWER)return[];const e=[...this.change.reviewers.REVIEWER].filter((e=>!(this.change?.owner&&this.change?.owner._account_id===e._account_id||dx(e))));return e.sort(((e,t)=>{if(this.loggedInUser){if(cx(e,this.loggedInUser))return-1;if(cx(t,this.loggedInUser))return 1}return this.hasAttention(e)&&!this.hasAttention(t)?-1:this.hasAttention(t)&&!this.hasAttention(e)?1:(e.name||"").localeCompare(t.name||"")})),e}computePrimaryReviewers(){return this.computeReviewers().slice(0,2)}computeAdditionalReviewers(){return this.computeReviewers().slice(2)}computeAdditionalReviewersCount(){return this.computeAdditionalReviewers().length}computeAdditionalReviewersTitle(){return this.change&&this.config?this.computeAdditionalReviewers().map((e=>ox(this.config,e,!0))).join(", "):""}computeChangeSize(){if(!this.change)return null;const e=this.change.insertions+this.change.deletions;return isNaN(e)||0===e?null:e<oN.XS?"XS":e<oN.SMALL?"S":e<oN.MEDIUM?"M":e<oN.LARGE?"L":"XL"}computeWaiting(){const e="self"===this.dashboardUser?this.loggedInUser?._account_id:this.dashboardUser;if(e&&this.change?.attention_set)return this.change?.attention_set[e]?.last_update}computeIsColumnHidden(e){if(!e)return!1;const t=this.visibleChangeTableColumns??[];return t.length>0&&!t.includes(e)}formatDate(e){if(e)return e.toString()}handleChangeClick(){const e=this.loggedInUser&&this.loggedInUser._account_id||-1,t=this.change&&this.change.owner&&this.change.owner._account_id||-1;this.reporting.reportInteraction("change-row-clicked",{section:this.sectionName,isOwner:e===t})}computeCommaHidden(e){const t=this.computeAdditionalReviewersCount();return e===this.computePrimaryReviewers().length-1&&0===t}};nN([Fc({type:Object})],aN.prototype,"loggedInUser",void 0),nN([Fc({type:String})],aN.prototype,"dashboardUser",void 0),nN([Fc({type:Array})],aN.prototype,"visibleChangeTableColumns",void 0),nN([Fc({type:Array})],aN.prototype,"labelNames",void 0),nN([Fc({type:Object})],aN.prototype,"change",void 0),nN([Fc({type:String})],aN.prototype,"sectionName",void 0),nN([Fc({type:Boolean})],aN.prototype,"showNumber",void 0),nN([Fc({type:String})],aN.prototype,"usp",void 0),nN([Fc({type:Number})],aN.prototype,"globalIndex",void 0),nN([Fc({type:Function})],aN.prototype,"triggerSelectionCallback",void 0),nN([Fc({type:Boolean,reflect:!0})],aN.prototype,"selected",void 0),nN([Fc({type:Boolean,reflect:!0})],aN.prototype,"checked",void 0),nN([Uc()],aN.prototype,"config",void 0),nN([Uc()],aN.prototype,"dynamicCellEndpoints",void 0),nN([Uc()],aN.prototype,"isLoggedIn",void 0),aN=nN([Dc("gr-change-list-item")],aN);class lN{constructor(e,t,i,r,...o){this.restApi=e,this.type=t,this.config=i,this.loggedIn=r,this.changes=o}async getSuggestions(e){if(!this.loggedIn)return[];const t=await py(this.changes.map((t=>this.getSuggestionsForChange(t._number,e)))),i=t.filter(hy).map((e=>e.value)).filter(cf);return i.length!==t.length?[]:this.changes.reduce(((e,t,r)=>{const o=new Set([...t.reviewers[this.type]?.map(lx)??[],...i[r].map(dN)]);return e.filter((e=>o.has(dN(e))))}),(r=i.flat()).filter(((e,t)=>t===r.findIndex((t=>dN(e)===dN(t))))));var r}makeSuggestionItem(e){const t=function(e,t){return Cx(e)?sx(t,e):Cf(e)?sx(t,e.account):Ef(e)?`${e.group.name||""} (group)`:void fa(e,"Received an incorrect suggestion")}(e,this.config);return{name:t,value:Cx(e)?{account:e,count:1}:e}}getSuggestionsForChange(e,t){return this.type===Vu.REVIEWER?this.restApi.getChangeSuggestedReviewers(e,t,Ff):this.restApi.getChangeSuggestedCCs(e,t,Ff)}}function dN(e){return Cf(e)?lx(e.account):Ef(e)?e.group.id:Cx(e)?lx(e):void 0}var cN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let hN=class extends Ic{constructor(){super(...arguments),this.allowAnyInput=!1,this.borderless=!1,this.placeholder="",this.querySuggestions=()=>Promise.resolve([]),this.inputText=""}static get styles(){return[Nc,Sd`
        gr-autocomplete {
          display: inline-block;
          flex: 1;
          overflow: hidden;
        }
      `]}render(){return dc`
      <gr-autocomplete
        id="input"
        .borderless=${this.borderless}
        .placeholder=${this.placeholder}
        .query=${this.querySuggestions}
        allow-non-suggested-values=${this.allowAnyInput}
        @commit=${this.handleInputCommit}
        clear-on-commit
        warn-uncommitted
        .text=${this.inputText}
        .verticalOffset=${24}
        @text-changed=${this.handleTextChanged}
      >
      </gr-autocomplete>
    `}willUpdate(e){e.has("inputText")&&this.inputTextChanged()}get focusStart(){return this.input.focusStart}focus(){this.input.focus()}clear(){this.input.clear()}setText(e){this.input.setText(e)}getText(){return this.input.text}handleInputCommit(e){Jn(this,"add",{value:e.detail.value}),this.input.focus()}inputTextChanged(){this.inputText.length&&this.allowAnyInput&&Jn(this,"account-text-changed",{})}handleTextChanged(e){this.inputText=e.detail.value??""}};cN([Hc("#input")],hN.prototype,"input",void 0),cN([Fc({type:Boolean})],hN.prototype,"allowAnyInput",void 0),cN([Fc({type:Boolean})],hN.prototype,"borderless",void 0),cN([Fc({type:String})],hN.prototype,"placeholder",void 0),cN([Fc({type:Object})],hN.prototype,"querySuggestions",void 0),cN([Uc()],hN.prototype,"inputText",void 0),hN=cN([Dc("gr-account-entry")],hN);var pN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let uN=class extends Ic{constructor(){super(),this.accounts=[],this.placeholder="",this.disabled=!1,this.pendingConfirmation=null,this.readonly=!1,this.allowAnyInput=!1,this.chipDraggable=!1,this.reporting=Xn().reportingService,this.querySuggestions=e=>this.getSuggestions(e),this.addEventListener("remove-account",(e=>this.handleRemove(e)))}static get styles(){return[Nc,Sd`
        gr-account-chip {
          display: inline-block;
          margin: var(--spacing-xs) var(--spacing-xs) var(--spacing-xs) 0;
        }
        gr-account-entry {
          display: flex;
          flex: 1;
          min-width: 10em;
          margin: var(--spacing-xs) var(--spacing-xs) var(--spacing-xs) 0;
        }
        .group {
          --account-label-suffix: ' (group)';
        }
        .newlyAdded {
          font-style: italic;
        }
        .list {
          align-items: center;
          display: flex;
          flex-wrap: wrap;
        }
      `]}render(){return dc`<div class="list">
        ${Mw(this.accounts,(e=>px(e)),(e=>dc`
            <gr-account-chip
              .account=${e}
              .change=${this.change}
              class=${th({group:mf(e),newlyAdded:ux(e,this.reviewerState,this.change)})}
              ?removable=${this.computeRemovable(e)}
              ?draggable=${this.chipDraggable}
              @keydown=${this.handleChipKeydown}
              @dragstart=${this.handleChipDragStart}
              tabindex="-1"
            >
            </gr-account-chip>
          `))}
      </div>
      <gr-account-entry
        borderless=""
        ?hidden=${this.readonly}
        id="entry"
        .placeholder=${this.placeholder}
        @add=${this.handleAdd}
        @keydown=${this.handleInputKeydown}
        .allowAnyInput=${this.allowAnyInput}
        .querySuggestions=${this.querySuggestions}
      >
      </gr-account-entry>
      <slot></slot>`}willUpdate(e){e.has("pendingConfirmation")&&Jn(this,"pending-confirmation-changed",{value:this.pendingConfirmation})}get accountChips(){return Array.from(this.shadowRoot?.querySelectorAll("gr-account-chip")||[])}get focusStart(){return this.entry?.focusStart}getSuggestions(e){const t=this.suggestionsProvider;return t?t.getSuggestions(e).then((e=>e?(this.filter&&(e=e.filter(this.filter)),e.map((e=>t.makeSuggestionItem(e)))):[])):Promise.resolve([])}handleAdd(e){const t=e.detail.value;this.addAccountItem(t)}addAccountItem(e){let t,i="unknown";if(function(e){return!!e.account}(e))t={...e.account},this.accounts.push(t),i="account";else if(function(e){return!!e.group}(e)){if(e.confirm)return this.pendingConfirmation=e,!1;t={...e.group},this.accounts.push(t),i="group"}else if(this.allowAnyInput){if(!e.includes("@"))return this.entry?.setText(e),ea(this,"Please input a valid email."),!1;t={email:e},this.accounts.push(t),i="email"}return t?(Jn(this,"accounts-changed",{value:this.accounts.slice()}),Jn(this,"account-added",{account:t}),this.reporting.reportInteraction(`Add to ${this.id}`,{itemTypeAdded:i}),this.pendingConfirmation=null,this.requestUpdate(),!0):(ea(this,"Please input a valid user or group."),!1)}confirmGroup(e){this.accounts.push({...e,confirmed:!0}),this.pendingConfirmation=null,Jn(this,"accounts-changed",{value:this.accounts}),this.requestUpdate()}computeRemovable(e){return!this.readonly&&(!this.removableValues||(this.removableValues.some((t=>px(t)===px(e)))||ux(e,this.reviewerState,this.change)))}handleRemove(e){const t=e.detail.account;this.removeAccount(t),this.entry?.focus()}removeAccount(e){if(!e||!this.computeRemovable(e))return!1;const t=this.accounts.findIndex((t=>px(e)===px(t)));return-1!==t&&(this.accounts.splice(t,1),this.reporting.reportInteraction(`Remove from ${this.id}`),this.requestUpdate(),Jn(this,"accounts-changed",{value:this.accounts.slice()}),!0)}handleInputKeydown(e){const t=_a(e.target,"#input").nativeInput;if(t.selectionStart===t.selectionEnd&&0===t.selectionStart)switch(e.key){case"Backspace":this.removeAccount(this.accounts[this.accounts.length-1]);break;case"ArrowLeft":this.accountChips[this.accountChips.length-1]&&this.accountChips[this.accountChips.length-1].focus()}}handleChipDragStart(e){const t=e.target.account;t&&gf(t)&&(e.dataTransfer&&(e.dataTransfer.setData("text/plain",px(t)),e.dataTransfer.effectAllowed="move"),Jn(this,"account-drag-start",{account:t}))}handleChipKeydown(e){const t=e.target,i=this.accountChips,r=i.indexOf(t);switch(e.key){case"Backspace":case"Enter":case" ":case"Delete":this.removeAccount(t.account),i.splice(r,1),r<i.length?i[r].focus():r>0?i[r-1].focus():this.entry?.focus();break;case"ArrowLeft":r>0&&(t.blur(),i[r-1].focus());break;case"ArrowRight":t.blur(),r<i.length-1?i[r+1].focus():this.entry?.focus()}}submitEntryText(){const e=this.entry?.getText();if(!e?.length)return!0;const t=this.addAccountItem(e);return t&&this.entry?.clear(),t}additions(){return this.change?this.accounts.filter((e=>ux(e,this.reviewerState,this.change))):[]}removals(){return this.reviewerState?Ea(this.change?.reviewers[this.reviewerState]??[],this.accounts,((e,t)=>px(e)===px(t))):[]}};function gN(e){const t=Array.from(e.values());return t.every((e=>e===lg.NOT_STARTED))?lg.NOT_STARTED:t.some((e=>e===lg.RUNNING))?lg.RUNNING:t.some((e=>e===lg.FAILED))?lg.FAILED:lg.SUCCESSFUL}pN([Hc("#entry")],uN.prototype,"entry",void 0),pN([Fc({type:Array})],uN.prototype,"accounts",void 0),pN([Fc({type:Object})],uN.prototype,"change",void 0),pN([Fc({type:Object})],uN.prototype,"filter",void 0),pN([Fc()],uN.prototype,"placeholder",void 0),pN([Fc({type:Boolean})],uN.prototype,"disabled",void 0),pN([Fc({type:String})],uN.prototype,"reviewerState",void 0),pN([Fc({type:Object})],uN.prototype,"suggestionsProvider",void 0),pN([Fc({type:Object})],uN.prototype,"pendingConfirmation",void 0),pN([Fc({type:Boolean})],uN.prototype,"readonly",void 0),pN([Fc({type:Boolean,attribute:"allow-any-input"})],uN.prototype,"allowAnyInput",void 0),pN([Fc({type:Array})],uN.prototype,"removableValues",void 0),pN([Fc({type:Boolean})],uN.prototype,"chipDraggable",void 0),pN([Uc()],uN.prototype,"querySuggestions",void 0),uN=pN([Dc("gr-account-list")],uN);var mN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let fN=class extends Ic{static get styles(){return[Iw,Sd`
        gr-dialog {
          width: 60em;
        }
        .grid {
          display: grid;
          grid-template-columns: min-content 1fr;
          column-gap: var(--spacing-l);
        }
        gr-account-list {
          display: flex;
          flex-wrap: wrap;
        }
        .warning,
        .error {
          display: flex;
          align-items: center;
          gap: var(--spacing-xl);
          padding: var(--spacing-l);
          padding-left: var(--spacing-xl);
          background-color: var(--yellow-50);
        }
        .error {
          background-color: var(--error-background);
        }
        .grid + .warning,
        .error {
          margin-top: var(--spacing-l);
        }
        .warning + .warning {
          margin-top: var(--spacing-s);
        }
        gr-icon {
          color: var(--orange-800);
          font-size: 18px;
        }
        dialog#confirm-cc,
        dialog#confirm-reviewer {
          padding: var(--spacing-l);
          text-align: center;
        }
        .confirmation-buttons {
          margin-top: var(--spacing-l);
        }
      `]}constructor(){super(),this.selectedChanges=[],this.updatedAccountsByReviewerState=new Map([[Vu.REVIEWER,[]],[Vu.CC,[]]]),this.suggestionsProviderByReviewerState=new Map,this.progressByChangeNum=new Map,this.isOverlayOpen=!1,this.groupPendingConfirmationByReviewerState=new Map([[Vu.REVIEWER,null],[Vu.CC,null]]),this.reportingService=Xn().reportingService,this.getBulkActionsModel=yu(this,eN),this.getConfigModel=yu(this,Qw),this.getUserModel=yu(this,jf),this.restApiService=Xn().restApiService,this.isLoggedIn=!1,zf(this,(()=>this.getBulkActionsModel().selectedChanges$),(e=>this.selectedChanges=e)),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.serverConfig=e)),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.isLoggedIn=e)),zf(this,(()=>this.getUserModel().account$),(e=>this.account=e))}render(){return dc`
      <gr-button
        id="start-flow"
        .disabled=${this.isFlowDisabled()}
        flatten
        @click=${()=>this.openOverlay()}
        >Add Reviewer/CC</gr-button
      >
      <dialog id="flow" tabindex="-1">
        ${this.isOverlayOpen?this.renderDialog():uc}
      </dialog>
    `}renderDialog(){const e=gN(this.progressByChangeNum);return dc`
      <gr-dialog
        @cancel=${()=>this.closeOverlay()}
        @confirm=${()=>this.onConfirm(e)}
        .confirmLabel=${"Add"}
        .disabled=${e===lg.RUNNING}
        .loadingLabel=${"Adding Reviewer and CC in progress..."}
        ?loading=${gN(this.progressByChangeNum)===lg.RUNNING}
      >
        <div slot="header">Add reviewer / CC</div>
        <div slot="main">
          <div class="grid">
            <span>Reviewers</span>
            ${this.renderAccountList(Vu.REVIEWER,"reviewer-list","Add reviewer")}
            <span>CC</span>
            ${this.renderAccountList(Vu.CC,"cc-list","Add CC")}
          </div>
          ${this.renderAnyOverwriteWarnings()} ${this.renderErrors()}
        </div>
      </gr-dialog>
    `}renderAccountList(e,t,i){const r=this.updatedAccountsByReviewerState.get(e),o=this.suggestionsProviderByReviewerState.get(e);if(r&&o)return dc`
      <gr-account-list
        id=${t}
        .accounts=${r}
        .removableValues=${[]}
        .suggestionsProvider=${o}
        .placeholder=${i}
        .pendingConfirmation=${this.groupPendingConfirmationByReviewerState.get(e)??null}
        @accounts-changed=${()=>this.onAccountsChanged(e)}
        @pending-confirmation-changed=${t=>this.onPendingConfirmationChanged(e,t)}
      >
      </gr-account-list>
      ${this.renderConfirmationDialog(e)}
    `}renderConfirmationDialog(e){const t=e===Vu.CC?"confirm-cc":"confirm-reviewer",i=this.groupPendingConfirmationByReviewerState.get(e);return dc`
      <dialog
        tabindex="-1"
        id=${t}
        @close=${()=>this.cancelPendingGroup(e)}
      >
        <div class="confirmation-text">
          Group
          <span class="groupName"> ${i?.group.name} </span>
          has
          <span class="groupSize"> ${i?.count} </span>
          members.
          <br />
          Are you sure you want to add them all?
        </div>
        <div class="confirmation-buttons">
          <gr-button
            @click=${()=>this.confirmPendingGroup(e,i)}
            >Yes</gr-button
          >
          <gr-button @click=${()=>this.cancelPendingGroup(e)}
            >No</gr-button
          >
        </div>
      </dialog>
    `}renderAnyOverwriteWarnings(){return dc`
      ${this.renderAnyOverwriteWarning(Vu.REVIEWER)}
      ${this.renderAnyOverwriteWarning(Vu.CC)}
    `}renderErrors(){if(gN(this.progressByChangeNum)!==lg.FAILED)return uc;const e=[...this.updatedAccountsByReviewerState.get(Vu.REVIEWER)??[],...this.updatedAccountsByReviewerState.get(Vu.CC)??[]].map((e=>ox(this.serverConfig,e)));return 0===e.length?uc:dc`
      <div class="error">
        <gr-icon icon="error" filled role="img" aria-label="Error"></gr-icon>
        Failed to add ${Ug(e)} to changes.
      </div>
    `}renderAnyOverwriteWarning(e){const t=e===Vu.CC?Vu.REVIEWER:Vu.CC,i=this.getOverwrittenDisplayNames(e);if(0===i.length)return uc;const r=1===i.length?"is a":"are",o=`${e===Vu.CC?"CC":"reviewer"}${i.length>1?"s":""}`,s=t===Vu.CC?"CC":"reviewer";return dc`
      <div class="warning">
        <gr-icon
          icon="warning"
          filled
          role="img"
          aria-label="Warning"
        ></gr-icon>
        ${Ug(i)} ${r} ${o}
        on some selected changes and will be moved to ${s} on all
        changes.
      </div>
    `}getAccountsInCurrentState(e){return this.selectedChanges.flatMap((t=>t.reviewers[e]?.filter(vN(t))??[])).filter((e=>void 0!==e?._account_id))}getOverwrittenDisplayNames(e){const t=e===Vu.CC?Vu.REVIEWER:Vu.CC,i=this.getAccountsInCurrentState(e);return this.updatedAccountsByReviewerState.get(t).filter((e=>i.some((t=>px(t)===px(e))))).map((e=>ox(this.serverConfig,e)))}async openOverlay(){this.resetFlow(),this.isOverlayOpen=!0,await(this.modal?.showModal())}closeOverlay(){this.isOverlayOpen=!1,this.modal?.close()}resetFlow(){this.progressByChangeNum=new Map(this.selectedChanges.map((e=>[e._number,lg.NOT_STARTED])));for(const e of[Vu.REVIEWER,Vu.CC])this.updatedAccountsByReviewerState.set(e,this.getCurrentAccounts(e)),this.selectedChanges.length>0&&this.suggestionsProviderByReviewerState.set(e,this.createSuggestionsProvider(e));this.requestUpdate()}onAccountsChanged(e){const t=this.updatedAccountsByReviewerState.get(e).map(px),i=e===Vu.CC?Vu.REVIEWER:Vu.CC,r=this.updatedAccountsByReviewerState.get(i),o=r.filter((e=>!t.includes(px(e))));o.length!==r.length&&this.updatedAccountsByReviewerState.set(i,o),this.requestUpdate()}async onPendingConfirmationChanged(e,t){this.groupPendingConfirmationByReviewerState.set(e,t.detail.value),this.requestUpdate(),await this.updateComplete;const i=e===Vu.CC?this.ccConfirmModal:this.reviewerConfirmModal;null===t.detail.value?i?.close():await(i?.showModal())}cancelPendingGroup(e){const t=e===Vu.CC?this.ccConfirmModal:this.reviewerConfirmModal;t?.close(),this.groupPendingConfirmationByReviewerState.set(e,null),this.requestUpdate()}confirmPendingGroup(e,t){if(!t)return;const i=e===Vu.CC?this.ccList:this.reviewerList;i?.confirmGroup(t.group)}onConfirm(e){switch(e){case lg.NOT_STARTED:this.saveReviewers();break;case lg.SUCCESSFUL:case lg.FAILED:this.modal?.close()}}fireSuccessToasts(){const e=(this.updatedAccountsByReviewerState.get(Vu.REVIEWER)?.length??0)-this.getCurrentAccounts(Vu.REVIEWER).length,t=(this.updatedAccountsByReviewerState.get(Vu.CC)?.length??0)-this.getCurrentAccounts(Vu.CC).length;let i="";i=e&&t?`${Ig(e,"reviewer")} and ${Ig(t,"CC")} added`:e?`${Ig(e,"reviewer")} added`:`${Ig(t,"CC")} added`,ea(this,i)}async saveReviewers(){this.reportingService.reportInteraction(ga.BULK_ACTION,{type:"add-reviewer",selectedChangeCount:this.selectedChanges.length}),this.progressByChangeNum=new Map(this.selectedChanges.map((e=>[e._number,lg.RUNNING])));const e=this.getBulkActionsModel().addReviewers(this.updatedAccountsByReviewerState,kC(this.account,this.serverConfig));await py(e.map(((e,t)=>{const i=this.selectedChanges[t];return e.then((()=>{this.progressByChangeNum.set(i._number,lg.SUCCESSFUL),this.requestUpdate()})).catch((()=>{this.progressByChangeNum.set(i._number,lg.FAILED),this.requestUpdate()}))}))),gN(this.progressByChangeNum)===lg.FAILED?this.reportingService.reportInteraction("bulk-action-failure",{type:"add-reviewer",count:Array.from(this.progressByChangeNum.values()).filter((e=>e===lg.FAILED)).length}):(this.fireSuccessToasts(),this.closeOverlay(),aa(this))}isFlowDisabled(){return 0===this.selectedChanges.length}getCurrentAccounts(e){return function(e,t=(e,t)=>e===t){return 0===e.length?[]:1===e.length?[...e[0]]:e.reduce(((e,i)=>e.filter((e=>i.find((i=>t(e,i)))))))}(this.selectedChanges.map((t=>t.reviewers[e]?.filter(vN(t))??[])),((e,t)=>lx(e)===lx(t)))}createSuggestionsProvider(e){return new lN(this.restApiService,e,this.serverConfig,this.isLoggedIn,...this.selectedChanges)}};function vN(e){return t=>lx(e.owner)!==lx(t)}mN([Uc()],fN.prototype,"selectedChanges",void 0),mN([Uc()],fN.prototype,"updatedAccountsByReviewerState",void 0),mN([Uc()],fN.prototype,"suggestionsProviderByReviewerState",void 0),mN([Uc()],fN.prototype,"progressByChangeNum",void 0),mN([Uc()],fN.prototype,"isOverlayOpen",void 0),mN([Uc()],fN.prototype,"serverConfig",void 0),mN([Uc()],fN.prototype,"groupPendingConfirmationByReviewerState",void 0),mN([Hc("dialog#flow")],fN.prototype,"modal",void 0),mN([Hc("gr-account-list#reviewer-list")],fN.prototype,"reviewerList",void 0),mN([Hc("gr-account-list#cc-list")],fN.prototype,"ccList",void 0),mN([Hc("dialog#confirm-reviewer")],fN.prototype,"reviewerConfirmModal",void 0),mN([Hc("dialog#confirm-cc")],fN.prototype,"ccConfirmModal",void 0),mN([Hc("gr-dialog")],fN.prototype,"dialog",void 0),fN=mN([Dc("gr-change-list-reviewer-flow")],fN);var bN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let yN=class extends Ic{constructor(){super(...arguments),this.attrForSelected=null,this.selectedAttribute=null,this.items=[],this.selectedItem_=null}render(){return dc`<slot></slot>`}firstUpdated(e){super.firstUpdated(e),this.addEventListener("click",(e=>this.onClick(e))),this.observeItems()}observeItems(){this.getSlot().addEventListener("slotchange",(()=>this.itemsChanged()))}connectedCallback(){super.connectedCallback(),this.updateItems()}willUpdate(e){if(super.willUpdate(e),e.has("attrForSelected")&&this.selectedItem_){ba(this.attrForSelected);const e=this.selectedItem_.getAttribute(this.attrForSelected);ba(e),this.selected=e}}updated(e){super.updated(e),e.has("selected")&&this.updateSelectedItem()}select(e){this.selected=e}getSlot(){const e=this.shadowRoot.querySelector("slot");return ba(e),e}queryItems(){const e=void 0===this.selectable?"*":this.selectable;return Array.from(this.querySelectorAll(`:scope > ${e}`))}queryMatchingItem(e){const t=this.selectable||"*";return this.querySelector(`:scope > :is(${t})${e}`)}updateItems(){this.items=this.queryItems(),this.items.forEach(((e,t)=>e.setAttribute("data-selection-index",t.toString())))}get selectedItem(){return this.selectedItem_}updateSelectedItem(){if(!this.items)return;const e=null===this.selected||void 0===this.selected?null:this.items[this.valueToIndex_(this.selected)];e&&this.selectedItem_!==e?(this.setItemSelected_(this.selectedItem_,!1),this.setItemSelected_(e,!0)):e||this.setItemSelected_(this.selectedItem_,!1)}setItemSelected_(e,t){e&&(e.classList.toggle("selected",t),this.selectedAttribute&&e.toggleAttribute(this.selectedAttribute,t),this.selectedItem_=t?e:null,Jn(this,t?"select":"deselect",{item:e}))}valueToIndex_(e){if(!this.attrForSelected)return Number(e);const t=this.queryMatchingItem(`[${this.attrForSelected}="${e}"]`);return t?Number(t.dataset.selectionIndex):-1}indexToValue_(e){if(!this.attrForSelected)return e;const t=this.items[e];return t&&t.getAttribute(this.attrForSelected)||e}itemsChanged(){this.updateItems(),this.updateSelectedItem(),Jn(this,"items-changed",{})}onClick(e){let t=e.target;for(;t&&t!==this;){const e=this.items.indexOf(t);if(e>=0){const i=this.indexToValue_(e);return ba(i),Jn(this,"activate",{item:t,selected:i}),void this.select(i)}t=t.parentNode}}};bN([Fc({type:String})],yN.prototype,"attrForSelected",void 0),bN([Fc({type:String})],yN.prototype,"selected",void 0),bN([Fc({type:String})],yN.prototype,"selectedAttribute",void 0),bN([Fc({type:String})],yN.prototype,"selectable",void 0),bN([Uc()],yN.prototype,"items",void 0),yN=bN([Dc("gr-selector")],yN);var wN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let _N=class extends Ic{constructor(){super(...arguments),this.selectedValueText="No value selected",this.setSelectedValueText=e=>{const t=e.target.selectedItem;if(!t)return;if(!this.labelSelector?.items)return;for(const e of this.labelSelector.items)t===e?e.setAttribute("aria-checked","true"):e.removeAttribute("aria-checked");this.selectedValueText=t.getAttribute("title")||"";const i=t.dataset.name,r=t.dataset.value;i&&r&&Jn(this,"labels-changed",{name:i,value:r})}}static get styles(){return[Nc,Sd`
        .labelNameCell,
        .buttonsCell,
        .selectedValueCell {
          padding: var(--spacing-s) var(--spacing-m);
          display: table-cell;
        }
        /* We want the :hover highlight to extend to the border of the dialog. */
        .labelNameCell {
          padding-left: var(--label-score-padding-left, 0);
          width: 160px;
        }
        .selectedValueCell {
          padding-right: var(--spacing-xl);
        }
        /* This is a trick to let the selectedValueCell take the remaining width. */
        .labelNameCell,
        .buttonsCell {
          white-space: nowrap;
        }
        .selectedValueCell {
          width: 52%;
        }
        .labelMessage {
          color: var(--deemphasized-text-color);
        }
        gr-button {
          min-width: 42px;
          box-sizing: border-box;
          --vote-text-color: var(--vote-chip-unselected-text-color);
        }
        gr-button.selected {
          --vote-text-color: var(--vote-chip-selected-text-color);
        }
        gr-button::part(md-text-button) {
          padding: 0 var(--spacing-m);
          background-color: var(
            --button-background-color,
            var(--table-header-background-color)
          );
          border-color: var(--vote-chip-unselected-outline-color);
        }
        gr-button.selected::part(md-text-button) {
          border-color: transparent;
        }
        gr-button {
          --button-background-color: var(--vote-chip-unselected-color);
        }
        gr-button[data-vote='max'].selected {
          --button-background-color: var(--vote-chip-selected-positive-color);
        }
        gr-button[data-vote='positive'].selected {
          --button-background-color: var(--vote-chip-selected-positive-color);
        }
        gr-button[data-vote='neutral'].selected {
          --button-background-color: var(--vote-chip-selected-neutral-color);
        }
        gr-button[data-vote='negative'].selected {
          --button-background-color: var(--vote-chip-selected-negative-color);
        }
        gr-button[data-vote='min'].selected {
          --button-background-color: var(--vote-chip-selected-negative-color);
        }
        gr-button > gr-tooltip-content {
          margin: 0px -10px;
          padding: 0px 10px;
        }
        .placeholder {
          display: inline-block;
          width: 42px;
          height: 1px;
        }
        .placeholder::before {
          content: ' ';
        }
        .selectedValueCell {
          color: var(--deemphasized-text-color);
          font-style: italic;
        }
        .selectedValueCell.hidden {
          display: none;
        }
        @media only screen and (max-width: 50em) {
          .selectedValueCell {
            display: none;
          }
        }
      `]}render(){return dc`
      <span class="labelNameCell" id="labelName" aria-hidden="true"
        >${this.label?.name??""}</span
      >
      ${this.renderButtonsCell()} ${this.renderSelectedValue()}
    `}renderButtonsCell(){return dc`
      <div class="buttonsCell">
        ${this.renderBlankItems("start")} ${this.renderLabelSelector()}
        ${this.renderBlankItems("end")}
      </div>
    `}renderBlankItems(e){const t=this.computeBlankItemsCount(e);return Array.from({length:t}).fill("").map((()=>dc`
          <span class="placeholder" data-label=${this.label?.name??""}>
          </span>
        `))}renderLabelSelector(){return dc`
      <gr-selector
        id="labelSelector"
        .attrForSelected=${"data-value"}
        selected=${Vw(this._computeLabelValue())}
        @select=${this.setSelectedValueText}
        role="radiogroup"
        aria-labelledby="labelName"
      >
        ${this.renderPermittedLabels()}
      </gr-selector>
    `}renderPermittedLabels(){const e=this.computePermittedLabelValues();return e.map(((t,i)=>dc`
        <gr-button
          role="button"
          title=${Vw(this.computeLabelValueTitle(t))}
          data-vote=${this._computeVoteAttribute(Number(t),i,e.length)}
          data-name=${Vw(this.label?.name)}
          data-value=${t}
          aria-label=${t}
          voteChip
          flatten
        >
          <gr-tooltip-content
            has-tooltip
            light-tooltip
            title=${Vw(this.computeLabelValueTitle(t))}
          >
            ${t}
          </gr-tooltip-content>
        </gr-button>
      `))}renderSelectedValue(){return dc`
      <div class="selectedValueCell">
        <span id="selectedValueLabel">${this.selectedValueText}</span>
      </div>
    `}get selectedItem(){if(this.labelSelector)return this.labelSelector.selectedItem}get selectedValue(){if(this.labelSelector)return this.labelSelector.selected}setSelectedValue(e){this.labelSelector&&this.labelSelector.select(e)}computeBlankItemsCount(e){if(!(this.label&&this.permittedLabels?.[this.label.name]&&this.permittedLabels[this.label.name].length&&this.orderedLabelValues?.length))return 0;const t=this.orderedLabelValues,i=this.permittedLabels[this.label.name];return"start"===e?Number(i[0])-t[0]:t[t.length-1]-Number(i[i.length-1])}getLabelValue(){return ba(this.labels),ba(this.label),ba(this.permittedLabels),this.label.value?this.label.value:ma(this.labels[this.label.name],"default_value")&&ma(this.permittedLabels,this.label.name)?this.permittedLabels[this.label.name].find((e=>Number(e)===this.labels[this.label.name].default_value)):void 0}_computeVoteAttribute(e,t,i){return e<0&&0===t?"min":e<0?"negative":e>0&&t===i-1?"max":e>0?"positive":"neutral"}_computeLabelValue(){if(!this.labels||!this.permittedLabels||!this.label)return;if(!this.labels[this.label.name])return;const e=this.getLabelValue(),t=this.permittedLabels[this.label.name],i=t?t.length:0;for(let r=0;r<i;r++){const i=t[r];if(i===e)return i}}computePermittedLabelValues(){return this.permittedLabels&&this.label&&this.permittedLabels[this.label.name]||[]}computeLabelValueTitle(e){if(!this.labels||!this.label)return"";const t=this.labels[this.label.name];return t&&t.values?0===Number(e)&&this.label.value&&0!==Number(this.label.value)?"Reset Vote":t.values[e]:""}};wN([Hc("#labelSelector")],_N.prototype,"labelSelector",void 0),wN([Fc({type:Object})],_N.prototype,"label",void 0),wN([Fc({type:Object})],_N.prototype,"labels",void 0),wN([Fc({type:String,reflect:!0})],_N.prototype,"name",void 0),wN([Fc({type:Object})],_N.prototype,"permittedLabels",void 0),wN([Fc({type:Array})],_N.prototype,"orderedLabelValues",void 0),wN([Uc()],_N.prototype,"selectedValueText",void 0),_N=wN([Dc("gr-label-score-row")],_N);var xN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let CN=class extends Ic{static get styles(){return[Qb,Iw,Sd`
        gr-dialog {
          width: 840px;
        }
        .scoresTable {
          display: table;
          width: 100%;
        }
        .scoresTable.newSubmitRequirements {
          table-layout: fixed;
        }
        gr-label-score-row:hover {
          background-color: var(--hover-background-color);
        }
        gr-label-score-row {
          display: table-row;
        }
        /* TODO(dhruvsri): Consider using flex column with gap */
        .scoresTable:not(:first-of-type) {
          margin-top: var(--spacing-m);
        }
        .vote-type {
          margin-bottom: var(--spacing-s);
          margin-top: 0;
          display: table-caption;
        }
        .main-heading {
          margin-bottom: var(--spacing-m);
          font-weight: var(--font-weight-h2);
        }
        .error-container {
          background-color: var(--error-background);
          margin-top: var(--spacing-l);
        }
        .code-review-message-container gr-icon,
        .error-container gr-icon {
          padding: 10px var(--spacing-xl);
        }
        .error-container gr-icon {
          color: var(--error-foreground);
        }
        .code-review-message-container gr-icon {
          color: var(--selected-foreground);
        }
        .error-container .error-text,
        .code-review-message-container .warning-text {
          position: relative;
          top: 10px;
        }
        .code-review-message-container {
          display: table-caption;
          background-color: var(--code-review-warning-background);
          margin-bottom: var(--spacing-m);
        }
        .code-review-message-layout-container {
          display: flex;
        }
        .code-review-message-container gr-button {
          margin-top: 6px;
          margin-right: var(--spacing-xl);
        }
        .flex-space {
          flex-grow: 1;
        }
      `]}constructor(){super(),this.getBulkActionsModel=yu(this,eN),this.getUserModel=yu(this,jf),this.reportingService=Xn().reportingService,this.selectedChanges=[],this.progressByChange=new Map,zf(this,(()=>this.getBulkActionsModel().selectedChanges$),(e=>{this.selectedChanges=e,this.resetFlow()})),zf(this,(()=>this.getUserModel().account$),(e=>this.account=e))}render(){const e=this.computePermittedLabels(),t=this.computeCommonTriggerLabels(e),i=this.computeCommonPermittedLabels(e).filter((e=>!t.some((t=>t.name===e.name))));return dc`
      <gr-button id="voteFlowButton" flatten @click=${this.openModal}
        >Vote</gr-button
      >
      <dialog id="actionModal" tabindex="-1">
        <gr-dialog
          .disableCancel=${!this.isCancelEnabled()}
          .disabled=${this.isDisabled(t.length+i.length)}
          ?loading=${this.isLoading()}
          .loadingLabel=${"Voting in progress..."}
          @confirm=${()=>this.handleConfirm()}
          @cancel=${()=>this.handleClose()}
          .confirmLabel=${"Vote"}
          .cancelLabel=${"Cancel"}
        >
          <div slot="header">
            <span class="main-heading"> Vote on selected changes </span>
          </div>
          <div slot="main">
            ${this.renderLabels(i,"Submit requirements votes",e,!0)}
            ${this.renderLabels(t,"Trigger Votes",e)}
            ${this.renderErrors()}
          </div>
        </gr-dialog>
      </dialog>
    `}renderCodeReviewMessage(){return dc`
      <div class="code-review-message-container">
        <div class="code-review-message-layout-container">
          <div>
            <gr-icon icon="info" aria-label="Information" role="img"></gr-icon>
            <span class="warning-text">
              Code Review vote is only available on the individual change page
            </span>
          </div>
          <div class="flex-space"></div>
          <div>
            <gr-button
              aria-label=${`Open ${Ig(this.selectedChanges.length,"change")} in different tabs`}
              flatten
              link
              @click=${this.handleOpenChanges}
              >Open ${Ig(this.selectedChanges.length,"change")}
            </gr-button>
          </div>
        </div>
      </div>
    `}handleOpenChanges(){for(const e of this.selectedChanges)window.open(WC({change:e,usp:"bulk-vote"}))}openModal(){this.actionModal.showModal()}renderErrors(){return gN(this.progressByChange)!==lg.FAILED?uc:dc`
      <div class="error-container">
        <gr-icon icon="error" filled role="img" aria-label="Error"></gr-icon>
        <span class="error-text">
          <!-- prettier-ignore -->
          Failed to vote on ${Ig(Array.from(this.progressByChange.values()).filter((e=>e===lg.FAILED)).length,"change")}
        </span>
      </div>
    `}renderLabels(e,t,i,r){return dc` <div class="scoresTable newSubmitRequirements">
      <h3 class="heading-4 vote-type">${e.length?t:uc}</h3>
      ${r?this.renderCodeReviewMessage():uc}
      ${e.filter((e=>i?.[e.name]&&i?.[e.name].length>0)).map((e=>dc`<gr-label-score-row
            .label=${e}
            .name=${e.name}
            .labels=${this.computeLabelNameToInfoMap()}
            .permittedLabels=${i}
            .orderedLabelValues=${Av(i)}
          ></gr-label-score-row>`))}
    </div>`}resetFlow(){this.progressByChange=new Map(this.selectedChanges.map((e=>[e._number,lg.NOT_STARTED])))}isLoading(){return gN(this.progressByChange)===lg.RUNNING}isDisabled(e){return!(gN(this.progressByChange)===lg.NOT_STARTED&&e>0)}isCancelEnabled(){return gN(this.progressByChange)!==lg.RUNNING}handleClose(){this.actionModal.close(),gN(this.progressByChange)!==lg.NOT_STARTED&&aa(this)}async handleConfirm(){this.progressByChange.clear(),this.reportingService.reportInteraction(ga.BULK_ACTION,{type:"vote",selectedChangeCount:this.selectedChanges.length});const e={labels:this.getLabelValues(this.computeCommonPermittedLabels(this.computePermittedLabels()))};for(const e of this.selectedChanges)this.progressByChange.set(e._number,lg.RUNNING);this.requestUpdate();const t=this.getBulkActionsModel().voteChanges(e);await py(t.map(((e,t)=>{const i=this.selectedChanges[t]._number;return e.then((()=>{this.progressByChange.set(i,lg.SUCCESSFUL)})).catch((()=>{this.progressByChange.set(i,lg.FAILED)})).finally((()=>{this.requestUpdate(),gN(this.progressByChange)===lg.SUCCESSFUL&&(ea(this,"Votes added"),this.handleClose())}))}))),gN(this.progressByChange)===lg.FAILED&&this.reportingService.reportInteraction("bulk-action-failure",{type:"vote",count:Array.from(this.progressByChange.values()).filter((e=>e===lg.FAILED)).length})}getLabelValues(e){const t={};for(const i of e){const e=_a(this,`gr-label-score-row[name="${i.name}"]`);if(!e?.selectedItem)continue;const r="string"==typeof e.selectedValue?Number(e.selectedValue):e.selectedValue;void 0!==r&&(t[i.name]=r)}return t}computePermittedLabels(){if(0===this.selectedChanges.length)return{};const e=this.selectedChanges.map((e=>e.permitted_labels)).reduce(Tv);return e?.[rv.CODE_REVIEW]&&delete e[rv.CODE_REVIEW],e}computeLabelNameToInfoMap(){return 0===this.selectedChanges.length?{}:this.selectedChanges.map((e=>e.labels)).reduce(Rv)}computeCommonTriggerLabels(e){if(0===this.selectedChanges.length)return[];const t=this.selectedChanges.map((e=>Nv(e))).reduce(((e,t)=>t.filter((t=>e.some((e=>e===t))))));return this.computeCommonPermittedLabels(e).filter((e=>t.includes(e.name)))}computeCommonPermittedLabels(e){return 0===this.selectedChanges.length?[]:this.selectedChanges.map((e=>Pv(this.account,e))).reduce(((e,t)=>t.filter((t=>e.some((e=>e.name===t.name)))))).filter((t=>e?.[t.name]&&e?.[t.name].length>0))}};xN([Uc()],CN.prototype,"selectedChanges",void 0),xN([Uc()],CN.prototype,"progressByChange",void 0),xN([Hc("#actionModal")],CN.prototype,"actionModal",void 0),xN([Hc("gr-dialog")],CN.prototype,"dialog",void 0),xN([Uc()],CN.prototype,"account",void 0),CN=xN([Dc("gr-change-list-bulk-vote-flow")],CN);var EN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let SN=class extends Ic{static get styles(){return[Yc,Sd`
        md-menu {
          --md-menu-container-color: var(--dialog-background-color);
          --md-menu-top-space: 0px;
          --md-menu-bottom-space: 0px;
        }
        .dropdown-content {
          box-shadow: var(--elevation-level-2);
          width: 400px;
          border-radius: 4px;
          padding: var(--spacing-xl) var(--spacing-l) var(--spacing-l);
        }
        gr-autocomplete {
          --prominent-border-color: var(--gray-800);
        }
        .footer {
          display: flex;
          justify-content: space-between;
          align-items: baseline;
        }
        .buttons {
          padding-top: var(--spacing-m);
          display: flex;
          justify-content: flex-end;
          gap: var(--spacing-m);
        }
        .chips {
          display: flex;
          flex-wrap: wrap;
          gap: 6px;
        }
        .chip {
          padding: var(--spacing-s) var(--spacing-xl);
          border-radius: 10px;
          width: fit-content;
          cursor: pointer;
          color: var(--primary-text-color);
        }
        .chip:not(.selected) {
          border: var(--spacing-xxs) solid var(--border-color);
          background: none;
        }
        .chip.selected {
          border: 0;
          color: var(--selected-foreground);
          background-color: var(--selected-chip-background);
          margin: var(--spacing-xxs);
        }
        .loadingOrError {
          display: flex;
          align-items: baseline;
          gap: var(--spacing-s);
        }

        /* The basics of .loadingSpin are defined in spinnerStyles. */
        .loadingSpin {
          vertical-align: top;
          position: relative;
          top: 3px;
        }
        .error {
          color: var(--deemphasized-text-color);
        }
        gr-icon {
          color: var(--error-color);
          /* Center with text by aligning it to the top and then pushing it down
             to match the text */
          vertical-align: top;
          position: relative;
          top: 7px;
        }
        .dropdown {
          position: relative;
          display: inline-block;
        }
      `]}constructor(){super(),this.selectedChanges=[],this.topicToAdd="",this.existingTopicSuggestions=[],this.isDropdownOpen=!1,this.overallProgress=lg.NOT_STARTED,this.selectedExistingTopics=new Set,this.getBulkActionsModel=yu(this,eN),this.restApiService=Xn().restApiService,this.reportingService=Xn().reportingService,zf(this,(()=>this.getBulkActionsModel().selectedChanges$),(e=>{this.selectedChanges=e}))}render(){const e=0===this.selectedChanges.length;return dc`<div class="dropdown">
      <gr-button
        id="start-flow"
        flatten
        down-arrow
        @click=${this.toggleDropdown}
        ?disabled=${e}
        >Topic</gr-button
      >
      <md-menu
        anchor="start-flow"
        tabindex="-1"
        .quick=${!0}
        @opening=${()=>this.isDropdownOpen=!0}
        @closing=${()=>this.isDropdownOpen=!1}
      >
        ${eb(this.isDropdownOpen,(()=>dc`
            <div class="dropdown-content">
              ${eb(this.selectedChanges.some((e=>e.topic)),(()=>this.renderExistingTopicsMode()),(()=>this.renderNoExistingTopicsMode()))}
            </div>
          `))}
      </md-menu>
    </div> `}disableApplyToAllButton(){return 1!==this.selectedExistingTopics.size||!this.selectedChanges.map((e=>e.topic)).filter(Ca).some((e=>!e||!this.selectedExistingTopics.has(e)))}renderExistingTopicsMode(){const e=this.selectedChanges.map((e=>e.topic)).filter(cf).filter(Ca),t=0===this.selectedExistingTopics.size||this.overallProgress===lg.RUNNING;return dc`
      <div class="chips">
        ${e.map((e=>this.renderExistingTopicChip(e)))}
      </div>
      <div class="footer">
        <div class="loadingOrError" role="progressbar">
          ${this.renderLoadingOrError()}
        </div>
        <div class="buttons">
          ${eb(this.overallProgress!==lg.FAILED,(()=>dc` <gr-button
                id="apply-to-all-button"
                flatten
                ?disabled=${this.disableApplyToAllButton()}
                @click=${this.applyTopicToAll}
                >Apply${this.selectedChanges.length>1?" to all":uc}</gr-button
              >
              <gr-button
                id="remove-topics-button"
                flatten
                ?disabled=${t}
                @click=${this.removeTopics}
                >Remove</gr-button
              >`),(()=>dc`
                <gr-button
                  id="cancel-button"
                  flatten
                  @click=${this.closeDropdown}
                  >Cancel</gr-button
                >
              `))}
        </div>
      </div>
    `}renderExistingTopicChip(e){const t={chip:!0,selected:this.selectedExistingTopics.has(e)};return dc`
      <button
        role="listbox"
        aria-label=${`${e} selection`}
        class=${th(t)}
        @click=${()=>this.toggleExistingTopicSelected(e)}
      >
        ${e}
      </button>
    `}renderLoadingOrError(){switch(this.overallProgress){case lg.RUNNING:return dc`
          <span class="loadingSpin"></span>
          <span class="loadingText">${this.loadingText}</span>
        `;case lg.FAILED:return dc`
          <gr-icon icon="error" filled></gr-icon>
          <div class="error">${this.errorText}</div>
        `;default:return uc}}renderNoExistingTopicsMode(){const e=""===this.topicToAdd||this.overallProgress===lg.RUNNING;return dc`
      <!--
        The .query function needs to be bound to this because lit's autobind
        seems to work only for @event handlers.
        'this.getTopicSuggestions.bind(this)' gets in trouble with our linter
        even though the bind is necessary here, so an anonymous function is used
        instead.
      -->
      <gr-autocomplete
        .text=${this.topicToAdd}
        .query=${e=>this.getTopicSuggestions(e)}
        show-blue-focus-border
        placeholder="Type topic name to create or filter topics"
        @text-changed=${e=>this.topicToAdd=e.detail.value}
      ></gr-autocomplete>
      <div class="footer">
        <div class="loadingOrError" role="progressbar">
          ${this.renderLoadingOrError()}
        </div>
        <div class="buttons">
          ${eb(this.overallProgress!==lg.FAILED,(()=>dc`
              <gr-button
                id="set-topic-button"
                flatten
                @click=${()=>this.setTopic("Setting topic...")}
                .disabled=${e}
                >Set Topic</gr-button
              >
            `),(()=>dc`
              <gr-button id="cancel-button" flatten @click=${this.closeDropdown}
                >Cancel</gr-button
              >
            `))}
        </div>
      </div>
    `}toggleDropdown(){this.isDropdownOpen?this.closeDropdown():this.openDropdown()}reset(){this.topicToAdd="",this.selectedExistingTopics=new Set,this.overallProgress=lg.NOT_STARTED,this.errorText=void 0}closeDropdown(){this.isDropdownOpen=!1,this.dropdown?.close()}openDropdown(){this.reset(),this.isDropdownOpen=!0,this.dropdown?.show()}async getTopicSuggestions(e){const t=await this.restApiService.getChangesWithSimilarTopic(e,Ff);return this.existingTopicSuggestions=(t??[]).map((e=>e.topic)).filter(cf).filter(Ca),this.existingTopicSuggestions.map((e=>({name:e,value:e})))}removeTopics(){this.reportingService.reportInteraction(ga.BULK_ACTION,{type:"removing-topic",selectedChangeCount:this.selectedChanges.length}),this.loadingText=`Removing topic${this.selectedExistingTopics.size>1?"s":""}...`,this.trackPromises(this.selectedChanges.filter((e=>e.topic&&this.selectedExistingTopics.has(e.topic))).map((e=>this.restApiService.removeChangeTopic(e._number,Ff))),`${this.selectedChanges[0].topic} removed from changes`,"Failed to remove topic")}applyTopicToAll(){this.reportingService.reportInteraction(ga.BULK_ACTION,{type:"apply-topic-to-all",selectedChangeCount:this.selectedChanges.length}),this.loadingText="Applying to all";const e=Array.from(this.selectedExistingTopics.values())[0];this.trackPromises(this.selectedChanges.map((t=>this.restApiService.setChangeTopic(t._number,e,Ff))),`${e} applied to all changes`,"Failed to apply topic")}setTopic(e){this.reportingService.reportInteraction(ga.BULK_ACTION,{type:"add-topic",selectedChangeCount:this.selectedChanges.length});const t=`${Ig(this.selectedChanges.length,"Change")} added to ${this.topicToAdd}`;this.loadingText=e,this.trackPromises(this.selectedChanges.map((e=>this.restApiService.setChangeTopic(e._number,this.topicToAdd,Ff))),t,"Failed to set topic")}async trackPromises(e,t,i){this.overallProgress=lg.RUNNING,(await py(e)).every((e=>"fulfilled"===e.status))?(this.overallProgress=lg.SUCCESSFUL,this.closeDropdown(),t&&ea(this,t),aa(this)):(this.overallProgress=lg.FAILED,this.errorText=i)}toggleExistingTopicSelected(e){this.selectedExistingTopics.has(e)?this.selectedExistingTopics.delete(e):this.selectedExistingTopics.add(e),this.requestUpdate()}};EN([Uc()],SN.prototype,"selectedChanges",void 0),EN([Uc()],SN.prototype,"topicToAdd",void 0),EN([Uc()],SN.prototype,"existingTopicSuggestions",void 0),EN([Uc()],SN.prototype,"loadingText",void 0),EN([Uc()],SN.prototype,"errorText",void 0),EN([Uc()],SN.prototype,"isDropdownOpen",void 0),EN([Uc()],SN.prototype,"overallProgress",void 0),EN([Hc("md-menu")],SN.prototype,"dropdown",void 0),SN=EN([Dc("gr-change-list-topic-flow")],SN);var $N=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let kN=class extends Ic{static get styles(){return[Yc,Sd`
        md-menu {
          --md-menu-container-color: var(--dialog-background-color);
          --md-menu-top-space: 0px;
          --md-menu-bottom-space: 0px;
        }
        .dropdown-content {
          box-shadow: var(--elevation-level-2);
          width: 400px;
          border-radius: 4px;
          padding: var(--spacing-xl) var(--spacing-l) var(--spacing-l);
        }
        gr-autocomplete {
          --prominent-border-color: var(--gray-800);
        }
        .footer {
          display: flex;
          justify-content: space-between;
          align-items: baseline;
        }
        .buttons {
          padding-top: var(--spacing-m);
          display: flex;
          justify-content: flex-end;
          gap: var(--spacing-m);
        }
        .chips {
          display: flex;
          flex-wrap: wrap;
          gap: 6px;
          padding-bottom: var(--spacing-l);
        }
        .chip {
          padding: var(--spacing-s) var(--spacing-xl);
          border-radius: 10px;
          width: fit-content;
          cursor: pointer;
          color: var(--primary-text-color);
        }
        .chip:not(.selected) {
          border: var(--spacing-xxs) solid var(--border-color);
          background: none;
        }
        .chip.selected {
          border: 0;
          color: var(--selected-foreground);
          background-color: var(--selected-chip-background);
          margin: var(--spacing-xxs);
        }
        .loadingOrError {
          display: flex;
          gap: var(--spacing-s);
          align-items: baseline;
        }

        /* The basics of .loadingSpin are defined in spinnerStyles. */
        .loadingSpin {
          vertical-align: top;
          position: relative;
          top: 3px;
        }
        .error {
          color: var(--deemphasized-text-color);
        }
        gr-icon {
          color: var(--error-color);
          /* Center with text by aligning it to the top and then pushing it down
             to match the text */
          vertical-align: top;
          position: relative;
          top: 7px;
        }
        .dropdown {
          position: relative;
          display: inline-block;
        }
      `]}constructor(){super(),this.selectedChanges=[],this.hashtagToAdd="",this.existingHashtagSuggestions=[],this.isDropdownOpen=!1,this.overallProgress=lg.NOT_STARTED,this.selectedExistingHashtags=new Set,this.getBulkActionsModel=yu(this,eN),this.restApiService=Xn().restApiService,this.reportingService=Xn().reportingService,zf(this,(()=>this.getBulkActionsModel().selectedChanges$),(e=>{this.selectedChanges=e}))}render(){const e=0===this.selectedChanges.length;return dc`<div class="dropdown">
      <gr-button
        id="start-flow"
        flatten
        down-arrow
        @click=${this.toggleDropdown}
        ?disabled=${e}
        >Hashtag</gr-button
      >
      <md-menu
        anchor="start-flow"
        tabindex="-1"
        .quick=${!0}
        @opening=${()=>this.isDropdownOpen=!0}
        @closing=${()=>this.isDropdownOpen=!1}
      >
        ${eb(this.isDropdownOpen,(()=>dc`
            <div class="dropdown-content">
              ${this.renderExistingHashtags()}
              <!--
                The .query function needs to be bound to this because lit's
                autobind seems to work only for @event handlers.
              -->
              <gr-autocomplete
                .text=${this.hashtagToAdd}
                .query=${e=>this.getHashtagSuggestions(e)}
                show-blue-focus-border
                placeholder="Type hashtag name to create or filter hashtags"
                @text-changed=${e=>this.hashtagToAdd=e.detail.value}
              ></gr-autocomplete>
              <div class="footer">
                <div class="loadingOrError" role="progressbar">
                  ${this.renderLoadingOrError()}
                </div>
                <div class="buttons">
                  ${eb(this.overallProgress!==lg.FAILED,(()=>dc`
                      <gr-button
                        id="add-hashtag-button"
                        flatten
                        @click=${()=>this.applyHashtags("Adding hashtag...")}
                        .disabled=${this.isAddHashtagDisabled()}
                        >Add Hashtag</gr-button
                      >
                    `),(()=>dc`
                      <gr-button
                        id="cancel-button"
                        flatten
                        @click=${this.closeDropdown}
                        >Cancel</gr-button
                      >
                    `))}
                </div>
              </div>
            </div>
          `))}
      </md-menu>
    </div> `}renderExistingHashtags(){const e=this.selectedChanges.flatMap((e=>e.hashtags??[])).filter(cf).filter(Ca);return dc`
      <div class="chips">
        ${e.map((e=>this.renderExistingHashtagChip(e)))}
      </div>
    `}renderExistingHashtagChip(e){const t={chip:!0,selected:this.selectedExistingHashtags.has(e)};return dc`
      <button
        role="listbox"
        aria-label=${`${e} selection`}
        class=${th(t)}
        @click=${()=>this.toggleExistingHashtagSelected(e)}
      >
        ${e}
      </button>
    `}renderLoadingOrError(){switch(this.overallProgress){case lg.RUNNING:return dc`
          <span class="loadingSpin"></span>
          <span class="loadingText">${this.loadingText}</span>
        `;case lg.FAILED:return dc`
          <gr-icon icon="error" filled></gr-icon>
          <div class="error">${this.errorText}</div>
        `;default:return uc}}isAddHashtagDisabled(){return[...this.selectedExistingHashtags.values(),...""===this.hashtagToAdd?[]:[this.hashtagToAdd]].every((e=>this.selectedChanges.every((t=>t.hashtags?.includes(e)))))||this.overallProgress===lg.RUNNING}toggleDropdown(){this.isDropdownOpen?this.closeDropdown():this.openDropdown()}reset(){this.hashtagToAdd="",this.selectedExistingHashtags=new Set,this.overallProgress=lg.NOT_STARTED,this.errorText=void 0}closeDropdown(){this.isDropdownOpen=!1,this.dropdown?.close()}openDropdown(){this.reset(),this.isDropdownOpen=!0,this.dropdown?.show()}async getHashtagSuggestions(e){const t=await this.restApiService.getChangesWithSimilarHashtag(e,Ff);return this.existingHashtagSuggestions=(t??[]).flatMap((e=>e.hashtags??[])).filter(cf).filter(Ca),this.existingHashtagSuggestions.map((e=>({name:e,value:e})))}applyHashtags(e){let t="";const i=[...this.selectedExistingHashtags.values(),...""===this.hashtagToAdd?[]:[this.hashtagToAdd]];t=i.length>1?`${i.length} hashtags added to changes`:`${Ig(this.selectedChanges.length,"Change")} added to ${i[0]}`,this.reportingService.reportInteraction(ga.BULK_ACTION,{type:"add-hashtag",selectedChangeCount:this.selectedChanges.length,hashtagsApplied:i.length}),this.loadingText=e,this.trackPromises(this.getBulkActionsModel().addHashtags(i),t,"Failed to add")}async trackPromises(e,t,i){this.overallProgress=lg.RUNNING,(await py(e)).every((e=>"fulfilled"===e.status))?(this.overallProgress=lg.SUCCESSFUL,ea(this,t),this.reset()):(this.overallProgress=lg.FAILED,this.errorText=i)}toggleExistingHashtagSelected(e){this.selectedExistingHashtags.has(e)?this.selectedExistingHashtags.delete(e):this.selectedExistingHashtags.add(e),this.requestUpdate()}};$N([Uc()],kN.prototype,"selectedChanges",void 0),$N([Uc()],kN.prototype,"hashtagToAdd",void 0),$N([Uc()],kN.prototype,"existingHashtagSuggestions",void 0),$N([Uc()],kN.prototype,"loadingText",void 0),$N([Uc()],kN.prototype,"errorText",void 0),$N([Uc()],kN.prototype,"isDropdownOpen",void 0),$N([Uc()],kN.prototype,"overallProgress",void 0),$N([Hc("md-menu")],kN.prototype,"dropdown",void 0),kN=$N([Dc("gr-change-list-hashtag-flow")],kN);var AN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let RN=class extends Ic{static get styles(){return[Iw,Sd`
        section {
          padding: var(--spacing-l);
        }
      `]}constructor(){super(),this.getBulkActionsModel=yu(this,eN),this.selectedChanges=[],this.progress=new Map,zf(this,(()=>this.getBulkActionsModel().selectedChanges$),(e=>this.selectedChanges=e))}render(){return dc`
      <gr-button
        id="abandon"
        flatten
        .disabled=${!this.isEnabled()}
        @click=${()=>this.actionModal.showModal()}
        >Abandon</gr-button
      >
      <dialog id="actionModal" tabindex="-1">
        <gr-dialog
          .disableCancel=${!this.isCancelEnabled()}
          .disabled=${this.isDisabled()}
          @confirm=${()=>this.handleConfirm()}
          @cancel=${()=>this.handleClose()}
          .cancelLabel=${"Close"}
        >
          <div slot="header">
            ${this.selectedChanges.length} changes to abandon
          </div>
          <div slot="main">
            <table>
              <thead>
                <tr>
                  <th>Subject</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                ${this.selectedChanges.map((e=>dc`
                    <tr>
                      <td>Change: ${e.subject}</td>
                      <td id="status">
                        Status: ${this.getStatus(e._number)}
                      </td>
                    </tr>
                  `))}
              </tbody>
            </table>
          </div>
        </gr-dialog>
      </dialog>
    `}getStatus(e){return this.progress.has(e)?this.progress.get(e):lg.NOT_STARTED}isEnabled(){return this.selectedChanges.every((e=>!!e.actions?.abandon||e.status===Nu.ABANDONED))}isDisabled(){for(const e of this.progress.values())if(e!==lg.NOT_STARTED)return!0;return!1}isCancelEnabled(){for(const e of this.progress.values())if(e===lg.RUNNING)return!1;return!0}handleConfirm(){this.progress.clear();for(const e of this.selectedChanges)this.progress.set(e._number,lg.RUNNING);this.requestUpdate();const e=this.getBulkActionsModel().abandonChanges("",(e=>{throw new Error(`request for ${e} failed`)}));for(let t=0;t<e.length;t++){const i=this.selectedChanges[t]._number;e[t].then((()=>{this.progress.set(i,lg.SUCCESSFUL),this.requestUpdate()})).catch((()=>{this.progress.set(i,lg.FAILED),this.requestUpdate()}))}}handleClose(){this.actionModal.close(),ea(this,"Reloading page.."),aa(this)}};AN([Uc()],RN.prototype,"selectedChanges",void 0),AN([Uc()],RN.prototype,"progress",void 0),AN([Hc("#actionModal")],RN.prototype,"actionModal",void 0),RN=AN([Dc("gr-change-list-bulk-abandon-flow")],RN);var TN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let IN=class extends Ic{constructor(){super(...arguments),this.copyClipboardRef=ER(),this.copyLinks=[],this.horizontalAlign="left",this.shortcutPrefix="l - ",this.verticalOffset=10,this.isDropdownOpen=!1,this.onWindowResize=()=>{this.dropdown?.reposition()}}static get styles(){return[vy,Sd`
        md-menu {
          white-space: nowrap;
          --md-menu-container-color: var(--dialog-background-color);
          --md-menu-top-space: 0px;
          --md-menu-bottom-space: 0px;
        }
        .dropdown-content {
          width: min(90vw, 640px);
          padding: var(--spacing-m) var(--spacing-l) var(--spacing-m);
          box-shadow: var(--elevation-level-2);
          border-radius: var(--border-radius);
        }
        .copy-link-row {
          margin-bottom: var(--spacing-m);
        }
        gr-copy-clipboard::part(text-container-wrapper-style) {
          flex: 1 1 420px;
        }
      `]}connectedCallback(){super.connectedCallback(),this.isDropdownOpen&&this.setUpGlobalEventListeners()}updated(e){e.has("isDropdownOpen")&&(this.isDropdownOpen?this.setUpGlobalEventListeners():this.cleanUpGlobalEventListeners())}setUpGlobalEventListeners(){const e={passive:!0};window.addEventListener("resize",this.onWindowResize,e),window.addEventListener("scroll",this.onWindowResize,e)}cleanUpGlobalEventListeners(){const e={passive:!0};window.removeEventListener("resize",this.onWindowResize,e),window.removeEventListener("scroll",this.onWindowResize,e)}render(){return this.copyLinks?dc`<md-menu
      default-focus="none"
      tabindex="-1"
      .menuCorner=${"left"===this.horizontalAlign?"start-start":"end-start"}
      ?quick=${!0}
      .yOffset=${this.verticalOffset}
      @opened=${()=>{this.isDropdownOpen=!0}}
      @closed=${()=>{this.isDropdownOpen=!1}}
      @keydown=${this.handleKeydown}
    >
      ${this.renderCopyLinks()}
    </md-menu> `:uc}renderCopyLinks(){return dc`<div class="dropdown-content">
      ${this.copyLinks?.map(((e,t)=>this.renderCopyLinkRow(e,t)))}
    </div>`}renderCopyLinkRow(e,t){const{label:i,shortcut:r,value:o,multiline:s}=e,n=`${Nn(i,"")}-field`;return dc`<div class="copy-link-row">
      <gr-copy-clipboard
        text=${o}
        label=${i}
        shortcut=${`${this.shortcutPrefix}${r}`}
        id=${`${n}-copy-clipboard`}
        nowrap
        ?multiline=${!!s}
        ${0===t&&kR(this.copyClipboardRef)}
      ></gr-copy-clipboard>
    </div>`}async handleKeydown(e){const t=this.copyLinks?.find((t=>t.shortcut===e.key));t&&(await Sa(t.value,t.label),this.closeDropdown())}toggleDropdown(e){e&&(this.dropdown.anchorElement=e),this.isDropdownOpen?this.closeDropdown():this.openDropdown()}closeDropdown(){this.dropdown?.close()}openDropdown(e){e&&(this.dropdown.anchorElement=e),this.dropdown?.show(),this.awaitOpen((()=>{this.copyClipboardRef?.value&&_a(this.copyClipboardRef.value,"md-outlined-text-field")?.select()}))}awaitOpen(e){let t=0;const i=()=>{setTimeout((()=>{"none"!==this.dropdown?.style.display?e.call(this):t++<10&&i.call(this)}),5)};i.call(this)}};TN([Fc({type:Array})],IN.prototype,"copyLinks",void 0),TN([Fc({type:String})],IN.prototype,"horizontalAlign",void 0),TN([Fc({type:String})],IN.prototype,"shortcutPrefix",void 0),TN([Fc({type:Number})],IN.prototype,"verticalOffset",void 0),TN([Uc()],IN.prototype,"isDropdownOpen",void 0),TN([Hc("md-menu")],IN.prototype,"dropdown",void 0),IN=TN([Dc("gr-copy-links")],IN);var PN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let NN=class extends Ic{static get styles(){return Sd`
      :host {
        display: inline-block;
        position: relative;
      }
      gr-button {
        margin-right: var(--spacing-s);
      }
      .copyLinkWrapper {
        position: relative;
      }
    `}constructor(){super(),this.selectedChangeNums=[],this.selectedChanges=[],this.getBulkActionsModel=yu(this,eN),zf(this,(()=>this.getBulkActionsModel().selectedChangeNums$),(e=>this.selectedChangeNums=e)),zf(this,(()=>this.getBulkActionsModel().selectedChanges$),(e=>this.selectedChanges=e))}getCopyLinks(){return 0===this.selectedChangeNums.length?[]:[{label:"Change Query URL",shortcut:"u",value:Af(`/q/${this.selectedChangeNums.map((e=>`change:${e}`)).join("+OR+")}`)},{label:"Markdown",shortcut:"m",value:this.selectedChanges.map((e=>{const t=Af(`/c/${e._number}`);return`[${e.subject}](${t})`})).join("\n"),multiline:!0}]}render(){return 0===this.selectedChangeNums.length?uc:dc`
      <div class="copyLinkWrapper">
        <gr-button
          id="copyLinkButton"
          link
          @click=${e=>{this.copyLinks?.toggleDropdown(e.target)}}
        >
          Copy Link
        </gr-button>
        <gr-copy-links
          .copyLinks=${this.getCopyLinks()}
          .horizontalAlign=${"right"}
          .verticalOffset=${30}
          .shortcutPrefix=${""}
        ></gr-copy-links>
      </div>
    `}};PN([Hc("gr-copy-links")],NN.prototype,"copyLinks",void 0),PN([Uc()],NN.prototype,"selectedChangeNums",void 0),PN([Uc()],NN.prototype,"selectedChanges",void 0),NN=PN([Dc("gr-change-list-copy-link-flow")],NN);var ON=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let DN=class extends Ic{static get styles(){return Sd`
      :host {
        display: contents;
      }
      td {
        padding: 0;
      }
      .container {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .actionButtons {
        margin-right: var(--spacing-l);
      }
    `}constructor(){super(),this.numSelected=0,this.getBulkActionsModel=yu(this,eN),zf(this,(()=>this.getBulkActionsModel().selectedChangeNums$),(e=>this.numSelected=e.length))}render(){const e=`${Ig(this.numSelected,"change")} selected`;return dc`
      <!--
        500 chosen to be more than the actual number of columns but less than
        1000 where the browser apparently decides it is an error and reverts
        back to colspan="1"
      -->
      <td colspan="500">
        <div class="container">
          <div class="selectionInfo">
            ${this.numSelected?dc`<span>${e}</span>`:uc}
          </div>
          <div class="actionButtons">
            <gr-change-list-bulk-vote-flow></gr-change-list-bulk-vote-flow>
            <gr-change-list-topic-flow></gr-change-list-topic-flow>
            <gr-change-list-hashtag-flow></gr-change-list-hashtag-flow>
            <gr-change-list-reviewer-flow></gr-change-list-reviewer-flow>
            <gr-change-list-bulk-abandon-flow></gr-change-list-bulk-abandon-flow>
            <gr-change-list-copy-link-flow></gr-change-list-copy-link-flow>
          </div>
        </div>
      </td>
    `}};ON([Uc()],DN.prototype,"numSelected",void 0),DN=ON([Dc("gr-change-list-action-bar")],DN);const LN=/\${user}/g,MN={name:"Your turn",query:"attention:${user}",hideIfEmpty:!1,suffixForDashboard:"limit:25"},FN={name:"Outgoing reviews",query:"is:open owner:${user} -is:wip",suffixForDashboard:"limit:25"},UN={name:"Recently closed",query:"is:closed (-is:wip OR owner:self) (owner:${user} OR reviewer:${user} OR cc:${user})",suffixForDashboard:"-age:4w limit:10"},BN=[{name:"Has draft comments",query:"has:draft",selfOnly:!0,hideIfEmpty:!0,suffixForDashboard:"limit:10"},MN,{name:"Work in progress",query:"is:open owner:${user} is:wip",selfOnly:!0,hideIfEmpty:!0,suffixForDashboard:"limit:25"},FN,{name:"Incoming reviews",query:"is:open -owner:${user} -is:wip reviewer:${user}",suffixForDashboard:"limit:25"},{name:"CCed on",query:"is:open -is:wip cc:${user}",suffixForDashboard:"limit:10"},UN];var HN;!function(e){e.OWNER="Owner",e.REVIEWERS="Reviewers",e.REPO_BRANCH="Repo | Branch",e.SUBMITTED="Submitted",e.PARENT="Parent",e.MERGED_AS="Merged as",e.REVERT_CREATED_AS="Revert Created as",e.STRATEGY="Strategy",e.UPDATED="Updated",e.CC="CC",e.HASHTAGS="Hashtags",e.TOPIC="Topic",e.UPLOADER="Uploader",e.AUTHOR="Author",e.COMMITTER="Committer",e.CHERRY_PICK_OF="Cherry pick of",e.REVERT_OF="Revert of"}(HN||(HN={}));const jN={ALWAYS_SHOW:[HN.OWNER,HN.REVIEWERS,HN.REPO_BRANCH,HN.SUBMITTED,HN.TOPIC],SHOW_IF_SET:[HN.CC,HN.HASHTAGS,HN.UPLOADER,HN.AUTHOR,HN.COMMITTER,HN.CHERRY_PICK_OF,HN.REVERT_OF],ALWAYS_HIDE:[HN.PARENT,HN.MERGED_AS,HN.REVERT_CREATED_AS,HN.STRATEGY,HN.UPDATED]};function GN(e,t){switch(e){case HN.CC:return!!t?.reviewers?.CC?.length;case HN.HASHTAGS:return!!t?.hashtags?.length;case HN.TOPIC:return!!t?.topic;case HN.UPLOADER:case HN.AUTHOR:case HN.COMMITTER:return!1;case HN.CHERRY_PICK_OF:return!!t?.cherry_pick_of_change}return!0}var zN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const VN=["limit:","age:","-age:"];let WN=class extends Ic{static get styles(){return[Nc,QP,Qb,vy,Jy,Sd`
        :host {
          display: contents;
        }
        .section-count-label {
          color: var(--deemphasized-text-color);
          font-family: var(--font-family);
          font-size: var(--font-size-small);
          font-weight: var(--font-weight-normal);
          line-height: var(--line-height-small);
        }
        /*
         * checkbox styles match checkboxes in <gr-change-list-item> rows to
         * vertically align with them.
         */
        input.selection-checkbox {
          background-color: var(--background-color-primary);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          box-sizing: border-box;
          color: var(--primary-text-color);
          margin: 0px;
          padding: var(--spacing-s);
          vertical-align: middle;
        }
        .showSelectionBorder {
          border-bottom: 2px solid var(--input-focus-border-color);
        }
        md-checkbox {
          --md-checkbox-container-size: 15px;
          --md-checkbox-icon-size: 15px;
        }
      `]}constructor(){super(),this.labelNames=[],this.isCursorMoving=!1,this.startIndex=0,this.numSelected=0,this.totalChangeCount=0,this.bulkActionsModel=new rN(Xn().restApiService),this.getUserModel=yu(this,jf),this.isLoggedIn=!1,bu(this,eN,(()=>this.bulkActionsModel)),zf(this,(()=>this.bulkActionsModel.selectedChangeNums$),(e=>{this.numSelected=e.length})),zf(this,(()=>this.bulkActionsModel.totalChangeCount$),(e=>this.totalChangeCount=e)),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.isLoggedIn=e))}willUpdate(e){e.has("changeSection")&&this.isLoggedIn&&this.bulkActionsModel.sync(this.changeSection.results)}render(){const e=this.computeColumns(),t=this.computeColspan(e);return dc`
      <tbody>
        <tr class="groupGap"></tr>
      </tbody>
      ${this.renderSectionHeader(t)}
      <tbody class="groupContent">
        ${this.isEmpty()?this.renderNoChangesRow(t):this.renderColumnHeaders(e)}
        ${this.changeSection.results.map(((t,i)=>this.renderChangeRow(t,i,e)))}
      </tbody>
    `}renderNoChangesRow(e){return dc`
      <tr class="noChanges">
        <td class="leftPadding" aria-hidden="true"></td>
        <td
          class="star"
          aria-hidden=${!this.isLoggedIn}
          ?hidden=${!this.isLoggedIn}
        ></td>
        <td class="cell" colspan=${e}>
          ${this.changeSection.emptyStateSlotName?dc`<slot name=${this.changeSection.emptyStateSlotName}></slot>`:"No changes"}
        </td>
      </tr>
    `}renderSectionHeader(e){if(void 0!==this.changeSection.name&&void 0!==this.changeSection.countLabel&&void 0!==this.changeSection.query)return dc`
      <tbody>
        <tr class="groupHeader">
          <td aria-hidden="true" class="leftPadding"></td>
          <td aria-hidden="true" class="star" ?hidden=${!this.isLoggedIn}></td>
          <td class="cell" colspan=${e}>
            <h2 class="heading-2">
              <a
                href=${this.sectionHref(this.changeSection.query)}
                class="section-title"
              >
                <span class="section-name">${this.changeSection.name}</span>
                <span class="section-count-label"
                  >${this.changeSection.countLabel}</span
                >
              </a>
            </h2>
          </td>
        </tr>
      </tbody>
    `}renderColumnHeaders(e){const t=this.numSelected>0;return dc`
      <tr
        class=${th({groupTitle:!0,showSelectionBorder:t})}
      >
        <td class="leftPadding"></td>
        ${this.renderSelectionHeader()}
        ${t?dc`<gr-change-list-action-bar></gr-change-list-action-bar>`:dc` <td
                class="star"
                aria-label="Star status column"
                ?hidden=${!this.isLoggedIn}
              ></td>
              <td class="number" ?hidden=${!this.showNumber}>#</td>
              ${e.map((e=>this.renderHeaderCell(e)))}
              ${this.labelNames?.map((e=>this.renderLabelHeader(e)))}
              ${this.dynamicHeaderEndpoints?.map((e=>this.renderEndpointHeader(e)))}`}
      </tr>
    `}renderSelectionHeader(){const e=this.numSelected>0,t=this.numSelected>0&&this.numSelected!==this.totalChangeCount;return dc`
      <td class="selection" ?hidden=${!this.isLoggedIn}>
        <md-checkbox
          class="selection-checkbox"
          ?checked=${e}
          .indeterminate=${t}
          @change=${this.handleSelectAllCheckboxClicked}
        ></md-checkbox>
      </td>
    `}renderHeaderCell(e){return dc`<td class=${e.toLowerCase()}>${e}</td>`}renderLabelHeader(e){return dc`
      <td class="label" title=${e}>
        ${function(e){return e.startsWith("Invalid-Prolog-Rules-Label-Name--")&&(e=e.slice(33)),e.split("-").reduce(((e,t)=>t?e+t[0].toUpperCase():e),"").slice(0,5)}(e)}
      </td>
    `}renderEndpointHeader(e){return dc`
      <td class="endpoint">
        <gr-endpoint-decorator .name=${e}></gr-endpoint-decorator>
      </td>
    `}renderChangeRow(e,t,i){const r=this.computeAriaLabel(e),o=this.computeItemSelected(t);return dc`
      <gr-change-list-item
        tabindex="0"
        .loggedInUser=${this.loggedInUser}
        .dashboardUser=${this.dashboardUser}
        .selected=${o}
        .change=${e}
        .sectionName=${this.changeSection.name}
        .visibleChangeTableColumns=${i}
        .showNumber=${!!this.showNumber}
        .usp=${this.usp}
        .labelNames=${this.labelNames}
        .globalIndex=${this.startIndex+t}
        .triggerSelectionCallback=${this.triggerSelectionCallback}
        aria-label=${r}
        role="button"
      ></gr-change-list-item>
    `}handleSelectAllCheckboxClicked(){0===this.numSelected?this.bulkActionsModel.selectAll():this.bulkActionsModel.clearSelectedChangeNums()}computeColumns(){const e=this.changeSection;if(!e||!this.visibleChangeTableColumns)return[];const t=[...this.visibleChangeTableColumns],i=t.indexOf(HN.UPDATED);return e.name===MN.name&&-1!==i&&(t[i]=Sg),e.name===UN.name&&-1!==i&&(t[i]=HN.SUBMITTED),t}toggleChange(e){this.bulkActionsModel.toggleSelectedChangeNum(this.changeSection.results[e]._number)}computeItemSelected(e){return e===this.selectedIndex}computeColspan(e){return e&&this.labelNames?e.length+this.labelNames.length+4:1}processQuery(e){let t=e.split(" ");return t=t.filter((e=>!VN.some((t=>e.startsWith(t))))),t.join(" ")}sectionHref(e){return e?tE({query:this.processQuery(e)}):""}isEmpty(){return!this.changeSection.results?.length}computeAriaLabel(e){const t=this.changeSection.name;return e?e.subject+(t?`, section: ${t}`:""):""}};zN([Fc({type:Array})],WN.prototype,"visibleChangeTableColumns",void 0),zN([Fc({type:Boolean})],WN.prototype,"showNumber",void 0),zN([Fc({type:Number})],WN.prototype,"selectedIndex",void 0),zN([Fc({type:Array})],WN.prototype,"labelNames",void 0),zN([Fc({type:Array})],WN.prototype,"dynamicHeaderEndpoints",void 0),zN([Fc({type:Object})],WN.prototype,"changeSection",void 0),zN([Fc({type:Boolean})],WN.prototype,"isCursorMoving",void 0),zN([Fc({type:Object})],WN.prototype,"loggedInUser",void 0),zN([Fc({type:String})],WN.prototype,"dashboardUser",void 0),zN([Fc({type:String})],WN.prototype,"usp",void 0),zN([Fc({type:Number})],WN.prototype,"startIndex",void 0),zN([Fc({type:Function})],WN.prototype,"triggerSelectionCallback",void 0),zN([Uc()],WN.prototype,"numSelected",void 0),zN([Uc()],WN.prototype,"totalChangeCount",void 0),WN=zN([Dc("gr-change-list-section")],WN);var qN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let KN=class extends Ic{constructor(){super(),this.sections=[],this.selectedIndex=0,this.showReviewedState=!1,this.isCursorMoving=!1,this.shortcuts=new Gg(this),this.getConfigModel=yu(this,Qw),this.getPluginLoader=yu(this,U_),this.getNavigation=yu(this,gy),this.getUserModel=yu(this,jf),this.cursor=new qb,this.cursor.scrollMode=cg.KEEP_VISIBLE,this.cursor.focusOnMove=!0,this.shortcuts.addAbstract(pu.CURSOR_NEXT_CHANGE,(()=>this.nextChange())),this.shortcuts.addAbstract(pu.CURSOR_PREV_CHANGE,(()=>this.prevChange())),this.shortcuts.addAbstract(pu.NEXT_PAGE,(()=>this.nextPage())),this.shortcuts.addAbstract(pu.PREV_PAGE,(()=>this.prevPage())),this.shortcuts.addAbstract(pu.OPEN_CHANGE,(()=>this.openChange())),this.shortcuts.addAbstract(pu.TOGGLE_CHANGE_STAR,(()=>this.toggleChangeStar())),this.shortcuts.addAbstract(pu.REFRESH_CHANGE_LIST,(()=>this.refreshChangeList())),this.shortcuts.addAbstract(pu.TOGGLE_CHECKBOX,(()=>this.toggleCheckbox())),this.shortcuts.addGlobal({key:Mn.ENTER},(()=>this.openChange())),zf(this,(()=>this.getUserModel().preferences$),(e=>this.preferences=e)),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.config=e}))}connectedCallback(){super.connectedCallback(),this.getPluginLoader().awaitPluginsLoaded().then((()=>{this.dynamicHeaderEndpoints=this.getPluginLoader().pluginEndPoints.getDynamicEndpoints("change-list-header")}))}disconnectedCallback(){this.cursor.unsetCursor(),super.disconnectedCallback()}static get styles(){return[QP,Qb,Nc,Sd`
        :host {
          display: block;
          padding: 0 8px;
          box-sizing: border-box;
        }
        #changeList {
          border-collapse: separate;
          width: 100%;
        }
        .section-count-label {
          color: var(--deemphasized-text-color);
          font-family: var(--font-family);
          font-size: var(--font-size-small);
          font-weight: var(--font-weight-normal);
          line-height: var(--line-height-small);
        }
        a.section-title:hover {
          text-decoration: none;
        }
        a.section-title:hover .section-count-label {
          text-decoration: none;
        }
        a.section-title:hover .section-name {
          text-decoration: underline;
        }
      `]}render(){if(!this.sections)return;const e=this.computeLabelNames(this.sections),t=this.calculateStartIndices(this.sections);return dc`
      <table id="changeList">
        ${this.sections.map(((i,r)=>this.renderSection(i,r,e,t[r])))}
      </table>
    `}calculateStartIndices(e){const t=Array.from({length:e.length}).fill(0);for(let i=1;i<e.length;++i)t[i]=t[i-1]+e[i-1].results.length;return t}renderSection(e,t,i,r){return dc`
      <gr-change-list-section
        .changeSection=${e}
        .labelNames=${i}
        .dynamicHeaderEndpoints=${this.dynamicHeaderEndpoints}
        .isCursorMoving=${this.isCursorMoving}
        .loggedInUser=${this.loggedInUser}
        .dashboardUser=${this.dashboardUser}
        .selectedIndex=${function(e,t,i){if(void 0!==e&&void 0!==t&&void 0!==i){for(let r=0;r<t;r++)e-=i[r].results.length;if(!(e<0))return e<i[t].results.length?e:void 0}}(this.selectedIndex,t,this.sections)}
        .showNumber=${this.showNumber}
        .visibleChangeTableColumns=${this.visibleChangeTableColumns}
        .usp=${this.usp}
        .startIndex=${r}
        .triggerSelectionCallback=${e=>{this.selectedIndex=e,this.cursor.setCursorAtIndex(this.selectedIndex)}}
      >
        ${e.emptyStateSlotName?dc`<slot
              slot=${e.emptyStateSlotName}
              name=${e.emptyStateSlotName}
            ></slot>`:uc}
      </gr-change-list-section>
    `}willUpdate(e){(e.has("loggedInUser")||e.has("preferences")||e.has("config")||e.has("sections"))&&this.computeVisibleChangeTableColumns(),e.has("changes")&&this.changesChanged()}updated(e){e.has("sections")&&this.sectionsChanged(),e.has("selectedIndex")&&Jn(this,"selected-index-changed",{value:this.selectedIndex??0})}toggleCheckbox(){ba(this.selectedIndex,"selectedIndex");let e=this.selectedIndex;ba(this.sections,"sections");const t=ya(this,"gr-change-list-section");for(let i=0;i<this.sections.length;i++){if(!(e>=this.sections[i].results.length))return void t[i].toggleChange(e);e-=this.sections[i].results.length}throw new Error("invalid selected index")}computeVisibleChangeTableColumns(){if(this.config&&(this.changeTableColumns=Object.values(dg),this.showNumber=!1,this.visibleChangeTableColumns=Object.values(dg),this.loggedInUser&&this.preferences)){this.showNumber=!!this.preferences?.legacycid_in_change_table;const e=Hf(this.preferences);this.visibleChangeTableColumns=Object.values(dg).filter((t=>e.includes(t)))}}computeLabelNames(e){if(!e)return[];if(this.config?.submit_requirement_dashboard_columns?.length)return this.config?.submit_requirement_dashboard_columns;const t=e.map((e=>e.results)).flat();let i=[];return i=this.config?.dashboard_show_all_labels?t.map((e=>Object.keys(e.labels??{}))).flat():t.map((e=>Cv(e))).flat().map((e=>e.name)),function(e){const t=Ev.filter((t=>e.includes(t))),i=e.filter((e=>!Ev.includes(e))).sort();return t.concat(i)}(i.filter(Ca))}changesChanged(){this.sections=this.changes?[{results:this.changes}]:[]}nextChange(){this.isCursorMoving=!0,this.cursor.next(),this.isCursorMoving=!1,this.selectedIndex=this.cursor.index}prevChange(){this.isCursorMoving=!0,this.cursor.previous(),this.isCursorMoving=!1,this.selectedIndex=this.cursor.index}async openChange(){const e=await this.changeForIndex(this.selectedIndex);e&&this.getNavigation().setUrl(WC({change:e}))}nextPage(){Jn(this,"next-page",{})}prevPage(){Jn(this,"previous-page",{})}refreshChangeList(){aa(this)}toggleChangeStar(){this.toggleStarForIndex(this.selectedIndex)}async toggleStarForIndex(e){const t=await this.getListItems();if(void 0===e||e>=t.length||!t[e])return;const i=t[e],r=i?.shadowRoot?.querySelector("gr-change-star");r&&r.toggleStar()}async changeForIndex(e){const t=await this.getListItems();return void 0!==e&&e<t.length&&t[e]?t[e].change:null}async getListItems(){const e=[],t=ya(this,"gr-change-list-section");await Promise.all(Array.from(t).map((e=>e.updateComplete)));for(const i of t){const t=ya(i,"gr-change-list-item");e.push(...t)}return e}async sectionsChanged(){const e=await this.getListItems();this.cursor.stops=e??[],this.cursor.moveToStart(),this.selectedIndex&&this.cursor.setCursorAtIndex(this.selectedIndex)}};qN([Fc({type:Object})],KN.prototype,"loggedInUser",void 0),qN([Fc({type:String})],KN.prototype,"dashboardUser",void 0),qN([Fc({type:Array})],KN.prototype,"changes",void 0),qN([Fc({type:Array})],KN.prototype,"sections",void 0),qN([Uc()],KN.prototype,"dynamicHeaderEndpoints",void 0),qN([Fc({type:Number})],KN.prototype,"selectedIndex",void 0),qN([Fc({type:Boolean})],KN.prototype,"showNumber",void 0),qN([Fc({type:Boolean})],KN.prototype,"showReviewedState",void 0),qN([Fc({type:Array})],KN.prototype,"changeTableColumns",void 0),qN([Fc({type:String})],KN.prototype,"usp",void 0),qN([Fc({type:Array})],KN.prototype,"visibleChangeTableColumns",void 0),qN([Uc()],KN.prototype,"preferences",void 0),qN([Fc({type:Boolean})],KN.prototype,"isCursorMoving",void 0),qN([Uc()],KN.prototype,"config",void 0),KN=qN([Dc("gr-change-list")],KN);const YN=document.createElement("template"),XN=Sd`
  :host {
    background-color: var(--view-background-color);
    display: block;
    min-height: 9em;
    width: 100%;
  }
  gr-avatar {
    display: inline-block;
    height: 7em;
    left: 1em;
    margin: 1em;
    top: 1em;
    width: 7em;
  }
  .info {
    display: inline-block;
    padding: var(--spacing-l);
    vertical-align: top;
  }
  .info > div > span {
    display: inline-block;
    font-weight: var(--font-weight-medium);
    width: 3.5em;
  }
`;YN.innerHTML=`<dom-module id="dashboard-header-styles">\n  <template>\n    <style>\n    ${XN.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(YN.content);var JN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let QN=class extends Ic{constructor(){super(...arguments),this._repoUrl=null,this._webLinks=[],this.restApiService=Xn().restApiService}static get styles(){return[Nc,XN,Qb,Sd`
        .browse {
          display: inline-block;
          font-weight: var(--font-weight-medium);
          text-align: right;
          width: 4em;
        }
        a {
          padding-right: 0.3em;
        }
      `]}_renderLinks(e){if(e)return dc`<div>
      <span class="browse">Browse:</span>
      ${e.map((e=>dc`<gr-weblink imageAndText .info=${e}></gr-weblink>`))}
    </div> `}render(){return dc` <div class="info">
      <h1 class="heading-1">${this.repo}</h1>
      <hr />
      <div>
        <span>Detail:</span> <a href=${this._repoUrl}>Repo settings</a>
      </div>
      ${this._renderLinks(this._webLinks)}
    </div>`}updated(e){e.has("repo")&&this._repoChanged()}_repoChanged(){const e=this.repo;e?(this._repoUrl=bw({repo:e}),this.restApiService.getRepo(e).then((e=>{e?.web_links&&(this._webLinks=e.web_links)}))):this._repoUrl=null}};JN([Fc({type:String})],QN.prototype,"repo",void 0),JN([Fc({type:String})],QN.prototype,"_repoUrl",void 0),JN([Fc({type:Array})],QN.prototype,"_webLinks",void 0),QN=JN([Dc("gr-repo-header")],QN);var ZN=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let eO=class extends Ic{constructor(){super(...arguments),this.showDashboardLink=!1,this.loggedIn=!1,this._status="",this.restApiService=Xn().restApiService}static get styles(){return[Nc,XN,Qb,Sd`
        .status.hide,
        .name.hide,
        .dashboardLink.hide {
          display: none;
        }
      `]}render(){return dc`<gr-avatar
        .account=${this._accountDetails}
        .imageSize=${100}
        aria-label="Account avatar"
      ></gr-avatar>
      <div class="info">
        <h1 class="heading-1">${this._computeHeading(this._accountDetails)}</h1>
        <hr />
        <div class="status ${this._computeStatusClass(this._status)}">
          <span>Status:</span> ${this._status}
        </div>
        <div>
          <span>Email:</span>
          <a href="mailto:${this._computeDetail(this._accountDetails,"email")}"
            ><!--
          -->${this._computeDetail(this._accountDetails,"email")}</a
          >
        </div>
        <div>
          <span>Joined:</span>
          <gr-date-formatter
            dateStr=${this._computeDetail(this._accountDetails,"registered_on")}
          >
          </gr-date-formatter>
        </div>
        <gr-endpoint-decorator name="user-header">
          <gr-endpoint-param
            name="accountDetails"
            .value=${this._accountDetails}
          >
          </gr-endpoint-param>
          <gr-endpoint-param name="loggedIn" .value=${this.loggedIn}>
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      </div>
      <div class="info">
        <div
          class=${this._computeDashboardLinkClass(this.showDashboardLink,this.loggedIn)}
        >
          <a href=${this._computeDashboardUrl(this._accountDetails)}
            >View dashboard</a
          >
        </div>
      </div>`}updated(e){e.has("userId")&&this._accountChanged(this.userId)}_accountChanged(e){if(!e)return this._accountDetails=void 0,void(this._status="");this.restApiService.getAccountDetails(e,(()=>{})).then((e=>{this._accountDetails=e??void 0,this._status=e?.status??""}))}_computeDetail(e,t){return e?String(e[t]):""}_computeHeading(e){return e?ox(void 0,e):""}_computeStatusClass(e){return e?"":"hide"}_computeDashboardUrl(e){if(!e)return"";const t=e._account_id;if(t)return aE({type:sE.USER,user:t});const i=e.email;return i?aE({type:sE.USER,user:i}):""}_computeDashboardLinkClass(e,t){return e&&t?"dashboardLink":"dashboardLink hide"}};ZN([Fc({type:String})],eO.prototype,"userId",void 0),ZN([Fc({type:Boolean})],eO.prototype,"showDashboardLink",void 0),ZN([Fc({type:Boolean})],eO.prototype,"loggedIn",void 0),ZN([Fc({type:Object})],eO.prototype,"_accountDetails",void 0),ZN([Fc({type:String})],eO.prototype,"_status",void 0),eO=ZN([Dc("gr-user-header")],eO);var tO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const iO=/\blimit:(\d+)/i;let rO=class extends Ic{constructor(){super(),this.loggedIn=!1,this.query="",this.offset=0,this.changes=[],this.loading=!0,this.restApiService=Xn().restApiService,this.reporting=Xn().reportingService,this.getUserModel=yu(this,jf),this.getViewModel=yu(this,iE),this.getNavigation=yu(this,gy),this.addEventListener("next-page",(()=>this.handleNextPage())),this.addEventListener("previous-page",(()=>this.handlePreviousPage())),zf(this,(()=>this.getViewModel().query$),(e=>this.query=e)),zf(this,(()=>this.getViewModel().offsetNumber$),(e=>this.offset=e)),zf(this,(()=>this.getViewModel().loading$),(e=>this.loading=e)),zf(this,(()=>this.getViewModel().changes$),(e=>this.changes=e)),zf(this,(()=>this.getViewModel().userId$),(e=>this.userId=e)),zf(this,(()=>this.getViewModel().repo$),(e=>this.repo=e)),zf(this,(()=>this.getUserModel().account$),(e=>this.account=e)),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.loggedIn=e)),zf(this,(()=>this.getUserModel().preferenceChangesPerPage$),(e=>this.changesPerPage=e))}static get styles(){return[Nc,Sd`
        :host {
          display: block;
        }
        .loading {
          color: var(--deemphasized-text-color);
          padding: var(--spacing-l);
        }
        gr-change-list {
          width: 100%;
        }
        gr-user-header,
        gr-repo-header {
          border-bottom: 1px solid var(--border-color);
        }
        span[disabled] gr-icon {
          background-color: transparent;
          color: var(--disabled-foreground);
          cursor: default;
        }
        nav {
          align-items: center;
          display: flex;
          height: 3rem;
          justify-content: flex-end;
          margin-right: 20px;
        }
        gr-icon {
          font-size: 1.85rem;
          margin-left: 16px;
        }
        .hide {
          display: none;
        }
        @media only screen and (max-width: 50em) {
          .loading,
          .error {
            padding: 0 var(--spacing-l);
          }
        }
      `]}render(){return dc`
      <div class="loading" ?hidden=${!this.loading}>Loading...</div>
      <div ?hidden=${this.loading}>
        ${this.renderRepoHeader()} ${this.renderUserHeader()}
        <gr-change-list
          .loggedInUser=${this.account}
          .changes=${this.changes}
          @toggle-star=${e=>{this.handleToggleStar(e)}}
          .usp=${"search"}
        ></gr-change-list>
        ${this.renderChangeListViewNav()}
      </div>
    `}renderRepoHeader(){return this.repo?dc` <gr-repo-header .repo=${this.repo}></gr-repo-header> `:uc}renderUserHeader(){return this.userId?dc`
      <gr-user-header
        .userId=${this.userId}
        showDashboardLink
        .loggedIn=${this.loggedIn}
      ></gr-user-header>
    `:uc}renderChangeListViewNav(){return!this.loading&&this.changes&&this.changes.length?dc`
      <nav>
        ${this.renderPageNums()}${this.renderPrevArrow()}
        ${this.renderNextArrow()}
      </nav>
    `:uc}renderPageNums(){if(0===this.offset&&this.changes.length<=1)return dc`<span><strong>${this.changes.length}</strong></span>`;const e=this.changes?.length??0,t=this.changes?.[e-1]._more_changes;return dc`<span>
      <strong
        >${this.offset+1}&nbsp;-&nbsp;${this.offset+e}</strong
      >&nbsp;of&nbsp;<strong
        >${t?"many":this.offset+e}
      </strong></span
    >`}renderPrevArrow(){return 0===(this.changes?.length??0)?uc:0===this.offset?dc`<span id="prevArrow" disabled>
        <gr-icon icon="chevron_left" aria-label="Older"></gr-icon>
      </span>`:dc`
      <a id="prevArrow" href=${this.computeNavLink(-1)}>
        <gr-icon icon="chevron_left" aria-label="Older"></gr-icon>
      </a>
    `}renderNextArrow(){const e=this.changes?.length??0;return 0===e?uc:this.changes?.[e-1]._more_changes?dc`
      <a id="nextArrow" href=${this.computeNavLink(1)}>
        <gr-icon icon="chevron_right" aria-label="Newer"></gr-icon>
      </a>
    `:dc`<span id="nextArrow" disabled>
        <gr-icon icon="chevron_right" aria-label="Newer"></gr-icon>
      </span>`}updated(e){e.has("query")&&oa(this.query)}limitFor(e,t){if(void 0===t)return 0;const i=e.match(iO);return i?Number(i[1]):t}computeNavLink(e){const t=this.offset??0,i=this.limitFor(this.query,this.changesPerPage),r=Math.max(0,t+i*e);return tE({query:this.query,offset:r})}handleNextPage(){!this.nextArrow?.hasAttribute("disabled")&&this.changesPerPage&&this.getNavigation().setUrl(this.computeNavLink(1))}handlePreviousPage(){!this.prevArrow?.hasAttribute("disabled")&&this.changesPerPage&&this.getNavigation().setUrl(this.computeNavLink(-1))}computePage(){if(void 0!==this.offset&&void 0!==this.changesPerPage)return Math.ceil(this.offset/this.limitFor(this.query,this.changesPerPage))+1}async handleToggleStar(e){e.detail.starred&&this.reporting.reportInteraction("change-starred-from-change-list"),ea(this,e.detail.starred?"Starring change...":"Unstarring change..."),await this.restApiService.saveChangeStarred(e.detail.change._number,e.detail.starred),Jn(this,"hide-alert",{})}};tO([Hc("#prevArrow")],rO.prototype,"prevArrow",void 0),tO([Hc("#nextArrow")],rO.prototype,"nextArrow",void 0),tO([Uc()],rO.prototype,"account",void 0),tO([Uc()],rO.prototype,"loggedIn",void 0),tO([Uc()],rO.prototype,"changesPerPage",void 0),tO([Uc()],rO.prototype,"query",void 0),tO([Uc()],rO.prototype,"offset",void 0),tO([Uc()],rO.prototype,"changes",void 0),tO([Uc()],rO.prototype,"loading",void 0),tO([Uc()],rO.prototype,"userId",void 0),tO([Uc()],rO.prototype,"repo",void 0),rO=tO([Dc("gr-change-list-view")],rO);var oO,sO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e.CREATE="git commit",e.AMEND="git commit --amend",e.PUSH_PREFIX="git push origin HEAD:refs/for/"}(oO||(oO={}));let nO=class extends Ic{static get styles(){return[Nc,Iw,Sd`
        ol {
          list-style: decimal;
          margin-left: var(--spacing-l);
        }
        p {
          margin-bottom: var(--spacing-m);
        }
        #commandsDialog {
          max-width: 40em;
        }
      `]}render(){return dc` <dialog id="commandsModal" tabindex="-1">
      <gr-dialog
        id="commandsDialog"
        confirm-label="Done"
        cancel-label=""
        confirm-on-enter=""
        @confirm=${()=>this.commandsModal?.close()}
      >
        <div class="header" slot="header">Create change commands</div>
        <div class="main" slot="main">
          <ol>
            <li>
              <p>Make the changes to the files on your machine</p>
            </li>
            <li>
              <p>If you are making a new commit use</p>
              <gr-shell-command .command=${oO.CREATE}></gr-shell-command>
              <p>Or to amend an existing commit use</p>
              <gr-shell-command .command=${oO.AMEND}></gr-shell-command>
              <p>
                Please make sure you add a commit message as it becomes the
                description for your change.
              </p>
            </li>
            <li>
              <p>Push the change for code review</p>
              <gr-shell-command
                .command=${oO.PUSH_PREFIX+(this.branch??"[BRANCH]")}
              ></gr-shell-command>
            </li>
            <li>
              <p>
                Close this dialog and you should be able to see your recently
                created change in the 'Outgoing changes' section on the 'Your
                changes' page.
              </p>
            </li>
          </ol>
        </div>
      </gr-dialog>
    </dialog>`}open(){this.commandsModal?.showModal()}};sO([Hc("#commandsModal")],nO.prototype,"commandsModal",void 0),sO([Fc({type:String})],nO.prototype,"branch",void 0),nO=sO([Dc("gr-create-commands-dialog")],nO);var aO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let lO=class extends Ic{static get styles(){return[Nc,Qb,Sd`
        :host {
          display: block;
        }
        #graphic {
          display: inline-block;
          margin: var(--spacing-m);
          margin-left: 0;
        }
        #graphic #circle {
          align-items: center;
          background-color: var(--chip-background-color);
          border-radius: 50%;
          display: flex;
          height: 10em;
          justify-content: center;
          width: 10em;
        }
        #graphic gr-icon {
          color: var(--gray-foreground);
          font-size: 5em;
        }
        #graphic p {
          color: var(--deemphasized-text-color);
          text-align: center;
        }
        #help {
          display: inline-block;
          margin: var(--spacing-m);
          padding-top: var(--spacing-xl);
          vertical-align: top;
        }
        #help p {
          margin-bottom: var(--spacing-m);
          max-width: 35em;
        }
        @media only screen and (max-width: 50em) {
          #graphic {
            display: none;
          }
        }
      `]}render(){return dc`
      <div id="graphic">
        <div id="circle">
          <gr-icon id="icon" icon="empty_dashboard"></gr-icon>
        </div>
        <p>No outgoing changes yet</p>
      </div>
      <div id="help">
        <h2 class="heading-3">Push your first change for code review</h2>
        <p>
          Pushing a change for review is easy, but a little different from other
          git code review tools. Click on the \`Create Change' button and follow
          the step by step instructions.
        </p>
        <gr-button @click=${this._handleCreateTap}>Create Change</gr-button>
      </div>
    `}_handleCreateTap(e){e.preventDefault(),Jn(this,"create-tap",{})}};lO=aO([Dc("gr-create-change-help")],lO);var dO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let cO=class extends Ic{constructor(){super(...arguments),this.pickerConfirm=e=>{ba(this.createModal,"createModal"),this.createModal.close();const t={repo:this.repo,branch:this.branch};e.preventDefault(),e.stopPropagation(),Zn(this,"confirm-destination",t)}}static get styles(){return[Nc,Iw]}render(){return dc`
      <dialog id="createModal" tabindex="-1">
        <gr-dialog
          confirm-label="View commands"
          @confirm=${this.pickerConfirm}
          @cancel=${()=>{ba(this.createModal,"createModal"),this.createModal.close()}}
          ?disabled=${!(this.repo&&this.branch)}
        >
          <div class="header" slot="header">Create change</div>
          <div class="main" slot="main">
            <gr-repo-branch-picker
              .repo=${this.repo}
              .branch=${this.branch}
              @repo-changed=${e=>{this.repo=e.detail.value}}
              @branch-changed=${e=>{this.branch=e.detail.value}}
            ></gr-repo-branch-picker>
            <p>
              If you haven't done so, you will need to clone the repository.
            </p>
          </div>
        </gr-dialog>
      </dialog>
    `}open(){ba(this.createModal,"createModal"),this.repo="",this.branch="",this.createModal.showModal()}};var hO;dO([Hc("#createModal")],cO.prototype,"createModal",void 0),dO([Uc()],cO.prototype,"repo",void 0),dO([Uc()],cO.prototype,"branch",void 0),cO=dO([Dc("gr-create-destination-dialog")],cO),function(e){e.TRIGGER_NOTIFICATIONS="TRIGGER_NOTIFICATIONS",e.USER_PREFERENCE_CHANGE="USER_PREFERENCE_CHANGE",e.REPORTING="REPORTING"}(hO||(hO={}));const pO=mu("service-worker-installer");class uO extends df{constructor(e,t,i){super({initialized:!1,shouldShowPrompt:!1}),this.flagsService=e,this.reportingService=t,this.userModel=i,this.initialized$=lf(this.state$,(e=>e.initialized)),this.shouldShowPrompt$=lf(this.initialized$,(e=>this.shouldShowPrompt())),this.initialized=!1,this.userModel.account$.subscribe((e=>this.account=e)),this.userModel.preferences$.subscribe((e=>{this.allowBrowserNotificationsPreference!==e.allow_browser_notifications&&(this.allowBrowserNotificationsPreference=e.allow_browser_notifications,this.initialized&&navigator.serviceWorker.controller?.postMessage({type:hO.USER_PREFERENCE_CHANGE,allowBrowserNotificationsPreference:this.allowBrowserNotificationsPreference}))})),Promise.all([cy(this.userModel.account$,(e=>!!e)),cy(this.userModel.preferences$,(e=>!!e.allow_browser_notifications))]).then((()=>{this.init()}))}async init(){if(this.initialized)return;if(!this.areNotificationsEnabled())return;if(!("serviceWorker"in navigator))return void console.error("Service worker API not available");var e;await(e=`${Sf()}/service-worker.js`,window.navigator.serviceWorker.register(e));const t=Notification.permission;this.reportingService.reportLifeCycle(ha.NOTIFICATION_PERMISSION,{permission:t}),this.isPermitted(t)&&this.startTriggerTimer(),this.initialized=!0,this.updateState({initialized:!0}),navigator.serviceWorker.onmessage=e=>{e.data?.type===hO.REPORTING&&this.reportingService.reportLifeCycle(ha.SERVICE_WORKER_UPDATE,{eventName:e.data.eventName})}}shouldShowPrompt(){return!!this.initialized&&!!this.areNotificationsEnabled()&&"default"===Notification.permission}async requestPermission(){const e=await Notification.requestPermission();this.reportingService.reportLifeCycle(ha.NOTIFICATION_PERMISSION,{requested:!0,permission:e}),this.isPermitted(e)&&this.startTriggerTimer()}areNotificationsEnabled(){return!(!this.flagsService.isEnabled(da.PUSH_NOTIFICATIONS_DEVELOPER)&&!xT(this.account))&&this.allowBrowserNotificationsPreference}startTriggerTimer(){setTimeout((()=>{this.startTriggerTimer(),navigator.serviceWorker.controller?.postMessage({type:hO.TRIGGER_NOTIFICATIONS,account:this.account})}),3e5)}isPermitted(e){return"granted"===e}}function gO(){return Sf()+"/settings"}const mO=mu("settings-view-model");class fO extends df{constructor(){super(void 0),this.emailToken$=lf(this.state$,(e=>e?.emailToken))}clearToken(){this.updateState({emailToken:void 0})}}var vO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let bO=class extends Ic{constructor(){super(),this.hideNotificationsPrompt=!1,this.shouldShowPrompt=!1,this.serviceWorkerInstaller=yu(this,pO),this.getNavigation=yu(this,gy),zf(this,(()=>this.serviceWorkerInstaller().shouldShowPrompt$),(e=>{this.shouldShowPrompt=!!e}))}static get styles(){return[Qb,Sd`
        #notificationsPrompt {
          position: absolute;
          right: 30px;
          top: 50px;
          z-index: 150; /* Less than gr-hovercard's, higher than rest */
          display: flex;
          background-color: var(--background-color-primary);
          padding: var(--spacing-l);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          box-shadow: var(--elevation-level-5);
        }
        h3 {
          margin: 0;
          padding: 0;
        }
        .icon {
          flex: 0 0 30px;
        }
        .content {
          width: 300px;
        }
        div.section {
          margin: 0 var(--spacing-xl) var(--spacing-m) var(--spacing-xl);
          display: flex;
          align-items: center;
        }
        div.sectionIcon {
          flex: 0 0 30px;
        }
        .message {
          margin: var(--spacing-m) 0;
        }
        div.sectionIcon gr-icon {
          position: relative;
        }
        b {
          font-weight: var(--font-weight-medium);
        }
      `]}render(){return this.hideNotificationsPrompt?uc:this.shouldShowPrompt?dc`<div id="notificationsPrompt" role="dialog">
      <div class="icon">
        <gr-icon icon="info"></gr-icon>
      </div>
      <div class="content">
        <h3 class="heading-3">Missing your turn notifications?</h3>
        <div class="message">
          Get notified whenever it's your turn on a change. Gerrit needs
          permission to send notifications. To turn on notifications, click
          <b>Continue</b> and then <b>Allow</b> when prompted by your browser.
        </div>
        <div class="buttons">
          <gr-button
            primary=""
            @click=${()=>{this.hideNotificationsPrompt=!0,this.serviceWorkerInstaller().requestPermission()}}
            >Continue</gr-button
          >
          <gr-button
            @click=${()=>{this.hideNotificationsPrompt=!0,this.getNavigation().setUrl(gO())}}
            >Disable In Settings</gr-button
          >
        </div>
      </div>
      <div class="icon">
        <gr-button
          @click=${()=>{this.hideNotificationsPrompt=!0}}
          link
        >
          <gr-icon icon="close"></gr-icon>
        </gr-button>
      </div>
    </div>`:uc}};vO([Uc()],bO.prototype,"hideNotificationsPrompt",void 0),vO([Uc()],bO.prototype,"shouldShowPrompt",void 0),bO=vO([Dc("gr-notifications-prompt")],bO);const yO=Sd`
  .assistive-tech-only {
    user-select: none;
    clip: rect(1px, 1px, 1px, 1px);
    height: 1px;
    margin: 0;
    overflow: hidden;
    padding: 0;
    position: absolute;
    white-space: nowrap;
    width: 1px;
    z-index: -1000;
  }
`,wO=document.createElement("template");wO.innerHTML=`<dom-module id="gr-a11y-styles">\n  <template>\n    <style>\n    ${yO.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(wO.content);var _O=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const xO=/\${project}/g,CO=new Map([[MN.name,"your-turn-slot"],[FN.name,"outgoing-slot"]]);let EO=class extends Ic{constructor(){super(),this.loading=!0,this.showDraftsBanner=!1,this.showNewUserHelp=!1,this.showNotificationsPrompt=!1,this.reporting=Xn().reportingService,this.restApiService=Xn().restApiService,this.getUserModel=yu(this,jf),this.getViewModel=yu(this,lE),this.lastVisibleTimestampMs=0,this.firstTimeLoad=!0,this.shortcuts=new Gg(this),this.visibilityChangeListener=()=>{"visible"===document.visibilityState?Date.now()-this.lastVisibleTimestampMs>1e4&&this.reload():this.lastVisibleTimestampMs=Date.now()},zf(this,(()=>this.getUserModel().account$),(e=>this.loggedInUser=e)),zf(this,(()=>this.getUserModel().preferences$),(e=>{this.preferences=e??{}})),zf(this,(()=>this.getViewModel().state$),(e=>{this.viewState=e,this.reload()})),this.addEventListener("reload",(()=>this.reload())),this.shortcuts.addAbstract(pu.UP_TO_DASHBOARD,(()=>this.reload()))}connectedCallback(){super.connectedCallback(),document.addEventListener("visibilitychange",this.visibilityChangeListener)}disconnectedCallback(){document.removeEventListener("visibilitychange",this.visibilityChangeListener),super.disconnectedCallback()}static get styles(){return[yO,Nc,Iw,Sd`
        :host {
          display: block;
        }
        .loading {
          color: var(--deemphasized-text-color);
          padding: var(--spacing-l);
        }
        gr-change-list {
          width: 100%;
        }
        gr-user-header {
          border-bottom: 1px solid var(--border-color);
        }
        .banner {
          align-items: center;
          background-color: var(--comment-background-color);
          border-bottom: 1px solid var(--border-color);
          display: flex;
          justify-content: space-between;
          padding: var(--spacing-xs) var(--spacing-l);
        }
        .hide {
          display: none;
        }
        #emptyOutgoing {
          display: block;
        }
        @media only screen and (max-width: 50em) {
          .loading {
            padding: 0 var(--spacing-l);
          }
        }
      `]}render(){return this.viewState?dc`
      ${this.renderBanner()} ${this.renderContent()}
      <dialog id="confirmDeleteModal" tabindex="-1">
        <gr-dialog
          id="confirmDeleteDialog"
          confirm-label="Delete"
          @confirm=${()=>{this.handleConfirmDelete()}}
          @cancel=${()=>{this.closeConfirmDeleteModal()}}
        >
          <div class="header" slot="header">Delete comments</div>
          <div class="main" slot="main">
            Are you sure you want to delete all your draft comments in closed
            changes? This action cannot be undone.
          </div>
        </gr-dialog>
      </dialog>
      <gr-create-destination-dialog
        id="destinationDialog"
        @confirm-destination=${e=>{this.handleDestinationConfirm(e)}}
      ></gr-create-destination-dialog>
      <gr-create-commands-dialog
        id="commandsDialog"
      ></gr-create-commands-dialog>
    `:uc}renderBanner(){if(this.showDraftsBanner)return dc`
      <div class="banner">
        <div>
          You have draft comments on closed changes.
          <a href=${this.computeDraftsLink()} target="_blank">(view all)</a>
        </div>
        <div>
          <gr-button
            class="delete"
            link
            @click=${()=>{this.handleOpenDeleteDialog()}}
            >Delete All</gr-button
          >
        </div>
      </div>
    `}renderContent(){return dc`
      <div class="loading" ?hidden=${!this.loading}>Loading...</div>
      <div ?hidden=${this.loading}>
        ${this.renderUserHeader()}
        <h1 class="assistive-tech-only">Dashboard</h1>
        <gr-change-list
          .loggedInUser=${this.loggedInUser}
          .dashboardUser=${this.viewState?.user}
          .preferences=${this.preferences}
          .sections=${this.results}
          .usp=${"dashboard"}
          @toggle-star=${e=>{this.handleToggleStar(e)}}
        >
          <div id="emptyOutgoing" slot="outgoing-slot">
            ${this.renderShowNewUserHelp()}
          </div>
          <div id="emptyYourTurn" slot="your-turn-slot">
            <span>No changes need your attention &nbsp;&#x1f389;</span>
          </div>
        </gr-change-list>
        ${this.renderShowNotificationsPrompt()}
      </div>
    `}renderUserHeader(){if(!this.viewState?.project&&this.viewState?.user&&"self"!==this.viewState?.user)return dc`
      <gr-user-header .userId=${this.viewState?.user}></gr-user-header>
    `}renderShowNewUserHelp(){return this.showNewUserHelp?dc`
      <gr-create-change-help
        @create-tap=${()=>{this.handleCreateChangeTap()}}
      ></gr-create-change-help>
    `:" No changes "}renderShowNotificationsPrompt(){if(this.showNotificationsPrompt)return dc`<gr-notifications-prompt></gr-notifications-prompt>`}getRepositoryDashboard(e,t){return ba(t,"project dashboard must have id"),this.restApiService.getDashboard(e,t,(e=>{ia(e)})).then((t=>{if(t)return{title:t.title,sections:t.sections.map((i=>{const r=t.foreach?" "+t.foreach:"";return{name:i.name,query:(i.query+r).replace(xO,e)}}))}}))}computeTitle(e){return e&&"self"!==e?"Dashboard for "+e:"My Reviews"}async reload(){if(!this.viewState)return;this.firstTimeLoad||this.reporting.time(ua.DASHBOARD_DISPLAYED),this.firstTimeLoad=!1,this.loading=!0;const{project:e,type:t,dashboard:i,title:r,user:o,sections:s}=this.viewState,n=e?this.getRepositoryDashboard(e,i):Promise.resolve(function(e="self",t=BN,i=""){return{title:i,sections:t=t.filter((t=>"self"===e||!t.selfOnly)).map((t=>({...t,name:t.name,query:t.query.replace(LN,String(e))})))}}(o,s,r||this.computeTitle(o))),a=!e&&!!this.loggedInUser&&"self"===o;try{const e=await n;e&&e.title&&oa(e.title),await this.fetchDashboardChanges(e,a),this.maybeShowDraftsBanner(),t===sE.USER&&a&&this.reporting.dashboardDisplayed()}catch(e){oa(r||this.computeTitle(o)),this.reporting.error("Dashboard reload",e)}finally{this.loading=!1}}async fetchDashboardChanges(e,t){if(!e)return;let i;window.PRELOADED_QUERIES&&window.PRELOADED_QUERIES.dashboardQuery?(i=window.PRELOADED_QUERIES.dashboardQuery,window.PRELOADED_QUERIES.dashboardQuery=void 0):(i=e.sections.map((e=>e.suffixForDashboard?e.query+" "+e.suffixForDashboard:e.query)),t&&i.push("owner:self limit:1"));const r=await this.restApiService.getChangesForDashboard(void 0,i);if(!r)throw new Error("getChanges returns undefined");if(t){const e=r.pop();this.showNewUserHelp=0===e.length,this.showNotificationsPrompt=!this.showNewUserHelp}this.results=r.map(((t,i)=>({name:e.sections[i].name,countLabel:this.computeSectionCountLabel(t),query:e.sections[i].query,results:this.maybeSortResults(e.sections[i].name,t),emptyStateSlotName:CO.get(e.sections[i].name)}))).filter(((t,i)=>i<e.sections.length&&(!e.sections[i].hideIfEmpty||t.results.length))),this.showNotificationsPrompt=this.showNotificationsPrompt||0!==this.results.filter((e=>e.name===MN.name&&e.results.length>0)).length}maybeSortResults(e,t){const i="self"===this.viewState?.user?this.loggedInUser?._account_id:this.viewState?.user,r=[...t];return e===MN.name&&i&&r.sort(((e,t)=>{const r=e.owner._account_id===i;if(r!==(t.owner._account_id===i))return r?1:-1;if(!e.attention_set||!e.attention_set[i])return 0;if(!t.attention_set||!t.attention_set[i])return 0;const o=e.attention_set[i].last_update,s=t.attention_set[i].last_update;return o&&s?Wm(o).valueOf()-Wm(s).valueOf():o?1:-1})),r}computeSectionCountLabel(e){if(!e||!e.length||0===e.length)return"";const t=e[e.length-1]._more_changes;return`(${e.length}${t?" and more":""})`}async handleToggleStar(e){ea(this,e.detail.starred?"Starring change...":"Unstarring change..."),await this.restApiService.saveChangeStarred(e.detail.change._number,e.detail.starred),Jn(this,"hide-alert",{}),e.detail.starred&&this.reporting.reportInteraction("change-starred-from-dashboard"),this.results?.forEach(((t,i)=>t.results.forEach(((t,r)=>{t.id===e.detail.change.id&&(this.results[i].results[r].starred=e.detail.starred,this.requestUpdate("results"))}))))}maybeShowDraftsBanner(){if(this.showDraftsBanner=!1,"self"!==this.viewState?.user)return;if(!this.results)throw new Error("this.results must be set. restAPI returned undefined");const e=this.results.find((e=>"has:draft"===e.query));e&&e.results.length&&e.results.filter((e=>!PC(e))).length&&(this.showDraftsBanner=!0)}handleOpenDeleteDialog(){ba(this.confirmDeleteModal,"confirmDeleteModal"),this.confirmDeleteModal.showModal()}handleConfirmDelete(){return ba(this.confirmDeleteDialog,"confirmDeleteDialog"),this.confirmDeleteDialog.disabled=!0,this.restApiService.deleteDraftComments("-is:open").then((()=>{this.closeConfirmDeleteModal(),this.reload()}))}closeConfirmDeleteModal(){ba(this.confirmDeleteModal,"confirmDeleteModal"),this.confirmDeleteModal.close()}computeDraftsLink(){return tE({query:"has:draft -is:open"})}handleCreateChangeTap(){ba(this.destinationDialog,"destinationDialog"),this.destinationDialog.open()}handleDestinationConfirm(e){ba(this.commandsDialog,"commandsDialog"),this.commandsDialog.branch=e.detail.branch,this.commandsDialog.open()}};_O([Hc("#confirmDeleteDialog")],EO.prototype,"confirmDeleteDialog",void 0),_O([Hc("#commandsDialog")],EO.prototype,"commandsDialog",void 0),_O([Hc("#destinationDialog")],EO.prototype,"destinationDialog",void 0),_O([Hc("#confirmDeleteModal")],EO.prototype,"confirmDeleteModal",void 0),_O([Fc({type:Object})],EO.prototype,"loggedInUser",void 0),_O([Fc({type:Object})],EO.prototype,"preferences",void 0),_O([Uc()],EO.prototype,"viewState",void 0),_O([Uc()],EO.prototype,"results",void 0),_O([Uc()],EO.prototype,"loading",void 0),_O([Uc()],EO.prototype,"showDraftsBanner",void 0),_O([Uc()],EO.prototype,"showNewUserHelp",void 0),_O([Uc()],EO.prototype,"showNotificationsPrompt",void 0),EO=_O([Dc("gr-dashboard-view")],EO);var SO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let $O=class extends Ic{};SO([Fc({type:String})],$O.prototype,"name",void 0),$O=SO([Dc("gr-endpoint-slot")],$O);const kO=864e5,AO=kO,RO=new Map;RO.set("draft",kO),RO.set("editablecontent",kO);const TO=mu("storage-service");class IO{constructor(){this.lastCleanup=0,this.storage=window.localStorage,this.exceededQuota=!1}finalize(){}getEditableContentItem(e){return this.cleanupItems(),this.getObject(this.getEditableContentKey(e))}setEditableContentItem(e,t){this.setObject(this.getEditableContentKey(e),{message:t,updated:Date.now()})}eraseEditableContentItem(e){this.storage.removeItem(this.getEditableContentKey(e))}eraseEditableContentItemsForChangeEdit(e){if(e)for(const t of Object.keys(this.storage))t.startsWith(`editablecontent:c${e}_ps`)&&this.eraseEditableContentItem(t.replace("editablecontent:",""))}getEditableContentKey(e){return`editablecontent:${e}`}cleanupItems(){this.lastCleanup&&Date.now()-this.lastCleanup<AO||(this.lastCleanup=Date.now(),Object.keys(this.storage).forEach((e=>{const t=RO.entries();for(const[i,r]of t)if(e.startsWith(i)){const t=this.getObject(e);(!t||Date.now()-t.updated>r)&&this.storage.removeItem(e)}})))}getObject(e){const t=this.storage.getItem(e);return t?JSON.parse(t):null}setObject(e,t){if(!this.exceededQuota)try{this.storage.setItem(e,JSON.stringify(t))}catch(e){if(e instanceof DOMException&&"QuotaExceededError"===e.name)return this.exceededQuota=!0,void console.warn("Local storage quota exceeded: disabling");throw e}}}var PO;!function(e){e[e.SUBJECT_TOO_LONG=0]="SUBJECT_TOO_LONG",e[e.LINE_TOO_LONG=1]="LINE_TOO_LONG",e[e.MISSING_BLANK_LINE=2]="MISSING_BLANK_LINE",e[e.EXTRA_BLANK_LINE=3]="EXTRA_BLANK_LINE",e[e.INVALID_INDENTATION=4]="INVALID_INDENTATION",e[e.TRAILING_SPACES=5]="TRAILING_SPACES",e[e.COMMENT_LINE=6]="COMMENT_LINE",e[e.LEADING_SPACES=7]="LEADING_SPACES"}(PO||(PO={}));const NO=/^\s*[-+*#]\s/;function OO(e,t){return e.trimStart().startsWith("> ")||e.length>=4&&""===e.substring(0,4).trim()||NO.test(e)||!t&&e.trimStart().length>0&&e!==e.trimStart()}function DO(e){const t=e.split(/\s+/),i=[];let r="";for(const e of t)e.length>72?(r.length>0&&(i.push(r),r=""),i.push(e)):r.length>0&&r.length+e.length+1>72?(i.push(r),r=e):r+=(r?" ":"")+e;return r&&i.push(r),i}function LO(e){const t=[];let i=!1;for(const r of e){const e=""===r.trim();e&&i||t.push(r),i=e}for(;t.length>0&&""===t[0].trim();)t.shift();for(;t.length>0&&""===t[t.length-1].trim();)t.pop();return t}function MO(e){const t=e.split("\n");for(;t.length>0&&""===t[0].trim();)t.shift();let i="",r=[],o=[],s=!1;if(0===t.length)return{subject:i,body:r,footer:o,hasTrailingBlankLine:s};if(1===t.length)return i=t[0],{subject:i,body:r,footer:o,hasTrailingBlankLine:s};i=t[0],s=t.length>0&&""===t[t.length-1].trim();const n=function(e,t){for(let i=t;i>=0;i--)if(""===e[i].trim())return i+1;return 1}(t,s?t.length-2:t.length-1);return o=t.slice(n,t.length),s&&o.pop(),r=t.slice(FO(t,2,1),FO(t,n-1,-1)+1),!o.some((e=>/^[^:]+:.+/.test(e.trim())))&&o.length>0&&(r.length>0&&r.push(""),r=r.concat(o),o=[]),{subject:i,body:r,footer:o,hasTrailingBlankLine:s}}function FO(e,t,i){for(;t>=0&&t<e.length&&""===e[t].trim();)t+=i;return t}function UO(e){return function(e){let t=e.subject;return e.body.length>0&&(t+="\n\n"+e.body.join("\n")),e.footer.length>0&&(t+="\n\n"+e.footer.join("\n")),e.hasTrailingBlankLine&&(t+="\n"),t}({subject:(t=MO(e)).subject.trim(),body:function(e){let t=!1,i=[];const r=[];let o=!1,s=!0;for(const n of e)n.trim().startsWith("```")?(t=!t,r.push(n.trimEnd()),s=!1):t||OO(n,s)?(t||(o=NO.test(n)),i.length>0&&r.push(...DO(i.join(" "))),i=[],r.push(n.trimEnd()),s=!1):o&&n.startsWith("  ")?(r.push(n.trimEnd()),s=!1):""===n.trim()?(i.length>0&&(r.push(...DO(i.join(" "))),i=[]),r.push(""),o=!1,s=!0):(i.push(n.trim()),s=!1);return i.length>0&&r.push(...DO(i.join(" "))),LO(r)}(t.body),footer:(i=t.footer,LO(i.map((e=>e.trim())))),hasTrailingBlankLine:t.hasTrailingBlankLine});var t,i}function BO(e){return function(e,t){const i=[];e.subject.length>72&&i.push({type:PO.SUBJECT_TOO_LONG,line:1,message:"Subject exceeds 72 characters"}),e.subject.startsWith(" ")&&i.push({type:PO.LEADING_SPACES,line:1,message:"Subject should not start with spaces"}),e.subject.endsWith(" ")&&i.push({type:PO.TRAILING_SPACES,line:1,message:"Subject should not end with spaces"});const r=t.split("\n");for(let e=0;e<r.length;e++)r[e].trim().startsWith("#")&&i.push({type:PO.COMMENT_LINE,line:e+1,message:"'#' at line start is a comment marker in Git. Line will be ignored"});for(let t=0;t<r.length;t++)if(t>0&&""===r[t].trim()&&""===r[t-1].trim()){const o=1===t&&e.body.length>0,s=t===e.body.length+(e.subject?1:0)&&e.footer.length>0,n=t===r.length-1&&e.footer.length>0;o||s||n||i.push({type:PO.EXTRA_BLANK_LINE,line:t+1,message:"Consecutive blank lines are not allowed"})}let o=3,s=!1;for(const t of e.body)t.trim().startsWith("```")&&(s=!s),!s&&!OO(t,!1)&&t.length>72&&!t.includes("://")&&i.push({type:PO.LINE_TOO_LONG,line:o,message:"Line exceeds 72 characters"}),t.endsWith(" ")&&i.push({type:PO.TRAILING_SPACES,line:o,message:"Line should not end with spaces"}),o++;o=e.body.length+4;for(const t of e.footer)t.trim().startsWith("```")&&(s=!s),!s&&!OO(t,!1)&&t.length>72&&!t.includes("://")&&i.push({type:PO.LINE_TOO_LONG,line:o,message:"Line exceeds 72 characters"}),t.endsWith(" ")&&i.push({type:PO.TRAILING_SPACES,line:o,message:"Line should not end with spaces"}),t.startsWith(" ")&&i.push({type:PO.LEADING_SPACES,line:o,message:"Line should not start with spaces"}),o++;return i}(MO(e),e)}var HO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let jO=class extends Ic{constructor(){super(),this.disabled=!1,this.editing=!1,this.commitCollapsible=!0,this.commitCollapsed=!0,this.newContent="",this.emails=[],this.editMode=!1,this.isUploader=!1,this.restApiService=Xn().restApiService,this.getChangeModel=yu(this,MT),this.getStorage=yu(this,TO),this.reporting=Xn().reportingService,this.getNavigation=yu(this,gy),this.getViewModel=yu(this,XC),this.formatDisabled=!0,this.formattedErrors=[],this.showFormattedErrors=!1,zf(this,(()=>this.getChangeModel().latestCommitter$),(e=>this.latestCommitter=e)),zf(this,(()=>this.getChangeModel().editMode$),(e=>this.editMode=e)),zf(this,(()=>this.getChangeModel().repo$),(e=>this.repoName=e)),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getChangeModel().patchNum$),(e=>this.patchNum=e)),zf(this,(()=>this.getChangeModel().isUploader$),(e=>this.isUploader=e))}disconnectedCallback(){this.storeTask?.flush(),super.disconnectedCallback()}willUpdate(e){e.has("editing")&&this.editingChanged(),e.has("newContent")&&(this.updateFormatState(),this.updateStorageWithNewContent(),this.lastFormattedContent&&this.newContent!==UO(this.lastFormattedContent)&&(this.lastFormattedContent=void 0)),e.has("content")&&this.contentChanged()}static get styles(){return[Nc,vy,Qb,Iw,Sd`
        :host {
          display: block;
        }
        :host([disabled]) gr-autogrow-textarea {
          opacity: 0.5;
        }
        .viewer {
          background-color: var(--view-background-color);
          border: 1px solid var(--view-background-color);
          border-radius: var(--border-radius);
          box-shadow: var(--elevation-level-1);
          padding: var(--spacing-m);
        }
        :host(.collapsed) .viewer,
        .viewer.collapsed {
          max-height: var(--collapsed-max-height, 300px);
          overflow: hidden;
        }
        .editor gr-autogrow-textarea,
        .viewer {
          min-height: 100px;
        }
        .editor gr-autogrow-textarea {
          background-color: var(--view-background-color);
          width: 100%;
          display: block;
          --gr-autogrow-textarea-padding: var(--spacing-m);
        }
        .editButtons {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }
        .show-all-container {
          background-color: var(--view-background-color);
          display: flex;
          border: 1px solid transparent;
          border-top-color: var(--border-color);
          border-radius: 0 0 4px 4px;
          box-shadow: var(--elevation-level-1);
          /* slightly up to cover rounded corner of the commit msg */
          margin-top: calc(-1 * var(--spacing-xs));
          /* To make this bar pop over editor, since editor has relative position.
          */
          position: relative;
        }
        :host([editing]) .show-all-container {
          box-shadow: none;
          border: 1px solid var(--border-color);
          justify-content: space-between;
        }
        :host(:not([editing])) .show-all-container {
          justify-content: flex-end;
        }
        div:only-child {
          align-self: flex-end;
          margin-left: auto;
        }
        .flex-space {
          flex-grow: 1;
        }
        .show-all-container gr-icon {
          color: inherit;
        }
        .email-dropdown {
          margin-left: var(--spacing-s);
          align-self: center;
        }
        .cancel-button {
          margin-right: var(--spacing-l);
        }
        .save-button {
          margin-right: var(--spacing-xs);
        }
        gr-button {
          padding: var(--spacing-xs);
        }
        .format-button {
          margin-right: var(--spacing-l);
        }
        gr-icon.warning {
          color: var(--warning-foreground);
        }
      `]}render(){return dc`
      <gr-endpoint-decorator name="commit-message">
        <gr-endpoint-param
          name="editing"
          .value=${this.editing}
        ></gr-endpoint-param>
        ${this.renderViewer()} ${this.renderEditor()} ${this.renderButtons()}
        <gr-endpoint-slot name="above-actions"></gr-endpoint-slot>
      </gr-endpoint-decorator>
      ${this.renderUploaderConfirmDialog()}
    `}renderViewer(){if(!this.editing)return dc`
      <div
        class=${th({viewer:!0,collapsed:this.commitCollapsed&&this.commitCollapsible})}
      >
        <slot></slot>
      </div>
    `}renderEditor(){if(this.editing)return dc`
      <div class="editor">
        <div>
          <gr-autogrow-textarea
            autocomplete="on"
            .value=${this.newContent}
            ?disabled=${this.disabled}
            @input=${e=>{const t=e.target.value??"";this.newContent=t}}
          ></gr-autogrow-textarea>
        </div>
      </div>
    `}renderButtons(){return this.editing||this.commitCollapsible||!this.hideEditCommitMessage?dc`
      <div class="show-all-container font-normal">
        ${eb(this.commitCollapsible&&!this.editing,(()=>dc`
            <gr-button
              link
              class="show-all-button"
              @click=${this.toggleCommitCollapsed}
            >
              <div>
                ${eb(!this.commitCollapsed,(()=>dc`<gr-icon icon="expand_less" small></gr-icon>`))}
                ${eb(this.commitCollapsed,(()=>dc`<gr-icon icon="expand_more" small></gr-icon>`))}
                <span>${this.commitCollapsed?"Show All":"Show Less"}</span>
              </div>
            </gr-button>
            <div class="flex-space"></div>
          `))}
        ${eb(!this.hideEditCommitMessage,(()=>dc`
            <gr-button
              link
              class="edit-commit-message"
              title="Edit commit message"
              @click=${this.handleEditCommitMessage}
              ><div>
                <gr-icon icon="edit" filled small></gr-icon>
                <span>Edit</span>
              </div></gr-button
            >
          `))}
        ${eb(this.editing,(()=>dc` ${eb(this.canShowEmailDropdown(),(()=>dc` <div class="email-dropdown" id="editMessageEmailDropdown">Committer Email
            <gr-dropdown-list
                .items=${this.getEmailDropdownItems()}
                .value=${this.committerEmail??""}
                @value-change=${this.setCommitterEmail}
            >
            </gr-dropdown-list>
            <span></div>`))}
            <div class="editButtons">
              ${eb(this.showFormattedErrors,(()=>dc`<gr-tooltip-content
                  .title=${this.formattedErrors.map((e=>`${e.line?`Line ${e.line}: `:""}${e.message}`)).join("\n")}
                  ><gr-icon class="warning" icon="warning" filled></gr-icon
                ></gr-tooltip-content>`))}
              <gr-button
                link
                class="format-button"
                @click=${this.handleFormat}
                ?disabled=${this.formatDisabled&&!this.lastFormattedContent}
                .title=${this.computeFormatButtonTooltip(this.formatDisabled,this.formattedErrors,!!this.lastFormattedContent)}
                >${this.lastFormattedContent?"Undo":"Format"}</gr-button
              >
              <gr-button
                link
                class="cancel-button"
                @click=${this.handleCancel}
                ?disabled=${this.disabled}
                >Cancel</gr-button
              >
              <gr-button
                class="save-button"
                primary=""
                @click=${this.handleSave}
                ?disabled=${this.computeSaveDisabled()}
                >Save</gr-button
              >
            </div>`))}
        </div>
      </div>
    `:uc}renderUploaderConfirmDialog(){return this.isUploader?uc:dc`
      <dialog id="uploaderConfirmDialog" tabindex="-1">
        <gr-dialog
          confirm-label="Continue"
          @confirm=${this.handleUploaderConfirm}
          @cancel=${this.handleUploaderCancel}
        >
          <div class="header" slot="header">Become Uploader</div>
          <div class="main" slot="main">
            <p>
              By editing the commit message, you will become the uploader of
              the<br />
              new patch set. This means that your own approvals will be
              ignored<br />
              for submit requirements that ignore uploader approvals.
            </p>
            <p>Do you want to continue?</p>
          </div>
        </gr-dialog>
      </dialog>
    `}contentChanged(){this.editing=!1,this.newContent="",Jn(this,"content-changed",{value:this.content??""})}focusTextarea(){this.textarea?.focus()}updateFormatState(e=!1){if(this.newContent)return e?(this.formatDisabled=UO(this.newContent)===this.newContent,this.formattedErrors=BO(this.newContent),void(this.showFormattedErrors=this.formattedErrors.length>0)):void(this.formatCheckTask=ny(this.formatCheckTask,(()=>{this.formattedErrors=BO(this.newContent);const e=this.filterActiveLineErrors(this.formattedErrors);this.showFormattedErrors=e.length>0;const t=0===e.length&&this.formattedErrors.length>0;this.formatDisabled=UO(this.newContent)===this.newContent||t}),700))}updateStorageWithNewContent(){if(!this.storageKey)return;const e=this.storageKey;this.storeTask=ny(this.storeTask,(()=>{this.newContent.length?this.getStorage().setEditableContentItem(e,this.newContent):this.getStorage().eraseEditableContentItem(e)}),400)}editingChanged(){if(Jn(this,"editing-changed",{value:this.editing}),!this.editing||this.newContent)return;let e;if(this.storageKey){const t=this.getStorage().getEditableContentItem(this.storageKey);t?.message&&(e=t.message,ea(this,"Content restored from a previous edit."))}e||(e=this.content||""),this.newContent=this.removeZeroWidthSpace?e.replace(/^R=\u200B/gm,"R="):e}computeSaveDisabled(){return this.disabled||!this.newContent||this.content===this.newContent}handleSave(e){e.preventDefault(),Jn(this,"editable-content-save",{content:this.newContent,committerEmail:this.committerEmail?this.committerEmail:null})}handleCancel(e){e.preventDefault(),this.editing=!1,Jn(this,"editable-content-cancel",{})}toggleCommitCollapsed(){this.commitCollapsed=!this.commitCollapsed,this.reporting.reportInteraction(ga.TOGGLE_SHOW_ALL_BUTTON,{sectionName:"Commit message",toState:this.commitCollapsed?"Show less":"Show all"}),this.commitCollapsed&&window.scrollTo(0,0)}async handleEditCommitMessage(){if(this.editMode)return ba(this.changeNum,"changeNum"),ba(this.repoName,"repoName"),ba(this.patchNum,"patchNum"),void this.getNavigation().setUrl(this.getViewModel().editUrl({editView:{path:hg.COMMIT_MESSAGE},patchNum:this.patchNum}));await this.loadEmails(),this.isUploader?this.startEditing():(ba(this.uploaderConfirmDialog,"uploaderConfirmDialog"),this.uploaderConfirmDialog.showModal())}async loadEmails(){const e=await this.restApiService.getAccountEmails()??[];let t;e.forEach((e=>{e.preferred&&(t=e.email)})),e.some((e=>e.email===this.latestCommitter?.email))&&(t=this.latestCommitter?.email),this.emails=e,this.committerEmail=t}canShowEmailDropdown(){return this.emails.length>1}getEmailDropdownItems(){return this.emails.map((e=>({text:e.email,value:e.email})))}handleFormat(e){e.preventDefault();const t=this.textarea?.nativeElement;if(!t)return;if(this.lastFormattedContent)return t.focus(),t.setSelectionRange(0,t.value.length),document.execCommand("insertText",!1,this.lastFormattedContent),this.newContent=this.lastFormattedContent,void(this.lastFormattedContent=void 0);const i=t.value,r=UO(i);if(i===r)return;const{selectionStart:o,selectionEnd:s}=t;t.focus(),t.setSelectionRange(0,i.length),this.lastFormattedContent=i,document.execCommand("insertText",!1,r),this.newContent=t.value;const n=Math.min(o,r.length),a=Math.min(s,r.length);t.setSelectionRange(n,a),this.updateFormatState(!0)}setCommitterEmail(e){this.committerEmail=e.detail.value}computeFormatButtonTooltip(e,t,i){return i?"Undo formatting changes":e?t.length>0?"Format button cannot fix all issues (like subject or footer length). Some must be fixed manually.":"No format changes needed.":"Automatically fixes formatting by trimming trailing spaces, wrapping paragraphs at 72 characters, and condensing blank lines. "}getCurrentCursorLine(){const e=this.textarea?.nativeElement;if(!e)return-1;const t=e.value,i=e.selectionStart,r=t.substring(0,i).match(/\n/g);return r?r.length:-1}filterActiveLineErrors(e){const t=this.getCurrentCursorLine();return e.filter((e=>-1===t||e.line!==t+1||e.type!==PO.TRAILING_SPACES))}handleUploaderConfirm(){ba(this.uploaderConfirmDialog,"uploaderConfirmDialog"),this.uploaderConfirmDialog.close(),this.startEditing()}handleUploaderCancel(){ba(this.uploaderConfirmDialog,"uploaderConfirmDialog"),this.uploaderConfirmDialog.close()}startEditing(){this.editing=!0,this.updateComplete.then((()=>{this.focusTextarea()}))}};HO([Hc("gr-autogrow-textarea")],jO.prototype,"textarea",void 0),HO([Hc("#uploaderConfirmDialog")],jO.prototype,"uploaderConfirmDialog",void 0),HO([Fc({type:String})],jO.prototype,"content",void 0),HO([Fc({type:Boolean,reflect:!0})],jO.prototype,"disabled",void 0),HO([Fc({type:Boolean,reflect:!0})],jO.prototype,"editing",void 0),HO([Fc({type:Boolean,attribute:"remove-zero-width-space"})],jO.prototype,"removeZeroWidthSpace",void 0),HO([Fc({type:String,attribute:"storage-key"})],jO.prototype,"storageKey",void 0),HO([Fc({type:Boolean,attribute:"commit-collapsible"})],jO.prototype,"commitCollapsible",void 0),HO([Fc({type:Boolean,attribute:"hide-edit-commit-message"})],jO.prototype,"hideEditCommitMessage",void 0),HO([Uc()],jO.prototype,"commitCollapsed",void 0),HO([Uc()],jO.prototype,"newContent",void 0),HO([Uc()],jO.prototype,"emails",void 0),HO([Uc()],jO.prototype,"committerEmail",void 0),HO([Uc()],jO.prototype,"latestCommitter",void 0),HO([Uc()],jO.prototype,"editMode",void 0),HO([Uc()],jO.prototype,"repoName",void 0),HO([Uc()],jO.prototype,"changeNum",void 0),HO([Uc()],jO.prototype,"patchNum",void 0),HO([Uc()],jO.prototype,"isUploader",void 0),HO([Uc()],jO.prototype,"formatDisabled",void 0),HO([Uc()],jO.prototype,"formattedErrors",void 0),HO([Uc()],jO.prototype,"showFormattedErrors",void 0),HO([Uc()],jO.prototype,"lastFormattedContent",void 0),jO=HO([Dc("gr-editable-content")],jO);var GO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let zO=class extends Ic{static get styles(){return[Nc,Sd`
        :host {
          display: inline-block;
        }
        .container {
          position: relative;
        }
        .dropdown-trigger {
          text-decoration: none;
          width: 100%;
        }
        .dropdown-content {
          min-width: 112px;
          max-width: 280px;
        }
        md-menu {
          white-space: nowrap;
          --md-menu-container-color: var(--dropdown-background-color);
          --md-menu-top-space: 0px;
          --md-menu-bottom-space: 0px;
          --md-focus-ring-duration: 0s;
          max-height: calc(100vh - 48px);
        }
        gr-button {
          vertical-align: top;
        }
        gr-avatar {
          height: 2em;
          width: 2em;
          vertical-align: middle;
        }
        gr-button[link]:focus {
          outline: 5px auto -webkit-focus-ring-color;
        }
        ul {
          list-style: none;
        }
        .topContent {
          display: block;
          padding: var(--spacing-m) var(--spacing-l);
          color: var(--gr-dropdown-item-color);
          background-color: var(--gr-dropdown-item-background-color);
          border: var(--gr-dropdown-item-border);
          text-transform: var(--gr-dropdown-item-text-transform);
        }
        .bold-text {
          font-weight: var(--font-weight-medium);
        }
        md-divider {
          margin: auto;
          --md-divider-color: var(--border-color);
        }
        md-menu-item {
          --md-sys-color-on-surface: var(
            --gr-dropdown-item-color,
            var(--primary-text-color, black)
          );
          --md-sys-color-on-secondary-container: var(
            --gr-dropdown-item-color,
            var(--primary-text-color, black)
          );
          --md-sys-typescale-body-large-font: inherit;
          --md-menu-item-hover-state-layer-color: var(
            --selection-background-color
          );
          --md-menu-item-hover-state-layer-opacity: 1;
          --md-menu-item-selected-container-color: var(
            --selection-background-color
          );
          --md-focus-ring-color: var(--gr-dropdown-focus-ring-color);
          --md-menu-item-one-line-container-height: auto;
        }
        .itemAction:link,
        .itemAction:visited {
          text-decoration: none;
        }
      `]}constructor(){super(),this.downArrow=!1,this.horizontalAlign="left",this.link=!1,this.verticalOffset=0,this.opened=!1,this.disabledIds=[],this.hadKeyboardEvent=!1,this.cursor=new qb,this.onWindowResize=()=>{this.dropdown?.reposition()},this.cursor.cursorTargetAttribute="selected",this.cursor.focusOnMove=!0}willUpdate(e){e.has("opened")&&Jn(this,"opened-changed",{value:this.opened})}updated(e){if(e.has("items")&&this.resetCursorStops(),e.has("opened"))if(this.opened){if(this.resetCursorStops(),this.cursor.setCursorAtIndex(0),null!==this.cursor.target&&(this.cursor.target.focus(),Dn()&&!this.hadKeyboardEvent)){const e=this.cursor.target?.shadowRoot?.querySelector("md-item")?.querySelector("md-focus-ring");e&&(e.visible=!1)}this.setUpGlobalEventListeners()}else this.cleanUpGlobalEventListeners()}setUpGlobalEventListeners(){const e={passive:!0};window.addEventListener("resize",this.onWindowResize,e),window.addEventListener("scroll",this.onWindowResize,e)}cleanUpGlobalEventListeners(){const e={passive:!0};window.removeEventListener("resize",this.onWindowResize,e),window.removeEventListener("scroll",this.onWindowResize,e)}render(){return dc`<div class="container">
      <gr-button
        id="trigger"
        ?link=${this.link}
        class="dropdown-trigger"
        ?down-arrow=${this.downArrow}
        @click=${this.dropdownTriggerTapHandler}
        @keydown=${e=>{this.hadKeyboardEvent=!0,e.key!==Mn.DOWN&&e.key!==Mn.UP||this.dropdown?.open||(e.preventDefault(),e.stopPropagation(),this.dropdown?.show())}}
        @mousedown=${()=>{this.hadKeyboardEvent=!1}}
        @pointerdown=${()=>{this.hadKeyboardEvent=!1}}
        @touchstart=${()=>{this.hadKeyboardEvent=!1}}
      >
        <slot></slot>
      </gr-button>
      <md-menu
        default-focus="none"
        id="dropdown"
        anchor="trigger"
        tabindex="-1"
        .menuCorner=${"left"===this.horizontalAlign?"start-start":"center"===this.horizontalAlign?"start-end":"end-start"}
        .yOffset=${this.verticalOffset}
        ?quick=${!0}
        .skipRestoreFocus=${!0}
        @opened=${()=>{this.opened=!0}}
        @closed=${()=>{this.opened=!1,this.hadKeyboardEvent=!1,this.cursor.target?.removeAttribute("selected"),this.cursor.target?.blur()}}
      >
        ${this.renderDropdownContent()}
      </md-menu>
    </div>`}renderDropdownContent(){return dc`
      <div class="dropdown-content">
        ${this.renderTopContent()}
        ${(this.items??[]).map(((e,t)=>this.renderDropdownLink(e,t)))}
      </div>
    `}renderTopContent(){return this.topContent?dc`
      <div class="topContent">
        ${(this.topContent??[]).map((e=>this.renderTopContentItem(e)))}
      </div>
      <md-divider role="separator" tabindex="-1"></md-divider>
    `:uc}renderTopContentItem(e){return dc`
      <div class="${this.getClassIfBold(e.bold)} top-item" tabindex="-1">
        ${e.text}
      </div>
    `}renderDropdownLink(e,t){const i=dc`
      <md-menu-item
        data-index=${t}
        ?selected=${0===t}
        ?active=${0===t}
        ?disabled=${!!e.id&&this.disabledIds.includes(e.id)}
        @keydown=${e=>{e.key!==Mn.ENTER&&e.key!==Mn.SPACE||(e.preventDefault(),e.stopPropagation(),this.handleEnter()),e.key===Mn.UP&&(e.preventDefault(),e.stopPropagation(),this.handleUp()),e.key===Mn.DOWN&&(e.preventDefault(),e.stopPropagation(),this.handleDown())}}
      >
        ${e.name}
      </md-menu-item>
    `,r=e.url?dc`
          <a
            class="itemAction"
            href=${this.computeLinkURL(e)}
            ?download=${!!e.download}
            rel=${Vw(this.computeLinkRel(e)??void 0)}
            target=${Vw(e.target??void 0)}
            ?hidden=${!e.url}
            tabindex="-1"
          >
            ${i}
          </a>
        `:dc`<span
          class="itemAction"
          data-id=${Vw(e.id)}
          @click=${this.handleItemTap}
          ?hidden=${!!e.url}
          tabindex="-1"
          >${i}</span
        >`;return dc`
      <gr-tooltip-content
        ?has-tooltip=${!!e.tooltip}
        title=${Vw(e.tooltip)}
      >
        ${r}
      </gr-tooltip-content>
      ${t<this.items.length-1?dc`<md-divider role="separator" tabindex="-1"></md-divider>`:uc}
    `}handleUp(){this.cursor.previous()}handleDown(){this.cursor.next()}handleEnter(){if(null!==this.cursor.target){const e=this.cursor.target.shadowRoot?.querySelector(":not([hidden])");e&&e.click()}}dropdownTriggerTapHandler(e){ba(this.dropdown),e&&(e.preventDefault(),e.stopPropagation()),this.dropdown.open=!this.dropdown.open}getClassIfBold(e){return e?"bold-text":""}computeURLHelper(e,t){return"//"+e+(t.startsWith(Sf())?"":Sf())+t}computeRelativeURL(e){const t=window.location.host;return this.computeURLHelper(t,e)}computeLinkURL(e){return void 0===e.url?"":e.target||!e.url.startsWith("/")?e.url:this.computeRelativeURL(e.url)}computeLinkRel(e){return e.target?"noopener":e.external?"external":null}handleItemTap(e){if(null===e.currentTarget||!this.items)return;const t=e.currentTarget,i=t.getAttribute("data-id"),r=this.items.find((e=>e.id===i));i&&!this.disabledIds.includes(i)&&(r&&Jn(this,"tap-item",r),this.dispatchEvent(new CustomEvent("tap-item-"+i))),t.blur()}resetCursorStops(){ba(this.dropdown),this.items&&this.items.length>0&&this.dropdown.open&&(this.cursor.stops=Array.from(this.shadowRoot?.querySelectorAll("md-menu-item")??[]))}};GO([Hc("#dropdown")],zO.prototype,"dropdown",void 0),GO([Hc("#trigger")],zO.prototype,"trigger",void 0),GO([Fc({type:Array})],zO.prototype,"items",void 0),GO([Fc({type:Boolean,attribute:"down-arrow"})],zO.prototype,"downArrow",void 0),GO([Fc({type:Array})],zO.prototype,"topContent",void 0),GO([Fc({type:String,attribute:"horizontal-align"})],zO.prototype,"horizontalAlign",void 0),GO([Fc({type:Boolean})],zO.prototype,"link",void 0),GO([Fc({type:Number,attribute:"vertical-offset"})],zO.prototype,"verticalOffset",void 0),GO([Uc()],zO.prototype,"opened",void 0),GO([Fc({type:Array})],zO.prototype,"disabledIds",void 0),GO([Uc()],zO.prototype,"hadKeyboardEvent",void 0),zO=GO([Dc("gr-dropdown")],zO);var VO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let WO=class extends Ic{constructor(){super(),this.message="",this.shortcuts=new Gg(this),this.shortcuts.addLocal({key:Mn.ENTER,modifiers:[Fn.CTRL_KEY]},(()=>this.confirm())),this.shortcuts.addLocal({key:Mn.ENTER,modifiers:[Fn.META_KEY]},(e=>this.confirm()))}static get styles(){return[vy,Nc,Sd`
        :host {
          display: block;
        }
        :host([disabled]) {
          opacity: 0.5;
          pointer-events: none;
        }
        .main {
          display: flex;
          flex-direction: column;
          width: 100%;
        }
        label {
          cursor: pointer;
          display: block;
          width: 100%;
        }
        gr-autogrow-textarea {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          width: 73ch; /* Add a char to account for the border. */
        }
      `]}render(){return dc`
      <gr-dialog
        confirm-label="Abandon"
        @confirm=${e=>{this.handleConfirmTap(e)}}
        @cancel=${e=>{this.handleCancelTap(e)}}
      >
        <div class="header" slot="header">Abandon Change</div>
        <div class="main" slot="main">
          <label for="messageInput">Abandon Message</label>
          <gr-autogrow-textarea
            id="messageInput"
            class="message"
            autocomplete="on"
            placeholder="&lt;Insert reasoning here&gt;"
            .value=${this.message}
            @input=${this.handleInputChanged}
          ></gr-autogrow-textarea>
        </div>
      </gr-dialog>
    `}resetFocus(){ba(this.messageInput,"messageInput"),this.messageInput.focus()}handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),this.confirm()}confirm(){Qn(this,"confirm",{})}handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"cancel",{})}handleInputChanged(e){const t=e.target.value??"";this.message=t}};VO([Hc("#messageInput")],WO.prototype,"messageInput",void 0),VO([Fc({type:String})],WO.prototype,"message",void 0),WO=VO([Dc("gr-confirm-abandon-dialog")],WO);var qO,KO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e[e.SINGLE_CHANGE=1]="SINGLE_CHANGE",e[e.TOPIC=2]="TOPIC"}(qO||(qO={}));let YO=class extends Ic{constructor(){super(),this.branch="",this.message="",this.changes=[],this.showCherryPickTopic=!1,this.cherryPickType=qO.SINGLE_CHANGE,this.duplicateProjectChanges=!1,this.invalidBranch=!1,this.emails=[],this.selectedChangeIds=new Set,this.restApiService=Xn().restApiService,this.getChangeModel=yu(this,MT),this.reporting=Xn().reportingService,this.getNavigation=yu(this,gy),this.statuses={},this.query=e=>this.getProjectBranchesSuggestions(e),zf(this,(()=>this.getChangeModel().latestCommitter$),(e=>this.latestCommitter=e))}connectedCallback(){super.connectedCallback(),this.loadEmails()}willUpdate(e){e.has("branch")&&this.updateBranch(),(e.has("changeStatus")||e.has("commitNum")||e.has("commitMessage"))&&this.computeMessage()}static get styles(){return[Jy,vy,Nc,Sd`
        :host {
          display: block;
        }
        :host([disabled]) {
          opacity: 0.5;
          pointer-events: none;
        }
        label {
          cursor: pointer;
        }
        .main {
          display: flex;
          flex-direction: column;
          width: 100%;
        }
        .main label,
        .main input[type='text'] {
          display: block;
          width: 100%;
        }
        gr-autogrow-textarea {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          width: 73ch; /* Add a char to account for the border. */
        }
        gr-autogrow-textarea:focus {
          border: 2px solid var(--input-focus-border-color);
        }
        .cherryPickTopicLayout {
          display: flex;
          align-items: center;
          margin-top: var(--spacing-l);
          margin-bottom: var(--spacing-m);
        }
        .cherryPickSingleChange,
        .cherryPickTopic {
          margin-left: var(--spacing-m);
        }
        .cherry-pick-topic-message {
          margin-bottom: var(--spacing-m);
        }
        label[for='messageInput'],
        label[for='baseInput'] {
          margin-top: var(--spacing-m);
        }
        .title {
          font-weight: var(--font-weight-medium);
        }
        tr > td {
          padding: var(--spacing-m);
        }
        th {
          color: var(--deemphasized-text-color);
        }
        table {
          border-collapse: collapse;
        }
        tr {
          border-bottom: 1px solid var(--border-color);
        }
        .error {
          color: var(--error-text-color);
        }
        .error-message {
          color: var(--error-text-color);
          margin: var(--spacing-m) 0 var(--spacing-m) 0;
        }
      `]}render(){return dc`
      <gr-dialog
        confirm-label="Cherry Pick"
        .cancelLabel=${this.computeCancelLabel()}
        ?disabled=${this.computeDisableCherryPick()}
        title=${this.computeTitleForCherryPick()}
        @confirm=${this.handleConfirmTap}
        @cancel=${this.handleCancelTap}
      >
        <div class="header title" slot="header">
          Cherry Pick Change to Another Branch
        </div>
        <div class="main" slot="main">
          <gr-endpoint-decorator name="cherrypick-main">
            <gr-endpoint-param name="changes" .value=${this.changes}>
            </gr-endpoint-param>
            <gr-endpoint-slot name="top"></gr-endpoint-slot>
            ${eb(this.showCherryPickTopic,(()=>this.renderCherrypickTopicLayout()))}
            <label for="branchInput"> Cherry Pick to branch </label>
            <gr-autocomplete
              id="branchInput"
              .text=${this.branch}
              .query=${this.query}
              placeholder="Destination branch"
              .showBlueFocusBorder=${!0}
              @text-changed=${e=>this.branch=e.detail.value}
            >
            </gr-autocomplete>
            ${eb(this.invalidBranch,(()=>dc`
                <span class="error"
                  >Branch name cannot contain space or commas.</span
                >
              `))}
            ${((e,t)=>{for(const i of t)if(i[0]===e)return(0,i[1])()})(this.cherryPickType,[[qO.SINGLE_CHANGE,()=>this.renderCherrypickSingleChangeInputs()],[qO.TOPIC,()=>this.renderCherrypickTopicTable()]])}
            <gr-endpoint-slot name="bottom"></gr-endpoint-slot>
          </gr-endpoint-decorator>
        </div>
      </gr-dialog>
    `}renderCherrypickTopicLayout(){return dc`
      <div class="cherryPickTopicLayout">
        <md-radio
          name="cherryPickOptions"
          id="cherryPickSingleChange"
          checked
          @change=${this.handlecherryPickSingleChangeClicked}
        >
        </md-radio>
        <label for="cherryPickSingleChange" class="cherryPickSingleChange">
          Cherry Pick single change
        </label>
      </div>
      <div class="cherryPickTopicLayout">
        <md-radio
          name="cherryPickOptions"
          id="cherryPickTopic"
          @change=${this.handlecherryPickTopicClicked}
        >
        </md-radio>
        <label for="cherryPickTopic" class="cherryPickTopic">
          Cherry Pick entire topic (${this.changesCount} Changes)
        </label>
      </div>
    `}renderCherrypickSingleChangeInputs(){return dc`
      <label for="baseInput"> Provide base commit sha1 for cherry-pick </label>
      <md-outlined-text-field
        id="baseCommitInput"
        class="showBlueFocusBorder"
        maxlength="40"
        placeholder="(optional)"
        .value=${this.baseCommit??""}
        @input=${e=>{const t=e.target;this.baseCommit=t.value}}
      >
      </md-outlined-text-field>
      <label for="messageInput"> Cherry Pick Commit Message </label>
      <gr-autogrow-textarea
        id="messageInput"
        class="message"
        autocomplete="on"
        .rows=${4}
        .maxRows=${15}
        .value=${this.message}
        @input=${e=>{const t=e.target.value??"";this.message=t}}
      ></gr-autogrow-textarea>
      ${eb(this.canShowEmailDropdown(),(()=>dc`<div id="cherryPickEmailDropdown">Cherry Pick Committer Email
            <gr-dropdown-list
                .items=${this.getEmailDropdownItems()}
                .value=${this.committerEmail??""}
                @value-change=${this.setCommitterEmail}
            >
            </gr-dropdown-list>
            <span></div>`))}
    `}renderCherrypickTopicTable(){return dc`
      <span class="error-message">${this.computeTopicErrorMessage()}</span>
      <span class="cherry-pick-topic-message">
        Commit Message will be auto generated
      </span>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>Change</th>
            <th>Status</th>
            <th>Subject</th>
            <th>Project</th>
            <th>Progress</th>
            <!-- Error Message -->
            <th></th>
          </tr>
        </thead>
        <tbody>
          ${this.changes.map((e=>dc`
              <tr>
                <td>
                  <md-checkbox
                    data-item=${e.id}
                    ?checked=${this.isChangeSelected(e.id)}
                    @change=${this.toggleChangeSelected}
                  ></md-checkbox>
                </td>
                <td><span> ${this.getChangeId(e)} </span></td>
                <td><span> ${e.status} </span></td>
                <td>
                  <span>
                    ${Fg(e.subject,50)}
                  </span>
                </td>
                <td><span> ${e.project} </span></td>
                <td>
                  <span class=${this.computeStatusClass(e,this.statuses)}>
                    ${this.computeStatus(e,this.statuses)}
                  </span>
                </td>
                <td>
                  <span class="error">
                    ${this.computeError(e,this.statuses)}
                  </span>
                </td>
              </tr>
            `))}
        </tbody>
      </table>
    `}computeTitleForCherryPick(){return this.computeDisableCherryPick()?this.noChangesSelected()?"Disabled because no changes are selected":this.branch?this.cherryPickType===qO.TOPIC&&this.duplicateProjectChanges?"Duplicate projects selected":"Cherry pick button disabled":"Disabled because no branch is selected":"Cherry pick changes"}containsDuplicateProject(e){const t={};for(let i=0;i<e.length;i++){const r=e[i];if(t[r.project])return!0;t[r.project]=!0}return!1}updateChanges(e){this.changes=e,this.statuses={},e.forEach((e=>{this.selectedChangeIds.add(e.id)})),this.duplicateProjectChanges=this.containsDuplicateProject(e),this.changesCount=e.length,this.showCherryPickTopic=e.length>1}updateBranch(){this.invalidBranch=!(!this.branch||![","," "].some((e=>this.branch.includes(e))))}isChangeSelected(e){return this.selectedChangeIds.has(e)}toggleChangeSelected(e){const t=e.target.dataset.item;this.selectedChangeIds.has(t)?this.selectedChangeIds.delete(t):this.selectedChangeIds.add(t);const i=this.changes.filter((e=>this.selectedChangeIds.has(e.id)));this.duplicateProjectChanges=this.containsDuplicateProject(i),this.selectedChangeIds=new Set(this.selectedChangeIds)}computeTopicErrorMessage(){return this.duplicateProjectChanges?"Two changes cannot be of the same project":""}updateStatus(e,t){this.statuses={...this.statuses,[e.id]:t}}computeStatus(e,t){return e&&t&&t[e.id]?t[e.id].status:lg.NOT_STARTED}computeStatusClass(e,t){return e&&t&&t[e.id]&&t[e.id].status===lg.FAILED?"error":""}computeError(e,t){return e&&t&&t[e.id]&&t[e.id].status===lg.FAILED?t[e.id].msg:""}getChangeId(e){return e.change_id.substring(0,10)}computeCancelLabel(){const e=Object.values(this.statuses).some((e=>e.status===lg.RUNNING));return e?"Close":"Cancel"}noChangesSelected(){const e=this.changes.filter((e=>this.selectedChangeIds.has(e.id)));return this.cherryPickType===qO.TOPIC&&0===e.length}computeDisableCherryPick(){if(!this.branch)return!0;if(this.noChangesSelected())return!0;if(this.cherryPickType===qO.TOPIC&&this.duplicateProjectChanges)return!0;if(!this.statuses)return!1;const e=Object.values(this.statuses).some((e=>e.status===lg.RUNNING));return e}handlecherryPickSingleChangeClicked(){this.cherryPickType=qO.SINGLE_CHANGE,Jn(this,"iron-resize",{})}handlecherryPickTopicClicked(){this.cherryPickType=qO.TOPIC,Jn(this,"iron-resize",{})}computeMessage(){if(void 0===this.changeStatus||void 0===this.commitNum||void 0===this.commitMessage)return;let e=this.commitMessage;"MERGED"===this.changeStatus&&(e.endsWith("\n")||(e+="\n"),e+="(cherry picked from commit "+this.commitNum+")"),this.message=e}generateRandomCherryPickTopic(e){return`cherrypick-${e.topic}-${$a()}`}handleCherryPickFailed(e,t){t&&t.text().then((t=>{this.updateStatus(e,{status:lg.FAILED,msg:t})}))}handleCherryPickTopic(){const e=this.changes.filter((e=>this.selectedChangeIds.has(e.id)));if(!e.length)return;const t=this.generateRandomCherryPickTopic(e[0]);e.forEach((e=>{this.updateStatus(e,{status:lg.RUNNING});const i={destination:this.branch,base:null,topic:t,allow_conflicts:!0,allow_empty:!0},r=e.revisions[e.current_revision]._number;this.restApiService.executeChangeAction(e._number,Uu.POST,"/cherrypick",r,i,(t=>{this.handleCherryPickFailed(e,t)})).then((i=>{if(!i.ok)return;this.updateStatus(e,{status:lg.SUCCESSFUL});const r=Object.values(this.statuses).find((e=>e.status!==lg.SUCCESSFUL));r||this.getNavigation().setUrl(tE({topic:t}))}))}))}handleConfirmTap(e){if(e.preventDefault(),e.stopPropagation(),this.cherryPickType===qO.TOPIC)return this.reporting.reportInteraction("cherry-pick-topic-clicked",{}),void this.handleCherryPickTopic();Qn(this,"confirm",{})}handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"cancel",{})}resetFocus(){this.branchInput.focus()}async getProjectBranchesSuggestions(e){return this.project?this.restApiService.getRepoBranches(Bx(e),this.project,15,void 0,Ff).then((e=>{if(!e)return[];const t=[];for(const i of e)t.push({name:Bx(i.ref)});return t})):Promise.reject(new Error("Missing project"))}async loadEmails(){const e=await this.restApiService.getAccountEmails()??[];let t;e.forEach((e=>{e.preferred&&(t=e.email)})),e.some((e=>e.email===this.latestCommitter?.email))&&(t=this.latestCommitter?.email),this.emails=e,this.committerEmail=t}canShowEmailDropdown(){return this.emails.length>1}getEmailDropdownItems(){return this.emails.map((e=>({text:e.email,value:e.email})))}setCommitterEmail(e){this.committerEmail=e.detail.value}};KO([Fc({type:String})],YO.prototype,"branch",void 0),KO([Fc({type:String})],YO.prototype,"baseCommit",void 0),KO([Fc({type:String})],YO.prototype,"changeStatus",void 0),KO([Fc({type:String})],YO.prototype,"commitMessage",void 0),KO([Fc({type:String})],YO.prototype,"commitNum",void 0),KO([Fc({type:String})],YO.prototype,"message",void 0),KO([Fc({type:String})],YO.prototype,"project",void 0),KO([Fc({type:Array})],YO.prototype,"changes",void 0),KO([Uc()],YO.prototype,"query",void 0),KO([Uc()],YO.prototype,"showCherryPickTopic",void 0),KO([Uc()],YO.prototype,"changesCount",void 0),KO([Uc()],YO.prototype,"cherryPickType",void 0),KO([Uc()],YO.prototype,"duplicateProjectChanges",void 0),KO([Uc()],YO.prototype,"statuses",void 0),KO([Uc()],YO.prototype,"invalidBranch",void 0),KO([Uc()],YO.prototype,"emails",void 0),KO([Hc("#branchInput")],YO.prototype,"branchInput",void 0),KO([Uc()],YO.prototype,"committerEmail",void 0),KO([Uc()],YO.prototype,"latestCommitter",void 0),KO([Uc()],YO.prototype,"selectedChangeIds",void 0),YO=KO([Dc("gr-confirm-cherrypick-dialog")],YO);var XO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let JO=class extends Ic{static get styles(){return[Nc,Sd`
        :host {
          display: block;
        }
        :host([disabled]) {
          opacity: 0.5;
          pointer-events: none;
        }
        .main {
          display: flex;
          flex-direction: column;
          width: 100%;
        }
      `]}render(){return dc`
      <gr-dialog
        confirm-label="Continue"
        @confirm=${this.handleConfirmTap}
        @cancel=${this.handleCancelTap}
      >
        <div class="header" slot="header">Cherry Pick Conflict!</div>
        <div class="main" slot="main">
          <span>Cherry Pick failed! (merge conflicts)</span>
          <span
            >Please select "Continue" to continue with conflicts or select
            "cancel" to close the dialog.</span
          >
        </div>
      </gr-dialog>
    `}handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"confirm",{})}handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"cancel",{})}};JO=XO([Dc("gr-confirm-cherrypick-conflict-dialog")],JO);var QO=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let ZO=class extends Ic{constructor(){super(),this.branch="",this.message="",this.shortcuts=new Gg(this),this.restApiService=Xn().restApiService,this.shortcuts.addLocal({key:Mn.ENTER,modifiers:[Fn.CTRL_KEY]},(e=>this.handleConfirmTap(e))),this.shortcuts.addLocal({key:Mn.ENTER,modifiers:[Fn.META_KEY]},(e=>this.handleConfirmTap(e)))}disconnectedCallback(){super.disconnectedCallback()}connectedCallback(){super.connectedCallback()}static get styles(){return[vy,Nc,Sd`
        :host {
          display: block;
          width: 30em;
        }
        :host([disabled]) {
          opacity: 0.5;
          pointer-events: none;
        }
        label {
          cursor: pointer;
        }
        .main {
          display: flex;
          flex-direction: column;
          width: 100%;
        }
        .main label,
        .main input[type='text'] {
          display: block;
          width: 100%;
        }
        .main .message {
          width: 100%;
        }
        .warning {
          color: var(--error-text-color);
        }
        gr-autogrow-textarea:focus {
          border: 2px solid var(--input-focus-border-color);
        }
        label[for='branchInput'],
        label[for='messageInput'] {
          margin-top: var(--spacing-m);
        }
      `]}render(){return dc`
      <gr-dialog
        confirm-label="Move Change"
        @confirm=${e=>this.handleConfirmTap(e)}
        @cancel=${e=>this.handleCancelTap(e)}
      >
        <div class="header" slot="header">Move Change to Another Branch</div>
        <div class="main" slot="main">
          <p class="warning">
            Warning: moving a change will not change its parents.
          </p>
          <label for="branchInput"> Move change to branch </label>
          <gr-autocomplete
            id="branchInput"
            .text=${this.branch}
            .showBlueFocusBorder=${!0}
            @text-changed=${e=>this.branch=e.detail.value}
            .query=${e=>this.getProjectBranchesSuggestions(e)}
            placeholder="Destination branch"
          >
          </gr-autocomplete>
          <label for="messageInput"> Move Change Message </label>
          <gr-autogrow-textarea
            id="messageInput"
            class="message"
            autocomplete="on"
            .rows=${4}
            .maxRows=${15}
            .value=${this.message}
            @input=${e=>{const t=e.target.value??"";this.message=t}}
          ></gr-autogrow-textarea>
        </div>
      </gr-dialog>
    `}handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"confirm",{})}handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"cancel",{})}getProjectBranchesSuggestions(e){return this.project?this.restApiService.getRepoBranches(Bx(e),this.project,15,void 0,Ff).then((e=>{if(!e)return[];const t=[];for(const i of e)t.push({name:Bx(i.ref)});return t})):Promise.reject(new Error("Missing project"))}};QO([Fc({type:String})],ZO.prototype,"branch",void 0),QO([Fc({type:String})],ZO.prototype,"message",void 0),QO([Fc({type:String})],ZO.prototype,"project",void 0),ZO=QO([Dc("gr-confirm-move-dialog")],ZO);var eD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let tD=class extends Ic{constructor(){super(...arguments),this.isOptionSelected=new Map}static get styles(){return[Jy,Sd`
        :host {
          display: block;
        }
        div.checkbox-container {
          display: flex;
          align-items: center;
          gap: var(--spacing-m);
          margin-top: var(--spacing-l);
        }
        label {
          cursor: pointer;
        }
      `]}init(){this.isOptionSelected=new Map}getSelectedOptions(){return(this.validationOptions?.validation_options??[]).filter((e=>this.isOptionSelected.get(e.name)))}render(){if(this.validationOptions)return dc`${Mw(this.validationOptions.validation_options,(e=>e.name),(e=>this.renderValidationOption(e)))}`}renderValidationOption(e){return dc`
      <div class="checkbox-container">
        <md-checkbox
          class="selectionLabel"
          id=${e.name}
          ?checked=${!!this.isOptionSelected.get(e.name)}
          @change=${()=>this.toggleCheckbox(e)}
        ></md-checkbox>
        <label for=${e.name}
          >${Mg(e.description)}</label
        >
      </div>
    `}toggleCheckbox(e){this.isOptionSelected.set(e.name,!this.isOptionSelected.get(e.name))}};eD([Fc({type:Object})],tD.prototype,"validationOptions",void 0),tD=eD([Dc("gr-validation-options")],tD);var iD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let rD=class extends Ic{constructor(){super(),this.text="",this.query=e=>this.getChangeSuggestions(e),this.recentChanges=[],this.restApiService=Xn().restApiService}connectedCallback(){super.connectedCallback()}static get styles(){return Sd`
      :host {
        display: block;
      }
      gr-autocomplete {
        width: 100%;
      }
    `}render(){return dc`
      <gr-autocomplete
        .query=${this.query}
        .text=${this.text}
        @text-changed=${e=>{this.text=e.detail.value}}
        allow-non-suggested-values
        placeholder="Change number or subject"
      >
      </gr-autocomplete>
    `}async fetchRecentChanges(){try{const e=await this.restApiService.getChanges(450,"is:open -age:90d",void 0,void 0,Ff);if(!e)return this.recentChanges=[],this.recentChanges;const t=[];for(const i of e)t.push({description:`${i._number}: ${i.subject}`,changeNum:i._number});this.recentChanges=t}catch(e){console.error("Failed to fetch recent changes:",e),this.recentChanges=[]}return this.recentChanges}getRecentChanges(){return this.recentChanges.length>0?Promise.resolve(this.recentChanges):this.fetchRecentChanges()}getChangeSuggestions(e){return this.getRecentChanges().then((t=>this.filterChanges(e,t)))}filterChanges(e,t){return t.filter((t=>t.description.includes(e)&&(void 0===this.excludeChangeNum||t.changeNum!==this.excludeChangeNum))).map((e=>({name:e.description,value:`${e.changeNum}`})))}};iD([Fc({type:String})],rD.prototype,"text",void 0),iD([Fc({type:Number})],rD.prototype,"excludeChangeNum",void 0),iD([Uc()],rD.prototype,"query",void 0),iD([Uc()],rD.prototype,"recentChanges",void 0),rD=iD([Dc("gr-change-autocomplete")],rD);const oD={relatedChanges:void 0,submittedTogether:void 0,cherryPicks:void 0,conflictingChanges:void 0,sameTopicChanges:void 0,revertingChanges:[]},sD=mu("related-changes-model");class nD extends df{constructor(e,t,i){super(oD),this.changeModel=e,this.configModel=t,this.restApiService=i,this.relatedChanges$=lf(this.state$,(e=>e.relatedChanges)),this.submittedTogether$=lf(this.state$,(e=>e.submittedTogether)),this.cherryPicks$=lf(this.state$,(e=>e.cherryPicks)),this.conflictingChanges$=lf(this.state$,(e=>e.conflictingChanges)),this.sameTopicChanges$=lf(this.state$,(e=>e.sameTopicChanges)),this.revertingChanges$=lf(this.state$,(e=>e.revertingChanges)),this.revertingChange$=lf(this.revertingChanges$,(e=>{if(0===e.length)return;const t=e.find((e=>e.status===Nu.MERGED));return t||e[0]})),this.hasParent$=lf(Yh([this.changeModel.change$,this.relatedChanges$]),(([e,t])=>{if(e&&void 0!==t)return 0!==t.length&&t[t.length-1].change_id!==e.change_id})),this.subscriptions=[this.loadRelatedChanges(),this.loadSubmittedTogether(),this.loadCherryPicks(),this.loadConflictingChanges(),this.loadSameTopicChanges(),this.loadRevertingChanges()]}loadRelatedChanges(){return Yh([this.changeModel.changeNum$,this.changeModel.latestPatchNum$]).pipe(Vp((([e,t])=>e&&t?Qh(this.restApiService.getRelatedChanges(e,t).then((e=>e?.changes??[]))):Zh(void 0)))).subscribe((e=>{this.updateState({relatedChanges:e})}))}loadSubmittedTogether(){return this.changeModel.changeNum$.pipe(Vp((e=>e?Qh(this.restApiService.getChangesSubmittedTogether(e)):Zh(void 0)))).subscribe((e=>{this.updateState({submittedTogether:e})}))}loadCherryPicks(){return Yh([this.changeModel.branch$,this.changeModel.changeId$,this.changeModel.repo$]).pipe(Vp((([e,t,i])=>e&&t&&i?Qh(this.restApiService.getChangeCherryPicks(i,t,e)):Zh(void 0)))).subscribe((e=>{this.updateState({cherryPicks:e})}))}loadConflictingChanges(){return Yh([this.changeModel.changeNum$,this.changeModel.status$,this.changeModel.mergeable$]).pipe(Vp((([e,t,i])=>e&&t&&i?t!==Nu.NEW?Zh(void 0):Qh(this.restApiService.getChangeConflicts(e)):Zh(void 0)))).subscribe((e=>{this.updateState({conflictingChanges:e})}))}loadSameTopicChanges(){return Yh([this.changeModel.changeNum$,this.changeModel.topic$,this.configModel.serverConfig$]).pipe(Vp((([e,t,i])=>e&&t&&i?i.change.submit_whole_topic?Zh(void 0):Qh(this.restApiService.getChangesWithSameTopic(t,{openChangesOnly:!0,changeToExclude:e})):Zh(void 0)))).subscribe((e=>{this.updateState({sameTopicChanges:e})}))}loadRevertingChanges(){return this.changeModel.revertingChangeIds$.pipe(Vp((e=>e?.length?Qm(e.map((e=>Qh(this.restApiService.getChange(e))))):Zh([]))),ep((e=>e.filter(cf))),ep((e=>e.filter((e=>e.status!==Nu.ABANDONED))))).subscribe((e=>{this.updateState({revertingChanges:e})}))}}var aD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let lD=class extends Ic{constructor(){super(),this.disableActions=!1,this.loading=!1,this.text="",this.shouldRebaseChain=!1,this.allowConflicts=!1,this.currentUserEmails=[],this.uploaderEmails=[],this.committerEmailDropdownItems=[],this.restApiService=Xn().restApiService,this.getChangeModel=yu(this,MT),this.getUserModel=yu(this,jf),this.getRelatedChangesModel=yu(this,sD),zf(this,(()=>this.getUserModel().account$),(e=>this.account=e)),zf(this,(()=>this.getChangeModel().latestUploader$),(e=>this.uploader=e)),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getRelatedChangesModel().hasParent$),(e=>this.hasParent=e)),zf(this,(()=>this.getChangeModel().latestCommitter$),(e=>this.latestCommitter=e))}connectedCallback(){super.connectedCallback(),this.loadCommitterEmailDropdownItems()}static get styles(){return[vy,Nc,Jy,Sd`
        :host {
          display: block;
          width: 30em;
        }
        :host([disabled]) {
          opacity: 0.5;
          pointer-events: none;
        }
        label {
          cursor: pointer;
        }
        .message {
          font-style: italic;
        }
        .parentRevisionContainer {
          margin-top: var(--spacing-m);
        }
        .parentRevisionContainer label,
        .parentRevisionContainer input[type='text'] {
          display: block;
          width: 100%;
        }
        div.rebaseOption,
        div.checkbox-container {
          display: flex;
          align-items: center;
          gap: var(--spacing-m);
          margin-top: var(--spacing-xl);
        }
        .rebaseCheckbox {
          margin-top: var(--spacing-xl);
        }
        .rebaseOnBehalfMsg {
          margin-top: var(--spacing-m);
        }
        .rebaseWithCommitterEmail {
          margin-top: var(--spacing-m);
        }
        .main {
          margin-top: var(--spacing-xl);
          margin-bottom: var(--spacing-xl);
        }
        @media screen and (max-width: 50em) {
          #confirmDialog {
            height: 90vh;
          }
        }
      `]}render(){return dc`
      <gr-dialog
        id="confirmDialog"
        confirm-label="Rebase"
        .disabled=${this.disableActions}
        @confirm=${this.handleConfirmTap}
        @cancel=${this.handleCancelTap}
      >
        <div class="header" slot="header">Confirm rebase</div>
        <div class="main" slot="main">
          ${eb(this.loading,(()=>dc`<div>Loading...</div>`),(()=>this.renderRebaseDialog()))}
        </div>
      </gr-dialog>
    `}renderRebaseDialog(){return dc`<div
        id="rebaseOnParent"
        class="rebaseOption loading"
        ?hidden=${!this.displayParentOption()||this.loading}
      >
        <md-radio
          id="rebaseOnParentInput"
          name="rebaseOptions"
          ?checked=${this.displayParentOption()}
        >
        </md-radio>
        <label id="rebaseOnParentLabel" for="rebaseOnParentInput">
          Rebase on parent change
        </label>
      </div>
      <div class="message" ?hidden=${void 0!==this.hasParent}>
        Still loading parent information ...
      </div>
      <div
        id="parentUpToDateMsg"
        class="message"
        ?hidden=${!this.displayParentUpToDateMsg()}
      >
        This change is up to date with its parent.
      </div>
      <div
        id="rebaseOnTip"
        class="rebaseOption"
        ?hidden=${!this.displayTipOption()}
      >
        <md-radio
          id="rebaseOnTipInput"
          name="rebaseOptions"
          ?checked=${!this.displayParentOption()&&this.displayTipOption()}
          ?disabled=${!this.displayTipOption()}
        >
        </md-radio>
        <label id="rebaseOnTipLabel" for="rebaseOnTipInput">
          Rebase on top of the ${this.branch} branch<span
            ?hidden=${!this.hasParent||this.shouldRebaseChain}
          >
            (breaks relation chain)
          </span>
        </label>
      </div>
      <div
        id="tipUpToDateMsg"
        class="message"
        ?hidden=${this.displayTipOption()}
      >
        Change is up to date with the target branch already (${this.branch})
      </div>
      <div id="rebaseOnOther" class="rebaseOption">
        <md-radio
          id="rebaseOnOtherInput"
          name="rebaseOptions"
          ?checked=${!this.displayParentOption()&&!this.displayTipOption()}
          @click=${this.handleRebaseOnOther}
        >
        </md-radio>
        <label id="rebaseOnOtherLabel" for="rebaseOnOtherInput">
          Rebase on a specific change, ref, or commit
          <span ?hidden=${!this.hasParent||this.shouldRebaseChain}>
            (breaks relation chain)
          </span>
        </label>
      </div>
      <div class="parentRevisionContainer">
        <gr-change-autocomplete
          .text=${this.text}
          .excludeChangeNum=${this.changeNum}
          @text-changed=${e=>this.text=e.detail.value}
          @click=${this.handleEnterChangeNumberClick}
        >
        </gr-change-autocomplete>
      </div>
      <div class="rebaseCheckbox">
        <div class="checkbox-container">
          <md-checkbox
            id="rebaseAllowConflicts"
            @change=${()=>{this.allowConflicts=!!this.rebaseAllowConflicts?.checked,this.loadCommitterEmailDropdownItems()}}
          ></md-checkbox>
          <label for="rebaseAllowConflicts">Allow rebase with conflicts</label>
        </div>
        ${eb(!this.isCurrentUserEqualToLatestUploader()&&this.allowConflicts,(()=>dc`<span class="message"
              >Rebase cannot be done on behalf of the uploader when allowing
              conflicts.</span
            >`))}
        <gr-validation-options
          .validationOptions=${this.validationOptions}
        ></gr-validation-options>
      </div>
      ${eb(this.hasParent,(()=>dc`<div class="rebaseCheckbox">
            <div class="checkbox-container">
              <md-checkbox
                id="rebaseChain"
                @change=${()=>{this.shouldRebaseChain=!!this.rebaseChain?.checked,this.shouldRebaseChain&&(this.selectedEmailForRebase=void 0)}}
              ></md-checkbox>
              <label for="rebaseChain">Rebase all ancestors</label>
            </div>
          </div>`))}
      ${eb(!this.isCurrentUserEqualToLatestUploader(),(()=>dc`<div class="rebaseOnBehalfMsg">Rebase will be done on behalf of${this.allowConflicts?"":" the uploader:"} <gr-account-chip
                .account=${this.allowConflicts?this.account:this.uploader}
              ></gr-account-chip
              ><span></div>`))}
      ${eb(this.canShowCommitterEmailDropdown(),(()=>dc`<div class="rebaseWithCommitterEmail"
            >Rebase with committer email
                <gr-dropdown-list
                    .items=${this.getCommitterEmailDropdownItems()}
                    .value=${this.selectedEmailForRebase??""}
                    @value-change=${this.handleCommitterEmailDropdownItems}
                >
                </gr-dropdown-list>
                <span></div>`))}`}getValidationOptions(){return this.validationOptionsEl?.getSelectedOptions()??[]}initiateFetchInfo(){this.fetchValidationOptions(),this.fetchRecentChanges()}async fetchRecentChanges(){this.loading=!0;try{await this.changeAutocomplete.fetchRecentChanges()}finally{this.loading=!1}}async fetchValidationOptions(){this.validationOptions={validation_options:[]},this.changeNum&&(this.validationOptions=await this.restApiService.getValidationOptions(this.changeNum))}isCurrentUserEqualToLatestUploader(){return!this.account||!this.uploader||this.account._account_id===this.uploader._account_id}setPreferredAsSelectedEmailForRebase(e){e.forEach((e=>{e.preferred&&(this.selectedEmailForRebase=e.email)}))}canShowCommitterEmailDropdown(){return this.committerEmailDropdownItems&&this.committerEmailDropdownItems.length>1&&!this.shouldRebaseChain}getCommitterEmailDropdownItems(){return this.committerEmailDropdownItems?.map((e=>({text:e.email,value:e.email})))}isLatestCommitterEmailInDropdownItems(){return this.committerEmailDropdownItems?.some((e=>e.email===this.latestCommitter?.email.toString()))}setSelectedEmailForRebase(){this.isLatestCommitterEmailInDropdownItems()?this.selectedEmailForRebase=this.latestCommitter?.email:this.setPreferredAsSelectedEmailForRebase(this.committerEmailDropdownItems)}async loadCommitterEmailDropdownItems(){if(this.isCurrentUserEqualToLatestUploader()||this.allowConflicts){const e=await this.restApiService.getAccountEmails();this.committerEmailDropdownItems=e||[]}else if(this.uploader&&this.uploader.email){const e=await this.restApiService.getAccountEmailsFor(this.uploader.email.toString(),(()=>{}));this.committerEmailDropdownItems=e||[]}else this.committerEmailDropdownItems=[];this.committerEmailDropdownItems&&this.setSelectedEmailForRebase()}handleCommitterEmailDropdownItems(e){this.selectedEmailForRebase=e.detail.value}displayParentOption(){return this.hasParent&&this.rebaseOnCurrent}displayParentUpToDateMsg(){return this.hasParent&&!this.rebaseOnCurrent}displayTipOption(){return!!this.rebaseOnCurrent||!!this.hasParent}getSelectedBase(){return this.rebaseOnParentInput?.checked?null:this.rebaseOnTipInput?.checked?"":this.text?this.text.split(":")[0]:""}handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),Zn(this,"confirm-rebase",{base:this.getSelectedBase(),allowConflicts:!!this.rebaseAllowConflicts?.checked,rebaseChain:!!this.rebaseChain?.checked,onBehalfOfUploader:this.rebaseOnBehalfOfUploader(),committerEmail:this.rebaseChain?.checked?null:this.selectedEmailForRebase||null}),this.text=""}rebaseOnBehalfOfUploader(){return!this.allowConflicts}handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Zn(this,"cancel",{}),this.text=""}handleRebaseOnOther(){this.changeAutocomplete.focus()}handleEnterChangeNumberClick(){this.rebaseOnOtherInput&&(this.rebaseOnOtherInput.checked=!0)}};aD([Fc({type:String})],lD.prototype,"branch",void 0),aD([Fc({type:Boolean})],lD.prototype,"rebaseOnCurrent",void 0),aD([Fc({type:Boolean})],lD.prototype,"disableActions",void 0),aD([Uc()],lD.prototype,"loading",void 0),aD([Uc()],lD.prototype,"changeNum",void 0),aD([Uc()],lD.prototype,"hasParent",void 0),aD([Uc()],lD.prototype,"text",void 0),aD([Uc()],lD.prototype,"shouldRebaseChain",void 0),aD([Uc()],lD.prototype,"allowConflicts",void 0),aD([Uc()],lD.prototype,"selectedEmailForRebase",void 0),aD([Uc()],lD.prototype,"currentUserEmails",void 0),aD([Uc()],lD.prototype,"uploaderEmails",void 0),aD([Uc()],lD.prototype,"committerEmailDropdownItems",void 0),aD([Hc("#rebaseOnParentInput")],lD.prototype,"rebaseOnParentInput",void 0),aD([Hc("#rebaseOnTipInput")],lD.prototype,"rebaseOnTipInput",void 0),aD([Hc("#rebaseOnOtherInput")],lD.prototype,"rebaseOnOtherInput",void 0),aD([Hc("#rebaseAllowConflicts")],lD.prototype,"rebaseAllowConflicts",void 0),aD([Hc("#rebaseChain")],lD.prototype,"rebaseChain",void 0),aD([Hc("gr-change-autocomplete")],lD.prototype,"changeAutocomplete",void 0),aD([Hc("gr-validation-options")],lD.prototype,"validationOptionsEl",void 0),aD([Uc()],lD.prototype,"validationOptions",void 0),aD([Uc()],lD.prototype,"account",void 0),aD([Uc()],lD.prototype,"uploader",void 0),aD([Uc()],lD.prototype,"latestCommitter",void 0),lD=aD([Dc("gr-confirm-rebase-dialog")],lD);var dD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const cD="Unable to find the commit hash of this change.",hD="<MUST SPECIFY REASON HERE>";var pD;!function(e){e[e.REVERT_SINGLE_CHANGE=1]="REVERT_SINGLE_CHANGE",e[e.REVERT_SUBMISSION=2]="REVERT_SUBMISSION"}(pD||(pD={}));let uD=class extends Ic{constructor(){super(...arguments),this.message="",this.revertType=pD.REVERT_SINGLE_CHANGE,this.showRevertSubmission=!1,this.showErrorMessage=!1,this.originalRevertMessages=[],this.revertMessages=[],this.getPluginLoader=yu(this,U_)}static get styles(){return[vy,Nc,Jy,Sd`
        :host {
          display: block;
        }
        :host([disabled]) {
          opacity: 0.5;
          pointer-events: none;
        }
        label {
          cursor: pointer;
          display: block;
          width: 100%;
        }
        .revertSubmissionLayout {
          display: flex;
          align-items: center;
          margin-top: var(--spacing-l);
          margin-bottom: var(--spacing-m);
        }
        .label {
          margin-left: var(--spacing-m);
        }
        gr-autogrow-textarea {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          width: 73ch; /* Add a char to account for the border. */
        }
        gr-autogrow-textarea:focus {
          border: 2px solid var(--input-focus-border-color);
        }
        .error {
          color: var(--error-text-color);
          margin-bottom: var(--spacing-m);
        }
        label[for='messageInput'] {
          margin-top: var(--spacing-m);
        }
        gr-validation-options {
          margin-bottom: var(--spacing-m);
        }
      `]}render(){return dc`
      <gr-dialog
        .confirmLabel=${"Create Revert Change"}
        @confirm=${e=>this.handleConfirmTap(e)}
        @cancel=${e=>this.handleCancelTap(e)}
      >
        <div class="header" slot="header">Revert Merged Change</div>
        <div class="main" slot="main">
          <div class="error" ?hidden=${!this.showErrorMessage}>
            <span> A reason is required </span>
          </div>
          ${this.showRevertSubmission?dc`
                <div class="revertSubmissionLayout">
                  <md-radio
                    id="revertSingleChange"
                    name="revertOptions"
                    ?checked=${this.computeIfSingleRevert()}
                    @change=${()=>this.handleRevertSingleChangeClicked()}
                  >
                  </md-radio>
                  <label
                    for="revertSingleChange"
                    class="label revertSingleChange"
                  >
                    Revert single change
                  </label>
                </div>
                <div class="revertSubmissionLayout">
                  <md-radio
                    id="revertSubmission"
                    name="revertOptions"
                    ?checked=${this.computeIfRevertSubmission()}
                    @change=${()=>this.handleRevertSubmissionClicked()}
                  >
                  </md-radio>
                  <label for="revertSubmission" class="label revertSubmission">
                    Revert entire submission (${this.changesCount} Changes)
                  </label>
                </div>
              `:uc}
          <gr-endpoint-decorator name="confirm-revert-change">
            <label for="messageInput"> Revert Commit Message </label>
            <gr-autogrow-textarea
              id="messageInput"
              class="message"
              .autocomplete=${"on"}
              .maxRows=${15}
              .value=${this.message}
              @input=${e=>{const t=e.target.value??"";this.message=t}}
            ></gr-autogrow-textarea>
          </gr-endpoint-decorator>
          <gr-validation-options
            .validationOptions=${this.validationOptions}
          ></gr-validation-options>
        </div>
      </gr-dialog>
    `}getValidationOptions(){return this.validationOptionsEl?.getSelectedOptions()??[]}computeIfSingleRevert(){return this.revertType===pD.REVERT_SINGLE_CHANGE}computeIfRevertSubmission(){return this.revertType===pD.REVERT_SUBMISSION}modifyRevertMsg(e,t,i){return this.getPluginLoader().jsApiService.modifyRevertMsg(e,i,t)}populate(e,t,i,r){this.changesCount=r,this.validationOptions=t,this.populateRevertSingleChangeMessage(e,i,e.current_revision),this.populateRevertSubmissionMessage(e,i)}populateRevertSingleChangeMessage(e,t,i){if(!i)return void ea(this,cD);const r=(t||"").split("\n")[0];let o=`Revert "${r}"`;const s=r.match(/^Revert(?:\^([0-9]+))? "(.*)"$/);if(s){let e=2;s[1]&&(e=Number(s[1])+1),o=`Revert^${e} "${s[2]}"`}if(!i)return void ea(this,cD);const n=`${o}\n\nThis reverts commit ${i}.\n\nReason for revert: ${hD}\n`;this.message=this.modifyRevertMsg(e,t,n),this.revertType=pD.REVERT_SINGLE_CHANGE,this.showRevertSubmission=!1,this.revertMessages[this.revertType]=this.message,this.originalRevertMessages[this.revertType]=this.message}modifyRevertSubmissionMsg(e,t,i){return this.getPluginLoader().jsApiService.modifyRevertSubmissionMsg(e,t,i)}populateRevertSubmissionMessage(e,t){if(!e.current_revision)return void ea(this,cD);if(this.changesCount<=1)return;const i=`Revert submission ${e.submission_id}\n\nReason for revert: ${hD}\n\nReverted changes: `+tE({query:`submissionid:${e.submission_id}`})+"\n";this.message=this.modifyRevertSubmissionMsg(e,i,t),this.revertType=pD.REVERT_SUBMISSION,this.revertMessages[this.revertType]=this.message,this.originalRevertMessages[this.revertType]=this.message,this.showRevertSubmission=!0}handleRevertSingleChangeClicked(){this.showErrorMessage=!1,this.message&&(this.revertMessages[pD.REVERT_SUBMISSION]=this.message),this.message=this.revertMessages[pD.REVERT_SINGLE_CHANGE],this.revertType=pD.REVERT_SINGLE_CHANGE}handleRevertSubmissionClicked(){this.showErrorMessage=!1,this.revertType=pD.REVERT_SUBMISSION,this.message&&(this.revertMessages[pD.REVERT_SINGLE_CHANGE]=this.message),this.message=this.revertMessages[pD.REVERT_SUBMISSION]}handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),this.message===this.originalRevertMessages[this.revertType]||this.message.includes(hD)?this.showErrorMessage=!0:Jn(this,"confirm-revert",{revertType:this.revertType,message:this.message})}handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Jn(this,"cancel",{})}};dD([Uc()],uD.prototype,"message",void 0),dD([Uc()],uD.prototype,"revertType",void 0),dD([Uc()],uD.prototype,"showRevertSubmission",void 0),dD([Uc()],uD.prototype,"changesCount",void 0),dD([Uc()],uD.prototype,"validationOptions",void 0),dD([Uc()],uD.prototype,"showErrorMessage",void 0),dD([Uc()],uD.prototype,"originalRevertMessages",void 0),dD([Uc()],uD.prototype,"revertMessages",void 0),dD([Hc("gr-validation-options")],uD.prototype,"validationOptionsEl",void 0),uD=dD([Dc("gr-confirm-revert-dialog")],uD);var gD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const mD="autocomplete-hint";let fD=class extends Ic{constructor(){super(...arguments),this.disabled=!1,this.putCursorAtEndOnFocus=!1,this.enableSaveShortcut=!1,this.focused=!1,this.currentCursorPosition=-1,this.isPlaintextOnlySupported=function(){const e=document.createElement("div");try{return e.contentEditable="PLAINTEXT-ONLY","plaintext-only"===e.contentEditable}catch(e){return!1}}()}set hint(e){this.hint!==e&&(this.innerHint=e,this.updateHintInDomIfRendered())}get hint(){return this.innerHint}set value(e){this.ignoreValue&&this.ignoreValue===e||this.value!==e&&(this.innerValue=e,this.updateValueInDom())}get value(){return this.innerValue}get isFocused(){return this.focused}get nativeElement(){return this.editableDivElement}get scrollTop(){return this.editableDivElement?.scrollTop??0}static get styles(){return[Sd`
        :host {
          display: inline-block;
          position: relative;
          width: 100%;
        }

        :host([disabled]) {
          .editableDiv {
            background-color: var(--input-field-disabled-bg, lightgrey);
            color: var(--text-disabled, black);
            cursor: default;
          }
        }

        .editableDiv {
          background-color: var(--input-field-bg, white);
          border: var(--gr-textarea-border-width, 2px) solid
            var(--gr-textarea-border-color, white);
          border-radius: 4px;
          box-sizing: border-box;
          color: var(--text-default, black);
          max-height: var(--gr-textarea-max-height, 16em);
          min-height: var(--gr-textarea-min-height, 4em);
          overflow-x: auto;
          padding: var(--gr-textarea-padding, 12px);
          white-space: pre-wrap;
          width: 100%;

          &:focus-visible {
            border-color: var(--gr-textarea-focus-outline-color, black);
            outline: none;
          }

          &:empty::before {
            content: attr(data-placeholder);
            color: var(--text-secondary, lightgrey);
            display: inline;
            pointer-events: none;
          }

          &.hintShown:empty::after,
          .autocomplete-hint:empty::after {
            background-color: var(--secondary-bg-color, white);
            border: 1px solid var(--text-secondary, lightgrey);
            border-radius: 2px;
            content: 'tab';
            color: var(--text-secondary, lightgrey);
            display: inline;
            pointer-events: none;
            font-size: 10px;
            line-height: 10px;
            margin-left: 4px;
            padding: 1px 3px;
          }

          .autocomplete-hint {
            &:empty::before {
              content: attr(data-hint);
              color: var(--text-secondary, lightgrey);
            }
          }
        }
      `]}render(){const e=(!this.disabled&&this.placeholderHint)??!1,t=e?this.placeholderHint:this.placeholder,i=e?(this.placeholderHint??"")+"Press TAB to accept the placeholder hint.":t,r=th({editableDiv:!0,hintShown:e});return dc`<div
      aria-disabled=${this.disabled}
      aria-multiline="true"
      aria-placeholder=${Vw(i)}
      data-placeholder=${Vw(t)}
      class=${r}
      contenteditable=${this.contentEditableAttributeValue}
      dir="ltr"
      role="textbox"
      spellcheck="true"
      @input=${this.onInput}
      @focus=${this.onFocus}
      @blur=${this.onBlur}
      @keydown=${this.handleKeyDown}
      @keyup=${this.handleKeyUp}
      @mouseup=${this.handleMouseUp}
      @scroll=${this.handleScroll}
    ></div>`}async focus(){const e=await this.editableDiv,t=this.isFocused;e?.focus?.(),this.putCursorAtEndOnFocus&&!t&&await this.putCursorAtEnd()}async putCursorAtEnd(){const e=await this.editableDiv,t=this.getSelection();if(!e||!t)return;const i=document.createRange();e.focus(),i.setStart(e,e.childNodes.length),i.collapse(!0),t.removeAllRanges(),t.addRange(i),this.scrollToCursorPosition(i),i.detach(),this.onCursorPositionChange()}setCursorPosition(e){this.setCursorPositionForDiv(e,this.editableDivElement)}async setCursorPositionAsync(e){const t=await this.editableDiv;this.setCursorPositionForDiv(e,t)}setCursorPositionForDiv(e,t){let i=e,r=!0,o=null;const s=this.getSelection();if(!t||!s)return;t.focus();const n=e=>{for(let t=0;t<e.length;t++){const s=e[t];let a=0;if(s.nodeType!==Node.COMMENT_NODE){if("BR"===s.nodeName&&(a++,r=!0),"DIV"!==s.nodeName||r||0===t||a++,r=!1,s.nodeType===Node.TEXT_NODE&&s.textContent&&(a+=s.textContent.length),i<=a){o=s;break}i-=a,s.childNodes?.length>0&&n(Array.from(s.childNodes))}}};n(Array.from(t.childNodes)),this.setFocusOnNode(s,t,o,i)}setRangeText(e,t,i){const r=this.value?.substring(0,t)??"",o=this.value?.substring(i,this.value?.length??0)??"";this.value=r+e+o,this.setCursorPosition(r.length+e.length)}get contentEditableAttributeValue(){return this.disabled?"false":!/firefox|fxios/i.test(navigator.userAgent)&&this.isPlaintextOnlySupported?"plaintext-only":"true"}setFocusOnNode(e,t,i,r){const o=document.createRange();if(null===i)o.setStart(t,t.childNodes.length);else if("BR"===i.nodeName){const e=i.nextSibling??i;o.setEnd(e,0)}else o.setStart(i,r);o.collapse(!0),e.removeAllRanges(),e.addRange(o),this.scrollToCursorPosition(o),o.detach(),this.onCursorPositionChange()}async onInput(e){e.preventDefault(),e.stopImmediatePropagation();const t=await this.getValue();this.innerValue=t,this.fire("input",{value:this.value})}onFocus(){this.focused=!0,this.onCursorPositionChange()}onBlur(){this.focused=!1,this.removeHintSpanIfShown(),this.onCursorPositionChange()}async handleKeyDown(e){"Tab"!==e.key||e.shiftKey||e.ctrlKey||e.metaKey?(this.enableSaveShortcut&&"s"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.fire("saveShortcut")),(e.ctrlKey||e.metaKey||e.altKey)&&("ArrowLeft"===e.key&&0===this.currentCursorPosition&&e.preventDefault(),"ArrowRight"===e.key&&this.currentCursorPosition===(this.value?.length??0)&&e.preventDefault(),"Backspace"===e.key&&0===this.currentCursorPosition&&e.preventDefault()),await this.toggleHintVisibilityIfAny()):await this.handleTabKeyPress(e)}handleKeyUp(){this.onCursorPositionChange()}async handleMouseUp(){this.onCursorPositionChange(),await this.toggleHintVisibilityIfAny()}handleScroll(){this.fire("scroll")}fire(e,t){this.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))}async handleTabKeyPress(e){const t=this.value;if(this.placeholderHint&&!t)e.preventDefault(),await this.appendHint(this.placeholderHint,e);else if(this.hasHintSpan())e.preventDefault(),await this.appendHint(this.hint,e);else{const t=await this.getCursorPositionAsync(),i=await this.getValue(),r=i.lastIndexOf("```",t-1),o=i.indexOf("```",t);-1!==r&&-1!==o&&o>r&&(e.preventDefault(),this.setRangeText("\t",t,t))}}async appendHint(e,t){const i=this.value??"",r=i+e;this.value=r,await this.putCursorAtEnd(),await this.onInput(t),this.fire("hintApplied",{hint:e,oldValue:i})}async toggleHintVisibilityIfAny(){await async function(){return new Promise((e=>{requestAnimationFrame((()=>{e()}))}))}();const e=await this.editableDiv,t=await this.getValue()??"",i=await this.getCursorPositionAsync();if(!e||this.placeholderHint&&!t||!this.hint||!this.isFocused||i!==t.length)return void this.removeHintSpanIfShown();const r=this.hintSpan();r?r.dataset.hint!==this.hint&&(this.removeHintSpanIfShown(),this.addHintSpanAtEndOfContent(e,this.hint||"")):this.addHintSpanAtEndOfContent(e,this.hint||"")}addHintSpanAtEndOfContent(e,t){const i=this.value??"",r=document.createElement("span");r.classList.add(mD),r.setAttribute("role","alert"),r.setAttribute("aria-label","Suggestion: "+t+" Press TAB to accept it."),r.dataset.hint=t,e.appendChild(r),this.fire("hintShown",{hint:t,oldValue:i})}removeHintSpanIfShown(){const e=this.hintSpan();e&&(e.remove(),this.fire("hintDismissed",{hint:e.dataset.hint}))}hasHintSpan(){return!!this.hintSpan()}hintSpan(){return this.shadowRoot?.querySelector("."+mD)}onCursorPositionChange(){const e=this.getCursorPosition();this.fire("cursorPositionChange",{position:e}),this.currentCursorPosition=e}async updateValueInDom(){const e=this.editableDivElement??await this.editableDiv;e&&(e.textContent=this.value||"")}async updateHintInDomIfRendered(){await this.editableDiv,await this.toggleHintVisibilityIfAny()}async getValue(){const e=await this.editableDiv;if(e){const[t]=this.parseText(e,!1,!0);return t}return""}parseText(e,t,i){let r="",o="";if("BR"===e.nodeName)return["\n",!0];if(e.nodeType===Node.TEXT_NODE&&e.textContent)return[e.textContent,!1];"DIV"!==e.nodeName||t||i||(r="\n"),t=!1;for(let i=0;i<e.childNodes?.length;i++)[o,t]=this.parseText(e.childNodes[i],t,0===i),r+=o;return[r,t]}getCursorPosition(){return this.getCursorPositionForDiv(this.editableDivElement)}async getCursorPositionAsync(){const e=await this.editableDiv;return this.getCursorPositionForDiv(e)}getCursorPositionForDiv(e){const t=this.getSelection();if(!(e&&this.focused&&t&&null!==t.focusNode&&t.isCollapsed))return-1;let i=0,r=!0;const o=e=>{for(let s=0;s<e.length;s++){const n=e[s];if("BR"!==n.nodeName){if("DIV"!==n.nodeName||r||0===s||i++,r=!1,n===t.focusNode){i+=t.focusOffset;break}3===n.nodeType&&n.textContent&&(i+=n.textContent.length),n.childNodes?.length>0&&o(Array.from(n.childNodes))}else i++,r=!0}};if(e===t.focusNode){const i=Array.from(e.childNodes).slice(0,t.focusOffset);o(i)}else o(Array.from(e.childNodes));return i}getSelection(){const e=this.shadowRoot?.getSelection?.()??document.getSelection?.();if(!e)return null;if(Dn()&&e.getComposedRanges){const t=e.getComposedRanges(this.shadowRoot);if(0===t.length)return null;const i=t[0],r=new Range;return r.setStart(i.startContainer,i.startOffset),r.setEnd(i.endContainer,i.endOffset),{isCollapsed:r.collapsed,focusNode:r.endContainer,focusOffset:r.endOffset,removeAllRanges:()=>e.removeAllRanges(),addRange:t=>e.addRange(t),getRangeAt:e=>r,rangeCount:1}}return e}scrollToCursorPosition(e){const t=document.createElement("br");e.insertNode(t),t.scrollIntoView({behavior:"smooth",block:"nearest"}),t.remove()}};gD([Hc(".editableDiv")],fD.prototype,"editableDivElement",void 0),gD([zc(".editableDiv")],fD.prototype,"editableDiv",void 0),gD([Fc({type:Boolean,reflect:!0})],fD.prototype,"disabled",void 0),gD([Fc({type:String,reflect:!0})],fD.prototype,"placeholder",void 0),gD([Fc({type:String})],fD.prototype,"hint",null),gD([Fc({type:String})],fD.prototype,"placeholderHint",void 0),gD([Fc({type:String})],fD.prototype,"value",null),gD([Fc({type:String})],fD.prototype,"ignoreValue",void 0),gD([Fc({type:Boolean})],fD.prototype,"putCursorAtEndOnFocus",void 0),gD([Fc({type:Boolean})],fD.prototype,"enableSaveShortcut",void 0),fD=gD([Dc("gr-textarea")],fD);const vD={src:"bower_components/emojis/emojis.min.js",checkPresent:()=>void 0!==window.emojis,configureCallback:()=>window.emojis};var bD,yD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const wD=[{value:"😊",match:"smile :)"},{value:"👍",match:"thumbs up"},{value:"😄",match:"laugh :D"},{value:"❤️",match:"heart <3"},{value:"😂",match:"tears :')"},{value:"🎉",match:"party"},{value:"😎",match:"cool |;)"},{value:"😞",match:"sad :("},{value:"😐",match:"neutral :|"},{value:"😮",match:"shock :O"},{value:"🙏",match:"pray"},{value:"😕",match:"confused"},{value:"👌",match:"ok"},{value:"🔥",match:"fire"},{value:"💯",match:"100"},{value:"✔",match:"check"},{value:"😋",match:"tongue"},{value:"😭",match:"crying :'("},{value:"🤓",match:"glasses"},{value:"😢",match:"tear"},{value:"😜",match:"winking tongue ;)"}];function _D(e){return!!e&&!!e.match}let xD=bD=class extends Ic{constructor(){super(),this.text="",this.hideBorder=!1,this.monospace=!1,this.code=!1,this.autocompleteHint="",this.suggestions=[],this.isDragging=!1,this.allowMarkdownBase64ImagesInComments=!1,this.reporting=Xn().reportingService,this.getChangeModel=yu(this,MT),this.restApiService=Xn().restApiService,this.getConfigModel=yu(this,Qw),this.specialCharIndex=-1,this.shortcuts=new Gg(this),this.getPluginLoader=yu(this,U_),this.addEventListener("dragenter",this.handleDragEnter),this.addEventListener("dragover",this.handleDragOver),this.addEventListener("dragleave",this.handleDragLeave),this.addEventListener("drop",this.handleDrop),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.serverConfig=e})),zf(this,(()=>this.getConfigModel().allowMarkdownBase64ImagesInComments$),(e=>{this.allowMarkdownBase64ImagesInComments=e})),this.shortcuts.addLocal({key:Mn.UP},(e=>this.handleUpKey(e)),{preventDefault:!1}),this.shortcuts.addLocal({key:Mn.DOWN},(e=>this.handleDownKey(e)),{preventDefault:!1}),this.shortcuts.addLocal({key:Mn.TAB},(e=>this.handleTabKey(e)),{preventDefault:!1}),this.shortcuts.addLocal({key:Mn.ENTER},(e=>this.handleEnterByKey(e)),{preventDefault:!1}),this.shortcuts.addLocal({key:Mn.ESC},(e=>this.handleEscKey(e)),{preventDefault:!1})}disconnectedCallback(){super.disconnectedCallback()}connectedCallback(){super.connectedCallback(),this.monospace&&this.classList.add("monospace"),this.code&&this.classList.add("code")}static get styles(){return[vy,Nc,Sd`
        :host {
          display: flex;
          position: relative;
        }
        :host(.monospace) {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          font-weight: var(--font-weight-normal);
        }
        :host(.code) {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-code);
          /* usually 16px = 12px + 4px */
          line-height: calc(var(--font-size-code) + var(--spacing-s));
          font-weight: var(--font-weight-normal);
        }
        #emojiSuggestions {
          font-family: var(--font-family);
        }
        #textarea {
          background-color: var(--view-background-color);
          width: 100%;
          color: var(--primary-text-color);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          padding: 0;
          box-sizing: border-box;
          position: relative;
          --gr-textarea-padding: var(--spacing-s);
          --gr-textarea-border-width: 0px;
          --gr-textarea-border-color: var(--border-color);
          --input-field-bg: var(--view-background-color);
          --input-field-disabled-bg: var(--view-background-color);
          --secondary-bg-color: var(--background-color-secondary);
          --text-default: var(--primary-text-color);
          --text-disabled: var(--deemphasized-text-color);
          --text-secondary: var(--deemphasized-text-color);
        }
        #hiddenText #emojiSuggestions {
          visibility: visible;
          white-space: normal;
        }
        #textarea.noBorder {
          border: none;
        }
        #hiddenText {
          display: block;
          float: left;
          position: absolute;
          visibility: hidden;
          width: 100%;
          white-space: pre-wrap;
        }
        :host {
          display: block;
        }
        :host([data-dragging]) {
          border: 2px dashed var(--border-color);
          background-color: var(--background-color-secondary);
        }
      `]}render(){return dc`
      <div id="hiddenText"></div>
      <!-- When the autocomplete is open, the span is moved at the end of
      hiddenText in order to correctly position the dropdown. After being moved,
      it is set as the positionTarget for the emojiSuggestions dropdown. -->
      <span id="caratSpan"></span>
      ${this.renderEmojiDropdown()} ${this.renderMentionsDropdown()}
      ${this.renderTextarea()}
    `}renderTextarea(){return dc`<gr-textarea
      id="textarea"
      putCursorAtEndOnFocus
      class=${th({noBorder:this.hideBorder})}
      .placeholder=${this.placeholder}
      ?disabled=${!!this.disabled}
      .value=${this.text}
      .hint=${this.autocompleteHint}
      @input=${e=>{const t=e.target.value;this.text=t??""}}
    ></gr-textarea>`}renderEmojiDropdown(){return dc`
      <gr-autocomplete-dropdown
        id="emojiSuggestions"
        .suggestions=${this.suggestions}
        .horizontalOffset=${20}
        .verticalOffset=${20}
        @dropdown-closed=${this.resetDropdown}
        @item-selected=${this.handleDropdownItemSelect}
      >
      </gr-autocomplete-dropdown>
    `}renderMentionsDropdown(){return dc` <gr-autocomplete-dropdown
      id="mentionsSuggestions"
      .suggestions=${this.suggestions}
      @dropdown-closed=${this.resetDropdown}
      @item-selected=${this.handleDropdownItemSelect}
      .horizontalOffset=${20}
      .verticalOffset=${20}
      role="listbox"
    ></gr-autocomplete-dropdown>`}firstUpdated(){this.emojis||bD.libLoader.getLibrary(vD).then((e=>{e&&(this.emojis=e)})).catch((e=>{console.error("Failed to load emojis library",e),this.emojis=wD}))}updated(e){e.has("text")&&(this.fireChangedEvents(),this.handleTextChanged()),e.has("isDragging")&&(this.isDragging?this.setAttribute("data-dragging",""):this.removeAttribute("data-dragging"))}closeDropdown(){this.mentionsSuggestions?.close(),this.emojiSuggestions?.close()}focus(){this.textarea?.focus()}putCursorAtEnd(){this.textarea?.putCursorAtEnd()}getVisibleDropdown(){if(this.emojiSuggestions&&!this.emojiSuggestions.isHidden)return this.emojiSuggestions;if(this.mentionsSuggestions&&!this.mentionsSuggestions.isHidden)return this.mentionsSuggestions;throw new Error("no dropdown visible")}isDropdownVisible(){return this.emojiSuggestions&&!this.emojiSuggestions.isHidden||this.mentionsSuggestions&&!this.mentionsSuggestions.isHidden}handleEscKey(e){this.isDropdownVisible()&&""!==this.getVisibleDropdown().getCurrentText()&&(e.preventDefault(),e.stopPropagation(),this.resetDropdown())}handleUpKey(e){this.isDropdownVisible()&&""!==this.getVisibleDropdown().getCurrentText()&&(e.preventDefault(),e.stopPropagation(),this.getVisibleDropdown().cursorUp(),this.focus())}handleDownKey(e){this.isDropdownVisible()&&""!==this.getVisibleDropdown().getCurrentText()&&(e.preventDefault(),e.stopPropagation(),this.getVisibleDropdown().cursorDown(),this.focus())}handleTabKey(e){this.isDropdownVisible()&&""!==this.getVisibleDropdown().getCurrentText()&&(e.preventDefault(),e.stopPropagation(),this.setValue(this.getVisibleDropdown().getCurrentText()))}handleEnterByKey(e){if(this.isDropdownVisible())return""===this.getVisibleDropdown().getCurrentText()?(this.indent(e),void this.resetDropdown()):(e.preventDefault(),e.stopPropagation(),void this.setValue(this.getVisibleDropdown().getCurrentText()));this.indent(e)}handleDropdownItemSelect(e){e.detail.selected?.dataset.value&&this.setValue(e.detail.selected?.dataset.value)}async setValue(e){if(-1===this.specialCharIndex)return;const t=this.specialCharIndex;let i=0;this.isEmojiDropdownActive()?(this.text=this.addValueToText(e),this.reporting.reportInteraction("select-emoji",{type:e})):(this.text=this.addValueToText("@"+e),this.reporting.reportInteraction("select-mention",{type:e}),i=1),await this.updateComplete,this.setCursorPosition(t+e.length+i),this.resetDropdown()}setCursorPosition(e){this.textarea?.setCursorPosition(e)}addValueToText(e){if(!this.text)return"";const t=this.specialCharIndex??0;return this.text.substring(0,t)+e+this.text.substring(t+1+(this.currentSearchString?.length??0))}updateCaratPosition(){let e=this.textarea?.getCursorPosition()??-1;-1===e&&(e=this.text.length),this.hiddenText.textContent=this.text.substring(0,e);const t=this.caratSpan;return this.hiddenText.appendChild(t),t}shouldResetDropdown(e,t,i){return(this.textarea?.getCursorPosition()??-1)!==(this.currentSearchString??"").length+t+1||" "===this.currentSearchString||"\n"===this.currentSearchString||!(e[t]===i)}async computeSuggestions(){if(this.suggestions=[],void 0===this.currentSearchString)return;const e=this.currentSearchString;let t=[];this.isEmojiDropdownActive()?t=this.computeEmojiSuggestions(this.currentSearchString):this.isMentionsDropdownActive()&&(t=await this.computeReviewerSuggestions()),e===this.currentSearchString&&(this.suggestions=t)}openOrResetDropdown(){let e,t;if(this.isEmojiDropdownActive())e=this.emojiSuggestions,t=()=>this.openEmojiDropdown();else{if(!this.isMentionsDropdownActive())return void this.resetDropdown();e=this.mentionsSuggestions,t=()=>this.openMentionsDropdown()}this.shouldResetDropdown(this.text,this.specialCharIndex,this.text[this.specialCharIndex])?this.resetDropdown():e.isHidden&&this.isTextareaFocused()&&(e.setPositionTarget(this.updateCaratPosition()),t())}isMentionsDropdownActive(){return-1!==this.specialCharIndex&&"@"===this.text[this.specialCharIndex]}isEmojiDropdownActive(){return-1!==this.specialCharIndex&&":"===this.text[this.specialCharIndex]}computeIndexAndSearchString(){let e=this.textarea?.getCursorPosition()??-1;-1===e&&(e=this.text.length);const t=this.text.substring(0,e).match(/(?:^|\s)([:@][\S]*)$/);if(!t)return this.specialCharIndex=-1,void(this.currentSearchString=void 0);this.currentSearchString=t[1].substring(1),-1===this.specialCharIndex&&(this.specialCharIndex=e-t[1].length)}async handleTextChanged(){this.computeIndexAndSearchString(),await this.computeSuggestions(),this.openOrResetDropdown(),this.focus()}openEmojiDropdown(){this.emojiSuggestions.open(),this.reporting.reportInteraction("open-emoji-dropdown")}openMentionsDropdown(){this.mentionsSuggestions.open(),this.reporting.reportInteraction("open-mentions-dropdown")}formatSuggestions(e){const t=[];for(const i of e)va(_D(i),"malformed suggestion"),i.dataValue=i.value,i.text=`${i.value} ${i.match}`,t.push(i);return t}computeEmojiSuggestions(e){const t=this.getPluginLoader().jsApiService.modifyEmojis(this.emojis);if(void 0===e||!t)return[];if(!e.length)return this.formatSuggestions(t.slice(0,25));const i=t.filter((t=>t.match.includes(e))).slice(0,25);return this.formatSuggestions(i)}async computeReviewerSuggestions(){return(await this.restApiService.queryAccounts(this.currentSearchString??"",15,this.changeNum,!0)??[]).filter((e=>e.email)).map((e=>({text:`${sx(this.serverConfig,e)}`,dataValue:e.email})))}resetDropdown(){this.requestUpdate(),this.currentSearchString="",this.closeDropdown(),this.specialCharIndex=-1,this.focus()}fireChangedEvents(){Jn(this,"text-changed",{value:this.text})}indent(e){if(!document.queryCommandSupported("insertText"))return;const t=this.text.substring(0,this.textarea?.getCursorPosition()??-1).split("\n").pop(),i=t?.match(/^\s*/)?.[0];i&&(e.preventDefault(),document.execCommand("insertText",!1,"\n"+i))}isTextareaFocused(){return!!this.textarea?.isFocused}handleDragEnter(e){this.allowMarkdownBase64ImagesInComments&&(e.preventDefault(),this.isDragging=!0)}handleDragOver(e){this.allowMarkdownBase64ImagesInComments&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")}handleDragLeave(e){this.allowMarkdownBase64ImagesInComments&&(e.preventDefault(),this.isDragging=!1)}async handleDrop(e){if(!this.allowMarkdownBase64ImagesInComments)return;e.preventDefault(),this.isDragging=!1;const t=e.dataTransfer?.files;if(!t?.length)return;const i=t[0];if(i.type.startsWith("image/"))try{const e=await this.fileToBase64(i),t=`![${i.name}](${e})`;this.text=this.text?`${this.text}\n${t}`:t}catch(e){console.error("Error processing dropped image:",e)}else console.warn("Only image files are supported")}fileToBase64(e){return new Promise(((t,i)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=i,r.readAsDataURL(e)}))}};xD.libLoader=new BA,yD([Hc("#textarea")],xD.prototype,"textarea",void 0),yD([Hc("#emojiSuggestions")],xD.prototype,"emojiSuggestions",void 0),yD([Hc("#mentionsSuggestions")],xD.prototype,"mentionsSuggestions",void 0),yD([Hc("#caratSpan",!0)],xD.prototype,"caratSpan",void 0),yD([Hc("#hiddenText")],xD.prototype,"hiddenText",void 0),yD([Fc()],xD.prototype,"autocomplete",void 0),yD([Fc({type:Boolean})],xD.prototype,"disabled",void 0),yD([Fc({type:Number})],xD.prototype,"rows",void 0),yD([Fc({type:Number})],xD.prototype,"maxRows",void 0),yD([Fc({type:String})],xD.prototype,"placeholder",void 0),yD([Fc({type:String})],xD.prototype,"text",void 0),yD([Fc({type:Boolean,attribute:"hide-border"})],xD.prototype,"hideBorder",void 0),yD([Fc({type:Boolean})],xD.prototype,"monospace",void 0),yD([Fc({type:Boolean})],xD.prototype,"code",void 0),yD([Fc({type:String})],xD.prototype,"autocompleteHint",void 0),yD([Uc()],xD.prototype,"suggestions",void 0),yD([Uc()],xD.prototype,"isDragging",void 0),yD([Uc()],xD.prototype,"allowMarkdownBase64ImagesInComments",void 0),yD([Uc()],xD.prototype,"emojis",void 0),xD=bD=yD([Dc("gr-suggestion-textarea")],xD);var CD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let ED=class extends Ic{constructor(){super(...arguments),this.message=""}static get styles(){return[Nc,Sd`
        :host {
          display: block;
        }
        :host([disabled]) {
          opacity: 0.5;
          pointer-events: none;
        }
        .main {
          display: flex;
          flex-direction: column;
          width: 100%;
        }
        p {
          margin-bottom: var(--spacing-l);
        }
        label {
          cursor: pointer;
          display: block;
          width: 100%;
        }
        gr-autogrow-textarea {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          width: 73ch; /* Add a char to account for the border. */
        }
      `]}render(){return dc` <gr-dialog
      confirm-label="Delete"
      ?disabled=${""===this.message}
      @confirm=${this.handleConfirmTap}
      @cancel=${this.handleCancelTap}
    >
      <div class="header" slot="header">Delete Comment</div>
      <div class="main" slot="main">
        <p>
          This is an admin function. Please only use in exceptional
          circumstances.
        </p>
        <label for="messageInput">Enter comment delete reason</label>
        <gr-autogrow-textarea
          id="messageInput"
          class="message"
          autocomplete="on"
          placeholder="&lt;Insert reasoning here&gt;"
          .value=${this.message}
          @input=${e=>{const t=e.target.value??"";this.message=t}}
        ></gr-autogrow-textarea>
      </div>
    </gr-dialog>`}resetFocus(){ba(this.messageInput,"messageInput"),this.messageInput.focus()}handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"confirm",{})}handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"cancel",{})}};CD([Hc("#messageInput")],ED.prototype,"messageInput",void 0),CD([Fc({type:String})],ED.prototype,"message",void 0),ED=CD([Dc("gr-confirm-delete-comment-dialog")],ED);var SD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const $D="collapseSuggestionStorageKey";let kD=class extends Ic{constructor(){super(),this.docsBaseUrl="",this.applyingFix=!1,this.isEditingSuggestion=!1,this.isOwner=!1,this.collapsed=!1,this.isChangeMerged=!1,this.isChangeAbandoned=!1,this.thumbUpSelected=!1,this.thumbDownSelected=!1,this.getConfigModel=yu(this,Qw),this.getChangeModel=yu(this,MT),this.getPluginLoader=yu(this,U_),this.getStorage=yu(this,TO),this.reporting=Xn().reportingService,this.flagsService=Xn().flagsService,this.previewLoaded=!1,zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getChangeModel().isOwner$),(e=>this.isOwner=e)),zf(this,(()=>this.getChangeModel().status$),(e=>this.isChangeMerged=e===Nu.MERGED)),zf(this,(()=>this.getChangeModel().status$),(e=>this.isChangeAbandoned=e===Nu.ABANDONED))}connectedCallback(){if(super.connectedCallback(),this.getPluginLoader().awaitPluginsLoaded().then((()=>{const e=this.getPluginLoader().pluginsModel.getState().suggestionsPlugins;this.suggestionsProvider=e?.[0]?.provider})),this.comment?.id){const e=this.getStorage().getEditableContentItem($D+this.comment.id);"true"===e?.message&&(this.collapsed=!0)}}static get styles(){return[Jy,Sd`
        :host {
          display: block;
        }
        :host([collapsed]) gr-suggestion-diff-preview {
          display: none;
        }
        .show-hide {
          margin-left: var(--spacing-s);
        }
        /* just for a11y */
        md-checkbox.show-hide {
          display: none;
        }
        label.show-hide {
          cursor: pointer;
          display: block;
        }
        label.show-hide gr-icon {
          vertical-align: top;
        }
        .header {
          background-color: var(--background-color-primary);
          border: 1px solid var(--border-color);
          padding: var(--spacing-xs) var(--spacing-xl);
          display: flex;
          justify-content: space-between;
          align-items: center;
          border-top-left-radius: var(--border-radius);
          border-top-right-radius: var(--border-radius);
        }
        .header .title {
          flex: 1;
          display: flex;
          align-items: center;
        }
        .headerMiddle {
          display: flex;
          align-items: center;
        }
        .copyButton {
          margin-right: var(--spacing-l);
        }
        .feedback-button[aria-label='Thumb up'] {
          margin-left: var(--spacing-l);
          margin-right: 0;
        }
        .feedback-button[aria-label='Thumb down'] {
          margin-left: 0;
        }
        .selected {
          color: var(--selected-foreground);
          background-color: var(--selected-background);
        }
      `]}render(){const e=this.getFixSuggestions();if(!e)return;const t=this.flagsService.isEnabled(da.ML_SUGGESTED_EDIT_EDITABLE_SUGGESTION);return dc`<div class="header">
        <div class="title">
          <span
            >${this.suggestionsProvider?.getFixSuggestionTitle?.(e)||"Suggested edit"}</span
          >
          <a
            href=${this.suggestionsProvider?.getDocumentationLink?.(e)||$f(this.docsBaseUrl,"user-suggest-edits.html")}
            target="_blank"
            rel="noopener noreferrer"
            ><gr-endpoint-decorator name="fix-suggestion-title-help">
              <gr-endpoint-param
                name="suggestion"
                .value=${e}
              ></gr-endpoint-param
              ><gr-icon icon="help" title="read documentation"></gr-icon
            ></gr-endpoint-decorator>
          </a>
          ${eb(this.flagsService.isEnabled(da.ML_SUGGESTED_EDIT_FEEDBACK),(()=>dc`
              <gr-button
                secondary
                flatten
                class="action feedback-button ${this.thumbUpSelected?"selected":""}"
                aria-label="Thumb up"
                @click=${this.handleThumbUpClick}
              >
                <gr-icon
                  icon="thumb_up"
                  ?filled=${this.thumbUpSelected}
                ></gr-icon>
              </gr-button>
              <gr-button
                secondary
                flatten
                class="action feedback-button ${this.thumbDownSelected?"selected":""}"
                aria-label="Thumb down"
                @click=${this.handleThumbDownClick}
              >
                <gr-icon
                  icon="thumb_down"
                  ?filled=${this.thumbDownSelected}
                ></gr-icon>
              </gr-button>
            `))}
        </div>
        <div class="headerMiddle">
          <gr-button
            secondary
            flatten
            class="action show-fix"
            @click=${this.handleShowFix}
          >
            Show Edit
          </gr-button>
          ${eb(!this.collapsed&&t&&this.isEditingSuggestion,(()=>this.renderEditingButtons()))}
          ${eb(!this.collapsed&&t&&!this.isEditingSuggestion&&yf(this.comment),(()=>this.renderChangeEditButton()))}
          ${eb(this.isOwner&&!this.collapsed&&!(t&&this.isEditingSuggestion),(()=>this.renderApplyEditButton()))}
          ${this.renderToggle()}
        </div>
      </div>
      <gr-suggestion-diff-preview
        .fixSuggestionInfo=${this.getFixSuggestions()?.[0]}
        .patchSet=${this.comment?.patch_set}
        .editable=${t&&this.isEditingSuggestion}
        .commentId=${Vx(this.comment)}
        @preview-loaded=${()=>this.previewLoaded=!0}
      ></gr-suggestion-diff-preview>`}renderChangeEditButton(){return dc`<gr-button
      secondary
      flatten
      class="action edit-fix"
      @click=${this.handleEditFix}
    >
      Change Edit
    </gr-button>`}renderEditingButtons(){return dc`<gr-button
        secondary
        flatten
        class="action cancel-fix"
        @click=${this.handleCancelFix}
      >
        Cancel </gr-button
      ><gr-button
        secondary
        flatten
        class="action reset-fix"
        @click=${this.handleResetFix}
      >
        Reset </gr-button
      ><gr-button
        secondary
        flatten
        class="action save-fix"
        @click=${this.handleSaveFix}
      >
        Save
      </gr-button>`}renderApplyEditButton(){return dc`<gr-button
      secondary
      flatten
      .loading=${this.applyingFix}
      .disabled=${this.isApplyEditDisabled()}
      class="action apply-fix"
      @click=${this.handleApplyFix}
      .title=${this.computeApplyEditTooltip()}
    >
      Apply Edit
    </gr-button>`}renderToggle(){const e=this.collapsed?"expand_more":"expand_less",t=this.collapsed?"Expand":"Collapse";return dc`
      <div class="show-hide" tabindex="0">
        <label class="show-hide" aria-label=${t}>
          <md-checkbox
            class="show-hide"
            ?checked=${this.collapsed}
            @change=${()=>{this.collapsed=!this.collapsed,this.collapsed?this.reporting.reportInteraction(ga.GENERATE_SUGGESTION_COLLAPSED):this.reporting.reportInteraction(ga.GENERATE_SUGGESTION_EXPANDED),this.comment?.id&&this.getStorage().setEditableContentItem($D+this.comment.id,this.collapsed.toString())}}
          ></md-checkbox>
          <gr-icon icon=${e} id="icon"></gr-icon>
        </label>
      </div>
    `}getFixSuggestions(){return this.comment?.fix_suggestions||this.generated_fix_suggestions}handleShowFix(){const e=this.getFixSuggestions();if(!e||!this.comment?.patch_set)return;const t={fixSuggestions:e.map((t=>({...t,fix_id:pC,description:this.suggestionsProvider?.getFixSuggestionTitle?.(e)||"Suggested edit"}))),patchNum:this.comment.patch_set,onCloseFixPreviewCallbacks:[t=>{t&&Jn(this,"apply-user-suggestion",{fixSuggestion:e?.[0]?.description?.includes(BT.GET_AI_FIX_FOR_COMMENT)?e?.[0]:void 0})}]};Jn(this,"open-fix-preview",t)}handleCancelFix(){this.isEditingSuggestion=!1,this.suggestionDiffPreview?.reset()}handleEditFix(){this.isEditingSuggestion=!0}handleResetFix(){this.suggestionDiffPreview?.reset()}handleSaveFix(){this.isEditingSuggestion=!1;const e=this.suggestionDiffPreview?.getEditedContent();if(void 0===e)return;const t=this.getFixSuggestions();if(!t||!t.length)return;const i=function(e){const t=/--- START REPLACEMENT path=(.*?) range=(\d+)-(\d+)\n([\s\S]*?)\n--- END REPLACEMENT ---/g,i=[];let r;for(;null!==(r=t.exec(e));){const e=r[1].trim(),t=Number(r[2]),o=Number(r[3]),s=r[4];i.push({path:e,range:{start_line:t,end_line:o,start_character:0,end_character:0},replacement:s})}if(0===i.length)throw new Error("Could not parse replacements from text");return i}(e),r=[{...t[0],replacements:i},...t.slice(1)];this.comment&&(this.comment.fix_suggestions=r),Jn(this,"generated-suggestion-changed",{suggestions:r})}async handleApplyFix(){if(this.getFixSuggestions()){this.applyingFix=!0;try{await(this.suggestionDiffPreview?.applyFix())}finally{this.applyingFix=!1}}}handleThumbUpClick(){this.thumbUpSelected=!this.thumbUpSelected,this.thumbUpSelected&&(this.thumbDownSelected=!1),this.reporting.reportInteraction(ga.GENERATE_SUGGESTION_THUMB_UP,{commentId:Vx(this.comment),fileExtension:HR(this.comment?.path??""),uuid:this.getFixSuggestions()?.[0]?.fix_id,replacement:this.getFixSuggestions()?.[0]?.replacements?.map((e=>e.replacement)).join("\n")})}handleThumbDownClick(){this.thumbDownSelected=!this.thumbDownSelected,this.thumbDownSelected&&(this.thumbUpSelected=!1),this.reporting.reportInteraction(ga.GENERATE_SUGGESTION_THUMB_DOWN,{commentId:Vx(this.comment),fileExtension:HR(this.comment?.path??""),uuid:this.getFixSuggestions()?.[0]?.fix_id,replacement:this.getFixSuggestions()?.[0]?.replacements?.map((e=>e.replacement)).join("\n")})}isApplyEditDisabled(){return void 0===this.comment?.patch_set||!!this.isChangeMerged||!!this.isChangeAbandoned||!this.previewLoaded}computeApplyEditTooltip(){return void 0===this.comment?.patch_set?"":this.isChangeMerged?"Change is already merged":this.isChangeAbandoned?"Change is abandoned":this.previewLoaded?"":"Fix is still loading ..."}updated(e){super.updated(e),e.has("comment")&&this.getFixSuggestions()&&(this.previewLoaded=!1)}};SD([Hc("gr-suggestion-diff-preview")],kD.prototype,"suggestionDiffPreview",void 0),SD([Fc({type:Object})],kD.prototype,"comment",void 0),SD([Fc({type:Object})],kD.prototype,"generated_fix_suggestions",void 0),SD([Uc()],kD.prototype,"docsBaseUrl",void 0),SD([Uc()],kD.prototype,"applyingFix",void 0),SD([Uc()],kD.prototype,"isEditingSuggestion",void 0),SD([Uc()],kD.prototype,"latestPatchNum",void 0),SD([Uc()],kD.prototype,"suggestionsProvider",void 0),SD([Uc()],kD.prototype,"isOwner",void 0),SD([Fc({type:Boolean,reflect:!0})],kD.prototype,"collapsed",void 0),SD([Uc()],kD.prototype,"isChangeMerged",void 0),SD([Uc()],kD.prototype,"isChangeAbandoned",void 0),SD([Uc()],kD.prototype,"thumbUpSelected",void 0),SD([Uc()],kD.prototype,"thumbDownSelected",void 0),SD([Uc()],kD.prototype,"previewLoaded",void 0),kD=SD([Dc("gr-fix-suggestions")],kD);class AD{constructor(e=10){this.capacity=e,this.cache=[]}get(e){if(""!==e)for(let t=this.cache.length-1;t>=0;t--){const i=this.cache[t],r=i.draftContent,o=r+i.commentCompletion;if(r.length>e.length)continue;if(!o.startsWith(e))continue;if(o===e)continue;const s=o.substring(e.length);return{...i,draftContent:e,commentCompletion:s,draftInSyncWithSuggestionLength:e.length-r.length}}}set(e){const t=this.cache.findIndex((t=>t.draftContent===e.draftContent));-1!==t?this.cache.splice(t,1):this.cache.length>=this.capacity&&this.cache.shift(),this.cache.push(e)}}var RD;!function(e){e.OK="OK",e.NO_SUGGESTION="NO_SUGGESTION",e.OUT_OF_RANGE="OUT_OF_RANGE",e.ERROR="ERROR",e.FILE_TOO_LARGE="FILE_TOO_LARGE",e.INVALID_RANGE="INVALID_RANGE",e.UNSUPPORTED_FILE_TYPE="UNSUPPORTED_FILE_TYPE",e.USER_QUOTA_EXCEEDED="USER_QUOTA_EXCEEDED",e.OK_LOW_CONFIDENCE="OK_LOW_CONFIDENCE"}(RD||(RD={}));var TD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const ID="enableGenerateSuggestionStorageKeyForCommentWithId-";let PD=class extends Ic{constructor(){super(),this.hideHeader=!1,this.permanentEditingMode=!1,this.disableAutoSaving=!1,this.editing=!1,this.messageText="",this.autocompleteAcceptedHints=[],this.autocompleteEnabled=!0,this.autocompleteCache=new AD,this.unresolved=!0,this.generateSuggestion=!0,this.generatedFixSuggestion=this.comment?.fix_suggestions?.[0],this.previewedGeneratedFixSuggestion=this.comment?.fix_suggestions?.[0],this.suggestionLoading=!1,this.wasSuggestionEdited=!1,this.showPatchset=!1,this.showPortedComment=!1,this.isAdmin=!1,this.isOwner=!1,this.docsBaseUrl="",this.restApiService=Xn().restApiService,this.reporting=Xn().reportingService,this.getChangeModel=yu(this,MT),this.getCommentsModel=yu(this,kP),this.getUserModel=yu(this,jf),this.getPluginLoader=yu(this,U_),this.getConfigModel=yu(this,Qw),this.getStorage=yu(this,TO),this.getSuggestionsService=yu(this,UT),this.flagsService=Xn().flagsService,this.shortcuts=new Gg(this),this.commentModel=new VT(this.restApiService),this.autoSaveTrigger$=new Dp,this.generateSuggestionTrigger$=new Dp,this.autocompleteTrigger$=new Dp,this.originalMessage="",this.originalUnresolved=!1,this.firstWillUpdateDone=!1,bu(this,zT,(()=>this.commentModel)),this.shortcuts.addLocal({key:Mn.ESC},(e=>{this.permanentEditingMode||(e.preventDefault(),e.stopPropagation()),this.handleEsc()}),{preventDefault:!1});for(const e of[Fn.CTRL_KEY,Fn.META_KEY])this.shortcuts.addLocal({key:Mn.ENTER,modifiers:[e]},(e=>{this.save(),this.permanentEditingMode||(e.preventDefault(),e.stopPropagation())}),{preventDefault:!1});for(const e of[Fn.CTRL_KEY,Fn.META_KEY])this.shortcuts.addLocal({key:"s",modifiers:[e]},(()=>{this.save()}));this.addEventListener("open-user-suggest-preview",(e=>{this.handleShowFix(e.detail.code)})),this.messagePlaceholder="Mention others with @",zf(this,(()=>this.getUserModel().account$),(e=>this.account=e)),zf(this,(()=>this.getUserModel().isAdmin$),(e=>this.isAdmin=e)),zf(this,(()=>this.getChangeModel().repo$),(e=>this.repoName=e)),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getChangeModel().isOwner$),(e=>this.isOwner=e)),zf(this,(()=>this.autoSaveTrigger$.pipe(lp(2e3))),(()=>{this.autoSave()})),zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e)),zf(this,(()=>this.getPluginLoader().pluginsModel.suggestionsPlugins$),(e=>this.suggestionsProvider=e?.[0]?.provider)),zf(this,(()=>this.autocompleteTrigger$.pipe(lp(200))),(()=>{this.autocompleteComment()})),this.flagsService.isEnabled(da.ML_SUGGESTED_EDIT_V2)&&zf(this,(()=>this.generateSuggestionTrigger$.pipe(lp(500))),(()=>{this.generateSuggestEdit()})),zf(this,(()=>this.getUserModel().preferences$),(e=>{this.autocompleteEnabled=!!e.allow_autocompleting_comments,this.generateSuggestion!==!!e.allow_suggest_code_while_commenting&&(this.generateSuggestion=!!e.allow_suggest_code_while_commenting),this.flagsService.isEnabled(da.ML_SUGGESTED_EDIT_UNCHECK_BY_DEFAULT)&&this.generateSuggestion&&(this.generateSuggestion=!1)})),zf(this,(()=>this.getSuggestionsService().suggestionsServiceUpdated$),(e=>{e&&this.requestUpdate()}))}connectedCallback(){if(super.connectedCallback(),this.comment?.id){const e=this.getStorage().getEditableContentItem(ID+this.comment.id);"false"===e?.message&&(this.generateSuggestion=!1)}}disconnectedCallback(){this.textarea&&this.textarea.closeDropdown(),super.disconnectedCallback()}static get styles(){return[vy,Nc,Iw,Jy,Sd`
        :host {
          display: block;
          font-family: var(--font-family);
          padding: var(--spacing-m);
        }
        :host([collapsed]) {
          padding: var(--spacing-s) var(--spacing-m);
        }
        :host([error]) {
          background-color: var(--error-background);
          border-radius: var(--border-radius);
        }
        .header {
          align-items: center;
          cursor: pointer;
          display: flex;
          padding-bottom: var(--spacing-m);
        }
        :host([collapsed]) .header {
          padding-bottom: 0px;
        }
        .headerLeft > span {
          font-weight: var(--font-weight-medium);
        }
        .headerMiddle {
          color: var(--deemphasized-text-color);
          flex: 1;
          overflow: hidden;
        }
        .draftTooltip {
          font-weight: var(--font-weight-medium);
          display: inline;
        }
        .draftTooltip gr-icon {
          color: var(--info-foreground);
        }
        .date {
          justify-content: flex-end;
          text-align: right;
          white-space: nowrap;
        }
        span.date {
          color: var(--deemphasized-text-color);
        }
        span.date:hover {
          text-decoration: underline;
        }
        .actions {
          display: flex;
          justify-content: space-between;
          padding-top: 0;
        }
        .action {
          margin-left: var(--spacing-l);
        }
        .leftActions,
        .rightActions {
          display: flex;
          justify-content: flex-end;
        }
        .leftActions gr-button,
        .rightActions gr-button {
          --gr-button-padding: 0 var(--spacing-s);
        }
        .editMessage {
          display: block;
          margin-bottom: var(--spacing-m);
          width: 100%;
        }
        .show-hide {
          margin-left: var(--spacing-s);
        }
        /* just for a11y */
        md-checkbox.show-hide {
          display: none;
        }
        label.show-hide {
          cursor: pointer;
          display: block;
        }
        label.show-hide gr-icon {
          vertical-align: top;
        }
        :host([collapsed]) #container .body {
          padding-top: 0;
        }
        #container .collapsedContent {
          display: block;
          overflow: hidden;
          padding-left: var(--spacing-m);
          text-overflow: ellipsis;
          white-space: nowrap;
        }
        .resolve,
        .unresolved {
          align-items: center;
          display: flex;
          flex: 1;
          margin: 0;
        }
        .resolve label {
          color: var(--comment-text-color);
        }
        gr-dialog .main {
          display: flex;
          flex-direction: column;
          width: 100%;
        }
        #deleteBtn {
          --gr-button-text-color: var(--deemphasized-text-color);
          --gr-button-padding: 0;
        }

        /** Disable select for the caret and actions */
        .actions,
        .show-hide {
          -webkit-user-select: none;
          -moz-user-select: none;
          -ms-user-select: none;
          user-select: none;
        }

        .pointer {
          cursor: pointer;
        }
        .patchset-text {
          color: var(--deemphasized-text-color);
          margin-left: var(--spacing-s);
        }
        .headerLeft gr-account-label {
          --account-max-length: 130px;
          width: 150px;
        }
        .headerLeft gr-account-label::part(gr-account-label-text) {
          font-weight: var(--font-weight-medium);
        }
        .draft gr-account-label {
          width: unset;
        }
        .draft gr-formatted-text.message {
          display: block;
          margin-bottom: var(--spacing-m);
        }
        .portedMessage {
          margin: 0 var(--spacing-m);
        }
        .link-icon {
          margin-left: var(--spacing-m);
          cursor: pointer;
        }
        .suggestEdit {
          /** same height as header */
          --margin: calc(0px - var(--spacing-s));
          margin-right: var(--spacing-s);
        }
        .suggestEdit gr-icon {
          color: inherit;
          margin-right: var(--spacing-s);
        }
        .info {
          background-color: var(--info-background);
          padding: var(--spacing-l) var(--spacing-xl);
        }
        .info gr-icon {
          color: var(--selected-foreground);
          margin-right: var(--spacing-xl);
        }
        /* The basics of .loadingSpin are defined in shared styles. */
        .loadingSpin {
          width: calc(var(--line-height-normal) - 2px);
          height: calc(var(--line-height-normal) - 2px);
          display: inline-block;
          vertical-align: top;
          position: relative;
          /* Making up for the 2px reduced height above. */
          top: 1px;
        }
        gr-suggestion-diff-preview,
        gr-fix-suggestions {
          margin-top: var(--spacing-s);
        }
      `]}render(){if(!this.comment)return;this.toggleAttribute("saving",wf(this.comment)),this.toggleAttribute("error",_f(this.comment));const e={container:!0,draft:yf(this.comment)};return dc`
      <gr-endpoint-decorator name="comment">
        <gr-endpoint-param name="comment" .value=${this.comment}>
        </gr-endpoint-param>
        <gr-endpoint-param name="editing" .value=${this.editing}>
        </gr-endpoint-param>
        <gr-endpoint-param name="message" .value=${this.messageText}>
        </gr-endpoint-param>
        <gr-endpoint-param name="isDraft" .value=${yf(this.comment)}>
        </gr-endpoint-param>
        <div id="container" class=${th(e)}>
          ${this.renderHeader()}
          <div class="body">
            ${this.renderEditingTextarea()} ${this.renderCommentMessage()}
            <gr-endpoint-slot name="above-actions"></gr-endpoint-slot>
            ${this.renderHumanActions()}
          </div>
          ${this.renderGeneratedSuggestionPreview()}
          ${this.renderFixSuggestionPreview()}
        </div>
      </gr-endpoint-decorator>
      ${this.renderConfirmDialog()}
    `}renderHeader(){return this.hideHeader?uc:dc`
      <div
        class="header"
        id="header"
        @click=${()=>this.collapsed=!this.collapsed}
      >
        <div class="headerLeft">
          ${this.renderAuthor()} ${this.renderPortedCommentMessage()}
          ${this.renderDraftLabel()}
        </div>
        <div class="headerMiddle">${this.renderCollapsedContent()}</div>
        ${this.renderSuggestEditButton()} ${this.renderDeleteButton()}
        ${this.renderPatchset()} ${this.renderSeparator()} ${this.renderDate()}
        ${this.renderToggle()}
      </div>
    `}renderAuthor(){if(!yf(this.comment))return dc`
      <gr-account-label .account=${this.comment?.author??this.account}>
      </gr-account-label>
    `}renderPortedCommentMessage(){if(this.showPortedComment&&this.comment?.patch_set)return dc`
      <a href=${this.getUrlForComment()}>
        <span class="portedMessage" @click=${this.handlePortedMessageClick}>
          From patchset ${this.comment?.patch_set}
        </span>
      </a>
    `}renderDraftLabel(){if(!yf(this.comment))return;let e="Draft",t="This draft is only visible to you. To publish drafts, click the 'Reply' or 'Start review' button at the top of the change or press the 'a' key.";return _f(this.comment)&&(e+=" (Failed to save)",t="Unable to save draft. Please try to save again."),dc`
      <gr-tooltip-content
        class="draftTooltip"
        has-tooltip
        title=${t}
        max-width="20em"
      >
        <gr-icon filled icon="rate_review"></gr-icon>
        <span class="draftLabel">${e}</span>
      </gr-tooltip-content>
    `}renderCollapsedContent(){if(this.collapsed)return dc`
      <span class="collapsedContent">${this.comment?.message}</span>
    `}renderDeleteButton(){if(this.isAdmin&&!yf(this.comment)&&!this.collapsed)return dc`
      <gr-button
        id="deleteBtn"
        title="Delete Comment"
        link
        class="action delete"
        @click=${e=>{e.stopPropagation(),this.openDeleteCommentModal()}}
      >
        <gr-icon id="icon" icon="delete" filled></gr-icon>
      </gr-button>
    `}renderPatchset(){if(this.showPatchset)return ba(this.comment?.patch_set,"comment.patch_set"),dc`
      <span class="patchset-text"> Patchset ${this.comment.patch_set}</span>
    `}renderSeparator(){if(this.showPatchset&&!this.collapsed)return dc`<span class="separator"></span>`}renderDate(){if(!this.collapsed)return dc`
      <span class="date" tabindex="0" @click=${this.handleAnchorClick}>
        ${this.renderDateInner()}
      </span>
    `}renderDateInner(){return _f(this.comment)?"Error":wf(this.comment)&&!this.autoSaving?"Saving":xf(this.comment)?"New":dc`
      <gr-date-formatter
        withTooltip
        .dateStr=${this.comment.updated}
      ></gr-date-formatter>
    `}renderToggle(){const e=this.collapsed?"expand_more":"expand_less",t=this.collapsed?"Expand":"Collapse";return dc`
      <div class="show-hide" tabindex="0">
        <label class="show-hide" aria-label=${t}>
          <md-checkbox
            class="show-hide"
            ?checked=${!!this.collapsed}
            @change=${()=>this.collapsed=!this.collapsed}
          ></md-checkbox>
          <gr-icon icon=${e} id="icon"></gr-icon>
        </label>
      </div>
    `}renderEditingTextarea(){if(this.editing&&!this.collapsed)return dc`
      <gr-suggestion-textarea
        id="editTextarea"
        class="editMessage"
        autocomplete="on"
        code=""
        rows="4"
        .placeholder=${this.messagePlaceholder}
        .text=${this.messageText}
        autocompleteHint=${this.autocompleteHint?.commentCompletion??""}
        @text-changed=${this.handleTextChanged}
        @hintShown=${this.handleHintShown}
        @hintApplied=${this.handleHintApplied}
      ></gr-suggestion-textarea>
    `}handleHintShown(e){const t=this.autocompleteCache.get(e.detail.oldValue);t?.commentCompletion===e.detail.hint&&this.reportHintInteraction(ga.COMMENT_COMPLETION_SUGGESTION_SHOWN,t)}handleHintApplied(e){const t=this.autocompleteCache.get(e.detail.oldValue);t?.commentCompletion===e.detail.hint&&(this.autocompleteAcceptedHints.push(e.detail.hint),this.reportHintInteraction(ga.COMMENT_COMPLETION_SUGGESTION_ACCEPTED,t))}reportHintInteractionSaved(){if(0===this.autocompleteAcceptedHints.length)return;const e=this.messageText.trimEnd(),t=this.autocompleteAcceptedHints.join(""),i=e.length-t.length;let r=function(e,t){const i=e.length,r=t.length,o=Array.from({length:i+1},(()=>Array(r+1).fill(0)));for(let e=0;e<=i;e++)o[e][0]=e;for(let e=0;e<=r;e++)o[0][e]=e;for(let s=1;s<=i;s++)for(let i=1;i<=r;i++)e[s-1]===t[i-1]?o[s][i]=o[s-1][i-1]:o[s][i]=Math.min(o[s-1][i]+1,o[s][i-1]+1,o[s-1][i-1]+1);return o[i][r]}(t,e);i>0&&(r-=i);const o={...this.createAutocompletionBaseContext(),similarCharacters:t.length-r,maxSimilarCharacters:t.length,acceptedSuggestionsCount:this.autocompleteAcceptedHints.length,totalAcceptedCharacters:t.length,savedDraftLength:e.length};this.reportHintInteraction(ga.COMMENT_COMPLETION_SAVE_DRAFT,o)}reportHintInteraction(e,t){t={...t,draftContent:"[REDACTED]",commentCompletion:"[REDACTED]"},this.reporting.reportInteraction(e,t)}handleTextChanged(e){const t=this.messageText,i=e.detail.value;t!==i&&(this.messageText=i,this.handleTextChangedForAutocomplete(),this.autoSaveTrigger$.next(),this.generateSuggestionTrigger$.next())}handleTextChangedForAutocomplete(){const e=this.autocompleteCache.get(this.messageText);e?this.autocompleteHint=e:(this.autocompleteHint=void 0,this.autocompleteTrigger$.next())}renderCommentMessage(){if(!this.collapsed&&!this.editing)return dc`
      <!--The "message" class is needed to ensure selectability from
          gr-diff-selection.-->
      <gr-formatted-text
        class="message"
        .markdown=${!0}
        .content=${this.comment?.message??""}
      ></gr-formatted-text>
    `}renderCopyLinkIcon(){if((this.comment?.in_reply_to||!yf(this.comment))&&!this.editing)return dc`
      <gr-icon
        icon="link"
        class="copy link-icon"
        @click=${this.handleCopyLink}
        title="Copy link to this comment"
        role="button"
        tabindex="0"
      ></gr-icon>
    `}renderHumanActions(){if(this.account&&!this.collapsed&&yf(this.comment))return dc`
      <div class="actions">
        <div class="leftActions">
          <div class="action resolve">
            <label>
              <md-checkbox
                id="resolvedCheckbox"
                ?checked=${!this.unresolved}
                @change=${this.handleToggleResolved}
              ></md-checkbox>
              Resolved
            </label>
          </div>
          ${this.renderGenerateSuggestEditButton()}
        </div>
        ${this.renderDraftActions()}
      </div>
    `}renderDraftActions(){if(yf(this.comment))return dc`
      <div class="rightActions">
        ${this.renderDiscardButton()} ${this.renderEditButton()}
        ${this.renderCancelButton()} ${this.renderSaveButton()}
        ${this.renderCopyLinkIcon()}
        <gr-endpoint-slot name="draft-actions-end"></gr-endpoint-slot>
      </div>
    `}renderSuggestEditButton(){return!this.editing||this.permanentEditingMode||!this.comment||this.comment.path===hg.PATCHSET_LEVEL_COMMENTS||wC(this.comment)?uc:(ba(this.comment,"comment"),uC(this.comment)||this.isOwner?uc:dc`<gr-button
      link
      class="action suggestEdit"
      title="This button copies the text to make a suggestion"
      @click=${this.createSuggestEdit}
      ><gr-icon icon="edit" id="icon" filled></gr-icon> Suggest Edit</gr-button
    >`)}renderDiscardButton(){if(!this.editing&&!this.permanentEditingMode)return dc`<gr-button
      link
      ?disabled=${wf(this.comment)&&!this.autoSaving}
      class="action discard"
      @click=${this.discard}
      >Discard</gr-button
    >`}renderEditButton(){if(!this.editing)return dc`<gr-button link class="action edit" @click=${this.edit}
      >Edit</gr-button
    >`}renderCancelButton(){if(this.editing&&!this.permanentEditingMode)return dc`
      <gr-button
        link
        ?disabled=${wf(this.comment)&&!this.autoSaving}
        class="action cancel"
        @click=${this.cancel}
        >Cancel</gr-button
      >
    `}renderSaveButton(){if(this.editing)return dc`
      <gr-button
        link
        ?disabled=${this.isSaveDisabled()}
        class="action save"
        @click=${this.handleSaveButtonClicked}
        >${this.permanentEditingMode?"Preview":"Save"}</gr-button
      >
    `}renderFixSuggestionPreview(){return!this.comment?.fix_suggestions||this.editing||this.collapsed?uc:dc`<gr-fix-suggestions
      .comment=${this.comment}
      @generated-suggestion-changed=${this.handleFixSuggestionChanged}
    ></gr-fix-suggestions>`}showGeneratedSuggestion(){return this.flagsService.isEnabled(da.ML_SUGGESTED_EDIT_V2)&&this.getSuggestionsService().isGeneratedSuggestedFixEnabledForComment(this.comment)&&this.editing&&!this.permanentEditingMode&&this.comment&&this.comment===this.comments?.[0]}renderGeneratedSuggestionPreview(){return this.editing&&this.showGeneratedSuggestion()&&this.generateSuggestion&&yf(this.comment)&&this.generatedFixSuggestion?dc`<gr-suggestion-diff-preview
        id="suggestionDiffPreview"
        .uuid=${this.generatedSuggestionId}
        .fixSuggestionInfo=${this.generatedFixSuggestion}
        .patchSet=${this.comment?.patch_set}
        .commentId=${Vx(this.comment)}
        @preview-loaded=${e=>this.previewedGeneratedFixSuggestion=e.detail.previewLoadedFor}
      ></gr-suggestion-diff-preview>`:uc}renderGenerateSuggestEditButton(){return this.showGeneratedSuggestion()?dc`
      <div class="action">
        <label title=${"Select to show a generated suggestion based on your comment for commented text. This suggestion can be inserted as a code block in your comment."} class="suggestEdit">
          <md-checkbox
            id="generateSuggestCheckbox"
            ?checked=${this.generateSuggestion}
            @change=${()=>{this.generateSuggestion=!this.generateSuggestion,this.wasSuggestionEdited=!1,this.comment?.id&&this.getStorage().setEditableContentItem(ID+this.comment.id,this.generateSuggestion.toString());const e=this.generatedFixSuggestion;this.generateSuggestion?this.generateSuggestionTrigger$.next():(this.generatedFixSuggestion=void 0,this.autoSaveTrigger$.next()),this.reporting.reportInteraction(this.generateSuggestion?ga.GENERATE_SUGGESTION_ENABLED:ga.GENERATE_SUGGESTION_DISABLED,{commentId:Vx(this.comment),fileExtension:HR(this.comment?.path??""),uuid:this.generatedSuggestionId,replacement:e?.replacements?.map((e=>e.replacement)).join("\n")})}}
          ></md-checkbox>
          Attach AI-suggested fix
          ${eb(this.suggestionLoading,(()=>dc`<span class="loadingSpin"></span>`),(()=>dc`${this.getNumberOfSuggestions()}`))}
        </label>
        <a
          href=${this.suggestionsProvider?.getDocumentationLink?.()||$f(this.docsBaseUrl,"user-suggest-edits.html#generate_suggestion")}
          target="_blank"
          rel="noopener noreferrer"
        >
          <gr-icon
            icon="help"
            title="About Generated Suggested Edits"
          ></gr-icon>
        </a>
      </div>
    `:uc}getNumberOfSuggestions(){return this.generatedFixSuggestion?"(1)":"(0)"}async generateSuggestEdit(){if(!this.flagsService.isEnabled(da.ML_SUGGESTED_EDIT_V2)||!this.showGeneratedSuggestion()||0===this.messageText.length||this.wasSuggestionEdited)return;let e;this.generatedSuggestionId=$a(),this.suggestionLoading=!0;try{e=await this.getSuggestionsService().generateSuggestedFixForComment(this.comment,this.messageText,this.generatedSuggestionId,BT.FIX_FOR_REVIEWER_COMMENT)}finally{this.suggestionLoading=!1}if(e){this.generatedFixSuggestion=e;try{await uy((()=>void 0!==this.getFixSuggestions())),this.autoSaveTrigger$.next()}catch(e){console.warn(e)}}}async autocompleteComment(){if(!this.autocompleteEnabled)return;const e=this.messageText,t=await this.getSuggestionsService().autocompleteComment(this.comment,this.messageText,this.comments);t&&(this.reportHintInteraction(ga.COMMENT_COMPLETION_SUGGESTION_FETCHED,{...t,hasDraftChanged:this.messageText!==e}),t.commentCompletion&&t.responseCode===RD.OK&&(this.autocompleteCache.set(t),this.autocompleteHint=this.autocompleteCache.get(this.messageText)))}createAutocompletionBaseContext(){return{commentId:Vx(this.comment),commentNumber:this.comments?.length??0,filePath:this.comment.path,fileExtension:HR(this.comment.path??"")}}renderConfirmDialog(){return dc`
      <dialog id="confirmDeleteModal" tabindex="-1">
        <gr-confirm-delete-comment-dialog
          id="confirmDeleteCommentDialog"
          @confirm=${this.handleConfirmDeleteComment}
          @cancel=${this.closeDeleteCommentModal}
        >
        </gr-confirm-delete-comment-dialog>
      </dialog>
    `}getUrlForComment(){return this.changeNum&&this.repoName&&this.comment?.id?qC({changeNum:this.changeNum,repo:this.repoName,commentId:this.comment.id}):""}firstWillUpdate(){this.firstWillUpdateDone||(ba(this.comment,"comment"),this.firstWillUpdateDone=!0,this.unresolved=this.comment.unresolved??!0,this.permanentEditingMode&&this.edit(),yf(this.comment)?this.collapsed=!1:this.collapsed=!!this.initiallyCollapsed)}updated(e){if(e.has("editing")&&this.editing&&!this.permanentEditingMode&&Ln(this,(()=>this.textarea?.putCursorAtEnd())),e.has("changeNum")||e.has("comment")){if(!this.changeNum||!this.comment||!uC(this.comment))return;(async()=>{this.commentedText=await this.commentModel.getCommentedCode(this.comment,this.changeNum)})()}}willUpdate(e){this.firstWillUpdate(),e.has("comment")&&(yf(this.comment)&&_f(this.comment)&&this.edit(),this.comment&&this.commentModel.updateState({comment:this.comment})),e.has("editing")&&this.onEditingChanged(),e.has("unresolved")&&Jn(this,"comment-unresolved-changed",{value:this.unresolved}),e.has("messageText")&&Jn(this,"comment-text-changed",{value:this.messageText})}handlePortedMessageClick(){ba(this.comment,"comment"),this.reporting.reportInteraction("navigate-to-original-comment",{line:this.comment.line,range:this.comment.range})}handleCopyLink(){Jn(this,"copy-comment-link",{})}edit(){va(yf(this.comment),"only drafts are editable"),this.editing||(this.editing=!0)}async addQuote(e){await uy((()=>!!this.textarea),"textarea element not found",5e3),this.messageText=e+this.messageText}async createFixPreview(e){if(ba(this.comment?.patch_set,"comment.patch_set"),ba(this.comment?.path,"comment.path"),uC(this.comment)||e){va(!!(e=e??function(e){if(e.message)return gC(e.message)}(this.comment)),"malformed user suggestion");let t=this.commentedText;if(!t&&(t=await this.commentModel.getCommentedCode(this.comment,this.changeNum),!t))throw new Error("unable to create preview fix event");return{fixSuggestions:mC(this.comment,t,e),patchNum:this.comment.patch_set,onCloseFixPreviewCallbacks:[e=>{e&&this.handleAppliedFix()}]}}throw new Error("unable to create preview fix event")}onEditingChanged(){this.editing&&(this.collapsed=!1,this.messageText=this.comment?.message??"",this.unresolved=this.comment?.unresolved??!0,_f(this.comment)||wf(this.comment)||(this.originalMessage=this.messageText,this.originalUnresolved=this.unresolved)),Jn(this,"comment-editing-changed",{editing:this.editing,path:this.comment?.path??""})}isSaveDisabled(){return ba(this.comment,"comment"),!(!wf(this.comment)||this.autoSaving)||!this.messageText?.trimEnd()}focus(){this.textarea?.focus()}handleEsc(){this.messageText?.trimEnd()||this.cancel()}handleAnchorClick(){ba(this.comment,"comment"),Jn(this,"comment-anchor-tap",{number:this.comment.line||Au,side:this.comment?.side})}async handleSaveButtonClicked(){await this.save(),this.permanentEditingMode&&(this.editing=!this.editing)}handleAppliedFix(){const e=this.comment?.message;va(!!e,"empty message"),Jn(this,"reply-to-comment",{content:"Fix applied.",userWantsToEdit:!1,unresolved:!1})}async handleShowFix(e){Jn(this,"open-fix-preview",await this.createFixPreview(e))}async createSuggestEdit(e){e.stopPropagation();const t=await this.commentModel.getCommentedCode(this.comment,this.changeNum),i=0!==this.messageText.length;this.messageText+=`${i?"\n":""}${hC}${t}\n\`\`\``}cancel(){this.permanentEditingMode||(ba(this.comment,"comment"),va(yf(this.comment),"only drafts are editable"),this.messageText=this.originalMessage,this.unresolved=this.originalUnresolved,this.save())}async autoSave(){if(!wf(this.comment)&&!this.autoSaving&&this.editing&&this.comment&&!this.disableAutoSaving&&(va(yf(this.comment),"only drafts are editable"),""!==this.messageText.trimEnd()&&this.somethingToSave()))try{this.autoSaving=this.rawSave({showToast:!1}),await this.autoSaving}finally{this.autoSaving=void 0}}async discard(){this.messageText="",await this.save()}async convertToCommentInputAndOrDiscard(){if(this.somethingToSave()&&this.comment)return""===this.messageText.trimEnd()?void await this.getCommentsModel().discardDraft(Vx(this.comment)):yC({...this.comment,message:this.messageText.trimEnd(),unresolved:this.unresolved})}async save(){if(va(yf(this.comment),"only drafts are editable"),!wf(this.comment)||this.autoSaving)if(this.permanentEditingMode||(this.editing=!1),this.autoSaving&&(this.comment=await this.autoSaving),""===this.messageText.trimEnd())this.permanentEditingMode&&!this.somethingToSave()||await this.getCommentsModel().discardDraft(Vx(this.comment));else for(;this.somethingToSave();)if(this.comment=await this.rawSave({showToast:!0}),_f(this.comment))return}somethingToSave(){return!!this.comment&&(_f(this.comment)||this.messageText.trimEnd()!==this.comment.message||this.unresolved!==this.comment.unresolved||this.isFixSuggestionChanged())}rawSave(e){va(yf(this.comment),"only drafts are editable"),va(!wf(this.comment),"saving already in progress");const t={...this.comment,message:this.messageText.trimEnd(),unresolved:this.unresolved};return this.isFixSuggestionChanged()&&(t.fix_suggestions=this.getFixSuggestions()),this.reportHintInteractionSaved(),this.getCommentsModel().saveDraft(t,e.showToast)}isFixSuggestionChanged(){return!sf(this.comment?.fix_suggestions,this.getFixSuggestions())}getFixSuggestions(){if(this.flagsService.isEnabled(da.ML_SUGGESTED_EDIT_V2)&&this.generateSuggestion&&this.generatedFixSuggestion&&(!this.comment||!uC(this.comment)))return this.previewedGeneratedFixSuggestion?[this.previewedGeneratedFixSuggestion]:void 0}handleFixSuggestionChanged(e){this.comment&&yf(this.comment)&&this.previewedGeneratedFixSuggestion&&(this.previewedGeneratedFixSuggestion=e.detail.suggestions?.[0],this.generatedFixSuggestion=e.detail.suggestions?.[0],this.wasSuggestionEdited=!0,this.rawSave({showToast:!1}))}handleToggleResolved(){this.unresolved=!this.unresolved,this.editing?""===this.messageText.trimEnd()&&this.comment?.path!==hg.PATCHSET_LEVEL_COMMENTS&&(this.messageText=this.unresolved?"Marked as unresolved.":"Marked as resolved.",this.autoSaveTrigger$.next()):(this.messageText=this.comment?.message??"",this.save())}openDeleteCommentModal(){this.confirmDeleteModal?.showModal(),Ln(this.confirmDeleteDialog,(()=>{this.confirmDeleteDialog.resetFocus()}))}closeDeleteCommentModal(){this.confirmDeleteModal?.close()}async handleConfirmDeleteComment(){if(!this.confirmDeleteDialog||!this.confirmDeleteDialog.message)throw new Error("missing confirm delete dialog");ba(this.changeNum,"changeNum"),ba(this.comment,"comment"),await this.getCommentsModel().deleteComment(this.changeNum,this.comment,this.confirmDeleteDialog.message),this.closeDeleteCommentModal()}};TD([Hc("#editTextarea")],PD.prototype,"textarea",void 0),TD([Hc("#container")],PD.prototype,"container",void 0),TD([Hc("#resolvedCheckbox")],PD.prototype,"resolvedCheckbox",void 0),TD([Hc("#confirmDeleteModal")],PD.prototype,"confirmDeleteModal",void 0),TD([Hc("#confirmDeleteCommentDialog")],PD.prototype,"confirmDeleteDialog",void 0),TD([Hc("#suggestionDiffPreview")],PD.prototype,"suggestionDiffPreview",void 0),TD([Fc({type:Object})],PD.prototype,"comment",void 0),TD([Fc({type:Array})],PD.prototype,"comments",void 0),TD([Fc({type:Boolean,attribute:"initially-collapsed"})],PD.prototype,"initiallyCollapsed",void 0),TD([Fc({type:Boolean,attribute:"hide-header"})],PD.prototype,"hideHeader",void 0),TD([Fc({type:Boolean,reflect:!0})],PD.prototype,"collapsed",void 0),TD([Fc({type:String})],PD.prototype,"messagePlaceholder",void 0),TD([Fc({type:Boolean,attribute:"permanent-editing-mode"})],PD.prototype,"permanentEditingMode",void 0),TD([Fc({type:Boolean})],PD.prototype,"disableAutoSaving",void 0),TD([Uc()],PD.prototype,"autoSaving",void 0),TD([Uc()],PD.prototype,"changeNum",void 0),TD([Uc()],PD.prototype,"editing",void 0),TD([Uc()],PD.prototype,"repoName",void 0),TD([Uc()],PD.prototype,"messageText",void 0),TD([Uc()],PD.prototype,"autocompleteHint",void 0),TD([Uc()],PD.prototype,"autocompleteEnabled",void 0),TD([Uc()],PD.prototype,"unresolved",void 0),TD([Uc()],PD.prototype,"generateSuggestion",void 0),TD([Uc()],PD.prototype,"generatedFixSuggestion",void 0),TD([Uc()],PD.prototype,"previewedGeneratedFixSuggestion",void 0),TD([Uc()],PD.prototype,"generatedSuggestionId",void 0),TD([Uc()],PD.prototype,"addedGeneratedSuggestion",void 0),TD([Uc()],PD.prototype,"suggestionsProvider",void 0),TD([Uc()],PD.prototype,"suggestionLoading",void 0),TD([Uc()],PD.prototype,"wasSuggestionEdited",void 0),TD([Fc({type:Boolean,attribute:"show-patchset"})],PD.prototype,"showPatchset",void 0),TD([Fc({type:Boolean,attribute:"show-ported-comment"})],PD.prototype,"showPortedComment",void 0),TD([Uc()],PD.prototype,"account",void 0),TD([Uc()],PD.prototype,"isAdmin",void 0),TD([Uc()],PD.prototype,"isOwner",void 0),TD([Uc()],PD.prototype,"commentedText",void 0),TD([Uc()],PD.prototype,"docsBaseUrl",void 0),PD=TD([Dc("gr-comment")],PD);const ND=new RegExp(/[\w]+/g),OD="token",DD="token-highlight",LD="tk-text-",MD="tk-index-";class FD{constructor(e,t,i){this.currentHighlightLineNumber=0,this.tokenToElements=new Map,this.tokenHighlightListener=t,e.addEventListener("click",(e=>{this.handleContainerClick(e)})),this.getTokenQueryContainer=i}annotate(e,t,i,r){const o=e.textContent;if(!o)return;if(o.length>500)return;let s,n=!1;for(;s=ND.exec(o);){const t=s[0];if(t.length>100)continue;const i=J$(o.slice(0,s.index)),r=J$(t);n=!0;const a=t===this.currentHighlight?DD:"",l=`${LD}${t}`,d=`${MD}${i}`;ok.annotateElement(e,i,r,`${l} ${d} ${OD} ${a}`),this.storeElementsForToken(t,e,l)}n&&(e.addEventListener("mouseover",(e=>{this.handleTokenMouseOver(e)})),e.addEventListener("mouseout",(e=>{this.handleTokenMouseOut(e)})))}storeElementsForToken(e,t,i){for(const r of t.querySelectorAll(`.${i}`)){let t=this.tokenToElements.get(e);if(!t){if(this.tokenToElements.size>1e4)return;t=new Set,this.tokenToElements.set(e,t)}if(t.size>1e3)return;t.add(r)}}handleTokenMouseOut(e){if(!this.updateTokenTask?.isActive())return;if(e.buttons>0||this.interferesWithSelection())return;const{element:t}=this.findTokenAncestor(e?.target);t&&t===this.hoveredElement&&(this.hoveredElement=void 0,this.updateTokenTask&&this.updateTokenTask.cancel())}handleTokenMouseOver(e){if(e.buttons>0||this.interferesWithSelection())return;const{line:t,token:i,element:r}=this.findTokenAncestor(e?.target);!i||this.currentHighlight===i&&this.currentHighlightLineNumber===t||(this.hoveredElement=r,this.updateTokenTask=ny(this.updateTokenTask,(()=>{this.updateTokenHighlight(i,t,r)}),200))}handleContainerClick(e){if(this.interferesWithSelection())return;const{element:t}=this.findTokenAncestor(e.composedPath()[0]);t||this.removeHighlight()}removeHighlight(){this.hoveredElement=void 0,this.updateTokenTask?.cancel(),this.updateTokenHighlight(void 0,0,void 0)}interferesWithSelection(){return"Range"===document.getSelection()?.type}findTokenAncestor(e){if(!(e instanceof Element))return{line:0,token:void 0,element:void 0};if(e.classList.contains(OD)){const t=[...e.classList].find((e=>e.startsWith(LD))),i=gk(uk(e));return i&&t?{line:i,token:t.substring(8),element:e}:{line:0,token:void 0,element:void 0}}return"TD"===e.tagName?{line:0,token:void 0,element:void 0}:this.findTokenAncestor(e.parentElement)}updateTokenHighlight(e,t,i){if(this.currentHighlight===e&&this.currentHighlightLineNumber===t)return;const r=this.currentHighlight;this.currentHighlight=e,this.currentHighlightLineNumber=t,this.triggerTokenHighlightEvent(e,t,i),this.toggleTokenHighlight(r,DD),this.toggleTokenHighlight(e,DD)}toggleTokenHighlight(e,t){if(!e)return;let i,r;if(this.getTokenQueryContainer?(i=this.getTokenQueryContainer().querySelectorAll(`.${LD}${e}`),r=i.length):(i=this.tokenToElements.get(e),r=i?.size),i&&0!==r)for(const e of i)e.classList.toggle(t);else console.warn(`No tokens have been found for '${e}'`)}triggerTokenHighlightEvent(e,t,i){if(!this.tokenHighlightListener)return;if(!e||!i)return void this.tokenHighlightListener(void 0);const r=mk(i);ba(r,"Line element should be found!");const o=[...i.classList].find((e=>e.startsWith(MD)))?.substring(9);ba(o,"Index class should be found!");const s=Number(o),n=fk(r),a={start_line:t,start_column:s+1,end_line:t,end_column:s+J$(e)};this.tokenHighlightListener({token:e,element:i,side:n,range:a})}}var UD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let BD=class extends Ic{constructor(){super(),this.shouldScrollIntoView=!1,this.showFilePath=!1,this.showFileName=!1,this.showPortedComment=!1,this.showPatchset=!0,this.showCommentContext=!1,this.editing=!1,this.prefs={context:10,cursor_blink_rate:0,font_size:12,ignore_whitespace:"IGNORE_NONE",line_length:100,line_wrapping:!1,show_line_endings:!0,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8},this.renderPrefs={hide_left_side:!0,disable_context_control_buttons:!0,show_file_comment_button:!1,hide_line_length_indicator:!0},this.layers=[],this.unresolved=!0,this.saving=!1,this.isOwner=!1,this.suggestionLoading=!1,this.getCommentsModel=yu(this,kP),this.getChangeModel=yu(this,MT),this.getUserModel=yu(this,jf),this.getViewModel=yu(this,XC),this.shortcuts=new Gg(this),this.getSuggestionsService=yu(this,UT),this.syntaxLayer=new _T(yu(this,ST),(()=>Xn().reportingService)),this.firstWillUpdateDone=!1,this.shortcuts.addGlobal({key:"e"},(()=>this.handleExpandShortcut())),this.shortcuts.addGlobal({key:"E"},(()=>this.handleCollapseShortcut())),this.addEventListener("apply-user-suggestion",(e=>{this.handleAppliedFix(e.detail?.fixSuggestion)})),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getUserModel().account$),(e=>this.account=e)),zf(this,(()=>this.getChangeModel().repo$),(e=>this.repoName=e)),zf(this,(()=>this.getUserModel().diffPreferences$),(e=>this.syntaxLayer.setEnabled(!!e.syntax_highlighting))),zf(this,(()=>this.getUserModel().preferences$),(e=>{const t=[this.syntaxLayer];e.disable_token_highlighting||t.push(new FD(this)),this.layers=t})),zf(this,(()=>this.getUserModel().diffPreferences$),(e=>{this.prefs={...e,line_wrapping:!0}})),zf(this,(()=>this.getChangeModel().isOwner$),(e=>this.isOwner=e)),zf(this,(()=>this.getSuggestionsService().suggestionsServiceUpdated$),(e=>{e&&this.requestUpdate()}))}static get styles(){return[yO,Nc,Sd`
        :host {
          font-family: var(--font-family);
          font-size: var(--font-size-normal);
          font-weight: var(--font-weight-normal);
          line-height: var(--line-height-normal);
        }
        gr-diff#diff {
          /* Explicitly set the background color of the diff. We
           * cannot use the diff content type ab because of the skip chunk preceding
           * it, diff processor assumes the chunk of type skip/ab can be collapsed
           * and hides our diff behind context control buttons.
           *  */
          --dark-add-highlight-color: var(--background-color-primary);
        }
        gr-button {
          margin-left: var(--spacing-m);
        }
        gr-comment {
          border-bottom: 1px solid var(--comment-separator-color);
        }
        #actions {
          margin-left: auto;
          padding: var(--spacing-s) var(--spacing-m);
        }
        .comment-box {
          width: 80ch;
          max-width: 100%;
          background-color: var(--comment-background-color);
          color: var(--comment-text-color);
          box-shadow: var(--elevation-level-2);
          border-radius: var(--border-radius);
          flex-shrink: 0;
        }
        #container {
          display: var(--gr-comment-thread-display, flex);
          align-items: flex-start;
          margin: 0 var(--spacing-s) var(--spacing-s);
          white-space: normal;
          /** This is required for firefox to continue the inheritance */
          -webkit-user-select: inherit;
          -moz-user-select: inherit;
          -ms-user-select: inherit;
          user-select: inherit;
        }
        .comment-box.unresolved {
          background-color: var(--unresolved-comment-background-color);
        }
        #actionsContainer {
          display: flex;
        }
        .comment-box.saving #actionsContainer {
          opacity: 0.5;
        }
        #unresolvedLabel {
          font-family: var(--font-family);
          margin: auto 0;
          padding: var(--spacing-m);
        }
        .pathInfo {
          display: flex;
          align-items: baseline;
          justify-content: space-between;
          padding: 0 var(--spacing-s) var(--spacing-s);
        }
        .fileName {
          padding: var(--spacing-m) var(--spacing-s) var(--spacing-m);
        }
        @media only screen and (max-width: 1200px) {
          .diff-container {
            display: none;
          }
        }
        .diff-container {
          margin-left: var(--spacing-l);
          border: 1px solid var(--border-color);
          flex-grow: 1;
          flex-shrink: 1;
          max-width: 1200px;
        }
        .view-diff-button {
          margin: var(--spacing-s) var(--spacing-m);
        }
        .view-diff-container {
          border-top: 1px solid var(--border-color);
          background-color: var(--background-color-primary);
        }

        /* In saved state the "reply" and "quote" buttons are 28px height.
         * top:4px  positions the 20px icon vertically centered.
         * Currently in draft state the "save" and "cancel" buttons are 20px
         * height, so the link icon does not need a top:4px in gr-comment_html.
         */
        .link-icon {
          margin-left: var(--spacing-m);
          position: relative;
          top: 4px;
          cursor: pointer;
        }
        .fileName gr-copy-clipboard {
          display: inline-block;
          visibility: hidden;
          vertical-align: top;
          --gr-button-padding: 0px;
        }
        .fileName:focus-within gr-copy-clipboard,
        .fileName:hover gr-copy-clipboard {
          visibility: visible;
        }
        .loadingSpin {
          width: calc(var(--line-height-normal) - 2px);
          height: calc(var(--line-height-normal) - 2px);
          display: inline-block;
          vertical-align: top;
          position: relative;
          /* Making up for the 2px reduced height above. */
          top: 1px;
        }
      `]}connectedCallback(){super.connectedCallback(),this.addEventListener("click",(e=>{e.stopPropagation()}))}render(){if(!this.thread)return;const e={unresolved:this.unresolved,saving:this.saving};return dc`
      ${this.renderFilePath()}
      <div id="container">
        <h3 class="assistive-tech-only">${this.computeAriaHeading()}</h3>
        <div class="comment-box ${th(e)}" tabindex="0">
          ${this.renderComments()} ${this.renderSuggestionPreview()}
          ${this.renderActions()}
        </div>
        ${this.renderContextualDiff()}
      </div>
    `}renderFilePath(){if(!this.showFilePath)return;const e=this.getUrlForFileComment(),t=this.computeDisplayLine();return dc`
      ${this.renderFileName()}
      <div class="pathInfo">
        ${e?dc`<a href=${e}>${t}</a>`:dc`<span>${t}</span>`}
      </div>
    `}renderFileName(){if(!this.showFileName)return;if(this.isPatchsetLevel())return dc`<div class="fileName"><span>Patchset</span></div>`;const e=this.getDiffUrlForPath(),t=this.getDisplayPath();return dc`
      <div class="fileName">
        ${e?dc`<a href=${e}>${t}</a>`:dc`<span>${t}</span>`}
        <gr-copy-clipboard hideInput .text=${t}></gr-copy-clipboard>
      </div>
    `}renderComments(){ba(this.thread,"thread");const e=Mw(this.thread.comments.filter((e=>!yf(e))),(e=>e.id),(e=>this.renderComment(e))),t=this.renderComment(this.getDraft());return dc`${e}${t}`}renderComment(e){if(!e)return uc;const t=this.getFirstComment()===e,i=!yf(e)&&(this.messageId?e.change_message_id!==this.messageId:!this.unresolved);return dc`
      <gr-comment
        class=${th({draft:yf(e)})}
        .comment=${e}
        .comments=${this.thread.comments}
        ?initially-collapsed=${i}
        ?show-patchset=${this.showPatchset}
        ?show-ported-comment=${this.showPortedComment&&t}
        @reply-to-comment=${this.handleReplyToComment}
        @copy-comment-link=${this.handleCopyLink}
        @comment-editing-changed=${t=>{yf(e)&&(this.editing=t.detail.editing)}}
        @comment-unresolved-changed=${t=>{yf(e)&&(this.unresolved=t.detail.value)}}
      ></gr-comment>
    `}renderSuggestionPreview(){if(!this.suggestion)return;const e=this.thread?.comments[0];return e?dc`<gr-fix-suggestions
      .comment=${e}
      .generated_fix_suggestions=${[this.suggestion]}
    ></gr-fix-suggestions>`:void 0}renderActions(){if(this.account&&!this.isDraft())return dc`
      <div id="actionsContainer">
        <span id="unresolvedLabel">${this.unresolved?"Unresolved":"Resolved"}</span>
        <div id="actions">

          <gr-button
              id="replyBtn"
              link
              class="action reply"
              ?disabled=${this.saving}
              @click=${()=>this.handleCommentReply(!1)}
          >Reply</gr-button
          >
          <gr-button
              id="quoteBtn"
              link
              class="action quote"
              ?disabled=${this.saving}
              @click=${()=>this.handleCommentReply(!0)}
          >Quote</gr-button
          >
          ${this.unresolved?dc`
                  ${this.shouldShowAIFixButton()?dc`
                        <gr-button
                          id="aiFixBtn"
                          link
                          class="action ai-fix"
                          ?disabled=${this.saving||this.suggestionLoading}
                          @click=${this.handleAIFix}
                          >Get AI Fix
                          ${eb(this.suggestionLoading,(()=>dc`<span class="loadingSpin"></span>`))}</gr-button
                        >
                      `:uc}
                  <gr-button
                    id="ackBtn"
                    link
                    class="action ack"
                    ?disabled=${this.saving}
                    @click=${this.handleCommentAck}
                    >Ack</gr-button
                  >
                  <gr-button
                    id="doneBtn"
                    link
                    class="action done"
                    ?disabled=${this.saving}
                    @click=${this.handleCommentDone}
                    >Done</gr-button
                  >
                `:""}
          <gr-icon
            icon="link"
            class="link-icon copy"
            @click=${this.handleCopyLink}
            title="Copy link to this comment"
            role="button"
            tabindex="0"
          ></gr-icon>
        </div>
      </div>
    </div>
    `}renderContextualDiff(){if(!this.changeNum||!this.showCommentContext||!this.diff)return;if(!this.thread?.path)return;const e=this.getUrlForFileComment()??"";return dc`
      <div class="diff-container">
        <gr-diff
          id="diff"
          .diff=${this.diff}
          .layers=${this.layers}
          .path=${this.thread.path}
          .prefs=${this.prefs}
          .renderPrefs=${this.renderPrefs}
          .highlightRange=${this.highlightRange}
        >
        </gr-diff>
        <div class="view-diff-container">
          <a href=${e}>
            <gr-button link class="view-diff-button">View Diff</gr-button>
          </a>
        </div>
      </div>
    `}firstWillUpdate(){this.thread&&(this.firstWillUpdateDone||(this.firstWillUpdateDone=!0,this.unresolved=this.getLastComment()?.unresolved??!0,this.diff=this.computeDiff(),this.highlightRange=this.computeHighlightRange()))}willUpdate(e){this.firstWillUpdate(),e.has("thread")&&(ba(this.thread,"thread"),ba(this.getFirstComment(),"first comment"),this.isDraft()||(this.unresolved=this.getLastComment()?.unresolved??!0),this.hasDraft=this.isDraft(),this.rootId=Vx(this.getFirstComment())),e.has("editing")&&Jn(this,"comment-thread-editing-changed",{value:this.editing})}firstUpdated(){this.shouldScrollIntoView&&Wn(this,(()=>{this.expandCollapseComments(!1),this.commentBox?.focus(),this.scrollIntoView({block:"center"}),setTimeout((()=>{this.scrollIntoView({block:"center"})}),500)})),this.thread&&yf(this.getFirstComment())&&0===(this.getFirstComment()?.message??"").length&&this.editDraft()}async editDraft(){await uy((()=>!!this.draftElement),"draft element not found",5e3),this.draftElement.edit()}async addQuote(e){await uy((()=>!!this.draftElement),"draft element not found",5e3),await this.draftElement.addQuote(e)}isDraft(){return yf(this.getLastComment())}getDraft(){if(this.isDraft())return this.getLastComment()}isPatchsetLevel(){return this.thread?.path===hg.PATCHSET_LEVEL_COMMENTS}computeDiff(){if(!this.showCommentContext)return;if(!this.thread?.path)return;const e=this.getFirstComment();if(!e?.context_lines?.length)return;const t=(i=e.context_lines,r=this.thread?.path,{meta_a:{name:"",content_type:"",lines:0,web_links:[]},meta_b:{name:r,content_type:e.source_content_type||"",lines:(i=i.slice(0,20)).length+i?.[0].line_number,web_links:[]},change_type:"MODIFIED",intraline_status:"OK",diff_header:[],content:[{skip:i[0].line_number-1},{b:i.map((e=>e.context_line))}]});var i,r;return this.diff&&JSON.stringify(this.diff)===JSON.stringify(t)?this.diff:(this.syntaxLayer.process(t),t)}getDiffUrlForPath(){if(this.changeNum&&this.repoName&&this.thread?.path&&this.thread?.patchNum)return this.getViewModel().diffUrl({patchNum:this.thread.patchNum,diffView:{path:this.thread.path}})}computeHighlightRange(){const e=this.getFirstComment();if(e)return e.range?{side:$u.RIGHT,range:e.range}:e.line?{side:$u.RIGHT,range:{start_line:e.line,start_character:0,end_line:e.line,end_character:0}}:void 0}getUrlForFileComment(){const e=this.getFirstComment()?.id;if(e&&this.repoName&&this.changeNum)return qC({changeNum:this.changeNum,repo:this.repoName,commentId:e})}handleCopyLink(){const e=this.getFirstComment();if(!e)return;let t;ba(this.changeNum,"changeNum"),ba(this.repoName,"repoName"),t=this.isPatchsetLevel()?WC({changeNum:this.changeNum,repo:this.repoName,commentId:e.id}):qC({changeNum:this.changeNum,repo:this.repoName,commentId:e.id}),ba(t,"url for comment"),Sa(function(e){return new URL(e,window.location.href).toString()}(t),"Link")}getDisplayPath(){return this.isPatchsetLevel()?"Patchset":kg(this.thread?.path)}computeDisplayLine(){return ba(this.thread,"thread"),this.thread.line===Au?this.isPatchsetLevel()?"":Au:this.thread.line?`#${this.thread.line}`:this.thread.range?`#${this.thread.range.end_line}`:""}getFirstComment(){return ba(this.thread),Jx(this.thread)}getLastComment(){return ba(this.thread),Xx(this.thread)}handleExpandShortcut(){this.expandCollapseComments(!1)}handleCollapseShortcut(){this.expandCollapseComments(!0)}expandCollapseComments(e){for(const t of this.commentElements??[])t.collapsed=e}async createReplyComment(e,t,i,r,o){const s=this.getLastComment();ba(this.thread,"thread"),ba(s,"the comment that the user wants to reply to"),va(!yf(s),"cannot reply to draft");const n=function(e,t,i){return{...Kx(t,i),path:e.path,patch_set:e.patch_set,side:e.side,line:e.line,range:e.range,parent:e.parent,in_reply_to:e.id}}(s,e,i);if(o&&(n.fix_suggestions=[o]),t)this.getCommentsModel().addNewDraft(n),this.editDraft(),r&&this.addQuote(r);else try{this.saving=!0,await this.getCommentsModel().saveDraft(n)}finally{this.saving=!1}}handleCommentReply(e){const t=this.getLastComment();if(!t)throw new Error("Failed to find last comment.");let i="";if(e){const e=t.message;if(!e)throw new Error("Quoting empty comment.");i="> "+e.replace(Gx,"\n> ")+"\n\n",this.createReplyComment("",!0,t.unresolved??!0,i)}else this.createReplyComment(i,!0,t.unresolved??!0)}handleCommentAck(){this.createReplyComment("Acknowledged",!1,!1)}handleCommentDone(){this.createReplyComment("Done",!1,!1)}handleReplyToComment(e){const{content:t,userWantsToEdit:i,unresolved:r}=e.detail;this.createReplyComment(t,i,r)}computeAriaHeading(){const e=rx(void 0,this.getFirstComment()?.author??this.account);return`${this.unresolved?"Unresolved ":""}${this.isDraft()?"Draft ":""}Comment thread by ${e}`}async handleAIFix(){if(!this.thread||!this.account)return;const e=this.thread.comments[0];if(!e?.message)return;let t;this.suggestionLoading=!0,this.generatedSuggestionId=$a();try{t=await this.getSuggestionsService().generateSuggestedFixForComment(e,e.message,this.generatedSuggestionId,BT.GET_AI_FIX_FOR_COMMENT)}finally{this.suggestionLoading=!1}t?(t.description=BT.GET_AI_FIX_FOR_COMMENT+" "+t.description,this.suggestion=t):ea(this,"No suitable AI fix could be found")}shouldShowAIFixButton(){if(!this.thread||!this.account)return!1;if(1!==this.thread.comments.length)return!1;const e=this.thread.comments[0];return!!this.getSuggestionsService()?.isGeneratedSuggestedFixEnabledForComment(e)&&!(void 0!==e.fix_suggestions&&e.fix_suggestions.length>0)&&this.isOwner&&!uC(e)}handleAppliedFix(e){const t=this.getLastComment()?.message;va(!!t,"empty message"),this.createReplyComment("Fix applied.",!1,!1,"",e)}};UD([Hc("#replyBtn")],BD.prototype,"replyBtn",void 0),UD([Hc("#quoteBtn")],BD.prototype,"quoteBtn",void 0),UD([Hc(".comment-box")],BD.prototype,"commentBox",void 0),UD([Hc("gr-comment.draft")],BD.prototype,"draftElement",void 0),UD([Gc("gr-comment")],BD.prototype,"commentElements",void 0),UD([Fc({hasChanged:nf})],BD.prototype,"thread",void 0),UD([Fc({type:String})],BD.prototype,"rootId",void 0),UD([Fc({type:Boolean,reflect:!0,attribute:"has-draft"})],BD.prototype,"hasDraft",void 0),UD([Fc({type:Boolean,attribute:"should-scroll-into-view"})],BD.prototype,"shouldScrollIntoView",void 0),UD([Fc({type:Boolean,attribute:"show-file-path"})],BD.prototype,"showFilePath",void 0),UD([Fc({type:Boolean,attribute:"show-file-name"})],BD.prototype,"showFileName",void 0),UD([Fc({type:Boolean,attribute:"show-ported-comment"})],BD.prototype,"showPortedComment",void 0),UD([Fc({type:Boolean,attribute:!1})],BD.prototype,"showPatchset",void 0),UD([Fc({type:Boolean,attribute:"show-comment-context"})],BD.prototype,"showCommentContext",void 0),UD([Fc({type:String,attribute:"message-id"})],BD.prototype,"messageId",void 0),UD([Fc({type:Boolean,attribute:"false"})],BD.prototype,"editing",void 0),UD([Uc()],BD.prototype,"changeNum",void 0),UD([Uc()],BD.prototype,"prefs",void 0),UD([Uc()],BD.prototype,"renderPrefs",void 0),UD([Uc()],BD.prototype,"repoName",void 0),UD([Uc()],BD.prototype,"account",void 0),UD([Uc()],BD.prototype,"layers",void 0),UD([Uc()],BD.prototype,"diff",void 0),UD([Uc()],BD.prototype,"highlightRange",void 0),UD([Uc()],BD.prototype,"unresolved",void 0),UD([Uc()],BD.prototype,"saving",void 0),UD([Uc()],BD.prototype,"isOwner",void 0),UD([Uc()],BD.prototype,"suggestionLoading",void 0),UD([Uc()],BD.prototype,"generatedSuggestionId",void 0),UD([Uc()],BD.prototype,"suggestion",void 0),BD=UD([Dc("gr-comment-thread")],BD);var HD,jD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e.TIMESTAMP="Latest timestamp",e.FILES="Files"}(HD||(HD={}));let GD=class extends Ic{constructor(){super(),this.threads=[],this.showCommentContext=!1,this.unresolvedOnly=!1,this.hideDropdown=!1,this.selectedAuthors=[],this.sortDropdownValue=HD.TIMESTAMP,this.draftsOnly=!1,this.mentionsOnly=!1,this.getChangeModel=yu(this,MT),this.getUserModel=yu(this,jf),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getUserModel().account$),(e=>this.account=e))}willUpdate(e){e.has("commentTabState")&&this.onCommentTabStateUpdate(),e.has("scrollCommentId")&&this.onScrollCommentIdUpdate()}onCommentTabStateUpdate(){switch(this.commentTabState?.commentTab){case eP.MENTIONS:this.handleOnlyMentions();break;case eP.UNRESOLVED:this.handleOnlyUnresolved();break;case eP.DRAFTS:this.handleOnlyDrafts();break;case eP.SHOW_ALL:this.handleAllComments()}}onScrollCommentIdUpdate(){this.scrollCommentId&&this.handleAllComments()}static get styles(){return[Nc,Sd`
        #threads {
          display: block;
        }
        gr-comment-thread {
          display: block;
          margin-bottom: var(--spacing-m);
        }
        .header {
          align-items: center;
          background-color: var(--background-color-primary);
          border-bottom: 1px solid var(--border-color);
          border-top: 1px solid var(--border-color);
          display: flex;
          justify-content: left;
          padding: var(--spacing-s) var(--spacing-l);
        }
        .draftsOnly:not(.unresolvedOnly) gr-comment-thread[has-draft],
        .unresolvedOnly:not(.draftsOnly) gr-comment-thread[unresolved],
        .draftsOnly.unresolvedOnly gr-comment-thread[has-draft][unresolved] {
          display: block;
        }
        .thread-separator {
          border-top: 1px solid var(--border-color);
          margin-top: var(--spacing-xl);
        }
        .show-resolved-comments {
          box-shadow: none;
          padding-left: var(--spacing-m);
        }
        .partypopper {
          margin-right: var(--spacing-s);
        }
        gr-dropdown-list {
          --trigger-style-text-color: var(--primary-text-color);
          --trigger-style-font-family: var(--font-family);
        }
        .filter-text,
        .sort-text,
        .author-text {
          margin-right: var(--spacing-s);
          color: var(--deemphasized-text-color);
        }
        .author-text {
          margin-left: var(--spacing-m);
        }
        gr-account-label {
          --account-max-length: 120px;
          display: inline-block;
          user-select: none;
          --label-border-radius: 8px;
          margin: 0 var(--spacing-xs);
          padding: var(--spacing-xs) var(--spacing-m);
          line-height: var(--line-height-normal);
          cursor: pointer;
        }
        gr-account-label:focus {
          outline: none;
        }
        gr-account-label:hover,
        gr-account-label:hover {
          box-shadow: var(--elevation-level-1);
          cursor: pointer;
        }
      `]}render(){return dc`
      ${this.renderDropdown()}
      <div id="threads" part="threads">
        ${this.renderEmptyThreadsMessage()} ${this.renderCommentThreads()}
      </div>
    `}renderDropdown(){if(!this.hideDropdown)return dc`
      <div class="header">
        <span class="sort-text">Sort By:</span>
        <gr-dropdown-list
          id="sortDropdown"
          .value=${this.sortDropdownValue}
          @value-change=${e=>this.sortDropdownValue=e.detail.value}
          .items=${this.getSortDropdownEntries()}
        >
        </gr-dropdown-list>
        <span class="separator"></span>
        <span class="filter-text">Filter By:</span>
        <gr-dropdown-list
          id="filterDropdown"
          .value=${this.getCommentsDropdownValue()}
          @value-change=${this.handleCommentsDropdownValueChange}
          .items=${this.getCommentsDropdownEntries()}
        >
        </gr-dropdown-list>
        ${this.renderAuthorChips()}
      </div>
    `}renderEmptyThreadsMessage(){const e=this.getAllThreads(),t=0===e.length;if(0!==this.getDisplayedThreads().length)return;const i=this.unresolvedOnly&&!t,r=dc`<span class="partypopper">&#x1F389;</span>`,o=this.unresolvedOnly&&!t,s=dc`
      <gr-button
        class="show-resolved-comments"
        link
        @click=${this.handleAllComments}
        >Show ${Ig(e.length,"resolved comment")}</gr-button
      >
    `;return dc`
      <div>
        <span>
          ${i?r:void 0}
          ${t?"No comments":"No unresolved comments"}
          ${o?s:void 0}
        </span>
      </div>
    `}renderCommentThreads(){const e=this.getDisplayedThreads();return Mw(e,(e=>e.rootId),((t,i)=>{const r=0===i||e[i-1].path!==e[i].path,o=0!==i&&r?dc`<div class="thread-separator"></div>`:void 0,s=this.renderCommentThread(t,r);return dc`${o}${s}`}))}renderCommentThread(e,t){return dc`
      <gr-comment-thread
        .thread=${e}
        show-file-path
        ?show-ported-comment=${!!e.ported}
        ?show-comment-context=${this.showCommentContext}
        ?show-file-name=${t}
        .messageId=${this.messageId}
        ?should-scroll-into-view=${e.rootId===this.scrollCommentId}
        @comment-thread-editing-changed=${()=>{this.requestUpdate()}}
      ></gr-comment-thread>
    `}renderAuthorChips(){const e=function(e,t){if(!e||!t)return[];const i=new Set,r=[];return e.forEach((e=>e.comments.forEach((e=>{if(yf(e)&&!i.has(t._account_id))return i.add(t._account_id),void r.push(t);e.author&&!i.has(e.author._account_id)&&(i.add(e.author._account_id),r.push(e.author))})))),r}(this.getDisplayedThreads(),this.account);if(0!==e.length)return dc`<span class="author-text">From:</span>${e.map((e=>this.renderAccountChip(e)))}`}renderAccountChip(e){const t=this.selectedAuthors.some((t=>t._account_id===e._account_id));return dc`
      <gr-account-label
        .account=${e}
        @click=${this.handleAccountClicked}
        selectionChipStyle
        noStatusIcons
        ?selected=${t}
      ></gr-account-label>
    `}getCommentsDropdownValue(){return this.mentionsOnly?eP.MENTIONS:this.draftsOnly?eP.DRAFTS:this.unresolvedOnly?eP.UNRESOLVED:eP.SHOW_ALL}getSortDropdownEntries(){return[{text:HD.FILES,value:HD.FILES},{text:HD.TIMESTAMP,value:HD.TIMESTAMP}]}getCommentsDropdownEntries(){const e=[],t=this.getAllThreads();return e.push({text:`Unresolved (${t.filter(Zx).length})`,value:eP.UNRESOLVED}),this.account&&(e.push({text:`Mentions (${vC(t,this.account).length})`,value:eP.MENTIONS}),e.push({text:`Drafts (${t.filter(tC).length})`,value:eP.DRAFTS})),e.push({text:`All (${t.length})`,value:eP.SHOW_ALL}),e}handleAccountClicked(e){const t=e.target.account;ba(t,"account");const i=e=>e._account_id===t._account_id,r=this.selectedAuthors.find(i);this.selectedAuthors=r?this.selectedAuthors.filter((e=>!i(e))):[...this.selectedAuthors,t]}handleCommentsDropdownValueChange(e){switch(e.detail.value){case eP.UNRESOLVED:this.handleOnlyUnresolved();break;case eP.MENTIONS:this.handleOnlyMentions();break;case eP.DRAFTS:this.handleOnlyDrafts();break;default:this.handleAllComments()}}getAllThreads(){return this.threads}getDisplayedThreads(){const e=this.sortDropdownValue===HD.TIMESTAMP&&!this.hideDropdown;return this.getAllThreads().sort(((t,i)=>function(e,t,i=!1){if(i){const i=oC(e)?.getTime()??0,r=oC(t)?.getTime()??0;if(0!==r-i)return r-i}if(e.path!==t.path)return e.path===hg.PATCHSET_LEVEL_COMMENTS?-1:t.path===hg.PATCHSET_LEVEL_COMMENTS?1:$g(e.path,t.path);const r="number"==typeof e.line?e.line:void 0,o="number"==typeof t.line?t.line:void 0;if(r!==o)return void 0===r?-1:void 0===o?1:r<o?-1:1;if(e.patchNum!==t.patchNum)return void 0===e.patchNum?-1:void 0===t.patchNum?1:e.patchNum>t.patchNum?-1:1;const s=oC(e)?.getTime()??0,n=oC(t)?.getTime()??0;return n!==s?n-s:0}(t,i,e))).filter((e=>this.shouldShowThread(e)))}isASelectedAuthor(e){return!!e&&this.selectedAuthors.some((t=>e._account_id===t._account_id))}shouldShowThread(e){ba(e.rootId,"thread.rootId");const t=this.queryThreadElement(e.rootId);if(t?.editing)return!0;if(this.selectedAuthors.length>0){const t=e.comments.some((e=>yf(e)&&this.isASelectedAuthor(this.account)||this.isASelectedAuthor(e.author)));if(!t)return!1}return!(this.mentionsOnly&&!rC(e,this.account)||this.draftsOnly&&!tC(e)||this.unresolvedOnly&&!Zx(e))}handleOnlyUnresolved(){this.unresolvedOnly=!0,this.draftsOnly=!1,this.mentionsOnly=!1}handleOnlyMentions(){this.mentionsOnly=!0,this.unresolvedOnly=!0,this.draftsOnly=!1}handleOnlyDrafts(){this.draftsOnly=!0,this.unresolvedOnly=!1,this.mentionsOnly=!1}handleAllComments(){this.draftsOnly=!1,this.unresolvedOnly=!1,this.mentionsOnly=!1}queryThreadElement(e){return[...this.threadElements??[]].find((t=>t.rootId===e))}};jD([Gc("gr-comment-thread")],GD.prototype,"threadElements",void 0),jD([Fc({type:Array})],GD.prototype,"threads",void 0),jD([Fc({type:Boolean,attribute:"show-comment-context"})],GD.prototype,"showCommentContext",void 0),jD([Fc({type:Boolean,attribute:"unresolved-only"})],GD.prototype,"unresolvedOnly",void 0),jD([Fc({type:Boolean,attribute:"hide-dropdown"})],GD.prototype,"hideDropdown",void 0),jD([Fc({type:Object,attribute:"comment-tab-state"})],GD.prototype,"commentTabState",void 0),jD([Fc({type:String,attribute:"scroll-comment-id"})],GD.prototype,"scrollCommentId",void 0),jD([Fc({type:String,attribute:"message-id"})],GD.prototype,"messageId",void 0),jD([Uc()],GD.prototype,"changeNum",void 0),jD([Uc()],GD.prototype,"change",void 0),jD([Uc()],GD.prototype,"account",void 0),jD([Uc()],GD.prototype,"selectedAuthors",void 0),jD([Uc()],GD.prototype,"sortDropdownValue",void 0),jD([Uc()],GD.prototype,"draftsOnly",void 0),jD([Uc()],GD.prototype,"mentionsOnly",void 0),GD=jD([Dc("gr-thread-list")],GD);var zD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let VD=class extends Ic{static get styles(){return[Nc,Qb,Sd`
        #dialog {
          min-width: 40em;
        }
        p {
          margin-bottom: var(--spacing-l);
        }
        .warningBeforeSubmit {
          color: var(--warning-foreground);
          vertical-align: top;
          margin-right: var(--spacing-s);
        }
        @media screen and (max-width: 50em) {
          #dialog {
            min-width: inherit;
            width: 100%;
          }
        }
      `]}constructor(){super(),this.unresolvedThreads=[],this.initialised=!1,this.sortedRevisions=[],this.getCommentsModel=yu(this,kP),this.getChangeModel=yu(this,MT),this.getNavigation=yu(this,gy),zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getCommentsModel().threadsSaved$),(e=>this.unresolvedThreads=e.filter(Zx))),zf(this,(()=>this.getChangeModel().revisions$),(e=>this.sortedRevisions=e))}renderPrivate(){return this.change?.is_private?dc`
      <p>
        <gr-icon icon="warning" filled class="warningBeforeSubmit"></gr-icon>
        <strong>Heads Up!</strong>
        Submitting this private change will also make it public.
      </p>
    `:""}renderUnresolvedCommentCount(){return this.unresolvedThreads?.length?dc`
      <p>
        <gr-icon icon="warning" filled class="warningBeforeSubmit"></gr-icon>
        ${this.computeUnresolvedCommentsWarning()}
      </p>
      <gr-thread-list
        id="commentList"
        .threads=${this.unresolvedThreads}
        hide-dropdown
      >
      </gr-thread-list>
    `:""}renderChangeEdit(){if(!this.computeHasChangeEdit())return"";const e=this.computeEditPatchNumIndex();return dc`
      <gr-icon icon="warning" filled class="warningBeforeSubmit"></gr-icon>
      Your
      <a href="#" @click=${this.handleEditTap}>unpublished edit</a>
      ${e?dc` (between patchset ${e-1} and
          ${e+1})`:""}
      will not be submitted. Did you forget to click <b>PUBLISH</b> after
      creating the <b>EDIT</b>?
    `}computeEditPatchNumIndex(){const e=this.sortedRevisions,t=e.findIndex((e=>e._number===Ju));if(-1!==t&&t!==e.length-1)return t}renderInitialised(){return this.initialised?dc`
      <div class="header" slot="header">${this.action?.label}</div>
      <div class="main" slot="main">
        <gr-endpoint-decorator name="confirm-submit-change">
          <p>Ready to submit "<strong>${this.change?.subject}</strong>"?</p>
          ${this.renderPrivate()} ${this.renderUnresolvedCommentCount()}
          ${this.renderChangeEdit()}
          <gr-endpoint-param
            name="change"
            .value=${this.change}
          ></gr-endpoint-param>
          <gr-endpoint-param
            name="action"
            .value=${this.action}
          ></gr-endpoint-param>
        </gr-endpoint-decorator>
      </div>
    `:""}render(){return dc` <gr-dialog
      id="dialog"
      confirm-label="Continue"
      confirm-on-enter=""
      @cancel=${this.handleCancelTap}
      @confirm=${this.handleConfirmTap}
    >
      ${this.renderInitialised()}
    </gr-dialog>`}init(){this.initialised=!0}resetFocus(){this.dialog?.resetFocus()}computeHasChangeEdit(){return Object.values(this.change?.revisions??{}).some((e=>e._number===Ju))}computeUnresolvedCommentsWarning(){const e=this.unresolvedThreads.length;if(!e)throw new Error("unresolved comments undefined or 0");return`Heads Up! ${Ig(e,"unresolved comment")}.`}handleConfirmTap(e){e.preventDefault(),e.stopPropagation(),Zn(this,"confirm",{})}handleCancelTap(e){e.preventDefault(),e.stopPropagation(),Zn(this,"cancel",{})}handleEditTap(e){if(e.preventDefault(),!this.change)return;const t=WC({change:this.change,edit:!0,forceReload:!0});this.getNavigation().setUrl(t)}};var WD,qD,KD,YD;zD([Hc("#dialog")],VD.prototype,"dialog",void 0),zD([Fc({type:Object})],VD.prototype,"action",void 0),zD([Uc()],VD.prototype,"change",void 0),zD([Uc()],VD.prototype,"unresolvedThreads",void 0),zD([Uc()],VD.prototype,"initialised",void 0),zD([Uc()],VD.prototype,"sortedRevisions",void 0),VD=zD([Dc("gr-confirm-submit-dialog")],VD),function(e){e.CHANGE="change",e.REVISION="revision"}(WD||(WD={})),function(e){e[e.CHANGE=2]="CHANGE",e[e.DEFAULT=0]="DEFAULT",e[e.PRIMARY=3]="PRIMARY",e[e.REVIEW=-3]="REVIEW",e[e.REVISION=1]="REVISION"}(qD||(qD={})),function(e){e.ABANDON="abandon",e.DELETE="/",e.DELETE_EDIT="deleteEdit",e.EDIT="edit",e.FOLLOW_UP="followup",e.MOVE="move",e.PRIVATE="private",e.PRIVATE_DELETE="private.delete",e.PUBLISH_EDIT="publishEdit",e.REBASE="rebase",e.REBASE_EDIT="rebaseEdit",e.READY="ready",e.RESTORE="restore",e.REVERT="revert",e.REVERT_SUBMISSION="revert_submission",e.REVIEWED="reviewed",e.STOP_EDIT="stopEdit",e.SUBMIT="submit",e.UNREVIEWED="unreviewed",e.WIP="wip",e.INCLUDED_IN="includedIn"}(KD||(KD={})),function(e){e.CHERRYPICK="cherrypick",e.REBASE="rebase",e.SUBMIT="submit",e.DOWNLOAD="download"}(YD||(YD={}));var XD=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const JD="The destination branch can’t be empty.";var QD;!function(e){e.OK="OK",e.REJECT="REJECT",e.MAY="MAY",e.NEED="NEED",e.IMPOSSIBLE="IMPOSSIBLE",e.OPTIONAL="OPTIONAL"}(QD||(QD={}));const ZD={abandon:"Abandoning...",cherrypick:"Cherry-picking...",delete:"Deleting...",move:"Moving..",rebase:"Rebasing...",restore:"Restoring...",revert:"Reverting...",submit:"Submitting..."},eL="__additionalAction_",tL={__key:"review",__type:WD.CHANGE,enabled:!0,key:"review",label:"Quick approve",method:Uu.POST};function iL(e){return e.key===tL.key}const rL={enabled:!0,label:"Download patch",title:"Open download dialog",__key:"download",__primary:!1,__type:WD.REVISION},oL={enabled:!0,label:"Included In",title:"Open Included In dialog",__key:"includedIn",__primary:!1,__type:WD.CHANGE},sL={enabled:!0,label:"Rebase edit",title:"Rebase change edit",__key:"rebaseEdit",__primary:!1,__type:WD.CHANGE,method:Uu.POST},nL={enabled:!0,label:"Publish edit",title:"Publish change edit",__key:"publishEdit",__primary:!1,__type:WD.CHANGE,method:Uu.POST},aL={enabled:!0,label:"Delete edit",title:"Delete change edit",__key:"deleteEdit",__primary:!1,__type:WD.CHANGE,method:Uu.DELETE},lL={enabled:!0,label:"Edit",title:"Edit this change",__key:"edit",__primary:!1,__type:WD.CHANGE},dL={enabled:!0,label:"Stop editing",title:"Stop editing this change",__key:"stopEdit",__primary:!1,__type:WD.CHANGE},cL=new Map([[KD.ABANDON,{icon:"block"}],[KD.DELETE_EDIT,{icon:"delete",filled:!0}],[KD.EDIT,{icon:"edit",filled:!0}],[KD.PUBLISH_EDIT,{icon:"publish",filled:!0}],[KD.READY,{icon:"visibility",filled:!0}],[KD.REBASE_EDIT,{icon:"rebase_edit"}],[YD.REBASE,{icon:"rebase"}],[KD.RESTORE,{icon:"history"}],[KD.REVERT,{icon:"undo"}],[KD.STOP_EDIT,{icon:"stop",filled:!0}],[tL.key,{icon:"check"}],[YD.SUBMIT,{icon:"done_all"}]]),hL=new Set([KD.DELETE_EDIT,KD.EDIT,KD.PUBLISH_EDIT,KD.REBASE_EDIT,KD.STOP_EDIT]),pL=[KD.REVIEWED,KD.UNREVIEWED,KD.REVERT_SUBMISSION];function uL(e){if(!e)throw new Error("action is undefined");const t=e;if(void 0===t.__key||void 0===t.__type)throw new Error("action is not an UIActionInfo");return t}let gL=class extends Ic{constructor(){super(),this.actions={},this.primaryActionKeys=[KD.READY,YD.SUBMIT],this._hideQuickApproveAction=!1,this.commitMessage="",this.actionLoadingMessage="",this.inProgressActionKeys=new Set,this.allActionValues=[],this.overflowActions=[{type:WD.CHANGE,key:KD.WIP},{type:WD.CHANGE,key:KD.DELETE},{type:WD.REVISION,key:YD.CHERRYPICK},{type:WD.CHANGE,key:KD.MOVE},{type:WD.REVISION,key:YD.DOWNLOAD},{type:WD.CHANGE,key:KD.REVIEWED},{type:WD.CHANGE,key:KD.UNREVIEWED},{type:WD.CHANGE,key:KD.PRIVATE},{type:WD.CHANGE,key:KD.PRIVATE_DELETE},{type:WD.CHANGE,key:KD.FOLLOW_UP},{type:WD.CHANGE,key:KD.INCLUDED_IN}],this.actionPriorityOverrides=[],this.additionalActions=[],this.hiddenActions=[],this.disabledMenuActions=[],this.editPatchsetLoaded=!1,this.editMode=!1,this.editBasedOnCurrentPatchSet=!0,this.loggedIn=!1,this.pluginsLoaded=!1,this.restApiService=Xn().restApiService,this.reporting=Xn().reportingService,this.getPluginLoader=yu(this,U_),this.getUserModel=yu(this,jf),this.getConfigModel=yu(this,Qw),this.getChangeModel=yu(this,MT),this.getStorage=yu(this,TO),this.getNavigation=yu(this,gy),this.getCommentsModel=yu(this,kP),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getChangeModel().patchsets$),(e=>{return this.editBasedOnCurrentPatchSet=!(!(t=e)||t.length<2)&&t[0].num===Ju;var t})),zf(this,(()=>this.getChangeModel().patchNum$),(e=>this.editPatchsetLoaded="edit"===e)),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getChangeModel().status$),(e=>this.changeStatus=e)),zf(this,(()=>this.getChangeModel().mergeable$),(e=>this.mergeable=e)),zf(this,(()=>this.getChangeModel().editMode$),(e=>this.editMode=e)),zf(this,(()=>this.getChangeModel().revision$),(e=>this.commitNum=e?.commit?.commit)),zf(this,(()=>this.getChangeModel().latestRevision$),(e=>this.commitMessage=e?.commit?.message??"")),zf(this,(()=>this.getUserModel().account$),(e=>this.account=e)),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.loggedIn=e)),zf(this,(()=>this.getPluginLoader().pluginsModel.pluginsLoaded$),(e=>this.pluginsLoaded=e)),zf(this,(()=>this.getConfigModel().repoConfig$),(e=>this.privateByDefault=e?.private_by_default)),zf(this,(()=>this.getCommentsModel().threadsWithUnappliedSuggestions$),(e=>this.threadsWithUnappliedSuggestions=e))}connectedCallback(){super.connectedCallback(),this.getPluginLoader().jsApiService.addElement(a_.CHANGE_ACTIONS,this)}static get styles(){return[Nc,Iw,Sd`
        :host {
          display: flex;
          font-family: var(--font-family);
        }
        #actionLoadingMessage,
        #mainContent,
        section {
          display: flex;
        }
        #actionLoadingMessage,
        gr-button,
        gr-dropdown {
          /* px because don't have the same font size */
          margin-left: 8px;
        }
        gr-button {
          display: block;
        }
        #actionLoadingMessage {
          align-items: center;
          color: var(--deemphasized-text-color);
        }
        #confirmSubmitDialog .changeSubject {
          margin: var(--spacing-l);
          text-align: center;
        }
        gr-icon {
          color: inherit;
          margin-right: var(--spacing-xs);
        }
        #moreActions gr-icon {
          margin: 0;
        }
        #moreMessage,
        .hidden {
          display: none;
        }
        .info {
          background-color: var(--info-background);
          padding: var(--spacing-l) var(--spacing-xl);
          margin-bottom: var(--spacing-l);
        }
        .info gr-icon {
          color: var(--selected-foreground);
          margin-right: var(--spacing-xl);
        }
        @media screen and (max-width: 50em) {
          #mainContent {
            flex-wrap: wrap;
          }
          gr-button {
            --gr-button-padding: var(--spacing-m);
            white-space: nowrap;
          }
          gr-button,
          gr-dropdown {
            margin: 0;
          }
          #actionLoadingMessage {
            margin: var(--spacing-m);
            text-align: center;
          }
          #moreMessage {
            display: inline;
          }
        }
      `]}render(){return this.change?dc`
      <div id="mainContent">
        <span id="actionLoadingMessage" ?hidden=${!this.actionLoadingMessage}>
          ${this.actionLoadingMessage}
        </span>
        <section
          id="primaryActions"
          ?hidden=${this.isLoading()||!this.topLevelActions||!this.topLevelActions.length}
        >
          ${this.topLevelPrimaryActions?.map((e=>this.renderUIAction(e)))}
        </section>
        <section
          id="secondaryActions"
          ?hidden=${this.isLoading()||!this.topLevelActions||!this.topLevelActions.length}
        >
          ${this.topLevelSecondaryActions?.map((e=>this.renderUIAction(e)))}
        </section>
        <gr-button ?hidden=${!this.isLoading()}>Loading actions...</gr-button>
        <gr-dropdown
          id="moreActions"
          link
          @tap-item=${this.handleOverflowItemTap}
          ?hidden=${this.isLoading()||!this.menuActions||!this.menuActions.length}
          .disabledIds=${this.disabledMenuActions}
          .items=${this.menuActions}
        >
          <gr-icon icon="more_vert" aria-labelledby="moreMessage"></gr-icon>
          <span id="moreMessage">More</span>
        </gr-dropdown>
      </div>
      <dialog id="actionsModal" tabindex="-1">
        <gr-confirm-rebase-dialog
          id="confirmRebase"
          class="confirmDialog"
          @confirm-rebase=${this.handleRebaseConfirm}
          @cancel=${this.handleConfirmDialogCancel}
          .disableActions=${this.inProgressActionKeys.has(YD.REBASE)}
          .branch=${this.change?.branch}
          .rebaseOnCurrent=${!!this.revisionActions?.rebase?.enabled}
        ></gr-confirm-rebase-dialog>
        <gr-confirm-cherrypick-dialog
          id="confirmCherrypick"
          class="confirmDialog"
          .changeStatus=${this.changeStatus}
          .commitMessage=${this.commitMessage}
          .commitNum=${this.commitNum}
          @confirm=${this.handleCherrypickConfirm}
          @cancel=${this.handleConfirmDialogCancel}
          .project=${this.change?.project}
        ></gr-confirm-cherrypick-dialog>
        <gr-confirm-cherrypick-conflict-dialog
          id="confirmCherrypickConflict"
          class="confirmDialog"
          @confirm=${this.handleCherrypickConflictConfirm}
          @cancel=${this.handleConfirmDialogCancel}
        ></gr-confirm-cherrypick-conflict-dialog>
        <gr-confirm-move-dialog
          id="confirmMove"
          class="confirmDialog"
          @confirm=${this.handleMoveConfirm}
          @cancel=${this.handleConfirmDialogCancel}
          .project=${this.change?.project}
        ></gr-confirm-move-dialog>
        <gr-confirm-revert-dialog
          id="confirmRevertDialog"
          class="confirmDialog"
          @confirm-revert=${this.handleRevertDialogConfirm}
          @cancel=${this.handleConfirmDialogCancel}
        ></gr-confirm-revert-dialog>
        <gr-confirm-abandon-dialog
          id="confirmAbandonDialog"
          class="confirmDialog"
          @confirm=${this.handleAbandonDialogConfirm}
          @cancel=${this.handleConfirmDialogCancel}
        ></gr-confirm-abandon-dialog>
        <gr-confirm-submit-dialog
          id="confirmSubmitDialog"
          class="confirmDialog"
          .action=${this.revisionActions?.submit}
          @cancel=${this.handleConfirmDialogCancel}
          @confirm=${this.handleSubmitConfirm}
        ></gr-confirm-submit-dialog>
        <gr-dialog
          id="createFollowUpDialog"
          class="confirmDialog"
          confirm-label="Create"
          @confirm=${this.handleCreateFollowUpChange}
          @cancel=${this.handleCloseCreateFollowUpChange}
        >
          <div class="header" slot="header">Create Follow-Up Change</div>
          <div class="main" slot="main">
            <gr-create-change-dialog
              id="createFollowUpChange"
              .branch=${this.change?.branch}
              .baseChange=${this.change?.change_id}
              .repoName=${this.change?.project}
              .privateByDefault=${this.privateByDefault}
            ></gr-create-change-dialog>
          </div>
        </gr-dialog>
        <gr-dialog
          id="confirmDeleteDialog"
          class="confirmDialog"
          confirm-label="Delete"
          confirm-on-enter=""
          @cancel=${this.handleConfirmDialogCancel}
          @confirm=${this.handleDeleteConfirm}
        >
          <div class="header" slot="header">Delete Change</div>
          <div class="main" slot="main">
            Do you really want to delete the change?
          </div>
        </gr-dialog>
        <gr-dialog
          id="confirmDeleteEditDialog"
          class="confirmDialog"
          confirm-label="Delete"
          confirm-on-enter=""
          @cancel=${this.handleConfirmDialogCancel}
          @confirm=${this.handleDeleteEditConfirm}
        >
          <div class="header" slot="header">Delete Change Edit</div>
          <div class="main" slot="main">
            Do you really want to delete the edit?
          </div>
        </gr-dialog>
        <gr-dialog
          id="confirmPublishEditDialog"
          class="confirmDialog"
          confirm-label="Publish"
          confirm-on-enter=""
          @cancel=${this.handleConfirmDialogCancel}
          @confirm=${this.handlePublishEditConfirm}
        >
          <div class="header" slot="header">Publish Change Edit</div>
          <div class="main" slot="main">
            ${eb(this.numberOfThreadsWithUnappliedSuggestions()>0,(()=>dc`<p class="info">
                <gr-icon id="icon" icon="info" small></gr-icon>
                Heads Up! ${this.numberOfThreadsWithUnappliedSuggestions()}
                comments have suggestions you can apply before publishing
              </p>`))}
            Do you really want to publish the edit?
          </div>
        </gr-dialog>
      </dialog>
    `:uc}renderUIAction(e){return dc`
      <gr-tooltip-content
        title=${Vw(e.title)}
        .hasTooltip=${!!e.title}
        ?position-below=${!0}
      >
        <gr-button
          link
          class=${e.__key}
          data-action-key=${e.__key}
          data-label=${e.label}
          ?disabled=${this.calculateDisabled(e)}
          @click=${t=>this.handleActionTap(t,e.__key,e.__type)}
        >
          ${this.renderUIActionIcon(e)} ${e.label}
        </gr-button>
      </gr-tooltip-content>
    `}renderUIActionIcon(e){return e.icon?dc`
      <gr-icon icon=${e.icon} ?filled=${!!e.filled}></gr-icon>
    `:uc}willUpdate(e){e.has("change")&&(this.reload(),this.actions=this.change?.actions??{}),this.editStatusChanged(),(e.has("actions")||e.has("revisionActions")||e.has("additionalActions"))&&this.actionsChanged(),this.allActionValues=this.computeAllActions(),this.topLevelActions=this.allActionValues.filter((e=>!this.hiddenActions.includes(e.__key)&&(this.editMode?hL.has(e.__key):!this.isOverflowAction(e.__type,e.__key)))),this.topLevelPrimaryActions=this.topLevelActions.filter((e=>e.__primary)),this.topLevelSecondaryActions=this.topLevelActions.filter((e=>!e.__primary)),this.menuActions=this.computeMenuActions()}reload(){if(!this.changeNum||!this.latestPatchNum||!this.change)return Promise.resolve();const e=this.change;return this.revisionActions=void 0,this.restApiService.getChangeRevisionActions(this.changeNum,this.latestPatchNum).then((t=>{this.revisionActions=t??{},this.sendShowRevisionActions({change:e,revisionActions:this.revisionActions})})).catch((e=>{throw ea(this,"Couldn’t load revision actions."),e}))}isLoading(){return!this.pluginsLoaded||!this.change||void 0===this.mergeable||void 0===this.revisionActions}sendShowRevisionActions(e){this.getPluginLoader().jsApiService.handleShowRevisionActions(e)}addActionButton(e,t){if(e!==WD.CHANGE&&e!==WD.REVISION)throw Error(`Invalid action type: ${e}`);const i={enabled:!0,label:t,__type:e,__key:eL+$a()};return this.additionalActions.push(i),this.requestUpdate("additionalActions"),i.__key}removeActionButton(e){const t=this.indexOfActionButtonWithKey(e);-1!==t&&(this.additionalActions.splice(t,1),this.requestUpdate("additionalActions"))}setActionButtonProp(e,t,i){this.additionalActions[this.indexOfActionButtonWithKey(e)][t]=i,this.requestUpdate("additionalActions")}setActionOverflow(e,t,i){if(e!==WD.CHANGE&&e!==WD.REVISION)throw Error(`Invalid action type given: ${e}`);i!==this.isOverflowAction(e,t)&&(i||(this.overflowActions=this.overflowActions.filter((i=>i.type!==e||i.key!==t))),i&&(this.overflowActions=[...this.overflowActions,{type:e,key:t}]))}setActionPriority(e,t,i){if(e!==WD.CHANGE&&e!==WD.REVISION)throw Error(`Invalid action type given: ${e}`);const r=this.actionPriorityOverrides.findIndex((i=>i.type===e&&i.key===t)),o={type:e,key:t,priority:i};-1!==r?(this.actionPriorityOverrides[r]=o,this.requestUpdate("actionPriorityOverrides")):(this.actionPriorityOverrides.push(o),this.requestUpdate("actionPriorityOverrides"))}setActionHidden(e,t,i){if(e!==WD.CHANGE&&e!==WD.REVISION)throw Error(`Invalid action type given: ${e}`);const r=this.hiddenActions.indexOf(t);i&&-1===r?(this.hiddenActions.push(t),this.requestUpdate("hiddenActions")):i||-1===r||(this.hiddenActions.splice(r,1),this.requestUpdate("hiddenActions"))}getActionDetails(e){return this.revisionActions?.[e]?this.revisionActions[e]:this.actions?.[e]?this.actions[e]:void 0}indexOfActionButtonWithKey(e){return this.additionalActions.findIndex((t=>t.__key===e))}actionsChanged(){this.actionLoadingMessage="",this.disabledMenuActions=[],this.revisionActions&&!this.revisionActions.download&&(this.revisionActions={...this.revisionActions,download:rL},Jn(this,"revision-actions-changed",{value:this.revisionActions})),this.actions.includedIn||this.change?.status!==Nu.MERGED||(this.actions={...this.actions,includedIn:oL})}editStatusChanged(){this.change&&this.loggedIn&&(this.editPatchsetLoaded?(PC(this.change)&&(this.editBasedOnCurrentPatchSet?(this.actions.publishEdit||(this.actions={...this.actions,publishEdit:nL}),delete this.actions.rebaseEdit):(this.actions.rebaseEdit||(this.actions={...this.actions,rebaseEdit:sL}),delete this.actions.publishEdit)),this.actions.deleteEdit||(this.actions={...this.actions,deleteEdit:aL})):(delete this.actions.rebaseEdit,delete this.actions.publishEdit,delete this.actions.deleteEdit),PC(this.change)?(this.editPatchsetLoaded||this.editMode?delete this.actions.edit:this.actions.edit||(this.actions={...this.actions,edit:lL}),this.editMode&&!this.editPatchsetLoaded?this.actions.stopEdit||(this.actions={...this.actions,stopEdit:dL},ea(this,"Change is in edit mode")):delete this.actions.stopEdit):delete this.actions.edit)}getValuesFor(e){return Object.keys(e).map((t=>e[t]))}getLabelStatus(e){if(Zu(e)){if(e.approved)return QD.OK;if(e.rejected)return QD.REJECT}return e.optional?QD.OPTIONAL:QD.NEED}getTopMissingApproval(){if(!this.change||!this.change.labels||!this.change.permitted_labels)return null;if(this.change?.status===Nu.MERGED)return null;let e;for(const[t,i]of Object.entries(this.change.labels)){if(!(t in this.change.permitted_labels))continue;if(0===this.change.permitted_labels[t].length)continue;const r=this.getLabelStatus(i);if(r===QD.NEED){if(e){e=null;break}e=t}else if(r===QD.REJECT||r===QD.IMPOSSIBLE)return null}const t=this.change.labels[rv.CODE_REVIEW],i=this.change.permitted_labels[rv.CODE_REVIEW];if(!e&&t&&i&&this.account?._account_id&&Xu(t)&&!DC(this.change,this.account)&&pv(t,this.account)?.value!==sv(t)?.max&&(e=rv.CODE_REVIEW),e){const t=this.change.labels[e];if(!Xu(t))return null;const i=this.change.permitted_labels[e],r=i[i.length-1],o=sv(t)?.max;if(Number(r)===o)return{label:e,score:r}}return null}hideQuickApproveAction(){if(!this.topLevelSecondaryActions)throw new Error("topLevelSecondaryActions must be set");this.topLevelSecondaryActions=this.topLevelSecondaryActions.filter((e=>!iL(e))),this._hideQuickApproveAction=!0}getQuickApproveAction(){if(this._hideQuickApproveAction)return null;const e=this.getTopMissingApproval();if(!e)return null;const t={...tL};t.label=e.label+e.score;const i=Number(e.score);if(isNaN(i))return null;const r={drafts:_g.PUBLISH_ALL_REVISIONS,labels:{[e.label]:i}};return t.payload=r,t}getActionValues(e,t,i,r){if(!e||!t)return[];const o=e,s=t,n=[],a=r===WD.CHANGE?this.getValuesFor(KD):this.getValuesFor(YD),l=[];Object.keys(o).forEach((e=>{const t=o[e];if(t.__key=e,t.__type=r,t.__primary=s.includes(e),-1!==e.indexOf("~"))return this.populateActionUrl(t),l.push(t),this.overflowActions.push({type:r,key:e}),void this.requestUpdate("overflowActions");a.includes(e)&&(t.label=this.getActionLabel(t),n.push({...t}))}));let d=i;return d=d.filter((e=>e.__type===r)).map((e=>(e.__primary=s.includes(e.__key),{...e}))),n.concat(d).concat(l)}populateActionUrl(e){const t=e.__type===WD.REVISION?this.latestPatchNum:void 0;this.changeNum&&this.restApiService.getChangeActionURL(this.changeNum,t,"/"+e.__key).then((t=>e.__url=t))}getActionLabel(e){return"Delete"===e.label?"Delete change":"WIP"===e.label?"Mark as work in progress":this.toSentenceCase(e.label)}toSentenceCase(e){return e.length?e[0].toUpperCase()+e.slice(1).toLowerCase():""}computeLoadingLabel(e){return ZD[e]||"Working..."}canSubmitChange(){if(!this.change)return!1;const e=this.change,t=this.getRevision(e,this.latestPatchNum);return this.getPluginLoader().jsApiService.canSubmitChange(e,t)}sendPublishEditEvent(){if(!this.change)return;const e=this.change,t=this.getRevision(e,this.latestPatchNum);this.getPluginLoader().jsApiService.handlePublishEdit(e,t)}getRevision(e,t){for(const i of Object.values(e.revisions??{}))if(i._number===t)return i;return null}async showRevertDialog(){const e=this.change;if(!e)return;const t=`submissionid: "${e.submission_id}"`,[i,r]=await Promise.all([this.restApiService.getChanges(0,t),this.restApiService.getValidationOptions(this.change._number)]);i&&(ba(this.confirmRevertDialog,"confirmRevertDialog"),this.confirmRevertDialog.populate(e,r,this.commitMessage,i.length),this.showActionDialog(this.confirmRevertDialog))}showSubmitDialog(){this.canSubmitChange()&&(ba(this.confirmSubmitDialog,"confirmSubmitDialog"),this.showActionDialog(this.confirmSubmitDialog))}async handleActionTap(e,t,i){e.preventDefault();let r=e.target;for(;"gr-button"!==r.tagName.toLowerCase();){if(!r.parentElement)return;r=r.parentElement}t.startsWith(eL)||-1!==t.indexOf("~")?this.dispatchEvent(new CustomEvent(`${t}-tap`,{detail:{node:r},composed:!0,bubbles:!0})):await this.handleAction(i,t)}async handleOverflowItemTap(e){e.preventDefault();const t=e.target,i=e.detail.action.__key;i.startsWith(eL)||-1!==i.indexOf("~")?this.dispatchEvent(new CustomEvent(`${i}-tap`,{detail:{node:t},composed:!0,bubbles:!0})):await this.handleAction(e.detail.action.__type,e.detail.action.__key)}async handleAction(e,t){switch(this.reporting.reportInteraction(`${e}-${t}`),e){case WD.REVISION:this.handleRevisionAction(t);break;case WD.CHANGE:await this.handleChangeAction(t);break;default:this.fireAction(this.prependSlash(t),uL(this.actions[t]),!1)}}async handleChangeAction(e){if(await this.getPluginLoader().jsApiService.handleBeforeChangeAction(e,this.change))switch(e){case KD.REVERT:this.showRevertDialog();break;case KD.ABANDON:ba(this.confirmAbandonDialog,"confirmAbandonDialog"),this.showActionDialog(this.confirmAbandonDialog);break;case tL.key:{const t=this.allActionValues.find(iL);if(!t)return;this.fireAction(this.prependSlash(e),t,!0,t.payload);break}case KD.EDIT:this.handleEditTap();break;case KD.STOP_EDIT:this.handleStopEditTap();break;case KD.DELETE:this.handleDeleteTap();break;case KD.DELETE_EDIT:this.handleDeleteEditTap();break;case KD.FOLLOW_UP:this.handleFollowUpTap();break;case KD.WIP:this.handleWipTap();break;case KD.MOVE:this.handleMoveTap();break;case KD.PUBLISH_EDIT:this.handlePublishEditTap();break;case KD.REBASE_EDIT:this.handleRebaseEditTap();break;case KD.INCLUDED_IN:this.handleIncludedInTap();break;default:this.fireAction(this.prependSlash(e),uL(this.actions[e]),!1)}}handleRevisionAction(e){switch(e){case YD.REBASE:ba(this.confirmRebase,"confirmRebase"),this.showActionDialog(this.confirmRebase),this.confirmRebase.initiateFetchInfo();break;case YD.CHERRYPICK:this.handleCherrypickTap();break;case YD.DOWNLOAD:this.handleDownloadTap();break;case YD.SUBMIT:if(!this.canSubmitChange())return;ba(this.confirmSubmitDialog,"confirmSubmitDialog"),this.showActionDialog(this.confirmSubmitDialog);break;default:this.fireAction(this.prependSlash(e),uL(this.revisionActions?.[e]),!0)}}prependSlash(e){return"/"===e?e:`/${e}`}calculateDisabled(e){return"rebase"!==e.__key&&!e.enabled}handleConfirmDialogCancel(){this.hideAllDialogs()}hideAllDialogs(){ba(this.confirmSubmitDialog,"confirmSubmitDialog");const e=ya(this,".confirmDialog");for(const t of e)t.hidden=!0;ba(this.actionsModal,"actionsModal"),this.actionsModal.close()}handleRebaseConfirm(e){ba(this.confirmRebase,"confirmRebase"),ba(this.actionsModal,"actionsModal");const t={base:e.detail.base,allow_conflicts:e.detail.allowConflicts,on_behalf_of_uploader:e.detail.onBehalfOfUploader,committer_email:e.detail.committerEmail,validation_options:this.computeValidationOptionsForPayload(this.confirmRebase.getValidationOptions())},i=!!e.detail.rebaseChain;this.fireAction(i?"/rebase:chain":"/rebase",uL(this.revisionActions?.rebase),!i,t,{allow_conflicts:t.allow_conflicts,on_behalf_of_uploader:t.on_behalf_of_uploader})}handleCherrypickConfirm(){this.handleCherryPickRestApi(!1)}handleCherrypickConflictConfirm(){this.handleCherryPickRestApi(!0)}handleCherryPickRestApi(e){ba(this.confirmCherrypick,"confirmCherrypick"),ba(this.actionsModal,"actionsModal");const t=this.confirmCherrypick;t.branch?t.message?(this.actionsModal.close(),t.hidden=!0,this.fireAction("/cherrypick",uL(this.revisionActions?.cherrypick),!0,{destination:t.branch,base:t.baseCommit?t.baseCommit:null,message:t.message,allow_conflicts:e,committer_email:t.committerEmail?t.committerEmail:null})):ea(this,"The commit message can’t be empty."):ea(this,JD)}handleMoveConfirm(){ba(this.confirmMove,"confirmMove"),ba(this.actionsModal,"actionsModal");const e=this.confirmMove;e.branch?(this.actionsModal.close(),e.hidden=!0,this.fireAction("/move",uL(this.actions.move),!1,{destination_branch:e.branch,message:e.message})):ea(this,JD)}computeValidationOptionsForPayload(e){const t={};for(const i of e)t[i.name]="true";return t}handleRevertDialogConfirm(e){ba(this.confirmRevertDialog,"confirmRevertDialog"),ba(this.actionsModal,"actionsModal");const t=e.detail.revertType,i=e.detail.message,r=this.confirmRevertDialog;switch(this.actionsModal.close(),r.hidden=!0,t){case pD.REVERT_SINGLE_CHANGE:this.fireAction("/revert",uL(this.actions.revert),!1,{message:i,validation_options:this.computeValidationOptionsForPayload(this.confirmRevertDialog.getValidationOptions())});break;case pD.REVERT_SUBMISSION:this.fireAction("/revert_submission",{__key:"revert_submission",method:Uu.POST},!1,{message:i,validation_options:this.computeValidationOptionsForPayload(this.confirmRevertDialog.getValidationOptions())});break;default:this.reporting.error("Change Actions",new Error("invalid revert type"))}}handleAbandonDialogConfirm(){ba(this.confirmAbandonDialog,"confirmAbandonDialog"),ba(this.actionsModal,"actionsModal");const e=this.confirmAbandonDialog;this.actionsModal.close(),e.hidden=!0,this.fireAction("/abandon",uL(this.actions.abandon),!1,{message:e.message})}handleCreateFollowUpChange(){ba(this.createFollowUpChange,"createFollowUpChange"),this.createFollowUpChange.handleCreateChange(),this.handleCloseCreateFollowUpChange()}handleCloseCreateFollowUpChange(){ba(this.actionsModal,"actionsModal"),this.actionsModal.close()}handleDeleteConfirm(){this.hideAllDialogs(),this.fireAction("/",uL(this.actions[KD.DELETE]),!1)}handleDeleteEditConfirm(){this.hideAllDialogs(),this.getStorage().eraseEditableContentItemsForChangeEdit(this.changeNum),this.fireAction("/edit",uL(this.actions.deleteEdit),!1)}handlePublishEditConfirm(){this.hideAllDialogs(),this.actions.publishEdit&&(this.getStorage().eraseEditableContentItemsForChangeEdit(this.changeNum),this.fireAction("/edit:publish",uL(this.actions.publishEdit),!1,{notify:xg.OWNER_REVIEWERS}),this.sendPublishEditEvent())}handleSubmitConfirm(){this.canSubmitChange()&&(this.hideAllDialogs(),this.fireAction("/submit",uL(this.revisionActions?.submit),!0))}isOverflowAction(e,t){return this.overflowActions.some((i=>i.type===e&&i.key===t))}setLoadingOnButtonWithKey(e){const t=e.__key;this.inProgressActionKeys.add(t),this.actionLoadingMessage=this.computeLoadingLabel(t);let i=t;if(i===KD.REVERT_SUBMISSION&&(i=KD.REVERT),this.isOverflowAction(e.__type,i))return this.disabledMenuActions.push("/"===i?"delete-change":`${i}-${e.__type}`),this.requestUpdate("disabledMenuActions"),()=>{this.inProgressActionKeys.delete(t),this.actionLoadingMessage="",this.disabledMenuActions=[],this.requestUpdate()};const r=this.shadowRoot.querySelector(`[data-action-key="${i}"]`);if(!r)throw new Error(`Can't find button by data-action-key '${i}'`);return r.setAttribute("loading","true"),r.disabled=!0,()=>{this.inProgressActionKeys.delete(e.__key),this.actionLoadingMessage="",r.removeAttribute("loading"),r.disabled=!1,this.requestUpdate()}}fireAction(e,t,i,r,o){const s=this.setLoadingOnButtonWithKey(t);this.reporting.reportInteraction(ga.CHANGE_ACTION_FIRED,{endpoint:e,toReport:o}),this.send(t.method,r,e,i,s,t).then((e=>this.handleResponse(t,e)))}showActionDialog(e){this.hideAllDialogs(),e.init&&e.init(),e.hidden=!1,ba(this.actionsModal,"actionsModal"),this.actionsModal.isConnected&&this.actionsModal.showModal(),Ln(e,(()=>{e.resetFocus&&e.resetFocus()}))}setReviewOnRevert(e){const t=this.getPluginLoader().jsApiService.getReviewPostRevert(this.change);return t?this.restApiService.saveChangeReview(e,$x,t):Promise.resolve(void 0)}async handleResponse(e,t){if(t?.ok)switch(e.__key){case KD.REVERT:{const e=(await Df(t)).parsed;if(this.restApiService.addRepoNameToCache(e._number,e.project),!await this.waitForChangeReachable(e._number))return;await this.setReviewOnRevert(e._number),this.getNavigation().setUrl(WC({change:e}));break}case YD.CHERRYPICK:{const e=(await Df(t)).parsed;if(this.restApiService.addRepoNameToCache(e._number,e.project),!this.waitForChangeReachable(e._number))return;this.getNavigation().setUrl(WC({change:e}));break}case KD.DELETE:e.__type===WD.CHANGE&&this.getNavigation().setUrl(kf());break;case KD.WIP:case KD.DELETE_EDIT:case KD.PUBLISH_EDIT:case KD.REBASE_EDIT:case KD.REBASE:case KD.SUBMIT:this.actionsModal?.close(),this.hideAllDialogs(),this.getChangeModel().navigateToChangeResetReload();break;case KD.REVERT_SUBMISSION:{const e=(await Df(t)).parsed;if(!e.revert_changes||!e.revert_changes.length)return;const i=e.revert_changes[0].topic;this.getNavigation().setUrl(tE({topic:i}));break}default:this.getChangeModel().navigateToChangeResetReload()}}handleResponseError(e,t,i){return t?e&&e.__key===YD.CHERRYPICK&&409===t.status&&i&&!i.allow_conflicts?(ba(this.confirmCherrypickConflict,"confirmCherrypickConflict"),void this.showActionDialog(this.confirmCherrypickConflict)):t.text().then((e=>{if(ta(this,`Could not perform action: ${e}`),!e.startsWith("Change is already up to date"))throw Error(e)})):Promise.resolve((()=>{ta(this,`Could not perform action '${e.__key}'`)}))}send(e,t,i,r,o,s){const n=e=>{o.call(this),this.handleResponseError(s,e,t)},a=this.change,l=this.changeNum;return a&&l?this.getChangeModel().fetchChangeUpdates(a).then((s=>{if(!s.isLatest)return Jn(this,"show-alert",{message:"Cannot set label: a newer patch has been uploaded to this change.",action:"Reload",callback:()=>this.getChangeModel().navigateToChangeResetReload()}),o(),Promise.resolve(void 0);const a=r?this.latestPatchNum:void 0;return this.restApiService.executeChangeAction(l,e,i,a,t,n).then((e=>(o.call(this),e)))})):Promise.reject(new Error("Properties change and changeNum must be set."))}async handleCherrypickTap(){if(!this.change)throw new Error("The change property must be set");ba(this.confirmCherrypick,"confirmCherrypick"),this.confirmCherrypick.branch="";const e=await this.getCherryPickChanges();e.length&&(this.confirmCherrypick.updateChanges(e),this.showActionDialog(this.confirmCherrypick))}async getCherryPickChanges(){if(!this.change)return[];if(!this.change.topic)return[this.change];const e=`topic: "${this.change.topic}"`,t=TC(uf.MESSAGES,uf.ALL_REVISIONS);return this.restApiService.getChanges(0,e,void 0,t).then((e=>e||(this.reporting.error("Change Actions",new Error("getChanges returns undefined")),[])))}handleMoveTap(){ba(this.confirmMove,"confirmMove"),this.confirmMove.branch="",this.confirmMove.message="",this.showActionDialog(this.confirmMove)}handleDownloadTap(){Jn(this,"download-tap",{})}handleIncludedInTap(){Jn(this,"included-tap",{})}handleDeleteTap(){ba(this.confirmDeleteDialog,"confirmDeleteDialog"),this.showActionDialog(this.confirmDeleteDialog)}handleDeleteEditTap(){ba(this.confirmDeleteEditDialog,"confirmDeleteEditDialog"),this.showActionDialog(this.confirmDeleteEditDialog)}handleFollowUpTap(){ba(this.createFollowUpDialog,"createFollowUpDialog"),this.showActionDialog(this.createFollowUpDialog)}handleWipTap(){this.actions.wip&&this.fireAction("/wip",uL(this.actions.wip),!1)}handlePublishEditTap(){this.numberOfThreadsWithUnappliedSuggestions()>0?(ba(this.confirmPublishEditDialog,"confirmPublishEditDialog"),this.showActionDialog(this.confirmPublishEditDialog)):this.handlePublishEditConfirm()}handleRebaseEditTap(){this.actions.rebaseEdit&&this.fireAction("/edit:rebase",uL(this.actions.rebaseEdit),!1)}computeAllActions(){if(void 0===this.change)return[];const e=this.getActionValues(this.revisionActions,this.primaryActionKeys,this.additionalActions,WD.REVISION),t=this.getActionValues(this.actions,this.primaryActionKeys,this.additionalActions,WD.CHANGE),i=this.getQuickApproveAction();return i&&t.unshift(i),e.concat(t).sort(((e,t)=>this.actionComparator(e,t))).map((e=>({...e,...cL.get(e.__key)??{}}))).filter((e=>!this.shouldSkipAction(e)))}getActionPriority(e){if(e.__type&&e.__key){const t=this.actionPriorityOverrides.find((t=>t.type===e.__type&&t.key===e.__key));if(void 0!==t)return t.priority}return"review"===e.__key?qD.REVIEW:e.__primary?qD.PRIMARY:e.__type===WD.CHANGE?qD.CHANGE:e.__type===WD.REVISION?qD.REVISION:qD.DEFAULT}actionComparator(e,t){const i=this.getActionPriority(e)-this.getActionPriority(t);return 0===i?e.label>t.label?1:-1:i}shouldSkipAction(e){return pL.includes(e.__key)}computeMenuActions(){return this.allActionValues.filter((e=>this.isOverflowAction(e.__type,e.__key)&&!this.hiddenActions.includes(e.__key))).map((e=>{let t=e.__key;return"/"===t&&(t="delete"),{name:e.label,id:`${t}-${e.__type}`,action:e,tooltip:e.title}}))}waitForChangeReachable(e){let t=5;return new Promise((i=>{const r=()=>{t--,this.restApiService.getChange(e,0!==t?()=>{}:void 0).then((e=>{e?i(!0):t?setTimeout(r,1e3):i(!1)}))};r()}))}handleEditTap(){Zn(this,"edit-tap",{})}handleStopEditTap(){Zn(this,"stop-edit-tap",{})}numberOfThreadsWithUnappliedSuggestions(){return this.threadsWithUnappliedSuggestions?this.threadsWithUnappliedSuggestions.length:0}};XD([Hc("#mainContent")],gL.prototype,"mainContent",void 0),XD([Hc("#actionsModal")],gL.prototype,"actionsModal",void 0),XD([Hc("#confirmRebase")],gL.prototype,"confirmRebase",void 0),XD([Hc("#confirmCherrypick")],gL.prototype,"confirmCherrypick",void 0),XD([Hc("#confirmCherrypickConflict")],gL.prototype,"confirmCherrypickConflict",void 0),XD([Hc("#confirmMove")],gL.prototype,"confirmMove",void 0),XD([Hc("#confirmRevertDialog")],gL.prototype,"confirmRevertDialog",void 0),XD([Hc("#confirmAbandonDialog")],gL.prototype,"confirmAbandonDialog",void 0),XD([Hc("#confirmSubmitDialog")],gL.prototype,"confirmSubmitDialog",void 0),XD([Hc("#createFollowUpDialog")],gL.prototype,"createFollowUpDialog",void 0),XD([Hc("#createFollowUpChange")],gL.prototype,"createFollowUpChange",void 0),XD([Hc("#confirmDeleteDialog")],gL.prototype,"confirmDeleteDialog",void 0),XD([Hc("#confirmDeleteEditDialog")],gL.prototype,"confirmDeleteEditDialog",void 0),XD([Hc("#confirmPublishEditDialog")],gL.prototype,"confirmPublishEditDialog",void 0),XD([Hc("#moreActions")],gL.prototype,"moreActions",void 0),XD([Hc("#secondaryActions")],gL.prototype,"secondaryActions",void 0),XD([Uc()],gL.prototype,"change",void 0),XD([Uc()],gL.prototype,"actions",void 0),XD([Uc()],gL.prototype,"primaryActionKeys",void 0),XD([Uc()],gL.prototype,"_hideQuickApproveAction",void 0),XD([Uc()],gL.prototype,"account",void 0),XD([Uc()],gL.prototype,"changeNum",void 0),XD([Uc()],gL.prototype,"changeStatus",void 0),XD([Uc()],gL.prototype,"mergeable",void 0),XD([Uc()],gL.prototype,"commitNum",void 0),XD([Uc()],gL.prototype,"latestPatchNum",void 0),XD([Uc()],gL.prototype,"commitMessage",void 0),XD([Uc()],gL.prototype,"revisionActions",void 0),XD([Uc()],gL.prototype,"privateByDefault",void 0),XD([Uc()],gL.prototype,"actionLoadingMessage",void 0),XD([Uc()],gL.prototype,"inProgressActionKeys",void 0),XD([Uc()],gL.prototype,"allActionValues",void 0),XD([Uc()],gL.prototype,"topLevelActions",void 0),XD([Uc()],gL.prototype,"topLevelPrimaryActions",void 0),XD([Uc()],gL.prototype,"topLevelSecondaryActions",void 0),XD([Uc()],gL.prototype,"menuActions",void 0),XD([Uc()],gL.prototype,"overflowActions",void 0),XD([Uc()],gL.prototype,"actionPriorityOverrides",void 0),XD([Uc()],gL.prototype,"additionalActions",void 0),XD([Uc()],gL.prototype,"hiddenActions",void 0),XD([Uc()],gL.prototype,"disabledMenuActions",void 0),XD([Uc()],gL.prototype,"editPatchsetLoaded",void 0),XD([Uc()],gL.prototype,"editMode",void 0),XD([Uc()],gL.prototype,"editBasedOnCurrentPatchSet",void 0),XD([Uc()],gL.prototype,"loggedIn",void 0),XD([Uc()],gL.prototype,"pluginsLoaded",void 0),XD([Uc()],gL.prototype,"threadsWithUnappliedSuggestions",void 0),gL=XD([Dc("gr-change-actions")],gL);const mL=Sd`
  section {
    display: table-row;
  }

  section:not(:first-of-type) .title,
  section:not(:first-of-type) .value {
    padding-top: var(--spacing-s);
  }

  .title,
  .value {
    display: table-cell;
    vertical-align: top;
  }

  .title {
    color: var(--deemphasized-text-color);
    max-width: 20em;
    padding-left: var(--metadata-horizontal-padding);
    padding-right: var(--metadata-horizontal-padding);
    overflow-wrap: anywhere;
  }
`,fL=document.createElement("template");fL.innerHTML=`<dom-module id="gr-change-metadata-shared-styles">\n  <template>\n    <style>\n    ${mL.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(fL.content);const vL=document.createElement("template");vL.innerHTML='<dom-module id="gr-change-view-integration-shared-styles">\n  <template>\n    <style include="shared-styles">\n      /* Workaround for empty style block - see https://github.com/Polymer/tools/issues/408 */\n    </style>\n    <style>\n      :host {\n        border-top: 1px solid var(--border-color);\n        display: block;\n      }\n      .header {\n        color: var(--primary-text-color);\n        background-color: var(--table-header-background-color);\n        justify-content: space-between;\n        padding: var(--spacing-m) var(--spacing-l);\n        border-bottom: 1px solid var(--border-color);\n      }\n      .header .label {\n        font-family: var(--header-font-family);\n        font-size: var(--font-size-h3);\n        font-weight: var(--font-weight-h3);\n        line-height: var(--line-height-h3);\n        margin: 0 var(--spacing-l) 0 0;\n      }\n      .header .note {\n        color: var(--deemphasized-text-color);\n      }\n      .content {\n        background-color: var(--view-background-color);\n      }\n      .header a,\n      .content a {\n        color: var(--link-color);\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild(vL.content);const bL=Sd`:host{--_active-indicator-color: var(--md-filled-text-field-active-indicator-color, var(--md-sys-color-on-surface-variant, #49454f));--_active-indicator-height: var(--md-filled-text-field-active-indicator-height, 1px);--_caret-color: var(--md-filled-text-field-caret-color, var(--md-sys-color-primary, #6750a4));--_container-color: var(--md-filled-text-field-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_disabled-active-indicator-color: var(--md-filled-text-field-disabled-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-active-indicator-height: var(--md-filled-text-field-disabled-active-indicator-height, 1px);--_disabled-active-indicator-opacity: var(--md-filled-text-field-disabled-active-indicator-opacity, 0.38);--_disabled-container-color: var(--md-filled-text-field-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-opacity: var(--md-filled-text-field-disabled-container-opacity, 0.04);--_disabled-input-text-color: var(--md-filled-text-field-disabled-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-input-text-opacity: var(--md-filled-text-field-disabled-input-text-opacity, 0.38);--_disabled-label-text-color: var(--md-filled-text-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-filled-text-field-disabled-label-text-opacity, 0.38);--_disabled-leading-icon-color: var(--md-filled-text-field-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-icon-opacity: var(--md-filled-text-field-disabled-leading-icon-opacity, 0.38);--_disabled-supporting-text-color: var(--md-filled-text-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-filled-text-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-icon-color: var(--md-filled-text-field-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-icon-opacity: var(--md-filled-text-field-disabled-trailing-icon-opacity, 0.38);--_error-active-indicator-color: var(--md-filled-text-field-error-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-focus-active-indicator-color: var(--md-filled-text-field-error-focus-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-focus-caret-color: var(--md-filled-text-field-error-focus-caret-color, var(--md-sys-color-error, #b3261e));--_error-focus-input-text-color: var(--md-filled-text-field-error-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-label-text-color: var(--md-filled-text-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-icon-color: var(--md-filled-text-field-error-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-supporting-text-color: var(--md-filled-text-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-icon-color: var(--md-filled-text-field-error-focus-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_error-hover-active-indicator-color: var(--md-filled-text-field-error-hover-active-indicator-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-input-text-color: var(--md-filled-text-field-error-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-filled-text-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-icon-color: var(--md-filled-text-field-error-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-state-layer-color: var(--md-filled-text-field-error-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-state-layer-opacity: var(--md-filled-text-field-error-hover-state-layer-opacity, 0.08);--_error-hover-supporting-text-color: var(--md-filled-text-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-icon-color: var(--md-filled-text-field-error-hover-trailing-icon-color, var(--md-sys-color-on-error-container, #410e0b));--_error-input-text-color: var(--md-filled-text-field-error-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-label-text-color: var(--md-filled-text-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-icon-color: var(--md-filled-text-field-error-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-supporting-text-color: var(--md-filled-text-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-icon-color: var(--md-filled-text-field-error-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_focus-active-indicator-color: var(--md-filled-text-field-focus-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_focus-active-indicator-height: var(--md-filled-text-field-focus-active-indicator-height, 3px);--_focus-input-text-color: var(--md-filled-text-field-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-filled-text-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-icon-color: var(--md-filled-text-field-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-supporting-text-color: var(--md-filled-text-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-icon-color: var(--md-filled-text-field-focus-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-active-indicator-color: var(--md-filled-text-field-hover-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-active-indicator-height: var(--md-filled-text-field-hover-active-indicator-height, 1px);--_hover-input-text-color: var(--md-filled-text-field-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-filled-text-field-hover-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-leading-icon-color: var(--md-filled-text-field-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-filled-text-field-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-state-layer-opacity: var(--md-filled-text-field-hover-state-layer-opacity, 0.08);--_hover-supporting-text-color: var(--md-filled-text-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-icon-color: var(--md-filled-text-field-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-color: var(--md-filled-text-field-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_input-text-font: var(--md-filled-text-field-input-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_input-text-line-height: var(--md-filled-text-field-input-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_input-text-placeholder-color: var(--md-filled-text-field-input-text-placeholder-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-prefix-color: var(--md-filled-text-field-input-text-prefix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-size: var(--md-filled-text-field-input-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_input-text-suffix-color: var(--md-filled-text-field-input-text-suffix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-weight: var(--md-filled-text-field-input-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_label-text-color: var(--md-filled-text-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-filled-text-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-filled-text-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-populated-line-height: var(--md-filled-text-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-filled-text-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-filled-text-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-filled-text-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-icon-color: var(--md-filled-text-field-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-icon-size: var(--md-filled-text-field-leading-icon-size, 24px);--_supporting-text-color: var(--md-filled-text-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-filled-text-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-line-height: var(--md-filled-text-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-filled-text-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-weight: var(--md-filled-text-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_trailing-icon-color: var(--md-filled-text-field-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-icon-size: var(--md-filled-text-field-trailing-icon-size, 24px);--_container-shape-start-start: var(--md-filled-text-field-container-shape-start-start, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-filled-text-field-container-shape-start-end, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-filled-text-field-container-shape-end-end, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-start: var(--md-filled-text-field-container-shape-end-start, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_icon-input-space: var(--md-filled-text-field-icon-input-space, 16px);--_leading-space: var(--md-filled-text-field-leading-space, 16px);--_trailing-space: var(--md-filled-text-field-trailing-space, 16px);--_top-space: var(--md-filled-text-field-top-space, 16px);--_bottom-space: var(--md-filled-text-field-bottom-space, 16px);--_input-text-prefix-trailing-space: var(--md-filled-text-field-input-text-prefix-trailing-space, 2px);--_input-text-suffix-leading-space: var(--md-filled-text-field-input-text-suffix-leading-space, 2px);--_with-label-top-space: var(--md-filled-text-field-with-label-top-space, 8px);--_with-label-bottom-space: var(--md-filled-text-field-with-label-bottom-space, 8px);--_focus-caret-color: var(--md-filled-text-field-focus-caret-color, var(--md-sys-color-primary, #6750a4));--_with-leading-icon-leading-space: var(--md-filled-text-field-with-leading-icon-leading-space, 12px);--_with-trailing-icon-trailing-space: var(--md-filled-text-field-with-trailing-icon-trailing-space, 12px);--md-filled-field-active-indicator-color: var(--_active-indicator-color);--md-filled-field-active-indicator-height: var(--_active-indicator-height);--md-filled-field-bottom-space: var(--_bottom-space);--md-filled-field-container-color: var(--_container-color);--md-filled-field-container-shape-end-end: var(--_container-shape-end-end);--md-filled-field-container-shape-end-start: var(--_container-shape-end-start);--md-filled-field-container-shape-start-end: var(--_container-shape-start-end);--md-filled-field-container-shape-start-start: var(--_container-shape-start-start);--md-filled-field-content-color: var(--_input-text-color);--md-filled-field-content-font: var(--_input-text-font);--md-filled-field-content-line-height: var(--_input-text-line-height);--md-filled-field-content-size: var(--_input-text-size);--md-filled-field-content-space: var(--_icon-input-space);--md-filled-field-content-weight: var(--_input-text-weight);--md-filled-field-disabled-active-indicator-color: var(--_disabled-active-indicator-color);--md-filled-field-disabled-active-indicator-height: var(--_disabled-active-indicator-height);--md-filled-field-disabled-active-indicator-opacity: var(--_disabled-active-indicator-opacity);--md-filled-field-disabled-container-color: var(--_disabled-container-color);--md-filled-field-disabled-container-opacity: var(--_disabled-container-opacity);--md-filled-field-disabled-content-color: var(--_disabled-input-text-color);--md-filled-field-disabled-content-opacity: var(--_disabled-input-text-opacity);--md-filled-field-disabled-label-text-color: var(--_disabled-label-text-color);--md-filled-field-disabled-label-text-opacity: var(--_disabled-label-text-opacity);--md-filled-field-disabled-leading-content-color: var(--_disabled-leading-icon-color);--md-filled-field-disabled-leading-content-opacity: var(--_disabled-leading-icon-opacity);--md-filled-field-disabled-supporting-text-color: var(--_disabled-supporting-text-color);--md-filled-field-disabled-supporting-text-opacity: var(--_disabled-supporting-text-opacity);--md-filled-field-disabled-trailing-content-color: var(--_disabled-trailing-icon-color);--md-filled-field-disabled-trailing-content-opacity: var(--_disabled-trailing-icon-opacity);--md-filled-field-error-active-indicator-color: var(--_error-active-indicator-color);--md-filled-field-error-content-color: var(--_error-input-text-color);--md-filled-field-error-focus-active-indicator-color: var(--_error-focus-active-indicator-color);--md-filled-field-error-focus-content-color: var(--_error-focus-input-text-color);--md-filled-field-error-focus-label-text-color: var(--_error-focus-label-text-color);--md-filled-field-error-focus-leading-content-color: var(--_error-focus-leading-icon-color);--md-filled-field-error-focus-supporting-text-color: var(--_error-focus-supporting-text-color);--md-filled-field-error-focus-trailing-content-color: var(--_error-focus-trailing-icon-color);--md-filled-field-error-hover-active-indicator-color: var(--_error-hover-active-indicator-color);--md-filled-field-error-hover-content-color: var(--_error-hover-input-text-color);--md-filled-field-error-hover-label-text-color: var(--_error-hover-label-text-color);--md-filled-field-error-hover-leading-content-color: var(--_error-hover-leading-icon-color);--md-filled-field-error-hover-state-layer-color: var(--_error-hover-state-layer-color);--md-filled-field-error-hover-state-layer-opacity: var(--_error-hover-state-layer-opacity);--md-filled-field-error-hover-supporting-text-color: var(--_error-hover-supporting-text-color);--md-filled-field-error-hover-trailing-content-color: var(--_error-hover-trailing-icon-color);--md-filled-field-error-label-text-color: var(--_error-label-text-color);--md-filled-field-error-leading-content-color: var(--_error-leading-icon-color);--md-filled-field-error-supporting-text-color: var(--_error-supporting-text-color);--md-filled-field-error-trailing-content-color: var(--_error-trailing-icon-color);--md-filled-field-focus-active-indicator-color: var(--_focus-active-indicator-color);--md-filled-field-focus-active-indicator-height: var(--_focus-active-indicator-height);--md-filled-field-focus-content-color: var(--_focus-input-text-color);--md-filled-field-focus-label-text-color: var(--_focus-label-text-color);--md-filled-field-focus-leading-content-color: var(--_focus-leading-icon-color);--md-filled-field-focus-supporting-text-color: var(--_focus-supporting-text-color);--md-filled-field-focus-trailing-content-color: var(--_focus-trailing-icon-color);--md-filled-field-hover-active-indicator-color: var(--_hover-active-indicator-color);--md-filled-field-hover-active-indicator-height: var(--_hover-active-indicator-height);--md-filled-field-hover-content-color: var(--_hover-input-text-color);--md-filled-field-hover-label-text-color: var(--_hover-label-text-color);--md-filled-field-hover-leading-content-color: var(--_hover-leading-icon-color);--md-filled-field-hover-state-layer-color: var(--_hover-state-layer-color);--md-filled-field-hover-state-layer-opacity: var(--_hover-state-layer-opacity);--md-filled-field-hover-supporting-text-color: var(--_hover-supporting-text-color);--md-filled-field-hover-trailing-content-color: var(--_hover-trailing-icon-color);--md-filled-field-label-text-color: var(--_label-text-color);--md-filled-field-label-text-font: var(--_label-text-font);--md-filled-field-label-text-line-height: var(--_label-text-line-height);--md-filled-field-label-text-populated-line-height: var(--_label-text-populated-line-height);--md-filled-field-label-text-populated-size: var(--_label-text-populated-size);--md-filled-field-label-text-size: var(--_label-text-size);--md-filled-field-label-text-weight: var(--_label-text-weight);--md-filled-field-leading-content-color: var(--_leading-icon-color);--md-filled-field-leading-space: var(--_leading-space);--md-filled-field-supporting-text-color: var(--_supporting-text-color);--md-filled-field-supporting-text-font: var(--_supporting-text-font);--md-filled-field-supporting-text-line-height: var(--_supporting-text-line-height);--md-filled-field-supporting-text-size: var(--_supporting-text-size);--md-filled-field-supporting-text-weight: var(--_supporting-text-weight);--md-filled-field-top-space: var(--_top-space);--md-filled-field-trailing-content-color: var(--_trailing-icon-color);--md-filled-field-trailing-space: var(--_trailing-space);--md-filled-field-with-label-bottom-space: var(--_with-label-bottom-space);--md-filled-field-with-label-top-space: var(--_with-label-top-space);--md-filled-field-with-leading-content-leading-space: var(--_with-leading-icon-leading-space);--md-filled-field-with-trailing-content-trailing-space: var(--_with-trailing-icon-trailing-space)}
`;class yL extends qy{constructor(){super(...arguments),this.fieldTag=Db`md-filled-field`}}let wL=class extends yL{constructor(){super(...arguments),this.fieldTag=Db`md-filled-field`}};wL.styles=[Yy,bL],wL=zg([Dc("md-filled-text-field")],wL);var _L=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let xL=class extends Ic{static get styles(){return[Nc,Sd`
        :host {
          align-items: center;
          display: inline-flex;
        }
        input,
        label {
          width: 100%;
        }
        label {
          color: var(--deemphasized-text-color);
          display: inline-block;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }
        label.editable {
          color: var(--link-color);
          cursor: pointer;
        }
        #dropdown {
          box-shadow: var(--elevation-level-2);
          --md-menu-container-color: var(--dialog-background-color);
          --md-menu-top-space: 0px;
          --md-menu-bottom-space: 0px;
        }
        .inputContainer {
          background-color: var(--dialog-background-color);
          padding: var(--spacing-m);
          white-space: nowrap;
        }
        /* This makes inputContainer on one line. */
        .inputContainer gr-autocomplete,
        .inputContainer .buttons {
          display: inline-block;
        }
        .buttons gr-button {
          margin-left: var(--spacing-m);
        }
        md-filled-text-field {
          min-width: 15em;
          --md-filled-text-field-container-color: rgba(0, 0, 0, 0);
          --md-filled-text-field-focus-active-indicator-color: var(
            --link-color
          );
          --md-filled-text-field-hover-state-layer-color: rgba(0, 0, 0, 0);
          --md-filled-field-top-space: var(--spacing-m);
          --md-filled-field-bottom-space: var(--spacing-m);
          --md-filled-field-leading-space: 8px;
          --md-filled-field-active-indicator-color: var(--link-color);
          --md-filled-field-hover-active-indicator-color: var(--link-color);
          --md-sys-color-primary: var(--primary-text-color);
          --md-sys-color-on-surface: var(--primary-text-color);
          --md-sys-color-on-surface-variant: var(--deemphasized-text-color);
          --md-filled-text-field-label-text-color: var(
            --deemphasized-text-color
          );
          --md-filled-text-field-focus-label-text-color: var(
            --deemphasized-text-color
          );
          --md-filled-text-field-hover-label-text-color: var(
            --deemphasized-text-color
          );
        }
        gr-button gr-icon {
          color: inherit;
        }
        gr-button.pencil {
          --gr-button-padding: var(--spacing-s);
          --margin: calc(0px - var(--spacing-s));
        }
        .dropdown-content {
          width: max-content;
        }
      `]}render(){return this.setAttribute("title",this.computeLabel()),dc`<div style="position: relative;">
      ${this.renderActivateButton()}
      <md-menu
        id="dropdown"
        anchor="button"
        tabindex="-1"
        .quick=${!0}
        @closing=${()=>{this.cancel()}}
      >
        <div class="dropdown-content">
          <div class="inputContainer" part="input-container">
            ${this.renderInputBox()}
            <div class="buttons">
              <gr-button primary id="saveBtn" @click=${this.save}
                >${this.confirmLabel}</gr-button
              >
              <gr-button id="cancelBtn" @click=${this.cancel}>Cancel</gr-button>
            </div>
          </div>
        </div>
      </md-menu>
    </div>`}renderActivateButton(){return this.showAsEditPencil?dc`<gr-button
        id="button"
        link=""
        class="pencil ${this.computeLabelClass()}"
        @click=${this.showDropdown}
        title=${this.computeLabel()}
      >
        <div>
          <gr-icon icon="edit" filled small></gr-icon>
        </div>
      </gr-button>`:dc`<label
        id="button"
        class=${this.computeLabelClass()}
        title=${this.computeLabel()}
        aria-label=${this.computeLabel()}
        @click=${this.showDropdown}
        part="label"
        >${this.computeLabel()}</label
      >`}renderInputBox(){return this.autocomplete?dc`<gr-autocomplete
        .label=${this.labelText}
        .placeholder=${this.placeholder}
        id="autocomplete"
        .text=${this.inputText}
        .query=${this.query}
        @cancel=${this.cancel}
        @text-changed=${e=>{this.inputText=e.detail.value}}
      >
      </gr-autocomplete>`:dc`
        <md-filled-text-field
          id="input"
          .label=${this.labelText}
          .placeholder=${this.placeholder}
          .maxlength=${this.maxLength}
          .value=${this.inputText}
          aria-label=${this.labelText||this.placeholder||uc}
        >
        </md-filled-text-field>
      `}constructor(){super(),this.labelText="",this.editing=!1,this.placeholder="",this.readOnly=!1,this.confirmLabel="Save",this.inputText="",this.showAsEditPencil=!1,this.autocomplete=!1,this.query=()=>Promise.resolve([]),this.shortcuts=new Gg(this),this.shortcuts.addLocal({key:Mn.ENTER},(e=>this.handleEnter(e))),this.shortcuts.addLocal({key:Mn.ESC},(e=>this.handleEsc(e)))}disconnectedCallback(){super.disconnectedCallback()}connectedCallback(){super.connectedCallback(),this.getAttribute("tabindex")||this.setAttribute("tabindex","0"),this.getAttribute("id")||this.setAttribute("id","global")}usePlaceholder(e,t){return(!e||!e.length)&&t}computeLabel(){const{value:e,placeholder:t}=this;return this.usePlaceholder(e,t)?t:e||""}showDropdown(){if(!this.readOnly&&!this.editing)return this.openDropdown().then((()=>{this.nativeInput.focus(),this.input?.value&&this.nativeInput.setSelectionRange(0,this.input.value.length)}))}open(){return this.openDropdown().then((()=>{this.nativeInput.focus()}))}openDropdown(){return this.dropdown?.show(),this.inputText=this.value||"",this.editing=!0,new Promise((e=>{this.awaitOpen(e)}))}awaitOpen(e){let t=0;const i=()=>{setTimeout((()=>{"none"!==this.dropdown?.style.display?e.call(this):t++<10&&i.call(this)}),5)};i.call(this)}save(){this.editing&&(this.dropdown?.close(),this.input?this.value=this.input.value??void 0:this.value=this.inputText||"",this.editing=!1,Jn(this,"changed",this.value))}cancel(){this.editing&&(this.dropdown?.close(),this.editing=!1,this.inputText=this.value||"")}get nativeInput(){return this.autocomplete?this.grAutocomplete.nativeInput:this.input.shadowRoot.querySelector("input")}handleEnter(e){const t=_a(this,".inputContainer");e.composedPath().some((e=>e===t))&&this.save()}handleEsc(e){if(this.autocomplete)return;const t=_a(this,".inputContainer");e.composedPath().some((e=>e===t))&&this.cancel()}computeLabelClass(){const{readOnly:e,value:t,placeholder:i}=this,r=[];return e||r.push("editable"),this.usePlaceholder(t,i)&&r.push("placeholder"),r.join(" ")}};_L([Hc("#dropdown")],xL.prototype,"dropdown",void 0),_L([Fc()],xL.prototype,"labelText",void 0),_L([Fc({type:Boolean})],xL.prototype,"editing",void 0),_L([Fc()],xL.prototype,"value",void 0),_L([Fc()],xL.prototype,"placeholder",void 0),_L([Fc({type:Boolean})],xL.prototype,"readOnly",void 0),_L([Fc({type:Number})],xL.prototype,"maxLength",void 0),_L([Fc({type:String})],xL.prototype,"confirmLabel",void 0),_L([Uc()],xL.prototype,"inputText",void 0),_L([Fc({type:Boolean})],xL.prototype,"showAsEditPencil",void 0),_L([Fc({type:Boolean})],xL.prototype,"autocomplete",void 0),_L([Fc({type:Object})],xL.prototype,"query",void 0),_L([Hc("#input")],xL.prototype,"input",void 0),_L([Hc("#autocomplete")],xL.prototype,"grAutocomplete",void 0),xL=_L([Dc("gr-editable-label")],xL);var CL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let EL=class extends Ic{constructor(){super(...arguments),this.href="",this.disabled=!1,this.removable=!1,this.text=""}static get styles(){return[Nc,Sd`
        :host {
          display: block;
          overflow: hidden;
        }
        .container {
          align-items: center;
          background: var(--chip-background-color);
          border-radius: 0.75em;
          display: inline-flex;
          padding: 0 var(--spacing-m);
        }
        :host([disabled]) {
          opacity: 0.6;
          pointer-events: none;
        }
        a {
          color: var(--linked-chip-text-color);
        }
        gr-icon {
          font-size: 1.2rem;
        }
        gr-button::part(md-text-button),
        gr-button.remove:hover::part(md-text-button),
        gr-button.remove:focus::part(md-text-button) {
          border-top-width: 0;
          border-right-width: 0;
          border-bottom-width: 0;
          border-left-width: 0;
          color: var(--deemphasized-text-color);
          font-weight: var(--font-weight-normal);
          height: 0.6em;
          line-height: 10px;
          margin-left: var(--spacing-xs);
          padding: 0;
          text-decoration: none;
        }
      `]}render(){return dc`<div class="container">
      <a href=${this.href}>
        <gr-limited-text
          .limit=${this.limit??25}
          .text=${this.text}
        ></gr-limited-text>
      </a>
      <gr-button
        id="remove"
        link=""
        ?hidden=${!this.removable}
        class="remove"
        @click=${this.handleRemoveTap}
      >
        <gr-icon icon="close"></gr-icon>
      </gr-button>
    </div>`}handleRemoveTap(e){e.preventDefault(),Jn(this,"remove",{})}};CL([Fc({type:String})],EL.prototype,"href",void 0),CL([Fc({type:Boolean,reflect:!0})],EL.prototype,"disabled",void 0),CL([Fc({type:Boolean})],EL.prototype,"removable",void 0),CL([Fc({type:String})],EL.prototype,"text",void 0),CL([Fc({type:Number})],EL.prototype,"limit",void 0),EL=CL([Dc("gr-linked-chip")],EL);var SL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let $L=class extends Ic{static get styles(){return[Nc,Sd`
        .container {
          align-items: center;
          display: flex;
        }
        gr-weblink {
          margin-right: 0;
        }
        gr-copy-clipboard {
          margin-left: var(--spacing-s);
        }
      `]}constructor(){super(),this.showCopyButton=!0,this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.serverConfig=e))}render(){const e=this.commitInfo?.commit;return e?dc` <div class="container">
      <gr-weblink imageAndText .info=${this.getWeblink(e)}></gr-weblink>
      ${eb(this.showCopyButton,(()=>dc`
          <gr-copy-clipboard
            hastooltip
            .buttonTitle=${"Copy full SHA to clipboard"}
            hideinput
            .text=${e}
          >
          </gr-copy-clipboard>
        `))}
    </div>`:uc}getWeblink(e){if(!e)return;const t=Ux(e),i=nS(this.commitInfo?.web_links,this.serverConfig);return i?{...i,name:t}:{name:t,url:tE({query:e})}}};SL([Fc({type:Object})],$L.prototype,"commitInfo",void 0),SL([Fc({type:Boolean})],$L.prototype,"showCopyButton",void 0),SL([Uc()],$L.prototype,"serverConfig",void 0),$L=SL([Dc("gr-commit-info")],$L);var kL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let AL=class extends Ic{static get styles(){return[Nc,Sd`
        :host {
          display: block;
        }
        :host([disabled]) {
          opacity: 0.8;
          pointer-events: none;
        }
        .container {
          display: block;
          /* line-height-normal for the chips, 2px for the chip border, spacing-s
            for the gap between lines, negative bottom margin for eliminating the
            gap after the last line */
          line-height: calc(var(--line-height-normal) + 2px + var(--spacing-s));
          margin-bottom: calc(0px - var(--spacing-s));
        }
        .addReviewer gr-icon {
          color: inherit;
        }
        .controlsContainer {
          display: inline-block;
        }
        gr-button.addReviewer {
          vertical-align: top;
          --gr-button-padding: var(--spacing-s);
          --margin: calc(0px - var(--spacing-s));
        }
        gr-button {
          line-height: var(--line-height-normal);
          --gr-button-padding: 0px;
        }
        gr-account-chip {
          line-height: var(--line-height-normal);
          vertical-align: top;
          display: inline-block;
        }
        gr-vote-chip {
          --gr-vote-chip-width: 14px;
          --gr-vote-chip-height: 14px;
        }
        .reviewersAndControls {
          text-wrap: pretty;
        }
      `]}constructor(){super(),this.disabled=!1,this.mutable=!1,this.reviewersOnly=!1,this.ccsOnly=!1,this.reviewers=[],this.showAllReviewers=!1,this.getChangeModel=yu(this,MT),this.getUserModel=yu(this,jf),zf(this,(()=>this.getChangeModel().change$),(e=>{this.change=e})),zf(this,(()=>this.getUserModel().account$),(e=>{this.account=e}))}render(){const e=this.computeDisplayedReviewers()??[],t=this.computeHiddenReviewerCount(e);return dc`
      <div class="container">
        <div class="reviewersAndControls">
          ${Mw(e,(e=>lx(e)),(e=>this.renderAccountChip(e)))}
          <div class="controlsContainer" ?hidden=${!this.mutable}>
            <gr-button
              link
              id="addReviewer"
              class="addReviewer"
              @click=${this.handleAddTap}
              title=${this.ccsOnly?"Add CC":"Add Reviewer"}
            >
              <div>
                <gr-icon icon="edit" filled small></gr-icon>
              </div>
            </gr-button>
          </div>
        </div>
        <gr-button
          class="hiddenReviewers"
          link=""
          ?hidden=${!t}
          @click=${()=>{this.showAllReviewers=!0}}
          >and ${t} more</gr-button
        >
      </div>
    `}renderAccountChip(e){const t=this.change;return t?dc`
      <gr-account-chip
        class="reviewer"
        .account=${e}
        .change=${t}
        highlightAttention
        .vote=${this.computeVote(e)}
        .label=${this.computeCodeReviewLabel()}
      >
        <gr-vote-chip
          slot="vote-chip"
          .vote=${this.computeVote(e)}
          .label=${this.computeCodeReviewLabel()}
          circle-shape
        ></gr-vote-chip>
      </gr-account-chip>
    `:uc}computeVote(e){const t=this.computeCodeReviewLabel();if(t&&Xu(t))return pv(t,e)}computeCodeReviewLabel(){if(this.change?.labels)return bv(this.change.labels)}computeDisplayedReviewers(){if(void 0===this.change?.owner)return;let e=[];const t=this.change.reviewers;for(const i of Object.keys(t))this.reviewersOnly&&"REVIEWER"!==i||this.ccsOnly&&"CC"!==i||"REVIEWER"!==i&&"CC"!==i||(e=e.concat(t[i]));if(this.reviewers=e.filter((e=>e._account_id!==this.change?.owner._account_id)).sort(((e,t)=>AC(e,t,this.change?.attention_set,this.change?.labels,this.account))),this.reviewers.length>8&&!this.showAllReviewers){const e=this.reviewers.filter((e=>CC(e,this.change?.attention_set)||0!==RC(e,this.change?.labels)));return this.reviewers.slice(0,Math.max(6,e.length))}return this.reviewers}computeHiddenReviewerCount(e){return this.reviewers.length-e.length}handleAddTap(e){e.preventDefault(),Jn(this,"show-reply-dialog",{value:{reviewersOnly:this.reviewersOnly,ccsOnly:this.ccsOnly}})}};kL([Fc({type:Boolean,reflect:!0})],AL.prototype,"disabled",void 0),kL([Fc({type:Boolean})],AL.prototype,"mutable",void 0),kL([Fc({type:Boolean,attribute:"reviewers-only"})],AL.prototype,"reviewersOnly",void 0),kL([Fc({type:Boolean,attribute:"ccs-only"})],AL.prototype,"ccsOnly",void 0),kL([Uc()],AL.prototype,"reviewers",void 0),kL([Uc()],AL.prototype,"showAllReviewers",void 0),kL([Uc()],AL.prototype,"change",void 0),kL([Uc()],AL.prototype,"account",void 0),AL=kL([Dc("gr-reviewer-list")],AL);var RL,TL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e.OWNER="owner",e.UPLOADER="uploader",e.AUTHOR="author",e.COMMITTER="committer"}(RL||(RL={}));const IL=new Map([[qu.FAST_FORWARD_ONLY,"Fast Forward Only"],[qu.MERGE_IF_NECESSARY,"Merge if Necessary"],[qu.REBASE_IF_NECESSARY,"Rebase if Necessary"],[qu.MERGE_ALWAYS,"Always Merge"],[qu.REBASE_ALWAYS,"Rebase Always"],[qu.CHERRY_PICK,"Cherry Pick"]]);let PL=class extends Ic{constructor(){super(),this.editMode=!1,this.mutable=!1,this.notCurrentMessage="Not current - rebase possible",this.topicReadOnly=!0,this.hashtagReadOnly=!0,this.settingTopic=!1,this.currentParents=[],this.showAllSections=!1,this.restApiService=Xn().restApiService,this.reporting=Xn().reportingService,this.getUserModel=yu(this,jf),this.getConfigModel=yu(this,Qw),this.getChangeModel=yu(this,MT),this.getRelatedChangesModel=yu(this,sD),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.serverConfig=e)),zf(this,(()=>this.getConfigModel().repoConfig$),(e=>this.repoConfig=e)),zf(this,(()=>this.getUserModel().account$),(e=>this.account=e)),zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getChangeModel().revision$),(e=>this.revision=e)),zf(this,(()=>this.getRelatedChangesModel().revertingChange$),(e=>this.revertedChange=e)),zf(this,(()=>this.getChangeModel().editMode$),(e=>this.editMode=e)),this.queryTopic=e=>this.getTopicSuggestions(e),this.queryHashtag=e=>this.getHashtagSuggestions(e),this.queryIdentity=e=>this.getIdentitySuggestions(e)}static get styles(){return[Nc,Qb,mL,Sd`
        :host {
          display: table;
        }
        gr-submit-requirements {
          --requirements-horizontal-padding: var(--metadata-horizontal-padding);
        }
        gr-editable-label {
          max-width: 9em;
        }
        gr-weblink {
          display: block;
        }
        gr-account-chip {
          display: inline;
        }
        gr-account-chip[disabled],
        gr-linked-chip[disabled] {
          opacity: 0;
          pointer-events: none;
        }
        .hashtagChip {
          padding-bottom: var(--spacing-s);
        }
        /* consistent with section .title, .value */
        .hashtagChip:not(last-of-type) {
          padding-bottom: var(--spacing-s);
        }
        .hashtagChip:last-of-type {
          display: inline;
          vertical-align: top;
        }
        .parentList.merge {
          list-style-type: decimal;
          padding-left: var(--spacing-l);
        }
        .parentList gr-commit-info {
          display: inline-block;
        }
        .hideDisplay,
        #parentNotCurrentMessage {
          display: none;
        }
        .icon {
          margin: -3px 0;
        }
        .icon.help,
        .icon.notTrusted {
          color: var(--warning-foreground);
        }
        .icon.invalid {
          color: var(--negative-red-text-color);
        }
        .icon.trusted {
          color: var(--positive-green-text-color);
        }
        .parentList.notCurrent.nonMerge #parentNotCurrentMessage {
          --arrow-color: var(--warning-foreground);
          display: inline-block;
        }
        .oldSeparatedSection {
          margin-top: var(--spacing-l);
          padding: var(--spacing-m) 0;
        }
        .separatedSection {
          padding: var(--spacing-m) 0;
        }
        .hashtag gr-linked-chip,
        .topic gr-linked-chip {
          --linked-chip-text-color: var(--link-color);
        }
        gr-reviewer-list {
          --account-max-length: 100px;
          max-width: 285px;
        }
        .metadata-title {
          color: var(--deemphasized-text-color);
          padding-left: var(--metadata-horizontal-padding);
        }
        .metadata-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-end;
          /* The goal is to achieve alignment of the owner account chip and the
         commit message box. Their top border should be on the same line. */
          margin-bottom: var(--spacing-s);
        }
        .show-all-button gr-icon {
          color: inherit;
          font-size: 18px;
        }
        gr-vote-chip {
          --gr-vote-chip-width: 14px;
          --gr-vote-chip-height: 14px;
        }
      `]}render(){return this.change?dc`<div>
      <div class="metadata-header">
        <h3 class="metadata-title heading-3">Change Info</h3>
        ${this.renderShowAllButton()}
      </div>
      ${this.renderSubmitted()} ${this.renderUpdated()} ${this.renderOwner()}
      ${this.renderNonOwner(RL.UPLOADER)}
      ${this.renderNonOwner(RL.AUTHOR)}
      ${this.renderNonOwner(RL.COMMITTER)} ${this.renderReviewers()}
      ${this.renderCCs()} ${this.renderProjectBranch()} ${this.renderParent()}
      ${this.renderMergedAs()} ${this.renderShowRevertCreatedAs()}
      ${this.renderTopic()} ${this.renderCherryPickOf()}
      ${this.renderRevertOf()} ${this.renderStrategy()} ${this.renderHashTags()}
      <gr-endpoint-decorator name="change-metadata-item">
        <gr-endpoint-param
          name="labels"
          .value=${{...this.change?.labels}}
        ></gr-endpoint-param>
        <gr-endpoint-param
          name="change"
          .value=${this.change}
        ></gr-endpoint-param>
        <gr-endpoint-param
          name="revision"
          .value=${this.revision}
        ></gr-endpoint-param>
        <gr-endpoint-slot name="above-submit-requirements"></gr-endpoint-slot>
        ${this.renderSubmitRequirements()} ${this.renderWeblinks()}
      </gr-endpoint-decorator>
    </div>`:uc}renderShowAllButton(){return dc`<gr-button
      link
      class="show-all-button"
      @click=${this.onShowAllClick}
      >${this.showAllSections?"Show Less":"Show All"}
      <gr-icon icon="expand_more" ?hidden=${this.showAllSections}></gr-icon>
      <gr-icon icon="expand_less" ?hidden=${!this.showAllSections}></gr-icon>
    </gr-button>`}renderSubmitted(){return this.change.submitted?dc`<section class=${this.computeDisplayState(HN.SUBMITTED)}>
      <span class="title">Submitted</span>
      <span class="value">
        <gr-date-formatter
          withTooltip
          .dateStr=${this.change.submitted}
          showYesterday
        ></gr-date-formatter>
      </span>
    </section> `:uc}renderUpdated(){return dc`<section class=${this.computeDisplayState(HN.UPDATED)}>
      <span class="title">
        <gr-tooltip-content
          has-tooltip
          title="Last update of (meta)data for this change."
        >
          Updated
        </gr-tooltip-content>
      </span>
      <span class="value">
        <gr-date-formatter
          withTooltip
          .dateStr=${this.change.updated}
          showYesterday
        ></gr-date-formatter>
      </span>
    </section>`}renderOwner(){const e=this.change;return dc`<section class=${this.computeDisplayState(HN.OWNER)}>
      <span class="title">
        <gr-tooltip-content
          has-tooltip
          title="This user created or uploaded the first patchset of this change."
        >
          Owner
        </gr-tooltip-content>
      </span>
      <span class="value">
        <gr-account-chip
          .account=${e.owner}
          .change=${e}
          highlightAttention
          .vote=${this.computeVote(e.owner)}
          .label=${this.computeCodeReviewLabel()}
        >
          <gr-vote-chip
            slot="vote-chip"
            .vote=${this.computeVote(e.owner)}
            .label=${this.computeCodeReviewLabel()}
            circle-shape
          ></gr-vote-chip>
        </gr-account-chip>
        ${eb(this.pushCertificateValidation,(()=>dc`<gr-tooltip-content
            has-tooltip
            title=${this.pushCertificateValidation.message}
          >
            <gr-icon
              icon=${this.pushCertificateValidation.icon}
              class="icon ${this.pushCertificateValidation.class}"
            ></gr-icon>
          </gr-tooltip-content>`))}
      </span>
    </section>`}renderNonOwner(e){if(!this.getNonOwnerRole(e))return uc;let t="",i="";return e===RL.UPLOADER?(t="This user uploaded the patchset to Gerrit (typically by running the 'git push' command).",i="Uploader"):e===RL.AUTHOR?(t="This user wrote the code change.",i="Author"):e===RL.COMMITTER&&(t="This user committed the code change to the Git repository (typically to the local Git repo before uploading).",i="Committer"),dc`<section>
      <span class="title">
        <gr-tooltip-content has-tooltip .title=${t}>
          ${i}
        </gr-tooltip-content>
      </span>
      <span class="value">
        <gr-account-chip
          .account=${this.getNonOwnerRole(e)}
          .change=${this.change}
          ?highlightAttention=${e===RL.UPLOADER}
          .vote=${this.computeVoteForRole(e)}
          .label=${this.computeCodeReviewLabel()}
        >
          <gr-vote-chip
            slot="vote-chip"
            .vote=${this.computeVoteForRole(e)}
            .label=${this.computeCodeReviewLabel()}
            circle-shape
          ></gr-vote-chip>
        </gr-account-chip>
        ${eb(this.editMode&&(e===RL.AUTHOR||e===RL.COMMITTER),(()=>dc`
            <gr-editable-label
              id="${e}-edit-label"
              placeholder="Update ${i}"
              @changed=${t=>this.handleIdentityChanged(t,e)}
              showAsEditPencil
              autocomplete
              .query=${this.queryIdentity}
            ></gr-editable-label>
          `))}
      </span>
    </section>`}renderReviewers(){return dc`<section class=${this.computeDisplayState(HN.REVIEWERS)}>
      <span class="title">Reviewers</span>
      <span class="value">
        <gr-reviewer-list
          ?mutable=${this.mutable}
          reviewers-only
        ></gr-reviewer-list>
      </span>
    </section>`}renderCCs(){return dc`<section class=${this.computeDisplayState(HN.CC)}>
      <span class="title">CC</span>
      <span class="value">
        <gr-reviewer-list ?mutable=${this.mutable} ccs-only></gr-reviewer-list>
      </span>
    </section>`}renderProjectBranch(){const e=this.change;return eb(this.computeShowRepoBranchTogether(),(()=>dc`<section class=${this.computeDisplayState(HN.REPO_BRANCH)}>
          <span class="title">
            <gr-tooltip-content
              has-tooltip
              title="Repository and branch that the change will be merged into if submitted."
            >
              Repo | Branch
            </gr-tooltip-content>
          </span>
          <span class="value">
            <a href=${this.computeProjectUrl(e.project)}
              >${e.project}</a
            >
            |
            <a href=${this.computeBranchUrl(e.project,e.branch)}
              >${e.branch}</a
            >
          </span>
        </section>`),(()=>dc`<section
          class=${this.computeDisplayState(HN.REPO_BRANCH)}
        >
          <span class="title">
            <gr-tooltip-content
              has-tooltip
              title="Repository that the change will be merged into if submitted."
            >
              Repo
            </gr-tooltip-content>
          </span>
          <span class="value">
            <a
              href=${this.computeProjectUrl(e.project)}
              .title=${e.project}
            >
              ${Tg(e.project,3)}
            </a>
          </span>
        </section>
        <section class=${this.computeDisplayState(HN.REPO_BRANCH)}>
          <span class="title">
            <gr-tooltip-content
              has-tooltip
              title="Branch that the change will be merged into if submitted."
            >
              Branch
            </gr-tooltip-content>
          </span>
          <span class="value">
            <a href=${this.computeBranchUrl(e.project,e.branch)}>
              <gr-limited-text
                limit="40"
                .text=${e.branch}
              ></gr-limited-text>
            </a>
          </span>
        </section>`))}renderParent(){return dc`<section class=${this.computeDisplayState(HN.PARENT)}>
      <span class="title"
        >${this.currentParents.length>1?"Parents":"Parent"}</span
      >
      <span class="value">
        <ol class=${this.computeParentListClass()}>
          ${this.currentParents.map((e=>dc` <li>
              <gr-commit-info .commitInfo=${e}></gr-commit-info>
              <gr-tooltip-content
                id="parentNotCurrentMessage"
                has-tooltip
                show-icon
                .title=${this.notCurrentMessage}
              ></gr-tooltip-content>
            </li>`))}
        </ol>
      </span>
    </section>`}renderMergedAs(){return this.change?.status===Nu.MERGED?dc`<section class=${this.computeDisplayState(HN.MERGED_AS)}>
      <span class="title">Merged As</span>
      <span class="value">
        <gr-commit-info
          .commitInfo=${this.computeMergedCommitInfo(this.change?.current_revision,this.change?.revisions)}
        ></gr-commit-info>
      </span>
    </section>`:uc}renderShowRevertCreatedAs(){return this.showRevertCreatedAs()?dc`<section
      class=${this.computeDisplayState(HN.REVERT_CREATED_AS)}
    >
      <span class="title">${this.getRevertSectionTitle()}</span>
      <span class="value">
        <gr-commit-info
          .commitInfo=${this.computeRevertCommit()}
        ></gr-commit-info>
      </span>
    </section>`:uc}renderTopic(){return this.change?.topic||!this.topicReadOnly?dc`<section
      class="topic ${this.computeDisplayState(HN.TOPIC,this.account)}"
    >
      <span class="title">Topic</span>
      <span class="value">
        ${eb(this.showTopicChip(),(()=>dc` <gr-linked-chip
            .text=${this.change?.topic??""}
            limit="40"
            href=${tE({topic:this.change.topic})}
            ?removable=${!this.topicReadOnly}
            @remove=${this.handleTopicRemoved}
          ></gr-linked-chip>`))}
        ${eb(this.showAddTopic(),(()=>dc` <gr-editable-label
              class="topicEditableLabel"
              .confirmLabel=${"Set Topic"}
              .value=${this.change?.topic}
              maxLength="1024"
              .placeholder=${this.computeTopicPlaceholder()}
              ?readOnly=${this.topicReadOnly}
              @changed=${this.handleTopicChanged}
              showAsEditPencil
              autocomplete
              .query=${this.queryTopic}
            ></gr-editable-label>`))}
      </span>
    </section>`:uc}renderCherryPickOf(){return this.showCherryPickOf()?dc` <section
      class=${this.computeDisplayState(HN.CHERRY_PICK_OF)}
    >
      <span class="title">Cherry pick of</span>
      <span class="value">
        <a
          href=${this.computeCherryPickOfUrl(this.change?.cherry_pick_of_change,this.change?.cherry_pick_of_patch_set,this.change?.project)}
        >
          <gr-limited-text
            text="${this.change?.cherry_pick_of_change},${this.change?.cherry_pick_of_patch_set}"
            limit="40"
          >
          </gr-limited-text>
        </a>
      </span>
    </section>`:uc}renderRevertOf(){return this.change?.revert_of?dc` <section class=${this.computeDisplayState(HN.REVERT_OF)}>
      <span class="title">Revert of</span>
      <span class="value">
        <a
          href=${WC({changeNum:this.change.revert_of,repo:this.change.project,usp:"metadata"})}
          >${this.change.revert_of}</a
        >
      </span>
    </section>`:uc}renderStrategy(){return PC(this.change)?dc`<section
      class="strategy ${this.computeDisplayState(HN.STRATEGY)}"
    >
      <span class="title">Strategy</span>
      <span class="value">${this.computeStrategy()}</span>
    </section>`:uc}renderHashTags(){return dc`<section
      class="hashtag ${this.computeDisplayState(HN.HASHTAGS)}"
    >
      <span class="title">Hashtags</span>
      <span class="value">
        ${(this.change?.hashtags??[]).map((e=>dc`<gr-linked-chip
            class="hashtagChip"
            .text=${e}
            href=${this.computeHashtagUrl(e)}
            ?removable=${!this.hashtagReadOnly}
            @remove=${this.handleHashtagRemoved}
            limit="40"
          >
          </gr-linked-chip>`))}
        ${eb(!this.hashtagReadOnly,(()=>dc`
            <gr-editable-label
              .placeholder=${this.computeHashtagPlaceholder()}
              .readOnly=${this.hashtagReadOnly}
              @changed=${this.handleHashtagChanged}
              showAsEditPencil
              autocomplete
              .query=${this.queryHashtag}
            ></gr-editable-label>
          `))}
      </span>
    </section>`}renderSubmitRequirements(){return dc`<div class="separatedSection">
      <gr-submit-requirements
        .change=${this.change}
        .account=${this.account}
        .mutable=${this.mutable}
      ></gr-submit-requirements>
    </div>`}renderWeblinks(){const e=this.computeWebLinks();return e.length?dc`<section id="webLinks">
      <span class="title">Links</span>
      <span class="value">
        ${e.map((e=>dc`<gr-weblink .info=${e}></gr-weblink>`))}
      </span>
    </section>`:uc}willUpdate(e){e.has("account")&&(this.mutable=this.computeIsMutable()),(e.has("mutable")||e.has("change"))&&(this.topicReadOnly=this.computeTopicReadOnly(),this.hashtagReadOnly=this.computeHashtagReadOnly()),e.has("change")&&(this.settingTopic=!1),(e.has("serverConfig")||e.has("change")||e.has("repoConfig"))&&(this.pushCertificateValidation=this.computePushCertificateValidation()),(e.has("revision")||e.has("change"))&&(this.currentParents=this.computeParents())}computeWebLinks(){return function(e,t){if(!e?.length)return[];const i=nS(e,t);return e.filter((e=>!i?.name||e.name!==i.name))}(this.revision?.commit?.web_links,this.serverConfig)}computeStrategy(){return this.change?.submit_type?IL.get(this.change.submit_type):""}computeLabelNames(e){return e?Object.keys(e).sort():[]}async handleTopicChanged(e){ba(this.change,"change");const t=e.detail.length?e.detail:void 0;this.settingTopic=!0;try{ea(this,"Saving topic and reloading ..."),await this.restApiService.setChangeTopic(this.change._number,t)}finally{this.settingTopic=!1}Jn(this,"hide-alert",{}),aa(this)}showAddTopic(){return!this.change?.topic&&!this.settingTopic&&!1===this.topicReadOnly}showTopicChip(){return!!this.change?.topic&&!this.settingTopic}showCherryPickOf(){return!!this.change?.cherry_pick_of_change&&!!this.change?.cherry_pick_of_patch_set}async handleHashtagChanged(e){ba(this.change,"change");const t=e.detail.length?e.detail:void 0;t?.length&&(ea(this,"Saving hashtag and reloading ..."),await this.restApiService.setChangeHashtag(this.change._number,{add:[t]}),Jn(this,"hide-alert",{}),aa(this))}async handleIdentityChanged(e,t){ba(this.change,"change");const i=e.detail.length?e.detail.trim():void 0;if(!i?.length)return;const[,r,o]=i.match(/(\w+.*)\s<(\S+@\S+.\S+)>/)??[];r&&o?(ea(this,"Saving identity and reloading ..."),await this.restApiService.updateIdentityInChangeEdit(this.change._number,r,o,t.toUpperCase()),Jn(this,"hide-alert",{}),aa(this)):ta(this,'Invalid input format, valid identity format is "FullName <user@example.com>"')}computeTopicReadOnly(){return!this.mutable||!this.change?.actions?.topic?.enabled}computeHashtagReadOnly(){return!this.mutable||!this.change?.actions?.hashtags?.enabled}computeTopicPlaceholder(){return this.topicReadOnly?"No topic":"Set Topic"}computeHashtagPlaceholder(){return this.hashtagReadOnly?"":"Add Hashtag"}computePushCertificateValidation(){if(!this.change||!this.serverConfig?.receive?.enable_signed_push)return;if(!this.isEnabledSignedPushOnRepo())return;const e=this.change.revisions[this.change.current_revision];if(!e.push_certificate?.key)return{class:"help filled",icon:"help",message:"This patch set was created without a push certificate"};const t=e.push_certificate.key;switch(t.status){case Fu.BAD:return{class:"invalid",icon:"close",message:this.problems("Push certificate is invalid",t)};case Fu.OK:return{class:"notTrusted filled",icon:"info",message:this.problems("Push certificate is valid, but key is not trusted",t)};case Fu.TRUSTED:return{class:"trusted",icon:"check",message:this.problems("Push certificate is valid and key is trusted",t)};case void 0:throw new Error("deleted certificate");default:fa(t.status,`unknown certificate status: ${t.status}`)}}isEnabledSignedPushOnRepo(){if(!this.repoConfig?.enable_signed_push)return!1;const e=this.repoConfig.enable_signed_push;return e.configured_value===Bu.INHERIT&&e.inherited_value||e.configured_value===Bu.TRUE}problems(e,t){return t?.problems&&0!==t.problems.length?[e+":"].concat(t.problems).join("\n"):e}computeShowRepoBranchTogether(){const{project:e,branch:t}=this.change;return!!e&&!!t&&e.length+t.length<40}computeProjectUrl(e){return e?tE({repo:e}):""}computeBranchUrl(e,t){return e&&t&&this.change&&this.change.status?tE({branch:t,repo:e}):""}computeCherryPickOfUrl(e,t,i){return e&&i?WC({changeNum:e,repo:i,usp:"metadata",patchNum:t}):""}computeHashtagUrl(e){return tE({hashtag:e,statuses:["open","merged"]})}async handleTopicRemoved(e){ba(this.change,"change");const t=e.composedPath()[0];t.disabled=!0;try{ea(this,"Removing topic and reloading ..."),await this.restApiService.setChangeTopic(this.change._number)}finally{t.disabled=!1}Jn(this,"hide-alert",{}),aa(this)}async handleHashtagRemoved(e){e.preventDefault(),ba(this.change,"change");const t=e.target;t.disabled=!0;try{ea(this,"Removing hashtag and reloading ..."),await this.restApiService.setChangeHashtag(this.change._number,{remove:[t.text]})}finally{t.disabled=!1}Jn(this,"hide-alert",{}),aa(this)}computeDisplayState(e,t){return e===HN.TOPIC?this.showAllSections||DC(this.change,t)||GN(e,this.change)?"":"hideDisplay":this.showAllSections||jN.ALWAYS_SHOW.includes(e)||jN.SHOW_IF_SET.includes(e)&&GN(e,this.change)?"":"hideDisplay"}computeMergedCommitInfo(e,t){if(!e||!t)return;const i=t[e];return i&&i.commit?(i.commit.commit||(i.commit.commit=e),i.commit):void 0}getRevertSectionTitle(){return this.revertedChange?.status===Nu.MERGED?"Revert Submitted As":"Revert Created As"}showRevertCreatedAs(){return!!this.change?.messages&&RT(this.change.messages).length>0}computeRevertCommit(){const{revertedChange:e,change:t}=this;return e?.current_revision&&e?.revisions?{commit:this.computeMergedCommitInfo(e.current_revision,e.revisions)}:t?.messages?{commit:RT(t.messages)?.[0]}:void 0}onShowAllClick(){this.showAllSections=!this.showAllSections,this.reporting.reportInteraction(ga.TOGGLE_SHOW_ALL_BUTTON,{sectionName:"metadata",toState:this.showAllSections?"Show all":"Show less"})}getNonOwnerRole(e){if(!this.change?.revisions?.[this.change.current_revision])return;const t=this.change.revisions[this.change.current_revision];return t?e===RL.UPLOADER&&t.uploader&&this.change.owner._account_id!==t.uploader._account_id?t.uploader:e===RL.AUTHOR&&t.commit?.author&&(this.editMode||this.change.owner.email!==t.commit.author.email)?t.commit.author:e!==RL.COMMITTER||!t.commit?.committer||!this.editMode&&(this.change.owner.email===t.commit.committer.email||t.uploader?.email&&t.uploader.email===t.commit.committer.email)?void 0:t.commit.committer:void 0}computeParents(){const{change:e,revision:t}=this;if(!t?.commit){if(!e?.current_revision)return[];const t=e.revisions[e.current_revision];return t?.commit?.parents??[]}return t?.commit?.parents??[]}computeParentListClass(){return["parentList",this.currentParents.length>1?"merge":"nonMerge",this.parentIsCurrent?"current":"notCurrent"].join(" ")}computeIsMutable(){return!!this.account&&!!Object.keys(this.account).length}editTopic(){if(this.topicReadOnly||!this.change||this.change.topic)return;const e=this.shadowRoot.querySelector(".topicEditableLabel");e&&e.open()}getTopicSuggestions(e){return this.restApiService.getChangesWithSimilarTopic(e,Ff).then((e=>(e??[]).map((e=>e.topic)).filter(cf).filter(Ca).map((e=>({name:e,value:e})))))}getHashtagSuggestions(e){const t=e.startsWith("^")?new RegExp(e):null;return this.restApiService.getChangesWithSimilarHashtag(e,Ff).then((i=>(i??[]).flatMap((e=>e.hashtags??[])).filter(cf).filter(Ca).filter((i=>t?t.test(i):i.includes(e))).map((e=>({name:e,value:e})))))}async getIdentitySuggestions(e){const t=await this.restApiService.getAccountSuggestions(e);if(!t)return[];const i=[];return t.forEach((e=>{const t=ox(this.serverConfig,e),r=[];e.email&&r.push(e.email),e.secondary_emails&&r.push(...e.secondary_emails),r.forEach((e=>{const r=t+" "+nx(e);i.push({name:r})}))})),i}computeVoteForRole(e){const t=this.getNonOwnerRole(e);return t&&gf(t)?this.computeVote(t):void 0}computeVote(e){const t=this.computeCodeReviewLabel();if(t&&Xu(t))return pv(t,e)}computeCodeReviewLabel(){if(this.change?.labels)return bv(this.change.labels)}};TL([Hc("#webLinks")],PL.prototype,"webLinks",void 0),TL([Fc({type:Boolean})],PL.prototype,"parentIsCurrent",void 0),TL([Uc()],PL.prototype,"change",void 0),TL([Uc()],PL.prototype,"revertedChange",void 0),TL([Uc()],PL.prototype,"editMode",void 0),TL([Uc()],PL.prototype,"account",void 0),TL([Uc()],PL.prototype,"revision",void 0),TL([Uc()],PL.prototype,"serverConfig",void 0),TL([Uc()],PL.prototype,"repoConfig",void 0),TL([Uc()],PL.prototype,"mutable",void 0),TL([Uc()],PL.prototype,"notCurrentMessage",void 0),TL([Uc()],PL.prototype,"topicReadOnly",void 0),TL([Uc()],PL.prototype,"hashtagReadOnly",void 0),TL([Uc()],PL.prototype,"pushCertificateValidation",void 0),TL([Uc()],PL.prototype,"settingTopic",void 0),TL([Uc()],PL.prototype,"currentParents",void 0),TL([Uc()],PL.prototype,"showAllSections",void 0),TL([Uc()],PL.prototype,"queryIdentity",void 0),TL([Uc()],PL.prototype,"queryTopic",void 0),TL([Uc()],PL.prototype,"queryHashtag",void 0),PL=TL([Dc("gr-change-metadata")],PL);var NL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let OL=class extends Ic{constructor(){super(),this.shortcuts=new Gg(this),this.getChangeModel=yu(this,MT),this.getConfigModel=yu(this,Qw),this.restApiService=Xn().restApiService,zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getChangeModel().patchNum$),(e=>this.patchNum=e)),zf(this,(()=>this.getConfigModel().download$),(e=>this.config=e));for(const e of["1","2","3","4","5","6","7","8","9"])this.shortcuts.addLocal({key:e},(e=>this.handleNumberKey(e)))}static get styles(){return[Qb,Nc,Sd`
        :host {
          display: block;
          padding: var(--spacing-m) 0;
        }
        section {
          display: flex;
          padding: var(--spacing-m) var(--spacing-xl);
        }
        .flexContainer {
          display: flex;
          justify-content: space-between;
          padding-top: var(--spacing-m);
        }
        .footer {
          justify-content: flex-end;
        }
        .closeButtonContainer {
          align-items: flex-end;
          display: flex;
          flex: 0;
          justify-content: flex-end;
        }
        .patchFiles,
        .archivesContainer {
          padding-bottom: var(--spacing-m);
        }
        .patchFiles {
          margin-right: var(--spacing-xxl);
        }
        .patchFiles a,
        .archives a {
          display: inline-block;
          margin-right: var(--spacing-l);
        }
        .patchFiles a:last-of-type,
        .archives a:last-of-type {
          margin-right: 0;
        }
        gr-download-commands {
          width: min(80vw, 1200px);
        }
      `]}render(){const e=this.change?.revisions;return dc`
      <section>
        <h3 class="heading-3">
          Patch set ${this.patchNum} of
          ${e?Object.keys(e).length:0}
        </h3>
      </section>
      ${this.renderDownloadCommands()}
      <section class="flexContainer">
        ${this.renderPatchFiles()} ${this.renderArchives()}
      </section>
      <section class="footer">
        <span class="closeButtonContainer">
          <gr-button
            id="closeButton"
            link
            @click=${e=>{this.handleCloseTap(e)}}
            >Close</gr-button
          >
        </span>
      </section>
    `}renderDownloadCommands(){const e=this.schemes.length?"":"hidden";return dc`
      <section class=${e}>
        <gr-download-commands
          id="downloadCommands"
          .commands=${this.computeDownloadCommands()}
          .schemes=${this.schemes}
          .selectedScheme=${this.selectedScheme}
          show-keyboard-shortcut-tooltips
          @selected-scheme-changed=${e=>{this.selectedScheme=e.detail.value}}
          @item-copied=${e=>{this.handleCloseTap(e)}}
        ></gr-download-commands>
      </section>
    `}renderPatchFiles(){if(!this.computeHidePatchFile())return dc`
      <div class="patchFiles">
        <label>Patch file</label>
        <div>
          <gr-button
            id="copy-clipboard-button"
            link=""
            class="copyToClipboard"
            title="Copy Patch to clipboard"
            @click=${this.handleCopyPatch}
            aria-label="copy"
            aria-description="Click to copy patch to clipboard"
          >
            <div>
              <gr-icon id="icon" icon="content_copy" small></gr-icon>
            </div>
          </gr-button>
          <a id="download" .href=${this.computeDownloadLink("raw")} download>
            ${this.computeDownloadFilename("raw")}
          </a>
          <a .href=${this.computeDownloadLink("base64")} download>
            ${this.computeDownloadFilename("base64")}
          </a>
          <a .href=${this.computeDownloadLink("zip")} download>
            ${this.computeDownloadFilename("zip")}
          </a>
        </div>
      </div>
    `}renderArchives(){if(this.config?.archives.length)return dc`
      <div class="archivesContainer">
        <label>Archive</label>
        <div id="archives" class="archives">
          ${this.config.archives.map((e=>this.renderArchivesLink(e)))}
        </div>
      </div>
    `}renderArchivesLink(e){return dc`
      <a .href=${this.computeArchiveDownloadLink(e)} download>
        ${e}
      </a>
    `}firstUpdated(e){super.firstUpdated(e),this.getAttribute("role")||this.setAttribute("role","dialog")}willUpdate(e){(e.has("change")||e.has("patchNum"))&&this.schemesChanged()}get schemes(){if(void 0===this.change||void 0===this.patchNum)return[];for(const e of Object.values(this.change.revisions||{}))if(e._number===this.patchNum){const t=e.fetch;if(t)return Object.keys(t).sort();break}return[]}async handleNumberKey(e){const t=Number(e.key)-1,i=this.computeDownloadCommands();t>i.length||(await Sa(i[t].command,`${i[t].title} command`),Jn(this,"close",{}))}async handleCopyPatch(e){if(e.preventDefault(),e.stopPropagation(),!this.change||!this.patchNum)return;const t=await this.restApiService.getPatchContent(this.change._number,this.patchNum);t?(await Sa(t,"patch file content"),this.handleCloseTap(e)):ta(this,"Failed to get patch content")}focus(){this.schemes.length?(ba(this.downloadCommands,"downloadCommands"),this.updateComplete.then((()=>this.downloadCommands.focusOnCopy()))):(ba(this.download,"download"),this.download.focus())}computeDownloadCommands(){let e;if(!this.change||!this.selectedScheme)return[];for(const t of Object.values(this.change.revisions||{}))if(t._number===this.patchNum&&t&&t.fetch&&ma(t.fetch,this.selectedScheme)){e=t.fetch[this.selectedScheme].commands;break}const t=[];for(const[i,r]of Object.entries(e??{}))t.push({title:i,command:r});return t}computeDownloadLink(e){if(void 0===this.change||void 0===this.patchNum)return"";let t;switch(e){case"zip":t="&zip";break;case"raw":t="&raw";break;case"base64":t=""}return IC(this.change.project,this.change._number,this.patchNum)+"/patch?download"+t}computeDownloadFilename(e){if(void 0===this.change||void 0===this.patchNum)return"";let t;switch(e){case"zip":t=".zip";break;case"raw":t="";break;case"base64":t=".base64"}return Ux(jC(this.change,this.patchNum)??"")+".diff"+t}computeHidePatchFile(){if(void 0===this.change||void 0===this.patchNum)return!1;for(const e of Object.values(this.change.revisions||{}))if(e._number===this.patchNum){const t=e.commit&&e.commit.parents?e.commit.parents.length:0;return 0===t||t>1}return!1}computeArchiveDownloadLink(e){return void 0===this.change||void 0===this.patchNum||void 0===e?"":IC(this.change.project,this.change._number,this.patchNum)+"/archive?format="+e}handleCloseTap(e){e.preventDefault(),e.stopPropagation(),Jn(this,"close",{})}schemesChanged(){0!==this.schemes.length&&(this.selectedScheme&&this.schemes.includes(this.selectedScheme)||(this.selectedScheme=this.schemes.sort()[0]))}};NL([Hc("#download")],OL.prototype,"download",void 0),NL([Hc("#downloadCommands")],OL.prototype,"downloadCommands",void 0),NL([Hc("#closeButton")],OL.prototype,"closeButton",void 0),NL([Uc()],OL.prototype,"change",void 0),NL([Uc()],OL.prototype,"config",void 0),NL([Uc()],OL.prototype,"patchNum",void 0),NL([Uc()],OL.prototype,"selectedScheme",void 0),OL=NL([Dc("gr-download-dialog")],OL);const DL={},LL=mu("browser-model");class ML extends df{constructor(e){super(DL),this.userModel=e,this.isScreenTooSmall$=lf(this.state$,(e=>!!e.screenWidth&&e.screenWidth<850)),this.diffViewMode$=lf(Yh([this.isScreenTooSmall$,this.userModel.preferenceDiffViewMode$]),(([e,t])=>e?Su.UNIFIED:t))}observeWidth(){return new ResizeObserver((e=>{e.forEach((e=>{this.setScreenWidth(e.contentRect.width)}))}))}setScreenWidth(e){this.updateState({screenWidth:e})}}var FL,UL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let BL=FL=class extends Ic{constructor(){super(...arguments),this.mode="polite",this.timeout=150,this._text="",this._onIronAnnounce=e=>{const t=e;t.detail?.text&&this.announce(t.detail.text)}}connectedCallback(){super.connectedCallback(),FL.instance||(FL.instance=this),document.addEventListener("iron-announce",this._onIronAnnounce)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("iron-announce",this._onIronAnnounce)}render(){return dc`<div aria-live=${this.mode}>${this._text}</div>`}announce(e){this._text="",setTimeout((()=>{this._text=e}),this.timeout)}static requestAvailability(){if(!FL.instance){const e=document.createElement("gr-a11y-announcer");document.body.appendChild(e),FL.instance=e}return FL.instance}};function HL(){BL.requestAvailability()}BL.instance=null,BL.styles=Sd`
    :host {
      display: inline-block;
      position: fixed;
      clip: rect(0, 0, 0, 0);
    }
  `,UL([Fc({type:String})],BL.prototype,"mode",void 0),UL([Fc({type:Number})],BL.prototype,"timeout",void 0),UL([Uc()],BL.prototype,"_text",void 0),BL=FL=UL([Dc("gr-a11y-announcer")],BL);var jL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let GL=class extends Ic{constructor(){super(),this.saveOnChange=!1,this.showTooltipBelow=!1,this.mode=Su.SIDE_BY_SIDE,this.getBrowserModel=yu(this,LL),this.getUserModel=yu(this,jf),zf(this,(()=>this.getBrowserModel().diffViewMode$),(e=>this.mode=e))}connectedCallback(){super.connectedCallback(),HL()}static get styles(){return[Nc,Sd`
        :host {
          /* Used to remove horizontal whitespace between the icons. */
          display: flex;
        }
        gr-button.selected gr-icon {
          color: var(--link-color);
        }
        gr-icon {
          font-size: 1.3rem;
        }
      `]}render(){return dc`
      <gr-tooltip-content
        has-tooltip
        title="Side-by-side diff"
        ?position-below=${this.showTooltipBelow}
      >
        <gr-button
          id="sideBySideBtn"
          link
          class=${this.computeSideBySideSelected()}
          aria-pressed=${this.isSideBySideSelected()}
          aria-label="Side-by-side diff"
          @click=${this.handleSideBySideTap}
        >
          <gr-icon icon="view_column_2" filled aria-hidden="true"></gr-icon>
        </gr-button>
      </gr-tooltip-content>
      <gr-tooltip-content
        has-tooltip
        ?position-below=${this.showTooltipBelow}
        title="Unified diff"
      >
        <gr-button
          id="unifiedBtn"
          link
          class=${this.computeUnifiedSelected()}
          aria-pressed=${this.isUnifiedSelected()}
          aria-label="Unified diff"
          @click=${this.handleUnifiedTap}
        >
          <gr-icon icon="calendar_view_day" filled aria-hidden="true"></gr-icon>
        </gr-button>
      </gr-tooltip-content>
    `}setMode(e){let t;this.saveOnChange&&this.mode&&this.mode!==e&&this.getUserModel().updatePreferences({diff_view:e}),this.mode=e,this.isUnifiedSelected()?t="Changed diff view to unified":this.isSideBySideSelected()&&(t="Changed diff view to side by side"),t&&sa(this,t)}computeSideBySideSelected(){return this.mode===Su.SIDE_BY_SIDE?"selected":""}computeUnifiedSelected(){return this.mode===Su.UNIFIED?"selected":""}isSideBySideSelected(){return this.mode===Su.SIDE_BY_SIDE}isUnifiedSelected(){return this.mode===Su.UNIFIED}handleSideBySideTap(){this.setMode(Su.SIDE_BY_SIDE)}handleUnifiedTap(){this.setMode(Su.UNIFIED)}};jL([Fc({type:Boolean})],GL.prototype,"saveOnChange",void 0),jL([Fc({type:Boolean,attribute:"show-tooltip-below"})],GL.prototype,"showTooltipBelow",void 0),jL([Uc()],GL.prototype,"mode",void 0),GL=jL([Dc("gr-diff-mode-selector")],GL);class zL{constructor(e){this.change=e}getMaxParents(){return this.change&&this.change.revisions?Object.values(this.change.revisions).reduce(((e,t)=>Math.max(t.commit?t.commit.parents.length:0,e)),0):0}getParentCountMap(){const e=new Map;return this.change&&this.change.revisions?(Object.values(this.change.revisions).forEach((t=>{t.commit&&e.set(t._number,t.commit.parents.length)})),e):e}getParentCount(e){return this.getParentCountMap().get(e)??1}isMergeCommit(e){return void 0!==e&&this.getParentCount(e)>1}getParentId(e,t){if(!this.change.revisions)return;const i=Object.values(this.change.revisions).find((t=>t._number===e));return i&&i.commit?i.commit.parents[t].commit:void 0}}var VL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let WL=class extends Ic{constructor(){super(),this.availablePatches=[],this.sortedRevisions=[],this.codeReviewVotes=new Map,this.reporting=Xn().reportingService,this.getUserModel=yu(this,jf),this.getCommentsModel=yu(this,kP),this.getChangeModel=yu(this,MT),this.getViewModel=yu(this,XC),zf(this,(()=>this.getViewModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getUserModel().account$),(e=>this.selfAccount=e)),zf(this,(()=>this.getChangeModel().change$),(e=>this.revisionInfo=e?new zL(e):void 0)),zf(this,(()=>this.getChangeModel().patchNum$),(e=>this.patchNum=e)),zf(this,(()=>this.getChangeModel().basePatchNum$),(e=>this.basePatchNum=e)),zf(this,(()=>this.getChangeModel().patchsets$),(e=>this.availablePatches=e)),zf(this,(()=>this.getChangeModel().revisions$),(e=>this.sortedRevisions=e)),zf(this,(()=>this.getCommentsModel().changeComments$),(e=>this.changeComments=e)),zf(this,(()=>this.getChangeModel().revisionUpdatedFiles$),(e=>this.revisionUpdatedFiles=e)),zf(this,(()=>Yh([this.getChangeModel().change$,this.getUserModel().account$])),(([e,t])=>{this.codeReviewVotes=function(e,t){const i=new Map;if(!e?.messages||!e?.labels||!t)return i;const r={};for(const t of Object.keys(e.labels)){const i=sv(e.labels[t]);i&&(r[t]=i)}for(const o of e.messages){if(o.author?._account_id!==t._account_id)continue;if(!o._revision_number)continue;const e=TT(o,r);for(const t of e)if(t.label===rv.CODE_REVIEW&&t.value){const e=t.value===kT?"0":t.value;i.set(o._revision_number,{label:t.label,value:e})}}return i}(e,t)}))}static get styles(){return[yO,Nc,Sd`
        :host {
          align-items: center;
          display: flex;
        }
        select {
          max-width: 15em;
        }
        .arrow {
          color: var(--deemphasized-text-color);
          margin: 0 var(--spacing-m);
        }
        gr-dropdown-list {
          --trigger-style-text-color: var(--deemphasized-text-color);
          --trigger-style-font-family: var(--font-family);
        }
        .filesWeblinks gr-weblink {
          vertical-align: baseline;
        }
        @media screen and (max-width: 50em) {
          .filesWeblinks {
            display: none;
          }
          /* prettier formatter removes semi-colons after css mixins. */
          /* prettier-ignore */
          gr-dropdown-list {
            --native-select-style: {
              max-width: 5.25em;
            };
          }
        }
      `]}render(){return this.changeNum&&this.patchNum&&this.basePatchNum?dc`
      <h3 class="assistive-tech-only">Patchset Range Selection</h3>
      <span class="patchRange" aria-label="patch range starts with">
        <gr-dropdown-list
          id="basePatchDropdown"
          .value=${Lg(this.basePatchNum)}
          .items=${this.computeBaseDropdownContent()}
          @value-change=${this.handlePatchChange}
        >
        </gr-dropdown-list>
      </span>
      ${this.renderWeblinks(this.filesWeblinks?.meta_a)}
      <span aria-hidden="true" class="arrow">→</span>
      <span class="patchRange" aria-label="patch range ends with">
        <gr-dropdown-list
          id="patchNumDropdown"
          .value=${Lg(this.patchNum)}
          .items=${this.computePatchDropdownContent()}
          @value-change=${this.handlePatchChange}
        >
        </gr-dropdown-list>
        ${this.renderWeblinks(this.filesWeblinks?.meta_b)}
      </span>
    `:uc}renderWeblinks(e){if(e)return dc`<span class="filesWeblinks">
      ${e.map((e=>dc`<gr-weblink .info=${e}></gr-weblink>`))}</span
    > `}computeBaseDropdownContent(){if(void 0===this.patchNum||void 0===this.changeComments||void 0===this.revisionInfo)return[];const e=this.revisionInfo.getMaxParents(),t=this.revisionInfo.isMergeCommit(this.patchNum),i=this.revisionInfo.getParentCount(this.patchNum),r=Ix(this.sortedRevisions,this.patchNum),o=this.availablePatches.filter((e=>this.isValidLeftPatchNum(e.num,this.patchNum))).map((e=>this.createDropdownEntry(e.num,"Patchset ",e.sha)));o.push({triggerText:t?"Auto Merge":"Base",text:t?"Auto Merge":`Base | ${Hx(r,0)}`,bottomText:t?void 0:jx(r,0),value:Qu});for(let s=0;t&&s<e;s++)o.push({disabled:s>=i,triggerText:`Parent ${s+1}`,text:`Parent ${s+1} | ${Hx(r,s)}`,bottomText:jx(r,s),mobileText:`Parent ${s+1}`,value:-(s+1)});return o}computeMobileText(e){return`${e}${this.computePatchSetCommentsString(e)}${this.computePatchSetDescription(e,!0)}`}computePatchDropdownContent(){return void 0===this.availablePatches||void 0===this.basePatchNum||void 0===this.changeComments?[]:this.availablePatches.filter((e=>this.isValidRightPatchNum(this.basePatchNum,e.num))).map((e=>this.createDropdownEntry(e.num,e.num===Ju?"":"Patchset ",e.sha)))}computeText(e,t,i){return`${t}${e} | ${i}`}createDropdownEntry(e,t,i){const r={triggerText:`${t}${e}`,text:this.computeText(e,t,Ux(i)),mobileText:this.computeMobileText(e),bottomText:`${this.computePatchSetDescription(e)}`,value:e,commentThreads:this.changeComments?.computeCommentThreads({path:this.path,patchNum:e},!!this.path),deemphasizeReason:this.computeDeemphasizeReason(i),vote:this.computeVote(this.selfAccount,this.change,e),label:this.computeCodeReviewLabel(this.change)},o=this.computePatchSetDate(e);return o&&(r.date=o),r}computeDeemphasizeReason(e){if(this.path&&this.revisionUpdatedFiles)return this.revisionUpdatedFiles[e]?.[this.path]===NT.SAME?"Unmodified":void 0}computeVote(e,t,i){if(!t||!e||!i)return;const r=this.codeReviewVotes.get(i);return r?{...e,value:Number(r.value)}:void 0}computeCodeReviewLabel(e){if(e?.labels)return bv(e.labels)}isValidLeftPatchNum(e,t){return Mx(e,this.sortedRevisions)>Mx(t,this.sortedRevisions)}isValidRightPatchNum(e,t){return e===Qu||(kx(e)?!!this.revisionInfo&&this.revisionInfo.getParentCount(t)>=Fx(e):Mx(e,this.sortedRevisions)>Mx(t,this.sortedRevisions))}computePatchSetCommentsString(e){if(!this.changeComments)return"";const t=Ig(this.changeComments.computeCommentThreads({path:this.path,patchNum:e},!!this.path).length,"comment"),i=this.changeComments.computeUnresolvedNum({path:this.path,patchNum:e},!!this.path),r=0===i?"":`${i} unresolved`;return t.length||r.length?` (${t}`+(t&&r?", ":"")+`${r})`:""}computePatchSetDescription(e,t){const i=Ix(this.sortedRevisions,e);return i?.description?(t?" ":"")+i.description.substring(0,500):""}computePatchSetDate(e){const t=Ix(this.sortedRevisions,e);return t?t.created:void 0}handlePatchChange(e){const t={patchNum:this.patchNum,basePatchNum:this.basePatchNum},i=e.target,r=Rx(e.detail.value),o=Dx(this.availablePatches);if(i===this.patchNumDropdown){if(t.patchNum===r)return;this.reporting.reportInteraction("right-patchset-changed",{path:this.path,previous:t.patchNum,current:r,latest:o,commentCount:this.changeComments?.computeCommentThreads({path:this.path,patchNum:r}).length}),t.patchNum=r}else{if(t.basePatchNum===r)return;this.reporting.reportInteraction("left-patchset-changed",{path:this.path,previous:t.basePatchNum,current:r,commentCount:this.changeComments?.computeCommentThreads({path:this.path,patchNum:r}).length}),t.basePatchNum=r}Zn(this,"patch-range-change",t)}};VL([Hc("#patchNumDropdown")],WL.prototype,"patchNumDropdown",void 0),VL([Uc()],WL.prototype,"availablePatches",void 0),VL([Uc()],WL.prototype,"changeNum",void 0),VL([Uc()],WL.prototype,"change",void 0),VL([Uc()],WL.prototype,"selfAccount",void 0),VL([Fc()],WL.prototype,"path",void 0),VL([Fc({type:Object})],WL.prototype,"filesWeblinks",void 0),VL([Uc()],WL.prototype,"patchNum",void 0),VL([Uc()],WL.prototype,"basePatchNum",void 0),VL([Uc()],WL.prototype,"revisionInfo",void 0),VL([Uc()],WL.prototype,"sortedRevisions",void 0),VL([Uc()],WL.prototype,"changeComments",void 0),VL([Uc()],WL.prototype,"revisionUpdatedFiles",void 0),VL([Uc()],WL.prototype,"codeReviewVotes",void 0),WL=VL([Dc("gr-patch-range-select")],WL);const qL={OPEN:{label:"Add/Open/Upload",id:"open"},DELETE:{label:"Delete",id:"delete"},RENAME:{label:"Rename",id:"rename"},RESTORE:{label:"Restore",id:"restore"}};var KL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const YL="File failed to upload.";let XL=class extends Ic{constructor(){super(...arguments),this.hiddenActions=[qL.RESTORE.id],this.actions=Object.values(qL),this.path="",this.newPath="",this.query=e=>this.queryFiles(e),this.restApiService=Xn().restApiService,this.getChangeModel=yu(this,MT),this.getViewModel=yu(this,XC),this.getNavigation=yu(this,gy),this.handleClick=e=>{switch(e.preventDefault(),e.target.id){case qL.OPEN.id:return void this.openOpenDialog();case qL.DELETE.id:return void this.openDeleteDialog();case qL.RENAME.id:return void this.openRenameDialog();case qL.RESTORE.id:return void this.openRestoreDialog()}}}static get styles(){return[Jy,vy,Nc,Iw,Yc,Sd`
        :host {
          align-items: center;
          display: flex;
          justify-content: flex-end;
        }
        .invisible {
          display: none;
        }
        gr-button {
          margin-left: var(--spacing-l);
          text-decoration: none;
        }
        gr-dialog {
          width: calc(min(50em, 90vw));
        }
        gr-dialog .main {
          width: 100%;
        }
        gr-dialog .main > md-outlined-text-field {
          width: 100%;
        }
        input {
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          margin: var(--spacing-m) 0;
          padding: var(--spacing-s);
          width: 100%;
          box-sizing: border-box;
        }
        #dragDropArea {
          border: 2px dashed var(--border-color);
          border-radius: var(--border-radius);
          margin-top: var(--spacing-l);
          padding: var(--spacing-xxl) var(--spacing-xxl);
          text-align: center;
          cursor: pointer;
        }
        #dragDropArea:hover,
        .hover {
          background-color: var(--hover-background-color);
        }
        #dragDropArea > p {
          font-weight: var(--font-weight-medium);
          padding: var(--spacing-s);
        }
        .loadingSpin {
          width: calc(var(--line-height-normal) - 2px);
          height: calc(var(--line-height-normal) - 2px);
          display: inline-block;
          vertical-align: middle;
        }
        .fileUploadInfo {
          margin-top: var(--spacing-l);
        }
        .disabled {
          pointer-events: none;
          opacity: 0.6;
        }
        md-outlined-text-field {
          margin: var(--spacing-m) 0;
        }
        @media screen and (max-width: 50em) {
          gr-dialog {
            height: 90vh;
          }
        }
      `]}render(){return dc`
      ${this.actions.map((e=>this.renderAction(e)))}
      <dialog id="modal" tabindex="-1">
        ${this.renderOpenDialog()} ${this.renderDeleteDialog()}
        ${this.renderRenameDialog()} ${this.renderRestoreDialog()}
      </dialog>
    `}renderAction(e){return dc`
      <gr-button
        id=${e.id}
        class=${this.computeIsInvisible(e.id)}
        link=""
        @click=${this.handleClick}
        >${e.label}</gr-button
      >
    `}renderOpenDialog(){return dc`
      <gr-dialog
        id="openDialog"
        class="invisible dialog"
        ?disabled=${!this.isValidPath(this.path)||!!this.fileUploaded}
        ?disableCancel=${!!this.fileUploaded}
        confirm-label="Confirm"
        confirm-on-enter=""
        @confirm=${e=>this.handleOpenConfirm(e)}
        @cancel=${e=>this.handleDialogCancel(e)}
      >
        <div class="header" slot="header">
          Add a new file or open an existing file
        </div>
        <div class="main" slot="main">
          <gr-autocomplete
            placeholder="Enter an existing or new full file path."
            .query=${this.query}
            .text=${this.path}
            .showBlueFocusBorder=${!0}
            @text-changed=${e=>this.handleTextChanged(e)}
          ></gr-autocomplete>
          <!-- We have to call preventDefault for dragenter and dragover
                in order for the drop event to work. -->
          <div
            id="dragDropArea"
            @drop=${e=>this.handleDragAndDropUpload(e)}
            @click=${()=>{this.fileUploaded||this.fileUploadInput?.click()}}
            @dragenter=${e=>e.preventDefault()}
            @dragover=${e=>{e.preventDefault(),!this.fileUploaded&&this.dragDropArea&&this.dragDropArea.classList.add("hover")}}
            @dragleave=${()=>{!this.fileUploaded&&this.dragDropArea&&this.dragDropArea.classList.remove("hover")}}
          >
            <p>Drag and drop your file here, or click to select</p>
            <input
              id="fileUploadInput"
              type="file"
              @change=${e=>this.handleFileUploadChange(e)}
              ?hidden=${!0}
            />
          </div>
          ${this.renderLoading()}
        </div>
      </gr-dialog>
    `}renderLoading(){if(this.fileUploaded)return dc`
      <div id="fileUploadInfo" class="fileUploadInfo">
        <span class="loadingSpin"></span>
        <span>Uploading...</span>
        <span>${this.fileName} (${this.fileSize})</span>
      </div>
    `}renderDeleteDialog(){return dc`
      <gr-dialog
        id="deleteDialog"
        class="invisible dialog"
        ?disabled=${!this.isValidPath(this.path)}
        confirm-label="Delete"
        confirm-on-enter=""
        @confirm=${e=>this.handleDeleteConfirm(e)}
        @cancel=${e=>this.handleDialogCancel(e)}
      >
        <div class="header" slot="header">Delete a file from the repo</div>
        <div class="main" slot="main">
          <gr-autocomplete
            placeholder="Enter an existing full file path."
            .query=${this.query}
            .text=${this.path}
            .showBlueFocusBorder=${!0}
            @text-changed=${e=>this.handleTextChanged(e)}
          ></gr-autocomplete>
        </div>
      </gr-dialog>
    `}renderRenameDialog(){return dc`
      <gr-dialog
        id="renameDialog"
        class="invisible dialog"
        ?disabled=${!this.isValidPath(this.path)||!this.isValidPath(this.newPath)}
        confirm-label="Rename"
        confirm-on-enter=""
        @confirm=${e=>this.handleRenameConfirm(e)}
        @cancel=${e=>this.handleDialogCancel(e)}
      >
        <div class="header" slot="header">Rename a file in the repo</div>
        <div class="main" slot="main">
          <gr-autocomplete
            placeholder="Enter an existing full file path."
            .query=${this.query}
            .text=${this.path}
            .showBlueFocusBorder=${!0}
            @text-changed=${e=>this.handleTextChanged(e)}
          ></gr-autocomplete>
          <md-outlined-text-field
            id="newPathInput"
            class="showBlueFocusBorder"
            placeholder="Enter the new path."
            .value=${this.newPath??""}
            @input=${e=>{const t=e.target;this.newPath=t.value}}
          >
          </md-outlined-text-field>
        </div>
      </gr-dialog>
    `}renderRestoreDialog(){return dc`
      <gr-dialog
        id="restoreDialog"
        class="invisible dialog"
        confirm-label="Restore"
        confirm-on-enter=""
        @confirm=${e=>this.handleRestoreConfirm(e)}
        @cancel=${e=>this.handleDialogCancel(e)}
      >
        <div class="header" slot="header">Restore this file?</div>
        <div class="main" slot="main">
          <md-outlined-text-field
            class="showBlueFocusBorder"
            ?readOnly=${!0}
            .value=${this.path??""}
            @input=${e=>{const t=e.target;this.path=t.value}}
          >
          </md-outlined-text-field>
        </div>
      </gr-dialog>
    `}openOpenDialog(e){e&&(this.path=e),this.resetUploadStatus(),ba(this.openDialog,"openDialog"),this.showDialog(this.openDialog)}openDeleteDialog(e){e&&(this.path=e),ba(this.deleteDialog,"deleteDialog"),this.showDialog(this.deleteDialog)}openRenameDialog(e){e&&(this.path=e),ba(this.renameDialog,"renameDialog"),this.showDialog(this.renameDialog)}openRestoreDialog(e){ba(this.restoreDialog,"restoreDialog"),e&&(this.path=e),this.showDialog(this.restoreDialog)}isValidPath(e){return!!e.length&&!e.endsWith("/")}getDialogFromEvent(e){return e.composedPath().find((e=>e instanceof Element&&!!e.classList&&e.classList.contains("dialog")))}showDialog(e){ba(this.modal,"modal"),this.hideAllDialogs(),this.modal.showModal(),Ln(this.modal,(()=>{e.classList.toggle("invisible",!1);const t=wa(e,"gr-autocomplete");t&&t.focus()}))}hideAllDialogs(){const e=ya(this,".dialog");for(const t of e)this.closeDialog(t,!1)}closeDialog(e,t=!0){e&&(t&&(e.querySelectorAll("gr-autocomplete").forEach((e=>{e.text=""})),e.querySelectorAll("md-outlined-text-field").forEach((e=>{e.value="",e.dispatchEvent(new Event("input",{bubbles:!0}))}))),e.classList.toggle("invisible",!0),ba(this.modal,"modal"),this.modal.close())}handleDialogCancel(e){this.closeDialog(this.getDialogFromEvent(e))}handleOpenConfirm(e){if(!this.change||!this.path)return ea(this,"You must enter a path."),void this.closeDialog(this.openDialog);const t=this.patchNum;ba(this.patchNum,"patchset number"),t===Qu&&ea(this,"This doesn't work on Parent");const i=this.getViewModel().editUrl({editView:{path:this.path},patchNum:t});this.getNavigation().setUrl(i),this.closeDialog(this.getDialogFromEvent(e))}handleUploadConfirm(e,t){return this.change&&e&&t?this.restApiService.saveFileUploadChangeEdit(this.change._number,e,t).then((e=>{e&&e.ok||ea(this,YL),this.resetUploadStatus(),this.closeDialog(this.openDialog),this.getChangeModel().navigateToChangeResetReload()})).catch((()=>{ea(this,YL),this.resetUploadStatus(),this.closeDialog(this.openDialog)})):(ea(this,"You must enter a path and data."),this.resetUploadStatus(),this.closeDialog(this.openDialog),Promise.resolve())}handleDeleteConfirm(e){const t=this.getDialogFromEvent(e);if(!this.change||!this.path)return ea(this,"You must enter a path."),void this.closeDialog(t);this.restApiService.deleteFileInChangeEdit(this.change._number,this.path).then((e=>{e&&e.ok&&(this.closeDialog(t),this.getChangeModel().navigateToChangeResetReload())}))}handleRestoreConfirm(e){const t=this.getDialogFromEvent(e);if(!this.change||!this.path)return ea(this,"You must enter a path."),void this.closeDialog(t);this.restApiService.restoreFileInChangeEdit(this.change._number,this.path).then((e=>{e&&e.ok&&(this.closeDialog(t),this.getChangeModel().navigateToChangeResetReload())}))}handleRenameConfirm(e){const t=this.getDialogFromEvent(e);if(!this.change||!this.path||!this.newPath)return ea(this,"You must enter a old path and a new path."),void this.closeDialog(t);this.restApiService.renameFileInChangeEdit(this.change._number,this.path,this.newPath).then((e=>{e&&e.ok&&(this.closeDialog(t),this.getChangeModel().navigateToChangeResetReload())}))}queryFiles(e){return ba(this.change,"this.change"),ba(this.patchNum,"this.patchNum"),this.restApiService.queryChangeFiles(this.change._number,this.patchNum,e,Ff).then((e=>{if(!e)throw new Error("Failed to retrieve files. Response not set.");return e.map((e=>({name:e})))}))}computeIsInvisible(e){return this.hiddenActions.includes(e)?"invisible":""}handleDragAndDropUpload(e){this.fileUploaded||(e.preventDefault(),e.stopPropagation(),this.dragDropArea.classList.remove("hover"),e.dataTransfer&&e.dataTransfer.files&&this.fileUpload(e.dataTransfer.files[0]))}handleFileUploadChange(e){const t=e.target;!this.fileUploaded&&t&&t instanceof HTMLInputElement&&t.files&&this.fileUpload(t.files[0])}async fileUpload(e){if(!e)return;let t=this.path;t||(t=e.name),this.fileUploaded=!0,this.fileName=t,this.fileSize=jR(e.size,!1),await this.updateComplete,this.dragDropArea?.classList.add("disabled");const i=new FileReader;i.onload=e=>{if(!e)return;const i=e.target.result;"string"==typeof i&&this.handleUploadConfirm(t,i)},i.readAsDataURL(e)}handleTextChanged(e){this.path=e.detail.value??""}async resetUploadStatus(){this.fileName="",this.fileSize="";const e=this.dragDropArea;e.classList.remove("disabled"),e.classList.remove("hover"),this.fileUploaded=!1,await this.updateComplete}};var JL;KL([Hc("#newPathInput")],XL.prototype,"newPathInput",void 0),KL([Hc("#modal")],XL.prototype,"modal",void 0),KL([Hc("#openDialog")],XL.prototype,"openDialog",void 0),KL([Hc("#deleteDialog")],XL.prototype,"deleteDialog",void 0),KL([Hc("#renameDialog")],XL.prototype,"renameDialog",void 0),KL([Hc("#restoreDialog")],XL.prototype,"restoreDialog",void 0),KL([Hc("#dragDropArea")],XL.prototype,"dragDropArea",void 0),KL([Hc("#fileUploadInput")],XL.prototype,"fileUploadInput",void 0),KL([Fc({type:Object})],XL.prototype,"change",void 0),KL([Fc({type:String})],XL.prototype,"patchNum",void 0),KL([Fc({type:Array})],XL.prototype,"hiddenActions",void 0),KL([Uc()],XL.prototype,"actions",void 0),KL([Uc()],XL.prototype,"path",void 0),KL([Uc()],XL.prototype,"newPath",void 0),KL([Uc()],XL.prototype,"fileName",void 0),KL([Uc()],XL.prototype,"fileSize",void 0),KL([Uc()],XL.prototype,"fileUploaded",void 0),XL=KL([Dc("gr-edit-controls")],XL),function(e){e.ALL="all",e.NONE="none",e.SOME="some"}(JL||(JL={}));var QL=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let ZL=class extends Ic{constructor(){super(),this.shownFileCount=0,this.getShortcutsService=yu(this,Bg),this.getConfigModel=yu(this,Qw),this.maxFilesForBulkActions=225,this.getUserModel=yu(this,jf),this.getNavigation=yu(this,gy),this.getChangeModel=yu(this,MT),zf(this,(()=>this.getUserModel().diffPreferences$),(e=>{e&&(this.diffPrefs=e)})),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.serverConfig=e})),zf(this,(()=>this.getChangeModel().patchNum$),(e=>this.patchNum=e)),zf(this,(()=>this.getChangeModel().basePatchNum$),(e=>this.basePatchNum=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e))}static get styles(){return[Nc,Sd`
        #diffPrefsContainer {
          display: flex;
        }
        .patchInfoOldPatchSet.patchInfo-header {
          background-color: var(--emphasis-color);
        }
        .patchInfo-header {
          align-items: center;
          display: flex;
          padding: var(--spacing-s) var(--spacing-l);
        }
        .patchInfo-left {
          align-items: baseline;
          display: flex;
        }
        .patchInfoContent {
          align-items: center;
          display: flex;
          flex-wrap: wrap;
        }
        .latestPatchContainer a {
          text-decoration: none;
        }
        .mobile {
          display: none;
        }
        .patchInfo-header .container {
          align-items: center;
          display: flex;
        }
        .downloadContainer,
        .uploadContainer {
          margin-right: 16px;
        }
        .uploadContainer.hide {
          display: none;
        }
        .rightControls {
          align-self: flex-end;
          margin: auto 0 auto auto;
          align-items: center;
          display: flex;
          flex-wrap: wrap;
          font-weight: var(--font-weight-normal);
          justify-content: flex-end;
        }
        #collapseBtn,
        .allExpanded #expandBtn {
          display: none;
        }
        .someExpanded #expandBtn {
          margin-right: 8px;
        }
        .someExpanded #collapseBtn,
        .allExpanded #collapseBtn {
          align-items: center;
          display: flex;
        }
        .rightControls gr-button,
        gr-patch-range-select {
          margin: 0 -4px;
        }
        .fileViewActions gr-button {
          margin: 0;
        }
        .fileViewActions {
          --gr-button-padding: 2px 4px;
        }
        .fileViewActions,
        .flexContainer {
          align-items: center;
          display: flex;
        }
        .label {
          font-weight: var(--font-weight-medium);
          margin-right: 24px;
        }
        gr-commit-info,
        gr-edit-controls {
          margin-right: -5px;
        }
        .fileViewActionsLabel {
          margin-right: var(--spacing-xs);
        }
        @media screen and (max-width: 50em) {
          .patchInfo-header .desktop {
            display: none;
          }
        }
      `]}render(){if(!this.change||!this.diffPrefs)return;const e=this.computeExpandedClass(this.filesExpanded);return dc`
      <div
        class=${th({"patchInfo-header":!0,patchInfoOldPatchSet:this.patchNum!==this.latestPatchNum})}
      >
        <div class="patchInfo-left">
          <div class="patchInfoContent">
            <gr-patch-range-select
              id="rangeSelect"
              @patch-range-change=${this.handlePatchChange}
            >
            </gr-patch-range-select>
            <span class="separator"></span>
            <gr-commit-info .commitInfo=${this.commitInfo}></gr-commit-info>
            ${this.renderLatestPatchContainer()}
          </div>
        </div>
        <div class="rightControls ${e}">
          ${eb(this.editMode,(()=>dc`
              <span class="flexContainer">
                <gr-edit-controls
                  id="editControls"
                  .patchNum=${this.patchNum}
                  .change=${this.change}
                ></gr-edit-controls>
                <span class="separator"></span>
              </span>
            `))}
          ${eb(this.loggedIn&&this.diffPrefs,(()=>dc`
              <div class="fileViewActions">
                <span class="fileViewActionsLabel">Diff view:</span>
                <gr-diff-mode-selector
                  id="modeSelect"
                  .saveOnChange=${!0}
                ></gr-diff-mode-selector>
                ${this.renderDiffPrefsContainer()}
                <span class="separator"></span>
              </div>
            `))}
          <span class="downloadContainer desktop">
            <gr-tooltip-content
              has-tooltip
              title=${this.createTitle(pu.OPEN_DOWNLOAD_DIALOG,hu.ACTIONS)}
            >
              <gr-button link class="download" @click=${this.handleDownloadTap}
                >Download</gr-button
              >
            </gr-tooltip-content>
          </span>
          ${eb(this.fileListActionsVisible(this.shownFileCount,this.maxFilesForBulkActions),(()=>dc` <gr-tooltip-content
                has-tooltip
                title=${this.createTitle(pu.TOGGLE_ALL_INLINE_DIFFS,hu.FILE_LIST)}
              >
                <gr-button id="expandBtn" link @click=${this.expandAllDiffs}
                  >Expand All</gr-button
                >
              </gr-tooltip-content>
              <gr-tooltip-content
                has-tooltip
                title=${this.createTitle(pu.TOGGLE_ALL_INLINE_DIFFS,hu.FILE_LIST)}
              >
                <gr-button id="collapseBtn" link @click=${this.collapseAllDiffs}
                  >Collapse All</gr-button
                >
              </gr-tooltip-content>`),(()=>dc`
              <div class="warning">
                Bulk actions disabled because there are too many files.
              </div>
            `))}
        </div>
      </div>
    `}renderLatestPatchContainer(){return this.editMode||this.patchNum===this.latestPatchNum?uc:dc`
      <span class="container latestPatchContainer">
        <span class="separator"></span>
        <a href=${Vw(this.changeUrl)}>Go to latest patch set</a>
      </span>
    `}renderDiffPrefsContainer(){return this.editMode?uc:dc`
      <span id="diffPrefsContainer">
        <gr-tooltip-content has-tooltip title="Diff preferences">
          <gr-button
            link
            class="prefsButton desktop"
            @click=${this.handleDiffPrefsTap}
            ><gr-icon icon="settings" filled></gr-icon
          ></gr-button>
        </gr-tooltip-content>
      </span>
    `}expandAllDiffs(){Jn(this,"expand-diffs",{})}collapseAllDiffs(){Jn(this,"collapse-diffs",{})}computeExpandedClass(e){const t=[];return e===JL.ALL?t.push("allExpanded"):e===JL.SOME&&t.push("someExpanded"),t.join(" ")}fileListActionsVisible(e,t){return e<=t}handlePatchChange(e){const{basePatchNum:t,patchNum:i}=e.detail;t===this.basePatchNum&&i===this.patchNum||!this.change||this.getNavigation().setUrl(WC({change:this.change,patchNum:i,basePatchNum:t}))}handleDiffPrefsTap(e){e.preventDefault(),Jn(this,"open-diff-prefs",{})}handleDownloadTap(e){e.preventDefault(),e.stopPropagation(),Zn(this,"open-download-dialog",{})}createTitle(e,t){return this.getShortcutsService().createTitle(e,t)}};QL([Fc({type:Object})],ZL.prototype,"account",void 0),QL([Fc({type:Object})],ZL.prototype,"change",void 0),QL([Fc({type:String})],ZL.prototype,"changeUrl",void 0),QL([Fc({type:Object})],ZL.prototype,"commitInfo",void 0),QL([Fc({type:Boolean})],ZL.prototype,"editMode",void 0),QL([Fc({type:Boolean})],ZL.prototype,"loggedIn",void 0),QL([Fc({type:Number})],ZL.prototype,"shownFileCount",void 0),QL([Fc({type:String})],ZL.prototype,"filesExpanded",void 0),QL([Uc()],ZL.prototype,"latestPatchNum",void 0),QL([Uc()],ZL.prototype,"patchNum",void 0),QL([Uc()],ZL.prototype,"basePatchNum",void 0),QL([Uc()],ZL.prototype,"diffPrefs",void 0),QL([Uc()],ZL.prototype,"serverConfig",void 0),QL([Hc("#modeSelect")],ZL.prototype,"modeSelect",void 0),QL([Hc("#expandBtn")],ZL.prototype,"expandBtn",void 0),QL([Hc("#collapseBtn")],ZL.prototype,"collapseBtn",void 0),ZL=QL([Dc("gr-file-list-header")],ZL);const eM=document.createElement("template"),tM=Sd`
  gr-icon.error {
    color: var(--error-foreground);
  }
  gr-icon.warning {
    color: var(--warning-foreground);
  }
  gr-icon.info {
    color: var(--info-foreground);
  }
  gr-icon.check_circle {
    color: var(--success-foreground);
  }
`;eM.innerHTML=`<dom-module id="gr-checks-styles">\n  <template>\n    <style>\n    ${tM.cssText}\n    </style>\n  </template>\n</dom-module>`,document.head.appendChild(eM.content);var iM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const rM=ix(Ic);let oM=class extends rM{static get styles(){return[Qb,tM,rM.styles||[],Sd`
        #container {
          min-width: 356px;
          padding: var(--spacing-xl) 0 var(--spacing-m) 0;
        }
        .row {
          display: flex;
          margin-top: var(--spacing-s);
        }
        .attempts.row {
          flex-wrap: wrap;
        }
        .chipRow {
          display: flex;
          margin-top: var(--spacing-s);
        }
        .chip {
          background: var(--gray-background);
          color: var(--gray-foreground);
          border-radius: 20px;
          padding: var(--spacing-xs) var(--spacing-m) var(--spacing-xs)
            var(--spacing-s);
        }
        .title {
          color: var(--deemphasized-text-color);
          margin-right: var(--spacing-m);
        }
        div.section {
          margin: 0 var(--spacing-xl) var(--spacing-m) var(--spacing-xl);
          display: flex;
        }
        div.sectionIcon {
          flex: 0 0 30px;
        }
        div.chip gr-icon {
          font-size: 16px;
          /* Positioning of a 16px icon in the middle of a 20px line. */
          position: relative;
          top: 2px;
        }
        div.sectionIcon gr-icon {
          position: relative;
          top: 2px;
          font-size: 20px;
        }
        div.sectionIcon gr-icon.small {
          position: relative;
          top: 6px;
          font-size: 16px;
        }
        div.sectionContent gr-icon.link {
          color: var(--link-color);
        }
        div.sectionContent .attemptIcon gr-icon,
        div.sectionContent gr-icon.small {
          font-size: 16px;
          margin-right: var(--spacing-s);
          /* Positioning of a 16px icon in the middle of a 20px line. */
          position: relative;
          top: 2px;
        }
        div.sectionContent .attemptIcon gr-icon {
          margin-right: 0;
        }
        .attemptIcon,
        .attemptNumber {
          margin-right: var(--spacing-s);
          color: var(--deemphasized-text-color);
          text-align: center;
          width: 24px;
          font-size: var(--font-size-small);
        }
        div.action {
          border-top: 1px solid var(--border-color);
          margin-top: var(--spacing-m);
          padding: var(--spacing-m) var(--spacing-xl) 0;
        }
      `]}render(){if(!this.run)return"";const e=this.computeIcon(),t=this.computeChipIcon();return dc`
      <div id="container" role="tooltip" tabindex="-1">
        <div class="section">
          <div
            ?hidden=${!this.run||this.run.status===lI.RUNNABLE}
            class="chipRow"
          >
            <div class="chip">
              <gr-icon
                icon=${t.name}
                ?filled=${!!t.filled}
              ></gr-icon>
              <span>${this.run.status}</span>
            </div>
          </div>
        </div>
        <div class="section">
          <div class="sectionIcon" ?hidden=${0===e.name.length}>
            <gr-icon
              icon=${e.name}
              class=${e.name}
              ?filled=${!!e.filled}
            ></gr-icon>
          </div>
          <div class="sectionContent">
            <h3 class="name heading-3">
              <span>${this.run.checkName}</span>
              ${eb(this.attempt,(()=>dc`(Attempt ${this.attempt})`))}
            </h3>
          </div>
        </div>
        ${this.renderStatusSection()} ${this.renderAttemptSection()}
        ${this.renderTimestampSection()} ${this.renderDescriptionSection()}
        ${this.renderActions()}
      </div>
    `}renderStatusSection(){if(this.run&&(this.run.statusLink||this.run.statusDescription))return dc`
      <div class="section">
        <div class="sectionIcon">
          <gr-icon icon="info" class="small"></gr-icon>
        </div>
        <div class="sectionContent">
          ${this.run.statusLink?dc` <div class="row">
                <div class="title">Status</div>
                <div>
                  <a
                    href=${this.run.statusLink}
                    target="_blank"
                    rel="noopener noreferrer"
                    ><gr-icon
                      icon="open_in_new"
                      aria-label="external link to check status"
                      class="small link"
                    ></gr-icon
                    >${this.computeHostName(this.run.statusLink)}
                  </a>
                </div>
              </div>`:""}
          ${this.run.statusDescription?dc` <div class="row">
                <div class="title">Message</div>
                <div>${this.run.statusDescription}</div>
              </div>`:""}
        </div>
      </div>
    `}renderAttemptSection(){if(this.attempt)return;if(this.hideAttempts())return;const e=this.computeAttempts();return dc`
      <div class="section">
        <div class="sectionIcon">
          <gr-icon icon="arrow_forward" class="small"></gr-icon>
        </div>
        <div class="sectionContent">
          <div class="attempts row">
            <div class="title">Attempt</div>
            ${e.map((e=>this.renderAttempt(e)))}
          </div>
        </div>
      </div>
    `}renderAttempt(e){const t=e.attempt,i=e.icon??{name:""};if(void 0===t||"number"==typeof t)return dc`
      <div>
        <div class="attemptIcon">
          <gr-icon
            class=${i.name}
            icon=${i.name}
            ?filled=${!!i.filled}
          >
          </gr-icon>
        </div>
        <div class="attemptNumber">${Og(t)}</div>
      </div>
    `}renderTimestampSection(){if(!this.run||!this.run.startedTimestamp&&!this.run.scheduledTimestamp&&!this.run.finishedTimestamp)return;const e=this.run.scheduledTimestamp&&!this.run.startedTimestamp?dc`<div class="row">
            <div class="title">Scheduled</div>
            <div>${Km(this.run.scheduledTimestamp)}</div>
          </div>`:"",t=this.run.startedTimestamp?dc`<div class="row">
          <div class="title">Started</div>
          <div>${Km(this.run.startedTimestamp)}</div>
        </div>`:"",i=this.run.finishedTimestamp&&this.run.status===lI.COMPLETED?dc`<div class="row">
            <div class="title">Ended</div>
            <div>${Km(this.run.finishedTimestamp)}</div>
          </div>`:"",r=this.run.startedTimestamp&&this.run.finishedTimestamp&&this.run.status===lI.COMPLETED?dc`<div class="row">
            <div class="title">Completion</div>
            <div>
              ${Ym(this.run.startedTimestamp,this.run.finishedTimestamp)}
            </div>
          </div>`:"",o=this.run.finishedTimestamp&&this.run.status===lI.RUNNING?dc`<div class="row">
            <div class="title">ETA</div>
            <div>${Ym(new Date,this.run.finishedTimestamp)}</div>
          </div>`:"";return dc`
      <div class="section">
        <div class="sectionIcon">
          <gr-icon icon="schedule" class="small"></gr-icon>
        </div>
        <div class="sectionContent">
          ${e} ${t} ${i} ${r} ${o}
        </div>
      </div>
    `}renderDescriptionSection(){if(this.run&&(this.run.checkLink||this.run.checkDescription))return dc`
      <div class="section">
        <div class="sectionIcon">
          <gr-icon icon="link" class="small"></gr-icon>
        </div>
        <div class="sectionContent">
          ${this.run.checkDescription?dc` <div class="row">
                <div class="title">Description</div>
                <gr-formatted-text
                  class="message"
                  .markdown=${!0}
                  .content=${this.run.checkDescription}
                ></gr-formatted-text>
              </div>`:""}
          ${this.run.checkLink?dc` <div class="row">
                <div class="title">Documentation</div>
                <div>
                  <a
                    href=${this.run.checkLink}
                    target="_blank"
                    rel="noopener noreferrer"
                    ><gr-icon
                      icon="open_in_new"
                      aria-label="external link to check documentation"
                      class="small link"
                    ></gr-icon
                    >${this.computeHostName(this.run.checkLink)}
                  </a>
                </div>
              </div>`:""}
        </div>
      </div>
    `}renderActions(){return CI(this.run).map((e=>dc`
          <div class="action">
            <gr-checks-action
              context="hovercard"
              .eventTarget=${this._target}
              .runOrResult=${this.run}
              .action=${e}
            ></gr-checks-action>
          </div>
        `))}computeIcon(){return this.run?this.run.worstCategory?wI(this.run.worstCategory):this.run.status===lI.COMPLETED?wI(lI.COMPLETED):{name:""}:{name:""}}computeAttempts(){const e=this.run?.attemptDetails??[];return[...e.length>7?[{icon:{name:"more_horiz"},attempt:void 0}]:[],...e.slice(-7)]}computeChipIcon(){return this.run?.status===lI.COMPLETED?{name:"check"}:this.run?.status===lI.RUNNING?wI(lI.RUNNING):this.run?.status===lI.SCHEDULED?wI(lI.SCHEDULED):{name:""}}computeHostName(e){return e?new URL(e).hostname:""}hideAttempts(){const e=this.run?.attemptDetails?.length;return void 0===e||e<2}};iM([Fc({type:Object})],oM.prototype,"run",void 0),iM([Fc({type:Number})],oM.prototype,"attempt",void 0),oM=iM([Dc("gr-hovercard-run")],oM);var sM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let nM=class extends Ic{static get styles(){return[Sd`
        .attempt {
          display: inline-block;
          height: var(--line-height-normal);
          vertical-align: top;
          font-size: var(--font-size-small);
          position: relative;
        }
        .attempt .box,
        .attempt .angle {
          box-sizing: border-box;
          height: calc(var(--line-height-normal) - 2px);
          line-height: calc(var(--line-height-normal) - 2px);
          border-radius: 2px;
        }
        .attempt .box {
          margin-left: 2px;
          margin-bottom: 2px;
          border: 1px solid var(--deemphasized-text-color);
          padding: 0 var(--spacing-s);
        }
        .attempt .angle {
          position: absolute;
          top: 2px;
          /* The text in the .angle div just ensures the correct width. */
          color: transparent;
          border-left: 1px solid var(--deemphasized-text-color);
          border-bottom: 1px solid var(--deemphasized-text-color);
          /* 1px for the border of the .box div. */
          padding: 0 calc(var(--spacing-s) + 1px);
        }
      `]}render(){if(!this.run)return;if(this.run.isSingleAttempt)return;if(!this.run.attempt)return;const e=Og(this.run.attempt);return dc`
      <span class="attempt">
        <div class="box">${e}</div>
        <div class="angle">${e}</div>
      </span>
    `}};sM([Fc({attribute:!1})],nM.prototype,"run",void 0),nM=sM([Dc("gr-checks-attempt")],nM);var aM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let lM=class extends Ic{constructor(){super(),this.previewLoaded=!1,this.applyingFix=!1,this.isChangeMerged=!1,this.isChangeAbandoned=!1,this.loggedIn=!1,this.selectedFixIdx=0,this.getChangeModel=yu(this,MT),this.getUserModel=yu(this,jf),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getChangeModel().repo$),(e=>this.repo=e)),zf(this,(()=>this.getChangeModel().status$),(e=>this.isChangeMerged=e===Nu.MERGED)),zf(this,(()=>this.getChangeModel().status$),(e=>this.isChangeAbandoned=e===Nu.ABANDONED)),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.loggedIn=e))}static get styles(){return[Sd`
        :host {
          display: block;
        }
        .header {
          background-color: var(--background-color-primary);
          border: 1px solid var(--border-color);
          border-bottom: none;
          padding: var(--spacing-xs) var(--spacing-xl);
          display: flex;
          align-items: center;
        }
        .header .title {
          flex: 1;
        }
        .fix-picker {
          display: flex;
          align-items: center;
          gap: var(--spacing-xs);
        }
        .fix-picker gr-button {
          display: flex;
          align-items: center;
        }
        .loading {
          border: 1px solid var(--border-color);
          padding: var(--spacing-xl);
        }
      `]}render(){return 0===(this.fixSuggestionInfos??[]).length?uc:dc`${this.renderHeader()}${this.renderDiff()}`}renderHeader(){const e=this.fixSuggestionInfos?.length??0;return dc`
      <div class="header">
        <div class="title">
          <span>Attached Fix</span>
          ${e>1?dc`
                <div class="fix-picker">
                  ${this.selectedFixIdx+1} of ${e}
                  <gr-button
                    id="prevFix"
                    link
                    @click=${this.onPrevFixClick}
                    ?disabled=${0===this.selectedFixIdx}
                  >
                    <gr-icon icon="chevron_left"></gr-icon>
                  </gr-button>
                  <gr-button
                    id="nextFix"
                    link
                    @click=${this.onNextFixClick}
                    ?disabled=${this.selectedFixIdx===e-1}
                  >
                    <gr-icon icon="chevron_right"></gr-icon>
                  </gr-button>
                </div>
              `:uc}
        </div>
        <div>
          <gr-button
            class="showFix"
            secondary
            flatten
            .disabled=${!this.previewLoaded}
            @click=${this.showFix}
          >
            Show Fix Side-By-Side
          </gr-button>
          <gr-button
            class="applyFix"
            primary
            flatten
            .loading=${this.applyingFix}
            .disabled=${this.isApplyEditDisabled()}
            @click=${this.applyFix}
            .title=${this.computeApplyFixTooltip()}
          >
            Apply Fix
          </gr-button>
        </div>
      </div>
    `}renderDiff(){const e=this.fixSuggestionInfos?.[this.selectedFixIdx];if(e)return dc`
      <gr-suggestion-diff-preview
        .fixSuggestionInfo=${e}
        .patchSet=${this.patchSet}
        .codeText=${"Loading fix preview ..."}
        @preview-loaded=${()=>this.previewLoaded=!0}
      ></gr-suggestion-diff-preview>
    `}showFix(){this.patchSet&&0!==(this.fixSuggestionInfos??[]).length&&Jn(this,"open-fix-preview",{patchNum:this.patchSet,fixSuggestions:this.fixSuggestionInfos??[],onCloseFixPreviewCallbacks:[]})}async applyFix(){const e=this.changeNum,t=this.patchSet;if(e&&t&&0!==(this.fixSuggestionInfos??[]).length){this.applyingFix=!0;try{await(this.suggestionDiffPreview?.applyFix())}finally{this.applyingFix=!1}}}isApplyEditDisabled(){return!(void 0!==this.patchSet&&!this.isChangeMerged&&!this.isChangeAbandoned&&this.loggedIn&&this.previewLoaded)}computeApplyFixTooltip(){return void 0===this.patchSet?"":this.isChangeMerged?"Change is already merged":this.isChangeAbandoned?"Change is abandoned":this.previewLoaded?this.loggedIn?"":"You must be logged in to apply a fix":"Fix is still loading ..."}onPrevFixClick(e){e&&e.stopPropagation(),this.selectedFixIdx>=1&&(this.selectedFixIdx-=1,this.previewLoaded=!1)}onNextFixClick(e){e&&e.stopPropagation(),this.fixSuggestionInfos&&this.selectedFixIdx<this.fixSuggestionInfos.length-1&&(this.selectedFixIdx+=1,this.previewLoaded=!1)}};aM([Hc("gr-suggestion-diff-preview")],lM.prototype,"suggestionDiffPreview",void 0),aM([Fc({type:Array})],lM.prototype,"fixSuggestionInfos",void 0),aM([Fc({type:Number})],lM.prototype,"patchSet",void 0),aM([Uc()],lM.prototype,"repo",void 0),aM([Uc()],lM.prototype,"changeNum",void 0),aM([Uc()],lM.prototype,"latestPatchNum",void 0),aM([Uc()],lM.prototype,"previewLoaded",void 0),aM([Uc()],lM.prototype,"applyingFix",void 0),aM([Uc()],lM.prototype,"isChangeMerged",void 0),aM([Uc()],lM.prototype,"isChangeAbandoned",void 0),aM([Uc()],lM.prototype,"loggedIn",void 0),aM([Uc()],lM.prototype,"selectedFixIdx",void 0),lM=aM([Dc("gr-checks-fix-preview")],lM);var dM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let cM=class extends Ic{constructor(){super(),this.isExpanded=!1,this.isExpandable=!1,this.shouldRender=!1,this.selectedAttempt=OI,this.isOwner=!1,this.suggestionLoading=!1,this.getChangeModel=yu(this,MT),this.getChecksModel=yu(this,sP),this.reporting=Xn().reportingService,this.getSuggestionsService=yu(this,UT),this.addEventListener("get-ai-fix-for-check-result",(()=>{this.handleAIFix()})),zf(this,(()=>this.getChangeModel().labels$),(e=>this.labels=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getChecksModel().checksSelectedAttemptNumber$),(e=>this.selectedAttempt=e)),zf(this,(()=>this.getChangeModel().isOwner$),(e=>this.isOwner=e)),zf(this,(()=>this.getSuggestionsService().suggestionsServiceUpdated$),(e=>{e&&this.requestUpdate()}))}static get styles(){return[Nc,Sd`
        :host {
          display: contents;
        }
        :host([isexpandable]) {
          cursor: pointer;
        }
        gr-result-expanded {
          cursor: default;
        }
        tr.container {
          border-top: 1px solid var(--border-color);
        }
        a.link {
          margin-right: var(--spacing-s);
        }
        gr-icon.link {
          color: var(--link-color);
        }
        td.nameCol div.flex {
          display: flex;
        }
        td.nameCol .name {
          overflow: hidden;
          text-overflow: ellipsis;
          margin-right: var(--spacing-s);
          outline-offset: var(--spacing-xs);
        }
        td.nameCol .space {
          flex-grow: 1;
        }
        td.nameCol gr-checks-action {
          display: none;
        }
        tr:focus-within td.nameCol gr-checks-action,
        tr:hover td.nameCol gr-checks-action {
          display: inline-block;
          /* The button should fit into the 20px line-height. The negative
             margin provides the extra space needed for the vertical padding.
             Alternatively we could have set the vertical padding to 0, but
             that would not have been a nice click target. */
          margin: calc(0px - var(--spacing-s)) 0px;
          margin-left: var(--spacing-s);
        }
        td {
          white-space: nowrap;
          padding: var(--spacing-s);
        }
        td.expandedCol,
        td.nameCol {
          padding-left: var(--spacing-l);
        }
        td.expandedCol,
        td.expanderCol {
          padding-right: var(--spacing-l);
        }
        td .summary-cell {
          display: flex;
        }
        td .summary-cell .summary {
          font-weight: var(--font-weight-medium);
          flex-shrink: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          margin-right: var(--spacing-s);
        }
        td .summary-cell .message {
          flex-grow: 1;
          /* Looks a bit stupid, but the idea is that .message shrinks first,
             and only when that has shrunken to 0, then .summary should also
             start shrinking (substantially). */
          flex-shrink: 1000000;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        tr.container:hover {
          background: var(--hover-background-color);
        }
        tr.container:focus-within {
          background: var(--selection-background-color);
        }
        tr.container td .summary-cell .links,
        tr.container td .summary-cell .actions,
        tr.container.collapsed:focus-within td .summary-cell .links,
        tr.container.collapsed:focus-within td .summary-cell .actions,
        tr.container.collapsed:hover td .summary-cell .links,
        tr.container.collapsed:hover td .summary-cell .actions,
        :host(.dropdown-open) tr td .summary-cell .links,
        :host(.dropdown-open) tr td .summary-cell .actions {
          display: inline-block;
          margin-left: var(--spacing-s);
        }
        /* actions-shown-on-collapsed are shown only when .actions is hidden
          and vice versa. */
        tr.container td .summary-cell .actions-shown-on-collapsed,
        tr.container.collapsed:focus-within
          td
          .summary-cell
          .actions-shown-on-collapsed,
        tr.container.collapsed:hover
          td
          .summary-cell
          .actions-shown-on-collapsed,
        :host(.dropdown-open) tr td .summary-cell .actions-shown-on-collapsed {
          display: none;
        }
        tr.container.collapsed td .summary-cell .message {
          color: var(--deemphasized-text-color);
        }
        tr.container.collapsed td .summary-cell .links,
        tr.container.collapsed td .summary-cell .actions {
          display: none;
        }
        tr.container.collapsed td .summary-cell .actions-shown-on-collapsed {
          display: inline-block;
          margin-left: var(--spacing-s);
        }
        tr.detailsRow.collapsed {
          display: none;
        }
        td .summary-cell .tags .tag {
          color: var(--primary-text-color);
          display: inline-block;
          border-radius: 20px;
          background-color: var(--tag-background);
          padding: 0 var(--spacing-m);
          margin-left: var(--spacing-s);
          cursor: pointer;
        }
        td .summary-cell .tag.gray {
          background-color: var(--tag-gray);
        }
        td .summary-cell .tag.yellow {
          background-color: var(--tag-yellow);
        }
        td .summary-cell .tag.pink {
          background-color: var(--tag-pink);
        }
        td .summary-cell .tag.purple {
          background-color: var(--tag-purple);
        }
        td .summary-cell .tag.cyan {
          background-color: var(--tag-cyan);
        }
        td .summary-cell .tag.brown {
          background-color: var(--tag-brown);
        }
        .actions-shown-on-collapsed gr-checks-action,
        .actions gr-checks-action,
        .actions gr-dropdown {
          /* Fitting a 28px button into 20px line-height. */
          margin: -4px 0;
          vertical-align: top;
        }
        #moreActions gr-icon {
          color: var(--link-color);
        }
        #moreMessage {
          display: none;
        }
        td .summary-cell .label {
          margin-left: var(--spacing-s);
          border-radius: var(--border-radius);
          color: var(--vote-text-color);
          display: inline-block;
          padding: 0 var(--spacing-s);
          text-align: center;
        }
        td .summary-cell .label.neutral {
          background-color: var(--vote-color-neutral);
        }
        td .summary-cell .label.recommended,
        td .summary-cell .label.disliked {
          line-height: calc(var(--line-height-normal) - 2px);
          color: var(--chip-color);
        }
        td .summary-cell .label.recommended {
          background-color: var(--vote-color-recommended);
          border: 1px solid var(--vote-outline-recommended);
        }
        td .summary-cell .label.disliked {
          background-color: var(--vote-color-disliked);
          border: 1px solid var(--vote-outline-disliked);
        }
        td .summary-cell .label.approved {
          background-color: var(--vote-color-approved);
        }
        td .summary-cell .label.rejected {
          background-color: var(--vote-color-rejected);
        }
      `]}willUpdate(e){e.has("result")&&(this.isExpandable=VI(this.result))}focus(){this.nameEl&&this.nameEl.focus()}firstUpdated(){const e=this.shadowRoot?.querySelector(".container");ba(e,'"Loading" element'),Ln(e,(()=>{this.shouldRender=!0}),200)}render(){return this.result?this.shouldRender?dc`
      <tr class=${th({container:!0,collapsed:!this.isExpanded})}>
        <td class="nameCol" @click=${this.toggleExpandedClick}>
          <div class="flex">
            <gr-hovercard-run .run=${this.result}></gr-hovercard-run>
            <div
              class="name"
              role="button"
              tabindex="0"
              @click=${this.toggleExpandedClick}
              @keydown=${this.toggleExpandedPress}
            >
              ${this.result.checkName}
            </div>
            ${this.renderAttempt()}
            <div class="space"></div>
          </div>
        </td>
        <td class="summaryCol">
          <div class="summary-cell">
            ${this.renderLink(GI(this.result))}
            ${this.renderSummary(this.result.summary)}
            <div class="message" @click=${this.toggleExpandedClick}>
              ${this.isExpanded?"":this.result.message}
            </div>
            ${this.renderLinks()} ${this.renderActions()}
            <div class="tags">
              ${(this.result.tags??[]).map((e=>this.renderTag(e)))}
            </div>
            ${this.renderLabel()}
          </div>
        </td>
        <td class="expanderCol" @click=${this.toggleExpandedClick}>
          <div
            class="show-hide"
            role="switch"
            tabindex="0"
            ?hidden=${!this.isExpandable}
            aria-checked=${this.isExpanded?"true":"false"}
            aria-label=${this.isExpanded?"Collapse result row":"Expand result row"}
            @keydown=${this.toggleExpandedPress}
          >
            <gr-icon
              icon=${this.isExpanded?"expand_less":"expand_more"}
            ></gr-icon>
          </div>
        </td>
      </tr>
      <tr class=${th({detailsRow:!0,collapsed:!this.isExpanded})}>
        <td class="expandedCol" colspan="3">${this.renderExpanded()}</td>
      </tr>
    `:dc`
        <tr class="container">
          <td class="nameCol">
            <div><span class="loading">Loading...</span></div>
          </td>
          <td class="summaryCol"></td>
          <td class="expanderCol"></td>
        </tr>
      `:""}renderAttempt(){return this.selectedAttempt!==NI?uc:dc`<gr-checks-attempt .run=${this.result}></gr-checks-attempt>`}renderExpanded(){if(this.isExpanded)return dc`<gr-result-expanded .result=${this.result}></gr-result-expanded>
      ${this.renderSuggestionPreview()}`}toggleExpandedClick(e){this.isExpandable&&(e.preventDefault(),e.stopPropagation(),this.toggleExpanded())}tagClick(e,t){e.preventDefault(),e.stopPropagation(),this.reporting.reportInteraction(ga.CHECKS_TAG_CLICKED,{tagName:t,checkName:this.result?.checkName}),Jn(this,"checks-results-filter",{filterRegExp:t})}toggleExpandedPress(e){this.isExpandable&&(Gn(e)||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),this.toggleExpanded()))}toggleExpanded(e){this.isExpandable&&(this.isExpanded=void 0===e?!this.isExpanded:e,this.reporting.reportInteraction(ga.CHECKS_RESULT_ROW_TOGGLE,{expanded:this.isExpanded,checkName:this.result?.checkName}))}renderSummary(e){return e=e??"",dc`
      <!-- The &nbsp; is for being able to shrink a tiny amount without
       the text itself getting shrunk with an ellipsis. -->
      <div class="summary" @click=${this.toggleExpandedClick} title=${e}>
        ${e}&nbsp;
      </div>
    `}renderLabel(){const e=this.result?.category;if(e!==dI.ERROR&&e!==dI.WARNING)return;const t=this.result?.labelName;if(!t)return;if(!this.result?.isLatestAttempt)return;if(this.result.patchset!==this.latestPatchNum)return;const i=this.labels?.[t],r=lv(i).toLowerCase(),o=av(i);if(0===o)return;const s=hv(o);return dc`
      <gr-tooltip-content
        has-tooltip
        ?position-below=${!0}
        title="The check result has (probably) influenced this label vote."
      >
        <div class="label ${r}">
          <span>${t} ${s}</span>
        </div>
      </gr-tooltip-content>
    `}renderLinks(){const e=zI(this.result).filter(((e,t,i)=>i.findIndex((t=>e.icon===t.icon))===t)).slice(0,4);if(0!==e.length)return dc`<div class="links">
      ${e.map((e=>this.renderLink(e)))}
    </div>`}renderLink(e){if(this.isExpanded)return;if(!e)return;const t=e.tooltip??gI(e.icon),i=uI(e.icon);return dc`<gr-tooltip-content
      has-tooltip
      ?position-below=${!0}
      title=${t}
    >
      <a
        href=${e.url}
        class="link"
        target="_blank"
        rel="noopener noreferrer"
      >
        <gr-icon
          icon=${i.name}
          ?filled=${!!i.filled}
          aria-label="external link to details"
          class="link"
        ></gr-icon>
      </a>
    </gr-tooltip-content>`}renderActions(){const e=[...this.result?.actions??[]].filter((e=>e.name!==nI&&e.name!==aI));let t,i;var r;if(this.isExpanded||(t=fI(this,this.result),t&&e.unshift(t)),this.getSuggestionsService()?.isGeneratedSuggestedFixEnabled(this.result?.codePointers?.[0]?.path)&&this.isOwner&&!this.result?.fixes?.length&&0!==this.result?.codePointers?.[0]?.range.start_line&&0!==this.result?.codePointers?.[0]?.range.end_line&&this.result?.category!==dI.SUCCESS&&this.result?.category!==dI.INFO&&!t&&(r=this,i={name:"Get AI Fix",callback:()=>{Jn(r,"get-ai-fix-for-check-result",{})}},i&&e.unshift(i)),0===e.length)return;const o=e.slice(2).map((e=>({...e,id:e.name}))),s=o.filter((e=>e.disabled)).map((e=>e.id));return dc` ${eb(t||i,(()=>dc`<div class="actions-shown-on-collapsed">
            ${this.renderAction(t||i)}
          </div> `))}
      <div class="actions">
        ${this.renderAction(e[0])} ${this.renderAction(e[1])}
        <gr-dropdown
          id="moreActions"
          link=""
          vertical-offset="32"
          horizontal-align="right"
          @tap-item=${this.handleAction}
          @opened-changed=${e=>this.classList.toggle("dropdown-open",e.detail.value)}
          ?hidden=${0===o.length}
          .items=${o}
          .disabledIds=${s}
        >
          <gr-icon icon="more_vert" aria-labelledby="moreMessage"></gr-icon>
          <span id="moreMessage">More</span>
        </gr-dropdown>
      </div>`}handleAction(e){this.getChecksModel().triggerAction(e.detail,this.result,"result-row-dropdown")}renderAction(e){if(e)return dc`<gr-checks-action
      .runOrResult=${this.result}
      context="result-row"
      .action=${e}
    ></gr-checks-action>`}renderTag(e){return dc`<gr-tooltip-content
      has-tooltip
      ?position-below=${!0}
      title=${e.tooltip??"A category tag for this check result. Click to filter."}
    >
      <button
        class="tag ${e.color}"
        @click=${t=>this.tagClick(t,e.name)}
      >
        <span>${e.name}</span>
      </button>
    </gr-tooltip-content>`}renderSuggestionPreview(){return this.suggestion?dc`<gr-checks-fix-preview
      .fixSuggestionInfos=${[this.suggestion]}
      .patchSet=${this.result?.patchset}
    ></gr-checks-fix-preview>`:uc}async handleAIFix(){const e=this.result?.codePointers?.[0];if(!this.result||!this.result.message||!e)return;let t;this.suggestionLoading=!0;try{t=await this.getSuggestionsService().generateSuggestedFix({prompt:this.result.message,patchsetNumber:this.result.patchset,filePath:e.path,range:e.range,reportSource:BT.GET_AI_FIX_FOR_CHECK})}finally{this.suggestionLoading=!1}t?(t.description=BT.GET_AI_FIX_FOR_CHECK+" "+t.description,this.suggestion=t,this.toggleExpanded(!0)):ea(this,"No suitable AI fix could be found")}};dM([Hc("td.nameCol div.name")],cM.prototype,"nameEl",void 0),dM([Fc({attribute:!1})],cM.prototype,"result",void 0),dM([Uc()],cM.prototype,"isExpanded",void 0),dM([Fc({type:Boolean,reflect:!0})],cM.prototype,"isExpandable",void 0),dM([Uc()],cM.prototype,"shouldRender",void 0),dM([Uc()],cM.prototype,"labels",void 0),dM([Uc()],cM.prototype,"latestPatchNum",void 0),dM([Uc()],cM.prototype,"selectedAttempt",void 0),dM([Uc()],cM.prototype,"isOwner",void 0),dM([Uc()],cM.prototype,"suggestionLoading",void 0),dM([Uc()],cM.prototype,"suggestion",void 0),cM=dM([Dc("gr-result-row")],cM);let hM=class extends Ic{constructor(){super(...arguments),this.hideCodePointers=!1,this.notUsefulLabel="Was this helpful?",this.getChangeModel=yu(this,MT),this.getViewModel=yu(this,XC)}static get styles(){return[Nc,Sd`
        .links {
          white-space: normal;
        }
        .links a {
          display: inline-block;
          margin-right: var(--spacing-xl);
        }
        .links a gr-icon {
          margin-right: var(--spacing-xs);
        }
        .message {
          padding: var(--spacing-m) 0;
        }
        gr-checks-fix-preview {
          margin: var(--spacing-l) 0;
          max-width: 800px;
        }
        .useful {
          display: flex;
          justify-content: flex-end;
          align-items: center;
          margin: var(--spacing-s) 0;
        }
        .useful .title {
          margin-right: var(--spacing-s);
        }
        .useful gr-checks-action {
          display: block;
        }
      `]}render(){return this.result?dc`
      ${this.renderFirstPrimaryLink()} ${this.renderOtherPrimaryLinks()}
      ${this.renderSecondaryLinks()} ${this.renderCodePointers()}
      <gr-endpoint-decorator
        name="check-result-expanded"
        .targetPlugin=${this.result.pluginName}
      >
        <gr-endpoint-param name="run" .value=${this.result}></gr-endpoint-param>
        <gr-endpoint-param
          name="result"
          .value=${this.result}
        ></gr-endpoint-param>
        <gr-formatted-text
          class="message"
          .markdown=${!0}
          .content=${this.result.message??""}
        ></gr-formatted-text>
      </gr-endpoint-decorator>
      ${this.renderFix()} ${this.renderNotUseful()}
    `:""}renderFirstPrimaryLink(){const e=GI(this.result);if(e)return dc`<div class="links">${this.renderLink(e)}</div>`}renderOtherPrimaryLinks(){const e=zI(this.result);if(0!==e.length)return dc`<div class="links">
      ${e.map((e=>this.renderLink(e)))}
    </div>`}renderSecondaryLinks(){const e=(t=this.result,(t?.links??[]).filter((e=>!e.primary)));var t;if(0!==e.length)return dc`<div class="links">
      ${e.map((e=>this.renderLink(e)))}
    </div>`}renderCodePointers(){if(this.hideCodePointers)return;const e=this.result?.codePointers??[];return 0!==e.length?e.map((e=>{let t="";const i=e?.range?.start_line,r=e?.range?.end_line;if(i&&(t+=`#${i}`),r&&i!==r&&(t+=`-${r}`),!this.getChangeModel().getChange())return;const o=e.path,s=this.result?.patchset,n=e?.range?.start_line;return{icon:hI.CODE,tooltip:`${o}${t}`,url:this.getViewModel().diffUrl({basePatchNum:Qu,patchNum:s,checksPatchset:s,diffView:{path:o,lineNum:n}}),primary:!0}})).map((e=>dc`<div class="links">${this.renderLink(e,!1)}</div>`)):void 0}renderFix(){const e=this.result?.fixes?.map((e=>vI(e,this.result?.checkName))).filter(cf)??[];if(0!==e.length)return dc`
      <gr-checks-fix-preview
        .fixSuggestionInfos=${e}
        .patchSet=${this.result?.patchset}
      ></gr-checks-fix-preview>
    `}renderNotUseful(){const e=this.result?.actions??[],t=e.find((e=>e.name===nI)),i=e.find((e=>e.name===aI));if(t&&i)return dc`
      <div class="useful">
        <div class="title">${this.notUsefulLabel}</div>
        <gr-checks-action
          .runOrResult=${this.result}
          @click=${()=>this.notUsefulLabel="Thanks!"}
          .action=${t}
        ></gr-checks-action>
        <gr-checks-action
          .runOrResult=${this.result}
          @click=${()=>this.notUsefulLabel="Sorry about that"}
          .action=${i}
        ></gr-checks-action>
      </div>
    `}renderLink(e,t=!0){if(!e)return;const i=e.tooltip??gI(e.icon),r=t?"_blank":void 0,o=uI(e.icon);return dc`<a
      href=${e.url}
      target=${Vw(r)}
      rel="noopener noreferrer"
    >
      <gr-icon
        icon=${o.name}
        class="link"
        ?filled=${!!o.filled}
      ></gr-icon>
      <span>${i}</span>
    </a>`}};dM([Fc({attribute:!1})],hM.prototype,"result",void 0),dM([Fc({type:Boolean})],hM.prototype,"hideCodePointers",void 0),dM([Uc()],hM.prototype,"notUsefulLabel",void 0),hM=dM([Dc("gr-result-expanded")],hM);const pM=new Map;pM.set(dI.ERROR,"Must be fixed and is blocking submit"),pM.set(dI.WARNING,"Should be checked but is not blocking submit"),pM.set(dI.INFO,"Does not have to be checked, for your information only"),pM.set(dI.SUCCESS,"Successful runs without results and individual successful results");let uM=class extends Ic{constructor(){super(),this.filterRegExp="",this.runs=[],this.selectedRuns=new Set,this.actions=[],this.links=[],this.someProvidersAreLoading=!1,this.checksPatchsetNumber=void 0,this.latestPatchsetNumber=void 0,this.selectedAttempt=OI,this.isShowAll=new Map,this.allResultsExpanded=new Map,this.isSectionExpanded=new Map,this.isSectionExpandedByUser=new Map,this.getViewModel=yu(this,XC),this.getChangeModel=yu(this,MT),this.getChecksModel=yu(this,sP),this.reporting=Xn().reportingService,zf(this,(()=>this.getChecksModel().topLevelActionsSelected$),(e=>this.actions=e)),zf(this,(()=>this.getChecksModel().topLevelLinksSelected$),(e=>this.links=e)),zf(this,(()=>this.getChecksModel().checksSelectedPatchsetNumber$),(e=>this.checksPatchsetNumber=e)),zf(this,(()=>this.getChecksModel().checksSelectedAttemptNumber$),(e=>this.selectedAttempt=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchsetNumber=e)),zf(this,(()=>this.getChecksModel().someProvidersAreLoadingSelected$),(e=>this.someProvidersAreLoading=e)),zf(this,(()=>this.getViewModel().checksRunsSelected$),(e=>this.selectedRuns=e)),zf(this,(()=>this.getViewModel().checksResultsFilter$),(e=>this.filterRegExp=e))}static get styles(){return[vy,Nc,Yc,Qb,Sd`
        :host {
          display: block;
          background-color: var(--background-color-secondary);
        }
        .header {
          display: block;
          background-color: var(--background-color-primary);
          padding: var(--spacing-l) var(--spacing-xl) var(--spacing-m)
            var(--spacing-xl);
          border-bottom: 1px solid var(--border-color);
        }
        .header.notLatest {
          background-color: var(--emphasis-color);
        }
        .headerTopRow,
        .headerBottomRow {
          display: flex;
          justify-content: space-between;
          align-items: flex-end;
        }
        .headerTopRow gr-dropdown-list {
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          padding: 0 var(--spacing-m);
        }
        .headerTopRow h2 {
          display: inline-block;
        }
        .headerTopRow .loading {
          display: inline-block;
          margin-left: var(--spacing-m);
          color: var(--deemphasized-text-color);
        }
        /* The basics of .loadingSpin are defined in shared styles. */
        .headerTopRow .loadingSpin {
          display: inline-block;
          margin-left: var(--spacing-s);
          width: 18px;
          height: 18px;
          vertical-align: top;
        }
        .headerBottomRow {
          margin-top: var(--spacing-s);
        }
        .headerTopRow .right,
        .headerBottomRow .right {
          display: flex;
          align-items: center;
        }
        .headerTopRow .right .goToLatest {
          display: none;
        }
        .notLatest .headerTopRow .right .goToLatest {
          display: block;
        }
        .headerTopRow .right > * {
          margin-left: var(--spacing-m);
        }
        .headerTopRow .right .goToLatest gr-button {
          --gr-button-padding: var(--spacing-s) var(--spacing-m);
        }
        .headerBottomRow gr-icon {
          color: var(--link-color);
        }
        .headerBottomRow .space {
          display: inline-block;
          width: var(--spacing-xl);
          height: var(--line-height-normal);
        }
        .headerBottomRow a {
          margin-right: var(--spacing-l);
        }
        #moreActions gr-icon {
          color: var(--link-color);
        }
        #moreMessage {
          display: none;
        }
        .body {
          display: block;
          padding: var(--spacing-s) var(--spacing-xl) var(--spacing-xl)
            var(--spacing-xl);
        }
        .filterDiv {
          display: flex;
          margin-top: var(--spacing-s);
          align-items: center;
        }
        .filterDiv input#filterInput {
          padding: var(--spacing-s) var(--spacing-m);
          min-width: 400px;
        }
        .filterDiv .selection {
          padding: var(--spacing-s) var(--spacing-m);
        }
        .categoryHeader {
          display: flex;
          justify-content: space-between;
          align-items: flex-end;
          margin-top: var(--spacing-l);
          margin-left: var(--spacing-l);
          cursor: default;
        }
        .categoryHeader .title {
          text-transform: capitalize;
        }
        .categoryHeader .expandIcon {
          width: var(--line-height-h3);
          height: var(--line-height-h3);
          margin-right: var(--spacing-s);
        }
        .categoryHeader .statusIconWrapper {
          display: inline-block;
        }
        .categoryHeader .statusIcon {
          position: relative;
          top: 2px;
        }
        .categoryHeader .statusIcon.error {
          color: var(--error-foreground);
        }
        .categoryHeader .statusIcon.warning {
          color: var(--warning-foreground);
        }
        .categoryHeader .statusIcon.info {
          color: var(--info-foreground);
        }
        .categoryHeader .statusIcon.success {
          color: var(--success-foreground);
        }
        .categoryHeader.empty gr-icon.statusIcon {
          color: var(--deemphasized-text-color);
        }
        .categoryHeader .filtered {
          color: var(--deemphasized-text-color);
        }
        .collapsed .noResultsMessage,
        .collapsed table {
          display: none;
        }
        .collapsed {
          border-bottom: 1px solid var(--border-color);
          padding-bottom: var(--spacing-m);
        }
        .noResultsMessage {
          width: 100%;
          margin-top: var(--spacing-m);
          background-color: var(--background-color-primary);
          box-shadow: var(--elevation-level-1);
          padding: var(--spacing-s)
            calc(20px + var(--spacing-l) + var(--spacing-m) + var(--spacing-s));
        }
        table.resultsTable {
          width: 100%;
          table-layout: fixed;
          margin-top: var(--spacing-m);
          background-color: var(--background-color-primary);
          box-shadow: var(--elevation-level-1);
        }
        tr.headerRow th {
          text-align: left;
          font-weight: var(--font-weight-medium);
          padding: var(--spacing-s);
        }
        tr.headerRow th.nameCol {
          padding-left: var(--spacing-l);
          width: 200px;
        }
        @media screen and (min-width: 1400px) {
          tr.headerRow th.nameCol.longNames {
            width: 300px;
          }
        }
        tr.headerRow th.summaryCol {
          width: 99%;
        }
        tr.headerRow th.expanderCol {
          width: 30px;
          padding-right: var(--spacing-l);
        }

        gr-button.showAll {
          margin: var(--spacing-m);
        }
        tr {
          border-top: 1px solid var(--border-color);
        }
      `]}updated(e){if(super.updated(e),e.has("filterRegExp")&&this.filterInput&&(this.filterInput.value=this.filterRegExp),e.has("tabState")&&this.tabState){const{statusOrCategory:e,checkName:i}=this.tabState;if((t=e)!==dI.ERROR&&t!==dI.WARNING&&t!==dI.INFO&&t!==dI.SUCCESS||this.isSectionExpanded.get(e)||this.toggleExpanded(e),i)this.scrollElIntoView(`gr-result-row.${Pg(i)}`);else if(e&&e!==lI.RUNNING&&e!==lI.RUNNABLE){const t=e.toString().toLowerCase();this.scrollElIntoView(`.categoryHeader.${t} + table gr-result-row`)}}var t}scrollElIntoView(e){this.updateComplete.then((()=>{let t=this.shadowRoot?.querySelector(e);setTimeout((()=>{t&&t.focus(),t?.toggleExpanded(!0),t=t?.shadowRoot?.firstElementChild??t,t?.scrollIntoView({block:"center"})}),0)}))}render(){const e={header:!0,notLatest:!!this.checksPatchsetNumber&&this.checksPatchsetNumber!==this.latestPatchsetNumber},t=this.createAttemptDropdownItems();return dc`
      <div class=${th(e)}>
        <div class="headerTopRow">
          <div class="left">
            <h2 class="heading-2">Results</h2>
            <div class="loading" ?hidden=${!this.someProvidersAreLoading}>
              <span>Loading results </span>
              <span class="loadingSpin"></span>
            </div>
          </div>
          <div class="right">
            <div class="goToLatest">
              <gr-button @click=${this.goToLatestPatchset} link
                >Go To Latest Patchset</gr-button
              >
            </div>
            ${eb(t.length>0,(()=>dc` <gr-dropdown-list
                value=${this.selectedAttempt??0}
                .items=${t}
                @value-change=${this.onAttemptSelected}
              ></gr-dropdown-list>`))}
            <gr-dropdown-list
              value=${(this.checksPatchsetNumber||this.latestPatchsetNumber)??0}
              .items=${this.createPatchsetDropdownItems()}
              @value-change=${this.onPatchsetSelected}
            ></gr-dropdown-list>
          </div>
        </div>
        <div class="headerBottomRow">
          <div class="left">${this.renderFilter()}</div>
          <div class="right">${this.renderLinksAndActions()}</div>
        </div>
      </div>
      <div class="body">
        ${this.renderSection(dI.ERROR)}
        ${this.renderSection(dI.WARNING)}
        ${this.renderSection(dI.INFO)}
        ${this.renderSection(dI.SUCCESS)}
      </div>
    `}renderLinksAndActions(){const e=this.links??[],t=e.filter((e=>e.primary)).filter(((e,t,i)=>i.findIndex((t=>e.icon===t.icon))===t)).slice(0,4),i=e.filter((e=>!t.includes(e))),r=i.map((e=>({...e,id:e.tooltip,name:e.tooltip,target:"_blank",tooltip:void 0}))),o=this.actions??[],s=o.filter((e=>e.primary)).slice(0,2),n=o.filter((e=>!s.includes(e))),a=n.map((e=>({...e,id:e.name}))),l=a.filter((e=>e.disabled)).map((e=>e.id));return dc`
      ${t.map(this.renderLink)}
      ${t.length>0&&s.length>0?dc`<div class="space"></div>`:""}
      ${s.map(this.renderAction)}
      ${this.renderOverflow([...r,...a],l)}
    `}renderLink(e){if(!e)return;const t=e.tooltip??gI(e.icon),i=uI(e.icon);return dc`<gr-tooltip-content
      has-tooltip
      ?position-below=${!0}
      title=${t}
    >
      <a href=${e.url} target="_blank" rel="noopener noreferrer">
        <gr-icon
          icon=${i.name}
          aria-label=${t}
          class="link"
          ?filled=${!!i.filled}
        ></gr-icon>
      </a>
    </gr-tooltip-content>`}renderOverflow(e,t=[]){if(0!==e.length)return dc`
      <gr-dropdown
        id="moreActions"
        link=""
        vertical-offset="32"
        horizontal-align="right"
        @tap-item=${this.handleAction}
        .items=${e}
        .disabledIds=${t}
      >
        <gr-icon icon="more_vert" aria-labelledby="moreMessage"></gr-icon>
        <span id="moreMessage">More</span>
      </gr-dropdown>
    `}handleAction(e){this.getChecksModel().triggerAction(e.detail,void 0,"results-dropdown")}handleFilter(e){const t=e.detail.filterRegExp??"";this.getViewModel().updateState({checksResultsFilter:this.filterRegExp===t?"":t})}renderAction(e){if(e)return dc`<gr-checks-action
      context="results"
      .action=${e}
    ></gr-checks-action>`}onAttemptSelected(e){const t=LI(e.detail.value);ba(t,`unexpected attempt choice ${e.detail.value}`),this.getChecksModel().updateStateSetAttempt(t)}onPatchsetSelected(e){const t=Number(e.detail.value);va(Number.isInteger(t),`patchset must be integer: ${t}`),this.getChecksModel().updateStateSetPatchset(t)}goToLatestPatchset(){ba(this.latestPatchsetNumber,"latestPatchsetNumber"),this.getChecksModel().updateStateSetPatchset(this.latestPatchsetNumber)}createAttemptDropdownItems(){if(this.runs.every((e=>e.isSingleAttempt)))return[];const e=this.runs.map((e=>e.attempt??0)).filter(DI).filter(Ca);e.push(OI),e.push(NI);const t=e.sort(UI).map((e=>({value:e,text:MI(e)})));return t}createPatchsetDropdownItems(){return this.latestPatchsetNumber?Array.from(Array(this.latestPatchsetNumber),((e,t)=>{ba(this.latestPatchsetNumber,"latestPatchsetNumber");const i=this.latestPatchsetNumber-t;return{value:`${i}`,text:`Patchset ${i}${i===this.latestPatchsetNumber?" (latest)":""}`}})):[]}isRunSelected(e){return 0===this.selectedRuns.size||this.selectedRuns.has(e.checkName)}renderFilter(){const e=this.runs.filter((e=>this.isRunSelected(e)&&LP(this.selectedAttempt,e)));if(!(0===this.selectedRuns.size&&function(e){return e.reduce(((e,t)=>[...e,...t.results??[]]),[])}(e).length<=3&&""===this.filterRegExp))return dc`
      <div class="filterDiv">
        <input
          id="filterInput"
          type="text"
          placeholder="Filter results by tag or regular expression"
          @input=${this.onFilterInputChange}
        />
      </div>
    `}onFilterInputChange(){ba(this.filterInput,"filter <input> element"),this.reporting.reportInteraction(ga.CHECKS_RESULT_FILTER_CHANGED,{},{deduping:ca.EVENT_ONCE_PER_CHANGE}),this.getViewModel().updateState({checksResultsFilter:this.filterInput.value})}renderSection(e){const t=e.toString().toLowerCase(),i=e===dI.WARNING||e===dI.ERROR,r=this.runs.filter((e=>LP(this.selectedAttempt,e))).reduce(((t,i)=>[...t,...this.computeRunResults(e,i)]),[]),o=this.selectedRuns.size>0,s=r.filter((e=>this.isRunSelected(e))),n=new RegExp(this.filterRegExp,"i"),a=s.filter((e=>function(e,t){return t.test(e.checkName)||t.test(e.summary)||(e.tags??[]).some((e=>t.test(e.name)))||t.test(e.message??"")}(e,n))),l=""!==this.filterRegExp&&a.length>0;let d=this.isSectionExpanded.get(e);this.isSectionExpandedByUser.get(e)&&void 0!==d||(d=!(0===s.length)&&(i||o||l),this.isSectionExpanded.set(e,d));const c=d?"expanded":"collapsed",h=this.isShowAll.get(e)??!1,p=this.allResultsExpanded.get(e)??!1,u=a.some(VI),g=a.length,m=0===g?"empty":"",f=h?1e3:20,v=this.renderShowAllButton(e,h,f,g),b=wI(e);return dc`
      <div class="${c} ${t}">
        <div
          class="categoryHeader ${t} ${m}"
          @click=${()=>this.toggleExpanded(e)}
        >
          <h3 class="left heading-3">
            <gr-icon
              class="expandIcon"
              icon=${d?"expand_less":"expand_more"}
            ></gr-icon>
            <gr-tooltip-content
              has-tooltip
              ?position-below=${!0}
              title=${Vw(pM.get(e))}
            >
              <div class="statusIconWrapper">
                <gr-icon
                  icon=${b.name}
                  ?filled=${!!b.filled}
                  class="statusIcon ${t}"
                ></gr-icon>
                <span class="title">${t}</span>
                <span class="count">${this.renderCount(r,a)}</span>
              </div>
            </gr-tooltip-content>
          </h3>
          <div class="right">
            <gr-button
              link
              ?hidden=${!d||!u}
              @click=${t=>this.toggleResultsExpanded(t,e)}
            >
              ${p?"Collapse All":"Expand All"}</gr-button
            >
          </div>
        </div>
        ${eb(d,(()=>this.renderResults(r,s,a,f,v)))}
      </div>
    `}renderShowAllButton(e,t,i,r){if(!(r<=i))return dc`
      <tr class="showAllRow">
        <td colspan="3">
          <gr-button class="showAll" link @click=${()=>this.toggleShowAll(e)}
            >${t?"Show Less":`Show All (${r})`}</gr-button
          >
        </td>
      </tr>
    `}toggleResultsExpanded(e,t){e.preventDefault(),e.stopPropagation();const i=t.toString().toLowerCase(),r=!this.allResultsExpanded.get(t);this.allResultsExpanded.set(t,r),this.requestUpdate();const o=this.shadowRoot.querySelectorAll(`.${i} gr-result-row`);for(const e of o)e.toggleExpanded(r)}toggleShowAll(e){const t=this.isShowAll.get(e)??!1;this.isShowAll.set(e,!t),this.reporting.reportInteraction(ga.CHECKS_RESULT_SECTION_SHOW_ALL,{category:e,showAll:!t}),this.requestUpdate()}renderResults(e,t,i,r,o){if(0===e.length)return dc`<div class="noResultsMessage">No results</div>`;if(0===t.length)return dc`<div class="noResultsMessage">
        No results for this filtered view
      </div>`;if(0===i.length)return dc`<div class="noResultsMessage">
        No results match the regular expression
      </div>`;i=i.slice(0,r);const s=Math.max(...e.map((e=>e.checkName.length)));return dc`
      <table class="resultsTable">
        <thead>
          <tr class="headerRow">
            <th class=${th({nameCol:!0,longNames:s>25})}>Run</th>
            <th class="summaryCol">Summary</th>
            <th class="expanderCol"></th>
          </tr>
        </thead>
        <tbody @checks-results-filter=${this.handleFilter}>
          ${Mw(i,(e=>e.internalResultId),(e=>dc`
              <gr-result-row
                class=${Pg(e.checkName)}
                .result=${e}
              ></gr-result-row>
            `))}
          ${o}
        </tbody>
      </table>
    `}renderCount(e,t){return e.length===t.length?dc`(${e.length})`:dc`(${t.length} shown out of ${e.length})`}toggleExpanded(e){const t=this.isSectionExpanded.get(e);ba(t,"expanded must have been set in initial render"),this.isSectionExpanded.set(e,!t),this.isSectionExpandedByUser.set(e,!0),this.reporting.reportInteraction(ga.CHECKS_RESULT_SECTION_TOGGLE,{expanded:!t,category:e}),this.requestUpdate()}computeRunResults(e,t){return e===dI.SUCCESS&&kI(t)?[this.computeSuccessfulRunResult(t)]:t.results?.filter((t=>t.category===e)).map((e=>oP(t,e)))??[]}computeSuccessfulRunResult(e){const t=oP(e,{internalResultId:e.internalRunId+"-0",category:dI.SUCCESS,summary:e.statusDescription??""});if(!e.statusDescription){const i=e.scheduledTimestamp??e.startedTimestamp,r=e.finishedTimestamp;let o="";i&&r&&(o=` ${Ym(i,r,"in")}`),t.message=`Completed without results${o}.`}return e.statusLink&&(t.links=[{url:e.statusLink,primary:!0,icon:hI.EXTERNAL}]),t}};dM([Hc("#filterInput")],uM.prototype,"filterInput",void 0),dM([Uc()],uM.prototype,"filterRegExp",void 0),dM([Fc({attribute:!1})],uM.prototype,"runs",void 0),dM([Uc()],uM.prototype,"selectedRuns",void 0),dM([Uc()],uM.prototype,"actions",void 0),dM([Uc()],uM.prototype,"links",void 0),dM([Fc({attribute:!1})],uM.prototype,"tabState",void 0),dM([Uc()],uM.prototype,"someProvidersAreLoading",void 0),dM([Uc()],uM.prototype,"checksPatchsetNumber",void 0),dM([Uc()],uM.prototype,"latestPatchsetNumber",void 0),dM([Uc()],uM.prototype,"selectedAttempt",void 0),dM([Uc()],uM.prototype,"isShowAll",void 0),dM([Uc()],uM.prototype,"allResultsExpanded",void 0),uM=dM([Dc("gr-checks-results")],uM);var gM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let mM=class extends Ic{static get styles(){return[Qb,Sd`
        .container {
          /* Allows hiding the check results along with the comments
             when the user presses the keyboard shortcut 'h'. */
          display: var(--gr-check-code-pointers-display, block);
          font-family: var(--font-family);
          margin: 0 var(--spacing-s) var(--spacing-s);
          background-color: var(--unresolved-comment-background-color);
          box-shadow: var(--elevation-level-2);
          border-radius: var(--border-radius);
          padding: var(--spacing-xs) var(--spacing-m);
          border: 1px solid #888;
        }
        .container.info {
          border-color: var(--info-foreground);
          background-color: var(--info-background);
        }
        .container.info gr-icon {
          color: var(--info-foreground);
        }
        .container.warning {
          border-color: var(--warning-foreground);
          background-color: var(--warning-background);
        }
        .container.warning gr-icon {
          color: var(--warning-foreground);
        }
        .container.error {
          border-color: var(--error-foreground);
          background-color: var(--error-background);
        }
        .container.error gr-icon {
          color: var(--error-foreground);
        }
        .header {
          display: flex;
          white-space: nowrap;
          cursor: pointer;
        }
        .icon {
          margin-right: var(--spacing-s);
        }
        .name {
          margin-right: var(--spacing-m);
        }
        .summary {
          font-weight: var(--font-weight-medium);
          flex-shrink: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          margin-right: var(--spacing-s);
        }
        .message {
          flex-grow: 1;
          /* Looks a bit unexpected, but the idea is that .message shrinks
             first, and only when that has shrunken to 0, then .summary should
             also start shrinking (substantially). */
          flex-shrink: 1000000;
          overflow: hidden;
          text-overflow: ellipsis;
          color: var(--deemphasized-text-color);
        }
        gr-result-expanded {
          display: block;
          margin-top: var(--spacing-m);
        }
        gr-icon {
          font-size: var(--line-height-normal);
        }
        .icon gr-icon {
          font-size: calc(var(--line-height-normal) - 4px);
          position: relative;
          top: 2px;
        }
        div.actions {
          display: flex;
          justify-content: flex-end;
        }
      `]}constructor(){super(),this.isExpanded=!1,this.isExpandable=!1,this.isOwner=!1,this.suggestionLoading=!1,this.getChangeModel=yu(this,MT),this.getCommentsModel=yu(this,kP),this.reporting=Xn().reportingService,this.getSuggestionsService=yu(this,UT),zf(this,(()=>this.getChangeModel().isOwner$),(e=>this.isOwner=e)),zf(this,(()=>this.getSuggestionsService().suggestionsServiceUpdated$),(e=>{e&&this.requestUpdate()}))}firstUpdated(e){this.reporting.reportInteraction(ga.CHECKS_RESULT_DIFF_RENDERED,{checkName:this.result?.checkName})}render(){if(!this.result)return;const e=this.result.category.toLowerCase(),t=wI(this.result.category);return dc`
      <div class="${e} container font-normal">
        <div class="header" @click=${this.toggleExpandedClick}>
          <div class="icon">
            <gr-icon icon=${t.name} ?filled=${!!t.filled}></gr-icon>
          </div>
          <div class="name">
            <gr-hovercard-run .run=${this.result}></gr-hovercard-run>
            <div
              class="name"
              role="button"
              tabindex="0"
              @keydown=${this.toggleExpandedPress}
            >
              ${this.result.checkName}
            </div>
          </div>
          <!-- The &nbsp; is for being able to shrink a tiny amount without
                the text itself getting shrunk with an ellipsis. -->
          <div class="summary">${this.result.summary}&nbsp;</div>
          <div class="message">
            ${this.isExpanded?uc:this.result.message}
          </div>
          ${this.renderToggle()}
        </div>
        <div class="details">
          ${this.renderExpanded()}${this.renderActions()}
        </div>
      </div>
    `}renderToggle(){return this.isExpandable?dc`
      <div
        class="show-hide"
        role="switch"
        tabindex="0"
        aria-checked=${this.isExpanded?"true":"false"}
        aria-label=${this.isExpanded?"Collapse result row":"Expand result row"}
        @keydown=${this.toggleExpandedPress}
      >
        <gr-icon
          icon=${this.isExpanded?"expand_less":"expand_more"}
        ></gr-icon>
      </div>
    `:uc}renderExpanded(){return this.isExpanded?dc`
      <gr-result-expanded
        hidecodepointers
        .result=${this.result}
      ></gr-result-expanded>
      ${this.renderSuggestionPreview()}
    `:uc}renderSuggestionPreview(){return this.suggestion?dc`<gr-checks-fix-preview
      .fixSuggestionInfos=${[this.suggestion]}
      .patchSet=${this.result?.patchset}
    ></gr-checks-fix-preview>`:uc}renderActions(){return dc`<div class="actions">
      ${this.renderAIFixButton()}
      ${this.renderShowFixButton()}${this.renderPleaseFixButton()}
    </div>`}renderAIFixButton(){return this.shouldShowAIFixButton()?dc`<gr-button
      id="aiFixBtn"
      link
      class="action ai-fix"
      ?disabled=${this.suggestionLoading}
      @click=${this.handleAIFix}
      >Get AI Fix
      ${eb(this.suggestionLoading,(()=>dc`<span class="loadingSpin"></span>`))}</gr-button
    >`:uc}shouldShowAIFixButton(){return!!this.getSuggestionsService()?.isGeneratedSuggestedFixEnabled(this.result?.codePointers?.[0].path)&&!this.result?.fixes?.length&&this.result?.category!==dI.SUCCESS&&this.result?.category!==dI.INFO&&0!==this.result?.codePointers?.[0]?.range.start_line&&0!==this.result?.codePointers?.[0]?.range.end_line&&this.isOwner}renderPleaseFixButton(){const e={name:"Please Fix",callback:()=>{var e;ba(this.result,"result"),this.getCommentsModel().saveDraft(mI(e=this.result,function(e){return`Please fix this ${e.category} reported by ${e.checkName}: ${e.summary}\n\n${e.message}`}(e),!0))}};return dc`
      <gr-checks-action
        id="please-fix"
        context="diff-fix"
        .runOrResult=${this.result}
        .action=${e}
      ></gr-checks-action>
    `}renderShowFixButton(){if(this.isExpanded)return uc;const e=fI(this,this.result);return e?dc`
      <gr-checks-action
        id="show-fix"
        context="diff-fix"
        .runOrResult=${this.result}
        .action=${e}
      ></gr-checks-action>
    `:uc}willUpdate(e){e.has("result")&&(this.isExpandable=VI(this.result))}toggleExpandedClick(e){this.isExpandable&&(e.preventDefault(),e.stopPropagation(),this.toggleExpanded())}toggleExpandedPress(e){this.isExpandable&&(Gn(e)||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),this.toggleExpanded()))}toggleExpanded(){this.isExpandable&&(this.isExpanded=!this.isExpanded)}async handleAIFix(){const e=this.result?.codePointers?.[0];if(!(this.result&&this.result.message&&e&&this.isOwner))return;let t;this.suggestionLoading=!0;try{t=await this.getSuggestionsService().generateSuggestedFix({prompt:this.result.message,patchsetNumber:this.result.patchset,filePath:e.path,range:e.range,reportSource:BT.GET_AI_FIX_FOR_CHECK})}finally{this.suggestionLoading=!1}t?(t.description=BT.GET_AI_FIX_FOR_CHECK+" "+t.description,this.suggestion=t,this.isExpanded=!0):ea(this,"No suitable AI fix could be found")}};gM([Fc({attribute:!1})],mM.prototype,"result",void 0),gM([Fc({type:String})],mM.prototype,"rootId",void 0),gM([Uc()],mM.prototype,"isExpanded",void 0),gM([Uc()],mM.prototype,"isExpandable",void 0),gM([Uc()],mM.prototype,"isOwner",void 0),gM([Uc()],mM.prototype,"suggestionLoading",void 0),gM([Uc()],mM.prototype,"suggestion",void 0),mM=gM([Dc("gr-diff-check-result")],mM);const fM=Zc(class extends eh{constructor(){super(...arguments),this.key=uc}render(e,t){return this.key=e,t}update(e,[t,i]){return t!==this.key&&(Gv(e),this.key=t),i}});var vM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const bM="No blame information for this diff.";let yM=class extends Ic{get editWeblinks(){return this._editWeblinks}set editWeblinks(e){this._editWeblinks!==e&&(this._editWeblinks=e,Jn(this,"edit-weblinks-changed",{value:e}))}get filesWeblinks(){return this._filesWeblinks}set filesWeblinks(e){this._filesWeblinks!==e&&(this._filesWeblinks=e,Jn(this,"files-weblinks-changed",{value:e}))}get diff(){return this._diff}set diff(e){if(this._diff===e)return;const t=this._diff;this._diff=e,Jn(this,"diff-changed",{value:this._diff}),this.requestUpdate("diff",t)}get blame(){return this._blame}set blame(e){if(this._blame===e)return;const t=this._blame;this._blame=e,Jn(this,"is-blame-loaded-changed",{value:!!this._blame}),this.requestUpdate("blame",t)}constructor(){super(),this.noAutoRender=!1,this.hidden=!1,this.noRenderOnPrefsChange=!1,this.threads=[],this.checks=[],this.lineWrapping=!1,this.viewMode=Su.SIDE_BY_SIDE,this.loggedIn=!1,this.errorMessage=null,this.getShortcutsService=yu(this,Bg),this.fetchDiffPromise=null,this._blame=null,this.coverageRanges=[],this.layers=[],this.renderPrefs={num_lines_rendered_at_once:128},this.getBrowserModel=yu(this,LL),this.getCommentsModel=yu(this,kP),this.getChecksModel=yu(this,sP),this.getPluginLoader=yu(this,U_),this.reporting=Xn().reportingService,this.flags=Xn().flagsService,this.restApiService=Xn().restApiService,this.getUserModel=yu(this,jf),this.grDiffKey=0,this.syntaxLayer=new _T(yu(this,ST),(()=>Xn().reportingService)),this.addEventListener("create-comment",(e=>this.handleCreateThread(e))),this.addEventListener("diff-context-expanded",(e=>this.handleDiffContextExpanded(e))),this.addEventListener("reload-diff",(e=>{e.detail.path===this.path&&this.reload(!1)})),zf(this,(()=>this.getBrowserModel().diffViewMode$),(e=>this.viewMode=e)),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.loggedIn=e)),zf(this,(()=>this.getCommentsModel().changeComments$),(e=>{this.changeComments=e})),zf(this,(()=>this.getUserModel().diffPreferences$),(e=>{this.prefs=e}))}connectedCallback(){super.connectedCallback(),this.subscribeToChecks(),this.getPluginLoader().jsApiService.handleShowDiff({change:this.change,fileRange:this.file,patchRange:this.patchRange})}disconnectedCallback(){this.reloadPromise&&(this.reloadPromise.cancel(),this.reloadPromise=void 0),this.checksSubscription&&(this.checksSubscription.unsubscribe(),this.checksSubscription=void 0),this.clear(),super.disconnectedCallback()}willUpdate(e){super.willUpdate(e),(e.has("changeComments")||e.has("patchRange")||e.has("file"))&&(this.threads=this.computeFileThreads(this.changeComments,this.patchRange,this.file)),(e.has("noRenderOnPrefsChange")||e.has("prefs")||e.has("path")||e.has("changeNum"))&&this.syntaxHighlightingChanged(this.noRenderOnPrefsChange,e.get("prefs"),this.prefs,this.path,this.changeNum),(e.has("prefs")||e.has("loadedWhitespaceLevel")||e.has("noRenderOnPrefsChange")||e.has("path")||e.has("changeNum"))&&this.whitespaceChanged(this.prefs?.ignore_whitespace,this.loadedWhitespaceLevel,this.noRenderOnPrefsChange,this.path,this.changeNum)}async waitForReloadToRender(){if(await this.updateComplete,this.reloadPromise){try{await this.reloadPromise}catch(e){e===ay||(e instanceof Error?this.reporting.error("GrDiffHost Reload:",e):this.reporting.error("GrDiffHost Reload:",new Error("reloadPromise error"),e))}await this.updateComplete}}render(){const e=!1===this.hasTrailingNewlines(this.diff,!0),t=!1===this.hasTrailingNewlines(this.diff,!1),i=this.flags.isEnabled(da.NEW_IMAGE_DIFF_UI);return fM(this.grDiffKey,dc`<gr-diff
        id="diff"
        ?hidden=${this.hidden}
        .noAutoRender=${this.noAutoRender}
        .path=${this.path}
        .prefs=${this.prefs}
        .noRenderOnPrefsChange=${this.noRenderOnPrefsChange}
        .renderPrefs=${this.renderPrefs}
        .lineWrapping=${this.lineWrapping}
        .viewMode=${this.viewMode}
        .lineOfInterest=${this.lineOfInterest}
        .loggedIn=${this.loggedIn}
        .errorMessage=${this.errorMessage}
        .baseImage=${this.baseImage}
        .revisionImage=${this.revisionImage}
        .coverageRanges=${this.coverageRanges}
        .blame=${this.blame}
        .layers=${this.layers}
        .diff=${this.diff}
        .showNewlineWarningLeft=${e}
        .showNewlineWarningRight=${t}
        .useNewImageDiffUi=${i}
        .binaryDiffHint=${` Download commit to view (shortcut:\n              ${this.getShortcutsService().getShortcut(pu.OPEN_DOWNLOAD_DIALOG)})`}
      >
        ${Mw(this.threads,(e=>e.rootId),(e=>this.renderThread(e)))}
        ${Mw(this.checks,(e=>e.internalResultId),(e=>this.renderCheck(e)))}
      </gr-diff>`)}async initLayers(){const e=this.restApiService.getPreferences(),t=await e,i=!t?.disable_token_highlighting;ba(this.path,"path"),this.layers=this.getLayers(i),this.coverageRanges=[],this.getCoverageData()}reload(e){return this.reloadPromise=function(e,t,i=0){const r=new ly(t,i);return e&&e.delegate(r),r}(this.reloadPromise,(async()=>{try{return void await this.reloadInternal(e)}catch(e){e instanceof Error?this.reporting.error("GrDiffHost Reload:",e):this.reporting.error("GrDiffHost Reload:",new Error("reloadInternal error"),e)}finally{this.reloadPromise=void 0}}),0),this.reloadPromise}async reloadInternal(e){this.reporting.time(ua.DIFF_TOTAL),this.reporting.time(ua.DIFF_LOAD),this.grDiffKey++,this.clear(),ba(this.path,"path"),ba(this.changeNum,"changeNum"),this.diff=void 0,this.errorMessage=null;const t=this.getIgnoreWhitespace();try{const r=this.initLayers(),o=await this.getDiff();this.loadedWhitespaceLevel=t,this.reportDiff(o),await this.loadDiffAssets(o),await r,this.editWeblinks=this.getEditWeblinks(o),this.filesWeblinks=this.getFilesWeblinks(o),this.diff=o,this.reporting.timeEnd(ua.DIFF_LOAD,this.timingDetails()),this.reporting.time(ua.DIFF_CONTENT),this.syntaxLayer.setEnabled(this.isSyntaxHighlightingEnabled());const s=this.syntaxLayer.process(o);await(i=this,new Promise((e=>{i.addEventListener("render",(t=>{e(t)}),{once:!0})}))),this.subscribeToChecks(),this.reporting.timeEnd(ua.DIFF_CONTENT,this.timingDetails()),e&&this.reporting.diffViewContentDisplayed(),this.reporting.time(ua.DIFF_SYNTAX),await s,this.reporting.timeEnd(ua.DIFF_SYNTAX,this.timingDetails())}catch(e){e instanceof Response?this.handleGetDiffError(e):e instanceof Error?this.reporting.error("GrDiffHost Reload:",e):this.reporting.error("GrDiffHost Reload:",new Error("reload error"),e)}finally{this.reporting.timeEnd(ua.DIFF_TOTAL,this.timingDetails())}var i}timingDetails(){if(!this.diff)return{};const e=(this.diff.meta_a?.lines??0)+(this.diff.meta_b?.lines??0);let t=0,i=0,r=0;for(const e of this.diff.content){const o=e.ab?.length??0,s=e.a?.length??0,n=e.b?.length??0;t+=o+o+s+n,i+=s+n,r+=o+o}return{metaLines:e,contentLines:t,contentUnchanged:r,contentChanged:i,height:this.diffElement?.shadowRoot?.querySelector(".diffContainer")?.clientHeight}}getLayers(e){const t=[];return e&&t.push(new FD(this,(e=>{for(const t of this.getPluginLoader().pluginsModel.getState().tokenHighlightPlugins)t.listener({change:this.change,basePatchNum:this.patchRange.basePatchNum,patchNum:this.patchRange.patchNum,fileRange:this.file,path:this.path,diffElement:this.diffElement},e)}))),t.push(this.syntaxLayer),t}clear(){this.layers=[]}subscribeToChecks(){this.checksSubscription&&(this.checksSubscription.unsubscribe(),this.checksSubscription=void 0,this.checks=[]);const e=this.path,t=this.patchRange?.patchNum;e&&t&&t!==Ju&&(this.checksSubscription=this.getChecksModel().allResults$.pipe(ep((e=>e.filter((e=>{if(e.patchset!==t)return!1;if(e.category===dI.SUCCESS)return!1;if(!e.isLatestAttempt)return!1;const i=e.codePointers?.[0];return i?.path===this.path&&!!i?.range})))),xp(sf)).subscribe((e=>this.checks=e)))}renderCheck(e){const t=mI(e),i=t.line??Au;let r;if(t.range&&(r=`${JSON.stringify(t.range)}`),!1!==e.show_on_unchanged_lines||!function(e,t,i){if(!e?.content||!t||!i)return!1;let r=0;for(const o of e.content)if(o.skip){if(r+=o.skip,r>=i)return!1}else if(o.ab){if(r+=o.ab.length,r>=i)return!0}else if(r+=(t===$u.LEFT?o.a?.length:o.b?.length)??0,r>=i)return o.common??!1;return!1}(this.diff,$u.RIGHT,gk(i)))return dc`
      <gr-diff-check-result
        class="comment-thread"
        .rootId=${e.internalResultId}
        .result=${e}
        slot=${`${$u.RIGHT}-${i}`}
        diff-side=${$u.RIGHT}
        line-num=${i}
        range=${Vw(r)}
      ></gr-diff-check-result>
    `}async getCoverageData(){ba(this.changeNum,"changeNum"),ba(this.change,"change"),ba(this.path,"path"),ba(this.patchRange,"patchRange");const e=this.changeNum,t=this.change,i=this.path,r=e=>Tx(e)?e:void 0,o=r(this.patchRange.basePatchNum),s=r(this.patchRange.patchNum);await this.getPluginLoader().awaitPluginsLoaded();const n=this.getPluginLoader().pluginsModel.getState().coveragePlugins.map((e=>e.provider));for(const a of n)try{const n=await a(e,i,o,s,t);if(ba(this.patchRange,"patchRange"),!n||e!==this.changeNum||t!==this.change||i!==this.path||o!==r(this.patchRange.basePatchNum)||s!==r(this.patchRange.patchNum))continue;this.coverageRanges=n}catch(e){e instanceof Error&&this.reporting.error("GrDiffHost Coverage",e)}}computeFileThreads(e,t,i){return e&&t&&i?e.getThreadsBySideForFile(i,t):this.threads}getEditWeblinks(e){return e?.edit_web_links??[]}getFilesWeblinks(e){return{meta_a:e?.meta_a?.web_links??[],meta_b:e?.meta_b?.web_links??[]}}getCursorStops(){return ba(this.diffElement),this.diffElement.getCursorStops()}isRangeSelected(){return ba(this.diffElement),this.diffElement.isRangeSelected()}getSelectedRange(){return ba(this.diffElement),this.diffElement.getSelectedRange()}createRangeComment(){ba(this.diffElement),this.diffElement.createRangeComment()}isShowFullContext(){return ba(this.diffElement),this.diffElement.isShowFullContext()}toggleLeftDiff(){ba(this.diffElement),this.renderPrefs={...this.renderPrefs,hide_left_side:!this.renderPrefs.hide_left_side}}loadBlame(){return ba(this.changeNum,"changeNum"),ba(this.patchRange,"patchRange"),ba(this.path,"path"),this.restApiService.getBlame(this.changeNum,this.patchRange.patchNum,this.path,!0).then((e=>e&&e.length?(this.blame=e,e):(ea(this,bM),Promise.reject(bM))))}clearBlame(){this.blame=null}toggleAllContext(){ba(this.diffElement),this.diffElement.toggleAllContext()}prefetchDiff(){this.changeNum&&this.patchRange&&this.path&&null===this.fetchDiffPromise&&(this.fetchDiffPromise=this.getDiff())}getDiff(){if(null!==this.fetchDiffPromise){const e=this.fetchDiffPromise;return this.fetchDiffPromise=null,e}return new Promise(((e,t)=>{ba(this.changeNum,"changeNum"),ba(this.patchRange,"patchRange"),ba(this.path,"path"),this.restApiService.getDiff(this.changeNum,this.patchRange.basePatchNum,this.patchRange.patchNum,this.path,this.getIgnoreWhitespace(),t).then((t=>e(t)))}))}handleGetDiffError(e){409!==e.status?this.showLoadFailure?this.errorMessage=["Encountered error when loading the diff:",e.status,e.statusText].join(" "):ia(e):ra(e)}reportDiff(e){if(!e||!e.content)return;let t=0,i=0;e.content.forEach((e=>{if(e.ab)return;const r=Math.max(e.a?e.a.length:0,e.b?e.b.length:0);e.due_to_rebase?i+=r:t+=r}));const r=i+t,o=r?Math.round(100*i/r):0;ba(this.patchRange,"patchRange"),this.patchRange.basePatchNum===Qu?this.reporting.reportInteraction("diff-against-parent"):0===o?this.reporting.reportInteraction("rebase-percent-zero"):this.reporting.reportInteraction("rebase-percent-nonzero",{percentRebaseDelta:o})}loadDiffAssets(e){return kk(e)?this.getImages(e).then((e=>{this.baseImage=e.baseImage??void 0,this.revisionImage=e.revisionImage??void 0})):(this.baseImage=void 0,this.revisionImage=void 0,Promise.resolve())}getImages(e){return ba(this.changeNum,"changeNum"),ba(this.patchRange,"patchRange"),this.restApiService.getImagesForDiff(this.changeNum,e,this.patchRange)}handleCreateThread(e){if(!this.patchRange)throw Error("patch range not set");const{lineNum:t,side:i,range:r}=e.detail,o=i!==$u.LEFT||Ax(this.patchRange.basePatchNum)?this.patchRange.patchNum:this.patchRange.basePatchNum,s=i===$u.LEFT&&Ax(this.patchRange.basePatchNum)?Yu.PARENT:Yu.REVISION;if(!this.canCommentOnPatchSetNum(o))return;const n=this.file?.basePath&&i===$u.LEFT&&s===Yu.REVISION?this.file?.basePath:this.path;ba(n,"path");const a=this.computeParentIndex(),l={...Kx("",!0),patch_set:o,side:s,parent:a??void 0,path:n,line:"number"==typeof t?t:void 0,range:r};this.getCommentsModel().addNewDraft(l)}canCommentOnPatchSetNum(e){if(!this.loggedIn)return Jn(this,"show-auth-required",{}),!1;if(!this.patchRange)return ea(this,"Cannot create comment. patchRange undefined."),!1;const t=e===Ju,i=e===Qu&&this.patchRange.patchNum===Ju;return t?(ea(this,"You cannot comment on an edit."),!1):!i||(ea(this,"You cannot comment on the base patchset of an edit."),!1)}getDiffSide(e){let t;ba(this.patchRange,"patchRange");const i={patch_set:e.patchNum,side:e.commentSide,parent:e.mergeParentNum};if(sC(i,this.patchRange))t=$u.LEFT;else{if(!nC(i,this.patchRange)){const e=JSON.stringify(i),t=JSON.stringify(this.patchRange);throw new Error(`comment ${e} not in range ${t}`)}t=$u.RIGHT}return t}renderThread(e){const t=this.getDiffSide(e),i=e.range?JSON.stringify(e.range):void 0;return dc`
      <gr-comment-thread
        class="comment-thread"
        .rootId=${e.rootId}
        .thread=${e}
        .showPatchset=${!1}
        .showPortedComment=${!!e.ported}
        slot=${`${t}-${e.line||Ru}`}
        diff-side=${t}
        line-num=${e.line||Ru}
        range=${Vw(i)}
      >
      </gr-comment-thread>
    `}getIgnoreWhitespace(){return this.prefs&&this.prefs.ignore_whitespace?this.prefs.ignore_whitespace:"IGNORE_NONE"}whitespaceChanged(e,t,i,r,o){if(void 0!==e&&void 0!==t&&void 0!==i&&void 0!==r&&void 0!==o)return this.fetchDiffPromise=null,e===t||i?void 0:this.reload()}syntaxHighlightingChanged(e,t,i,r,o){if(void 0!==e&&void 0!==i&&void 0!==r&&void 0!==o&&t?.syntax_highlighting!==i.syntax_highlighting)return e?void 0:this.reload()}computeParentIndex(){return this.patchRange&&kx(this.patchRange.basePatchNum)?Fx(this.patchRange.basePatchNum):null}isSyntaxHighlightingEnabled(){return!(!this.prefs?.syntax_highlighting||!this.diff||(ba(this.diffElement),$k(this.diff)>2e4&&(ea(this,"Files with more than 20000 lines  will not be syntax highlighted."),1)))}handleDiffContextExpanded(e){this.reporting.reportInteraction("diff-context-expanded",{numLines:e.detail.numLines})}lastChunkForSide(e,t){if(!e?.content.length)return null;let i,r=e.content.length;do{r--,i=e.content[r]}while(r>=0&&!i.ab&&(t&&(!i.a||!i.a.length)||!t&&(!i.b||!i.b.length)));return-1===r?null:i}hasTrailingNewlines(e,t){const i=this.lastChunkForSide(e,t);if(!i)return null;let r;return r=i.ab?i.ab:t?i.a:i.b,r?""===r[r.length-1]:null}};vM([Hc("#diff")],yM.prototype,"diffElement",void 0),vM([Fc({type:Number})],yM.prototype,"changeNum",void 0),vM([Fc({type:Object})],yM.prototype,"change",void 0),vM([Fc({type:Boolean})],yM.prototype,"noAutoRender",void 0),vM([Fc({type:Object})],yM.prototype,"patchRange",void 0),vM([Fc({type:Object})],yM.prototype,"file",void 0),vM([Fc({type:String})],yM.prototype,"path",void 0),vM([Fc({type:Object})],yM.prototype,"prefs",void 0),vM([Fc({type:String})],yM.prototype,"projectName",void 0),vM([Uc()],yM.prototype,"_editWeblinks",void 0),vM([Uc()],yM.prototype,"_filesWeblinks",void 0),vM([Fc({type:Boolean,reflect:!0})],yM.prototype,"hidden",void 0),vM([Fc({type:Boolean})],yM.prototype,"noRenderOnPrefsChange",void 0),vM([Uc()],yM.prototype,"threads",void 0),vM([Uc()],yM.prototype,"checks",void 0),vM([Fc({type:Boolean})],yM.prototype,"lineWrapping",void 0),vM([Fc({type:Object})],yM.prototype,"lineOfInterest",void 0),vM([Fc({type:String})],yM.prototype,"viewMode",void 0),vM([Fc({type:Boolean})],yM.prototype,"showLoadFailure",void 0),vM([Uc()],yM.prototype,"loggedIn",void 0),vM([Uc()],yM.prototype,"errorMessage",void 0),vM([Uc()],yM.prototype,"baseImage",void 0),vM([Uc()],yM.prototype,"revisionImage",void 0),vM([Uc()],yM.prototype,"changeComments",void 0),vM([Uc()],yM.prototype,"fetchDiffPromise",void 0),vM([Uc()],yM.prototype,"blame",null),vM([Uc()],yM.prototype,"coverageRanges",void 0),vM([Uc()],yM.prototype,"loadedWhitespaceLevel",void 0),vM([Uc()],yM.prototype,"layers",void 0),vM([Uc()],yM.prototype,"renderPrefs",void 0),yM=vM([Dc("gr-diff-host")],yM);var wM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let _M=class extends Ic{constructor(){super(),this.getUserModel=yu(this,jf),this.handleLineWrappingTap=()=>{this.diffPrefs.line_wrapping=this.lineWrappingInput.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleDiffLineLengthInput=()=>{this.diffPrefs.line_length=Number(this.columnsInput.value),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleDiffTabSizeInput=()=>{this.diffPrefs.tab_size=Number(this.tabSizeInput.value),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleDiffFontSizeInput=()=>{this.diffPrefs.font_size=Number(this.fontSizeInput.value),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleShowTabsTap=()=>{this.diffPrefs.show_tabs=this.showTabsInput.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleShowTrailingWhitespaceTap=()=>{this.diffPrefs.show_whitespace_errors=this.showTrailingWhitespaceInput.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleSyntaxHighlightTap=()=>{this.diffPrefs.syntax_highlighting=this.syntaxHighlightInput.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleAutomaticReviewTap=()=>{this.diffPrefs.manual_review=!this.automaticReviewInput.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},zf(this,(()=>this.getUserModel().diffPreferences$),(e=>{e&&(this.originalDiffPrefs=e,this.diffPrefs={...e})}))}static get styles(){return[Jy,Nc,my,Sd`
        md-outlined-text-field {
          max-width: 25em;
        }
      `]}render(){return dc`
      <div id="diffPreferences" class="gr-form-styles">
        <section>
          <label for="contextLineSelect" class="title">Context</label>
          <span class="value">
            <md-outlined-select
              id="contextSelect"
              value=${Lg(this.diffPrefs?.context)}
              @change=${e=>{const t=e.target;this.diffPrefs.context=Number(t.value),this.requestUpdate(),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})}}
            >
              <md-select-option value="3">
                <div slot="headline">3 lines</div>
              </md-select-option>
              <md-select-option value="10">
                <div slot="headline">10 lines</div>
              </md-select-option>
              <md-select-option value="25">
                <div slot="headline">25 lines</div>
              </md-select-option>
              <md-select-option value="50">
                <div slot="headline">50 lines</div>
              </md-select-option>
              <md-select-option value="75">
                <div slot="headline">75 lines</div>
              </md-select-option>
              <md-select-option value="100">
                <div slot="headline">100 lines</div>
              </md-select-option>
              <md-select-option value="-1">
                <div slot="headline">Whole file</div>
              </md-select-option>
            </md-outlined-select>
          </span>
        </section>
        <section>
          <label for="lineWrappingInput" class="title">Fit to screen</label>
          <span class="value">
            <md-checkbox
              id="lineWrappingInput"
              ?checked=${!!this.diffPrefs?.line_wrapping}
              @change=${this.handleLineWrappingTap}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="columnsInput" class="title">Diff width</label>
          <span class="value">
            <md-outlined-text-field
              id="columnsInput"
              class="showBlueFocusBorder"
              type="number"
              step="1"
              .value=${Lg(this.diffPrefs?.line_length)}
              @input=${this.handleDiffLineLengthInput}
              @beforeinput=${e=>{const t=e.data;t&&!/^[0-9]*$/.test(t)&&e.preventDefault()}}
            >
            </md-outlined-text-field>
          </span>
        </section>
        <section>
          <label for="tabSizeInput" class="title">Tab width</label>
          <span class="value">
            <md-outlined-text-field
              id="tabSizeInput"
              class="showBlueFocusBorder"
              type="number"
              step="1"
              .value=${Lg(this.diffPrefs?.tab_size)}
              @input=${this.handleDiffTabSizeInput}
              @beforeinput=${e=>{const t=e.data;t&&!/^[0-9]*$/.test(t)&&e.preventDefault()}}
            >
            </md-outlined-text-field>
          </span>
        </section>
        <section>
          <label for="fontSizeInput" class="title">Font size</label>
          <span class="value">
            <md-outlined-text-field
              id="fontSizeInput"
              class="showBlueFocusBorder"
              type="number"
              step="1"
              .value=${Lg(this.diffPrefs?.font_size)}
              @input=${this.handleDiffFontSizeInput}
              @beforeinput=${e=>{const t=e.data;t&&!/^[0-9]*$/.test(t)&&e.preventDefault()}}
            >
            </md-outlined-text-field>
          </span>
        </section>
        <section>
          <label for="showTabsInput" class="title">Show tabs</label>
          <span class="value">
            <md-checkbox
              id="showTabsInput"
              ?checked=${!!this.diffPrefs?.show_tabs}
              @change=${this.handleShowTabsTap}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="showTrailingWhitespaceInput" class="title"
            >Show trailing whitespace</label
          >
          <span class="value">
            <md-checkbox
              id="showTrailingWhitespaceInput"
              ?checked=${!!this.diffPrefs?.show_whitespace_errors}
              @change=${this.handleShowTrailingWhitespaceTap}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="syntaxHighlightInput" class="title"
            >Syntax highlighting</label
          >
          <span class="value">
            <md-checkbox
              id="syntaxHighlightInput"
              ?checked=${!!this.diffPrefs?.syntax_highlighting}
              @change=${this.handleSyntaxHighlightTap}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="automaticReviewInput" class="title"
            >Automatically mark viewed files reviewed</label
          >
          <span class="value">
            <md-checkbox
              id="automaticReviewInput"
              ?checked=${!this.diffPrefs?.manual_review}
              @change=${this.handleAutomaticReviewTap}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <div class="pref">
            <label for="ignoreWhiteSpace" class="title"
              >Ignore Whitespace</label
            >
            <span class="value">
              <md-outlined-select
                id="contextSelect"
                value=${Lg(this.diffPrefs?.ignore_whitespace)}
                @change=${e=>{const t=e.target;this.diffPrefs.ignore_whitespace=t.value,this.requestUpdate(),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})}}
              >
                <md-select-option value="IGNORE_NONE">
                  <div slot="headline">None</div>
                </md-select-option>
                <md-select-option value="IGNORE_TRAILING">
                  <div slot="headline">Trailing</div>
                </md-select-option>
                <md-select-option value="IGNORE_LEADING_AND_TRAILING">
                  <div slot="headline">Leading &amp; trailing</div>
                </md-select-option>
                <md-select-option value="IGNORE_ALL">
                  <div slot="headline">All</div>
                </md-select-option>
              </md-outlined-select>
            </span>
          </div>
        </section>
      </div>
    `}hasUnsavedChanges(){return Boolean(this.originalDiffPrefs?.syntax_highlighting)!==Boolean(this.diffPrefs?.syntax_highlighting)||this.originalDiffPrefs?.context!==this.diffPrefs?.context||Boolean(this.originalDiffPrefs?.line_wrapping)!==Boolean(this.diffPrefs?.line_wrapping)||this.originalDiffPrefs?.line_length!==this.diffPrefs?.line_length||this.originalDiffPrefs?.tab_size!==this.diffPrefs?.tab_size||this.originalDiffPrefs?.font_size!==this.diffPrefs?.font_size||this.originalDiffPrefs?.ignore_whitespace!==this.diffPrefs?.ignore_whitespace||Boolean(this.originalDiffPrefs?.show_tabs)!==Boolean(this.diffPrefs?.show_tabs)||Boolean(this.originalDiffPrefs?.show_whitespace_errors)!==Boolean(this.diffPrefs?.show_whitespace_errors)||Boolean(this.originalDiffPrefs?.manual_review)!==Boolean(this.diffPrefs?.manual_review)}async save(){this.diffPrefs&&(await this.getUserModel().updateDiffPreference(this.diffPrefs),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()}))}};wM([Hc("#columnsInput")],_M.prototype,"columnsInput",void 0),wM([Hc("#tabSizeInput")],_M.prototype,"tabSizeInput",void 0),wM([Hc("#fontSizeInput")],_M.prototype,"fontSizeInput",void 0),wM([Hc("#lineWrappingInput")],_M.prototype,"lineWrappingInput",void 0),wM([Hc("#showTabsInput")],_M.prototype,"showTabsInput",void 0),wM([Hc("#showTrailingWhitespaceInput")],_M.prototype,"showTrailingWhitespaceInput",void 0),wM([Hc("#automaticReviewInput")],_M.prototype,"automaticReviewInput",void 0),wM([Hc("#syntaxHighlightInput")],_M.prototype,"syntaxHighlightInput",void 0),wM([Hc("#contextSelect")],_M.prototype,"contextSelect",void 0),wM([Uc()],_M.prototype,"diffPrefs",void 0),wM([Uc()],_M.prototype,"originalDiffPrefs",void 0),_M=wM([Dc("gr-diff-preferences")],_M);var xM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let CM=class extends Ic{constructor(){super(...arguments),this.handleCancelDiff=e=>{e.stopPropagation(),ba(this.diffPrefsModal,"diffPrefsModal"),this.diffPrefsModal.close()},this.handleHasUnsavedChangesChanged=e=>{this.diffPrefsChanged=e.detail.value}}static get styles(){return[Nc,Iw,Sd`
        .diffHeader,
        .diffActions {
          padding: var(--spacing-l) var(--spacing-xl);
        }
        .diffHeader,
        .diffActions {
          background-color: var(--dialog-background-color);
        }
        .diffHeader {
          border-bottom: 1px solid var(--border-color);
          font-weight: var(--font-weight-medium);
        }
        .diffActions {
          border-top: 1px solid var(--border-color);
          display: flex;
          justify-content: flex-end;
        }
        .diffPrefsModal gr-button {
          margin-left: var(--spacing-l);
        }
        div.edited:after {
          color: var(--deemphasized-text-color);
          content: ' *';
        }
        #diffPreferences {
          display: flex;
          padding: var(--spacing-s) var(--spacing-xl);
        }
      `]}render(){return dc`
      <dialog id="diffPrefsModal" tabindex="-1">
        <div role="dialog" aria-labelledby="diffPreferencesTitle">
          <h3
            class="heading-3 diffHeader ${this.diffPrefsChanged?"edited":""}"
            id="diffPreferencesTitle"
          >
            Diff Preferences
          </h3>
          <gr-diff-preferences
            id="diffPreferences"
            @has-unsaved-changes-changed=${this.handleHasUnsavedChangesChanged}
          ></gr-diff-preferences>
          <div class="diffActions">
            <gr-button
              id="cancelButton"
              link=""
              @click=${this.handleCancelDiff}
            >
              Cancel
            </gr-button>
            <gr-button
              id="saveButton"
              link=""
              primary=""
              @click=${()=>{this.handleSaveDiffPreferences()}}
              ?disabled=${!this.diffPrefsChanged}
            >
              Save
            </gr-button>
          </div>
        </div>
      </dialog>
    `}resetFocus(){ba(this.diffPreferences,"diffPreferences"),this.diffPreferences.contextSelect.focus()}open(){ba(this.diffPrefsModal,"diffPrefsModal"),this.diffPrefsModal.showModal()}async handleSaveDiffPreferences(){ba(this.diffPreferences,"diffPreferences"),ba(this.diffPrefsModal,"diffPrefsModal"),await this.diffPreferences.save(),this.diffPrefsModal.close()}};xM([Hc("#diffPreferences")],CM.prototype,"diffPreferences",void 0),xM([Hc("#diffPrefsModal")],CM.prototype,"diffPrefsModal",void 0),xM([Uc()],CM.prototype,"diffPrefsChanged",void 0),CM=xM([Dc("gr-diff-preferences-dialog")],CM);var EM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let SM=class extends Ic{constructor(){super(...arguments),this._allFileActions=Object.values(qL)}static get styles(){return[Nc,Sd`
        :host {
          align-items: center;
          display: flex;
          justify-content: flex-end;
        }
        gr-dropdown {
          --gr-dropdown-item-color: var(--link-color);
          --gr-button-padding: var(--spacing-xs) var(--spacing-s);
          --gr-dropdown-item-background-color: transparent;
          --gr-dropdown-item-border: none;
        }
        #actions {
          margin-right: var(--spacing-l);
        }
      `]}render(){const e=this._computeFileActions(this._allFileActions);return dc` <gr-dropdown
      id="actions"
      .items=${e}
      down-arrow=""
      @tap-item=${this._handleActionTap}
      link=""
      >Actions</gr-dropdown
    >`}_handleActionTap(e){e.preventDefault(),e.stopPropagation();const t=e.detail.id;t&&this.filePath&&this._dispatchFileAction(t,this.filePath)}_dispatchFileAction(e,t){Jn(this,"file-action-tap",{action:e,path:t})}_computeFileActions(e){return e.filter((e=>this.filePath!==hg.COMMIT_MESSAGE||e.label===qL.OPEN.label)).map((e=>({name:e.label,id:e.id})))}};EM([Fc({type:String})],SM.prototype,"filePath",void 0),EM([Fc({type:Array})],SM.prototype,"_allFileActions",void 0),SM=EM([Dc("gr-edit-file-controls")],SM);const $M="target-side-left",kM="target-side-right";function AM(e){const t=e.parentElement;if(!t)return;if("TBODY"===t.tagName)return t;const i=t.parentElement;return i&&"TBODY"===i.tagName?i:void 0}class RM{set side(e){this.sideInternal!==e&&(this.diffRowTR&&this.fireCursorMoved("line-cursor-moved-out"),this.sideInternal=e,this.updateSideClass(),this.diffRowTR&&this.fireCursorMoved("line-cursor-moved-in"))}get side(){return this.sideInternal}set diffRowTR(e){this.diffRowTRInternal&&(this.diffRowTRInternal.classList.remove($M,kM),this.fireCursorMoved("line-cursor-moved-out")),this.diffRowTRInternal=e,this.updateSideClass(),this.diffRowTR&&this.fireCursorMoved("line-cursor-moved-in")}get diffRowTR(){return this.diffRowTRInternal}constructor(){this.preventAutoScrollOnManualScroll=!1,this.sideInternal=$u.RIGHT,this.diffs=[],this.initialLineNumber=null,this.cursorManager=new qb,this.boundHandleWindowScroll=()=>{this.preventAutoScrollOnManualScroll&&(this.cursorManager.scrollMode=cg.NEVER,this.cursorManager.focusOnMove=!1,this.preventAutoScrollOnManualScroll=!1)},this.boundHandleDiffLoadingChanged=()=>{this.updateStops()},this.boundHandleDiffRenderStart=()=>{this.preventAutoScrollOnManualScroll=!0},this.boundHandleDiffRenderContent=()=>{this.updateStops(),this.cursorManager.focusOnMove=!0,this.preventAutoScrollOnManualScroll=!1},this.boundHandleDiffLineSelected=e=>{this.moveToLineNumber(e.detail.number,e.detail.side,e.detail.path)},this.cursorManager.cursorTargetClass="target-row",this.cursorManager.scrollMode=cg.KEEP_VISIBLE,this.cursorManager.focusOnMove=!0,window.addEventListener("scroll",this.boundHandleWindowScroll),this.targetSubscription=this.cursorManager.target$.subscribe((e=>{this.diffRowTR=e??void 0}))}dispose(){this.cursorManager.unsetCursor(),this.targetSubscription&&this.targetSubscription.unsubscribe(),window.removeEventListener("scroll",this.boundHandleWindowScroll)}isAtStart(){return this.cursorManager.isAtStart()}isAtEnd(){return this.cursorManager.isAtEnd()}moveLeft(){this.side=$u.LEFT,this.isTargetBlank()&&this.moveUp()}moveRight(){this.side=$u.RIGHT,this.isTargetBlank()&&this.moveUp()}moveDown(){return this.getViewMode()===Su.SIDE_BY_SIDE?this.cursorManager.next({filter:e=>this.rowHasSide(e)}):this.cursorManager.next()}moveUp(){return this.getViewMode()===Su.SIDE_BY_SIDE?this.cursorManager.previous({filter:e=>this.rowHasSide(e)}):this.cursorManager.previous()}moveToVisibleArea(){this.getViewMode()===Su.SIDE_BY_SIDE?this.cursorManager.moveToVisibleArea((e=>this.rowHasSide(e))):this.cursorManager.moveToVisibleArea()}moveToNextChunk(e){const t=this.cursorManager.next({filter:e=>this.isFirstRowOfChunk(e),getTargetHeight:e=>AM(e)?.scrollHeight||0,clipToTop:e});return this.fixSide(),t}moveToPreviousChunk(){const e=this.cursorManager.previous({filter:e=>this.isFirstRowOfChunk(e)});return this.fixSide(),e}moveToNextCommentThread(){if(this.isAtEnd())return zb.CLIPPED;const e=this.cursorManager.next({filter:e=>this.rowHasThread(e)});return this.fixSide(),e}moveToPreviousCommentThread(){const e=this.cursorManager.previous({filter:e=>this.rowHasThread(e)});return this.fixSide(),e}moveToLineNumber(e,t,i,r){const o=this.findRowByNumberAndFile(e,t,i);o&&(this.side=t,this.cursorManager.setCursor(o,void 0,r))}getTargetDiffRow(){let e=this.diffRowTR;for(;e;){if("GR-DIFF-ROW"===e.tagName)return e;e=e.parentElement??void 0}}getTargetLineNumber(){const e=this.getTargetDiffRow();return e?.lineNumber(this.side)}getTargetDiffElement(){if(!this.diffRowTR)return;const e=this.diffRowTR.getRootNode();return"GR-DIFF"===e?.host?.tagName?e.host:void 0}moveToFirstChunk(){this.cursorManager.moveToStart(),this.diffRowTR&&!this.isFirstRowOfChunk(this.diffRowTR)?this.moveToNextChunk(!0):this.fixSide()}moveToLastChunk(){this.cursorManager.moveToEnd(),this.diffRowTR&&!this.isFirstRowOfChunk(this.diffRowTR)?this.moveToPreviousChunk():this.fixSide()}reInitCursor(){this.updateStops(),this.diffRowTR||(this.cursorManager.scrollMode=this.initialLineNumber?cg.KEEP_VISIBLE:cg.NEVER,this.initialLineNumber?(this.moveToLineNumber(this.initialLineNumber,this.side),this.initialLineNumber=null):this.moveToFirstChunk()),this.resetScrollMode()}resetScrollMode(){this.cursorManager.scrollMode=cg.KEEP_VISIBLE}reInitAndUpdateStops(){this.resetScrollMode(),this.updateStops()}createCommentInPlace(){const e=this.getSelectedDiff();if(e)e.createRangeComment();else{const e=this.getTargetDiffRow(),t=e?.lineNumber(this.side),i=this.getTargetDiffElement();i&&t&&i.addDraftAtLine(t,this.side)}}getSelectedDiff(){return this.diffs.find((e=>e.isRangeSelected()))}getSelectedRange(){const e=this.getSelectedDiff();if(e)return e.getSelectedRange()}getViewMode(){return this.diffRowTR?this.diffRowTR.classList.contains("side-by-side")?Su.SIDE_BY_SIDE:Su.UNIFIED:null}rowHasSide(e){const t=(this.side===$u.LEFT?".left":".right")+" + .content";return!!e.querySelector(t)}isFirstRowOfChunk(e){const t=AM(e);return!!t&&(!!t.classList.contains("delta")&&t.querySelector("tr:not(.moveControls)")===e)}rowHasThread(e){return[...e.querySelectorAll(".thread-group > slot")].some((e=>e.assignedElements().length>0))}fixSide(){this.getViewMode()===Su.SIDE_BY_SIDE&&this.isTargetBlank()&&(this.side=this.side===$u.LEFT?$u.RIGHT:$u.LEFT)}isTargetBlank(){const e=this.getTargetDiffRow()?.line(this.side);return e?.type===Iu.BLANK}fireCursorMoved(e){const t=this.getTargetLineNumber();t&&Jn(this.diffRowTR,e,{lineNum:t,side:this.side})}updateSideClass(){this.diffRowTR&&(this.diffRowTR.classList.toggle($M,this.side===$u.LEFT),this.diffRowTR.classList.toggle(kM,this.side===$u.RIGHT))}updateStops(){this.cursorManager.stops=this.diffs.reduce(((e,t)=>e.concat(t.getCursorStops())),[])}replaceDiffs(e){for(const e of this.diffs)this.removeEventListeners(e);this.diffs=[];for(const t of e)this.addEventListeners(t);this.diffs.push(...e),this.updateStops()}unregisterDiff(e){if(!this.diffs)return;const t=this.diffs.indexOf(e);-1!==t&&this.diffs.splice(t,1)}removeEventListeners(e){e.removeEventListener("loading-changed",this.boundHandleDiffLoadingChanged),e.removeEventListener("render-start",this.boundHandleDiffRenderStart),e.removeEventListener("render-content",this.boundHandleDiffRenderContent),e.removeEventListener("line-selected",this.boundHandleDiffLineSelected)}addEventListeners(e){e.addEventListener("loading-changed",this.boundHandleDiffLoadingChanged),e.addEventListener("render-start",this.boundHandleDiffRenderStart),e.addEventListener("render-content",this.boundHandleDiffRenderContent),e.addEventListener("line-selected",this.boundHandleDiffLineSelected)}findRowByNumberAndFile(e,t,i){let r;r=i?this.diffs.filter((e=>e.path===i))[0].getCursorStops():this.cursorManager.stops;const o=r.filter(Wb),s=`.lineNum.${t}[data-value="${e}"]`;return o.find((e=>e.querySelector(s)))}}function TM(e,t){return{__path:t,lines_inserted:0,lines_deleted:0,size_delta:0,size:0,...e}}function IM(e){const t=[];for(const[i,r]of Object.entries(e??{}))t.push(TM(r,i));return t.sort(((e,t)=>$g(e.__path,t.__path))),t}const PM={files:[],filesLeftBase:[],filesRightBase:[]},NM=mu("files-model");class OM extends df{constructor(e,t,i,r,o){super(PM),this.changeModel=e,this.commentsModel=t,this.checksModel=i,this.restApiService=r,this.reporting=o,this.files$=lf(this.state$,(e=>e.files)),this.file$=e=>Yh([e,this.files$]).pipe(ep((([e,t])=>t.find((t=>t.__path===e))))),this.filesIncludingUnmodified$=lf(Yh([this.files$,this.commentsModel.commentedPaths$,this.checksModel.allResults$]),(([e,t,i])=>function(e,t,i){const r=[...e];for(const i of t)i!==hg.PATCHSET_LEVEL_COMMENTS&&(e.some((e=>e.__path===i))||e.some((e=>e.status===Mu.RENAMED&&e.old_path===i))||r.push(TM({status:Mu.UNMODIFIED},i)));if(i)for(const t of i)if(t.codePointers?.length)for(const i of t.codePointers){const t=i.path;t&&(e.some((e=>e.__path===t))||e.some((e=>e.status===Mu.RENAMED&&e.old_path===t))||r.some((e=>e.__path===t))||r.push(TM({status:Mu.UNMODIFIED},t)))}return r.sort(((e,t)=>$g(e.__path,t.__path))),r}(e,t,i))),this.filesLeftBase$=lf(this.state$,(e=>e.filesLeftBase)),this.filesRightBase$=lf(this.state$,(e=>e.filesRightBase)),this.subscriptions=[this.reportChangeDataStart(),this.reportChangeDataEnd(),this.subscribeToFiles(((e,t)=>({basePatchNum:e,patchNum:t})),(e=>({files:[...e]}))),this.subscribeToFiles(((e,t)=>{if(!(e===Qu||e<=0))return{basePatchNum:Qu,patchNum:e}}),(e=>({filesLeftBase:[...e]}))),this.subscribeToFiles(((e,t)=>{if(!(e===Qu||e<=0))return{basePatchNum:Qu,patchNum:t}}),(e=>({filesRightBase:[...e]})))]}reportChangeDataStart(){return Yh([this.changeModel.loading$]).subscribe((([e])=>{e&&this.reporting.time(ua.CHANGE_DATA)}))}reportChangeDataEnd(){return Yh([this.changeModel.loading$,this.files$]).subscribe((([e,t])=>{!e&&t.length>0&&this.reporting.timeEnd(ua.CHANGE_DATA)}))}subscribeToFiles(e,t){return Yh([this.changeModel.changeNum$,this.changeModel.basePatchNum$,this.changeModel.patchNum$]).pipe(Vp((([t,i,r])=>{if(!t||!r)return Zh({});const o=e(i,r);return o?Qh(this.restApiService.getChangeOrEditFiles(t,o)):Zh({})})),ep(IM),ep(t)).subscribe((e=>{this.updateState(e)}))}}var DM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const LM="file-row";let MM=class extends Ic{get patchRange(){if(this.patchNum)return{patchNum:this.patchNum,basePatchNum:this.basePatchNum}}get filesExpanded(){return this._filesExpanded}set filesExpanded(e){if(this._filesExpanded===e)return;const t=this._filesExpanded;this._filesExpanded=e,Jn(this,"files-expanded-changed",{value:this._filesExpanded}),this.requestUpdate("filesExpanded",t)}static get styles(){return[yO,Nc,Sd`
        :host {
          display: block;
        }
        .row {
          align-items: center;
          border-top: 1px solid var(--border-color);
          display: flex;
          min-height: calc(var(--line-height-normal) + 2 * var(--spacing-s));
          padding: var(--spacing-xs) var(--spacing-l);
        }
        /* The class defines a content visible only to screen readers */
        .noCommentsScreenReaderText {
          opacity: 0;
          max-width: 1px;
          overflow: hidden;
          display: none;
          vertical-align: top;
        }
        div[role='gridcell']
          > div.comments
          > span:empty
          + span:empty
          + span.noCommentsScreenReaderText {
          /* inline-block instead of block, such that it can control width */
          display: inline-block;
        }
        :host(.editMode) .hideOnEdit {
          display: none;
        }
        .showOnEdit {
          display: none;
        }
        :host(.editMode) .showOnEdit {
          display: initial;
        }
        .invisible {
          visibility: hidden;
        }
        .header-row {
          background-color: var(--background-color-secondary);
        }
        .controlRow {
          align-items: center;
          display: flex;
          height: 2.25em;
          justify-content: center;
        }
        .controlRow.invisible,
        .show-hide.invisible {
          display: none;
        }
        .reviewed {
          align-items: center;
          display: inline-flex;
        }
        .reviewed {
          display: inline-block;
          text-align: left;
          width: 1.5em;
        }
        .file-row {
          cursor: pointer;
        }
        .file-row.expanded {
          border-bottom: 1px solid var(--border-color);
          position: -webkit-sticky;
          position: sticky;
          top: 0;
          /* Has to visible above the diff view, and by default has a lower
            z-index. setting to 1 places it directly above. */
          z-index: 1;
        }
        .separator-row {
          background-color: var(--background-color-secondary);
          border-top: 1px solid var(--border-color);
          color: var(--deemphasized-text-color);
          padding: var(--spacing-l);
        }
        .separator-row .path {
          color: var(--deemphasized-text-color);
          font-style: italic;
        }
        .separator-row .path gr-icon {
          margin-left: var(--spacing-s);
        }
        .file-row:hover {
          background-color: var(--hover-background-color);
        }
        .file-row.selected {
          background-color: var(--selection-background-color);
        }
        .file-row.expanded,
        .file-row.expanded:hover {
          background-color: var(--expanded-background-color);
        }
        .status {
          margin-right: var(--spacing-m);
          display: flex;
          width: 20px;
          justify-content: flex-end;
        }
        .status.extended {
          width: 56px;
        }
        .status > * {
          display: block;
        }
        .header-row .status .content {
          width: 20px;
          text-align: center;
        }
        .path {
          flex: 1;
          /* Wrap it into multiple lines if too long. */
          white-space: normal;
          overflow-wrap: anywhere;
        }
        .oldPath {
          color: var(--deemphasized-text-color);
        }
        .header-stats {
          text-align: center;
          min-width: 7.5em;
        }
        .stats {
          text-align: right;
          min-width: 7.5em;
        }
        .comments {
          padding-left: var(--spacing-l);
          min-width: 7.5em;
          white-space: nowrap;
        }
        .row:not(.header-row) .stats,
        .total-stats {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          display: flex;
        }
        .sizeBars {
          margin-left: var(--spacing-m);
          min-width: 7em;
          text-align: center;
        }
        .sizeBars.hide {
          display: none;
        }
        .added,
        .removed {
          display: inline-block;
          min-width: 3.5em;
        }
        .added {
          color: var(--positive-green-text-color);
          text-align: left;
          min-width: 4em;
          padding-left: var(--spacing-s);
        }
        .removed {
          color: var(--negative-red-text-color);
        }
        .drafts {
          color: var(--error-foreground);
          font-weight: var(--font-weight-medium);
        }
        .show-hide-icon:focus {
          outline: none;
        }
        .show-hide {
          margin-left: var(--spacing-s);
          width: 1.9em;
        }
        .fileListButton {
          margin: var(--spacing-m);
        }
        .totalChanges {
          justify-content: flex-end;
          text-align: right;
        }
        .warning {
          color: var(--deemphasized-text-color);
        }
        input.show-hide {
          display: none;
        }
        label.show-hide {
          cursor: pointer;
          display: block;
          min-width: 2em;
        }
        gr-diff {
          display: block;
          overflow-x: auto;
        }
        .matchingFilePath {
          color: var(--deemphasized-text-color);
        }
        .newFilePath {
          color: var(--primary-text-color);
          font-weight: var(--font-weight-medium);
        }
        .fileName {
          color: var(--link-color);
          font-weight: var(--font-weight-medium);
        }
        .truncatedFileName {
          display: none;
        }
        .mobile {
          display: none;
        }
        .reviewed {
          margin-left: var(--spacing-xxl);
          width: 15em;
        }
        .reviewedSwitch {
          color: var(--link-color);
          opacity: 0;
          justify-content: flex-end;
          width: 100%;
        }
        .reviewedSwitch:hover {
          cursor: pointer;
          opacity: 100;
        }
        .showParentButton {
          line-height: var(--line-height-normal);
          margin-bottom: calc(var(--spacing-s) * -1);
          margin-left: var(--spacing-m);
          margin-top: calc(var(--spacing-s) * -1);
        }
        .row:focus {
          outline: none;
        }
        .row:hover .reviewedSwitch,
        .row:focus-within .reviewedSwitch,
        .row.expanded .reviewedSwitch {
          opacity: 100;
        }
        .reviewedLabel {
          color: var(--deemphasized-text-color);
          margin-right: var(--spacing-l);
          opacity: 0;
        }
        .reviewedLabel.isReviewed {
          display: initial;
          opacity: 100;
        }
        .editFileControls {
          width: 7em;
        }
        .markReviewed:focus {
          outline: none;
        }
        .markReviewed,
        .pathLink {
          display: inline-block;
          margin: -2px 0;
          padding: var(--spacing-s) 0;
          text-decoration: none;
        }
        .pathLink:hover span.fullFileName,
        .pathLink:hover span.truncatedFileName {
          text-decoration: underline;
        }

        /** copy on file path **/
        .pathLink gr-copy-clipboard,
        .oldPath gr-copy-clipboard {
          display: inline-block;
          visibility: hidden;
          vertical-align: bottom;
          --gr-button-padding: 0px;
        }
        .row:focus-within gr-copy-clipboard,
        .row:hover gr-copy-clipboard {
          visibility: visible;
        }

        .file-status-arrow {
          font-size: 16px;
          position: relative;
          top: 2px;
          display: block;
        }
        .file-mode-warning {
          font-size: 16px;
          position: relative;
          top: 2px;
          color: var(--warning-foreground);
        }
        .file-mode-content {
          display: inline-block;
          color: var(--deemphasized-text-color);
        }

        @media screen and (max-width: 1200px) {
          gr-endpoint-decorator.extra-col {
            display: none;
          }
        }

        @media screen and (max-width: 1000px) {
          .reviewed {
            display: none;
          }
        }

        @media screen and (max-width: 800px) {
          .desktop {
            display: none;
          }
          .mobile {
            display: block;
          }
          .row.selected {
            background-color: var(--view-background-color);
          }
          .stats {
            display: none;
          }
          .reviewed,
          .status {
            justify-content: flex-start;
          }
          .comments {
            min-width: initial;
          }
          .expanded .fullFileName,
          .truncatedFileName {
            display: inline;
          }
          .expanded .truncatedFileName,
          .fullFileName {
            display: none;
          }
        }
        :host(.hideComments) {
          --gr-comment-thread-display: none;
        }
        :host(.hideCheckCodePointers) {
          --gr-check-code-pointers-display: none;
        }
        .checkChip {
          display: inline-flex;
          align-items: center;
          gap: var(--spacing-xs);
          border: 1px solid;
          border-radius: 999px;
          padding: var(--spacing-xxs) var(--spacing-m) var(--spacing-xxs)
            var(--spacing-s);
          vertical-align: top;
          position: relative;
          top: 2px;
          font-size: var(--font-size-small);
          font-weight: var(--font-weight-normal);
          line-height: var(--line-height-small);
          color: var(--primary-text-color);
          & gr-icon {
            font-size: var(--line-height-small);
          }
          &.info {
            border-color: var(--info-foreground);
            background-color: var(--info-background);
            & gr-icon {
              color: var(--info-foreground);
            }
          }
          &.warning {
            border-color: var(--warning-foreground);
            background-color: var(--warning-background);
            & gr-icon {
              color: var(--warning-foreground);
            }
          }
          &.error {
            border-color: var(--error-foreground);
            background-color: var(--error-background);
            & gr-icon {
              color: var(--error-foreground);
            }
          }
        }
      `]}constructor(){super(),this.basePatchNum=Qu,this.selectedIndex=0,this.editMode=!1,this._filesExpanded=JL.NONE,this.files=[],this.modifiedFiles=[],this.unmodifiedFiles=[],this.filesLeftBase=[],this.filesRightBase=[],this.loggedIn=!1,this.reviewed=[],this.numFilesShown=0,this.fileListIncrement=200,this.expandedFiles=[],this.showSizeBars=!0,this.cleanlyMergedPaths=[],this.cleanlyMergedOldPaths=[],this.sizeBarLayout={maxInserted:0,maxDeleted:0,maxAdditionWidth:0,maxDeletionWidth:0,additionOffset:0},this.reporting=Xn().reportingService,this.restApiService=Xn().restApiService,this.getPluginLoader=yu(this,U_),this.getUserModel=yu(this,jf),this.getChangeModel=yu(this,MT),this.getFilesModel=yu(this,NM),this.getCommentsModel=yu(this,kP),this.getChecksModel=yu(this,sP),this.getBrowserModel=yu(this,LL),this.shortcutsController=new Gg(this),this.getNavigation=yu(this,gy),this.getViewModel=yu(this,XC),this.fileCursor=new qb,this.fileCursor.scrollMode=cg.KEEP_VISIBLE,this.fileCursor.cursorTargetClass="selected",this.fileCursor.focusOnMove=!0,this.shortcutsController.addAbstract(pu.LEFT_PANE,(e=>this.handleLeftPane())),this.shortcutsController.addAbstract(pu.RIGHT_PANE,(e=>this.handleRightPane())),this.shortcutsController.addAbstract(pu.TOGGLE_INLINE_DIFF,(e=>this.handleToggleInlineDiff())),this.shortcutsController.addAbstract(pu.TOGGLE_ALL_INLINE_DIFFS,(e=>this.toggleInlineDiffs())),this.shortcutsController.addAbstract(pu.TOGGLE_HIDE_ALL_COMMENT_THREADS_AND_CODE_POINTERS,(e=>this.toggleHideAllCommentsAndCodePointers())),this.shortcutsController.addAbstract(pu.TOGGLE_HIDE_CHECK_CODE_POINTERS,(e=>this.toggleHideCheckCodePointers())),this.shortcutsController.addAbstract(pu.CURSOR_NEXT_FILE,(e=>this.handleCursorNext(e)),{preventDefault:!1}),this.shortcutsController.addAbstract(pu.CURSOR_PREV_FILE,(e=>this.handleCursorPrev(e)),{preventDefault:!1}),this.shortcutsController.addAbstract(pu.NEXT_LINE,(e=>{}),{preventDefault:!1}),this.shortcutsController.addAbstract(pu.PREV_LINE,(e=>{}),{preventDefault:!1}),this.shortcutsController.addAbstract(pu.NEW_COMMENT,(e=>this.handleNewComment())),this.shortcutsController.addAbstract(pu.OPEN_LAST_FILE,(e=>this.openSelectedFile(this.files.length-1))),this.shortcutsController.addAbstract(pu.OPEN_FIRST_FILE,(e=>this.openSelectedFile(0))),this.shortcutsController.addAbstract(pu.OPEN_FILE,(e=>this.handleOpenFile())),this.shortcutsController.addAbstract(pu.NEXT_CHUNK,(e=>this.handleNextChunk())),this.shortcutsController.addAbstract(pu.PREV_CHUNK,(e=>this.handlePrevChunk())),this.shortcutsController.addAbstract(pu.NEXT_COMMENT_THREAD,(e=>this.handleNextComment())),this.shortcutsController.addAbstract(pu.PREV_COMMENT_THREAD,(e=>this.handlePrevComment())),this.shortcutsController.addAbstract(pu.TOGGLE_FILE_REVIEWED,(e=>this.handleToggleFileReviewed())),this.shortcutsController.addAbstract(pu.TOGGLE_LEFT_PANE,(e=>this.handleToggleLeftPane())),this.shortcutsController.addAbstract(pu.EXPAND_ALL_COMMENT_THREADS,(e=>{})),this.shortcutsController.addAbstract(pu.COLLAPSE_ALL_COMMENT_THREADS,(e=>{})),this.shortcutsController.addLocal({key:Mn.ENTER},(e=>this.handleOpenFile()),{shouldSuppress:!0}),zf(this,(()=>this.getCommentsModel().changeComments$),(e=>{this.changeComments=e})),zf(this,(()=>this.getChecksModel().allResultsSelected$),(e=>{this.checkResults=e})),zf(this,(()=>this.getFilesModel().filesIncludingUnmodified$),(e=>{this.modifiedFiles=e.filter((e=>e.status!==Mu.UNMODIFIED)),this.unmodifiedFiles=e.filter((e=>e.status===Mu.UNMODIFIED)),this.files=[...this.modifiedFiles,...this.unmodifiedFiles]})),zf(this,(()=>this.getFilesModel().filesLeftBase$),(e=>{this.filesLeftBase=[...e]})),zf(this,(()=>this.getFilesModel().filesRightBase$),(e=>{this.filesRightBase=[...e]})),zf(this,(()=>this.getBrowserModel().diffViewMode$),(e=>{this.diffViewMode=e})),zf(this,(()=>this.getUserModel().diffPreferences$),(e=>{this.diffPrefs=e})),zf(this,(()=>lf(this.getUserModel().preferences$,(e=>!!e?.size_bar_in_change_table))),(e=>{this.showSizeBars=e})),zf(this,(()=>this.getUserModel().loggedIn$),(e=>{this.loggedIn=e})),zf(this,(()=>this.getChangeModel().reviewedFiles$),(e=>{this.reviewed=e??[]})),zf(this,(()=>this.getChangeModel().patchNum$),(e=>this.patchNum=e)),zf(this,(()=>this.getChangeModel().basePatchNum$),(e=>this.basePatchNum=e))}willUpdate(e){(e.has("patchNum")||e.has("basePatchNum"))&&(this.resetFileState(),this.collapseAllDiffs()),(e.has("diffPrefs")||e.has("diffViewMode"))&&this.updateDiffPreferences(),e.has("files")&&(this.filesChanged(),this.numFilesShown=Math.min(this.files.length,200),this.updateSizeBarLayout(),Jn(this,"files-shown-changed",{length:this.numFilesShown})),e.has("expandedFiles")&&this.expandedFilesChanged(e.get("expandedFiles")),e.has("numFilesShown")&&(Jn(this,"files-shown-changed",{length:this.numFilesShown}),this.updateSizeBarLayout())}connectedCallback(){super.connectedCallback(),this.getPluginLoader().awaitPluginsLoaded().then((()=>{this.dynamicHeaderEndpoints=this.getPluginLoader().pluginEndPoints.getDynamicEndpoints("change-view-file-list-header"),this.dynamicContentEndpoints=this.getPluginLoader().pluginEndPoints.getDynamicEndpoints("change-view-file-list-content"),this.dynamicPrependedHeaderEndpoints=this.getPluginLoader().pluginEndPoints.getDynamicEndpoints("change-view-file-list-header-prepend"),this.dynamicPrependedContentEndpoints=this.getPluginLoader().pluginEndPoints.getDynamicEndpoints("change-view-file-list-content-prepend"),this.dynamicSummaryEndpoints=this.getPluginLoader().pluginEndPoints.getDynamicEndpoints("change-view-file-list-summary"),this.dynamicHeaderEndpoints.length!==this.dynamicContentEndpoints.length&&this.reporting.error("Plugin change-view-file-list",new Error("dynamic header/content mismatch")),this.dynamicPrependedHeaderEndpoints.length!==this.dynamicPrependedContentEndpoints.length&&this.reporting.error("Plugin change-view-file-list",new Error("dynamic prepend header/content mismatch")),this.dynamicHeaderEndpoints.length!==this.dynamicSummaryEndpoints.length&&this.reporting.error("Plugin change-view-file-list",new Error("dynamic header/summary mismatch"))})),this.diffCursor=new RM,this.diffCursor.replaceDiffs(this.diffs)}disconnectedCallback(){this.diffCursor?.dispose(),this.fileCursor.unsetCursor(),this.cancelDiffs(),super.disconnectedCallback()}async getUpdateComplete(){const e=await super.getUpdateComplete();return await Promise.all(this.diffs.map((e=>e.updateComplete))),e}render(){this.classList.toggle("editMode",this.editMode);const e=this.calculatePatchChange();return dc`
      <h3 class="assistive-tech-only">File list</h3>
      ${this.renderContainer()} ${this.renderChangeTotals(e)}
      ${this.renderBinaryTotals(e)} ${this.renderControlRow()}
      <gr-diff-preferences-dialog id="diffPreferencesDialog">
      </gr-diff-preferences-dialog>
    `}renderContainer(){return dc`
      <div
        id="container"
        @click=${e=>this.handleFileListClick(e)}
        role="grid"
        aria-label="Files list"
      >
        ${this.renderHeaderRow()} ${this.renderShownFiles()}
        ${eb(this.computeShowNumCleanlyMerged(),(()=>this.renderCleanlyMerged()))}
      </div>
    `}renderHeaderRow(){const e=this.computeShowPrependedDynamicColumns(),t=this.computeShowDynamicColumns();return dc` <div class="header-row row" role="row">
      <!-- endpoint: change-view-file-list-header-prepend -->
      ${eb(e,(()=>this.renderPrependedHeaderEndpoints()))}
      ${this.renderFileStatus()}
      <div class="path" role="columnheader">File</div>
      <div class="comments desktop" role="columnheader">Comments</div>
      <div class="comments mobile" role="columnheader" title="Comments">C</div>
      ${eb(this.showSizeBars,(()=>dc`<div class="sizeBars desktop" role="columnheader">Size</div>`))}
      <div class="header-stats" role="columnheader">Delta</div>
      <!-- endpoint: change-view-file-list-header -->
      ${eb(t,(()=>this.renderDynamicHeaderEndpoints()))}
      <!-- Empty div here exists to keep spacing in sync with file rows. -->
      <div
        class="reviewed hideOnEdit"
        ?hidden=${!this.loggedIn}
        aria-hidden="true"
      ></div>
      <div class="editFileControls showOnEdit" aria-hidden="true"></div>
      <div class="show-hide" aria-hidden="true"></div>
    </div>`}renderPrependedHeaderEndpoints(){return this.dynamicPrependedHeaderEndpoints?.map((e=>dc`
        <gr-endpoint-decorator
          class="prepended-col"
          .name=${e}
          role="columnheader"
        >
          <gr-endpoint-param name="change" .value=${this.change}>
          </gr-endpoint-param>
          <gr-endpoint-param name="patchRange" .value=${this.patchRange}>
          </gr-endpoint-param>
          <gr-endpoint-param name="files" .value=${this.files}>
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      `))}renderDynamicHeaderEndpoints(){return this.dynamicHeaderEndpoints?.map((e=>dc`
        <gr-endpoint-decorator
          class="extra-col"
          .name=${e}
          role="columnheader"
        >
          <gr-endpoint-param name="change" .value=${this.change}>
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      `))}renderSeparator(){return dc`
      <div class="row separator-row" role="row">
        <div class="path" role="gridcell">
          <span>${"Unmodified Files"}</span>
          <gr-tooltip-content .title=${"Files not modified in this patchset, but referenced by a check or a comment. May include files outside of this change, also virtual or generated files."} has-tooltip>
            <gr-icon icon="info"></gr-icon>
          </gr-tooltip-content>
        </div>
      </div>
    `}renderShownFiles(){const e=this.computeShowDynamicColumns(),t=this.computeShowPrependedDynamicColumns(),i=this.modifiedFiles.length;return Zv({values:this.files,mapFn:(r,o)=>dc`
        ${eb(o===i&&this.modifiedFiles.length>0&&this.unmodifiedFiles.length>0,(()=>this.renderSeparator()))}
        ${this.renderFileRow(r,o,e,t)}
      `,initialCount:this.fileListIncrement,targetFrameRate:1,startAt:0,endAt:this.numFilesShown})}renderFileRow(e,t,i,r){const o=this.files[t-1]?.__path,s=this.computePatchSetFile(e);return dc` <div class="stickyArea">
      <div
        class=${`file-row row ${this.computePathClass(e.__path)}`}
        data-file=${JSON.stringify(s)}
        tabindex="-1"
        role="row"
        aria-label=${e.__path}
      >
        <!-- endpoint: change-view-file-list-content-prepend -->
        ${eb(r,(()=>this.renderPrependedContentEndpointsForFile(e)))}
        ${this.renderFileStatus(e)}
        ${this.renderFilePath(e,o)}
        ${this.renderFileComments(e)} ${this.renderSizeBar(e)}
        ${this.renderFileStats(e)}
        ${eb(i,(()=>this.renderDynamicContentEndpointsForFile(e)))}
        <!-- endpoint: change-view-file-list-content -->
        ${this.renderReviewed(e)} ${this.renderFileControls(e)}
        ${this.renderShowHide(e)}
      </div>
      ${eb(this.isFileExpanded(e.__path),(()=>dc`
          <gr-diff-host
            ?noAutoRender=${!0}
            ?showLoadFailure=${!0}
            .changeNum=${this.changeNum}
            .change=${this.change}
            .patchRange=${this.patchRange}
            .file=${s}
            .path=${e.__path}
            .projectName=${this.change?.project}
            ?noRenderOnPrefsChange=${!0}
          ></gr-diff-host>
        `))}
    </div>`}renderPrependedContentEndpointsForFile(e){return this.dynamicPrependedContentEndpoints?.map((t=>dc`
        <gr-endpoint-decorator
          class="prepended-col"
          .name=${t}
          role="gridcell"
        >
          <gr-endpoint-param name="change" .value=${this.change}>
          </gr-endpoint-param>
          <gr-endpoint-param name="changeNum" .value=${this.changeNum}>
          </gr-endpoint-param>
          <gr-endpoint-param name="patchRange" .value=${this.patchRange}>
          </gr-endpoint-param>
          <gr-endpoint-param name="path" .value=${e.__path}>
          </gr-endpoint-param>
          <gr-endpoint-param name="oldPath" .value=${this.getOldPath(e)}>
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      `))}renderFileStatus(e){const t=this.filesLeftBase.length>0,i=this.renderFileStatusLeft(e?.__path),r=this.renderFileStatusRight(e);return dc`<div
      class=${th({status:!0,extended:t})}
      role="gridcell"
    >
      ${i}${r}
    </div>`}renderDivWithTooltip(e,t,i="content"){return dc`
      <gr-tooltip-content title=${t} has-tooltip>
        <div class=${i}>${e}</div>
      </gr-tooltip-content>
    `}renderFileStatusRight(e){const t=this.filesLeftBase.length>0;if(!e){const e=this.patchNum;return t?this.renderDivWithTooltip(`${e}`,`Patchset ${e}`):uc}if(Ag(e.__path))return uc;const i=this.filesLeftBase.some((t=>t.__path===e?.__path)),r=t&&!i,o=i&&!this.filesRightBase.some((t=>t.__path===e?.__path))?Mu.REVERTED:e?.status??Mu.MODIFIED,s=`patchset ${this.basePatchNum}`,n=`patchset ${this.patchNum}`;return dc`<gr-file-status
      .status=${o}
      .labelPostfix=${` between ${s} and ${n}`}
      ?newlyChanged=${r}
    ></gr-file-status>`}renderFileStatusLeft(e){if(0===this.filesLeftBase.length)return uc;const t=dc`
      <gr-icon
        icon="arrow_right_alt"
        class="file-status-arrow"
        aria-label="then"
      ></gr-icon>
    `,i=this.basePatchNum;if(!e)return dc`
        ${this.renderDivWithTooltip(`${i}`,`Patchset ${i}`)} ${t}
      `;if(Ag(e))return uc;const r=this.filesLeftBase.find((t=>t.__path===e));if(!r)return uc;const o=r.status??Mu.MODIFIED,s=`patchset ${this.basePatchNum}`;return dc`
      <gr-file-status
        .status=${o}
        .labelPostfix=${` between base and ${s}`}
      ></gr-file-status>
      ${t}
    `}renderFilePath(e,t){return dc`
      <span class="path" role="gridcell">
        <a class="pathLink" href=${Vw(this.computeDiffURL(e.__path))}>
          <span title=${kg(e.__path)} class="fullFileName">
            ${this.renderStyledPath(e.__path,t)}
          </span>
          <span
            title=${kg(e.__path)}
            class="truncatedFileName"
          >
            ${Rg(e.__path)}
          </span>
          ${this.renderFileMode(e)}
          <gr-copy-clipboard
            ?hideInput=${!0}
            .text=${e.__path}
          ></gr-copy-clipboard>
        </a>
        ${eb(e.old_path,(()=>dc`
            <div class="oldPath" title=${Vw(e.old_path)}>
              ${e.old_path}
              <gr-copy-clipboard
                ?hideInput=${!0}
                .text=${e.old_path}
              ></gr-copy-clipboard>
            </div>
          `))}
      </span>
    `}renderFileMode(e){const{old_mode:t,new_mode:i}=e;if(void 0===i)return uc;let r=UR(i,!1);if(i===LR.REGULAR_FILE){if(void 0===t)return uc;if(t===LR.REGULAR_FILE)return uc;r=`non-${UR(t,!1)}`}const o=void 0!==t&&t!==i,s=o?dc`<gr-icon icon="warning" class="file-mode-warning"></gr-icon> `:"",n=o?`changed from ${UR(t)} to`:"is";return this.renderDivWithTooltip(dc`${s}(${r})`,`file mode ${n} ${UR(i)}`,"file-mode-content")}renderStyledPath(e,t){const{matchingFolders:i,newFolders:r,fileName:o}=function(e,t){const i=kg(e),r=kg(t),o=i.split("/"),s=r.split("/"),n=o.findIndex(((e,t)=>s[t]!==e)),a=o.slice(0,n).join("/"),l=o.slice(n,-1).join("/"),d=o[o.length-1];return{matchingFolders:a.length>0?`${a}/`:"",newFolders:l.length>0?`${l}/`:"",fileName:d}}(e,t);return[i.length>0?dc`<span class="matchingFilePath">${i}</span>`:uc,r.length>0?dc`<span class="newFilePath">${r}</span>`:uc,dc`<span class="fileName">${o}</span>`]}renderFileComments(e){return dc` <div role="gridcell">
      <div class="comments desktop">
        <span>${this.renderCommentsChips(e)}</span>
        <span>${this.renderChecksChips(e)}</span>
        <span class="noCommentsScreenReaderText">
          <!-- Screen readers read the following content only if 2 other
          spans in the parent div is empty. The content is not visible on
          the page.
          Without this span, screen readers don't navigate correctly inside
          table, because empty div doesn't rendered. For example, VoiceOver
          jumps back to the whole table.
          We can use &nbsp instead, but it sounds worse.
          -->
          No comments
        </span>
      </div>
      <div class="comments mobile">
        <span class="drafts">${this.computeDraftsStringMobile(e)}</span>
        <span>${this.computeCommentsStringMobile(e)}</span>
        <span class="noCommentsScreenReaderText">
          <!-- The same as for desktop comments -->
          No comments
        </span>
      </div>
    </div>`}renderSizeBar(e){const t=this.sizeBarLayout;return dc` <div class="desktop" role="gridcell">
      <!-- The content must be in a separate div. It guarantees, that
          gridcell always visible for screen readers.
          For example, without a nested div screen readers pronounce the
          "Commit message" row content with incorrect column headers.
        -->
      <div class=${this.computeSizeBarsClass(e.__path)} aria-hidden="true">
        <svg width="61" height="8">
          <rect
            x=${this.computeBarDeletionX(e,t)}
            y="0"
            height="8"
            fill="var(--negative-red-text-color)"
            width=${this.computeBarDeletionWidth(e,t)}
          ></rect>
          <rect
            x=${this.computeBarAdditionX(t)}
            y="0"
            height="8"
            fill="var(--positive-green-text-color)"
            width=${this.computeBarAdditionWidth(e,t)}
          ></rect>
        </svg>
      </div>
    </div>`}renderFileStats(e){return dc` <div class="stats" role="gridcell">
      <!-- The content must be in a separate div. It guarantees, that
        gridcell always visible for screen readers.
        For example, without a nested div screen readers pronounce the
        "Commit message" row content with incorrect column headers.
        -->
      <div class=${this.computeClass("",e.__path)}>
        <span
          class="removed"
          tabindex="0"
          aria-label=${`${e.lines_deleted} removed`}
          ?hidden=${!!e.binary}
        >
          -${e.lines_deleted}
        </span>
        <span
          class="added"
          tabindex="0"
          aria-label=${`${e.lines_inserted} added`}
          ?hidden=${!!e.binary}
        >
          +${e.lines_inserted}
        </span>
        <span
          class=${Vw(this.computeBinaryClass(e.size_delta))}
          ?hidden=${!e.binary}
        >
          ${jR(e.size_delta)}
          ${this.formatPercentage(e.size,e.size_delta)}
        </span>
      </div>
    </div>`}renderDynamicContentEndpointsForFile(e){return this.dynamicContentEndpoints?.map((t=>dc` <div
        class=${this.computeClass("",e.__path)}
        role="gridcell"
      >
        <gr-endpoint-decorator class="extra-col" .name=${t}>
          <gr-endpoint-param name="change" .value=${this.change}>
          </gr-endpoint-param>
          <gr-endpoint-param name="changeNum" .value=${this.changeNum}>
          </gr-endpoint-param>
          <gr-endpoint-param name="patchRange" .value=${this.patchRange}>
          </gr-endpoint-param>
          <gr-endpoint-param name="path" .value=${e.__path}>
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      </div>`))}renderReviewed(e){if(!this.loggedIn)return uc;const t=this.reviewed.includes(e.__path),i=`Mark as ${t?"not ":""}reviewed (shortcut: r)`,r=t?"MARK UNREVIEWED":"MARK REVIEWED";return dc` <div class="reviewed hideOnEdit" role="gridcell">
      <span
        class=${"reviewedLabel "+(t?"isReviewed":"")}
        aria-hidden=${this.booleanToString(!t)}
        >Reviewed</span
      >
      <!-- Do not use input type="checkbox" with hidden input and
              visible label here. Screen readers don't read/interract
              correctly with such input.
          -->
      <span
        class="reviewedSwitch"
        role="switch"
        tabindex="0"
        @click=${e=>this.reviewedClick(e)}
        @keydown=${e=>this.reviewedClick(e)}
        aria-label="Reviewed"
        aria-checked=${this.booleanToString(t)}
      >
        <!-- Trick with tabindex to avoid outline on mouse focus, but
            preserve focus outline for keyboard navigation -->
        <span tabindex="-1" class="markReviewed" title=${i}
          >${r}</span
        >
      </span>
    </div>`}renderFileControls(e){return dc` <div
      class="editFileControls showOnEdit"
      role="gridcell"
      aria-hidden=${this.booleanToString(!this.editMode)}
    >
      ${eb(this.editMode,(()=>dc`
          <gr-edit-file-controls
            class=${this.computeClass("",e.__path,!0)}
            .filePath=${e.__path}
          ></gr-edit-file-controls>
        `))}
    </div>`}renderShowHide(e){const t=this.isFileExpanded(e.__path);return dc` <div class="show-hide" role="gridcell">
      <!-- Do not use input type="checkbox" with hidden input and
            visible label here. Screen readers don't read/interract
            correctly with such input.
        -->
      <span
        class="show-hide"
        data-path=${e.__path}
        data-expand="true"
        role="switch"
        tabindex="0"
        aria-checked=${this.isFileExpandedStr(e.__path)}
        aria-label=${t?"collapse":"expand"}
        aria-description=${t?"Collapse diff of this file":"Expand diff of this file"}
        @click=${this.expandedClick}
        @keydown=${this.expandedClick}
      >
        <!-- Trick with tabindex to avoid outline on mouse focus, but
          preserve focus outline for keyboard navigation -->
        <gr-icon
          class="show-hide-icon"
          tabindex="-1"
          id="icon"
          icon=${t?"expand_less":"expand_more"}
        ></gr-icon>
      </span>
    </div>`}renderCleanlyMerged(){const e=this.computeShowPrependedDynamicColumns();return dc` <div class="row">
      <!-- endpoint: change-view-file-list-content-prepend -->
      ${eb(e,(()=>this.renderPrependedContentEndpoints()))}
      <div role="gridcell">
        <div>
          <span class="cleanlyMergedText">
            ${this.computeCleanlyMergedText()}
          </span>
          <gr-button
            link
            class="showParentButton"
            @click=${this.handleShowParent1}
          >
            Show Parent 1
          </gr-button>
        </div>
      </div>
    </div>`}renderPrependedContentEndpoints(){return this.dynamicPrependedContentEndpoints?.map((e=>dc`
        <gr-endpoint-decorator
          class="prepended-col"
          .name=${e}
          role="gridcell"
        >
          <gr-endpoint-param name="change" .value=${this.change}>
          </gr-endpoint-param>
          <gr-endpoint-param name="changeNum" .value=${this.changeNum}>
          </gr-endpoint-param>
          <gr-endpoint-param name="patchRange" .value=${this.patchRange}>
          </gr-endpoint-param>
          <gr-endpoint-param
            name="cleanlyMergedPaths"
            .value=${this.cleanlyMergedPaths}
          >
          </gr-endpoint-param>
          <gr-endpoint-param
            name="cleanlyMergedOldPaths"
            .value=${this.cleanlyMergedOldPaths}
          >
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      `))}renderChangeTotals(e){const t=this.computeShowDynamicColumns();return this.shouldHideChangeTotals(e)?uc:dc`
      <div class="row totalChanges">
        <div class="total-stats">
          <div>
            <span
              class="removed"
              tabindex="0"
              aria-label="Total ${e.deleted} lines removed"
            >
              -${e.deleted}
            </span>
            <span
              class="added"
              tabindex="0"
              aria-label="Total ${e.inserted} lines added"
            >
              +${e.inserted}
            </span>
          </div>
        </div>
        ${eb(t,(()=>this.dynamicSummaryEndpoints?.map((e=>dc`
              <gr-endpoint-decorator class="extra-col" name=${e}>
                <gr-endpoint-param name="change" .value=${this.change}>
                </gr-endpoint-param>
                <gr-endpoint-param name="patchRange" .value=${this.patchRange}>
                </gr-endpoint-param>
              </gr-endpoint-decorator>
            `))))}

        <!-- Empty div here exists to keep spacing in sync with file rows. -->
        <div class="reviewed hideOnEdit" ?hidden=${!this.loggedIn}></div>
        <div class="editFileControls showOnEdit"></div>
        <div class="show-hide"></div>
      </div>
    `}renderBinaryTotals(e){if(this.shouldHideBinaryChangeTotals(e))return uc;const t=jR(e.size_delta_inserted),i=jR(e.size_delta_deleted);return dc`
      <div class="row totalChanges">
        <div class="total-stats">
          <span
            class="removed"
            aria-label="Total bytes removed: ${i}"
          >
            ${i}
            ${this.formatPercentage(e.total_size,e.size_delta_deleted)}
          </span>
          <span
            class="added"
            aria-label="Total bytes inserted: ${t}"
          >
            ${t}
            ${this.formatPercentage(e.total_size,e.size_delta_inserted)}
          </span>
        </div>
      </div>
    `}renderControlRow(){return dc`<div
      class=${`row controlRow ${this.computeFileListControlClass()}`}
    >
      <gr-button
        class="fileListButton"
        id="incrementButton"
        link=""
        @click=${this.incrementNumFilesShown}
      >
        ${this.computeIncrementText()}
      </gr-button>
      <gr-tooltip-content
        ?has-tooltip=${this.computeWarnShowAll()}
        ?show-icon=${this.computeWarnShowAll()}
        .title=${this.computeShowAllWarning()}
      >
        <gr-button
          class="fileListButton"
          id="showAllButton"
          link=""
          @click=${this.showAllFiles}
        >
          ${this.computeShowAllText()}
        </gr-button>
      </gr-tooltip-content>
    </div>`}renderCommentsChips(e){if(!this.changeComments||!this.patchRange||!e?.__path)return uc;const t=this.changeComments?.computeCommentsThreads(this.patchRange,e.__path,e),i=this.changeComments?.computeDraftCountForFile(this.patchRange,e);return dc`<gr-comments-summary
      .commentThreads=${t}
      .draftCount=${i}
      emptyWhenNoComments
    ></gr-comments-summary>`}renderChecksChips(e){if(!this.checkResults||!this.patchRange||!e?.__path)return uc;const t={},i=[e.__path];e.old_path&&i.push(e.old_path);const r=this.checkResults?.filter((e=>e.isLatestAttempt))??[];for(const e of r){if(void 0===e.codePointers||!e.codePointers.some((e=>i.includes(e.path))))continue;const r=wI(e.category);t[r.name]??=[],t[r.name].push(r)}return Object.values(t).map((e=>dc`
          <div class="checkChip ${e[0].name}">
            <gr-icon
              icon=${e[0].name}
              ?filled=${!!e[0].filled}
            ></gr-icon>
            <div>${e.length}</div>
          </div>
        `))}firstUpdated(){this.detectChromiteButler(),this.reporting.fileListDisplayed()}async updateCleanlyMergedPaths(){if(this.change&&this.changeNum&&this.patchNum&&new zL(this.change).isMergeCommit(this.patchNum)&&this.basePatchNum===Qu&&this.patchNum!==Ju){const e=await this.restApiService.getChangeOrEditFiles(this.changeNum,{basePatchNum:-1,patchNum:this.patchNum});if(!e)return;const t=this.files.map((e=>e.__path));this.cleanlyMergedPaths=Object.keys(e).filter((e=>!t.includes(e))),this.cleanlyMergedOldPaths=this.cleanlyMergedPaths.map((t=>e[t].old_path)).filter((e=>!!e))}else this.cleanlyMergedPaths=[],this.cleanlyMergedOldPaths=[]}detectChromiteButler(){document.getElementById("butler-suggested-owners")&&this.reporting.reportExtension("butler")}get diffs(){const e=this.shadowRoot.querySelectorAll("gr-diff-host");return Array.from(e).filter((e=>!!e&&!!e.style&&"none"!==e.style.display))}resetFileState(){this.numFilesShown=200,this.selectedIndex=0,this.fileCursor.setCursorAtIndex(this.selectedIndex,!0)}openDiffPrefs(){this.diffPreferencesDialog?.open()}calculatePatchChange(){return this.files.filter((e=>!Ag(e.__path))).reduce(((e,t)=>{const i=t.lines_inserted?t.lines_inserted:0,r=t.lines_deleted?t.lines_deleted:0,o=t.size&&t.binary?t.size:0,s=t.binary&&t.size_delta&&t.size_delta>0?t.size_delta:0,n=t.binary&&t.size_delta&&t.size_delta<0?t.size_delta:0;return{inserted:e.inserted+i,deleted:e.deleted+r,size_delta_inserted:e.size_delta_inserted+s,size_delta_deleted:e.size_delta_deleted+n,total_size:e.total_size+o}}),{inserted:0,deleted:0,size_delta_inserted:0,size_delta_deleted:0,total_size:0})}toggleHideAllCommentsAndCodePointers(){this.classList.toggle("hideComments")?this.classList.add("hideCheckCodePointers"):this.classList.remove("hideCheckCodePointers")}toggleHideCheckCodePointers(){this.classList.toggle("hideCheckCodePointers")}toggleFileExpanded(e){const t=this.expandedFiles.findIndex((t=>t.path===e.path));-1===t?(this.reporting.reportInteraction(ga.FILE_LIST_DIFF_EXPANDED),this.expandedFiles=this.expandedFiles.concat([e])):(this.reporting.reportInteraction(ga.FILE_LIST_DIFF_COLLAPSED),this.expandedFiles=this.expandedFiles.filter(((e,i)=>i!==t)));const i=this.files.findIndex((t=>t.__path===e.path));this.shadowRoot.querySelectorAll(`.${LM}`)[i].scrollIntoView({block:"nearest"})}toggleFileExpandedByIndex(e){this.toggleFileExpanded(this.computePatchSetFile(this.files[e]))}updateDiffPreferences(){this.diffs.length&&this.renderInOrder(this.expandedFiles,this.diffs)}expandAllDiffs(){const e=this.files.slice(0,this.numFilesShown).filter((e=>!this.expandedFiles.some((t=>t.path===e.__path)))).map((e=>this.computePatchSetFile(e)));this.reporting.reportInteraction(ga.FILE_LIST_ALL_DIFFS_EXPANDED),this.expandedFiles=e.concat(this.expandedFiles)}collapseAllDiffs(){this.reporting.reportInteraction(ga.FILE_LIST_ALL_DIFFS_COLLAPSED),this.expandedFiles=[]}computeDraftsStringMobile(e){if(void 0===this.changeComments)return"";const t=this.changeComments.computeDraftCountForFile(this.patchRange,e);return 0===t?"":`${t}d`}computeCommentsStringMobile(e){if(void 0===this.changeComments||void 0===this.patchRange||void 0===e)return"";const t=this.changeComments.computeCommentThreads({patchNum:this.patchRange.basePatchNum,path:e.__path}).length+this.changeComments.computeCommentThreads({patchNum:this.patchRange.patchNum,path:e.__path}).length;return 0===t?"":`${t}c`}reviewFile(e,t){return this.editMode?Promise.resolve():(t=t??!this.reviewed.includes(e),this._saveReviewedState(e,t))}_saveReviewedState(e,t){return ba(this.changeNum,"changeNum"),ba(this.patchRange,"patchRange"),this.getChangeModel().setReviewedFilesStatus(this.changeNum,this.patchRange.patchNum,e,t)}isClickEvent(e){if("click"===e.type)return!0;const t=e,i="Enter"===t.key||" "===t.key;return"keydown"===t.type&&i}fileActionClick(e,t){if(this.isClickEvent(e)){const i=this.getFileRowFromEvent(e);if(!i)return;e.preventDefault(),e.stopPropagation(),this.fileCursor.setCursor(i.element),t(i.file)}}reviewedClick(e){this.fileActionClick(e,(e=>this.reviewFile(e.path)))}expandedClick(e){this.fileActionClick(e,(e=>this.toggleFileExpanded(e)))}handleFileListClick(e){if(!e.target)return;const t=this.getFileRowFromEvent(e);if(!t)return;const i=t.file;i.path&&!In(e.target,"pathLink")&&(In(e.target,"editFileControls")||(e.preventDefault(),this.fileCursor.setCursor(t.element),this.toggleFileExpanded(i)))}getFileRowFromEvent(e){let t=e.target;for(;!t.classList.contains(LM)&&t.parentElement;)t=t.parentElement;return t.dataset.file?{file:JSON.parse(t.dataset.file),element:t}:null}computePatchSetFile(e){const t={path:e.__path};return e.old_path&&(t.basePath=e.old_path),t}handleLeftPane(){this.noDiffsExpanded()||this.diffCursor?.moveLeft()}handleRightPane(){this.noDiffsExpanded()||this.diffCursor?.moveRight()}handleToggleInlineDiff(){-1!==this.fileCursor.index&&this.toggleFileExpandedByIndex(this.fileCursor.index)}handleCursorNext(e){this.filesExpanded!==JL.ALL&&e.key===Mn.DOWN||(e.preventDefault(),e.stopPropagation(),this.filesExpanded===JL.ALL?this.diffCursor?.moveDown():(this.fileCursor.next({circular:!0}),this.selectedIndex=this.fileCursor.index))}handleCursorPrev(e){this.filesExpanded!==JL.ALL&&e.key===Mn.UP||(e.preventDefault(),e.stopPropagation(),this.filesExpanded===JL.ALL?this.diffCursor?.moveUp():(this.fileCursor.previous({circular:!0}),this.selectedIndex=this.fileCursor.index))}handleNewComment(){this.classList.remove("hideComments"),this.diffCursor?.createCommentInPlace()}handleOpenFile(){this.filesExpanded!==JL.ALL?this.openSelectedFile():this.openCursorFile()}handleNextChunk(){this.noDiffsExpanded()||this.diffCursor?.moveToNextChunk()}handleNextComment(){this.noDiffsExpanded()||this.diffCursor?.moveToNextCommentThread()}handlePrevChunk(){this.noDiffsExpanded()||this.diffCursor?.moveToPreviousChunk()}handlePrevComment(){this.noDiffsExpanded()||this.diffCursor?.moveToPreviousCommentThread()}handleToggleFileReviewed(){this.files[this.fileCursor.index]&&this.reviewFile(this.files[this.fileCursor.index].__path)}handleToggleLeftPane(){this.diffs.forEach((e=>{e.toggleLeftDiff()}))}toggleInlineDiffs(){this.filesExpanded===JL.ALL?this.collapseAllDiffs():this.expandAllDiffs()}openCursorFile(){const e=this.diffCursor?.getTargetDiffElement();if(!(this.change&&e&&this.patchNum&&e.path))throw new Error("change, diff and pacthNum must be all set and valid");this.getNavigation().setUrl(this.getViewModel().diffUrl({diffView:{path:e.path},patchNum:this.patchNum}))}openSelectedFile(e){if(void 0!==e&&this.fileCursor.setCursorAtIndex(e),this.files[this.fileCursor.index]){if(!this.change||!this.patchNum)throw new Error("change and patchRange must be set");this.getNavigation().setUrl(this.getViewModel().diffUrl({diffView:{path:this.files[this.fileCursor.index].__path},patchNum:this.patchNum}))}}shouldHideChangeTotals(e){return 0===e.inserted&&0===e.deleted}shouldHideBinaryChangeTotals(e){return 0===e.size_delta_inserted&&0===e.size_delta_deleted}computeDiffURL(e){if(void 0!==e&&void 0!==this.patchNum)return this.editMode&&e!==hg.MERGE_LIST?this.getViewModel().editUrl({patchNum:this.patchNum,editView:{path:e}}):this.getViewModel().diffUrl({diffView:{path:e},patchNum:this.patchNum})}formatPercentage(e,t){if(void 0===e||void 0===t)return"";const i=e-t;return 0===i?"":`(${t>0?"+":"-"}${Math.round(Math.abs(100*t/i))}%)`}computeBinaryClass(e){if(e)return e>0?"added":"removed"}computeClass(e="",t,i=!1){const r=[e];return i&&t===hg.COMMIT_MESSAGE||!Ag(t)||r.push("invisible"),r.join(" ").trim()}computePathClass(e){return this.isFileExpanded(e)?"expanded":""}computeShowNumCleanlyMerged(){return this.cleanlyMergedPaths.length>0}computeCleanlyMergedText(){return`${Ig(this.cleanlyMergedPaths.length,"file")} merged cleanly in Parent 1`}handleShowParent1(){this.change&&this.patchRange&&this.getNavigation().setUrl(WC({change:this.change,patchNum:this.patchRange.patchNum,basePatchNum:-1}))}updateDiffCursor(){this.diffCursor?.replaceDiffs(this.diffs)}async filesChanged(){this.expandedFiles.length>0&&(this.expandedFiles=[]),await this.updateCleanlyMergedPaths(),this.files&&0!==this.files.length&&(await this.updateComplete,this.fileCursor.stops=Array.from(this.shadowRoot?.querySelectorAll(`.${LM}`)??[]),this.fileCursor.setCursorAtIndex(this.selectedIndex,!0))}incrementNumFilesShown(){this.numFilesShown+=this.fileListIncrement,this.numFilesShown>this.files.length&&(this.numFilesShown=this.files.length)}computeFileListControlClass(){return this.numFilesShown>=this.files.length?"invisible":""}computeIncrementText(){return`Show ${Math.min(this.fileListIncrement,this.files.length-this.numFilesShown)} More`}computeShowAllText(){const e=this.files.filter((e=>e.__path!==hg.COMMIT_MESSAGE)).length;return`Show All ${e} Files`}computeWarnShowAll(){return this.files.length>1e3}computeShowAllWarning(){return this.computeWarnShowAll()?`Warning: showing all ${this.files.length} files may take several seconds.`:""}showAllFiles(){this.numFilesShown=this.files.length}booleanToString(e){return e?"true":"false"}isFileExpanded(e){return this.expandedFiles.some((t=>t.path===e))}isFileExpandedStr(e){return this.booleanToString(this.isFileExpanded(e))}computeExpandedFiles(){return 0===this.expandedFiles.length?JL.NONE:this.expandedFiles.length===this.files.length?JL.ALL:JL.SOME}async expandedFilesChanged(e){this.filesExpanded=this.computeExpandedFiles();const t=this.expandedFiles.filter((t=>-1===(e??[]).findIndex((e=>e.path===t.path))));await this.updateComplete,t.length&&await this.renderInOrder(t,this.diffs),this.updateDiffCursor(),this.diffCursor?.reInitAndUpdateStops()}async renderInOrder(e,t){this.reporting.time(ua.FILE_EXPAND_ALL);for(const i of e){const e=i.path,r=this.findDiffByPath(e,t);if(!r)return void this.reporting.error("GrFileList",new Error(`Did not find <gr-diff-host> element for ${e}`));r.prefetchDiff()}await iy(e,(async(i,r)=>{const o=i.path;this.cancelForEachDiff=r;const s=this.findDiffByPath(o,t);if(s){if(!this.diffPrefs)throw new Error("diffPrefs must be set");this.loggedIn&&!this.diffPrefs.manual_review&&1===e.length&&await this.reviewFile(o,!0),await s.reload()}else this.reporting.error("GrFileList",new Error(`Did not find <gr-diff-host> element for ${o}`))})),this.cancelForEachDiff=void 0,this.reporting.timeEnd(ua.FILE_EXPAND_ALL,{count:e.length,height:this.clientHeight}),this.diffCursor?.reInitAndUpdateStops()}cancelDiffs(){this.cancelForEachDiff&&this.cancelForEachDiff()}findDiffByPath(e,t){return t.find((t=>t.path===e))}updateSizeBarLayout(){const e={maxInserted:0,maxDeleted:0,maxAdditionWidth:0,maxDeletionWidth:0,additionOffset:0};this.files.slice(0,this.numFilesShown).filter((e=>!Ag(e.__path))).forEach((t=>{t.lines_inserted&&(e.maxInserted=Math.max(e.maxInserted,t.lines_inserted)),t.lines_deleted&&(e.maxDeleted=Math.max(e.maxDeleted,t.lines_deleted))}));const t=e.maxInserted/(e.maxInserted+e.maxDeleted);isNaN(t)||(e.maxAdditionWidth=60*t,e.maxDeletionWidth=60-e.maxAdditionWidth,e.additionOffset=e.maxDeletionWidth+1),this.sizeBarLayout=e}computeBarAdditionWidth(e,t){if(!e||!t||0===t.maxInserted||!e.lines_inserted||Ag(e.__path))return 0;const i=t.maxAdditionWidth*e.lines_inserted/t.maxInserted;return 0===i?0:Math.max(1.5,i)}computeBarAdditionX(e){return e.additionOffset}computeBarDeletionWidth(e,t){if(!e||!t||0===t.maxDeleted||!e.lines_deleted||Ag(e.__path))return 0;const i=t.maxDeletionWidth*e.lines_deleted/t.maxDeleted;return 0===i?0:Math.max(1.5,i)}computeBarDeletionX(e,t){if(e&&t)return t.maxDeletionWidth-this.computeBarDeletionWidth(e,t)}computeSizeBarsClass(e){let t="";return this.showSizeBars?Ag(e)&&(t="invisible"):t="hide",`sizeBars ${t}`}computeShowDynamicColumns(){return!!(this.dynamicHeaderEndpoints&&this.dynamicContentEndpoints&&this.dynamicSummaryEndpoints&&this.dynamicHeaderEndpoints.length&&this.dynamicHeaderEndpoints.length===this.dynamicContentEndpoints.length&&this.dynamicHeaderEndpoints.length===this.dynamicSummaryEndpoints.length)}computeShowPrependedDynamicColumns(){return!!(this.dynamicPrependedHeaderEndpoints&&this.dynamicPrependedContentEndpoints&&this.dynamicPrependedHeaderEndpoints.length&&this.dynamicPrependedHeaderEndpoints.length===this.dynamicPrependedContentEndpoints.length)}noDiffsExpanded(){return this.filesExpanded===JL.NONE}getOldPath(e){return e.old_path??null}};DM([Hc("#diffPreferencesDialog")],MM.prototype,"diffPreferencesDialog",void 0),DM([Uc()],MM.prototype,"patchNum",void 0),DM([Uc()],MM.prototype,"basePatchNum",void 0),DM([Fc({type:Number})],MM.prototype,"changeNum",void 0),DM([Fc({type:Object})],MM.prototype,"changeComments",void 0),DM([Fc({type:Array})],MM.prototype,"checkResults",void 0),DM([Uc()],MM.prototype,"selectedIndex",void 0),DM([Fc({type:Object})],MM.prototype,"change",void 0),DM([Uc()],MM.prototype,"diffViewMode",void 0),DM([Fc({type:Boolean})],MM.prototype,"editMode",void 0),DM([Uc()],MM.prototype,"files",void 0),DM([Uc()],MM.prototype,"modifiedFiles",void 0),DM([Uc()],MM.prototype,"unmodifiedFiles",void 0),DM([Uc()],MM.prototype,"filesLeftBase",void 0),DM([Uc()],MM.prototype,"filesRightBase",void 0),DM([Uc()],MM.prototype,"loggedIn",void 0),DM([Uc()],MM.prototype,"reviewed",void 0),DM([Uc()],MM.prototype,"diffPrefs",void 0),DM([Uc()],MM.prototype,"numFilesShown",void 0),DM([Uc()],MM.prototype,"fileListIncrement",void 0),DM([Uc()],MM.prototype,"expandedFiles",void 0),DM([Uc()],MM.prototype,"showSizeBars",void 0),DM([Uc()],MM.prototype,"cleanlyMergedPaths",void 0),DM([Uc()],MM.prototype,"cleanlyMergedOldPaths",void 0),DM([Uc()],MM.prototype,"dynamicHeaderEndpoints",void 0),DM([Uc()],MM.prototype,"dynamicContentEndpoints",void 0),DM([Uc()],MM.prototype,"dynamicSummaryEndpoints",void 0),DM([Uc()],MM.prototype,"dynamicPrependedHeaderEndpoints",void 0),DM([Uc()],MM.prototype,"dynamicPrependedContentEndpoints",void 0),MM=DM([Dc("gr-file-list")],MM);var FM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let UM=class extends Ic{constructor(){super(),this.showDetails=!1,this.docsBaseUrl="",this.getChangeModel=yu(this,MT),this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getChangeModel().revision$),(e=>{e?._number===Ju&&(e=void 0),this.revision=e})),zf(this,(()=>this.getChangeModel().repo$),(e=>this.repo=e)),zf(this,(()=>this.getChangeModel().baseRevision$),(e=>this.baseRevision=e)),zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e))}static get styles(){return[Qb,Nc,Sd`
        :host {
          display: block;
        }
        div.container {
          padding: var(--spacing-m) var(--spacing-l);
          border-top: 1px solid var(--border-color);
        }
        .sections {
          display: flex;
        }
        .section {
          margin-top: 0;
          padding-right: var(--spacing-xxl);
        }
        .section h4 {
          margin: 0;
        }
        .title {
          font-weight: var(--font-weight-medium);
        }
        .messageContainer {
          display: flex;
          padding: var(--spacing-m) var(--spacing-l);
          border-top: 1px solid var(--border-color);
        }
        .messageContainer.info {
          background-color: var(--info-background);
        }
        .messageContainer.warning {
          background-color: var(--warning-background);
        }
        .messageContainer gr-icon {
          margin-right: var(--spacing-m);
        }
        .messageContainer.info gr-icon {
          color: var(--info-foreground);
        }
        .messageContainer.warning gr-icon {
          color: var(--warning-foreground);
        }
        .messageContainer .text {
          max-width: 600px;
        }
        .messageContainer .text p {
          margin: 0;
        }
        .messageContainer .text gr-button {
          margin-left: -4px;
        }
        gr-commit-info {
          display: inline-block;
        }
      `]}render(){return dc`${this.renderMessage()}${this.renderDetails()}`}renderMessage(){if(!this.baseRevision||!this.revision)return;const e=this.baseRevision?.parents_data?.[0],t=this.revision?.parents_data?.[0];if(!e||!t)return;const i=this.baseRevision?._number,r=this.revision?._number,o=e.commit_id,s=t.commit_id,n=Bx(e.branch_name),a=Bx(t.branch_name),l=e.is_merged_in_target_branch,d=t.is_merged_in_target_branch,c=e.change_number,h=t.change_number,p=e.patch_set_number,u=t.patch_set_number;if(o===s)return;if(n!==a)return dc`
        ${this.renderWarning("warning",dc`
            Patchset ${i} and ${r} are targeting different branches.
          `)}
      `;const g=!l&&!c,m=!d&&!h;if(g||m){const e=g&&m?`${i} and ${r} are`:g?`${i} is`:`${r} is`;return dc`
        ${this.renderWarning("warning",dc`
            Patchset ${e} based on a commit that neither exists in its
            target branch, nor is it a commit of another active change.
          `)}
      `}return c&&h&&c===h&&i!==r?dc`
        ${this.renderWarning("info",dc`
            The change was rebased from patchset
            ${this.renderPatchsetLink(c,p)} onto
            patchset ${this.renderPatchsetLink(c,u)} of
            change ${this.renderChangeLink(c)}
            ${eb(d,(()=>dc` (MERGED)`))}.
          `)}
      `:l&&d?dc`
        ${this.renderWarning("info",dc`
            The change was rebased from
            ${this.renderCommitLink(o,!1)} onto
            ${this.renderCommitLink(s,!1)}.
          `)}
      `:this.renderWarning("warning",dc`${this.renderInfo(this.baseRevision)}<br />${this.renderInfo(this.revision)}`)}renderInfo(e){const t=e.parents_data?.[0];if(!t)return;const i=e._number,r=t.is_merged_in_target_branch,o=t.change_number;return o&&!r?dc`
        Patchset ${i} is based on patchset
        ${this.renderPatchsetLink(o,t.patch_set_number)} of change
        ${this.renderChangeLink(o)}.
      `:dc`
        Patchset ${i} is based on commit
        ${this.renderCommitLink(t.commit_id,!1)} in the target branch
        (${Bx(t.branch_name)}).
      `}renderWarning(e,t){const i="warning"===e;return dc`
      <div class="messageContainer ${e}">
        <div class="icon">
          <gr-icon icon=${e}></gr-icon>
        </div>
        <div class="text">
          <p>
            ${t}${eb(i,(()=>dc`
                <br />
                The diff below may not be meaningful and may <br />
                even be hiding relevant changes.
                <a
                  href=${$f(this.docsBaseUrl,"user-review-ui.html#hazardous-rebases")}
                  >Learn more</a
                >
              `))}
          </p>
          ${eb(i,(()=>dc`
              <p>
                <gr-button
                  link
                  @click=${()=>this.showDetails=!this.showDetails}
                  >${this.showDetails?"Hide":"Show"} details</gr-button
                >
              </p>
            `))}
        </div>
      </div>
    `}renderDetails(){if(!this.showDetails)return;if(!this.baseRevision||!this.revision)return;const e=this.baseRevision.parents_data?.[0],t=this.revision.parents_data?.[0];return t&&e?dc`
      <div class="container">
        <div class="sections">
          ${this.renderSection(this.baseRevision,e,e.change_number===t.change_number)}
          ${this.renderSection(this.revision,t,e.change_number===t.change_number)}
        </div>
      </div>
    `:void 0}renderCommitLink(e,t=!0){if(e)return dc`<gr-commit-info
      .commitInfo=${{commit:e}}
      .showCopyButton=${t}
    ></gr-commit-info>`}renderChangeLink(e){return dc`
      <a href=${WC({changeNum:e,repo:this.repo})}>${e}</a>
    `}renderPatchsetLink(e,t){if(t)return dc`
      <a
        href=${WC({changeNum:e,repo:this.repo,patchNum:t})}
        >${t}</a
      >
    `}renderSection(e,t,i){const r=e._number,o=t.commit_id,s=Bx(t.branch_name),n=t.is_merged_in_target_branch,a=t.change_number,l=t.patch_set_number;return WC({changeNum:a,repo:this.repo}),dc`
      <div class="section">
        <h4 class="heading-4">Patchset ${r}</h4>
        <div>Target branch: ${s}</div>
        <div>Base commit: ${this.renderCommitLink(o)}</div>
        ${eb(!a&&!n,(()=>dc`
            <div>
              <gr-icon icon="warning"></gr-icon>
              <span
                >Warning: The base commit is not known (aka reachable) in the
                target branch.</span
              >
            </div>
          `))}
        ${eb(a&&(i||!n),(()=>dc`
            <div>
              Base change: ${this.renderChangeLink(a)}, patchset
              ${this.renderPatchsetLink(a,l)}
              ${eb(n,(()=>dc`(MERGED)`))}
            </div>
          `))}
      </div>
    `}};FM([Uc()],UM.prototype,"repo",void 0),FM([Uc()],UM.prototype,"revision",void 0),FM([Uc()],UM.prototype,"baseRevision",void 0),FM([Uc()],UM.prototype,"showDetails",void 0),FM([Uc()],UM.prototype,"docsBaseUrl",void 0),UM=FM([Dc("gr-revision-parents")],UM);var BM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let HM=class extends Ic{static get styles(){return[Jy,vy,Qb,Nc,Sd`
        :host {
          background-color: var(--dialog-background-color);
          display: block;
          max-height: 80vh;
          overflow-y: auto;
          padding: 4.5em var(--spacing-l) var(--spacing-l) var(--spacing-l);
        }
        header {
          background-color: var(--dialog-background-color);
          border-bottom: 1px solid var(--border-color);
          left: 0;
          padding: var(--spacing-l);
          position: absolute;
          right: 0;
          top: 0;
        }
        #title {
          display: inline-block;
          font-family: var(--header-font-family);
          font-size: var(--font-size-h3);
          font-weight: var(--font-weight-h3);
          line-height: var(--line-height-h3);
          margin-top: var(--spacing-xs);
        }
        #filterInput {
          display: block;
          float: right;
          margin: 0 var(--spacing-l);
          padding: var(--spacing-xs);
        }
        .closeButtonContainer {
          float: right;
        }
        ul {
          margin-bottom: var(--spacing-l);
        }
        ul li {
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          background: var(--chip-background-color);
          display: inline-block;
          margin: 0 var(--spacing-xs) var(--spacing-s) var(--spacing-xs);
          padding: var(--spacing-xs) var(--spacing-s);
        }
      `]}constructor(){super(),this.loaded=!1,this.filterText="",this.restApiService=Xn().restApiService,this.getChangeModel=yu(this,MT),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e))}render(){return dc`
      <header>
        <h1 id="title" class="heading-1">Included In:</h1>
        <span class="closeButtonContainer">
          <gr-button
            id="closeButton"
            link
            @click=${e=>{this.handleCloseTap(e)}}
            >Close</gr-button
          >
        </span>
        <md-outlined-text-field
          id="filterInput"
          placeholder="Filter"
          .value=${this.filterText??""}
          @input=${e=>{const t=e.target;this.filterText=t.value}}
        >
        </md-outlined-text-field>
      </header>
      ${this.renderLoading()}
      ${this.computeGroups().map((e=>this.renderGroup(e)))}
    `}renderLoading(){if(!this.loaded)return dc`<div>Loading...</div>`}renderGroup(e){return dc`
      <div>
        <span>${e.title}:</span>
        <ul>
          ${e.items.map((e=>this.renderGroupItem(e)))}
        </ul>
      </div>
    `}renderGroupItem(e){return dc`<li>${e}</li>`}willUpdate(e){e.has("changeNum")&&this.resetData()}loadData(){return this.changeNum?(this.filterText="",this.restApiService.getChangeIncludedIn(this.changeNum).then((e=>{e&&(this.includedIn=e,this.loaded=!0)}))):Promise.reject(new Error("missing required property changeNum"))}resetData(){this.includedIn=void 0,this.loaded=!1}computeGroups(){if(!this.includedIn||void 0===this.filterText)return[];const e=e=>!this.filterText.length||-1!==e.toLowerCase().indexOf(this.filterText.toLowerCase()),t=[{title:"Branches",items:this.includedIn.branches.filter(e)},{title:"Tags",items:this.includedIn.tags.filter(e)}];if(this.includedIn.external)for(const i of Object.keys(this.includedIn.external))t.push({title:i,items:this.includedIn.external[i].filter(e)});return t.filter((e=>e.items.length))}handleCloseTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"close",{})}};BM([Uc()],HM.prototype,"changeNum",void 0),BM([Uc()],HM.prototype,"includedIn",void 0),BM([Uc()],HM.prototype,"loaded",void 0),BM([Uc()],HM.prototype,"filterText",void 0),HM=BM([Dc("gr-included-in-dialog")],HM);var jM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let GM=class extends Ic{static get styles(){return Sd`
      .score,
      gr-trigger-vote {
        padding: 0 var(--spacing-s);
        margin-right: var(--spacing-s);
        display: inline-block;
      }
      .score {
        box-sizing: border-box;
        border-radius: var(--border-radius);
        color: var(--vote-text-color);
        text-align: center;
        min-width: 115px;
      }
      .score.removed {
        background-color: var(--vote-color-neutral);
      }
      .score.negative {
        background-color: var(--vote-color-disliked);
        border: 1px solid var(--vote-outline-disliked);
        line-height: calc(var(--line-height-normal) - 2px);
        color: var(--chip-color);
      }
      .score.negative.min {
        background-color: var(--vote-color-rejected);
        border: none;
        padding-top: 1px;
        padding-bottom: 1px;
        color: var(--vote-text-color);
      }
      .score.positive {
        background-color: var(--vote-color-recommended);
        border: 1px solid var(--vote-outline-recommended);
        line-height: calc(var(--line-height-normal) - 2px);
        color: var(--chip-color);
      }
      .score.positive.max {
        background-color: var(--vote-color-approved);
        border: none;
        padding-top: 1px;
        padding-bottom: 1px;
        color: var(--vote-text-color);
      }

      @media screen and (max-width: 50em) {
        .score {
          min-width: 0px;
        }
      }

      gr-checks-chip-for-label {
        /* .checksChip has top: 2px, this is canceling it */
        position: relative;
        top: -2px;
      }
    `}constructor(){super(),this.runs=[],this.getChangeModel=yu(this,MT),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e))}render(){const e=TT(this.message,this.labelExtremes),t=Nv(this.change);return e.map((e=>this.renderScore(e,t)))}renderScore(e,t){if(e.label&&t.includes(e.label)&&!e.value?.includes(kT)){const t=this.change?.labels??{};return dc`<gr-trigger-vote
        .label=${e.label}
        .displayValue=${e.value}
        .labelInfo=${t[e.label]}
        .change=${this.change}
        .mutable=${!1}
        disable-hovercards
      >
      </gr-trigger-vote>`}return dc`<span
        class="score ${this._computeScoreClass(e,this.labelExtremes)}"
      >
        ${e.label} ${e.value} </span
      >${this.renderChecks(e)}`}renderChecks(e){const t=e.label;return t?Number(e.value)>=0||this.latestPatchNum!==this.message?._revision_number?uc:dc`<gr-checks-chip-for-label
      .labels=${[t]}
      .showRunning=${!1}
    ></gr-checks-chip-for-label>`:uc}_computeScoreClass(e,t){if(void 0===e||void 0===t)return"";if(!e.value)return"";if(e.value.includes(kT))return"removed";const i=[];if(Number(e.value)>0?i.push("positive"):Number(e.value)<0&&i.push("negative"),e.label){const r=t[e.label];if(r){const t=Number(e.value);t===r.max?i.push("max"):t===r.min&&i.push("min")}}return i.join(" ")}};jM([Fc()],GM.prototype,"labelExtremes",void 0),jM([Fc({type:Object})],GM.prototype,"message",void 0),jM([Fc({type:Object})],GM.prototype,"change",void 0),jM([Uc()],GM.prototype,"runs",void 0),jM([Uc()],GM.prototype,"latestPatchNum",void 0),GM=jM([Dc("gr-message-scores")],GM);var zM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const VM=/Uploaded patch set (\d+)./,WM=/(\d+) is the latest approved patch-set/;let qM=class extends Ic{get author(){return this.message?.author||this.message?.updated_by}constructor(){super(),this.commentThreads=[],this.hideAutomated=!1,this.loggedIn=!1,this.isAdmin=!1,this.isDeletingChangeMsg=!1,this.restApiService=Xn().restApiService,this.getNavigation=yu(this,gy),this.getConfigModel=yu(this,Qw),this.getUserModel=yu(this,jf),this.addEventListener("click",(e=>this.handleClick(e))),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.config=e)),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.loggedIn=e)),zf(this,(()=>this.getUserModel().isAdmin$),(e=>this.isAdmin=e))}static get styles(){return[Sd`
        :host {
          display: block;
          position: relative;
          cursor: pointer;
          overflow-y: hidden;
        }
        :host(.expanded) {
          cursor: auto;
        }
        .collapsed .contentContainer {
          align-items: center;
          color: var(--deemphasized-text-color);
          display: flex;
          white-space: nowrap;
        }
        .contentContainer {
          padding: var(--spacing-m) var(--spacing-l);
        }
        .expanded .contentContainer {
          background-color: var(--background-color-secondary);
        }
        .collapsed .contentContainer {
          background-color: var(--background-color-primary);
        }
        div.serviceUser.expanded div.contentContainer {
          background-color: var(
            --background-color-service-user,
            var(--background-color-secondary)
          );
        }
        div.serviceUser.collapsed div.contentContainer {
          background-color: var(
            --background-color-service-user,
            var(--background-color-primary)
          );
        }
        .name {
          font-weight: var(--font-weight-medium);
        }
        .message {
          --gr-formatted-text-prose-max-width: 120ch;
        }
        .collapsed .message {
          max-width: none;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .collapsed .author,
        .collapsed .content,
        .collapsed .message,
        .collapsed .updateCategory,
        gr-account-chip {
          display: inline;
        }
        gr-button {
          margin: 0 -4px;
        }
        .collapsed gr-thread-list,
        .collapsed .deleteBtn,
        .collapsed .hideOnCollapsed,
        .hideOnOpen {
          display: none;
        }
        .collapsed .hideOnOpen {
          display: block;
        }
        .collapsed .content {
          flex: 1;
          margin-right: var(--spacing-m);
          min-width: 0;
          overflow: hidden;
        }
        .collapsed .content.messageContent {
          text-overflow: ellipsis;
        }
        .collapsed .dateContainer {
          position: static;
        }
        .collapsed .author {
          overflow: hidden;
          color: var(--primary-text-color);
          margin-right: var(--spacing-s);
        }
        .authorLabel {
          min-width: 130px;
          --account-max-length: 120px;
          margin-right: var(--spacing-s);
        }
        .expanded .author {
          cursor: pointer;
          margin-bottom: var(--spacing-m);
        }
        .expanded .content {
          padding-left: 40px;
        }
        .dateContainer {
          position: absolute;
          /* right and top values should match .contentContainer padding */
          right: var(--spacing-l);
          top: var(--spacing-m);
        }
        .dateContainer gr-icon {
          margin-right: var(--spacing-m);
          color: var(--deemphasized-text-color);
        }
        .dateContainer .patchset:before {
          content: 'Patchset ';
        }
        .dateContainer .patchsetDiffButton {
          margin-right: var(--spacing-m);
          --gr-button-padding: 0 var(--spacing-m);
        }
        span.date {
          color: var(--deemphasized-text-color);
        }
        span.date:hover {
          text-decoration: underline;
        }
        .dateContainer gr-icon {
          cursor: pointer;
          vertical-align: top;
        }
        .commentsSummary {
          margin-right: var(--spacing-s);
        }
        .expanded .commentsSummary {
          display: none;
        }
        gr-icon.commentsIcon {
          vertical-align: top;
        }
        gr-icon.unresolved.commentsIcon {
          color: var(--warning-foreground);
        }
        .numberOfComments {
          padding-right: var(--spacing-m);
        }
        gr-account-label::part(gr-account-label-text) {
          font-weight: var(--font-weight-medium);
        }
        @media screen and (max-width: 50em) {
          .expanded .content {
            padding-left: 0;
          }
          .commentsSummary {
            min-width: 0px;
          }
          .authorLabel {
            width: 100px;
          }
          .dateContainer .patchset:before {
            content: 'PS ';
          }
        }
      `]}render(){return this.message?this.hideAutomated&&this.computeIsAutomated()?uc:(this.updateExpandedClass(),dc` <div class=${this.computeClass()}>
      <div class="contentContainer">
        ${this.renderAuthor()} ${this.renderCommentsSummary()}
        ${this.renderMessageContent()} ${this.renderReviewerUpdate()}
        ${this.renderDateContainer()}
      </div>
    </div>`):uc}renderAuthor(){return ba(this.message,"message"),dc` <div class="author" @click=${this.handleAuthorClick}>
      ${eb(this.computeShowOnBehalfOf(),(()=>dc`
          <span>
            <span class="name">${this.message?.real_author?.name}</span>
            on behalf of
          </span>
        `))}
      <gr-account-label
        .account=${this.author}
        .change=${this.change}
        class="authorLabel"
      ></gr-account-label>
      <gr-message-scores
        .labelExtremes=${this.labelExtremes}
        .message=${this.message}
        .change=${this.change}
      ></gr-message-scores>
    </div>`}renderCommentIcon({commentThreadsCount:e,unresolved:t}){return 0===e?uc:dc` <span
      class="numberOfComments"
      title=${Ig(e,(t?"unresolved":"resolved")+" comment")}
    >
      <gr-icon
        small
        icon=${t?"chat_bubble":"mark_chat_read"}
        ?filled=${t}
        class="${t?"unresolved ":""}commentsIcon"
      ></gr-icon>
      ${e}</span
    >`}renderCommentsSummary(){if(!this.commentThreads?.length)return uc;const e=this.commentThreads.filter(Zx).length,t=this.commentThreads.length-e;return dc`
      <div class="commentsSummary">
        ${this.renderCommentIcon({commentThreadsCount:e,unresolved:!0})}
        ${this.renderCommentIcon({commentThreadsCount:t,unresolved:!1})}
      </div>
    `}renderMessageContent(){if(!this.message?.message)return uc;const e=this.computeMessageContent(!1,this.message.message.substring(0,1e3),this.message.accounts_in_message,this.message.tag,this.change?.labels)||this.patchsetCommentSummary();return dc` <div class="content messageContent">
      <div class="message hideOnOpen">${e}</div>
      ${this.renderExpandedMessageContent()}
    </div>`}renderExpandedMessageContent(){if(!this.message?.expanded)return uc;const e=this.computeMessageContent(!0,this.message.message,this.message.accounts_in_message,this.message.tag,this.change?.labels);return dc`
      <gr-formatted-text
        class="message hideOnCollapsed"
        .markdown=${!0}
        .content=${e}
      ></gr-formatted-text>
      ${eb(e,(()=>this.renderActionContainer()))}
      <gr-thread-list
        ?hidden=${!this.commentThreads.length}
        .threads=${this.commentThreads}
        hide-dropdown
        show-comment-context
        .messageId=${this.message.id}
      >
      </gr-thread-list>
    `}renderActionContainer(){return this.isAdmin&&this.loggedIn&&!this.computeIsAutomated()?dc` <div class="replyActionContainer">
      <gr-button
        ?disabled=${this.isDeletingChangeMsg}
        class="deleteBtn"
        link=""
        @click=${this.handleDeleteMessage}
      >
        Delete
      </gr-button>
    </div>`:uc}renderReviewerUpdate(){if(ba(this.message,"message"),"REVIEWER_UPDATE"===this.message.type)return dc` <div class="content">
      ${this.message.updates.map((e=>this.renderMessageUpdate(e)))}
    </div>`}renderMessageUpdate(e){return dc`<div class="updateCategory">
      ${e.message}
      ${e.reviewers.map((e=>dc`
          <gr-account-chip .account=${e} .change=${this.change}>
          </gr-account-chip>
        `))}
    </div>`}renderDateContainer(){return dc`<span class="dateContainer">
      ${this.renderDiffButton()}
      ${eb(this.message?._revision_number,(()=>dc`
          <span class="patchset">${this.message?._revision_number} |</span>
        `))}
      ${eb(this.message?.id,(()=>dc`
          <span class="date" @click=${this.handleAnchorClick}>
            <gr-date-formatter
              withTooltip
              showDateAndTime
              .dateStr=${this.message?.date}
            ></gr-date-formatter>
          </span>
        `),(()=>dc`
          <span class="date">
            <gr-date-formatter
              withTooltip
              showDateAndTime
              .dateStr=${this.message?.date}
            ></gr-date-formatter>
          </span>
        `))}
      <gr-icon
        id="expandToggle"
        @click=${this.toggleExpanded}
        title="Toggle expanded state"
        icon=${this.computeExpandToggleIcon()}
      ></gr-icon>
    </span>`}renderDiffButton(){return this.showViewDiffButton()?dc` <gr-button
      class="patchsetDiffButton"
      @click=${this.handleViewPatchsetDiff}
      link
    >
      View Diff
    </gr-button>`:uc}updateExpandedClass(){this.message?.expanded?this.classList.add("expanded"):this.classList.remove("expanded")}patchsetCommentSummary(){const e=this.message?.id;if(!e)return"";const t=(this.commentThreads??[]).filter((e=>e.path===hg.PATCHSET_LEVEL_COMMENTS));for(const i of t)if(i.comments[0].change_message_id===e)return i.comments[0].message;for(const i of t)for(const t of i.comments)if(t.change_message_id===e)return t.message;return""}showViewDiffButton(){return this.isNewPatchsetTag(this.message?.tag)||this.isMergePatchset(this.message)}isMergePatchset(e){return e?.tag===ag.TAG_MERGED&&e?.message.match(WM)}isNewPatchsetTag(e){return e===ag.TAG_NEW_PATCHSET||e===ag.TAG_NEW_WIP_PATCHSET||e===ag.TAG_NEW_PATCHSET_OUTDATED_VOTES}handleViewPatchsetDiff(e){if(!this.message||!this.change)return;let t,i;if(this.message.message.match(VM)){const e=this.message.message.match(VM);if(isNaN(Number(e[1])))throw new Error("invalid patchnum in message");t=Number(e[1]),i=Lx(t)}else if(this.message.message.match(WM)){const e=this.message.message.match(WM);if(isNaN(Number(e[1])))throw new Error("invalid patchnum in message");i=Number(e[1]),t=Dx(Ox(this.change))}else t=Dx(Ox(this.change)),i=Lx(t);this.getNavigation().setUrl(WC({change:this.change,patchNum:t,basePatchNum:i})),e.stopPropagation()}computeMessageContent(e,t,i,r,o){if(!t)return"";const s=this.isNewPatchsetTag(r);i&&(t=bx(t,i,this.config));return t.split("\n").filter((t=>{if(!e&&t.startsWith(">"))return!1;if(t.startsWith("(")&&t.endsWith(" comment)"))return!1;if(t.startsWith("(")&&t.endsWith(" comments)"))return!1;if(!s&&o){const e=t.match(zx);if(e&&e[1]){const t=e[1].split(" ");if(t.map((e=>e.match(AT))).filter((e=>e&&4===e.length&&ma(o,e[2]))).length===t.length)return!1}}return!0})).map((e=>(e.startsWith("Patch Set")&&(e=e.replace(zx,"$1")),e))).join("\n").trim()}computeShowOnBehalfOf(){return!!this.message&&!(!this.author||!this.message.real_author||this.author._account_id===this.message.real_author._account_id)}handleClick(e){this.message&&!this.message?.expanded&&(e.stopPropagation(),this.message.expanded=!0,this.requestUpdate())}handleAuthorClick(e){this.message&&this.message?.expanded&&(e.stopPropagation(),this.message.expanded=!1,this.requestUpdate())}computeIsAutomated(){return!!(this.message?.reviewer||this.computeIsReviewerUpdate()||this.message?.tag&&this.message.tag.startsWith("autogenerated"))}computeIsReviewerUpdate(){return"REVIEWER_UPDATE"===this.message?.type}computeClass(){const e=this.message?.expanded,t=[];return t.push(e?"expanded":"collapsed"),dx(this.author)&&t.push("serviceUser"),t.join(" ")}handleAnchorClick(e){e.preventDefault(),ba(this.message,"message"),Jn(this,"message-anchor-tap",{id:this.message.id})}handleDeleteMessage(e){e.preventDefault(),this.message&&this.message.id&&this.changeNum&&(this.isDeletingChangeMsg=!0,this.restApiService.deleteChangeCommitMessage(this.changeNum,this.message.id).then((()=>{this.isDeletingChangeMsg=!1,Jn(this,"change-message-deleted",{message:this.message})})))}computeExpandToggleIcon(){return this.message?.expanded?"expand_less":"expand_more"}toggleExpanded(e){e.stopPropagation(),this.message&&(this.message={...this.message,expanded:!this.message.expanded})}};zM([Fc({type:Object})],qM.prototype,"change",void 0),zM([Fc({type:Number})],qM.prototype,"changeNum",void 0),zM([Fc({type:Object})],qM.prototype,"message",void 0),zM([Fc({type:Array})],qM.prototype,"commentThreads",void 0),zM([Fc({type:Boolean})],qM.prototype,"hideAutomated",void 0),zM([Fc({type:Object})],qM.prototype,"labelExtremes",void 0),zM([Uc()],qM.prototype,"loggedIn",void 0),zM([Uc()],qM.prototype,"config",void 0),zM([Uc()],qM.prototype,"isAdmin",void 0),zM([Uc()],qM.prototype,"isDeletingChangeMsg",void 0),qM=zM([Dc("gr-message")],qM);var KM,YM=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};function XM(e){return void 0!==e.id}function JM(e){return XM(e)?e.id:void 0}function QM(e,t){if(void 0===e._index)return[];const i=JM(e);return t.filter((e=>e.comments.some((e=>e.change_message_id===i))))}function ZM(e){if(e.tag)return e.tag===ag.TAG_NEW_PATCHSET?XM(e)&&-1!==e.message.indexOf("\nOutdated Votes:\n")?ag.TAG_NEW_PATCHSET_OUTDATED_VOTES:ag.TAG_NEW_PATCHSET:e.tag===ag.TAG_NEW_WIP_PATCHSET?ag.TAG_NEW_PATCHSET:e.tag===ag.TAG_UNSET_PRIVATE?ag.TAG_SET_PRIVATE:e.tag===ag.TAG_SET_WIP?ag.TAG_SET_READY:e.tag.replace(/~.*/,"")}function eF(e,t){if(pf(e._revision_number))return e._revision_number;let i;for(const r of t){if(r.date>e.date)break;pf(r._revision_number)&&(i=r._revision_number)}return i}!function(e){e.EXPAND_ALL="Expand All",e.COLLAPSE_ALL="Collapse All"}(KM||(KM={}));let tF=class extends Ic{static get styles(){return[Nc,Jy,Sd`
        :host {
          display: flex;
          justify-content: space-between;
        }
        .header {
          align-items: center;
          border-bottom: 1px solid var(--border-color);
          display: flex;
          justify-content: space-between;
          padding: var(--spacing-s) var(--spacing-l);
        }
        .highlighted {
          animation: 3s fadeOut;
        }
        @keyframes fadeOut {
          0% {
            background-color: var(--emphasis-color);
          }
          100% {
            background-color: var(--view-background-color);
          }
        }
        .container {
          align-items: center;
          display: flex;
        }
        .hiddenEntries {
          color: var(--deemphasized-text-color);
        }
        gr-message:not(:last-of-type) {
          border-bottom: 1px solid var(--border-color);
        }
      `]}constructor(){super(),this.messages=[],this.reviewerUpdates=[],this.commentThreads=[],this.expandAllState=KM.EXPAND_ALL,this.showAllActivity=!1,this.combinedMessages=[],this.getCommentsModel=yu(this,kP),this.changeModel=yu(this,MT),this.reporting=Xn().reportingService,this.getShortcutsService=yu(this,Bg),zf(this,(()=>this.getCommentsModel().threadsSaved$),(e=>{this.commentThreads=e})),zf(this,(()=>this.changeModel().change$),(e=>{this.change=e})),zf(this,(()=>this.changeModel().changeNum$),(e=>{this.changeNum=e}))}willUpdate(e){(e.has("messages")||e.has("reviewerUpdates")||e.has("commentThreads"))&&(this.combinedMessages=function(e,t,i){let r,o,s=0,n=0,a=[];for(let t=0;t<e.length;t++)e[t]._index=t;for(;s<e.length||n<t.length;){if(s>=e.length){a=a.concat(t.slice(n));break}if(n>=t.length){a=a.concat(e.slice(s));break}r=r||Wm(e[s].date),o=o||Wm(t[n].date),o<r?(a.push(t[n++]),o=null):(a.push(e[s++]),r=null)}for(let e=0;e<a.length;e++){const t=a[e];void 0===t.expanded&&(t.expanded=!1),t.commentThreads=QM(t,i),t._revision_number=eF(t,a),t.tag=ZM(t)}return a.forEach((e=>{e.isImportant=function(e,t){if(!e.tag)return!0;const i=e._revision_number||0;return!t.filter((t=>t.tag===e.tag)).some((e=>(e._revision_number||0)>i))}(e,a)})),a}(this.messages??[],this.reviewerUpdates??[],this.commentThreads??[]),this.combinedMessagesChanged())}render(){const e=this.computeLabelExtremes();return dc`${this.renderHeader()}
    ${this.combinedMessages.filter((e=>this.showAllActivity||e.isImportant)).map((t=>dc`<gr-message
          .change=${this.change}
          .changeNum=${this.changeNum}
          .message=${t}
          .commentThreads=${t.commentThreads??[]}
          @message-anchor-tap=${this.handleAnchorClick}
          .labelExtremes=${e}
          data-message-id=${Vw(JM(t))}
        ></gr-message>`))}`}renderHeader(){return dc`<div class="header">
      <div id="showAllActivityToggleContainer" class="container">
        ${eb(this.combinedMessages.some((e=>!e.isImportant)),(()=>dc`
            <md-switch
              class="showAllActivityToggle"
              ?selected=${this.showAllActivity}
              @change=${this.handleShowAllActivityChanged}
              aria-labelledby="showAllEntriesLabel"
              role="switch"
            ></md-switch>
            <div id="showAllEntriesLabel" aria-hidden="true">
              <span>Show all entries</span>
              <span class="hiddenEntries" ?hidden=${this.showAllActivity}>
                (${this.combinedMessages.filter((e=>!e.isImportant)).length}
                hidden)
              </span>
            </div>
            <span class="transparent separator"></span>
          `))}
      </div>
      <gr-button
        id="collapse-messages"
        link
        .title=${this.computeExpandAllTitle()}
        @click=${this.handleExpandCollapseTap}
      >
        ${this.expandAllState}
      </gr-button>
    </div>`}async scrollToMessage(e){await uy((()=>this.messages&&this.messages.length>0)),await this.updateComplete;const t=`[data-message-id="${e}"]`,i=this.shadowRoot.querySelector(t);if(i||!this.showAllActivity){if(!i||!i.message)return this.showAllActivity=!0,void setTimeout((()=>this.scrollToMessage(e)));i.message.expanded=!0,i.requestUpdate(),await i.updateComplete,await(wa(i,"gr-formatted-text.message")?.updateComplete),i.scrollIntoView(),this.highlightEl(i)}else this.reporting.error("GrMessagesList scroll",new Error(`Failed to scroll to message: ${e}`))}handleShowAllActivityChanged(e){this.showAllActivity=e.target.selected??!1}refreshMessages(){for(const e of ya(this,"gr-message"))e.requestUpdate()}computeExpandAllTitle(){return this.expandAllState===KM.COLLAPSE_ALL?this.getShortcutsService().createTitle(pu.COLLAPSE_ALL_MESSAGES,hu.ACTIONS):this.expandAllState===KM.EXPAND_ALL?this.getShortcutsService().createTitle(pu.EXPAND_ALL_MESSAGES,hu.ACTIONS):""}highlightEl(e){const t=this.shadowRoot?.querySelectorAll(".highlighted")??[];for(const e of t)e.classList.remove("highlighted");e.addEventListener("animationend",(function t(){e.removeEventListener("animationend",t),e.classList.remove("highlighted")})),e.classList.add("highlighted")}handleExpandCollapse(e){if(this.expandAllState=e?KM.COLLAPSE_ALL:KM.EXPAND_ALL,this.combinedMessages){for(let t=0;t<this.combinedMessages.length;t++)this.combinedMessages[t].expanded=e;this.refreshMessages()}}handleExpandCollapseTap(e){e.preventDefault(),this.handleExpandCollapse(this.expandAllState===KM.EXPAND_ALL)}handleAnchorClick(e){this.scrollToMessage(e.detail.id)}combinedMessagesChanged(){if(0===this.combinedMessages.length)return;this.refreshMessages();const e=this.combinedMessages.map((e=>e.tag||e.type||"none")).reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{all:this.combinedMessages.length});this.reporting.reportInteraction("messages-count",e)}computeLabelExtremes(){const e={};if(!this.labels)return e;for(const t of Object.keys(this.labels)){const i=sv(this.labels[t]);i&&(e[t]=i)}return e}};YM([Fc({type:Array})],tF.prototype,"messages",void 0),YM([Fc({type:Array})],tF.prototype,"reviewerUpdates",void 0),YM([Fc({type:Object})],tF.prototype,"labels",void 0),YM([Uc()],tF.prototype,"change",void 0),YM([Uc()],tF.prototype,"changeNum",void 0),YM([Uc()],tF.prototype,"commentThreads",void 0),YM([Uc()],tF.prototype,"expandAllState",void 0),YM([Uc()],tF.prototype,"showAllActivity",void 0),YM([Uc()],tF.prototype,"combinedMessages",void 0),tF=YM([Dc("gr-messages-list")],tF);var iF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let rF=class extends Ic{constructor(){super(...arguments),this.showSubmittableCheck=!1,this.showChangeStatus=!1}static get styles(){return[Nc,Sd`
        :host,
        .changeContainer,
        a {
          max-width: 100%;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          width: 100%;
          display: inline-flex;
        }
        .strikethrough {
          color: var(--deemphasized-text-color);
          text-decoration: line-through;
        }
        .status {
          color: var(--deemphasized-text-color);
          font-weight: var(--font-weight-medium);
          margin-left: var(--spacing-xs);
          margin-right: var(--spacing-m);
        }
        .notCurrent {
          color: var(--warning-foreground);
        }
        .indirectRelation {
          color: var(--indirect-relation-text-color);
        }
        .workInProgress {
          color: var(--status-wip);
        }
        .workInProgressLink {
          color: var(--deemphasized-text-color);
        }
        .submittableCheck {
          padding-left: var(--spacing-s);
          color: var(--positive-green-text-color);
          display: none;
        }
        .submittableCheck.submittable {
          display: inline;
        }
        .hidden,
        .mobile {
          display: none;
        }
        .submittableCheck {
          padding-left: var(--spacing-s);
          color: var(--positive-green-text-color);
          display: none;
        }
        .submittableCheck.submittable {
          display: inline;
        }
      `]}render(){const e=this.change;if(!e)throw new Error("Missing change");const t=this.computeLinkClass(e);return dc`
      <div class="changeContainer">
        <a
          href=${Vw(this.href)}
          aria-label=${Vw(this.label)}
          class=${t}
          ><slot name="name"></slot
        ></a>
        ${this.showSubmittableCheck?dc`<span
              tabindex="-1"
              title="Submittable"
              class="submittableCheck ${t}"
              role="img"
              aria-label="Submittable"
              >✓</span
            >`:""}
        ${this.showChangeStatus?dc`<span class=${this.computeChangeStatusClass(e)}>
              (${this.computeChangeStatus(e)})
            </span>`:""}
        <slot name="extra"></slot>
      </div>
    `}computeLinkClass(e){const t=[];return e.status===Nu.ABANDONED&&t.push("strikethrough"),e.submittable&&t.push("submittable"),e.work_in_progress&&t.push("workInProgressLink"),t.join(" ")}computeChangeStatusClass(e){const t=["status"];return GC(e)||e._revision_number===e._current_revision_number?!GC(e)&&this.isIndirectRelation(e)?t.push("indirectRelation"):e.submittable?t.push("submittable"):e.work_in_progress?t.push("workInProgress"):e.status===Nu.NEW&&t.push("hidden"):t.push("notCurrent"),t.join(" ")}computeChangeStatus(e){switch(e.status){case Nu.MERGED:return"Merged";case Nu.ABANDONED:return"Abandoned"}return GC(e)||e._revision_number===e._current_revision_number?!GC(e)&&this.isIndirectRelation(e)?"Indirect relation":e.work_in_progress?"WIP":e.submittable?"Submittable":"":"Not current"}isIndirectRelation(e){return this.connectedRevisions&&!this.connectedRevisions.includes(e.commit.commit)}};iF([Fc({type:Object})],rF.prototype,"change",void 0),iF([Fc()],rF.prototype,"href",void 0),iF([Fc()],rF.prototype,"label",void 0),iF([Fc({type:Boolean,attribute:"show-submittable-check"})],rF.prototype,"showSubmittableCheck",void 0),iF([Fc({type:Boolean,attribute:"show-change-status"})],rF.prototype,"showChangeStatus",void 0),iF([Fc({type:Array})],rF.prototype,"connectedRevisions",void 0),rF=iF([Dc("gr-related-change")],rF);var oF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let sF=class extends Ic{constructor(){super(...arguments),this.name="",this.showAll=!1,this.collapsed=!0,this.length=0,this.numChangesWhenCollapsed=3,this.reporting=Xn().reportingService}static get styles(){return[Nc,Qb,Sd`
        .title {
          color: var(--deemphasized-text-color);
          display: flex;
          align-self: flex-end;
        }
        gr-button {
          display: flex;
        }
        gr-button gr-icon {
          color: inherit;
          font-size: 18px;
        }
        .container {
          justify-content: space-between;
          display: flex;
          margin-bottom: var(--spacing-s);
        }
        :host(.first) .container {
          margin-bottom: var(--spacing-m);
        }
      `]}render(){const e=dc`<h3 class="title heading-3">${this.name}</h3>`,t=this.length>this.numChangesWhenCollapsed;this.collapsed=!this.showAll&&t;let i=uc;if(t){const e=this.showAll?"Show less":`Show all (${this.length})`,t=this.showAll?"expand_less":"expand_more";i=dc`<gr-button link="" @click=${this.toggle}
        >${e}<gr-icon icon=${t}></gr-icon
      ></gr-button>`}return dc`<div class="container">${e}${i}</div>
      <div><slot></slot></div>`}toggle(e){e.stopPropagation(),this.showAll=!this.showAll,this.reporting.reportInteraction(ga.TOGGLE_SHOW_ALL_BUTTON,{sectionName:this.name,toState:this.showAll?"Show all":"Show less"})}};oF([Fc()],sF.prototype,"name",void 0),oF([Fc({type:Boolean})],sF.prototype,"showAll",void 0),oF([Fc({type:Boolean,reflect:!0})],sF.prototype,"collapsed",void 0),oF([Fc({type:Number})],sF.prototype,"length",void 0),oF([Fc({type:Number})],sF.prototype,"numChangesWhenCollapsed",void 0),sF=oF([Dc("gr-related-collapse")],sF);var nF,aF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e.RELATED_CHANGES="related changes",e.SUBMITTED_TOGETHER="submitted together",e.SAME_TOPIC="same topic",e.MERGE_CONFLICTS="merge conflicts",e.CHERRY_PICKS="cherry picks"}(nF||(nF={}));let lF=class extends Ic{constructor(){super(),this.submittedTogether={changes:[],non_visible_changes:0},this.relatedChanges=[],this.conflictingChanges=[],this.cherryPickChanges=[],this.sameTopicChanges=[],this.getChangeModel=yu(this,MT),this.getRelatedChangesModel=yu(this,sD),zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getRelatedChangesModel().relatedChanges$),(e=>this.relatedChanges=e??[])),zf(this,(()=>this.getRelatedChangesModel().submittedTogether$),(e=>this.submittedTogether=e)),zf(this,(()=>this.getRelatedChangesModel().cherryPicks$),(e=>this.cherryPickChanges=e??[])),zf(this,(()=>this.getRelatedChangesModel().conflictingChanges$),(e=>this.conflictingChanges=e??[])),zf(this,(()=>this.getRelatedChangesModel().sameTopicChanges$),(e=>this.sameTopicChanges=e??[]))}static get styles(){return[Nc,Sd`
        .note {
          color: var(--error-text-color);
          margin-left: 1.2em;
        }
        section {
          margin-bottom: var(--spacing-l);
        }
        gr-related-collapse .relatedChangeLine:first-child {
          border-top-left-radius: var(--border-radius);
          border-top-right-radius: var(--border-radius);
        }
        gr-related-collapse .relatedChangeLine:last-child {
          border-bottom-left-radius: var(--border-radius);
          border-bottom-right-radius: var(--border-radius);
          border-bottom: 1px solid var(--border-color);
        }
        .relatedChangeLine {
          background-color: var(--background-color-primary);
          display: flex;
          width: 100%;
          visibility: visible;
          height: auto;
          padding-bottom: 2px;
          padding-top: 2px;
          border-left: 1px solid var(--border-color);
          border-right: 1px solid var(--border-color);
          border-top: 1px solid var(--border-color);
          padding-right: var(--spacing-m);
        }
        .relatedChangeLine.selected {
          background-color: var(--selection-background-color);
        }
        .marker.arrow {
          visibility: hidden;
          min-width: 20px;
        }
        .marker.arrowToCurrentChange {
          min-width: 20px;
          text-align: center;
        }
        .marker.space {
          height: 1px;
          min-width: 20px;
        }
        .repo {
          margin-left: var(--spacing-m);
        }
        .repo,
        .branch {
          color: var(--primary-text-color);
        }
        @media screen and (max-width: 1400px) {
          .repo,
          .branch {
            display: none;
          }
        }

        gr-related-collapse[collapsed] .marker.arrow {
          visibility: visible;
          min-width: auto;
        }
        gr-related-collapse[collapsed] .relatedChangeLine.show-when-collapsed {
          visibility: visible;
          height: auto;
          padding-bottom: 2px;
          padding-top: 2px;
          border-top: 1px solid var(--border-color);
        }
        gr-related-collapse[collapsed]
          .relatedChangeLine.show-when-collapsed:last-child {
          border-bottom: 1px solid var(--border-color);
        }
        gr-related-collapse[collapsed]
          .relatedChangeLine.show-when-collapsed.bottom {
          border-bottom: 1px solid var(--border-color);
        }
        /* keep width, so width of section and position of show all button
         * are set according to width of all (even hidden) elements
         */
        gr-related-collapse[collapsed] .relatedChangeLine {
          visibility: hidden;
          height: 0px;
          padding-top: 0px;
          padding-bottom: 0px;
          border-bottom: none;
          border-top: none;
        }
      `]}render(){const e=this.sectionSizeFactory(this.relatedChanges.length,this.submittedTogether?.changes.length||0,this.sameTopicChanges.length,this.conflictingChanges.length,this.cherryPickChanges.length),t=[this.renderRelationChain,this.renderSubmittedTogether,this.renderSameTopic,this.renderMergeConflicts,this.renderCherryPicks];let i=!1;const r=[];for(const o of t){const t=o.call(this,!i,e);i=i||!!t,r.push(t)}return dc`<gr-endpoint-decorator name="related-changes-section">
      <gr-endpoint-param
        name="change"
        .value=${this.change}
      ></gr-endpoint-param>
      <gr-endpoint-slot name="top"></gr-endpoint-slot>
      ${r}
      <gr-endpoint-slot name="bottom"></gr-endpoint-slot>
    </gr-endpoint-decorator>`}renderRelationChain(e,t){if(0===this.relatedChanges.length)return;const i=this.markersPredicateFactory(this.relatedChanges.length,this.relatedChanges.findIndex((e=>this._changesEqual(e,this.change))),t(nF.RELATED_CHANGES)),r=this._computeConnectedRevisions(this.change,this.latestPatchNum,this.relatedChanges);return dc`<section id="relatedChanges">
      <gr-related-collapse
        .name=${"Relation chain"}
        title="parent changes appear below child changes"
        class=${th({first:e})}
        .length=${this.relatedChanges.length}
        .numChangesWhenCollapsed=${t(nF.RELATED_CHANGES)}
      >
        ${this.relatedChanges.map(((e,t)=>dc`<div
              class=${th({relatedChangeLine:!0,selected:i(t).showCurrentChangeArrow,bottom:i(t).showBottomArrow,"show-when-collapsed":i(t).showWhenCollapsed})}
            >
              ${this.renderMarkers(i(t))}<gr-related-change
                .change=${e}
                .connectedRevisions=${r}
                .href=${e?._change_number?WC({changeNum:e._change_number,repo:e.project,usp:"related-change",patchNum:e._revision_number}):""}
                show-change-status
                show-submittable-check
                ><span slot="name"
                  >${e.commit.subject}</span
                ></gr-related-change
              >
            </div>`))}
      </gr-related-collapse>
    </section>`}renderSubmittedTogether(e,t){const i=this.submittedTogether?.changes??[];if(!i.length&&!this.submittedTogether?.non_visible_changes)return;const r=this.submittedTogether?.non_visible_changes??0,o=this.markersPredicateFactory(i.length,i.findIndex((e=>this._changesEqual(e,this.change))),t(nF.SUBMITTED_TOGETHER));return dc`<section id="submittedTogether">
      <gr-related-collapse
        .name=${"Submitted together"}
        title="parent changes appear below child changes"
        class=${th({first:e})}
        .length=${i.length}
        .numChangesWhenCollapsed=${t(nF.SUBMITTED_TOGETHER)}
      >
        ${i.map(((e,t)=>dc`<div
              class=${th({relatedChangeLine:!0,selected:o(t).showCurrentChangeArrow,bottom:o(t).showBottomArrow,"show-when-collapsed":o(t).showWhenCollapsed})}
            >
              ${this.renderMarkers(o(t))}${this.renderSubmittedTogetherLine(e)}
            </div>`))}
      </gr-related-collapse>
      <div class="note" ?hidden=${!r}>
        (+ ${Ig(r,"non-visible change")})
      </div>
    </section>`}renderSubmittedTogetherLine(e){const t=Tg(e.project,2);return dc`
      <gr-related-change
        .label=${this.renderChangeTitle(e)}
        .change=${e}
        .href=${WC({change:e,usp:"submitted-together"})}
        show-submittable-check
        ><span slot="name">${e.subject}</span
        ><span slot="extra"
          ><span class="repo" .title=${e.project}>${t}</span
          ><span class="branch">&nbsp;|&nbsp;${e.branch}&nbsp;</span></span
        ></gr-related-change
      >
    `}renderSameTopic(e,t){if(!this.sameTopicChanges?.length)return;const i=this.markersPredicateFactory(this.sameTopicChanges.length,-1,t(nF.SAME_TOPIC));return dc`<section id="sameTopic">
      <gr-related-collapse
        .name=${"Same topic"}
        class=${th({first:e})}
        .length=${this.sameTopicChanges.length}
        .numChangesWhenCollapsed=${t(nF.SAME_TOPIC)}
      >
        ${this.sameTopicChanges.map(((e,t)=>dc`<div
              class=${th({relatedChangeLine:!0,selected:i(t).showCurrentChangeArrow,bottom:i(t).showBottomArrow,"show-when-collapsed":i(t).showWhenCollapsed})}
            >
              ${this.renderMarkers(i(t))}${this.renderSubmittedTogetherLine(e)}
            </div>`))}
      </gr-related-collapse>
    </section>`}renderMergeConflicts(e,t){if(!this.conflictingChanges?.length)return;const i=this.markersPredicateFactory(this.conflictingChanges.length,-1,t(nF.MERGE_CONFLICTS));return dc`<section id="mergeConflicts">
      <gr-related-collapse
        .name=${"Merge conflicts"}
        class=${th({first:e})}
        .length=${this.conflictingChanges.length}
        .numChangesWhenCollapsed=${t(nF.MERGE_CONFLICTS)}
      >
        ${this.conflictingChanges.map(((e,t)=>dc`<div
              class=${th({relatedChangeLine:!0,selected:i(t).showCurrentChangeArrow,bottom:i(t).showBottomArrow,"show-when-collapsed":i(t).showWhenCollapsed})}
            >
              ${this.renderMarkers(i(t))}<gr-related-change
                .change=${e}
                .href=${WC({change:e,usp:"merge-conflict"})}
                ><span slot="name">${e.subject}</span></gr-related-change
              >
            </div>`))}
      </gr-related-collapse>
    </section>`}renderCherryPicks(e,t){if(!this.cherryPickChanges.length)return;const i=this.markersPredicateFactory(this.cherryPickChanges.length,-1,t(nF.CHERRY_PICKS));return dc`<section id="cherryPicks">
      <gr-related-collapse
        .name=${"Cherry picks"}
        class=${th({first:e})}
        .length=${this.cherryPickChanges.length}
        .numChangesWhenCollapsed=${t(nF.CHERRY_PICKS)}
      >
        ${this.cherryPickChanges.map(((e,t)=>dc`<div
              class=${th({relatedChangeLine:!0,"show-when-collapsed":i(t).showWhenCollapsed})}
            >
              ${this.renderMarkers(i(t))}<gr-related-change
                .change=${e}
                .href=${WC({change:e,usp:"cherry-pick"})}
                show-change-status
                ><span slot="name"
                  >${e.branch}: ${e.subject}</span
                ></gr-related-change
              >
            </div>`))}
      </gr-related-collapse>
    </section>`}renderChangeTitle(e){return`${e.project}: ${e.branch}: ${e.subject}`}sectionSizeFactory(e,t,i,r,o){const s=e=>Math.min(e,3),n=[{section:nF.RELATED_CHANGES,size:s(e),len:e},{section:nF.SUBMITTED_TOGETHER,size:s(t),len:t},{section:nF.SAME_TOPIC,size:s(i),len:i},{section:nF.MERGE_CONFLICTS,size:s(r),len:r},{section:nF.CHERRY_PICKS,size:s(o),len:o}];let a=n.reduce(((e,t)=>e+t.size+(0!==t.size?1:0)),0);for(let e=0;e<n.length&&!(a>=16);e++){const t=n[e];if(t.size===t.len)continue;const i=Math.min(16-a+t.size,t.len);a+=i-t.size,t.size=i}return e=>{const t=n.find((t=>t.section===e));return t?t.size:3}}markersPredicateFactory(e,t,i=3){const r=r=>{if(-1===t)return r<i;if(0===t)return r<=i-1;if(t===e-1)return r>=e-i;let o=Math.floor(i/2),s=Math.floor(i/2)-(i%2?0:1);return o+=Math.max(t+s-e+1,0),s-=Math.min(0,t-o),t-o<=r&&r<=t+s};return i=>({showCurrentChangeArrow:-1!==t&&i===t,showWhenCollapsed:r(i),showTopArrow:i>=1&&i!==t&&r(i)&&!r(i-1),showBottomArrow:i<=e-2&&i!==t&&r(i)&&!r(i+1)})}renderMarkers(e){return e.showCurrentChangeArrow?dc`<span
        role="img"
        class="marker arrowToCurrentChange"
        aria-label="Arrow marking current change"
        >➔</span
      >`:e.showTopArrow?dc`<span
        role="img"
        class="marker arrow"
        aria-label="Arrow marking change has collapsed ancestors"
        ><gr-icon icon="arrow_drop_up"></gr-icon
      ></span> `:e.showBottomArrow?dc`<span
        role="img"
        class="marker arrow"
        aria-label="Arrow marking change has collapsed descendants"
        ><gr-icon icon="arrow_drop_down"></gr-icon
      ></span> `:dc`<span class="marker space"></span>`}_changesEqual(e,t){return!(!e||!t)&&NC(e)===NC(t)}_computeConnectedRevisions(e,t,i){if(!t||!i||!e)return[];const r=[],o=jC(e,t),s=i.map((e=>e.commit));let n=s.length-1;for(;n>=0;){const e=s[n].commit;if(r.push(e),e===o)break;n--}for(;n>=0;){for(let e=0;e<s[n].parents.length;e++)if(r.includes(s[n].parents[e].commit)){r.push(s[n].commit);break}--n}return r}};aF([Uc()],lF.prototype,"change",void 0),aF([Uc()],lF.prototype,"latestPatchNum",void 0),aF([Uc()],lF.prototype,"submittedTogether",void 0),aF([Uc()],lF.prototype,"relatedChanges",void 0),aF([Uc()],lF.prototype,"conflictingChanges",void 0),aF([Uc()],lF.prototype,"cherryPickChanges",void 0),aF([Uc()],lF.prototype,"sameTopicChanges",void 0),lF=aF([Dc("gr-related-changes-list")],lF);var dF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let cF=class extends Ic{constructor(){super(),this.currentPreviews=[],this.isApplyFixLoading=!1,this.selectedFixIdx=0,this.layers=[],this.loading=!1,this.hasEdit=!1,this.isChangeMerged=!1,this.isChangeAbandoned=!1,this.onCloseFixPreviewCallbacks=[],this.loggedIn=!1,this.restApiService=Xn().restApiService,this.getUserModel=yu(this,jf),this.getChangeModel=yu(this,MT),this.getNavigation=yu(this,gy),this.reporting=Xn().reportingService,this.syntaxLayer=new _T(yu(this,ST),(()=>Xn().reportingService)),zf(this,(()=>this.getUserModel().preferences$),(e=>{const t=[this.syntaxLayer];e?.disable_token_highlighting||t.push(new FD(this)),this.layers=t})),zf(this,(()=>this.getUserModel().loggedIn$),(e=>{this.loggedIn=e})),zf(this,(()=>this.getUserModel().diffPreferences$),(e=>{e&&(this.diffPrefs=e,this.syntaxLayer.setEnabled(!!this.diffPrefs.syntax_highlighting))})),zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getChangeModel().status$),(e=>this.isChangeMerged=e===Nu.MERGED)),zf(this,(()=>this.getChangeModel().status$),(e=>this.isChangeAbandoned=e===Nu.ABANDONED)),zf(this,(()=>this.getChangeModel().revisions$),(e=>this.hasEdit=Object.values(e).some((e=>e._number===Ju))))}static get styles(){return[Nc,Iw,Sd`
        .diffContainer {
          padding: var(--spacing-l) 0;
          border-bottom: 1px solid var(--border-color);
        }
        .file-name {
          display: block;
          padding: var(--spacing-s) var(--spacing-l);
          background-color: var(--background-color-secondary);
          border-bottom: 1px solid var(--border-color);
        }
        gr-button {
          margin-left: var(--spacing-m);
        }
        .fix-picker {
          display: flex;
          align-items: center;
          margin-right: var(--spacing-l);
        }
        .info {
          background-color: var(--info-background);
          padding: var(--spacing-l) var(--spacing-xl);
        }
        .info gr-icon {
          color: var(--selected-foreground);
          margin-right: var(--spacing-xl);
        }
      `]}render(){return dc`
      <dialog id="applyFixModal" tabindex="-1">
        <gr-dialog
          id="applyFixDialog"
          ?loading=${this.loading}
          .loadingLabel=${"Creating preview ..."}
          .confirmLabel=${this.isApplyFixLoading?"Saving...":"Apply Fix"}
          .confirmTooltip=${this.computeTooltip()}
          ?disabled=${this.computeDisableApplyFixButton()}
          @confirm=${this.handleApplyFix}
          @cancel=${this.onCancel}
        >
          ${this.renderHeader()} ${this.renderMain()} ${this.renderFooter()}
        </gr-dialog>
      </dialog>
    `}renderHeader(){return dc`
      <div slot="header">${this.currentFix?.description??""}</div>
    `}renderMain(){const e=this.currentPreviews.map((e=>dc`
        <div class="file-name">
          <span>${e.filepath}</span>
        </div>
        <div class="diffContainer">${this.renderDiff(e)}</div>
      `));return dc`<div slot="main">${e}</div>`}renderDiff(e){const t=e.preview;return this.syntaxLayer.process(t),dc`<gr-diff
      .prefs=${this.overridePartialDiffPrefs()}
      .path=${e.filepath}
      .diff=${t}
      .layers=${this.layers}
    ></gr-diff>`}renderFooter(){const e=this.fixSuggestions?.length??0,t=this.computeTooltip(),i=e>=2,r=!!t;return i||r?dc`
      <div slot="footer" class="fix-picker">
        ${eb(i,(()=>this.renderNavForMultipleSuggestedFixes(e)))}
        ${eb(r,(()=>this.renderWarning(t)))}
      </div>
    `:uc}renderNavForMultipleSuggestedFixes(e){const t=this.selectedFixIdx;return dc`
      <span>Suggested fix ${t+1} of ${e}</span>
      <gr-button
        id="prevFix"
        @click=${this.onPrevFixClick}
        ?disabled=${0===t}
      >
        <gr-icon icon="chevron_left"></gr-icon>
      </gr-button>
      <gr-button
        id="nextFix"
        @click=${this.onNextFixClick}
        ?disabled=${t===e-1}
      >
        <gr-icon icon="chevron_right"></gr-icon>
      </gr-button>
    `}renderWarning(e){return e?dc`<span class="info"
      ><gr-icon icon="info"></gr-icon>${e}</span
    >`:uc}open(e){return this.patchNum=e.detail.patchNum,this.fixSuggestions=e.detail.fixSuggestions,this.onCloseFixPreviewCallbacks=e.detail.onCloseFixPreviewCallbacks,va(this.fixSuggestions.length>0,"no fix in the event"),this.selectedFixIdx=0,this.applyFixModal?.showModal(),this.showSelectedFixSuggestion(this.fixSuggestions[0])}async showSelectedFixSuggestion(e){this.currentFix=e,this.loading=!0,this.reporting.time(ua.PREVIEW_FIX_LOAD),await this.fetchFixPreview(e),this.reporting.timeEnd(ua.PREVIEW_FIX_LOAD),this.loading=!1}async fetchFixPreview(e){if(!this.changeNum||!this.patchNum)return Promise.reject(new Error("Both patchNum and changeNum must be set"));let t;try{t=await this.restApiService.getFixPreview(this.changeNum,this.patchNum,e.replacements),t&&(this.currentPreviews=Object.keys(t).map((e=>({filepath:e,preview:t[e]}))))}catch(e){throw this.close(!1),e}return t}overridePartialDiffPrefs(){if(this.diffPrefs)return{...this.diffPrefs,line_length:Math.min(this.diffPrefs.line_length,100)}}onCancel(e){e&&e.stopPropagation(),this.close(!1)}onPrevFixClick(e){e&&e.stopPropagation(),this.selectedFixIdx>=1&&this.fixSuggestions&&(this.selectedFixIdx-=1,this.showSelectedFixSuggestion(this.fixSuggestions[this.selectedFixIdx]))}onNextFixClick(e){e&&e.stopPropagation(),this.fixSuggestions&&this.selectedFixIdx<this.fixSuggestions.length&&(this.selectedFixIdx+=1,this.showSelectedFixSuggestion(this.fixSuggestions[this.selectedFixIdx]))}close(e){this.currentFix=void 0,this.currentPreviews=[],this.isApplyFixLoading=!1,this.onCloseFixPreviewCallbacks.forEach((t=>t(e))),this.applyFixModal?.close(),e&&aa(this)}computeTooltip(){return this.change&&this.patchNum?this.isChangeMerged?"Change is already merged":this.isChangeAbandoned?"Change is abandoned":this.isApplyFixLoading?"Fix is still loading ...":this.loggedIn?this.currentPreviews[0]?.filepath===hg.COMMIT_MESSAGE&&this.patchNum!==this.latestPatchNum?"You cannot apply a commit message edit from a previous patch set":"":"You must be logged in to apply a fix":""}computeDisableApplyFixButton(){return!this.change||!this.patchNum||!!this.isChangeMerged||!!this.isChangeAbandoned||!this.loggedIn||this.currentPreviews[0]?.filepath===hg.COMMIT_MESSAGE&&this.patchNum!==this.latestPatchNum||this.isApplyFixLoading}async handleApplyFix(e){e&&e.stopPropagation();const{changeNum:t,patchNum:i,change:r}=this;if(!(t&&i&&r&&this.currentFix))throw new Error("Not all required properties are set.");let o;if(this.isApplyFixLoading=!0,this.reporting.time(ua.APPLY_FIX_LOAD),this.fixSuggestions?.[this.selectedFixIdx].fix_id===pC){let e="",r="";try{o=await this.restApiService.applyFixSuggestion(t,i,this.fixSuggestions[this.selectedFixIdx].replacements,this.latestPatchNum)}catch(t){t instanceof Error&&(e=t.message,r=e.match(/\b\d{3}\b/)?.[0]||""),ta(this,`Applying Fix failed.\n${e}`)}finally{this.reporting.timeEnd(ua.APPLY_FIX_LOAD,{method:"apply-fix-dialog",description:this.fixSuggestions?.[0].description,fileExtension:HR(this.fixSuggestions?.[0]?.replacements?.[0].path??""),success:o?.ok??!1,status:o?.status??r,errorText:e})}}o?.ok&&(this.getNavigation().setUrl(WC({change:r,patchNum:Ju,basePatchNum:i,forceReload:!this.hasEdit})),this.close(!0)),this.isApplyFixLoading=!1}};dF([Hc("#applyFixModal")],cF.prototype,"applyFixModal",void 0),dF([Hc("#applyFixDialog")],cF.prototype,"applyFixDialog",void 0),dF([Hc("#nextFix")],cF.prototype,"nextFix",void 0),dF([Uc()],cF.prototype,"change",void 0),dF([Uc()],cF.prototype,"changeNum",void 0),dF([Uc()],cF.prototype,"patchNum",void 0),dF([Uc()],cF.prototype,"latestPatchNum",void 0),dF([Uc()],cF.prototype,"currentFix",void 0),dF([Uc()],cF.prototype,"currentPreviews",void 0),dF([Uc()],cF.prototype,"fixSuggestions",void 0),dF([Uc()],cF.prototype,"isApplyFixLoading",void 0),dF([Uc()],cF.prototype,"selectedFixIdx",void 0),dF([Uc()],cF.prototype,"layers",void 0),dF([Uc()],cF.prototype,"diffPrefs",void 0),dF([Uc()],cF.prototype,"loading",void 0),dF([Uc()],cF.prototype,"hasEdit",void 0),dF([Uc()],cF.prototype,"isChangeMerged",void 0),dF([Uc()],cF.prototype,"isChangeAbandoned",void 0),dF([Uc()],cF.prototype,"onCloseFixPreviewCallbacks",void 0),dF([Uc()],cF.prototype,"loggedIn",void 0),cF=dF([Dc("gr-apply-fix-dialog")],cF);var hF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let pF=class extends Ic{static get styles(){return[Qb,Sd`
        .scoresTable {
          display: table;
          width: 100%;
          table-layout: fixed;
        }
        .mergedMessage,
        .abandonedMessage {
          font-style: italic;
          text-align: center;
        }
        .permissionMessage {
          color: var(--deemphasized-text-color);
          padding-left: var(--label-score-padding-left, 0);
        }
        gr-label-score-row:hover {
          background-color: var(--hover-background-color);
        }
        gr-label-score-row {
          display: table-row;
        }
        .heading-4 {
          padding-left: var(--label-score-padding-left, 0);
          margin-bottom: var(--spacing-s);
          margin-top: var(--spacing-l);
        }
        .heading-4:first-of-type {
          margin-top: 0;
        }
      `]}render(){return dc`${this.renderSubmitReqsLabels()}${this.renderTriggerVotes()}
    ${this.renderErrorMessages()}`}renderSubmitReqsLabels(){const e=Nv(this.change),t=function(e){const t=e?.submit_requirements??[],i=t.filter((e=>e.status===tg.NOT_APPLICABLE)).flatMap((e=>wv(e))).filter(Ca),r=t.filter((e=>e.status!==tg.NOT_APPLICABLE)).flatMap((e=>wv(e))).filter(Ca),o=i.filter((e=>!r.includes(e)));return r.filter((e=>!o.includes(e)))}(this.change),i=Pv(this.account,this.change).filter((t=>!e.includes(t.name))).filter((e=>t.includes(e.name)));if(i.length)return 0===i.filter((e=>!this.permittedLabels||this.permittedLabels[e.name])).length?dc`<h3 class="heading-4">Submit requirements votes</h3>
        <div class="permissionMessage">You don't have permission to vote</div>`:dc`<h3 class="heading-4">Submit requirements votes</h3>
      ${this.renderLabels(i)}`}renderTriggerVotes(){const e=Nv(this.change),t=Pv(this.account,this.change).filter((t=>e.includes(t.name)));if(t.length)return 0===t.filter((e=>!this.permittedLabels||this.permittedLabels[e.name])).length?uc:dc`<h3 class="heading-4">Trigger Votes</h3>
      ${this.renderLabels(t)}`}renderLabels(e){return dc`<div class="scoresTable">
      ${e.filter((e=>this.permittedLabels?.[e.name]&&this.permittedLabels?.[e.name].length>0)).map((e=>dc`<gr-label-score-row
            .label=${e}
            .name=${e.name}
            .labels=${this.change?.labels}
            .permittedLabels=${this.permittedLabels}
            .orderedLabelValues=${Av(this.permittedLabels)}
          ></gr-label-score-row>`))}
    </div>`}renderErrorMessages(){return dc`<div
        class="mergedMessage"
        ?hidden=${this.change?.status!==Nu.MERGED}
      >
        Because this change has been merged, votes may not be decreased.
      </div>
      <div
        class="abandonedMessage"
        ?hidden=${this.change?.status!==Nu.ABANDONED}
      >
        Because this change has been abandoned, you cannot vote.
      </div>`}getLabelValues(e=!0){const t={};if(null===this.shadowRoot||!this.change)return t;for(const i of Object.keys(this.permittedLabels??{})){const r=this.shadowRoot.querySelector(`gr-label-score-row[name="${i}"]`);if(!r?.selectedItem)continue;const o="string"==typeof r.selectedValue?Number(r.selectedValue):r.selectedValue;if(void 0===o)continue;const s=$v(this.change?.labels,i);(e||o!==s)&&(t[i]=o)}return t}};hF([Fc({type:Object})],pF.prototype,"permittedLabels",void 0),hF([Fc({type:Object})],pF.prototype,"change",void 0),hF([Fc({type:Object})],pF.prototype,"account",void 0),pF=hF([Dc("gr-label-scores")],pF);var uF,gF,mF,fF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};!function(e){e.ANY="any",e.BODY="body",e.CCS="cc",e.REVIEWERS="reviewers"}(uF||(uF={})),function(e){e.REVIEWER="REVIEWER",e.CC="CC"}(gF||(gF={})),function(e){e.LATEST="latest",e.CHECKING="checking",e.NOT_LATEST="not-latest"}(mF||(mF={}));const vF="Send";let bF=class extends Ic{get ccs(){return[...this._ccs,...this.mentionedUsers.filter((e=>!this.isAlreadyReviewerOrCC(e)))]}set ccs(e){this._ccs=e.filter((e=>!this.mentionedUsers.some((t=>px(t)===px(e))))),this.requestUpdate("ccs",e)}static get styles(){return[vy,Nc,Iw,Jy,Sd`
        gr-account-list.drag-over {
          background-color: var(--table-header-background-color);
          outline: 2px dashed var(--border-color);
        }
        :host {
          background-color: var(--dialog-background-color);
          display: block;
          max-height: 90vh;
          --label-score-padding-left: var(--spacing-xl);
        }
        :host([disabled]) {
          pointer-events: none;
        }
        :host([disabled]) .container {
          opacity: 0.5;
        }
        section {
          border-top: 1px solid var(--border-color);
          flex-shrink: 0;
          padding: var(--spacing-m) var(--spacing-xl);
          width: 100%;
        }
        section.labelsContainer {
          /* We want the :hover highlight to extend to the border of the dialog. */
          padding: var(--spacing-m) 0;
        }
        .stickyBottom {
          background-color: var(--dialog-background-color);
          box-shadow: 0px 0px 8px 0px rgba(60, 64, 67, 0.15);
          margin-top: var(--spacing-s);
          bottom: 0;
          position: sticky;
          /* @see Issue 8602 */
          z-index: 1;
        }
        .stickyBottom.newReplyDialog {
          margin-top: unset;
        }
        .actions {
          display: flex;
          justify-content: space-between;
        }
        .actions .right gr-button {
          margin-left: var(--spacing-l);
        }
        .peopleContainer,
        .labelsContainer {
          flex-shrink: 0;
        }
        .peopleContainer {
          border-top: none;
          display: table;
        }
        .peopleList {
          display: flex;
        }
        .peopleListLabel {
          color: var(--deemphasized-text-color);
          margin-top: var(--spacing-xs);
          min-width: 6em;
          padding-right: var(--spacing-m);
        }
        gr-account-list {
          display: flex;
          flex-wrap: wrap;
          flex: 1;
        }
        #reviewerConfirmationModal {
          padding: var(--spacing-l);
          text-align: center;
        }
        .reviewerConfirmationButtons {
          margin-top: var(--spacing-l);
        }
        .groupName {
          font-weight: var(--font-weight-medium);
        }
        .groupSize {
          font-style: italic;
        }
        .textareaContainer {
          min-height: 12em;
          position: relative;
        }
        .newReplyDialog.textareaContainer {
          min-height: unset;
        }
        textareaContainer,
        gr-endpoint-decorator[name='reply-text'] {
          display: flex;
          width: 100%;
        }
        gr-endpoint-decorator[name='reply-text'] {
          flex-direction: column;
        }
        #changeIsMergedLabel #checkingStatusLabel,
        #notLatestLabel {
          margin-left: var(--spacing-l);
        }
        #checkingStatusLabel {
          color: var(--deemphasized-text-color);
          font-style: italic;
        }
        #changeIsMergedLabel,
        #notLatestLabel,
        #savingLabel {
          color: var(--error-text-color);
        }
        #savingLabel {
          display: none;
        }
        #savingLabel.saving {
          display: inline;
        }
        #pluginMessage {
          color: var(--deemphasized-text-color);
          margin-left: var(--spacing-l);
          margin-bottom: var(--spacing-m);
        }
        #pluginMessage:empty {
          display: none;
        }
        .edit-attention-button {
          vertical-align: top;
          --gr-button-padding: 0px 4px;
        }
        .edit-attention-button gr-icon {
          color: inherit;
        }
        .attentionSummary .edit-attention-button gr-icon {
          /* The line-height:26px hack (see below) requires us to do this.
           Normally the gr-icon would account for a proper positioning
           within the standard line-height:20px context. */
          top: 5px;
        }
        .attention a,
        .attention-detail a {
          text-decoration: none;
        }
        .attentionSummary {
          display: flex;
          justify-content: space-between;
        }
        .attentionSummary {
          /* The account label for selection is misbehaving currently: It consumes
          26px height instead of 20px, which is the default line-height and thus
          the max that can be nicely fit into an inline layout flow. We
          acknowledge that using a fixed 26px value here is a hack and not a
          great solution. */
          line-height: 26px;
        }
        .attentionSummary gr-account-label,
        .attention-detail gr-account-label {
          --account-max-length: 120px;
          display: inline-block;
          padding: var(--spacing-xs) var(--spacing-m);
          user-select: none;
          --label-border-radius: 8px;
        }
        .attentionSummary gr-account-label {
          margin: 0 var(--spacing-xs);
          line-height: var(--line-height-normal);
          vertical-align: top;
        }
        .attention-detail .peopleListValues {
          line-height: calc(var(--line-height-normal) + 10px);
        }
        .attention-detail gr-account-label {
          line-height: var(--line-height-normal);
        }
        .attentionSummary gr-account-label:focus,
        .attention-detail gr-account-label:focus {
          outline: none;
        }
        .attentionSummary gr-account-label:hover,
        .attention-detail gr-account-label:hover {
          box-shadow: var(--elevation-level-1);
          cursor: pointer;
        }
        .attention-detail .attentionDetailsTitle {
          display: flex;
          justify-content: space-between;
        }
        .attention-detail .selectUsers {
          color: var(--deemphasized-text-color);
          margin-bottom: var(--spacing-m);
        }
        .attentionTip {
          padding: var(--spacing-m);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          margin-top: var(--spacing-m);
          background-color: var(--line-item-highlight-color);
        }
        .attentionTip div gr-icon {
          margin-right: var(--spacing-s);
        }
        .patchsetLevelContainer {
          width: calc(min(80ch, 100%));
          border-radius: var(--border-radius);
          box-shadow: var(--elevation-level-2);
        }
        .patchsetLevelContainer.resolved {
          background-color: var(--comment-background-color);
        }
        .patchsetLevelContainer.unresolved {
          background-color: var(--unresolved-comment-background-color);
        }
        .privateVisiblityInfo {
          display: flex;
          justify-content: center;
          background-color: var(--info-background);
          padding: var(--spacing-s) 0;
        }
        .privateVisiblityInfo gr-icon {
          margin-right: var(--spacing-m);
          color: var(--info-foreground);
        }
        .rightActions {
          display: flex;
          align-items: center;
          gap: var(--spacing-s);
        }
        .rightActions a {
          display: flex;
          align-items: center;
        }
        .rightActions gr-icon {
          margin: 0;
        }
        md-checkbox {
          --md-checkbox-container-size: 15px;
          --md-checkbox-icon-size: 15px;
        }
      `]}constructor(){super(),this.FocusTarget=uF,this.reporting=Xn().reportingService,this.getChangeModel=yu(this,MT),this.getCommentsModel=yu(this,kP),this.canBeStarted=!1,this.disabled=!1,this.draftCommentThreads=[],this.docsBaseUrl="",this.patchsetLevelDraftMessage="",this.isChangeMerged=!1,this.underReview=!0,this._ccs=[],this.mentionedUsers=[],this.mentionedUsersInUnresolvedDrafts=[],this.attentionCcsCount=0,this.ccPendingConfirmation=null,this.pendingConfirmationDetails=null,this.includeComments=!0,this.reviewers=[],this.reviewerPendingConfirmation=null,this.savingComments=!1,this.reviewersMutated=!1,this.labelsChanged=!1,this.saveTooltip="Send changes and comments as work in progress but do not start review",this.pluginMessage="",this.commentEditing=!1,this.attentionExpanded=!1,this.currentAttentionSet=new Set,this.newAttentionSet=new Set,this.manuallyAddedAttentionSet=new Set,this.manuallyDeletedAttentionSet=new Set,this.patchsetLevelDraftIsResolved=!0,this.isOwner=!1,this.draggedAccount=null,this.draggedFrom=null,this.restApiService=Xn().restApiService,this.getPluginLoader=yu(this,U_),this.getConfigModel=yu(this,Qw),this.getAccountsModel=yu(this,mE),this.getUserModel=yu(this,jf),this.getNavigation=yu(this,gy),this.isLoggedIn=!1,this.shortcuts=new Gg(this),this.filterReviewerSuggestion=this.filterReviewerSuggestionGenerator(!1),this.filterCCSuggestion=this.filterReviewerSuggestionGenerator(!0),this.shortcuts.addLocal({key:Mn.ESC},(()=>this.cancel())),this.shortcuts.addLocal({key:Mn.ENTER,modifiers:[Fn.CTRL_KEY]},(()=>this.submit())),this.shortcuts.addLocal({key:Mn.ENTER,modifiers:[Fn.META_KEY]},(()=>this.submit())),zf(this,(()=>this.getUserModel().loggedIn$),(e=>this.isLoggedIn=e)),zf(this,(()=>this.getUserModel().account$),(e=>{this.account=e})),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.serverConfig=e})),zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e)),zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getChangeModel().isOwner$),(e=>this.isOwner=e)),zf(this,(()=>this.getCommentsModel().mentionedUsersInDrafts$),(e=>{this.mentionedUsers=e,this.reviewersMutated=this.reviewersMutated||this.mentionedUsers.length>0})),zf(this,(()=>this.getCommentsModel().mentionedUsersInUnresolvedDrafts$),(e=>{this.mentionedUsersInUnresolvedDrafts=e.filter((e=>!this.isAlreadyReviewerOrCC(e)))})),zf(this,(()=>this.getCommentsModel().patchsetLevelDrafts$),(e=>this.patchsetLevelComment=e[0])),zf(this,(()=>this.getCommentsModel().draftThreadsSaved$),(e=>this.draftCommentThreads=e.filter((e=>!(yf(Jx(e))&&Qx(e))))))}connectedCallback(){super.connectedCallback(),HL(),this.getPluginLoader().jsApiService.addElement(a_.REPLY_DIALOG,this),this.addEventListener("comment-editing-changed",(e=>{if(e.detail.path===hg.PATCHSET_LEVEL_COMMENTS)return;const t=_a(this,"#commentList");this.commentEditing=Array.from(t.threadElements??[]).some((e=>e.editing))})),this.addEventListener("add-reviewer",(e=>{const t=e.detail.reviewer;this.reviewersList?.addAccountItem({account:t,count:1})})),this.addEventListener("remove-reviewer",(e=>{const t=e.detail.reviewer;this.reviewersList?.removeAccount(t)}))}willUpdate(e){e.has("ccPendingConfirmation")&&this.pendingConfirmationUpdated(this.ccPendingConfirmation),e.has("reviewerPendingConfirmation")&&this.pendingConfirmationUpdated(this.reviewerPendingConfirmation),e.has("change")&&(this.computeUploader(),this.rebuildReviewerArrays()),e.has("canBeStarted")&&this.computeMessagePlaceholder(),e.has("attentionExpanded")&&this.onAttentionExpandedChange(),(e.has("account")||e.has("reviewers")||e.has("ccs")||e.has("change")||e.has("draftCommentThreads")||e.has("mentionedUsersInUnresolvedDrafts")||e.has("includeComments")||e.has("labelsChanged")||e.has("patchsetLevelDraftMessage")||e.has("mentionedCCs"))&&this.computeNewAttention()}disconnectedCallback(){this.storeTask?.flush(),super.disconnectedCallback()}render(){if(this.change)return dc`
      <div tabindex="-1">
        <section class="peopleContainer">
          <gr-endpoint-decorator name="reply-reviewers">
            <gr-endpoint-param
              name="change"
              .value=${this.change}
            ></gr-endpoint-param>
            <gr-endpoint-param name="reviewers" .value=${[...this.reviewers]}>
            </gr-endpoint-param>
            ${this.renderReviewerList()}
            <gr-endpoint-slot name="below"></gr-endpoint-slot>
          </gr-endpoint-decorator>
          ${this.renderCCList()} ${this.renderReviewConfirmation()}
          ${this.renderPrivateVisiblityInfo()}
        </section>
        <section class="labelsContainer">${this.renderLabels()}</section>
        <section class="newReplyDialog textareaContainer">
          ${this.renderReplyText()}
        </section>
        ${this.renderDraftsSection()}
        <div class="stickyBottom newReplyDialog">
          <gr-endpoint-decorator name="reply-bottom">
            <gr-endpoint-param
              name="change"
              .value=${this.change}
            ></gr-endpoint-param>
            ${eb(this.attentionExpanded,(()=>this.renderAttentionDetailsSection()),(()=>this.renderAttentionSummarySection()))}
            <gr-endpoint-slot name="above-actions"></gr-endpoint-slot>
            ${this.renderActionsSection()}
          </gr-endpoint-decorator>
        </div>
      </div>
    `}renderReviewerList(){return dc`
      <div class="peopleList">
        <div class="peopleListLabel">Reviewers</div>
        <gr-account-list
          id="reviewers"
          .accounts=${[...this.reviewers]}
          .change=${this.change}
          .reviewerState=${Vu.REVIEWER}
          .chipDraggable=${!0}
          @account-added=${this.handleAccountAdded}
          @accounts-changed=${this.handleReviewersChanged}
          @account-drag-start=${this.handleAccountDragStart}
          @dragover=${this.handleDragOver}
          @dragleave=${this.handleDragLeave}
          @drop=${this.handleDrop}
          .removableValues=${this.change?.removable_reviewers}
          .filter=${this.filterReviewerSuggestion}
          .pendingConfirmation=${this.reviewerPendingConfirmation}
          @pending-confirmation-changed=${this.handleReviewersConfirmationChanged}
          .placeholder=${"Add reviewer..."}
          @account-text-changed=${this.handleAccountTextEntry}
          .suggestionsProvider=${this.getReviewerSuggestionsProvider(this.change)}
        >
        </gr-account-list>
        <gr-endpoint-slot name="right"></gr-endpoint-slot>
      </div>
    `}renderCCList(){return dc`
      <div class="peopleList">
        <div class="peopleListLabel">CC</div>
        <gr-account-list
          id="ccs"
          .accounts=${[...this.ccs]}
          .change=${this.change}
          .reviewerState=${Vu.CC}
          .chipDraggable=${!0}
          @account-added=${this.handleAccountAdded}
          @accounts-changed=${this.handleCcsChanged}
          @account-drag-start=${this.handleAccountDragStart}
          @dragover=${this.handleDragOver}
          @dragleave=${this.handleDragLeave}
          @drop=${this.handleDrop}
          .filter=${this.filterCCSuggestion}
          .pendingConfirmation=${this.ccPendingConfirmation}
          @pending-confirmation-changed=${this.handleCcsConfirmationChanged}
          allow-any-input
          .placeholder=${"Add CC..."}
          @account-text-changed=${this.handleAccountTextEntry}
          .suggestionsProvider=${this.getCcSuggestionsProvider(this.change)}
        >
        </gr-account-list>
      </div>
    `}renderReviewConfirmation(){return dc`
      <dialog
        tabindex="-1"
        id="reviewerConfirmationModal"
        @close=${this.cancelPendingReviewer}
      >
        <div class="reviewerConfirmation">
          Group
          <span class="groupName">
            ${this.pendingConfirmationDetails?.group.name}
          </span>
          has
          <span class="groupSize">
            ${this.pendingConfirmationDetails?.count}
          </span>
          members.
          <br />
          Are you sure you want to add them all?
        </div>
        <div class="reviewerConfirmationButtons">
          <gr-button @click=${this.confirmPendingReviewer}>Yes</gr-button>
          <gr-button @click=${this.cancelPendingReviewer}>No</gr-button>
        </div>
      </dialog>
    `}renderPrivateVisiblityInfo(){const e=[...this.reviewersList?.additions()??[],...this.ccsList?.additions()??[]];return this.change?.is_private&&e.length?dc`
      <div class="privateVisiblityInfo">
        <gr-icon icon="info"></gr-icon>
        <div>
          Adding a reviewer/CC will make this private change visible to them
        </div>
      </div>
    `:uc}renderLabels(){if(this.change&&this.account&&this.permittedLabels)return dc`
      <gr-endpoint-decorator name="reply-label-scores">
        <gr-label-scores
          id="labelScores"
          .account=${this.account}
          .change=${this.change}
          @labels-changed=${this._handleLabelsChanged}
          .permittedLabels=${this.permittedLabels}
        ></gr-label-scores>
        <gr-endpoint-param
          name="change"
          .value=${this.change}
        ></gr-endpoint-param>
      </gr-endpoint-decorator>
      <div id="pluginMessage">${this.pluginMessage}</div>
    `}renderPatchsetLevelComment(){return this.patchsetLevelComment?dc`
      <gr-comment
        id="patchsetLevelComment"
        .comment=${this.patchsetLevelComment}
        .comments=${[this.patchsetLevelComment]}
        @comment-unresolved-changed=${e=>{this.patchsetLevelDraftIsResolved=!e.detail.value}}
        @comment-text-changed=${e=>{this.patchsetLevelDraftMessage=e.detail.value,Jn(e.currentTarget,"value-changed",e.detail)}}
        .messagePlaceholder=${this.messagePlaceholder??""}
        hide-header
        permanent-editing-mode
      ></gr-comment>
    `:uc}renderReplyText(){if(this.change)return dc`
      <div
        class=${th({patchsetLevelContainer:!0,[this.getUnresolvedPatchsetLevelClass(this.patchsetLevelDraftIsResolved)]:!0})}
      >
        <gr-endpoint-decorator name="reply-text">
          ${this.renderPatchsetLevelComment()}
          <gr-endpoint-param name="change" .value=${this.change}>
          </gr-endpoint-param>
        </gr-endpoint-decorator>
      </div>
    `}renderDraftsSection(){const e=this.draftCommentThreads;if(e&&0!==e.length)return dc`
      <section class="draftsContainer">
        <div class="includeComments">
          <md-checkbox
            id="includeComments"
            @change=${this.handleIncludeCommentsChanged}
            ?checked=${this.includeComments}
          ></md-checkbox>
          Publish ${this.computeDraftsTitle(e)}
        </div>
        ${eb(this.includeComments,(()=>dc`
            <gr-thread-list id="commentList" .threads=${e} hide-dropdown>
            </gr-thread-list>
          `))}
        <span
          id="savingLabel"
          class=${this.computeSavingLabelClass(this.savingComments)}
        >
          Saving comments...
        </span>
      </section>
    `}renderAttentionSummarySection(){return dc`
      <section class="attention">
        <div class="attentionSummary">
          <div>
            ${eb(this.computeShowNoAttentionUpdate(),(()=>dc` <span>${this.computeDoNotUpdateMessage()}</span> `))}
            ${eb(!this.computeShowNoAttentionUpdate(),(()=>dc`
                <span>Bring to attention of</span>
                ${this.computeNewAttentionAccounts().map((e=>dc`
                    <gr-account-label
                      .account=${e}
                      .forceAttention=${this.computeHasNewAttention(e)}
                      .selected=${this.computeHasNewAttention(e)}
                      .hideHovercard=${!0}
                      .selectionChipStyle=${!0}
                      @click=${this.handleAttentionClick}
                    ></gr-account-label>
                  `))}
              `))}
          </div>
          <div class="rightActions">
            ${this.renderModifyAttentionSetButton()}
            <a
              href=${$f(this.docsBaseUrl,"user-attention-set.html")}
              target="_blank"
              rel="noopener noreferrer"
            >
              <gr-icon icon="help" title="read documentation"></gr-icon>
            </a>
          </div>
        </div>
      </section>
    `}renderModifyAttentionSetButton(){return dc` <gr-button
      class="edit-attention-button"
      @click=${this.toggleAttentionModify}
      link
      position-below
      data-label="Edit"
      data-action-type="change"
      data-action-key="edit"
      role="button"
      tabindex="0"
    >
      <div>
        <gr-icon
          icon=${this.attentionExpanded?"expand_circle_up":"edit"}
          filled
          small
        ></gr-icon>
        <span>${this.attentionExpanded?"Collapse":"Modify"}</span>
      </div>
    </gr-button>`}renderAttentionDetailsSection(){return dc`
      <section class="attention-detail">
        <div class="attentionDetailsTitle">
          <div>
            <span>Modify attention to</span>
          </div>
          <div class="rightActions">
            ${this.renderModifyAttentionSetButton()}
            <a
              href=${$f(this.docsBaseUrl,"user-attention-set.html")}
              target="_blank"
              rel="noopener noreferrer"
            >
              <gr-icon icon="help" title="read documentation"></gr-icon>
            </a>
          </div>
        </div>
        <div class="selectUsers">
          <span
            >Select chips to set who will be in the attention set after sending
            this reply</span
          >
        </div>
        <div class="peopleList">
          <div class="peopleListLabel">Owner</div>
          <div class="peopleListValues">
            <gr-account-label
              .account=${this.change?.owner}
              ?forceAttention=${this.computeHasNewAttention(this.change?.owner)}
              .selected=${this.computeHasNewAttention(this.change?.owner)}
              .hideHovercard=${!0}
              .selectionChipStyle=${!0}
              @click=${this.handleAttentionClick}
            >
            </gr-account-label>
          </div>
        </div>
        ${eb(this.uploader,(()=>dc`
            <div class="peopleList">
              <div class="peopleListLabel">Uploader</div>
              <div class="peopleListValues">
                <gr-account-label
                  .account=${this.uploader}
                  ?forceAttention=${this.computeHasNewAttention(this.uploader)}
                  .selected=${this.computeHasNewAttention(this.uploader)}
                  .hideHovercard=${!0}
                  .selectionChipStyle=${!0}
                  @click=${this.handleAttentionClick}
                >
                </gr-account-label>
              </div>
            </div>
          `))}
        <div class="peopleList">
          <div class="peopleListLabel">Reviewers</div>
          <div class="peopleListValues">
            ${hx(this.reviewers).map((e=>dc`
                <gr-account-label
                  .account=${e}
                  ?forceAttention=${this.computeHasNewAttention(e)}
                  .selected=${this.computeHasNewAttention(e)}
                  .hideHovercard=${!0}
                  .selectionChipStyle=${!0}
                  @click=${this.handleAttentionClick}
                >
                </gr-account-label>
              `))}
          </div>
        </div>

        ${eb(this.attentionCcsCount,(()=>dc`
            <div class="peopleList">
              <div class="peopleListLabel">CC</div>
              <div class="peopleListValues">
                ${hx(this.ccs).map((e=>dc`
                    <gr-account-label
                      .account=${e}
                      ?forceAttention=${this.computeHasNewAttention(e)}
                      .selected=${this.computeHasNewAttention(e)}
                      .hideHovercard=${!0}
                      .selectionChipStyle=${!0}
                      @click=${this.handleAttentionClick}
                    >
                    </gr-account-label>
                  `))}
              </div>
            </div>
          `))}
        ${eb(this.computeShowAttentionTip(3),(()=>dc`
            <div class="attentionTip">
              <gr-icon icon="lightbulb"></gr-icon>
              Please be mindful of requiring attention from too many users.
            </div>
          `))}
      </section>
    `}renderActionsSection(){return dc`
      <section class="actions">
        <div class="left">
          ${eb(this.knownLatestState===mF.CHECKING,(()=>dc`
              <span id="checkingStatusLabel">
                Checking whether patch ${this.latestPatchNum} is latest...
              </span>
            `))}
          ${eb(this.knownLatestState!==mF.CHECKING&&this.isChangeMerged,(()=>dc`
              <span id="changeIsMergedLabel">
                ${this.computeChangeMergedWarning()}
              </span>
            `))}
          ${eb(!this.isChangeMerged&&this.knownLatestState===mF.NOT_LATEST,(()=>dc`
              <span id="notLatestLabel">
                ${this.computePatchSetWarning()}
                <gr-button link @click=${this._reload}>Reload</gr-button>
              </span>
            `))}
        </div>
        <div class="right">
          <gr-button
            link
            id="cancelButton"
            class="action cancel"
            @click=${this.cancelTapHandler}
            >Cancel</gr-button
          >
          ${eb(this.canBeStarted,(()=>dc`
              <!-- Use 'Send' here as the change may only about reviewers / ccs
            and when this button is visible, the next button will always
            be 'Start review' -->
              <gr-tooltip-content has-tooltip title=${this.saveTooltip}>
                <gr-button
                  link
                  ?disabled=${this.knownLatestState===mF.NOT_LATEST}
                  class="action save"
                  @click=${this.saveClickHandler}
                  >Send As WIP</gr-button
                >
              </gr-tooltip-content>
            `))}
          <gr-tooltip-content
            has-tooltip
            title=${this.computeSendButtonTooltip(this.canBeStarted,this.commentEditing)}
          >
            <gr-button
              id="sendButton"
              primary
              ?disabled=${!!this.isSendDisabled()}
              class="action send"
              @click=${this.sendClickHandler}
              >${this.canBeStarted?vF+" and Start Review":vF}
            </gr-button>
          </gr-tooltip-content>
        </div>
      </section>
    `}open(e){ba(this.change,"change"),this.knownLatestState=mF.CHECKING,this.getChangeModel().fetchChangeUpdates(this.change).then((e=>{this.knownLatestState=e.isLatest?mF.LATEST:mF.NOT_LATEST,this.isChangeMerged=e.newStatus===Nu.MERGED})),this.focusOn(e),this.restApiService.hasPendingDiffDrafts()&&(this.savingComments=!0,this.restApiService.awaitPendingDiffDrafts().then((()=>{Jn(this,"comment-refresh",{}),this.savingComments=!1})))}hasDrafts(){return this.patchsetLevelDraftMessage.length>0||this.draftCommentThreads.length>0}focus(){this.focusOn(uF.ANY)}handleIncludeCommentsChanged(e){e.target instanceof dw&&(this.includeComments=e.target.checked)}setLabelValue(e,t){const i=this.getLabelScores().shadowRoot?.querySelector(`gr-label-score-row[name="${e}"]`);i?.setSelectedValue(t)}getLabelValue(e){const t=this.getLabelScores().shadowRoot?.querySelector(`gr-label-score-row[name="${e}"]`);return t?.selectedValue}handleAccountAdded(e){const t=e.detail.account,i=px(t),r="ccs"===e.target.getAttribute("id")?gF.CC:gF.REVIEWER,o=gF.REVIEWER===r,s=o?this.ccsList:this.reviewersList;if(s?.removeAccount(t)){const e=o?"CC":"reviewer",r=o?"reviewer":"CC";ea(this,`${t.name||i} moved from ${e} to ${r}.`)}}handleAccountDragStart(e){const t=e.detail.account;t&&(this.draggedAccount=t,this.draggedFrom=e.currentTarget)}handleDragOver(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="move");const t=e.currentTarget;this.draggedFrom&&this.draggedFrom!==t&&t.classList.add("drag-over")}handleDragLeave(e){e.preventDefault(),e.stopPropagation(),e.currentTarget.classList.remove("drag-over")}handleDrop(e){e.preventDefault(),e.stopPropagation();const t=e.currentTarget;if(t.classList.remove("drag-over"),!this.draggedAccount||!this.draggedFrom)return;if(this.draggedFrom===t)return this.draggedAccount=null,void(this.draggedFrom=null);const i=this.draggedAccount,r="ccs"===t.id;r?(this.reviewers=this.reviewers.filter((e=>px(e)!==px(i))),this.ccs.find((e=>px(e)===px(i)))||(this.ccs=[...this.ccs,i],this.reviewersMutated=!0)):(this.ccs=this.ccs.filter((e=>px(e)!==px(i))),this.reviewers.find((e=>px(e)===px(i)))||(this.reviewers=[...this.reviewers,i],this.reviewersMutated=!0));const o=r?"reviewers":"CCs",s=r?"CCs":"reviewers";ea(this,`${i.name||px(i)} moved from ${o} to ${s}.`),this.draggedAccount=null,this.draggedFrom=null}getUnresolvedPatchsetLevelClass(e){return e?"resolved":"unresolved"}computeReviewers(){const e=[],t=this.reviewersList?.additions()??[];e.push(...t.map((e=>xx(e,Vu.REVIEWER))));const i=this.ccsList?.additions()??[];e.push(...i.map((e=>xx(e,Vu.CC))));let r=Ea(this.reviewersList?.removals()??[],i,((e,t)=>px(e)===px(t))).map((e=>xx(e,Vu.REMOVED)));return e.push(...r),r=Ea(this.ccsList?.removals()??[],t,((e,t)=>px(e)===px(t))).map((e=>xx(e,Vu.REMOVED))),e.push(...r),e.filter((e=>!(this.change?.owner._account_id===e.reviewer&&e.state===Vu.REMOVED)))}async send(e,t){this.reporting.time(ua.SEND_REPLY);const i=this.getLabelScores().getLabelValues();2===i[rv.CODE_REVIEW]&&this.reporting.reportInteraction(ga.CODE_REVIEW_APPROVAL);const r={drafts:e?_g.PUBLISH_ALL_REVISIONS:_g.KEEP,labels:i};t?r.ready=!0:this.change?.work_in_progress&&[...this.reviewersList?.additions()??[],...this.ccsList?.additions()??[]].length>0&&ea(this,"Reviewers are not notified for WIP changes"),this.disabled=!0;const o=kC(this.account,this.serverConfig);r.ignore_automatic_attention_set_rules=!0,r.add_to_attention_set=[];const s=this.allAccounts(),n=Array.from(this.newAttentionSet).filter((e=>!this.currentAttentionSet.has(e))).map((e=>s.find((t=>px(t)===e)))).filter(cf),a=(await Promise.all(n.map((e=>this.getAccountsModel().fillDetails(e))))).filter(cf);for(const e of a){const t=EC(this.draftCommentThreads,this.account,e,this.serverConfig)??"";r.add_to_attention_set.push({user:px(e),reason:t})}r.remove_from_attention_set=[];for(const e of this.currentAttentionSet)this.newAttentionSet.has(e)||r.remove_from_attention_set.push({user:e,reason:o});if(this.reportAttentionSetChanges(this.attentionExpanded,r.add_to_attention_set,r.remove_from_attention_set),this.patchsetLevelGrComment){this.patchsetLevelGrComment.disableAutoSaving=!0,await this.restApiService.awaitPendingDiffDrafts();const e=await this.patchsetLevelGrComment.convertToCommentInputAndOrDiscard();e&&e.path&&e.message&&(r.comments??={},r.comments[e.path]??=[],r.comments[e.path].push(e))}if(ba(this.change,"change"),r.reviewers=this.computeReviewers(),this.reportStartReview(r),await this.getPluginLoader().jsApiService.handleBeforeReplySent(this.change,r))return this.getNavigation().blockNavigation("sending review"),this.saveReview(r,(e=>this.handle400Error(e))).then((e=>{if(!e?.change_info)return;const t=e.change_info.current_revision_number!==this.change?.current_revision_number,i={...e.change_info,revisions:this.change?.revisions,current_revision:this.change?.current_revision,current_revision_number:this.change?.current_revision_number};this.getChangeModel().updateStateChange(PT.parse(i)),t&&aa(this),this.patchsetLevelDraftMessage="",this.includeComments=!0,Qn(this,"send",{}),sa(this,"Reply sent"),this.getPluginLoader().jsApiService.handleReplySent()})).finally((()=>{this.getNavigation().releaseNavigation("sending review"),this.disabled=!1,this.patchsetLevelGrComment&&(this.patchsetLevelGrComment.disableAutoSaving=!1),this.reporting.timeEnd(ua.SEND_REPLY)}))}reportStartReview(e){const t=(this.change?.reviewers.REVIEWER??[]).length>0,i=(this.reviewersList?.additions()??[]).length>0,r=this.change?.work_in_progress&&e.ready&&(t||i),o=!this.change?.work_in_progress&&!e.work_in_progress&&!t&&i;(r||o)&&this.reporting.reportInteraction(ga.START_REVIEW)}focusOn(e){e&&e!==uF.ANY||(e=this.chooseFocusTarget()),Ln(this,(()=>{if(e===uF.REVIEWERS){const e=this.reviewersList?.focusStart;e?.focus()}else if(e===uF.CCS){const e=this.ccsList?.focusStart;e?.focus()}else this.patchsetLevelGrComment?.focus()}))}chooseFocusTarget(){return this.isOwner?(e=this.change)&&(e.reviewers.REVIEWER??[]).filter((t=>px(t)!==px(e.owner))).some((e=>!dx(e)))?uF.BODY:uF.REVIEWERS:uF.BODY;var e}handle400Error(e){if(!e)throw new Error("Response is empty.");let t=e;return this.disabled=!1,Df(t.clone()).then((e=>{const i=e.parsed;if(400===t.status&&i.reviewers){const e=[];Object.values(i.reviewers).forEach((t=>e.push(t.error??"no explanation"))),t={...t,ok:!1,text:()=>Promise.resolve(e.join(", "))}}})).finally((()=>{ra(t)}))}computeDraftsTitle(e){return Ig(e?e.length:0,"Draft")}computeMessagePlaceholder(){this.messagePlaceholder=this.canBeStarted?"Add a note for your reviewers...":"Say something nice..."}rebuildReviewerArrays(){if(!this.change?.owner||!this.change?.reviewers)return;const e=e=>Object.values(this.change?.reviewers[e]??[]).filter((e=>e._account_id!==this.change.owner._account_id));this.ccs=e(Vu.CC),this.reviewers=e(Vu.REVIEWER)}toggleAttentionModify(){this.attentionExpanded=!this.attentionExpanded}onAttentionExpandedChange(){Jn(this,"iron-resize",{})}handleAttentionClick(e){const t=e.target?.account;if(!t)return;const i=px(t);if(!i||!this.account||!this.change?.owner)return;const r=i===px(this.account)?"_SELF":"",o=i===px(this.change.owner)?"OWNER":"_REVIEWER";this.newAttentionSet.has(i)?(this.newAttentionSet.delete(i),this.manuallyAddedAttentionSet.delete(i),this.manuallyDeletedAttentionSet.add(i),this.reporting.reportInteraction(ga.ATTENTION_SET_CHIP,{action:`REMOVE${r}${o}`})):(this.newAttentionSet.add(i),this.manuallyAddedAttentionSet.add(i),this.manuallyDeletedAttentionSet.delete(i),this.reporting.reportInteraction(ga.ATTENTION_SET_CHIP,{action:`ADD${r}${o}`})),this.requestUpdate()}computeHasNewAttention(e){return!(!e||!this.newAttentionSet?.has(px(e)))}computeNewAttention(){if(void 0===this.account?._account_id||void 0===this.change||void 0===this.includeComments)return;const e=this.includeComments?this.draftCommentThreads:[],t=!!this.labelsChanged,i=this.uploader?._account_id===this.account._account_id;this.attentionCcsCount=hx(this.ccs).length,this.currentAttentionSet=new Set(Object.keys(this.change.attention_set||{}).map((e=>Number(e))));const r=new Set(this.currentAttentionSet);for(const e of this.mentionedUsersInUnresolvedDrafts)r.add(px(e));if(this.change.status===Nu.NEW){this.computeCommentAccountsForAttention(e,i).forEach((e=>r.add(e))),r.delete(this.account._account_id);const o=e=>!(e._account_id===this.account._account_id&&(this.hasDrafts()||t));this.reviewers.filter((e=>gf(e))).filter((e=>ux(e,Vu.REVIEWER,this.change)||this.canBeStarted&&this.isOwner)).filter(o).forEach((e=>r.add(e._account_id))),(this.hasDrafts()||t)&&(this.uploader?._account_id&&!i&&r.add(this.uploader._account_id),this.change.owner?._account_id&&!this.isOwner&&r.add(this.change.owner._account_id))}else{const t=e.some(Zx);this.change.owner&&t&&r.add(this.change.owner._account_id),r.delete(this.account._account_id)}const o=this.allAccounts().map((e=>px(e))).filter((e=>!!e));this.newAttentionSet=new Set([...this.manuallyAddedAttentionSet,...[...r].filter((e=>o.includes(e)&&!this.manuallyDeletedAttentionSet.has(e)))]),this.attentionExpanded=this.attentionExpanded||o.length<10&&this.computeShowAttentionTip(1)}computeShowAttentionTip(e){if(!this.currentAttentionSet||!this.newAttentionSet)return!1;const t=[...this.newAttentionSet].filter((e=>!this.currentAttentionSet.has(e)));return this.isOwner&&t.length>=e}computeCommentAccountsForAttention(e,t){const i=this.change?.labels?.[rv.CODE_REVIEW],r=function(e){if(!e||!Xu(e)||!e.all)return[];const t=nv(e);return e.all.filter((e=>e.value===t.max))}(i).map((e=>e._account_id)),o=new Set;return e.forEach((e=>{const i=Zx(e);let s=!1;if(i){if(!this.isOwner&&!t)return;s=!0}e.comments.forEach((e=>{if(e.author){const t=e.author._account_id,i=!r.includes(t)&&this.uploader?._account_id!==t&&this.change?.owner._account_id!==t;(s||i)&&o.add(t)}}))})),o}computeShowNoAttentionUpdate(){return this.isSendDisabled()||0===this.computeNewAttentionAccounts().length}computeDoNotUpdateMessage(){return this.currentAttentionSet&&this.newAttentionSet?this.isSendDisabled()||function(e,t){return e.size===t.size&&xa(e,t)}(this.currentAttentionSet,this.newAttentionSet)?"No changes to the attention set.":xa(this.currentAttentionSet,this.newAttentionSet)?"No additions to the attention set.":(this.reporting.error("computeDoNotUpdateMessage",new Error("computeDoNotUpdateMessage()should not be called when users were added to the attention set.")),""):""}computeNewAttentionAccounts(){return void 0===this.currentAttentionSet||void 0===this.newAttentionSet?[]:[...this.newAttentionSet].filter((e=>!this.currentAttentionSet.has(e))).map((e=>this.findAccountById(e))).filter((e=>!!e))}findAccountById(e){return this.allAccounts().find((t=>px(t)===e))}allAccounts(){let e=[];return this.change&&this.change.owner&&e.push(this.change.owner),this.uploader&&e.push(this.uploader),this.reviewers&&(e=[...e,...this.reviewers]),this.ccs&&(e=[...e,...this.ccs]),hx(e.filter(gf))}computeUploader(){if(!this.change?.current_revision||!this.change?.revisions?.[this.change.current_revision])return void(this.uploader=void 0);const e=this.change.revisions[this.change.current_revision];e.uploader&&this.change?.owner._account_id!==e.uploader._account_id?this.uploader=e.uploader:this.uploader=void 0}filterReviewerSuggestionGenerator(e){return t=>{let i;if(Cf(t)){if(i=t.account,i._account_id===this.change?.owner?._account_id)return!1}else{if(!Ef(t))return this.reporting.error("Reviewer Suggestion",new Error(`Suggestion is neither account nor group: ${t}`)),!1;i=t.group}const r=px(i),o=e=>px(e)===r;return e?void 0===this.ccs.find(o):void 0===this.reviewers.find(o)}}cancelTapHandler(e){e.preventDefault(),e.stopPropagation(),this.cancel()}async cancel(){if(ba(this.change,"change"),!this.change?.owner)throw new Error("missing required owner property");Qn(this,"cancel",{}),await(this.patchsetLevelGrComment?.save()),this.rebuildReviewerArrays()}saveClickHandler(e){e.preventDefault(),e.stopPropagation(),this.submit(!1)}sendClickHandler(e){e.preventDefault(),e.stopPropagation(),this.submit(this.canBeStarted)}submit(e){if(void 0===e&&(e=this.isOwner&&this.canBeStarted),this.ccsList?.submitEntryText()){if(!this.isSendDisabled())return this.send(this.includeComments,e).catch((e=>{ta(this,`Error submitting review ${e}`)}));ea(this,"Cannot send an empty reply.")}}saveReview(e,t){return ba(this.change,"change"),ba(this.latestPatchNum,"latestPatchNum"),this.restApiService.saveChangeReview(this.change._number,this.latestPatchNum,e,t,!0)}pendingConfirmationUpdated(e){null===e?this.reviewerConfirmationModal?.close():(this.pendingConfirmationDetails=this.ccPendingConfirmation||this.reviewerPendingConfirmation,this.reviewerConfirmationModal?.showModal())}confirmPendingReviewer(){return this.reviewerConfirmationModal?.close(),this.ccPendingConfirmation?(this.ccsList?.confirmGroup(this.ccPendingConfirmation.group),void this.focusOn(uF.CCS)):this.reviewerPendingConfirmation?(this.reviewersList?.confirmGroup(this.reviewerPendingConfirmation.group),void this.focusOn(uF.REVIEWERS)):void this.reporting.error("confirmPendingReviewer",new Error("confirmPendingReviewer called without pending confirm"))}cancelPendingReviewer(){this.reviewerConfirmationModal?.close(),this.ccPendingConfirmation=null,this.reviewerPendingConfirmation=null;const e=this.ccPendingConfirmation?uF.CCS:uF.REVIEWERS;this.focusOn(e)}handleAccountTextEntry(){this.reviewersMutated=!0}alreadyExists(e,t){return e.filter((e=>gf(e))).some((e=>px(e)===px(t)))}isAlreadyReviewerOrCC(e){return this.alreadyExists(this.reviewers,e)||this.alreadyExists(this._ccs,e)}getLabelScores(){return this.labelScores||_a(this,"gr-label-scores")}_handleLabelsChanged(){this.labelsChanged=0!==Object.keys(this.getLabelScores().getLabelValues(!1)).length}handleReviewersChanged(e){this.reviewers=[...e.detail.value],this.reviewersMutated=!0}handleCcsChanged(e){this.ccs=[...e.detail.value],this.reviewersMutated=!0}handleReviewersConfirmationChanged(e){this.reviewerPendingConfirmation=e.detail.value}handleCcsConfirmationChanged(e){this.ccPendingConfirmation=e.detail.value}_reload(){this.getChangeModel().navigateToChangeResetReload(),this.cancel()}computeSendButtonTooltip(e,t){return t?"Save draft comments to enable send":e?"Mark as ready for review and send reply":"Send reply"}computeSavingLabelClass(e){return e?"saving":""}isSendDisabled(){if(void 0===this.canBeStarted||void 0===this.patchsetLevelDraftMessage||void 0===this.reviewersMutated||void 0===this.labelsChanged||void 0===this.includeComments||void 0===this.disabled||void 0===this.commentEditing||void 0===this.change?.labels||void 0===this.account)return;if(this.commentEditing||this.disabled)return!0;if(!0===this.canBeStarted)return!1;const e=Object.values(this.change.labels).some((e=>Xu(e)&&pv(e,this.account))),t=this.labelsChanged||e;return!(this.includeComments&&this.draftCommentThreads.length>0||this.patchsetLevelDraftMessage.length>0||this.patchsetLevelDraftMessage.length||this.reviewersMutated||t)}computeChangeMergedWarning(){return"Change has already been merged"}computePatchSetWarning(){let e=`Patch ${this.latestPatchNum} is not latest.`;return this.labelsChanged&&(e+=" Voting may have no effect."),e}setPluginMessage(e){this.pluginMessage=e}getReviewerSuggestionsProvider(e){if(e)return new lN(this.restApiService,Vu.REVIEWER,this.serverConfig,this.isLoggedIn,e)}getCcSuggestionsProvider(e){if(e)return new lN(this.restApiService,Vu.CC,this.serverConfig,this.isLoggedIn,e)}reportAttentionSetChanges(e,t,i){const r=e?["MODIFIED"]:["NOT_MODIFIED"],o=this.change&&this.change.owner&&this.change.owner._account_id||-1,s=this.account&&this.account._account_id||-1;for(const e of t||[]){const t=e.user,i=t===s?"_SELF":"",n=t===o?"OWNER":"_REVIEWER";r.push("ADD"+i+n)}for(const e of i||[]){const t=e.user,i=t===s?"_SELF":"",n=t===o?"OWNER":"_REVIEWER";r.push("REMOVE"+i+n)}this.reporting.reportInteraction("attention-set-actions",{actions:r})}};fF([Fc({type:Object})],bF.prototype,"change",void 0),fF([Fc({type:Boolean})],bF.prototype,"canBeStarted",void 0),fF([Fc({type:Boolean,reflect:!0})],bF.prototype,"disabled",void 0),fF([Uc()],bF.prototype,"draftCommentThreads",void 0),fF([Fc({type:Object})],bF.prototype,"permittedLabels",void 0),fF([Hc("#patchsetLevelComment")],bF.prototype,"patchsetLevelGrComment",void 0),fF([Hc("#reviewers")],bF.prototype,"reviewersList",void 0),fF([Hc("#ccs")],bF.prototype,"ccsList",void 0),fF([Hc("#cancelButton")],bF.prototype,"cancelButton",void 0),fF([Hc("#sendButton")],bF.prototype,"sendButton",void 0),fF([Hc("#labelScores")],bF.prototype,"labelScores",void 0),fF([Hc("#reviewerConfirmationModal")],bF.prototype,"reviewerConfirmationModal",void 0),fF([Uc()],bF.prototype,"latestPatchNum",void 0),fF([Uc()],bF.prototype,"serverConfig",void 0),fF([Uc()],bF.prototype,"docsBaseUrl",void 0),fF([Uc()],bF.prototype,"patchsetLevelDraftMessage",void 0),fF([Uc()],bF.prototype,"filterReviewerSuggestion",void 0),fF([Uc()],bF.prototype,"filterCCSuggestion",void 0),fF([Uc()],bF.prototype,"knownLatestState",void 0),fF([Uc()],bF.prototype,"isChangeMerged",void 0),fF([Uc()],bF.prototype,"underReview",void 0),fF([Uc()],bF.prototype,"account",void 0),fF([Uc()],bF.prototype,"_ccs",void 0),fF([Uc()],bF.prototype,"mentionedUsers",void 0),fF([Uc()],bF.prototype,"mentionedUsersInUnresolvedDrafts",void 0),fF([Uc()],bF.prototype,"attentionCcsCount",void 0),fF([Uc()],bF.prototype,"ccPendingConfirmation",void 0),fF([Uc()],bF.prototype,"messagePlaceholder",void 0),fF([Uc()],bF.prototype,"uploader",void 0),fF([Uc()],bF.prototype,"pendingConfirmationDetails",void 0),fF([Uc()],bF.prototype,"includeComments",void 0),fF([Uc()],bF.prototype,"reviewers",void 0),fF([Uc()],bF.prototype,"reviewerPendingConfirmation",void 0),fF([Uc()],bF.prototype,"savingComments",void 0),fF([Uc()],bF.prototype,"reviewersMutated",void 0),fF([Uc()],bF.prototype,"labelsChanged",void 0),fF([Uc()],bF.prototype,"saveTooltip",void 0),fF([Uc()],bF.prototype,"pluginMessage",void 0),fF([Uc()],bF.prototype,"commentEditing",void 0),fF([Uc()],bF.prototype,"attentionExpanded",void 0),fF([Uc()],bF.prototype,"currentAttentionSet",void 0),fF([Uc()],bF.prototype,"newAttentionSet",void 0),fF([Uc()],bF.prototype,"manuallyAddedAttentionSet",void 0),fF([Uc()],bF.prototype,"manuallyDeletedAttentionSet",void 0),fF([Uc()],bF.prototype,"patchsetLevelDraftIsResolved",void 0),fF([Uc()],bF.prototype,"patchsetLevelComment",void 0),fF([Uc()],bF.prototype,"isOwner",void 0),fF([Uc()],bF.prototype,"draggedAccount",void 0),fF([Uc()],bF.prototype,"draggedFrom",void 0),bF=fF([Dc("gr-reply-dialog")],bF);const yF={pluginName:"f0",internalRunId:"f0",patchset:1,checkName:"FAKE Error Finder Finder Finder Finder Finder Finder Finder",labelName:"Presubmit",isSingleAttempt:!0,isLatestAttempt:!0,attemptDetails:[],worstCategory:dI.ERROR,results:[{internalResultId:"f0r0",category:dI.ERROR,summary:"I would like to point out this error: 1 is not equal to 2!",links:[{primary:!0,url:"https://www.google.com",icon:hI.EXTERNAL}],tags:[{name:"OBSOLETE"},{name:"E2E"}]},{internalResultId:"f0r1",category:dI.ERROR,summary:"Running the mighty test has failed by crashing.",message:"Btw, 1 is also not equal to 3. Did you know?",actions:[{name:"Ignore",tooltip:"Ignore this result",primary:!0,callback:()=>Promise.resolve({message:'fake "ignore" triggered'})},{name:"Flag",tooltip:"Flag this result as totally absolutely really not useful",primary:!0,disabled:!0,callback:()=>Promise.resolve({message:'flag "flag" triggered'})},{name:"Upload",tooltip:"Upload the result to the super cloud.",primary:!1,callback:()=>Promise.resolve({message:'fake "upload" triggered'})},{name:"useful",callback:()=>Promise.resolve({message:'fake "useful report" triggered'})},{name:"not-useful",callback:()=>Promise.resolve({message:'fake "not useful report" triggered'})}],tags:[{name:"INTERRUPTED",color:cI.BROWN},{name:"WINDOWS"}],links:[{primary:!1,url:"https://google.com",icon:hI.EXTERNAL},{primary:!0,url:"https://google.com",icon:hI.DOWNLOAD},{primary:!0,url:"https://google.com",icon:hI.DOWNLOAD_MOBILE},{primary:!0,url:"https://google.com",icon:hI.IMAGE},{primary:!0,url:"https://google.com",icon:hI.IMAGE},{primary:!1,url:"https://google.com",icon:hI.IMAGE},{primary:!0,url:"https://google.com",icon:hI.REPORT_BUG},{primary:!0,url:"https://google.com",icon:hI.HELP_PAGE},{primary:!0,url:"https://google.com",icon:hI.HISTORY}]}],status:lI.COMPLETED},wF={pluginName:"f1",internalRunId:"f1",checkName:"FAKE Super Check",startedTimestamp:new Date((new Date).getTime()-3e5),finishedTimestamp:new Date((new Date).getTime()+3e5),patchset:1,labelName:"Verified",isSingleAttempt:!0,isLatestAttempt:!0,attemptDetails:[],worstCategory:dI.ERROR,results:[{internalResultId:"f1r0",category:dI.WARNING,summary:"We think that you could improve this.",message:"There is a lot to be said. A lot. I say, a lot.\n                So please keep reading.",tags:[{name:"INTERRUPTED",color:cI.PURPLE},{name:"WINDOWS"}],codePointers:[{path:"/COMMIT_MSG",range:{start_line:7,start_character:5,end_line:9,end_character:20}}],links:[{primary:!0,url:"https://google.com",icon:hI.EXTERNAL},{primary:!0,url:"https://google.com",icon:hI.DOWNLOAD},{primary:!0,url:"https://google.com",icon:hI.DOWNLOAD_MOBILE},{primary:!0,url:"https://google.com",icon:hI.IMAGE},{primary:!1,url:"https://google.com",tooltip:"look at this",icon:hI.IMAGE},{primary:!1,url:"https://google.com",tooltip:"not at this",icon:hI.IMAGE}]},{internalResultId:"f1r1",category:dI.INFO,summary:"Suspicious Author",message:"Do you personally know this person?",codePointers:[{path:"/COMMIT_MSG",range:{start_line:2,start_character:0,end_line:2,end_character:0}}],links:[]},{internalResultId:"f1r2",category:dI.ERROR,summary:"Test Size Checker",message:"The test seems to be of large size, not medium.",codePointers:[{path:"plugins/BUILD",range:{start_line:186,start_character:12,end_line:186,end_character:18}}],actions:[{name:"useful",tooltip:"This check result was helpful",callback:()=>new Promise((e=>{setTimeout((()=>e({message:"Feedback recorded."})),1e3)}))},{name:"not-useful",tooltip:"This check result was not helpful",callback:()=>new Promise((e=>{setTimeout((()=>e({message:"Feedback recorded."})),1e3)}))}],fixes:[{description:"This is the way to do it.",replacements:[{path:"plugins/BUILD",range:{start_line:186,start_character:12,end_line:186,end_character:18},replacement:"large"}]}],links:[]}],status:lI.RUNNING},_F={pluginName:"f2",internalRunId:"f2",patchset:1,checkName:"FAKE Mega Analysis",statusDescription:"This run is nearly completed, but not quite.",statusLink:"https://www.google.com/",checkDescription:"From what the title says you can tell that this check analyses.",checkLink:"https://www.google.com/",scheduledTimestamp:new Date("2021-04-01T03:14:15"),startedTimestamp:new Date("2021-04-01T04:24:25"),finishedTimestamp:new Date("2021-04-01T04:44:44"),isSingleAttempt:!0,isLatestAttempt:!0,attemptDetails:[],actions:[{name:"Re-Run",tooltip:"More powerful run than before",primary:!0,callback:()=>Promise.resolve({message:'fake "re-run" triggered'})},{name:"Monetize",primary:!0,disabled:!0,callback:()=>Promise.resolve({message:'fake "monetize" triggered'})},{name:"Delete",primary:!0,callback:()=>Promise.resolve({message:'fake "delete" triggered'})}],worstCategory:dI.INFO,results:[{internalResultId:"f2r0",category:dI.INFO,summary:"This is looking a bit too large.",message:"We are still looking into how large exactly. Stay tuned.\nAnd have a look at https://www.google.com!\n\nOr have a look at change 30000.\nExample code:\n  const constable = '';\n  var variable = '';",tags:[{name:"FLAKY"},{name:"MAC-OS"}]}],status:lI.COMPLETED},xF={pluginName:"f3",internalRunId:"f3",checkName:"FAKE Critical Observations",status:lI.RUNNABLE,isSingleAttempt:!0,isLatestAttempt:!0,attemptDetails:[]},CF={pluginName:"f4",internalRunId:"f4",checkName:"FAKE Elimination Long Long Long Long Long",status:lI.RUNNABLE,attempt:1,isSingleAttempt:!1,isLatestAttempt:!1,attemptDetails:[]},EF={pluginName:"f4",internalRunId:"f4",checkName:"FAKE Elimination Long Long Long Long Long",status:lI.COMPLETED,attempt:2,isSingleAttempt:!1,isLatestAttempt:!1,attemptDetails:[],worstCategory:dI.INFO,results:[{internalResultId:"f42r0",category:dI.INFO,summary:"Please eliminate all the TODOs!"}]},SF={pluginName:"f4",internalRunId:"f4",checkName:"FAKE Elimination Long Long Long Long Long",status:lI.COMPLETED,attempt:3,isSingleAttempt:!1,isLatestAttempt:!1,attemptDetails:[],worstCategory:dI.ERROR,results:[{internalResultId:"f43r0",category:dI.ERROR,summary:"Without eliminating all the TODOs your change will break!"}]},$F={pluginName:"f4",internalRunId:"f4",patchset:1,checkName:"FAKE Elimination Long Long Long Long Long",checkDescription:"Shows you the possible eliminations.",checkLink:"https://www.google.com",status:lI.COMPLETED,statusDescription:"Everything was eliminated already.",statusLink:"https://www.google.com",attempt:40,scheduledTimestamp:new Date("2021-04-02T03:14:15"),startedTimestamp:new Date("2021-04-02T04:24:25"),finishedTimestamp:new Date("2021-04-02T04:25:44"),isSingleAttempt:!1,isLatestAttempt:!0,attemptDetails:[],worstCategory:dI.INFO,results:[{internalResultId:"f44r0",category:dI.INFO,summary:"Dont be afraid. All TODOs will be eliminated.",fixes:[{description:"This is the way to do it.",replacements:[{path:"BUILD",range:{start_line:1,start_character:0,end_line:1,end_character:0},replacement:"# This is now fixed.\n"}]}],actions:[{name:"Re-Run",tooltip:"More powerful run than before with a long tooltip, really.",primary:!0,callback:()=>Promise.resolve({message:'fake "re-run" triggered'})}]}],actions:[{name:"Re-Run",tooltip:"small",primary:!0,callback:()=>Promise.resolve({message:'fake "re-run" triggered'})}]},kF=[CF,EF,SF,...function(){const e=[];for(let i=5;i<40;i++)e.push((t=i,{pluginName:"f4",internalRunId:"f4",checkName:"FAKE Elimination Long Long Long Long Long",status:lI.COMPLETED,attempt:t,isSingleAttempt:!1,isLatestAttempt:!1,attemptDetails:[],worstCategory:dI.ERROR,results:t%2==0?[{internalResultId:"f43r0",category:dI.ERROR,summary:"Without eliminating all the TODOs your change will break!"}]:[]}));var t;return e}(),$F],AF=[{name:"Fake Action 1",primary:!0,disabled:!0,tooltip:"Tooltip for Fake Action 1",callback:()=>Promise.resolve({message:"fake action 1 triggered"})},{name:"Fake Action 2",primary:!1,disabled:!0,tooltip:"Tooltip for Fake Action 2",callback:()=>Promise.resolve({message:"fake action 2 triggered"})},{name:"Fake Action 3",summary:!0,primary:!1,tooltip:"Tooltip for Fake Action 3",callback:()=>Promise.resolve({message:"fake action 3 triggered"})}],RF=[{url:"https://www.google.com",primary:!0,tooltip:"Fake Bug Report 1",icon:hI.REPORT_BUG},{url:"https://www.google.com",primary:!0,tooltip:"Fake Bug Report 2",icon:hI.REPORT_BUG},{url:"https://www.google.com",primary:!0,tooltip:"Fake Link 1",icon:hI.EXTERNAL},{url:"https://www.google.com",primary:!1,tooltip:"Fake Link 2",icon:hI.EXTERNAL},{url:"https://www.google.com",primary:!0,tooltip:"Fake Code Link",icon:hI.CODE},{url:"https://www.google.com",primary:!0,tooltip:"Fake Image Link",icon:hI.IMAGE},{url:"https://www.google.com",primary:!0,tooltip:"Fake Help Link",icon:hI.HELP_PAGE}],TF={pluginName:"f5",internalRunId:"f5",checkName:"FAKE Of Tomorrow",status:lI.SCHEDULED,isSingleAttempt:!0,isLatestAttempt:!0,attemptDetails:[]};var IF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let PF=class extends Ic{static get styles(){return[vy,Nc,Jy,Sd`
        :host {
          display: block;
          --thick-border: 6px;
        }
        :host([condensed]) .eta,
        :host([condensed]) .middle,
        :host([condensed]) .right {
          display: none;
        }
        :host([condensed]) * {
          pointer-events: none;
        }
        .chip {
          display: flex;
          justify-content: space-between;
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          padding: var(--spacing-s) var(--spacing-m);
          margin-top: var(--spacing-s);
          cursor: pointer;
        }
        .left {
          overflow: hidden;
          white-space: nowrap;
          text-overflow: ellipsis;
          flex-shrink: 1;
        }
        .middle {
          /* extra space must go between middle and right */
          flex-grow: 1;
          white-space: nowrap;
        }
        .middle gr-checks-attempt {
          margin-left: var(--spacing-s);
        }
        .name {
          font-weight: var(--font-weight-medium);
        }
        .eta {
          color: var(--deemphasized-text-color);
          padding-left: var(--spacing-s);
        }
        .chip.error {
          border-left: var(--thick-border) solid var(--error-foreground);
        }
        .chip.warning {
          border-left: var(--thick-border) solid var(--warning-foreground);
        }
        .chip.info {
          border-left: var(--thick-border) solid var(--info-foreground);
        }
        .chip.check_circle {
          border-left: var(--thick-border) solid var(--success-foreground);
        }
        .chip.timelapse,
        .chip.pending_actions {
          border-left: var(--thick-border) solid var(--border-color);
        }
        .chip.placeholder {
          border-left: var(--thick-border) solid var(--border-color);
        }
        .chip.placeholder gr-icon {
          display: none;
        }
        gr-icon.error {
          color: var(--error-foreground);
        }
        gr-icon.warning {
          color: var(--warning-foreground);
        }
        gr-icon.info {
          color: var(--info-foreground);
        }
        gr-icon.check_circle {
          color: var(--success-foreground);
        }
        :host(:not([condensed])) div.chip:hover {
          background-color: var(--hover-background-color);
        }
        div.chip:focus-within {
          background-color: var(--selection-background-color);
        }
        /* Additional 'div' for increased specificity. */
        div.chip.selected {
          border: 1px solid var(--selected-background);
          background-color: var(--selected-background);
          padding-left: calc(var(--spacing-m) + var(--thick-border) - 1px);
        }
        div.chip.selected .name,
        div.chip.selected gr-icon.filter {
          color: var(--selected-foreground);
        }
        gr-checks-action {
          /* The button should fit into the 20px line-height. The negative
             margin provides the extra space needed for the vertical padding.
             Alternatively we could have set the vertical padding to 0, but
             that would not have been a nice click target. */
          margin: calc(0px - var(--spacing-s));
          margin-left: var(--spacing-s);
        }
        .attemptDetails {
          padding-bottom: var(--spacing-s);
        }
        .attemptDetail {
          /* This is thick-border (6) + spacing-m (8) + icon (20) + padding. */
          padding-left: 39px;
          padding-top: var(--spacing-l);
        }
        .attemptDetail input {
          width: 14px;
          height: 14px;
          /* The next 3 are for placing in the middle of 20px line-height. */
          vertical-align: top;
          position: relative;
          top: 3px;
          margin-right: var(--spacing-s);
        }
        .statusLinkIcon {
          color: var(--link-color);
          margin-left: var(--spacing-s);
        }
      `]}constructor(){super(),this.selected=!1,this.selectedAttempt=OI,this.deselected=!1,this.condensed=!1,this.shouldRender=!1,this.runs=[],this.reporting=Xn().reportingService,this.getChecksModel=yu(this,sP),zf(this,(()=>this.getChecksModel().checksSelectedAttemptNumber$),(e=>this.selectedAttempt=e)),zf(this,(()=>this.getChecksModel().allRunsSelectedPatchset$),(e=>{this.runs=e}))}firstUpdated(){ba(this.chipElement,"chip element"),Ln(this.chipElement,(()=>this.shouldRender=!0),200)}render(){if(!this.shouldRender)return dc`<div class="chip">Loading ...</div>`;const e=EI(this.run),t={chip:!0,[e.name]:!0,selected:this.selected,deselected:this.deselected},i=xI(this.run);return dc`
      <div
        @click=${this.handleChipClick}
        @keydown=${this.handleChipKey}
        class=${th(t)}
        tabindex="0"
      >
        <div class="left" tabindex="0">
          <gr-hovercard-run .run=${this.run}></gr-hovercard-run>
          ${this.renderFilterIcon()}
          <gr-icon
            class=${e.name}
            icon=${e.name}
            ?filled=${!!e.filled}
          ></gr-icon>
          ${this.renderAdditionalIcon()}
          <span class="name">${this.run.checkName}</span>
          ${this.renderETA()}
        </div>
        <div class="middle">
          <gr-checks-attempt .run=${this.run}></gr-checks-attempt>
          ${this.renderStatusLink()}
        </div>
        <div class="right">
          ${i?dc`<gr-checks-action
                .runOrResult=${this.run}
                context="runs"
                .action=${i}
              ></gr-checks-action>`:""}
        </div>
      </div>
      <div
        class="attemptDetails"
        ?hidden=${this.run.isSingleAttempt||!this.selected}
      >
        ${this.renderAttempt({attempt:OI})}
        ${this.renderAttempt({attempt:NI})}
        ${this.run.attemptDetails.map((e=>this.renderAttempt(e)))}
      </div>
    `}renderAttempt(e){const t=e.attempt??0,i=Pg(this.run.checkName).toLowerCase(),r=`attempt-${e.attempt}`,o=e.icon??{name:""},s=o?.name===wI(lI.RUNNABLE)?.name&&t!==OI&&t!==NI,n=this.selectedAttempt===t;return dc`<div class="attemptDetail">
      ${eb("number"==typeof t,(()=>dc` <gr-hovercard-run
          .run=${this.runs.find((e=>e.attempt===t&&e.checkName===this.run?.checkName&&e.pluginName===this.run?.pluginName))}
          .attempt=${t}
        ></gr-hovercard-run>`))}
      <md-radio
        id=${r}
        name=${`${i}-attempt-choice`}
        ?checked=${n}
        ?disabled=${!n&&s}
        @change=${()=>this.handleAttemptChange(t)}
      >
      </md-radio>
      <gr-icon
        icon=${o.name}
        class=${o.name}
        ?filled=${!!o.filled}
      ></gr-icon>
      <label for=${r}>
        ${MI(t)}${s?" (not run)":""}
      </label>
    </div>`}handleAttemptChange(e){this.getChecksModel().updateStateSetAttempt(e)}renderETA(){if(this.run.status!==lI.RUNNING)return;if(!this.run.finishedTimestamp)return;const e=new Date;if(this.run.finishedTimestamp.getTime()<e.getTime())return;const t=Ym(new Date,this.run.finishedTimestamp);return dc`<span class="eta">ETA: ${t}</span>`}renderStatusLink(){const e=this.run.statusLink;if(e)return dc`
      <gr-tooltip-content
        has-tooltip
        ?position-below=${!0}
        title="Link to run status details"
      >
        <a
          href=${e}
          target="_blank"
          rel="noopener noreferrer"
          @click=${this.onLinkClick}
          ><gr-icon
            icon="open_in_new"
            class="statusLinkIcon"
            aria-label="external link to run status details"
          ></gr-icon>
        </a>
      </gr-tooltip-content>
    `}onLinkClick(e){e.stopPropagation(),this.reporting.reportInteraction(ga.CHECKS_RUN_LINK_CLICKED,{checkName:this.run.checkName,status:this.run.status})}renderFilterIcon(){if(this.selected)return dc`<gr-icon icon="filter_alt" filled class="filter"></gr-icon>`}renderAdditionalIcon(){if(this.run.status!==lI.RUNNING)return uc;const e=this.run.worstCategory;if(!e)return uc;const t=wI(e);return dc`
      <gr-icon
        icon=${t.name}
        class=${t.name}
        ?filled=${!!t.filled}
      ></gr-icon>
    `}handleChipClick(e){e.stopPropagation(),e.preventDefault(),DP(this,this.run.checkName)}handleChipKey(e){Gn(e)||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),DP(this,this.run.checkName))}};IF([Hc(".chip")],PF.prototype,"chipElement",void 0),IF([Fc({attribute:!1})],PF.prototype,"run",void 0),IF([Fc({attribute:!1})],PF.prototype,"selected",void 0),IF([Uc()],PF.prototype,"selectedAttempt",void 0),IF([Fc({attribute:!1})],PF.prototype,"deselected",void 0),IF([Fc({type:Boolean})],PF.prototype,"condensed",void 0),IF([Uc()],PF.prototype,"shouldRender",void 0),IF([Uc()],PF.prototype,"runs",void 0),PF=IF([Dc("gr-checks-run")],PF);let NF=class extends Ic{constructor(){super(),this.filterRegExp="",this.runs=[],this.collapsed=!1,this.selectedRuns=new Set,this.selectedAttempt=OI,this.errorMessages={},this.isSectionExpanded=new Map,this.flagService=Xn().flagsService,this.getChecksModel=yu(this,sP),this.getViewModel=yu(this,XC),this.reporting=Xn().reportingService,zf(this,(()=>this.getChecksModel().allRunsSelectedPatchset$),(e=>this.runs=e)),zf(this,(()=>this.getChecksModel().errorMessagesLatest$),(e=>this.errorMessages=e)),zf(this,(()=>this.getChecksModel().loginCallbackLatest$),(e=>this.loginCallback=e)),zf(this,(()=>this.getChecksModel().checksSelectedAttemptNumber$),(e=>this.selectedAttempt=e)),zf(this,(()=>this.getChecksModel().runFilterRegexp$),(e=>this.filterRegExp=e)),zf(this,(()=>this.getViewModel().checksRunsSelected$),(e=>this.selectedRuns=e)),this.addEventListener("click",(()=>{this.collapsed&&this.toggleCollapsed()}))}static get styles(){return[Nc,Qb,vy,Sd`
        :host {
          display: block;
        }
        :host(:not([collapsed])) {
          width: 20%;
          padding: var(--spacing-l) var(--spacing-xl) var(--spacing-xl)
            var(--spacing-xl);
        }
        :host([collapsed]) {
          width: 90px;
          padding: var(--spacing-l) var(--spacing-l) var(--spacing-xl)
            var(--spacing-l);
          max-height: 600px;
          overflow: hidden;
        }
        :host([collapsed]) * {
          pointer-events: none;
        }
        :host([collapsed]:hover) {
          cursor: pointer;
        }
        .title {
          display: flex;
        }
        .title .flex-space {
          flex-grow: 1;
        }
        .title gr-button {
          --gr-button-padding: var(--spacing-s) var(--spacing-m);
          white-space: nowrap;
        }
        .title gr-button.expandButton {
          --gr-button-padding: var(--spacing-xs) var(--spacing-s);
        }
        :host .expandButton {
          margin-right: calc(0px - var(--spacing-m));
        }
        :host([collapsed]:hover) .expandButton {
          background: var(--gray-background-hover);
          border-radius: var(--border-radius);
        }
        .sectionHeader {
          padding-top: var(--spacing-l);
          text-transform: capitalize;
          cursor: default;
        }
        :host([collapsed]) .sectionHeader {
          cursor: pointer;
        }
        .sectionHeader h3 {
          display: inline-block;
        }
        :host(:not([collapsed])) .collapsed .sectionRuns {
          display: none;
        }
        :host(:not([collapsed])) .collapsed {
          border-bottom: 1px solid var(--border-color);
          padding-bottom: var(--spacing-m);
        }
        input#filterInput {
          margin-top: var(--spacing-m);
          padding: var(--spacing-s) var(--spacing-m);
          width: 100%;
        }
        .testing {
          margin-top: var(--spacing-xxl);
          color: var(--deemphasized-text-color);
        }
        .testing gr-button {
          min-width: 25px;
        }
        .testing * {
          visibility: hidden;
        }
        .testing:hover * {
          visibility: visible;
        }
        .zero {
          padding: var(--spacing-m) 0;
          color: var(--primary-text-color);
          margin-top: var(--spacing-m);
        }
        .login,
        .error {
          padding: var(--spacing-m);
          color: var(--primary-text-color);
          margin-top: var(--spacing-m);
          max-width: 400px;
        }
        .error {
          display: flex;
          background-color: var(--error-background);
        }
        .error gr-icon {
          color: var(--error-foreground);
          margin-right: var(--spacing-m);
        }
        .login {
          background: var(--info-background);
        }
        .login gr-icon {
          color: var(--info-foreground);
        }
        .login .buttonRow {
          text-align: right;
          margin-top: var(--spacing-xl);
        }
        .login gr-button {
          margin: 0 var(--spacing-s);
        }
      `]}updated(e){if(super.updated(e),e.has("tabState")&&this.tabState){const{statusOrCategory:e}=this.tabState;e!==lI.RUNNING&&e!==lI.RUNNABLE||this.updateComplete.then((()=>{const t=e.toString().toLowerCase(),i=this.shadowRoot?.querySelector(`.${t} .sectionHeader`);i?.scrollIntoView({block:"center"})}))}}render(){return dc`
      <h2 class="title">
        <div class="heading-2">Runs</div>
        <div class="flex-space"></div>
        ${this.renderTitleButtons()} ${this.renderCollapseButton()}
      </h2>
      ${this.renderErrors()} ${this.renderSignIn()} ${this.renderZeroState()}
      <input
        id="filterInput"
        type="text"
        placeholder="Filter runs by regular expression"
        ?hidden=${!this.showFilter()}
        .value=${this.filterRegExp}
        @input=${this.onInput}
      />
      ${this.renderSection(lI.RUNNING)}
      ${this.renderSection(lI.COMPLETED)}
      ${this.renderSection(lI.RUNNABLE)} ${this.renderFakeControls()}
    `}renderZeroState(){if(!(this.collapsed||this.runs.length>0))return dc`<div class="zero">No Check Run to show</div>`}renderErrors(){return Object.entries(this.errorMessages).map((([e,t])=>{const i=this.collapsed?"Error":dc`Error while fetching results for ${e}:<br />${t}`;return dc`
        <div class="error">
          <div class="left">
            <gr-icon icon="error" filled></gr-icon>
          </div>
          <div class="right">
            <div class="message">${i}</div>
          </div>
        </div>
      `}))}renderSignIn(){if(!this.loginCallback)return;const e=this.collapsed?"Sign in":"Sign in to Checks Plugin to see runs and results";return dc`
      <div class="login">
        <div>
          <gr-icon icon="info"></gr-icon>
          ${e}
        </div>
        <div class="buttonRow">
          <gr-button @click=${this.loginCallback} link>Sign In</gr-button>
        </div>
      </div>
    `}renderTitleButtons(){if(this.collapsed)return;if(this.selectedRuns.size<2)return;const e=[...this.selectedRuns].map((e=>xI(this.runs.find((t=>t.isLatestAttempt&&t.checkName===e))))),t=!e.every((e=>e?.name===pI.RUN||e?.name===pI.RERUN));return dc`
      <gr-button
        class="font-normal"
        link
        @click=${()=>this.getViewModel().updateState({checksRunsSelected:void 0})}
        >Unselect All</gr-button
      >
      <gr-tooltip-content
        title=${t?'Disabled. Unselect checks without a "Run" action to enable the button.':""}
        ?has-tooltip=${t}
      >
        <gr-button
          class="font-normal"
          link
          ?disabled=${t}
          @click=${()=>{e.forEach((e=>{e&&this.getChecksModel().triggerAction(e,void 0,"run-selected")})),this.reporting.reportInteraction(ga.CHECKS_RUNS_SELECTED_TRIGGERED)}}
          >Run Selected</gr-button
        >
      </gr-tooltip-content>
    `}renderCollapseButton(){return dc`
      <gr-tooltip-content
        has-tooltip
        title=${this.collapsed?"Expand runs panel":"Collapse runs panel"}
      >
        <gr-button
          link
          class="expandButton font-normal"
          role="switch"
          aria-checked=${this.collapsed?"true":"false"}
          aria-label=${this.collapsed?"Expand runs panel":"Collapse runs panel"}
          @click=${this.toggleCollapsed}
        >
          <div>
            <gr-icon
              icon=${this.collapsed?"chevron_right":"chevron_left"}
              class="expandIcon"
            >
            </gr-icon>
          </div>
        </gr-button>
      </gr-tooltip-content>
    `}toggleCollapsed(e){e&&e.stopPropagation(),this.collapsed=!this.collapsed,this.reporting.reportInteraction(ga.CHECKS_RUNS_PANEL_TOGGLE,{collapsed:this.collapsed})}onInput(){ba(this.filterInput,"filter <input> element"),this.reporting.reportInteraction(ga.CHECKS_RUN_FILTER_CHANGED,{},{deduping:ca.EVENT_ONCE_PER_CHANGE});const e=this.filterInput.value;this.getChecksModel().updateStateSetRunFilter(e??"")}toggle(e,t,i=[],r=[],o=void 0){const s=this.getChecksModel();s.updateStateSetProvider(e,rP.LATEST);const n=this.runs.includes(t[0])?[]:t;s.updateStateSetResults(e,n,i,r,o,rP.LATEST)}renderSection(e){const t=new RegExp(this.filterRegExp,"i"),i=this.runs.filter((e=>e.isLatestAttempt)).filter((t=>t.status===e||e===lI.RUNNING&&t.status===lI.SCHEDULED)).filter((e=>t.test(e.checkName))).sort(TI);if(0===i.length)return;const r=this.isSectionExpanded.get(e)??!0,o=r?"expanded":"collapsed",s=r?"expand_less":"expand_more";let n=_I(e);i.some((e=>e.status===lI.SCHEDULED))&&(n=`${n} / ${_I(lI.SCHEDULED)}`);const a=eb(!this.collapsed,(()=>dc` (${i.length})`)),l=eb(!this.collapsed,(()=>dc`<gr-icon icon=${s} class="expandIcon"></gr-icon>`));return dc`
      <div class="${e.toLowerCase()} ${o}">
        <div class="sectionHeader" @click=${()=>this.toggleExpanded(e)}>
          ${l}
          <h3 class="heading-3">${n}${a}</h3>
        </div>
        <div class="sectionRuns">${i.map((e=>this.renderRun(e)))}</div>
      </div>
    `}toggleExpanded(e){if(this.collapsed)return;const t=this.isSectionExpanded.get(e)??!0;this.isSectionExpanded.set(e,!t),this.reporting.reportInteraction(ga.CHECKS_RUN_SECTION_TOGGLE,{status:e,expanded:!t}),this.requestUpdate()}renderRun(e){const t=this.selectedRuns.has(e.checkName),i=!t&&this.selectedRuns.size>0;return dc`<gr-checks-run
      .run=${e}
      ?condensed=${this.collapsed}
      .selected=${t}
      .deselected=${i}
      @run-selected=${this.handleRunSelected}
    ></gr-checks-run>`}handleRunSelected(e){e.detail.checkName&&this.getViewModel().toggleSelectedCheckRun(e.detail.checkName)}showFilter(){return!this.collapsed&&(this.runs.length>10||!!this.filterRegExp)}renderFakeControls(){if(this.flagService.isEnabled(da.CHECKS_DEVELOPER)&&!this.collapsed)return dc`
      <div class="testing">
        <div>Toggle fake runs by clicking buttons:</div>
        <gr-button link @click=${()=>{return(e=this.getChecksModel()).updateStateSetProvider("f0",rP.LATEST),e.updateStateSetProvider("f1",rP.LATEST),e.updateStateSetProvider("f2",rP.LATEST),e.updateStateSetProvider("f3",rP.LATEST),e.updateStateSetProvider("f4",rP.LATEST),e.updateStateSetProvider("f5",rP.LATEST),e.updateStateSetResults("f0",[],[],[],void 0,rP.LATEST),e.updateStateSetResults("f1",[],[],[],void 0,rP.LATEST),e.updateStateSetResults("f2",[],[],[],void 0,rP.LATEST),e.updateStateSetResults("f3",[],[],[],void 0,rP.LATEST),e.updateStateSetResults("f4",[],[],[],void 0,rP.LATEST),void e.updateStateSetResults("f5",[],[],[],void 0,rP.LATEST);var e}}
          >None</gr-button
        >
        <gr-button
          link
          @click=${()=>this.toggle("f0",[yF],AF,RF,"ETA: 1 min")}
          >0</gr-button
        >
        <gr-button link @click=${()=>this.toggle("f1",[wF])}
          >1</gr-button
        >
        <gr-button link @click=${()=>this.toggle("f2",[_F])}
          >2</gr-button
        >
        <gr-button link @click=${()=>this.toggle("f3",[xF])}
          >3</gr-button
        >
        <gr-button link @click=${()=>this.toggle("f4",kF)}
          >4</gr-button
        >
        <gr-button link @click=${()=>this.toggle("f5",[TF])}
          >5</gr-button
        >
        <gr-button link @click=${()=>{return(e=this.getChecksModel()).updateStateSetProvider("f0",rP.LATEST),e.updateStateSetProvider("f1",rP.LATEST),e.updateStateSetProvider("f2",rP.LATEST),e.updateStateSetProvider("f3",rP.LATEST),e.updateStateSetProvider("f4",rP.LATEST),e.updateStateSetProvider("f5",rP.LATEST),e.updateStateSetResults("f0",[yF],AF,RF,"ETA: 1 min",rP.LATEST),e.updateStateSetResults("f1",[wF],[],[],void 0,rP.LATEST),e.updateStateSetResults("f2",[_F],[],[],void 0,rP.LATEST),e.updateStateSetResults("f3",[xF],[],[],void 0,rP.LATEST),e.updateStateSetResults("f4",kF,[],[],void 0,rP.LATEST),void e.updateStateSetResults("f5",[TF],[],[],void 0,rP.LATEST);var e}}
          >all</gr-button
        >
      </div>
    `}};IF([Hc("#filterInput")],NF.prototype,"filterInput",void 0),IF([Uc()],NF.prototype,"filterRegExp",void 0),IF([Fc({attribute:!1})],NF.prototype,"runs",void 0),IF([Fc({type:Boolean,reflect:!0})],NF.prototype,"collapsed",void 0),IF([Uc()],NF.prototype,"selectedRuns",void 0),IF([Uc()],NF.prototype,"selectedAttempt",void 0),IF([Fc({attribute:!1})],NF.prototype,"tabState",void 0),IF([Uc()],NF.prototype,"errorMessages",void 0),IF([Uc()],NF.prototype,"loginCallback",void 0),NF=IF([Dc("gr-checks-runs")],NF);var OF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let DF=class extends Ic{constructor(){super(),this.runs=[],this.results=[],this.checksPatchsetNumber=void 0,this.latestPatchsetNumber=void 0,this.changeNum=void 0,this.getChangeModel=yu(this,MT),this.getChecksModel=yu(this,sP),this.reporting=Xn().reportingService,this.offsetWidthBefore=0,zf(this,(()=>this.getChecksModel().allRunsSelectedPatchset$),(e=>this.runs=e)),zf(this,(()=>this.getChecksModel().allResultsSelected$),(e=>this.results=e)),zf(this,(()=>this.getChecksModel().checksSelectedPatchsetNumber$),(e=>this.checksPatchsetNumber=e)),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchsetNumber=e)),zf(this,(()=>this.getChangeModel().changeNum$),(e=>this.changeNum=e)),new ResizeObserver((()=>{this.checksRuns&&(Math.abs(this.offsetWidth-this.offsetWidthBefore)<40||(this.offsetWidthBefore=this.offsetWidth,this.checksRuns.collapsed=this.offsetWidth<1200))})).observe(this)}static get styles(){return Sd`
      :host {
        display: block;
      }
      .container {
        display: flex;
      }
      .runs {
        min-height: 400px;
        border-right: 1px solid var(--border-color);
        flex: 0 0 auto;
      }
      .results {
        flex: 1 1 auto;
      }
    `}render(){return this.reporting.reportInteraction(ga.CHECKS_TAB_RENDERED,{checkName:this.tabState?.checksTab?.checkName,statusOrCategory:this.tabState?.checksTab?.statusOrCategory},{deduping:ca.DETAILS_ONCE_PER_CHANGE}),dc`
      <div class="container">
        <gr-checks-runs
          class="runs"
          ?collapsed=${this.offsetWidth<1e3}
          .runs=${this.runs}
          .tabState=${this.tabState?.checksTab}
        ></gr-checks-runs>
        <gr-checks-results
          class="results"
          .tabState=${this.tabState?.checksTab}
          .runs=${this.runs}
        ></gr-checks-results>
      </div>
    `}};OF([Hc(".runs")],DF.prototype,"checksRuns",void 0),OF([Uc()],DF.prototype,"runs",void 0),OF([Uc()],DF.prototype,"results",void 0),OF([Fc({type:Object})],DF.prototype,"tabState",void 0),OF([Uc()],DF.prototype,"checksPatchsetNumber",void 0),OF([Uc()],DF.prototype,"latestPatchsetNumber",void 0),OF([Uc()],DF.prototype,"changeNum",void 0),DF=OF([Dc("gr-checks-tab")],DF);var LF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const MF=["added:","after:","age:","age:1week","attention:","author:","before:","branch:","bug:","cc:","cc:self","change:","cherrypickof:","comment:","commentby:","commit:","committer:","deleted:","delta:","dir:","directory:","ext:","extension:","file:","footer:","from:","has:","has:attention","has:draft","has:edit","has:star","has:unresolved","hasfooter:","hashtag:","inhashtag:","intopic:","is:","is:abandoned","is:attention","is:cherrypick","is:closed","is:merge","is:merged","is:open","is:owner","is:private","is:pure-revert","is:reviewed","is:reviewer","is:starred","is:submittable","is:watched","is:wip","label:","mergedafter:","mergedbefore:","message:","onlyexts:","onlyextensions:","owner:","ownerin:","parentof:","parentproject:","project:","projects:","query:","repo:","ref:","reviewedby:","reviewer:","reviewer:self","reviewerin:","rule:","size:","star:","status:","status:abandoned","status:closed","status:merged","status:open","status:reviewed","submissionid:","topic:","tr:"],FF=new Set(MF.concat(MF.map((e=>`-${e}`)))),UF=/(?:(?:[^\s":]+:\s*[^\s"]+)|[^\s"]+|"[^"]*")+\s*/g;let BF=class extends Ic{constructor(){super(),this.placeholder="Search for changes",this.value="",this.projectSuggestions=()=>Promise.resolve([]),this.groupSuggestions=()=>Promise.resolve([]),this.accountSuggestions=()=>Promise.resolve([]),this.inputVal="",this.docsBaseUrl="",this.getConfigModel=yu(this,Qw),this.query=e=>this.getSearchSuggestions(e),zf(this,(()=>this.getConfigModel().mergeabilityComputationBehavior$),(e=>{this.mergeabilityComputationBehavior=e})),zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e))}static get styles(){return[Nc,Sd`
        form {
          display: flex;
        }
        gr-autocomplete {
          background-color: var(--view-background-color);
          border-radius: var(--gr-search-bar-border-radius, 0);
          --gr-autocomplete-text-field-border-radius: var(
            --gr-search-bar-border-radius,
            0
          );
          flex: 1;
          outline: none;
        }

        md-icon-button {
          --md-icon-button-icon-size: 20px;
        }
      `]}render(){return dc`
      <form>
        <gr-autocomplete
          id="queryInput"
          placeholder=${this.placeholder}
          .text=${this.inputVal}
          .query=${this.query}
          allow-non-suggested-values
          multi
          skip-commit-on-item-select
          tab-complete
          @text-changed=${e=>{this.handleQueryTextChanged(e)}}
        >
          <div slot="leading-icon">
            <slot name="leading-icon"></slot>
          </div>
          ${eb(this.inputVal?.length>0,(()=>dc`
              <md-icon-button
                slot="trailing-icon"
                touch-target="none"
                @click=${e=>{e.preventDefault(),this.queryInput?.clear()}}
              >
                <gr-icon icon="close" title="Clear all text"></gr-icon>
              </md-icon-button>
            `))}
          ${eb(!this.inputVal?.length,(()=>dc`
              <a
                class="help"
                slot="trailing-icon"
                href=${$f(this.docsBaseUrl,"user-search.html")}
                target="_blank"
                rel="noopener noreferrer"
                tabindex="-1"
              >
                <md-icon-button touch-target="none">
                  <gr-icon icon="help" title="read documentation"></gr-icon>
                </md-icon-button>
              </a>
            `))}
        </gr-autocomplete>
      </form>
    `}willUpdate(e){e.has("value")&&this.valueChanged()}valueChanged(){this.inputVal=this.value}getInput(){return this.inputVal}searchOperators(){const e=new Set(FF);return this.mergeabilityComputationBehavior!==Hu.API_REF_UPDATED_AND_CHANGE_REINDEX&&this.mergeabilityComputationBehavior!==Hu.REF_UPDATED_AND_CHANGE_REINDEX||(e.add("is:mergeable"),e.add("-is:mergeable")),e}fetchSuggestions(e){const t=e.split(":"),i=t[0],r=t[1]||"";return/^-?(ownerin|reviewerin)$/.test(i)?this.groupSuggestions(i,r):/^-?(parentproject|project|repo)$/.test(i)?this.projectSuggestions(i,r):/^-?(attention|author|cc|commentby|committer|from|owner|reviewedby|reviewer)$/.test(i)?this.accountSuggestions(i,r):Promise.resolve([...this.searchOperators()].filter((t=>t.includes(e))).map((e=>({text:e}))))}getSearchSuggestions(e){const t=e.match(UF);if(null===t)return Promise.resolve([]);const i=t[t.length-1].toLowerCase();return this.fetchSuggestions(i).then((e=>e&&e.length?e.sort(((e,t)=>{const r=e.text?.toLowerCase().indexOf(i),o=t.text?.toLowerCase().indexOf(i);return void 0===r&&void 0===o?0:void 0===r&&void 0!==o?1:void 0!==r&&void 0===o?-1:r===o?e.text.localeCompare(t.text):-1===r?1:-1===o?-1:r-o})).slice(0,9).map((({text:e,label:t})=>({name:e,value:e,label:t}))):[]))}focusAndSelectAll(){ba(this.queryInput,"queryInput"),this.queryInput.focus(),this.queryInput.selectAll()}handleQueryTextChanged(e){this.inputVal=e.detail.value}};LF([Hc("#queryInput")],BF.prototype,"queryInput",void 0),LF([Fc({type:String})],BF.prototype,"placeholder",void 0),LF([Fc({type:String})],BF.prototype,"value",void 0),LF([Fc({type:Object})],BF.prototype,"projectSuggestions",void 0),LF([Fc({type:Object})],BF.prototype,"groupSuggestions",void 0),LF([Fc({type:Object})],BF.prototype,"accountSuggestions",void 0),LF([Uc()],BF.prototype,"mergeabilityComputationBehavior",void 0),LF([Uc()],BF.prototype,"inputVal",void 0),LF([Uc()],BF.prototype,"docsBaseUrl",void 0),LF([Uc()],BF.prototype,"query",void 0),BF=LF([Dc("gr-search-autocomplete")],BF);const HF="self";function jF(e,t,i,r){return 0===i.length?Promise.resolve([]):e(i).then((e=>e?function(e,t,i){return e.map((e=>{const r=rx(i,e);return{label:e.name||"",text:e.email?`${t}:${e.email}`:`${t}:"${r}"`}}))}(e,t,r):[])).then((e=>HF.startsWith(i)?e.concat([{text:t+":"+HF}]):"me".startsWith(i)?e.concat([{text:t+":me"}]):e))}var GF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let zF=class extends Ic{constructor(){super(),this.stages=[],this.currentCondition="",this.currentAction="",this.currentParameter="",this.currentConditionPrefix="Gerrit",this.loading=!1,this.restApiService=Xn().restApiService,this.getConfigModel=yu(this,Qw),this.getFlowsModel=yu(this,RP),this.projectSuggestions=(e,t)=>this.fetchProjects(e,t),this.groupSuggestions=(e,t)=>this.fetchGroups(e,t),this.accountSuggestions=(e,t)=>jF((e=>this.restApiService.queryAccounts(e,10,void 0,void 0,Ff)),e,t,this.serverConfig),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.serverConfig=e))}static get styles(){return[Nc,my,Sd`
        .add-stage-row {
          display: flex;
          align-items: center;
          gap: var(--spacing-s);
        }
        .add-stage-row > md-outlined-select,
        .add-stage-row > md-outlined-text-field,
        .add-stage-row > gr-search-autocomplete {
          width: 15em;
        }
        table {
          border-collapse: collapse;
        }
        th,
        td {
          border: 1px solid var(--border-color);
          padding: var(--spacing-s);
          text-align: left;
        }
      `]}firstUpdated(){this.hostUrl=window.location.origin+window.location.pathname}renderTable(){return eb(this.stages.length>0,(()=>dc`
        <table>
          <thead>
            <tr>
              <th>Stage</th>
              <th>Condition</th>
              <th>Action</th>
              <th>Parameters</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            ${this.stages.map(((e,t)=>dc`
                <tr>
                  <td>${t+1}</td>
                  <td>${e.condition}</td>
                  <td>${e.action}</td>
                  <td>${e.parameterStr}</td>
                  <td>
                    <gr-button
                      link
                      @click=${()=>this.handleRemoveStage(t)}
                      title="Delete stage"
                    >
                      <gr-icon icon="delete" filled></gr-icon>
                    </gr-button>
                  </td>
                </tr>
              `))}
          </tbody>
        </table>
      `))}render(){return dc`
      <div>${this.renderTable()}</div>
      <div class="add-stage-row">
        <md-outlined-select
          value=${this.currentConditionPrefix}
          @change=${e=>{const t=e.target;this.currentConditionPrefix=t.value}}
        >
          <md-select-option value="Gerrit">
            <div slot="headline">Gerrit</div>
          </md-select-option>
          <md-select-option value="Other">
            <div slot="headline">Other</div>
          </md-select-option>
        </md-outlined-select>
        ${"Gerrit"===this.currentConditionPrefix?dc`<gr-search-autocomplete
              .placeholder=${"Create condition"}
              .value=${this.currentCondition}
              .projectSuggestions=${this.projectSuggestions}
              .groupSuggestions=${this.groupSuggestions}
              .accountSuggestions=${this.accountSuggestions}
              @text-changed=${this.handleGerritConditionTextChanged}
            ></gr-search-autocomplete>`:dc`<md-outlined-text-field
              label="Condition"
              .value=${this.currentCondition}
              @input=${e=>this.currentCondition=e.target.value}
            ></md-outlined-text-field>`}
        <span> -> </span>
        <md-outlined-text-field
          label="Action"
          .value=${this.currentAction}
          @input=${e=>this.currentAction=e.target.value}
        ></md-outlined-text-field>
        <md-outlined-text-field
          label="Parameters"
          .value=${this.currentParameter}
          @input=${e=>this.currentParameter=e.target.value}
        ></md-outlined-text-field>
        <gr-button aria-label="Add Stage" @click=${this.handleAddStage}
          >Add Stage</gr-button
        >
      </div>
      <gr-button
        aria-label="Create Flow"
        ?disabled=${this.loading}
        @click=${this.handleCreateFlow}
      >
        Create Flow
      </gr-button>
    `}handleGerritConditionTextChanged(e){this.currentCondition=e.detail.value??""}fetchProjects(e,t){return this.restApiService.getSuggestedRepos(t,10,Ff).then((t=>t?Object.keys(t).map((t=>({text:e+":"+t}))):[]))}fetchGroups(e,t){return 0===t.length?Promise.resolve([]):this.restApiService.getSuggestedGroups(t,void 0,10,Ff).then((t=>t?Object.keys(t).map((t=>({text:e+":"+t}))):[]))}handleAddStage(){if(""===this.currentCondition.trim()&&""===this.currentAction.trim())return;const e="Gerrit"===this.currentConditionPrefix?`${this.hostUrl} is ${this.currentCondition}`:this.currentCondition;this.stages=[...this.stages,{condition:e,action:this.currentAction,parameterStr:this.currentParameter}],this.currentCondition="",this.currentAction="",this.currentParameter=""}handleRemoveStage(e){this.stages=this.stages.filter(((t,i)=>i!==e))}async handleCreateFlow(){if(!this.changeNum)return;const e=[...this.stages];if(""!==this.currentCondition.trim()||""!==this.currentAction.trim()){const t="Gerrit"===this.currentConditionPrefix?`${this.hostUrl} is ${this.currentCondition}`:this.currentCondition;e.push({condition:t,action:this.currentAction,parameterStr:this.currentParameter})}if(0===e.length)return;this.loading=!0;const t={stage_expressions:e.map((e=>{if(e.action){const t={name:e.action};return e.parameterStr.length>0&&(t.parameters=e.parameterStr.split(" ")),{condition:e.condition,action:t}}return{condition:e.condition}}))};await this.getFlowsModel().createFlow(t),this.stages=[],this.currentCondition="",this.currentAction="",this.currentParameter="",this.loading=!1}};GF([Fc({type:Number})],zF.prototype,"changeNum",void 0),GF([Fc({type:String})],zF.prototype,"hostUrl",void 0),GF([Uc()],zF.prototype,"stages",void 0),GF([Uc()],zF.prototype,"currentCondition",void 0),GF([Uc()],zF.prototype,"currentAction",void 0),GF([Uc()],zF.prototype,"currentParameter",void 0),GF([Uc()],zF.prototype,"currentConditionPrefix",void 0),GF([Uc()],zF.prototype,"loading",void 0),GF([Uc()],zF.prototype,"serverConfig",void 0),zF=GF([Dc("gr-create-flow")],zF);var VF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let WF=class extends Ic{static get styles(){return[Nc,my,Sd`
        .container {
          padding: var(--spacing-l);
        }
        hr {
          margin-top: var(--spacing-l);
          margin-bottom: var(--spacing-l);
          border: 0;
          border-top: 1px solid var(--border-color);
        }
        .flow {
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          margin: var(--spacing-m) 0;
          padding: var(--spacing-m);
        }
        .flow-id {
          font-weight: var(--font-weight-bold);
        }
        .flow-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: var(--spacing-s);
        }
        .heading-with-button {
          display: flex;
          align-items: center;
        }
        .hidden {
          display: none;
        }
        table {
          border-collapse: collapse;
        }
        th,
        td {
          border: 1px solid var(--border-color);
          padding: var(--spacing-s);
          text-align: left;
        }
        .main-heading {
          font-size: var(--font-size-h2);
          font-weight: var(--font-weight-bold);
          margin-bottom: var(--spacing-m);
        }
        gr-icon {
          font-size: var(--line-height-normal, 20px);
          vertical-align: middle;
        }
        gr-icon.done {
          color: var(--success-foreground);
        }
        gr-icon.pending {
          color: var(--deemphasized-text-color);
        }
        gr-icon.failed {
          color: var(--error-foreground);
        }
        .owner-container {
          display: flex;
          align-items: center;
          gap: var(--spacing-s);
        }
        .refresh {
          top: -4px;
        }
      `]}constructor(){super(),this.flows=[],this.loading=!0,this.statusFilter="all",this.getChangeModel=yu(this,MT),this.getFlowsModel=yu(this,RP),zf(this,(()=>this.getChangeModel().changeNum$),(e=>{this.changeNum=e})),zf(this,(()=>this.getFlowsModel().flows$),(e=>{this.flows=e})),zf(this,(()=>this.getFlowsModel().loading$),(e=>{this.loading=e}))}async deleteFlow(){this.flowIdToDelete&&(await this.getFlowsModel().deleteFlow(this.flowIdToDelete),this.closeConfirmDialog())}openConfirmDialog(e){this.deleteFlowModal?.showModal(),this.flowIdToDelete=e}closeConfirmDialog(){this.deleteFlowModal?.close(),this.flowIdToDelete=void 0}render(){return dc`
      <div class="container">
        <h2 class="main-heading">Create new flow</h2>
        <gr-create-flow .changeNum=${this.changeNum}></gr-create-flow>
        <hr />
        ${this.renderFlowsList()}
      </div>
      ${this.renderDeleteFlowModal()}
    `}renderDeleteFlowModal(){return dc` <dialog id="deleteFlowModal">
      <gr-dialog
        confirm-label="Delete"
        @confirm=${()=>this.deleteFlow()}
        @cancel=${()=>this.closeConfirmDialog()}
      >
        <div class="header" slot="header">Delete Flow</div>
        <div class="main" slot="main">
          Are you sure you want to delete this flow?
        </div>
      </gr-dialog>
    </dialog>`}renderStatus(e){const t=(e=>{switch(e){case Ku.DONE:return{icon:"check_circle",filled:!0,class:"done"};case Ku.PENDING:return{icon:"timelapse",filled:!1,class:"pending"};case Ku.FAILED:case Ku.TERMINATED:return{icon:"error",filled:!0,class:"failed"};default:return{icon:"help",filled:!1,class:"other"}}})(e.state);return dc`<gr-icon
      class=${t.class}
      icon=${t.icon}
      ?filled=${t.filled}
      aria-label=${e.state.toLowerCase()}
      role="img"
    ></gr-icon>`}renderFlowsList(){if(this.loading)return dc`<p>Loading...</p>`;if(0===this.flows.length)return dc`<p>No flows found for this change.</p>`;const e=this.flows.filter((e=>"all"===this.statusFilter||e.stages[e.stages.length-1].state===this.statusFilter));return dc`
      <div>
        <div class="heading-with-button">
          <h2 class="main-heading">Existing Flows</h2>
          <gr-button
            link
            @click=${()=>this.getFlowsModel().reload()}
            aria-label="Refresh flows"
            title="Refresh flows"
            class="refresh"
          >
            <gr-icon icon="refresh"></gr-icon>
          </gr-button>
        </div>
        <md-filled-select
          label="Filter by status"
          @request-selection=${e=>{this.statusFilter=e.target.value}}
        >
          <md-select-option value="all">
            <div slot="headline">All</div>
          </md-select-option>
          ${Object.values(Ku).map((e=>dc`
              <md-select-option value=${e}>
                <div slot="headline">${e}</div>
              </md-select-option>
            `))}
        </md-filled-select>
        ${e.map((e=>dc`
            <div class="flow">
              <div class="flow-header">
                <gr-button
                  link
                  @click=${()=>this.openConfirmDialog(e.uuid)}
                  title="Delete flow"
                >
                  <gr-icon icon="delete" filled></gr-icon>
                </gr-button>
              </div>
              <div class="flow-id hidden">Flow ${e.uuid}</div>
              <div>
                Created:
                <gr-date-formatter withTooltip .dateStr=${e.created}>
                </gr-date-formatter>
              </div>
              ${eb(e.last_evaluated,(()=>dc` <div>
                    Last Evaluated:
                    <gr-date-formatter
                      withTooltip
                      .dateStr=${e.last_evaluated}
                    >
                    </gr-date-formatter>
                  </div>`))}
              <table>
                <thead>
                  <tr>
                    <th>Status</th>
                    <th>Condition</th>
                    <th>Action</th>
                    <th>Parameters</th>
                    <th>Message</th>
                  </tr>
                </thead>
                <tbody>
                  ${e.stages.map((e=>{const t=e.expression.action;return dc`
                      <tr>
                        <td>${this.renderStatus(e)}</td>
                        <td>${e.expression.condition}</td>
                        <td>${t?t.name:""}</td>
                        <td>${t?t.parameters:""}</td>
                        <td>${e.message??""}</td>
                      </tr>
                    `}))}
                </tbody>
              </table>
            </div>
          `))}
      </div>
    `}};function qF(e,t){!function(e,t){const i=Xl(t);void 0!==i&&e.assign(i)}(e,t)}VF([Hc("#deleteFlowModal")],WF.prototype,"deleteFlowModal",void 0),VF([Uc()],WF.prototype,"flows",void 0),VF([Uc()],WF.prototype,"changeNum",void 0),VF([Uc()],WF.prototype,"loading",void 0),VF([Uc()],WF.prototype,"flowIdToDelete",void 0),VF([Uc()],WF.prototype,"statusFilter",void 0),WF=VF([Dc("gr-flows")],WF),window&&window.__awaiter,Error;var KF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const YF=/^(R|CC)=/gm,XF=/[ \t]+$/gm,JF="#message-";let QF=class extends Ic{get serverConfig(){return this._serverConfig}set serverConfig(e){if(this._serverConfig===e)return;const t=this._serverConfig;this._serverConfig=e,this.startUpdateCheckTimer(),this.requestUpdate("serverConfig",t)}canStartReview(){return!!this.change?.actions?.ready?.enabled}get change(){return this._change}set change(e){if(this._change===e)return;const t=this._change;this._change=e,this.changeChanged(t),this.requestUpdate("change",t)}isSubmitEnabled(){return!!(this.currentRevisionActions&&this.currentRevisionActions.submit&&this.currentRevisionActions.submit.enabled)}constructor(){super(),this.editingCommitMessage=!1,this.latestCommitMessage="",this.basePatchNum=Qu,this.currentRevisionActions={},this.loggedIn=!1,this.replyDisabled=!0,this.editMode=!1,this.pluginTabsHeaderEndpoints=[],this.pluginTabsContentEndpoints=[],this.activeTab=ng.FILES,this.unresolvedOnly=!0,this.draftCount=0,this.showChecksTab=!1,this.isViewCurrent=!1,this.isFlowsEnabled=!1,this.replyModalOpened=!1,this.loginUrl="",this.loginText="",this.reporting=Xn().reportingService,this.getChecksModel=yu(this,sP),this.flagService=Xn().flagsService,this.restApiService=Xn().restApiService,this.getPluginLoader=yu(this,U_),this.getUserModel=yu(this,jf),this.getChangeModel=yu(this,MT),this.getCommentsModel=yu(this,kP),this.getConfigModel=yu(this,Qw),this.getViewModel=yu(this,XC),this.getRelatedChangesModel=yu(this,sD),this.getShortcutsService=yu(this,Bg),this.connected$=new Up(!1),this.isFirstConnection=!0,this.shortcutsController=new Gg(this),this.getNavigation=yu(this,gy),this.handleScroll=()=>{this.isViewCurrent&&(this.scrollTask=ny(this.scrollTask,(()=>this.scrollPosition=document.documentElement.scrollTop),150))},this.handleVisibilityChange=()=>{document.hidden&&this.updateCheckTimerHandle?this.cancelUpdateCheckTimer():this.updateCheckTimerHandle||this.startUpdateCheckTimer()},this.setupListeners(),this.setupShortcuts(),this.setupSubscriptions()}setupListeners(){this.addEventListener("open-reply-dialog",(()=>this.openReplyDialog())),this.addEventListener("change-message-deleted",(()=>aa(this))),this.addEventListener("editable-content-save",(e=>this.handleCommitMessageSave(e))),this.addEventListener("editable-content-cancel",(()=>this.handleCommitMessageCancel())),this.addEventListener("open-fix-preview",(e=>this.onOpenFixPreview(e))),this.addEventListener("show-tab",(e=>this.setActiveTab(e)))}setupShortcuts(){this.shortcutsController.addAbstract(pu.EMOJI_DROPDOWN,(()=>{})),this.shortcutsController.addAbstract(pu.MENTIONS_DROPDOWN,(()=>{})),this.shortcutsController.addAbstract(pu.SAVE_COMMENT,(()=>{})),this.shortcutsController.addAbstract(pu.REFRESH_CHANGE,(()=>this.getChangeModel().navigateToChangeResetReload())),this.shortcutsController.addAbstract(pu.OPEN_REPLY_DIALOG,(()=>this.handleOpenReplyDialog())),this.shortcutsController.addAbstract(pu.OPEN_DOWNLOAD_DIALOG,(()=>this.handleOpenDownloadDialog())),this.shortcutsController.addAbstract(pu.TOGGLE_DIFF_MODE,(()=>this.handleToggleDiffMode())),this.shortcutsController.addAbstract(pu.TOGGLE_CHANGE_STAR,(e=>{this.throttledToggleChangeStar&&this.throttledToggleChangeStar(e)})),this.shortcutsController.addAbstract(pu.UP_TO_DASHBOARD,(()=>this.determinePageBack())),this.shortcutsController.addAbstract(pu.EXPAND_ALL_MESSAGES,(()=>this.handleExpandAllMessages())),this.shortcutsController.addAbstract(pu.COLLAPSE_ALL_MESSAGES,(()=>this.handleCollapseAllMessages())),this.shortcutsController.addAbstract(pu.OPEN_DIFF_PREFS,(()=>this.handleOpenDiffPrefsShortcut())),this.shortcutsController.addAbstract(pu.EDIT_TOPIC,(()=>{ba(this.metadata),this.metadata.editTopic()})),this.shortcutsController.addAbstract(pu.DIFF_AGAINST_BASE,(()=>this.handleDiffAgainstBase())),this.shortcutsController.addAbstract(pu.DIFF_AGAINST_LATEST,(()=>this.handleDiffAgainstLatest())),this.shortcutsController.addAbstract(pu.DIFF_BASE_AGAINST_LEFT,(()=>this.handleDiffBaseAgainstLeft())),this.shortcutsController.addAbstract(pu.DIFF_RIGHT_AGAINST_LATEST,(()=>this.handleDiffRightAgainstLatest())),this.shortcutsController.addAbstract(pu.DIFF_BASE_AGAINST_LATEST,(()=>this.handleDiffBaseAgainstLatest())),this.shortcutsController.addAbstract(pu.OPEN_SUBMIT_DIALOG,(()=>this.handleOpenSubmitDialog())),this.shortcutsController.addAbstract(pu.TOGGLE_ATTENTION_SET,(()=>this.handleToggleAttentionSet())),this.shortcutsController.addAbstract(pu.OPEN_COPY_LINKS_DROPDOWN,(()=>{const e=this.shadowRoot?.querySelector("#copyLinkDialogButton");e&&this.copyLinksDropdown?.openDropdown(e)}))}setupSubscriptions(){zf(this,(()=>this.getViewModel().state$),(e=>this.viewState=e)),zf(this,(()=>this.getViewModel().tab$),(e=>{this.tabs&&this.tabs.scrollIntoView({block:"nearest"}),this.activeTab=e})),zf(this,(()=>this.getViewModel().commentId$),(e=>this.scrollCommentId=e)),zf(this,(()=>this.getViewModel().openReplyDialog$),(e=>{e&&this.loggedIn&&this.handleOpenReplyDialog()})),zf(this,(()=>this.getChecksModel().aPluginHasRegistered$),(e=>{this.showChecksTab=e})),zf(this,(()=>this.getViewModel().childView$),(e=>{this.isViewCurrent=e===zC.OVERVIEW,this.isViewCurrent&&(document.documentElement.scrollTop=this.scrollPosition??0)})),zf(this,(()=>this.getViewModel().patchNum$),(e=>{this.viewModelPatchNum=e})),zf(this,(()=>this.getUserModel().preferenceDiffViewMode$),(e=>{this.diffViewMode=e})),zf(this,(()=>this.getCommentsModel().draftsCount$),(e=>{this.draftCount=e})),zf(this,(()=>this.getCommentsModel().threadsSaved$),(e=>{this.commentThreads=e})),zf(this,(()=>this.getChangeModel().change$),(e=>{e&&(this.change=e)})),zf(this,(()=>this.getChangeModel().changeNum$),(e=>{e&&!this.changeNum&&(this.changeNum=e,this.restApiService.getIfFlowsIsEnabled(this.changeNum).then((e=>{this.isFlowsEnabled=e?.enabled??!1})))})),zf(this,(()=>this.getChangeModel().editMode$),(e=>this.editMode=e)),zf(this,(()=>this.getChangeModel().patchNum$),(e=>this.patchNum=e)),zf(this,(()=>this.getChangeModel().basePatchNum$),(e=>this.basePatchNum=e)),zf(this,(()=>this.getChangeModel().mergeable$),(e=>this.mergeable=e)),zf(this,(()=>this.getChangeModel().revision$),(e=>this.revision=e)),zf(this,(()=>this.getChangeModel().changeLoadingStatus$),(e=>this.loading=e!==of.LOADED)),zf(this,(()=>this.getChangeModel().latestRevisionWithEdit$),(e=>{this.latestCommitMessage=this.prepareCommitMsgForLinkify(e?.commit?.message??"")})),zf(this,(()=>this.getUserModel().account$),(e=>{this.account=e})),zf(this,(()=>this.getUserModel().loggedIn$),(e=>{this.loggedIn=e})),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.serverConfig=e,this.replyDisabled=!1})),zf(this,(()=>this.getConfigModel().loginUrl$),(e=>this.loginUrl=e)),zf(this,(()=>this.getConfigModel().loginText$),(e=>this.loginText=e)),zf(this,(()=>this.getRelatedChangesModel().revertingChange$),(e=>{this.revertingChange=e}))}connectedCallback(){super.connectedCallback(),this.firstConnectedCallback(),this.connected$.next(!0),document.addEventListener("visibilitychange",this.handleVisibilityChange),document.addEventListener("scroll",this.handleScroll)}firstUpdated(){this.maybeScrollToMessage(window.location.hash),this.maybeShowRevertDialog()}firstConnectedCallback(){this.isFirstConnection&&(this.isFirstConnection=!1,this.getPluginLoader().awaitPluginsLoaded().then((()=>{this.pluginTabsHeaderEndpoints=this.getPluginLoader().pluginEndPoints.getDynamicEndpoints("change-view-tab-header"),this.pluginTabsContentEndpoints=this.getPluginLoader().pluginEndPoints.getDynamicEndpoints("change-view-tab-content"),this.pluginTabsContentEndpoints.length!==this.pluginTabsHeaderEndpoints.length&&this.reporting.error("Plugin change-view-tab",new Error("Mismatch of headers and content."))})),this.throttledToggleChangeStar=dy((e=>this.handleToggleChangeStar())))}disconnectedCallback(){document.removeEventListener("visibilitychange",this.handleVisibilityChange),document.removeEventListener("scroll",this.handleScroll),this.scrollTask?.cancel(),this.updateCheckTimerHandle&&this.cancelUpdateCheckTimer(),this.connected$.next(!1),super.disconnectedCallback()}static get styles(){return[yO,Jy,Nc,Iw,Sd`
        .tabs {
          display: flex;
        }
        .container:not(.loading) {
          background-color: var(--background-color-tertiary);
        }
        .container.loading {
          color: var(--deemphasized-text-color);
          padding: var(--spacing-l);
        }
        .header {
          align-items: center;
          background-color: var(--background-color-primary);
          border-bottom: 2px solid var(--border-color);
          display: flex;
          padding: var(--spacing-s) var(--spacing-l);
        }
        .header.active {
          border-color: var(--status-active);
        }
        .header.abandoned {
          border-color: var(--status-abandoned);
        }
        .header.merged {
          border-color: var(--status-merged);
        }
        .header.private {
          border-color: var(--status-private);
        }
        .header.ready-to-submit {
          border-color: var(--status-ready);
        }
        .header.wip {
          border-color: var(--status-wip);
        }
        .header.merge-conflict,
        .header.git-conflict {
          border-color: var(--status-conflict);
        }
        .header.editMode {
          background-color: var(--edit-mode-background-color);
        }
        .header .download {
          margin-right: var(--spacing-l);
        }
        gr-change-status {
          margin-left: var(--spacing-s);
        }
        gr-change-status:first-child {
          margin-left: 0;
        }
        .headerTitle {
          align-items: center;
          display: flex;
          flex: 1;
        }
        .headerSubject {
          font-family: var(--header-font-family);
          font-size: var(--font-size-h3);
          font-weight: var(--font-weight-h3);
          line-height: var(--line-height-h3);
          margin-left: var(--spacing-l);
        }
        .changeNumberColon {
          color: transparent;
        }
        .changeCopyClipboard {
          margin-left: var(--spacing-m);
        }
        .showCopyLinkDialogButton {
          --gr-button-padding: 0 0 0 var(--spacing-s);
          --background-color: transparent;
          margin-left: var(--spacing-s);
        }
        #replyBtn {
          margin-bottom: var(--spacing-m);
          --gr-button-padding: var(--spacing-s) var(--spacing-xl);
        }
        gr-change-star {
          margin-left: var(--spacing-s);
        }
        .showCopyLinkDialogButton gr-change-star {
          margin-left: 0;
        }
        a.changeNumber {
          margin-left: var(--spacing-xs);
          position: relative;
        }
        gr-reply-dialog {
          width: calc(min(60em, 90vw));
        }
        .changeStatus {
          text-transform: capitalize;
        }
        /* Strong specificity here is needed due to
            https://github.com/Polymer/polymer/issues/2531 */
        .container .changeInfo {
          display: flex;
          background-color: var(--background-color-secondary);
          padding-right: var(--spacing-m);
        }
        section {
          background-color: var(--view-background-color);
          box-shadow: var(--elevation-level-1);
        }
        .changeMetadata {
          /* Limit meta section to half of the screen at max */
          max-width: 50%;
        }
        .commitMessage {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          margin-right: var(--spacing-l);
          margin-bottom: var(--spacing-l);
          /* Account for border and padding and rounding errors. */
          max-width: calc(72ch + 2px + 2 * var(--spacing-m) + 0.4px);
        }
        .commitMessage gr-formatted-text {
          overflow-wrap: anywhere;
        }
        #commitMessageEditor {
          /* Account for border and padding and rounding errors. */
          min-width: calc(72ch + 2px + 2 * var(--spacing-m) + 0.4px);
          --collapsed-max-height: 300px;
        }
        .changeStatuses,
        .commitActions {
          align-items: center;
          display: flex;
        }
        .changeStatuses {
          flex-wrap: wrap;
        }
        .mainChangeInfo {
          display: flex;
          flex: 1;
          flex-direction: column;
          min-width: 0;
        }
        #commitAndRelated {
          align-content: flex-start;
          display: flex;
          flex: 1;
          overflow-x: hidden;
        }
        .relatedChanges {
          flex: 0 1 auto;
          overflow: hidden;
          padding: var(--spacing-l) 0;
        }
        .mobile {
          display: none;
        }
        hr {
          border: 0;
          border-top: 1px solid var(--border-color);
          height: 0;
          margin-bottom: var(--spacing-l);
        }
        .emptySpace {
          flex-grow: 1;
        }
        .commitContainer {
          display: flex;
          flex-direction: column;
          flex-shrink: 0;
          margin: var(--spacing-l) 0;
          padding: 0 var(--spacing-l);
        }
        .showOnEdit {
          display: none;
        }
        .scrollable {
          overflow: auto;
        }
        .text {
          white-space: pre;
        }
        gr-commit-info {
          display: inline-block;
        }
        md-tabs {
          background-color: var(--background-color-tertiary);
          margin-top: var(--spacing-m);
        }
        md-secondary-tab {
          display: inline-flex;
          box-sizing: border-box;
          max-width: 12em;
          min-width: 12em;
          --md-secondary-tab-container-height: calc(
            var(--line-height-h3) + var(--spacing-m)
          );
        }
        gr-thread-list,
        gr-messages-list {
          display: block;
        }
        gr-thread-list {
          min-height: 250px;
        }
        #includedInModal {
          width: 65em;
        }
        #uploadHelpOverlay {
          width: 50em;
        }
        #metadata {
          --metadata-horizontal-padding: var(--spacing-l);
          padding-top: var(--spacing-l);
          width: 100%;
        }
        gr-change-summary {
          margin-left: var(--spacing-m);
        }
        .changeStarContainer {
          position: relative;
        }
        @media screen and (max-width: 75em) {
          .relatedChanges {
            padding: 0;
          }
          .relatedChanges gr-related-changes-list {
            padding-top: var(--spacing-l);
          }
          #commitAndRelated {
            flex-direction: column;
            flex-wrap: nowrap;
          }
          #commitMessageEditor {
            min-width: 0;
          }
          .commitMessage {
            margin-right: 0;
          }
          .mainChangeInfo {
            padding-right: 0;
          }
        }
        @media screen and (max-width: 50em) {
          .mobile {
            display: block;
          }
          .header {
            align-items: flex-start;
            flex-direction: column;
            flex: 1;
            padding: var(--spacing-s) var(--spacing-l);
          }
          .headerTitle {
            flex-wrap: wrap;
            font-family: var(--header-font-family);
            font-size: var(--font-size-h3);
            font-weight: var(--font-weight-h3);
            line-height: var(--line-height-h3);
          }
          .desktop {
            display: none;
          }
          .reply {
            display: block;
            margin-right: 0;
            /* px because don't have the same font size */
            margin-bottom: 6px;
          }
          .changeInfo-column:not(:last-of-type) {
            margin-right: 0;
            padding-right: 0;
          }
          .changeInfo,
          #commitAndRelated {
            flex-direction: column;
            flex-wrap: nowrap;
          }
          .commitContainer {
            margin: 0;
            padding: var(--spacing-l);
          }
          .changeMetadata {
            margin-top: var(--spacing-xs);
            max-width: none;
          }
          #metadata,
          .mainChangeInfo {
            padding: 0;
          }
          .commitActions {
            display: block;
            margin-top: var(--spacing-l);
            width: 100%;
          }
          .commitMessage {
            flex: initial;
            margin: 0;
          }
          gr-reply-dialog {
            height: 90vh;
            width: initial;
          }
        }
        .patch-set-dropdown {
          margin: var(--spacing-m) 0 0 var(--spacing-m);
        }
        .tabContent gr-thread-list::part(threads) {
          padding: var(--spacing-l);
        }
      `]}render(){return dc`${this.renderLoading()}${this.renderMainContent()}`}renderLoading(){return this.loading?dc`
      <div class="container loading" ?hidden=${!this.loading}>Loading...</div>
    `:uc}renderMainContent(){return dc`
      <div id="mainContent" class="container" ?hidden=${!!this.loading}>
        ${this.renderChangeInfoSection()}
        <h2 class="assistive-tech-only">Files and Comments tabs</h2>
        ${this.renderTabHeaders()} ${this.renderTabContent()}
        ${this.renderChangeLog()}
      </div>
      <gr-apply-fix-dialog id="applyFixDialog"></gr-apply-fix-dialog>
      <dialog id="downloadModal" tabindex="-1">
        <gr-download-dialog
          id="downloadDialog"
          @close=${this.handleDownloadDialogClose}
        ></gr-download-dialog>
      </dialog>
      <dialog id="includedInModal" tabindex="-1">
        <gr-included-in-dialog
          id="includedInDialog"
          @close=${this.handleIncludedInDialogClose}
        ></gr-included-in-dialog>
      </dialog>
      <dialog id="replyModal" @close=${this.onReplyModalCanceled}>
        ${eb(this.replyModalOpened&&this.loggedIn,(()=>dc`
            <gr-reply-dialog
              id="replyDialog"
              .permittedLabels=${this.change?.permitted_labels}
              .canBeStarted=${this.canStartReview()}
              @send=${this.handleReplySent}
              @cancel=${this.handleReplyCancel}
            >
            </gr-reply-dialog>
          `))}
      </dialog>
    `}renderChangeInfoSection(){return dc`<section class="changeInfoSection">
      <div class=${this.computeHeaderClass()}>
        <h1 class="assistive-tech-only">
          Change ${this.change?._number}: ${this.change?.subject}
        </h1>
        ${this.renderHeaderTitle()} ${this.renderCommitActions()}
      </div>
      <h2 class="assistive-tech-only">Change metadata</h2>
      ${this.renderChangeInfo()}
    </section>`}renderHeaderTitle(){const e=this.computeChangeStatusChips(),t=this.revision?.commit?.resolve_conflicts_web_links??[];return dc` <div class="headerTitle">
      <div class="changeStatuses">
        ${e.map((e=>dc` <gr-change-status
            .revertedChange=${this.revertingChange}
            .status=${e}
            .resolveWeblinks=${t}
          ></gr-change-status>`))}
      </div>
      <div class="changeStarContainer">
        ${this.renderCopyLinksDropdown()}
        <gr-button
          id="copyLinkDialogButton"
          flatten
          down-arrow
          class="showCopyLinkDialogButton"
          @click=${e=>{"GR-BUTTON"===e.target?.nodeName&&this.copyLinksDropdown?.toggleDropdown(e.target)}}
          ><gr-change-star
            id="changeStar"
            .change=${this.change}
            @toggle-star=${e=>this.handleToggleStar(e)}
            ?hidden=${!this.loggedIn}
          ></gr-change-star>
          <a
            class="changeNumber"
            aria-label=${`Change ${this.change?._number}`}
            href=${Vw(this.computeChangeUrl(!0))}
            >${this.change?._number}</a
          >
        </gr-button>
      </div>
      <div class="headerSubject">
        ${Fg(this.change?.subject,80)}
      </div>
      <gr-copy-clipboard
        class="changeCopyClipboard"
        hideInput=""
        text=${this.computeCopyTextForTitle()}
      >
      </gr-copy-clipboard>
    </div>`}renderCopyLinksDropdown(){const e=this.computeChangeUrl();if(!e)return;const t=Af(e),i=[{label:"Change Number",shortcut:"n",value:`${this.change?._number}`},{label:"Change URL",shortcut:"u",value:t},{label:"Title and URL",shortcut:"t",value:`${this.change?._number}: ${this.change?.subject} | ${t}`},{label:"URL and title",shortcut:"r",value:`${t}: ${this.change?.subject}`},{label:"Markdown",shortcut:"m",value:`[${this.change?.subject}](${t})`},{label:"Change-Id",shortcut:"d",value:`${this.change?.change_id}`}];return this.change?.status===Nu.MERGED&&this.change?.current_revision&&i.push({label:"SHA",shortcut:"s",value:this.change.current_revision}),dc`<gr-copy-links .copyLinks=${i} .shortcutPrefix=${"l -"}>
    </gr-copy-links>`}renderCommitActions(){return dc`
      <div class="commitActions">
        <gr-change-actions
          id="actions"
          @edit-tap=${()=>this.handleEditTap()}
          @stop-edit-tap=${()=>this.handleStopEditTap()}
          @download-tap=${()=>this.handleOpenDownloadDialog()}
          @included-tap=${()=>this.handleOpenIncludedInDialog()}
          @revision-actions-changed=${this.handleRevisionActionsChanged}
        ></gr-change-actions>
      </div>
    `}renderChangeInfo(){const e=this.computeHideEditCommitMessage(this.loggedIn,this.editingCommitMessage,this.change);return dc` <div class="changeInfo">
      <div class="changeInfo-column changeMetadata">
        <gr-change-metadata
          id="metadata"
          .parentIsCurrent=${this.isParentCurrent()}
          @show-reply-dialog=${this.handleShowReplyDialog}
        >
        </gr-change-metadata>
      </div>
      <div id="mainChangeInfo" class="changeInfo-column mainChangeInfo">
        <div id="commitAndRelated">
          <div class="commitContainer">
            <h3 class="assistive-tech-only">Commit Message</h3>
            <div>
              <gr-button
                id="replyBtn"
                class="reply"
                title=${this.createTitle(pu.OPEN_REPLY_DIALOG,hu.ACTIONS)}
                primary=""
                .disabled=${this.replyDisabled}
                @click=${this.handleReplyTap}
                >${this.computeReplyButtonLabel()}</gr-button
              >
            </div>
            <div id="commitMessage" class="commitMessage">
              <gr-editable-content
                id="commitMessageEditor"
                .editing=${this.editingCommitMessage}
                .content=${this.latestCommitMessage}
                @editing-changed=${this.handleEditingChanged}
                @content-changed=${this.handleContentChanged}
                .storageKey=${`c${this.change?._number}_rev${this.change?.current_revision}`}
                .hideEditCommitMessage=${e}
                .commitCollapsible=${this.computeCommitCollapsible()}
                remove-zero-width-space=""
              >
                <gr-formatted-text
                  .content=${this.latestCommitMessage}
                  .markdown=${!1}
                ></gr-formatted-text>
              </gr-editable-content>
            </div>
            <h3 class="assistive-tech-only">Comments and Checks Summary</h3>
            <gr-change-summary></gr-change-summary>
            <gr-endpoint-decorator name="commit-container">
              <gr-endpoint-param name="change" .value=${this.change}>
              </gr-endpoint-param>
              <gr-endpoint-param name="revision" .value=${this.revision}>
              </gr-endpoint-param>
            </gr-endpoint-decorator>
          </div>
          <div class="relatedChanges">
            <gr-related-changes-list></gr-related-changes-list>
          </div>
          <div class="emptySpace"></div>
        </div>
      </div>
    </div>`}renderTabHeaders(){return dc`
      <div class="tabs">
        <md-tabs id="tabs" @change=${this.onMdTabsChange}>
          <md-secondary-tab
            @click=${this.onMdSecondaryTabClick}
            @keydown=${this.onMdSecondaryTabKeydown}
            data-name=${ng.FILES}
            ><span>Files</span></md-secondary-tab
          >
          <md-secondary-tab
            @click=${this.onMdSecondaryTabClick}
            @keydown=${this.onMdSecondaryTabKeydown}
            data-name=${ng.COMMENT_THREADS}
            class="commentThreads"
          >
            <gr-tooltip-content
              has-tooltip
              title=${Vw(this.computeTotalCommentCounts())}
            >
              <span>Comments</span></gr-tooltip-content
            >
          </md-secondary-tab>
          ${eb(this.showChecksTab,(()=>dc`
              <md-secondary-tab
                data-name=${ng.CHECKS}
                @click=${this.onMdSecondaryTabClick}
                @keydown=${this.onMdSecondaryTabKeydown}
                ><span>Checks</span></md-secondary-tab
              >
            `))}
          ${eb(this.flagService.isEnabled(da.SHOW_FLOWS_TAB)&&this.isFlowsEnabled,(()=>dc`
              <md-secondary-tab
                data-name=${ng.FLOWS}
                @click=${this.onMdSecondaryTabClick}
                @keydown=${this.onMdSecondaryTabKeydown}
                ><span>Flows</span></md-secondary-tab
              >
            `))}
          ${this.pluginTabsHeaderEndpoints.map((e=>dc`
              <md-secondary-tab
                data-name=${e}
                @click=${this.onMdSecondaryTabClick}
                @keydown=${this.onMdSecondaryTabKeydown}
              >
                <gr-endpoint-decorator name=${e}>
                  <gr-endpoint-param name="change" .value=${this.change}>
                  </gr-endpoint-param>
                  <gr-endpoint-param name="revision" .value=${this.revision}>
                  </gr-endpoint-param>
                </gr-endpoint-decorator>
              </md-secondary-tab>
            `))}
        </md-tabs>
      </div>
    `}renderTabContent(){return dc`
      <section class="tabContent">
        ${this.renderFilesTab()} ${this.renderCommentsTab()}
        ${this.renderChecksTab()} ${this.renderFlowsTab()}
        ${this.renderPluginTab()}
      </section>
    `}renderFilesTab(){return dc`
      <div ?hidden=${this.activeTab!==ng.FILES}>
        <gr-file-list-header
          id="fileListHeader"
          .account=${this.account}
          .change=${this.change}
          .commitInfo=${this.revision?.commit}
          .changeUrl=${this.computeChangeUrl()}
          .editMode=${this.editMode}
          .loggedIn=${this.loggedIn}
          .shownFileCount=${this.shownFileCount??0}
          .filesExpanded=${this.fileList?.filesExpanded}
          @open-diff-prefs=${this.handleOpenDiffPrefs}
          @open-download-dialog=${this.handleOpenDownloadDialog}
          @expand-diffs=${this.expandAllDiffs}
          @collapse-diffs=${this.collapseAllDiffs}
        >
        </gr-file-list-header>
        <gr-revision-parents></gr-revision-parents>
        <gr-file-list
          id="fileList"
          .change=${this.change}
          .changeNum=${this.changeNum}
          .editMode=${this.editMode}
          @files-shown-changed=${e=>{this.shownFileCount=e.detail.length}}
          @files-expanded-changed=${e=>{this.requestUpdate()}}
          @file-action-tap=${this.handleFileActionTap}
        >
        </gr-file-list>
      </div>
    `}renderCommentsTab(){return this.activeTab!==ng.COMMENT_THREADS?uc:dc`
      <h3 class="assistive-tech-only">Comments</h3>
      <gr-thread-list
        .threads=${this.commentThreads??[]}
        .commentTabState=${this.tabState}
        .unresolvedOnly=${this.unresolvedOnly}
        .scrollCommentId=${this.scrollCommentId}
        show-comment-context
      ></gr-thread-list>
    `}renderChecksTab(){return this.activeTab!==ng.CHECKS?uc:dc`
      <h3 class="assistive-tech-only">Checks</h3>
      <gr-checks-tab id="checksTab" .tabState=${this.tabState}></gr-checks-tab>
    `}renderFlowsTab(){return this.activeTab!==ng.FLOWS?uc:dc`
      <h3 class="assistive-tech-only">Flows</h3>
      <gr-flows></gr-flows>
    `}renderPluginTab(){const e=this.pluginTabsHeaderEndpoints.findIndex((e=>this.activeTab===e));if(-1===e)return uc;const t=this.pluginTabsContentEndpoints[e];return dc`
      <gr-endpoint-decorator .name=${t}>
        <gr-endpoint-param name="change" .value=${this.change}>
        </gr-endpoint-param>
        <gr-endpoint-param name="revision" .value=${this.revision}></gr-endpoint-param>
        </gr-endpoint-param>
      </gr-endpoint-decorator>
    `}renderChangeLog(){return dc`
      <gr-endpoint-decorator name="change-view-integration">
        <gr-endpoint-param name="change" .value=${this.change}>
        </gr-endpoint-param>
        <gr-endpoint-param name="revision" .value=${this.revision}>
        </gr-endpoint-param>
      </gr-endpoint-decorator>

      <div class="tabs">
        <md-tabs>
          <md-secondary-tab data-name="_changeLog" class="changeLog">
            Change Log
          </md-secondary-tab>
        </md-tabs>
      </div>
      <section class="changeLog">
        <h2 class="assistive-tech-only">Change Log</h2>
        <gr-messages-list
          .labels=${this.change?.labels}
          .messages=${this.change?.messages}
          .reviewerUpdates=${this.change?.reviewer_updates??[]}
          @message-anchor-tap=${this.handleMessageAnchorTap}
        ></gr-messages-list>
      </section>
    `}updated(){const e=[...ya(this.tabs,"md-secondary-tab")].findIndex((e=>e.dataset.name===this.activeTab));-1!==e&&this.tabs.activeTabIndex!==e&&(this.tabs.activeTabIndex=e),this.reportChangeDisplayed(),this.reportFullyLoaded()}onOpenFixPreview(e){ba(this.applyFixDialog),this.applyFixDialog.open(e)}handleToggleDiffMode(){this.diffViewMode===Su.SIDE_BY_SIDE?this.getUserModel().updatePreferences({diff_view:Su.UNIFIED}):this.getUserModel().updatePreferences({diff_view:Su.SIDE_BY_SIDE})}onMdTabsChange(e){if(!this.tabs)return;const t=[...ya(this.tabs,"md-secondary-tab")];if(!t)return;const i=e.target.activeTabIndex,r=Number(i);va(Number.isInteger(r)&&0<=r&&r<t.length,`${r} must be integer`);const o=t[r].dataset.name;this.getViewModel().updateState({tab:o})}setActiveTab(e){const t=e.detail.tab;this.getViewModel().updateState({tab:t}),e.detail.tabState&&(this.tabState=e.detail.tabState),e.detail.scrollIntoView&&this.tabs.scrollIntoView({block:"center"})}onMdSecondaryTabClick(e){let t,i=e.target;do{if(t=i?.dataset?.name,t)break;i=i?.parentElement}while(i);t===ng.COMMENT_THREADS&&((this.commentThreads??[]).filter((e=>Zx(e))).length>0||(this.unresolvedOnly=!1)),this.reporting.reportInteraction(ga.SHOW_TAB,{tabName:t,src:"md-secondary-tab-click"})}onMdSecondaryTabKeydown(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),e.currentTarget.click())}handleEditingChanged(e){this.editingCommitMessage=e.detail.value}handleContentChanged(e){this.latestCommitMessage=e.detail.value??""}async handleCommitMessageSave(e){if(ba(this.change,"change"),ba(this.changeNum,"changeNum"),!this.commitMessageEditor||this.commitMessageEditor.disabled)return;const t=e.detail.content.replace(XF,""),i=e.detail.committerEmail;await this.getPluginLoader().jsApiService.handleBeforeCommitMessage(this.change,t)&&(this.getPluginLoader().jsApiService.handleCommitMessage(this.change,t),this.commitMessageEditor.disabled=!0,this.restApiService.putChangeCommitMessage(this.changeNum,t,i).then((e=>{ba(this.commitMessageEditor),this.commitMessageEditor.disabled=!1,e.ok&&(this.editingCommitMessage=!1,this.getChangeModel().navigateToChangeResetReload())})).catch((()=>{ba(this.commitMessageEditor),this.commitMessageEditor.disabled=!1})))}handleCommitMessageCancel(){this.editingCommitMessage=!1}computeChangeStatusChips(){if(!this.change||void 0===this.mergeable)return[];const e={mergeable:this.mergeable,revertingChangeStatus:this.revertingChange?.status};return OC(this.change,e)}computeHideEditCommitMessage(e,t,i){return!!(!e||t||i&&i.status===Nu.MERGED)}computeTotalCommentCounts(){const e=this.change?.unresolved_comment_count??0,t=0===e?"":`${e} unresolved`,i=Ig(this.draftCount,"draft");return t+(t&&i?", ":"")+i}handleReplyTap(){this.loggedIn?this.openReplyDialog(uF.ANY):qF(window.location,this.loginUrl)}onReplyModalCanceled(){this.replyModalOpened=!1}handleOpenDiffPrefs(){ba(this.fileList),this.fileList.openDiffPrefs()}handleOpenIncludedInDialog(){ba(this.includedInDialog),ba(this.includedInModal),this.includedInDialog.loadData(),this.includedInModal.showModal()}handleIncludedInDialogClose(){ba(this.includedInModal),this.includedInModal.close()}handleOpenDownloadDialog(){ba(this.downloadModal),this.downloadModal.showModal(),Ln(this.downloadModal,(()=>{ba(this.downloadModal),ba(this.downloadDialog),this.downloadDialog.focus()}))}handleDownloadDialogClose(){ba(this.downloadModal),this.downloadModal.close()}handleReplySent(){ba(this.replyModal),this.replyModal.close(),this.getCommentsModel().reloadAllComments()}handleReplyCancel(){ba(this.replyModal),this.replyModal.close(),this.onReplyModalCanceled()}handleShowReplyDialog(e){let t=uF.REVIEWERS;e.detail.value&&e.detail.value.ccsOnly&&(t=uF.CCS),this.openReplyDialog(t)}expandAllDiffs(){ba(this.fileList),this.fileList.expandAllDiffs()}collapseAllDiffs(){ba(this.fileList),this.fileList.collapseAllDiffs()}isChangeObsolete(){return void 0!==this.changeNum&&this.changeNum!==this.viewState?.changeNum}handleMessageAnchorTap(e){ba(this.change,"change"),ba(this.patchNum,"patchNum");const t=JF+e.detail.id,i=WC({change:this.change,patchNum:this.patchNum,basePatchNum:this.basePatchNum,edit:this.editMode,messageHash:t});history.replaceState(null,"",i)}async maybeScrollToMessage(e){e.startsWith(JF)&&(await uy((()=>!!this.messagesList)),await this.messagesList.scrollToMessage(e.substr(9)))}getLocationSearch(){return window.location.search}_getUrlParameter(e){const t=this.getLocationSearch().substring(1).split("&");for(let i=0;i<t.length;i++){const r=t[i].split("=");if(r[0]===e)return r[0]}return null}async maybeShowRevertDialog(){this._getUrlParameter("revert")&&(await this.getPluginLoader().awaitPluginsLoaded(),await uy((()=>!!this.actions)),await uy((()=>!!this.change)),this.change?.status===Nu.MERGED&&this.loggedIn&&await this.actions.showRevertDialog())}changeChanged(e){this.allPatchSets=Ox(this.change),this.change&&this.labelsChanged(e?.labels,this.change.labels)}computeChangeUrl(e){if(this.change)return WC({change:this.change,forceReload:!!e})}computeReplyButtonLabel(){if(!this.loggedIn)return this.loginText;let e=this.canStartReview()?"Start Review":"Reply";return this.draftCount>0&&(e+=` (${this.draftCount})`),e}handleOpenReplyDialog(){this.loggedIn?this.openReplyDialog(uF.ANY):Jn(this,"show-auth-required",{})}handleOpenSubmitDialog(){this.isSubmitEnabled()&&(ba(this.actions),this.actions.showSubmitDialog())}handleToggleAttentionSet(){if(!this.change||!this.account?._account_id)return;if(!this.loggedIn||!UC(this.change,this.account))return;const e={...this.change};if(e.attention_set||(e.attention_set={}),CC(this.account,this.change.attention_set)){const t=$C(this.account,this.serverConfig);e.attention_set&&delete e.attention_set[this.account._account_id],ea(this,"Removing you from the attention set ..."),this.restApiService.removeFromAttentionSet(this.change._number,this.account._account_id,t).then((()=>{Jn(this,"hide-alert",{})}))}else{const t=SC(this.account,this.serverConfig);ea(this,"Adding you to the attention set ..."),e.attention_set[this.account._account_id]={account:this.account,reason:t,reason_account:this.account},this.restApiService.addToAttentionSet(this.change._number,this.account._account_id,t).then((()=>{Jn(this,"hide-alert",{})}))}this.getChangeModel().updateStateChange(e)}handleDiffAgainstBase(){ba(this.change,"change"),ba(this.patchNum,"patchNum"),this.basePatchNum!==Qu?this.getNavigation().setUrl(WC({change:this.change,patchNum:this.patchNum})):ea(this,"Base is already selected.")}handleDiffBaseAgainstLeft(){this.viewState?.childView===zC.OVERVIEW&&(ba(this.change,"change"),ba(this.patchNum,"patchNum"),this.basePatchNum!==Qu?this.getNavigation().setUrl(WC({change:this.change,patchNum:this.basePatchNum})):ea(this,"Left is already base."))}handleDiffAgainstLatest(){ba(this.change,"change"),ba(this.patchNum,"patchNum");const e=Dx(this.allPatchSets);this.patchNum!==e?this.getNavigation().setUrl(WC({change:this.change,patchNum:e,basePatchNum:this.basePatchNum})):ea(this,"Latest is already selected.")}handleDiffRightAgainstLatest(){ba(this.change,"change"),ba(this.patchNum,"patchNum");const e=Dx(this.allPatchSets);this.patchNum!==e?this.getNavigation().setUrl(WC({change:this.change,patchNum:e,basePatchNum:this.patchNum})):ea(this,"Right is already latest.")}handleDiffBaseAgainstLatest(){ba(this.change,"change"),ba(this.patchNum,"patchNum");const e=Dx(this.allPatchSets);this.patchNum!==e||this.basePatchNum!==Qu?this.getNavigation().setUrl(WC({change:this.change,patchNum:e})):ea(this,"Already diffing base against latest.")}handleToggleChangeStar(){ba(this.changeStar),this.changeStar.toggleStar()}handleExpandAllMessages(){this.messagesList&&this.messagesList.handleExpandCollapse(!0)}handleCollapseAllMessages(){this.messagesList&&this.messagesList.handleExpandCollapse(!1)}handleOpenDiffPrefsShortcut(){this.loggedIn&&(ba(this.fileList),this.fileList.openDiffPrefs())}determinePageBack(){this.getNavigation().setUrl(this.backPage||kf())}handleLabelRemoved(e,t){for(const i in e){if(!Object.prototype.hasOwnProperty.call(e,i))continue;const r=e[i],o=t[i];if(!o)continue;if(!r.all||!o.all)continue;const s=r.all.map((e=>e._account_id)),n=o.all.map((e=>e._account_id));for(const e of s)if(!n.includes(e)&&o.approved?._account_id===e)return void aa(this)}}labelsChanged(e,t){e&&t&&(this.handleLabelRemoved(e,t),this.getPluginLoader().jsApiService.handleLabelChange({change:this.change}))}openReplyDialog(e){this.change&&(this.replyModalOpened=!0,ba(this.replyModal),this.replyModal.showModal(),Ln(this.replyModal,(()=>{ba(this.replyDialog,"replyDialog"),this.replyDialog.open(e)})))}prepareCommitMsgForLinkify(e){return e.replace(YF,"$1=​")}isParentCurrent(){const e=this.currentRevisionActions;return!e||!e.rebase||!e.rebase.enabled}async reportChangeDisplayed(){await uy((()=>!!this.metadata)),await Vn(this.metadata),this.activeTab===ng.FILES&&(await uy((()=>!!this.fileList)),await Vn(this.fileList)),await uy((()=>!!this.messagesList)),await Vn(this.messagesList),this.change&&this.isConnected&&!this.isChangeObsolete()&&this.reporting.changeDisplayed(BC(this.change,this.account))}async reportFullyLoaded(){await uy((()=>!!this.metadata)),await Vn(this.metadata),this.activeTab===ng.FILES&&(await uy((()=>!!this.fileList)),await Vn(this.fileList)),await uy((()=>!!this.messagesList)),await Vn(this.messagesList),await uy((()=>void 0!==this.mergeable)),await cy(this.getCommentsModel().comments$,(e=>void 0!==e)),await cy(this.getCommentsModel().drafts$,(e=>void 0!==e)),this.change&&this.isConnected&&!this.isChangeObsolete()&&this.reporting.changeFullyLoaded()}computeCopyTextForTitle(){return`${this.change?._number}: ${this.change?.subject} | ${location.protocol}//${location.host}${this.computeChangeUrl()}`}computeCommitCollapsible(){return!!this.latestCommitMessage&&this.latestCommitMessage.split("\n").length>=18}startUpdateCheckTimer(){if(this.getPluginLoader().pluginsModel.getChangeUpdatesPlugins().length>0)return;const e=this.serverConfig?.change?.update_delay??0;e<=0||(this.updateCheckTimerHandle=window.setTimeout((()=>{this.isViewCurrent&&this.change?this.getChangeModel().throttledShowUpdateChangeNotification():this.startUpdateCheckTimer()}),1e3*e))}cancelUpdateCheckTimer(){this.updateCheckTimerHandle&&window.clearTimeout(this.updateCheckTimerHandle),this.updateCheckTimerHandle=null}computeHeaderClass(){const e=["header"],t=this.computeChangeStatusChips()?.[0];return t&&e.push(t.toLowerCase()),this.editMode&&e.push("editMode"),e.join(" ")}handleFileActionTap(e){e.preventDefault(),ba(this.fileListHeader);const t=this.fileListHeader.shadowRoot.querySelector("#editControls");if(!t)throw new Error("Missing edit controls");ba(this.change,"change"),ba(this.patchNum,"patchNum");const i=e.detail.path;switch(e.detail.action){case qL.DELETE.id:t.openDeleteDialog(i);break;case qL.OPEN.id:this.getNavigation().setUrl(this.getViewModel().editUrl({editView:{path:i},patchNum:this.patchNum}));break;case qL.RENAME.id:t.openRenameDialog(i);break;case qL.RESTORE.id:t.openRestoreDialog(i)}}handleEditTap(){if(!this.change||!this.change.revisions)throw new Error("missing required change property");if(Object.values(this.change.revisions).find((e=>e._number===Ju))){const e=WC({change:this.change,patchNum:Ju});this.getNavigation().setUrl(e)}else this.getNavigation().setUrl(WC({change:this.change,patchNum:this.viewModelPatchNum,edit:!0,forceReload:!0}))}handleStopEditTap(){ba(this.change,"change"),ba(this.patchNum,"patchNum"),this.getNavigation().setUrl(WC({change:this.change,patchNum:this.patchNum,forceReload:!0}))}async handleToggleStar(e){e.detail.starred?(this.reporting.reportInteraction("change-starred-from-change-view"),this.lastStarredTimestamp=Date.now()):this.lastStarredTimestamp&&Date.now()-this.lastStarredTimestamp<1e4&&this.reporting.reportInteraction("change-accidentally-starred"),ea(this,e.detail.starred?"Starring change...":"Unstarring change..."),await this.restApiService.saveChangeStarred(e.detail.change._number,e.detail.starred),Jn(this,"hide-alert",{})}createTitle(e,t){return this.getShortcutsService().createTitle(e,t)}handleRevisionActionsChanged(e){this.currentRevisionActions=e.detail.value}};KF([Hc("#applyFixDialog")],QF.prototype,"applyFixDialog",void 0),KF([Hc("#fileList")],QF.prototype,"fileList",void 0),KF([Hc("#fileListHeader")],QF.prototype,"fileListHeader",void 0),KF([Hc("#commitMessageEditor")],QF.prototype,"commitMessageEditor",void 0),KF([Hc("#includedInModal")],QF.prototype,"includedInModal",void 0),KF([Hc("#includedInDialog")],QF.prototype,"includedInDialog",void 0),KF([Hc("#downloadModal")],QF.prototype,"downloadModal",void 0),KF([Hc("#downloadDialog")],QF.prototype,"downloadDialog",void 0),KF([Hc("#replyModal")],QF.prototype,"replyModal",void 0),KF([Hc("#replyDialog")],QF.prototype,"replyDialog",void 0),KF([Hc("#mainContent")],QF.prototype,"mainContent",void 0),KF([Hc("#changeStar")],QF.prototype,"changeStar",void 0),KF([Hc("#actions")],QF.prototype,"actions",void 0),KF([Hc("#commitMessage")],QF.prototype,"commitMessage",void 0),KF([Hc("#commitAndRelated")],QF.prototype,"commitAndRelated",void 0),KF([Hc("#metadata")],QF.prototype,"metadata",void 0),KF([Hc("#mainChangeInfo")],QF.prototype,"mainChangeInfo",void 0),KF([Hc("#replyBtn")],QF.prototype,"replyBtn",void 0),KF([Hc("#tabs")],QF.prototype,"tabs",void 0),KF([Hc("gr-messages-list")],QF.prototype,"messagesList",void 0),KF([Hc("gr-thread-list")],QF.prototype,"threadList",void 0),KF([Hc("gr-copy-links")],QF.prototype,"copyLinksDropdown",void 0),KF([Uc()],QF.prototype,"viewState",void 0),KF([Fc({type:String})],QF.prototype,"backPage",void 0),KF([Uc()],QF.prototype,"commentThreads",void 0),KF([Uc()],QF.prototype,"serverConfig",null),KF([Uc()],QF.prototype,"account",void 0),KF([Uc()],QF.prototype,"change",null),KF([Uc()],QF.prototype,"changeNum",void 0),KF([Uc()],QF.prototype,"editingCommitMessage",void 0),KF([Uc()],QF.prototype,"latestCommitMessage",void 0),KF([Uc()],QF.prototype,"basePatchNum",void 0),KF([Uc()],QF.prototype,"patchNum",void 0),KF([Uc()],QF.prototype,"revision",void 0),KF([Uc()],QF.prototype,"currentRevisionActions",void 0),KF([Uc()],QF.prototype,"allPatchSets",void 0),KF([Uc()],QF.prototype,"loggedIn",void 0),KF([Uc()],QF.prototype,"loading",void 0),KF([Uc()],QF.prototype,"shownFileCount",void 0),KF([Uc()],QF.prototype,"replyDisabled",void 0),KF([Uc()],QF.prototype,"editMode",void 0),KF([Uc()],QF.prototype,"mergeable",void 0),KF([Uc()],QF.prototype,"pluginTabsHeaderEndpoints",void 0),KF([Uc()],QF.prototype,"pluginTabsContentEndpoints",void 0),KF([Uc()],QF.prototype,"activeTab",void 0),KF([Fc({type:Boolean})],QF.prototype,"unresolvedOnly",void 0),KF([Uc()],QF.prototype,"draftCount",void 0),KF([Uc()],QF.prototype,"showChecksTab",void 0),KF([Uc()],QF.prototype,"isViewCurrent",void 0),KF([Uc()],QF.prototype,"tabState",void 0),KF([Uc()],QF.prototype,"revertingChange",void 0),KF([Uc()],QF.prototype,"isFlowsEnabled",void 0),KF([Uc()],QF.prototype,"scrollCommentId",void 0),KF([Uc()],QF.prototype,"replyModalOpened",void 0),KF([Uc()],QF.prototype,"loginUrl",void 0),KF([Uc()],QF.prototype,"loginText",void 0),QF=KF([Dc("gr-change-view")],QF);var ZF=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let eU=class extends Ic{render(){return dc`${hd(this.htmlContent??"")}`}};ZF([Fc({type:String})],eU.prototype,"htmlContent",void 0),eU=ZF([Dc("gr-html-renderer")],eU);var tU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let iU=class extends Ic{constructor(){super(),this.loginUrl="",this.loginText="",this.showSignInButton=!1,this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getConfigModel().loginUrl$),(e=>this.loginUrl=e)),zf(this,(()=>this.getConfigModel().loginText$),(e=>this.loginText=e))}static get styles(){return[Nc,Sd`
        .main {
          max-height: 40em;
          max-width: 60em;
          overflow-y: auto;
          white-space: pre-wrap;
        }
        @media screen and (max-width: 50em) {
          .main {
            max-height: none;
            max-width: 50em;
          }
        }
        .signInLink {
          text-decoration: none;
        }
        .plaintext {
          font: inherit;
          white-space: var(--linked-text-white-space, pre-wrap);
          word-wrap: var(--linked-text-word-wrap, break-word);
        }
      `]}render(){return dc`
      <gr-dialog
        id="dialog"
        cancel-label=""
        @confirm=${()=>{this.handleConfirm()}}
        confirm-label="Dismiss"
        confirm-on-enter=""
      >
        <div class="header" slot="header">An error occurred</div>
        ${eb(this.htmlContent,(()=>dc`<div class="main" slot="main">
              <gr-html-renderer
                .htmlContent=${this.htmlContent}
              ></gr-html-renderer>
            </div>`),(()=>dc`<div class="main" slot="main">${this.text}</div>`))}
        ${this.renderSignButton()}
      </gr-dialog>
    `}renderSignButton(){if(this.showSignInButton)return dc`
      <gr-button id="signIn" class="signInLink" link="" slot="footer">
        <a class="signInLink" href=${this.loginUrl}>${this.loginText}</a>
      </gr-button>
    `}handleConfirm(){Zn(this,"dismiss",{})}};tU([Fc({type:String})],iU.prototype,"text",void 0),tU([Fc({attribute:!1})],iU.prototype,"htmlContent",void 0),tU([Uc()],iU.prototype,"loginUrl",void 0),tU([Uc()],iU.prototype,"loginText",void 0),tU([Fc({type:Boolean})],iU.prototype,"showSignInButton",void 0),iU=tU([Dc("gr-error-dialog")],iU);var rU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let oU=class extends Ic{constructor(){super(...arguments),this.shown=!0,this.toast=!0,this.showDismiss=!1,this.owner=null,this.resolveDep=e=>{this.owner?.dispatchEvent(new wu(e.dependency,e.callback))}}static get styles(){return[Nc,Sd`
        /**
         * ALERT: DO NOT ADD TRANSITION PROPERTIES WITHOUT PROPERLY UNDERSTANDING
         * HOW THEY ARE USED IN THE CODE.
         */
        :host([toast]) {
          background-color: var(--tooltip-background-color);
          bottom: 1.25rem;
          border-radius: var(--border-radius);
          box-shadow: var(--elevation-level-2);
          left: 1.25rem;
          position: fixed;
          transform: translateY(5rem);
          transition: transform var(--gr-alert-transition-duration, 80ms)
            ease-out;
          z-index: 1000;
        }
        :host([shown]) {
          transform: translateY(0);
        }
        /**
         * NOTE: To avoid style being overwritten by outside of the shadow DOM
         * (as outside styles always win), .content-wrapper is introduced as a
         * wrapper around main content to have better encapsulation, styles that
         * may be affected by outside should be defined on it.
         * In this case, \`padding:0px\` is defined in main.css for all elements
         * with the universal selector: *.
         */
        .content-wrapper {
          padding: var(--spacing-l) var(--spacing-xl);
        }
        .text {
          color: var(--tooltip-text-color);
          display: inline-block;
          max-height: 10rem;
          max-width: 80vw;
          vertical-align: bottom;
          word-break: break-all;
        }
        gr-button.action {
          --text-color: var(--tooltip-button-text-color);
          --gr-button-padding: 0 var(--spacing-s);
          margin-left: var(--spacing-l);
        }
      `]}renderDismissButton(){return this.showDismiss?dc`<gr-button
      link=""
      class="action"
      @click=${this._handleDismissTap}
      >Dismiss</gr-button
    >`:""}render(){const{text:e,actionText:t}=this;return dc`
      <div class="content-wrapper">
        <span class="text">${e}</span>
        <gr-button
          link=""
          class="action"
          ?hidden=${!!this._hideActionButton}
          @click=${this._handleActionTap}
          >${t}
        </gr-button>
        ${this.renderDismissButton()}
      </div>
    `}connectedCallback(){super.connectedCallback(),this._boundTransitionEndHandler=()=>this._handleTransitionEnd(),this.addEventListener("transitionend",this._boundTransitionEndHandler),this.addEventListener("request-dependency",this.resolveDep)}disconnectedCallback(){this.removeEventListener("request-dependency",this.resolveDep),this._boundTransitionEndHandler&&this.removeEventListener("transitionend",this._boundTransitionEndHandler),super.disconnectedCallback()}show(e,t,i){this.text=e,this.actionText=t,this._hideActionButton=!t,this._actionCallback=i,document.body.appendChild(this),this.shown=!0}hide(){this.shown=!1,this._hasZeroTransitionDuration()&&document.body.removeChild(this)}_handleDismissTap(){this.hide()}_hasZeroTransitionDuration(){const e=window.getComputedStyle(this);return 0===Math.round(100*parseFloat(e.transitionDuration))}_handleTransitionEnd(){this.shown||document.body.removeChild(this)}_handleActionTap(e){e.preventDefault(),this._actionCallback&&this._actionCallback(),this.hide()}};rU([Fc({type:String})],oU.prototype,"text",void 0),rU([Fc({type:String})],oU.prototype,"actionText",void 0),rU([Fc({type:String})],oU.prototype,"type",void 0),rU([Fc({type:Boolean,reflect:!0})],oU.prototype,"shown",void 0),rU([Fc({type:Boolean,reflect:!0})],oU.prototype,"toast",void 0),rU([Fc({type:Boolean})],oU.prototype,"_hideActionButton",void 0),rU([Fc({type:Boolean})],oU.prototype,"showDismiss",void 0),rU([Fc({type:Object})],oU.prototype,"owner",void 0),rU([Fc()],oU.prototype,"_boundTransitionEndHandler",void 0),rU([Fc()],oU.prototype,"_actionCallback",void 0),oU=rU([Dc("gr-alert")],oU);const sU=mu("auth-service");var nU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const aU="Authentication required\n",lU={[rf.AUTH]:3,[rf.NETWORK]:2,[rf.GENERIC]:1};function dU({errorText:e,status:t,statusText:i,url:r,trace:o,tip:s}){let n="";return s&&(n+=`${s}\n\n`),n+=`Error ${t}`,i&&(n+=` (${i})`),(e||r)&&(n+=": "),e&&(n+=e),r&&(n+=`\nEndpoint: ${r}`),o&&(n+=`\nTrace Id: ${o}`),n}let cU=class extends Ic{constructor(){super(...arguments),this.alertElement=null,this.hideAlertHandle=null,this.refreshingCredentials=!1,this.lastCredentialCheck=Date.now(),this.reporting=Xn().reportingService,this.getAuthService=yu(this,sU),this.restApiService=Xn().restApiService,this.handleAuthRequired=()=>{this.showAuthErrorAlert("Log in is required to perform that action.","Log in.")},this.handleAuthError=e=>{this.signInModal.showModal(),this.showAuthErrorAlert(e.detail.message,e.detail.action)},this.handleServerError=e=>{const{request:t,response:i}=e.detail;i.text().then((e=>{const r=t&&(t.anonymizedUrl||t.url),{status:o,statusText:s}=i;if(403!==i.status||this.getAuthService().isAuthed||e!==aU){if(403===i.status&&this.getAuthService().isAuthed&&e===aU)this.getAuthService().clearCache(),this.restApiService.getLoggedIn();else if(!this.shouldSuppressError(e)){const t=i.headers&&i.headers.get("X-Gerrit-Trace");404===i.status?this.showNotFoundMessageWithTip({status:o,statusText:s,errorText:e,url:r,trace:t}):429===i.status?this.showQuotaExceeded({status:o,statusText:s}):(i.headers?.get("Content-Type")??"").includes("text/html")?this.showErrorDialog(dU({status:o,statusText:s,url:r,trace:t}),{htmlContent:e}):this.showErrorDialog(dU({status:o,statusText:s,errorText:e,url:r,trace:t}))}}else this.handleAuthRequired();this.reporting.error("Server error",new Error(e))}))},this.handleShowAlert=e=>{this._showAlert(e.detail.message,e.detail.action,e.detail.callback,e.detail.dismissOnNavigation,void 0,e.detail.showDismiss)},this.handleNetworkError=e=>{this._showAlert("Server unavailable"),this.reporting.error("Network error",new Error(e.detail.error.message))},this.hideAlert=()=>{this.alertElement&&(this.alertElement.hide(),this.alertElement=null,document.removeEventListener("location-change",this.hideAlert))},this.handleVisibilityChange=()=>{if(!1!==document.hidden)return;const e=Date.now()-this.lastCredentialCheck;!this.refreshingCredentials&&void 0!==this.knownAccountId&&e>6e5&&(this.reporting.reportInteraction("visibility-sign-in-check"),this.lastCredentialCheck=Date.now(),this.checkSignedIn())},this.handleWindowFocus=()=>{this.checkLoggedInTask?.flush()},this.handleShowErrorDialog=e=>{this.showErrorDialog(e.detail.message)}}connectedCallback(){super.connectedCallback(),document.addEventListener("server-error",this.handleServerError),document.addEventListener("network-error",this.handleNetworkError),document.addEventListener("show-alert",this.handleShowAlert),document.addEventListener("hide-alert",this.hideAlert),document.addEventListener("show-error",this.handleShowErrorDialog),document.addEventListener("visibilitychange",this.handleVisibilityChange),document.addEventListener("show-auth-required",this.handleAuthRequired),document.addEventListener("auth-error",this.handleAuthError),HL()}disconnectedCallback(){this.clearHideAlertHandle(),document.removeEventListener("server-error",this.handleServerError),document.removeEventListener("network-error",this.handleNetworkError),document.removeEventListener("show-alert",this.handleShowAlert),document.removeEventListener("hide-alert",this.hideAlert),document.removeEventListener("show-error",this.handleShowErrorDialog),document.removeEventListener("visibilitychange",this.handleVisibilityChange),document.removeEventListener("show-auth-required",this.handleAuthRequired),this.checkLoggedInTask?.cancel(),document.removeEventListener("auth-error",this.handleAuthError),super.disconnectedCallback()}static get styles(){return[Iw]}render(){return dc`
      <dialog id="errorModal" tabindex="-1">
        <gr-error-dialog
          id="errorDialog"
          @dismiss=${()=>this.errorModal.close()}
        ></gr-error-dialog>
      </dialog>
      <dialog
        id="signInModal"
        @keydown=${e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation())}}
        tabindex="-1"
      >
        <gr-dialog
          id="signInDialog"
          confirm-label="Sign In"
          @confirm=${()=>{this.createLoginPopup()}}
          cancel-label=""
        >
          <div class="header" slot="header">Refresh Credentials</div>
        </gr-dialog>
      </dialog>
    `}shouldSuppressError(e){return e.includes("too many files to find conflicts")}showNotFoundMessageWithTip({status:e,statusText:t,errorText:i,url:r,trace:o}){this.restApiService.getLoggedIn().then((s=>{const n=s?"You might have not enough privileges.":"You might have not enough privileges. Sign in and try again.";this.showErrorDialog(dU({status:e,statusText:t,errorText:i,url:r,trace:o,tip:n}),{showSignInButton:!s})}))}showQuotaExceeded({status:e,statusText:t}){this.showErrorDialog(dU({status:e,statusText:t,errorText:"Too many requests from this client",tip:"Try again later"}))}canOverride(e=rf.GENERIC,t=rf.GENERIC){return lU[e]>=lU[t]}_showAlert(e,t,i,r,o,s){if(this.alertElement){if(!this.canOverride(o,this.alertElement.type))return;this.hideAlert()}this.clearHideAlertHandle(),r?document.addEventListener("location-change",this.hideAlert):this.hideAlertHandle=window.setTimeout(this.hideAlert,1e4);const n=this.createToastAlert(s);n.show(e,t,i),this.alertElement=n,sa(this,`Alert: ${e}`),this.reporting.reportInteraction("show-alert",{text:e})}clearHideAlertHandle(){null!==this.hideAlertHandle&&(window.clearTimeout(this.hideAlertHandle),this.hideAlertHandle=null)}showAuthErrorAlert(e,t){this.alertElement&&this.alertElement.hide(),this.alertElement=this.createToastAlert(),this.alertElement.type=rf.AUTH,this.alertElement.show(e,t,(()=>this.createLoginPopup())),sa(this,e),this.reporting.reportInteraction("show-auth-error",{text:e}),this.refreshingCredentials=!0,this.requestCheckLoggedIn(),document.hidden||this.handleVisibilityChange()}createToastAlert(e){const t=document.createElement("gr-alert");return t.owner=this,t.toast=!0,t.showDismiss=!!e,t}requestCheckLoggedIn(){this.checkLoggedInTask=ny(this.checkLoggedInTask,(()=>this.checkSignedIn()),6e4)}checkSignedIn(){this.lastCredentialCheck=Date.now(),this.restApiService.invalidateAccountsCache(),this.getAuthService().clearCache(),this.restApiService.getLoggedIn().then((e=>{this.refreshingCredentials&&(e?this.restApiService.getAccount().then((e=>{if(this.refreshingCredentials){if(e?._account_id!==this.knownAccountId)return this.reporting.reportInteraction("sign-in-window-reload",{oldAccount:!!this.knownAccountId,newAccount:!!e?._account_id}),void this.reloadPage();this.handleCredentialRefreshed()}})):this.requestCheckLoggedIn())}))}reloadPage(){Rn()}createLoginPopup(){const e=["width=690","height=500",`left=${window.screenLeft+(window.outerWidth-690)/2}`,`top=${window.screenTop+(window.outerHeight-500)/2}`];window.open(Sf()+"/login/%3FcloseAfterLogin","_blank",e.join(",")),window.addEventListener("focus",this.handleWindowFocus)}handleCredentialRefreshed(){window.removeEventListener("focus",this.handleWindowFocus),this.refreshingCredentials=!1,this.hideAlert(),this._showAlert("Credentials refreshed."),this.signInModal.close(),this.getAuthService().clearCache()}showErrorDialog(e,t){this.reporting.reportErrorDialog(e),this.errorDialog.text=e,this.errorDialog.htmlContent=t?.htmlContent,this.errorDialog.showSignInButton=!!t&&!!t.showSignInButton,this.errorModal.hasAttribute("open")&&this.errorModal.close(),this.errorModal.showModal()}};nU([Uc()],cU.prototype,"knownAccountId",void 0),nU([Uc()],cU.prototype,"alertElement",void 0),nU([Uc()],cU.prototype,"hideAlertHandle",void 0),nU([Uc()],cU.prototype,"refreshingCredentials",void 0),nU([Hc("#signInModal")],cU.prototype,"signInModal",void 0),nU([Hc("#errorDialog")],cU.prototype,"errorDialog",void 0),nU([Hc("#errorModal")],cU.prototype,"errorModal",void 0),nU([Uc()],cU.prototype,"lastCredentialCheck",void 0),cU=nU([Dc("gr-error-manager")],cU);var hU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let pU=class extends Ic{constructor(){super(...arguments),this.binding=[]}static get styles(){return[Sd`
        .key {
          background-color: var(--chip-background-color);
          color: var(--primary-text-color);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          display: inline-block;
          font-weight: var(--font-weight-medium);
          padding: var(--spacing-xxs) var(--spacing-m);
          text-align: center;
        }
      `]}render(){const e=this.binding.map(((e,t)=>[t>0?dc` or `:dc``,this._computeModifiers(e).map((e=>dc`<span class="key modifier">${e}</span> `)),dc`<span class="key">${this._computeKey(e)}</span>`]));return dc`${e}`}_computeModifiers(e){return e.slice(0,e.length-1)}_computeKey(e){return e[e.length-1]}};hU([Fc({type:Array})],pU.prototype,"binding",void 0),pU=hU([Dc("gr-key-binding-display")],pU);var uU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let gU=class extends Ic{constructor(){super(),this.getShortcutsService=yu(this,Bg),this.shortcutListener=e=>this.onDirectoryUpdated(e)}static get styles(){return[Nc,Qb,Sd`
        :host {
          display: block;
          max-height: 100vh;
          min-width: 60vw;
        }
        main {
          display: flex;
          padding: 0 var(--spacing-xxl) var(--spacing-xxl);
        }
        .column {
          flex: 50%;
        }
        header {
          padding: var(--spacing-l) var(--spacing-xxl);
          align-items: center;
          border-bottom: 1px solid var(--border-color);
          display: flex;
          justify-content: space-between;
        }
        table caption {
          padding: var(--spacing-l) var(--spacing-s);
        }
        td {
          padding: var(--spacing-xs) 0;
          vertical-align: middle;
          width: 200px;
        }
        td:first-child,
        th:first-child {
          padding-right: var(--spacing-m);
          text-align: right;
        }
        td:last-child,
        th:last-child {
          text-align: left;
        }
        td:last-child {
          color: var(--deemphasized-text-color);
        }
        th {
          color: var(--deemphasized-text-color);
        }
        .modifier {
          font-weight: var(--font-weight-normal);
        }
      `]}render(){return dc`
      <header>
        <h3 class="heading-2">Keyboard shortcuts</h3>
        <gr-button link="" @click=${this.handleCloseTap}>Close</gr-button>
      </header>
      <main>
        <div class="column">
          ${this.left?.map((e=>this.renderSection(e)))}
        </div>
        <div class="column">
          ${this.right?.map((e=>this.renderSection(e)))}
        </div>
      </main>
      <footer></footer>
    `}renderSection(e){return dc`<table>
      <caption class="heading-3">
        ${e.section}
      </caption>
      <thead>
        <tr>
          <th><strong>Action</strong></th>
          <th><strong>Key</strong></th>
        </tr>
      </thead>
      <tbody>
        ${e.shortcuts?.map((e=>dc`<tr>
            <td>${e.text}</td>
            <td>
              <gr-key-binding-display .binding=${e.binding}>
              </gr-key-binding-display>
            </td>
          </tr>`))}
      </tbody>
    </table>`}connectedCallback(){super.connectedCallback(),this.getShortcutsService().addListener(this.shortcutListener)}disconnectedCallback(){this.getShortcutsService().removeListener(this.shortcutListener),super.disconnectedCallback()}handleCloseTap(e){e.preventDefault(),e.stopPropagation(),Qn(this,"close",{})}onDirectoryUpdated(e){if(!e)return;const t=[],i=[];e.has(hu.EVERYWHERE)&&t.push({section:hu.EVERYWHERE,shortcuts:e.get(hu.EVERYWHERE)}),e.has(hu.NAVIGATION)&&t.push({section:hu.NAVIGATION,shortcuts:e.get(hu.NAVIGATION)}),e.has(hu.ACTIONS)&&i.push({section:hu.ACTIONS,shortcuts:e.get(hu.ACTIONS)}),e.has(hu.REPLY_DIALOG)&&t.push({section:hu.REPLY_DIALOG,shortcuts:e.get(hu.REPLY_DIALOG)}),e.has(hu.FILE_LIST)&&t.push({section:hu.FILE_LIST,shortcuts:e.get(hu.FILE_LIST)}),e.has(hu.DIFFS)&&i.push({section:hu.DIFFS,shortcuts:e.get(hu.DIFFS)}),this.right=i,this.left=t}};uU([Uc()],gU.prototype,"left",void 0),uU([Uc()],gU.prototype,"right",void 0),gU=uU([Dc("gr-keyboard-shortcuts-dialog")],gU);var mU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const fU=/\${([\w]+)}/g;let vU=class extends Ic{constructor(){super(),this.path="/",this.hasAvatars=!1,this.switchAccountUrl="",this.feedbackURL="",this.getConfigModel=yu(this,Qw),this.handleLocationChange=()=>{this.path=window.location.pathname+window.location.search+window.location.hash},zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.config=e,e?.gerrit?.report_bug_url&&(this.feedbackURL=e?.gerrit.report_bug_url),e&&e.auth&&e.auth.switch_account_url?this.switchAccountUrl=e.auth.switch_account_url:this.switchAccountUrl="",this.hasAvatars=!!(e&&e.plugin&&e.plugin.has_avatars)}))}connectedCallback(){super.connectedCallback(),this.handleLocationChange(),document.addEventListener("location-change",this.handleLocationChange)}disconnectedCallback(){document.removeEventListener("location-change",this.handleLocationChange),super.disconnectedCallback()}static get styles(){return[Nc,Sd`
        gr-dropdown {
          padding: 0 var(--spacing-m);
          --gr-button-text-color: var(--header-text-color);
          --gr-dropdown-item-color: var(--primary-text-color);
        }
        gr-avatar {
          height: 2em;
          width: 2em;
          vertical-align: middle;
        }
        md-icon[filled] {
          font-variation-settings: 'FILL' 1;
        }
      `]}render(){return dc`<gr-dropdown
      link=""
      .items=${this.links}
      .topContent=${this.topContent}
      @tap-item-shortcuts=${this.handleShortcutsTap}
      .horizontalAlign=${"right"}
      .verticalOffset=${40}
    >
      ${this.showMobile&&!this.hasAvatars?dc`<md-icon filled>account_circle</md-icon>`:dc`<span ?hidden=${this.hasAvatars}
            >${this.accountName(this.account)}</span
          >`}
      <gr-avatar
        .account=${this.account}
        ?hidden=${!this.hasAvatars}
        .imageSize=${56}
        aria-label="Account avatar"
      ></gr-avatar>
    </gr-dropdown>`}get links(){return this.getLinks(this.switchAccountUrl,this.path)}get topContent(){return this.getTopContent(this.account)}getLinks(e,t){if(void 0===e||void 0===t)return;const i=[];if(i.push({name:"Settings",id:"settings",url:"/settings/"}),i.push({name:"Keyboard Shortcuts",id:"shortcuts"}),e){const r={path:t},o=this.interpolateUrl(e,r);i.push({name:"Switch account",url:o,external:!0})}return this.showMobile&&this.feedbackURL&&i.push({name:"Feedback",id:"feedback",url:this.feedbackURL,external:!0,target:"_blank"}),i.push({name:"Sign out",id:"signout",url:"/logout"}),i}getTopContent(e){return[{text:this.accountName(e),bold:!0},{text:e?.email?e.email:""}]}handleShortcutsTap(){Jn(this,"show-keyboard-shortcuts",{})}interpolateUrl(e,t){return e.replace(fU,((e,i)=>t[i]||""))}accountName(e){return rx(this.config,e)}};mU([Fc({type:Object})],vU.prototype,"account",void 0),mU([Fc({type:Boolean})],vU.prototype,"showMobile",void 0),mU([Uc()],vU.prototype,"config",void 0),mU([Uc()],vU.prototype,"path",void 0),mU([Uc()],vU.prototype,"hasAvatars",void 0),mU([Uc()],vU.prototype,"switchAccountUrl",void 0),mU([Uc()],vU.prototype,"feedbackURL",void 0),vU=mU([Dc("gr-account-dropdown")],vU);var bU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let yU=class extends Ic{constructor(){super(),this.verticalOffset=31,this.searchQuery="",this.restApiService=Xn().restApiService,this.getConfigModel=yu(this,Qw),this.getNavigation=yu(this,gy),this.getSearchViewModel=yu(this,iE),this.shortcuts=new Gg(this),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.serverConfig=e)),zf(this,(()=>this.getSearchViewModel().query$),(e=>this.searchQuery=e??"")),this.shortcuts.addAbstract(pu.SEARCH,(()=>this.focusAndSelectAll()))}static get styles(){return Sd`
      gr-search-autocomplete {
        --gr-search-bar-border-radius: 50px;
      }
    `}render(){return dc`
      <gr-search-autocomplete
        id="search"
        .value=${this.searchQuery}
        .projectSuggestions=${(e,t)=>this.fetchProjects(e,t)}
        .groupSuggestions=${(e,t)=>this.fetchGroups(e,t)}
        .accountSuggestions=${(e,t)=>jF((e=>this.restApiService.queryAccounts(e,10,void 0,void 0,Ff)),e,t,this.serverConfig)}
        .verticalOffset=${this.verticalOffset}
        @commit=${this.handleInputCommit}
      >
        <gr-icon icon="search" slot="leading-icon" aria-hidden="true"></gr-icon>
      </gr-search-autocomplete>
    `}focusAndSelectAll(){this.searchBar?.focusAndSelectAll()}handleInputCommit(e){if(e.preventDefault(),!this.searchBar)return;const t=this.searchBar.getInput().trim();t&&this.handleSearch(t)}fetchProjects(e,t){return this.restApiService.getSuggestedRepos(t,10,Ff).then((t=>t?Object.keys(t).map((t=>({text:e+":"+t}))):[]))}fetchGroups(e,t){return 0===t.length?Promise.resolve([]):this.restApiService.getSuggestedGroups(t,void 0,10,Ff).then((t=>t?Object.keys(t).map((t=>({text:e+":"+t}))):[]))}handleSearch(e){e&&this.getNavigation().setUrl(tE({query:e}))}};bU([Fc({type:Number})],yU.prototype,"verticalOffset",void 0),bU([Uc()],yU.prototype,"searchQuery",void 0),bU([Uc()],yU.prototype,"serverConfig",void 0),bU([Hc("gr-search-autocomplete")],yU.prototype,"searchBar",void 0),yU=bU([Dc("gr-smart-search")],yU);const wU=new Set(Object.values(pb));class _U extends Ic{get items(){return this.listController.items}constructor(){super(),this.listController=new ub({isItem:e=>e.hasAttribute("md-list-item"),getPossibleItems:()=>this.slotItems,isRtl:()=>"rtl"===getComputedStyle(this).direction,deactivateItem:e=>{e.tabIndex=-1},activateItem:e=>{e.tabIndex=0},isNavigableKey:e=>wU.has(e),isActivatable:e=>!e.disabled&&"text"!==e.type}),this.internals=this.attachInternals(),this.internals.role="list",this.addEventListener("keydown",this.listController.handleKeydown)}render(){return dc`
      <slot
        @deactivate-items=${this.listController.onDeactivateItems}
        @request-activation=${this.listController.onRequestActivation}
        @slotchange=${this.listController.onSlotchange}>
      </slot>
    `}activateNextItem(){return this.listController.activateNextItem()}activatePreviousItem(){return this.listController.activatePreviousItem()}}zg([Vc({flatten:!0})],_U.prototype,"slotItems",void 0);const xU=Sd`:host{background:var(--md-list-container-color, var(--md-sys-color-surface, #fef7ff));color:unset;display:flex;flex-direction:column;outline:none;padding:8px 0;position:relative}
`;let CU=class extends _U{};CU.styles=[xU],CU=zg([Dc("md-list")],CU);const EU=fm(Ic);class SU extends EU{constructor(){super(...arguments),this.disabled=!1,this.type="text",this.isListItem=!0,this.href="",this.target=""}get isDisabled(){return this.disabled&&"link"!==this.type}willUpdate(e){this.href&&(this.type="link"),super.willUpdate(e)}render(){return this.renderListItem(dc`
      <md-item>
        <div slot="container">
          ${this.renderRipple()} ${this.renderFocusRing()}
        </div>
        <slot name="start" slot="start"></slot>
        <slot name="end" slot="end"></slot>
        ${this.renderBody()}
      </md-item>
    `)}renderListItem(e){const t="link"===this.type;let i;switch(this.type){case"link":i=Db`a`;break;case"button":i=Db`button`;break;default:i=Db`li`}const r="text"!==this.type,o=t&&this.target?this.target:uc;return Fb`
      <${i}
        id="item"
        tabindex="${this.isDisabled||!r?-1:0}"
        ?disabled=${this.isDisabled}
        role="listitem"
        aria-selected=${this.ariaSelected||uc}
        aria-checked=${this.ariaChecked||uc}
        aria-expanded=${this.ariaExpanded||uc}
        aria-haspopup=${this.ariaHasPopup||uc}
        class="list-item ${th(this.getRenderClasses())}"
        href=${this.href||uc}
        target=${o}
        @focus=${this.onFocus}
      >${e}</${i}>
    `}renderRipple(){return"text"===this.type?uc:dc` <md-ripple
      part="ripple"
      for="item"
      ?disabled=${this.isDisabled}></md-ripple>`}renderFocusRing(){return"text"===this.type?uc:dc` <md-focus-ring
      @visibility-changed=${this.onFocusRingVisibilityChanged}
      part="focus-ring"
      for="item"
      inward></md-focus-ring>`}onFocusRingVisibilityChanged(e){}getRenderClasses(){return{disabled:this.isDisabled}}renderBody(){return dc`
      <slot></slot>
      <slot name="overline" slot="overline"></slot>
      <slot name="headline" slot="headline"></slot>
      <slot name="supporting-text" slot="supporting-text"></slot>
      <slot
        name="trailing-supporting-text"
        slot="trailing-supporting-text"></slot>
    `}onFocus(){-1===this.tabIndex&&this.dispatchEvent(new Event("request-activation",{bubbles:!0,composed:!0}))}focus(){this.listItemRoot?.focus()}click(){this.listItemRoot?this.listItemRoot.click():super.click()}}SU.shadowRootOptions={...Ic.shadowRootOptions,delegatesFocus:!0},zg([Fc({type:Boolean,reflect:!0})],SU.prototype,"disabled",void 0),zg([Fc({reflect:!0})],SU.prototype,"type",void 0),zg([Fc({type:Boolean,attribute:"md-list-item",reflect:!0})],SU.prototype,"isListItem",void 0),zg([Fc()],SU.prototype,"href",void 0),zg([Fc()],SU.prototype,"target",void 0),zg([Hc(".list-item")],SU.prototype,"listItemRoot",void 0);const $U=Sd`:host{display:flex;-webkit-tap-highlight-color:rgba(0,0,0,0);--md-ripple-hover-color: var(--md-list-item-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-list-item-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-list-item-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-opacity: var(--md-list-item-pressed-state-layer-opacity, 0.12)}:host(:is([type=button]:not([disabled]),[type=link])){cursor:pointer}md-focus-ring{z-index:1;--md-focus-ring-shape: 8px}a,button,li{background:none;border:none;cursor:inherit;padding:0;margin:0;text-align:unset;text-decoration:none}.list-item{border-radius:inherit;display:flex;flex:1;max-width:inherit;min-width:inherit;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%}.list-item.interactive{cursor:pointer}.list-item.disabled{opacity:var(--md-list-item-disabled-opacity, 0.3);pointer-events:none}[slot=container]{pointer-events:none}md-ripple{border-radius:inherit}md-item{border-radius:inherit;flex:1;height:100%;color:var(--md-list-item-label-text-color, var(--md-sys-color-on-surface, #1d1b20));font-family:var(--md-list-item-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-list-item-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));line-height:var(--md-list-item-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));font-weight:var(--md-list-item-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));min-height:var(--md-list-item-one-line-container-height, 56px);padding-top:var(--md-list-item-top-space, 12px);padding-bottom:var(--md-list-item-bottom-space, 12px);padding-inline-start:var(--md-list-item-leading-space, 16px);padding-inline-end:var(--md-list-item-trailing-space, 16px)}md-item[multiline]{min-height:var(--md-list-item-two-line-container-height, 72px)}[slot=supporting-text]{color:var(--md-list-item-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-list-item-supporting-text-font, var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-list-item-supporting-text-size, var(--md-sys-typescale-body-medium-size, 0.875rem));line-height:var(--md-list-item-supporting-text-line-height, var(--md-sys-typescale-body-medium-line-height, 1.25rem));font-weight:var(--md-list-item-supporting-text-weight, var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400)))}[slot=trailing-supporting-text]{color:var(--md-list-item-trailing-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-list-item-trailing-supporting-text-font, var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-list-item-trailing-supporting-text-size, var(--md-sys-typescale-label-small-size, 0.6875rem));line-height:var(--md-list-item-trailing-supporting-text-line-height, var(--md-sys-typescale-label-small-line-height, 1rem));font-weight:var(--md-list-item-trailing-supporting-text-weight, var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500)))}:is([slot=start],[slot=end])::slotted(*){fill:currentColor}[slot=start]{color:var(--md-list-item-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}[slot=end]{color:var(--md-list-item-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}@media(forced-colors: active){.disabled slot{color:GrayText}.list-item.disabled{color:GrayText;opacity:1}}
`;let kU=class extends SU{};kU.styles=[$U],kU=zg([Dc("md-list-item")],kU);var AU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const RU=[{title:"Changes",links:[{url:"/q/status:open+-is:wip",name:"Open"},{url:"/q/status:merged",name:"Merged"},{url:"/q/status:abandoned",name:"Abandoned"}]}],TU=[{url:"/index.html",name:"Table of Contents"},{url:"/user-search.html",name:"Searching"},{url:"/user-upload.html",name:"Uploading"},{url:"/access-control.html",name:"Access Control"},{url:"/rest-api.html",name:"REST API"},{url:"/intro-project-owner.html",name:"Project Owner Guide"}],IU=new Set([Pu.LDAP,Pu.LDAP_BIND,Pu.CUSTOM_EXTENSION]);let PU=class extends Ic{constructor(){super(),this.loginUrl="",this.loginText="",this.adminLinks=[],this.docsBaseUrl="",this.userLinks=[],this.topMenus=[],this.registerText="Sign up",this.registerURL="",this.feedbackURL="",this.hamburgerClose=!1,this.mobileSearch=!1,this.restApiService=Xn().restApiService,this.getPluginLoader=yu(this,U_),this.getUserModel=yu(this,jf),this.getConfigModel=yu(this,Qw),this.handleBodyClick=e=>{const t=e.composedPath();t&&(t.find((e=>An(e)&&"GR-MAIN-HEADER"===e.tagName.toUpperCase()))||(this.mobileSearch=!1))},zf(this,(()=>this.getUserModel().myMenuItems$),(e=>this.userLinks=e.map(this.createHeaderLink))),zf(this,(()=>this.getConfigModel().loginUrl$),(e=>this.loginUrl=e)),zf(this,(()=>this.getConfigModel().loginText$),(e=>this.loginText=e)),zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e)),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{e&&(this.retrieveFeedbackURL(e),this.retrieveRegisterURL(e))}))}connectedCallback(){super.connectedCallback(),document.addEventListener("click",this.handleBodyClick),this.loadAccount()}disconnectedCallback(){document.removeEventListener("click",this.handleBodyClick),super.disconnectedCallback()}static get styles(){return[Nc,Sd`
        :host {
          display: block;
        }
        .hideOnDesktop {
          display: none;
        }
        nav.hideOnMobile {
          align-items: center;
          display: flex;
        }
        nav.hideOnMobile ul {
          list-style: none;
          padding-left: var(--spacing-l);
        }
        nav.hideOnMobile .links > li {
          cursor: default;
          display: inline-block;
          padding: 0;
          position: relative;
        }
        .mobileTitle {
          display: none;
        }
        .bigTitle {
          color: var(--header-text-color);
          font-size: var(--header-title-font-size);
          line-height: calc(var(--header-title-font-size) * 1.2);
          text-decoration: none;
          display: block;
          flex: 1 1 auto;
          flex-grow: 0;
          justify-content: center;
          overflow: hidden;
          max-width: 30%;
          text-decoration: none;
        }
        .bigTitle:hover {
          text-decoration: underline;
        }
        .mobileTitleWrapper {
          position: absolute;
          left: 100px;
          right: 100px;
          overflow: hidden;
          display: flex;
          justify-content: center;
        }
        .titleText {
          display: flex;
          align-items: center;
          min-width: 0;
          overflow: hidden;
        }
        .titleText::before {
          --icon-width: var(--header-icon-width, var(--header-icon-size, 0));
          --icon-height: var(--header-icon-height, var(--header-icon-size, 0));
          background-image: var(--header-icon);
          background-size: var(--icon-width) var(--icon-height);
          background-repeat: no-repeat;
          content: '';
          /* Any direct child of a flex element implicitly has 'display: block', but let's make that explicit here. */
          display: inline-block;
          width: var(--mobile-icon-width, var(--icon-width));
          height: var(--mobile-icon-height, var(--icon-height));
          /* If size or height are set, then use 'spacing-m', 0px otherwise. */
          margin-right: clamp(
            0px,
            var(--mobile-icon-height, var(--icon-height)),
            var(--spacing-m)
          );
          flex-shrink: 0;
        }
        .titleText::after {
          /* The height will be determined by the line-height of the .bigTitle element. */
          content: var(--header-title-content);
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          flex: 1;
          min-width: 0;
        }

        .linksTitle {
          display: inline-block;
          font-weight: var(--font-weight-medium);
          position: relative;
          text-transform: uppercase;
        }
        .linksTitle:hover {
          opacity: 0.75;
        }
        .rightItems {
          align-items: center;
          display: flex;
          flex: 1;
          justify-content: flex-end;
        }
        .mobileRightItems {
          align-items: center;
          justify-content: flex-end;
          display: inline-flex;
          vertical-align: middle;
          position: relative;
          top: 0px;
          right: 0px;
          margin-right: 0;
          margin-left: auto;
          min-height: 50px;
        }
        .rightItems gr-endpoint-decorator:not(:empty),
        .mobileRightItems gr-endpoint-decorator:not(:empty) {
          margin-left: var(--spacing-s);
        }
        gr-smart-search {
          flex-grow: 1;
          margin: 0 var(--spacing-m);
          max-width: 500px;
          min-width: 150px;
          height: 36px;
          --gr-autocomplete-height: 36px;
        }
        gr-dropdown,
        .browse {
          padding: var(--spacing-m);
        }
        gr-dropdown {
          --gr-dropdown-item-color: var(--primary-text-color);
        }
        .browse {
          color: var(--header-text-color);
          /* Same as gr-button */
          margin: 5px 4px;
          text-decoration: none;
        }
        .invisible,
        gr-account-dropdown,
        .settingsButton {
          display: none;
        }
        :host([loading]) .accountContainer,
        :host([loggedIn]) .loginButton,
        :host([loggedIn]) .registerButton,
        :host([loggedIn]) .moreMenu {
          display: none;
        }
        :host([loggedIn]) .settingsButton {
          display: flex;
        }
        :host([loggedIn]) gr-account-dropdown {
          display: inline;
        }
        :host:not([loggedIn]) .moreMenu {
          display: inline;
        }
        .accountContainer {
          flex: 0 0 auto;
          align-items: center;
          display: flex;
          margin: 0 calc(0 - var(--spacing-m)) 0 var(--spacing-m);
          text-overflow: ellipsis;
          white-space: nowrap;
        }
        .loginButton,
        .registerButton {
          padding: var(--spacing-m) var(--spacing-l);
        }
        .dropdown-trigger {
          text-decoration: none;
        }
        .dropdown-content {
          background-color: var(--view-background-color);
          box-shadow: var(--elevation-level-2);
        }
        /*
          * We are not using :host to do this, because :host has a lowest css priority
          * compared to others. This means that using :host to do this would break styles.
          */
        .linksTitle,
        .bigTitle,
        .loginButton,
        .registerButton,
        gr-dropdown,
        gr-account-dropdown {
          --gr-button-text-color: var(--header-text-color);
          color: var(--header-text-color);
        }
        .hamburger-open {
          --gr-button-text-color: var(--primary-text-color);
          color: var(--primary-text-color);
        }
        md-icon-button {
          --md-sys-color-on-surface-variant: var(--header-text-color);
        }
        md-icon[filled] {
          font-variation-settings: 'FILL' 1;
        }
        nav.hideOnMobile,
        nav .nav-header {
          border-bottom: var(--header-border-bottom);
          border-image: var(--header-border-image);
          box-shadow: var(--header-box-shadow);
          padding: var(--header-padding);
          min-height: 48px;
        }
        @media screen and (max-width: 50em) {
          .bigTitle {
            font-family: var(--header-font-family);
            font-size: 20px;
            font-weight: var(--font-weight-h3);
            line-height: var(--line-height-h3);
            min-width: 0;
            max-width: unset;
          }
          .titleText::before {
            --icon-width: var(
              --header-icon-width,
              var(--header-mobile-icon-size, var(--header-icon-size, 0))
            );
            --icon-height: var(
              --header-icon-height,
              var(--header-mobile-icon-size, var(--header-icon-size, 0))
            );
            background-image: var(--header-mobile-icon, var(--header-icon));
            background-size: var(--mobile-icon-width, var(--icon-width))
              var(--mobile-icon-height, var(--icon-height));
            width: var(--mobile-icon-width, var(--icon-width));
            height: var(--mobile-icon-height, var(--icon-height));
          }
          .titleText::after {
            /* The height will be determined by the line-height of the .bigTitle element. */
            content: var(
              --header-mobile-title-content,
              var(--header-title-content)
            );
          }
          .browse,
          .rightItems .hideOnMobile,
          .links > li.hideOnMobile {
            display: none;
          }
          .accountContainer {
            margin-left: var(--spacing-m) !important;
          }
          gr-dropdown {
            padding: 0 var(--spacing-m);
          }
          .nav-sidebar {
            background: var(--table-header-background-color);
            width: 200px;
            height: 100%;
            display: block;
            position: absolute;
            left: -200px;
            transition: left 0.25s ease;
            overflow-y: auto;
            overflow-x: hidden;
            box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
            z-index: 2;
            padding-bottom: 56px;
          }
          .nav-sidebar.visible {
            left: 0px;
            transition: left 0.25s ease;
            width: 50%;
            z-index: 200;
            box-shadow: var(--header-box-shadow);
          }
          .nav-header {
            display: flex;
            align-items: center;
          }
          .hamburger {
            display: inline-block;
            vertical-align: middle;
            height: 50px;
            cursor: pointer;
            margin: 0;
            position: absolute;
            top: 0;
            left: 0;
            padding: 12px;
            z-index: 200;
          }
          .modelBackground {
            background: rgba(0, 0, 0, 0.5);
            position: absolute;
            height: 100%;
            overflow: none;
            z-index: 199;
            width: 100%;
          }
          .transparent {
            background: rgba(0, 0, 0, 0);
          }
          .hideOnDesktop {
            display: block;
          }
          nav.hideOnMobile {
            display: none;
          }
          md-list {
            --md-list-container-color: transparent;
            display: block;
            margin-inline: 12px;
            min-width: unset;
            --md-sys-typescale-body-large-size: inherit;
            --md-sys-color-on-surface: var(--primary-text-color);
          }
          md-list-item {
            font-size: 16px;
            --md-list-item-label-text-font: inherit;
          }
          md-list a md-list-item::part(focus-ring) {
            --md-focus-ring-shape: 28px;
          }
          md-list a md-list-item {
            margin-block: 12px;
            display: block;
            --md-focus-ring-shape: 28px;
            border-radius: 28px;
          }
          md-list md-item [slot='headline'] {
            /* shadow root slot has overflow:hidden, it's cutting some text off */
            padding-block: 2px;
          }
          md-list md-item:first-of-type {
            padding-block: 0;
          }
          md-list md-item {
            font-size: 24px;
            padding-block-end: 0;
          }
          md-list md-item + a md-list-item {
            margin-block-start: 0;
          }
          .itemAction:link,
          .itemAction:visited {
            text-decoration: none;
          }
          @media (forced-colors: active) {
            md-list a md-list-item[selected] {
              border: 4px double CanvasText;
            }
            md-list a md-list-item {
              border-radius: 28px;
              border: 1px solid CanvasText;
            }
          }
        }
      `]}render(){return dc` ${this.renderDesktop()} ${this.renderMobile()} `}renderDesktop(){return dc`
      <nav class="hideOnMobile">
        <a href=${`//${window.location.host}${Sf()}/`} class="bigTitle">
          <gr-endpoint-decorator name="header-title">
            <div class="titleText"></div>
          </gr-endpoint-decorator>
        </a>
        <ul class="links">
          ${this.computeLinks(this.userLinks,this.adminLinks,this.topMenus).map((e=>this.renderLinkGroup(e)))}
        </ul>
        <div class="rightItems">
          <gr-endpoint-decorator
            class="hideOnMobile"
            name="header-small-banner"
          ></gr-endpoint-decorator>
          <gr-smart-search id="search" .verticalOffset=${40}></gr-smart-search>
          <gr-endpoint-decorator
            class="hideOnMobile"
            name="header-top-right"
          ></gr-endpoint-decorator>
          <!--
          Always render the fallback feedback button, but hide it with CSS if feedbackURL is empty.
          We do this instead of using Lit's conditional rendering (e.g., ?hidden or if) inside
          <gr-endpoint-decorator>, because the plugin system may replace or remove this content
          outside of Lit's control. If Lit tries to update a node that was removed by the plugin
          system, it will throw an error. By always rendering the node and only hiding it, we
          avoid this issue and ensure plugin compatibility.
          -->
          <gr-endpoint-decorator class="feedbackButton" name="header-feedback">
            <md-icon-button
              touch-target="none"
              href=${this.feedbackURL}
              title="File a bug"
              aria-label="File a bug"
              target="_blank"
              ?hidden=${!this.feedbackURL}
              @click=${e=>{const t=e.composedPath().find((e=>e instanceof HTMLElement&&"md-icon-button"===e.tagName.toLowerCase())),i=t?.shadowRoot?.querySelector("a");i?.setAttribute("rel","noopener noreferrer")}}
            >
              <md-icon filled>bug_report</md-icon>
            </md-icon-button>
          </gr-endpoint-decorator>
        </div>
        ${this.renderAccount()}
      </nav>
    `}renderMobile(){const e=[{name:this.registerText,url:this.registerURL},{name:this.loginText,url:this.loginUrl}];this.registerURL||e.shift(),this.feedbackURL&&e.push({name:"Feedback",url:this.feedbackURL,external:!0,target:"_blank"});const t=this.computeLinks(this.userLinks,this.adminLinks,this.topMenus);return dc`
      <nav class="hideOnDesktop">
        ${eb(this.mobileSearch,(()=>dc` <div class="nav-header">
            <md-icon-button
              touch-target="none"
              aria-label="Back"
              @click=${()=>{this.mobileSearch=!1}}
            >
              <md-icon filled>arrow_back</md-icon>
            </md-icon-button>
            <gr-smart-search
              id="search"
              .verticalOffset=${40}
            ></gr-smart-search>
          </div>`))}
        ${eb(!this.mobileSearch,(()=>dc`
            <div class="nav-header">
              <md-icon-button
                touch-target="none"
                aria-label="${this.hamburgerClose?"Close":"Open"} hamburger"
                @click=${()=>{this.handleSidebar()}}
              >
                <md-icon filled
                  >${this.hamburgerClose?"menu_open":"menu"}</md-icon
                >
              </md-icon-button>
              <div class="mobileTitleWrapper">
                <a
                  href=${`//${window.location.host}${Sf()}/`}
                  class="bigTitle"
                  @click=${()=>{this.hamburgerClose&&this.handleSidebar()}}
                >
                  <gr-endpoint-decorator name="header-mobile-title">
                    <div class="titleText"></div>
                  </gr-endpoint-decorator>
                </a>
              </div>
              <div class="mobileRightItems">
                <md-icon-button
                  touch-target="none"
                  title="Search"
                  aria-label=${this.mobileSearch?"Hide Search Bar":"Show Search Bar"}
                  @click=${()=>{this.mobileSearch=!this.mobileSearch,this.hamburgerClose&&this.handleSidebar()}}
                >
                  <md-icon filled>search</md-icon>
                </md-icon-button>
                <gr-dropdown
                  class="moreMenu"
                  link=""
                  .items=${e}
                  .horizontalAlign=${"right"}
                  .verticalOffset=${40}
                  @click=${()=>{this.hamburgerClose&&this.handleSidebar()}}
                >
                  <span class="linksTitle">
                    <md-icon filled>more_horiz</md-icon>
                  </span>
                </gr-dropdown>
                ${this.renderAccountDropdown(!0)}
              </div>
            </div>
            <div class="nav-sidebar">
              <md-list aria-label="menu links">
                ${t.map(((e,i)=>this.renderLinkGroupMobile(e,i,t.length)))}
              </md-list>
            </div>
            ${this.hamburgerClose?dc`<div
                  class="modelBackground"
                  @click=${()=>this.handleSidebar()}
                ></div>`:uc}
          `))}
      </nav>
    `}renderLinkGroup(e){return dc`
      <li class=${e.class??""}>
        <gr-dropdown
          link
          down-arrow
          .items=${e.links}
          horizontal-align="left"
        >
          <span class="linksTitle" id=${e.title}>
            ${e.title}
          </span>
        </gr-dropdown>
      </li>
    `}renderLinkGroupMobile(e,t,i){return dc`
      <md-item><div slot="headline">${e.title}</div></md-item>
      ${e.links.map((e=>this.renderLinkMobile(e)))}
      ${t<i-1?dc`<md-divider role="separator" tabindex="-1"></md-divider>`:uc}
    `}renderLinkMobile(e){return dc`
      <a
        class="itemAction"
        href=${Vw(this.computeLinkURL(e))}
        ?download=${!!e.download}
        rel=${Vw(this.computeLinkRel(e)??void 0)}
        target=${Vw(e.target??void 0)}
        tabindex="-1"
      >
        <md-list-item type="button" @click=${()=>this.handleSidebar()}>
          ${e.name}
        </md-list-item></a
      >
    `}renderAccount(){return dc`
      <div class="accountContainer" id="accountContainer">
        ${this.renderRegister()}
        <gr-endpoint-decorator name="auth-link">
          <a class="loginButton" href=${this.loginUrl}>${this.loginText}</a>
        </gr-endpoint-decorator>
        <md-icon-button
          class="settingsButton"
          touch-target="none"
          href="${Sf()}/settings/"
          title="Settings"
          aria-label="Settings"
        >
          <md-icon filled>settings</md-icon>
        </md-icon-button>
        ${this.renderAccountDropdown()}
      </div>
    `}renderRegister(){if(this.registerURL)return dc`
      <div class="registerDiv">
        <a class="registerButton" href=${this.registerURL}>
          ${this.registerText}
        </a>
      </div>
    `}renderAccountDropdown(e){if(this.account)return dc`
      <gr-account-dropdown
        .account=${this.account}
        ?showMobile=${!!e}
        @click=${()=>{this.hamburgerClose&&this.handleSidebar()}}
      ></gr-account-dropdown>
    `}firstUpdated(e){super.firstUpdated(e),this.getAttribute("role")||this.setAttribute("role","banner")}reload(){this.loadAccount()}computeLinks(e,t,i,r=RU){if(void 0===e||void 0===t||void 0===i)return[];const o=r.map((e=>({title:e.title,links:e.links.slice()})));e&&e.length>0&&o.push({title:"Your",links:e.slice()});const s=(n=this.docsBaseUrl)?TU.map((e=>({url:$f(n,e.url),name:e.name,target:"_blank"}))):[];var n;s.length&&o.push({title:"Documentation",links:s}),o.push({title:"Browse",links:t.slice()});const a={};o.forEach((e=>{a[e.title]=e.links}));for(const e of i){const t=e.items.map(this.createHeaderLink).filter((e=>!e.url.includes("${projectName}")));e.name in a?t.forEach((t=>{a[e.name].push(t)})):t.length>0&&o.push({title:e.name,links:a[e.name]=t})}return o}loadAccount(){return this.loading=!0,Promise.all([this.restApiService.getAccount(),this.restApiService.getTopMenus(),this.getPluginLoader().awaitPluginsLoaded()]).then((e=>{const t=e[0];return this.account=t,this.loggedIn=!!t,this.loading=!1,this.topMenus=e[1],Sw(t,(()=>this.restApiService.getAccountCapabilities().then((e=>{if(!e)throw new Error("getAccountCapabilities returns undefined");return e}))),(()=>this.getPluginLoader().jsApiService.getAdminMenuLinks())).then((e=>{this.adminLinks=e.links}))}))}retrieveFeedbackURL(e){e.gerrit?.report_bug_url&&(this.feedbackURL=e.gerrit.report_bug_url)}retrieveRegisterURL(e){IU.has(e.auth.auth_type)&&(this.registerURL=e.auth.register_url??"",e.auth.register_text&&(this.registerText=e.auth.register_text))}createHeaderLink(e){const t={...e};return t.url.startsWith("#")&&(t.url=e.url.slice(1)),t}computeURLHelper(e,t){return"//"+e+(t.startsWith(Sf())?"":Sf())+t}computeRelativeURL(e){const t=window.location.host;return this.computeURLHelper(t,e)}computeLinkURL(e){if(void 0!==e.url)return e.target||!e.url.startsWith("/")?e.url:this.computeRelativeURL(e.url)}computeLinkRel(e){return e.target?"noopener":e.external?"external":null}handleSidebar(){this.navSidebar?.classList.toggle("visible"),this.modelBackground?document.getElementsByTagName("html")&&(document.getElementsByTagName("html")[0].style.overflow=""):document.getElementsByTagName("html")&&(document.getElementsByTagName("html")[0].style.overflow="hidden"),this.hamburgerClose=!this.hamburgerClose}};AU([Fc({type:Boolean,reflect:!0})],PU.prototype,"loggedIn",void 0),AU([Fc({type:Boolean,reflect:!0})],PU.prototype,"loading",void 0),AU([Uc()],PU.prototype,"loginUrl",void 0),AU([Uc()],PU.prototype,"loginText",void 0),AU([Uc()],PU.prototype,"account",void 0),AU([Uc()],PU.prototype,"adminLinks",void 0),AU([Uc()],PU.prototype,"docsBaseUrl",void 0),AU([Uc()],PU.prototype,"userLinks",void 0),AU([Uc()],PU.prototype,"topMenus",void 0),AU([Uc()],PU.prototype,"registerText",void 0),AU([Uc()],PU.prototype,"registerURL",void 0),AU([Uc()],PU.prototype,"feedbackURL",void 0),AU([Uc()],PU.prototype,"hamburgerClose",void 0),AU([Uc()],PU.prototype,"mobileSearch",void 0),AU([Hc(".nav-sidebar")],PU.prototype,"navSidebar",void 0),AU([Hc(".modelBackground")],PU.prototype,"modelBackground",void 0),PU=AU([Dc("gr-main-header")],PU);var NU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let OU=class extends Ic{get patchRange(){if(this.patchNum)return{patchNum:this.patchNum,basePatchNum:this.basePatchNum}}constructor(){super(),this.reviewed=!1,this.sidebarHeight=0,this.basePatchNum=Qu,this.files={sortedPaths:[],changeFilesByPath:{}},this.isActiveChildView=!1,this.allowBlame=!1,this.loggedIn=!1,this.isBlameLoading=!1,this.leftSide=!1,this.commentsForPath=[],this.isShowingEntireFile=!1,this.reviewedFiles=new Set,this.reporting=Xn().reportingService,this.getUserModel=yu(this,jf),this.getChangeModel=yu(this,MT),this.getCommentsModel=yu(this,kP),this.getFilesModel=yu(this,NM),this.getShortcutsService=yu(this,Bg),this.getViewModel=yu(this,XC),this.getConfigModel=yu(this,Qw),this.hasShownNavigateToFileToast=new Map,this.shortcutsController=new Gg(this),this.updateSidebarHeight=()=>{this.sidebarAnchor&&(this.sidebarHeight=window.innerHeight-this.sidebarAnchor.getBoundingClientRect().bottom)},this.lastDisplayedNavigateToFileToast=new Map,this.setupKeyboardShortcuts(),this.setupSubscriptions(),zf(this,(()=>this.getFilesModel().filesIncludingUnmodified$),(e=>{const t={};for(const i of e)t[i.__path]=i;this.files={sortedPaths:e.map((e=>e.__path)),changeFilesByPath:t}}))}setupKeyboardShortcuts(){const e=(e,t)=>{this.shortcutsController.addAbstract(e,t)};e(pu.LEFT_PANE,(e=>this.cursor?.moveLeft())),e(pu.RIGHT_PANE,(e=>this.cursor?.moveRight())),e(pu.NEXT_LINE,(e=>this.handleNextLine())),e(pu.PREV_LINE,(e=>this.handlePrevLine())),e(pu.VISIBLE_LINE,(e=>this.cursor?.moveToVisibleArea())),e(pu.NEXT_FILE_WITH_COMMENTS,(e=>this.moveToFileWithComment(1))),e(pu.PREV_FILE_WITH_COMMENTS,(e=>this.moveToFileWithComment(-1))),e(pu.NEW_COMMENT,(e=>this.handleNewComment())),e(pu.SAVE_COMMENT,(e=>{})),e(pu.NEXT_FILE,(e=>this.handleNextFile())),e(pu.PREV_FILE,(e=>this.handlePrevFile())),e(pu.NEXT_CHUNK,(e=>this.handleNextChunk())),e(pu.PREV_CHUNK,(e=>this.handlePrevChunk())),e(pu.NEXT_COMMENT_THREAD,(e=>this.handleNextCommentThread())),e(pu.PREV_COMMENT_THREAD,(e=>this.handlePrevCommentThread())),e(pu.OPEN_REPLY_DIALOG,(e=>this.handleOpenReplyDialog())),e(pu.TOGGLE_LEFT_PANE,(e=>this.handleToggleLeftPane())),e(pu.OPEN_DOWNLOAD_DIALOG,(e=>this.handleOpenDownloadDialog())),e(pu.UP_TO_CHANGE,(e=>this.getChangeModel().navigateToChange())),e(pu.OPEN_DIFF_PREFS,(e=>this.handleCommaKey())),e(pu.TOGGLE_DIFF_MODE,(e=>this.handleToggleDiffMode())),e(pu.TOGGLE_FILE_REVIEWED,(e=>{this.throttledToggleFileReviewed&&this.throttledToggleFileReviewed(e)})),e(pu.TOGGLE_ALL_DIFF_CONTEXT,(e=>this.handleToggleAllDiffContext())),e(pu.TOGGLE_HIDE_CHECK_CODE_POINTERS,(e=>this.handleToggleHideCheckCodePointers())),e(pu.NEXT_UNREVIEWED_FILE,(e=>this.handleNextUnreviewedFile())),e(pu.TOGGLE_BLAME,(e=>this.toggleBlame())),e(pu.TOGGLE_HIDE_ALL_COMMENT_THREADS_AND_CODE_POINTERS,(e=>this.handleToggleHideAllCommentsAndCodePointers())),e(pu.OPEN_FILE_LIST,(e=>this.handleOpenFileList())),e(pu.DIFF_AGAINST_BASE,(e=>this.handleDiffAgainstBase())),e(pu.DIFF_AGAINST_LATEST,(e=>this.handleDiffAgainstLatest())),e(pu.DIFF_BASE_AGAINST_LEFT,(e=>this.handleDiffBaseAgainstLeft())),e(pu.DIFF_RIGHT_AGAINST_LATEST,(e=>this.handleDiffRightAgainstLatest())),e(pu.DIFF_BASE_AGAINST_LATEST,(e=>this.handleDiffBaseAgainstLatest())),e(pu.EXPAND_ALL_COMMENT_THREADS,(e=>{})),e(pu.COLLAPSE_ALL_COMMENT_THREADS,(e=>{}))}setupSubscriptions(){zf(this,(()=>this.getUserModel().loggedIn$),(e=>{this.loggedIn=e})),zf(this,(()=>this.getCommentsModel().changeComments$),(e=>{this.changeComments=e})),zf(this,(()=>this.getUserModel().preferences$),(e=>{this.userPrefs=e})),zf(this,(()=>this.getUserModel().diffPreferences$),(e=>{this.prefs=e})),zf(this,(()=>this.getChangeModel().change$),(e=>{e&&(this.change=e)})),zf(this,(()=>this.getChangeModel().latestPatchNum$),(e=>this.latestPatchNum=e)),zf(this,(()=>this.getChangeModel().reviewedFiles$),(e=>{this.reviewedFiles=new Set(e)??new Set})),zf(this,(()=>this.getViewModel().changeNum$),(e=>{e&&this.changeNum!==e&&(this.changeNum||(this.changeNum=e))})),zf(this,(()=>this.getViewModel().childView$),(e=>this.isActiveChildView=e===zC.DIFF)),zf(this,(()=>this.getViewModel().diffPath$),(e=>this.path=e)),zf(this,(()=>this.getFilesModel().file$(this.getViewModel().diffPath$)),(e=>this.file=e)),zf(this,(()=>this.getViewModel().diffLine$),(e=>this.focusLineNum=e)),zf(this,(()=>this.getViewModel().diffLeftSide$),(e=>this.leftSide=e)),zf(this,(()=>this.getViewModel().patchNum$),(e=>this.patchNum=e)),zf(this,(()=>this.getViewModel().basePatchNum$),(e=>this.basePatchNum=e??Qu)),zf(this,(()=>Yh([this.getViewModel().diffPath$,this.getChangeModel().reviewedFiles$])),(([e,t])=>{this.reviewed=!!e&&!!t&&t.includes(e)})),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>this.allowBlame=e?.change.allow_blame??!1)),zf(this,(()=>this.getViewModel().diffPath$.pipe($p((e=>!!e)),Vp((()=>Yh([this.getChangeModel().patchNum$,this.getViewModel().childView$,this.getUserModel().diffPreferences$,this.getChangeModel().reviewedFiles$]).pipe($p((([e,t,i,r])=>!!e&&t===zC.DIFF&&!!i&&!!r)),Rp(1)))))),(([e,t,i])=>{ba(e,"patchNum"),this.setReviewedStatus(e,i)}))}static get styles(){return[vy,yO,Nc,Iw,Jy,Sd`
        :host {
          display: block;
          background-color: var(--view-background-color);
          --sidebar-width: 300px;
        }
        .hidden {
          display: none;
        }
        gr-patch-range-select {
          display: block;
        }
        gr-diff {
          border: none;
        }
        .stickyHeader {
          background-color: var(--view-background-color);
          position: sticky;
          top: 0;
          /* sidebar should outrank <footer> in GrAppElement */
          z-index: 110;
          box-shadow: var(--elevation-level-1);
          /* This is just for giving the box-shadow some space. */
          margin-bottom: 2px;
        }
        header,
        .subHeader {
          align-items: center;
          display: flex;
          justify-content: space-between;
        }
        header {
          padding: var(--spacing-s) var(--spacing-xl);
          border-bottom: 1px solid var(--border-color);
        }
        .changeNumberColon {
          color: transparent;
        }
        .headerSubject {
          margin-right: var(--spacing-m);
          font-weight: var(--font-weight-medium);
        }
        .patchRangeLeft {
          align-items: center;
          display: flex;
        }
        .navLink:not([href]) {
          color: var(--deemphasized-text-color);
        }
        .navLinks {
          align-items: center;
          display: flex;
          white-space: nowrap;
        }
        .navLink {
          padding: 0 var(--spacing-xs);
        }
        .reviewed {
          display: inline-block;
          margin: 0 var(--spacing-xs);
          vertical-align: top;
          position: relative;
          top: 8px;
        }
        .jumpToFileContainer {
          display: inline-block;
          word-break: break-all;
        }
        .mobile {
          display: none;
        }
        gr-button {
          padding: var(--spacing-s) 0;
          text-decoration: none;
        }
        .loading {
          color: var(--deemphasized-text-color);
          font-family: var(--header-font-family);
          font-size: var(--font-size-h1);
          font-weight: var(--font-weight-h1);
          line-height: var(--line-height-h1);
          height: 100%;
          padding: var(--spacing-l);
          text-align: center;
        }
        .subHeader {
          background-color: var(--background-color-secondary);
          flex-wrap: wrap;
          padding: 0 var(--spacing-l);
        }
        .prefsButton {
          text-align: right;
        }
        .editMode .hideOnEdit {
          display: none;
        }
        .fileNum {
          display: none;
        }
        .blameLoader,
        .fileNum.show,
        .download,
        .preferences,
        .rightControls {
          align-items: center;
          display: flex;
        }
        .diffModeSelector,
        .editButton {
          align-items: center;
          display: flex;
        }
        .diffModeSelector span,
        .editButton span {
          margin-right: var(--spacing-xs);
        }
        .diffModeSelector.hide,
        .separator.hide {
          display: none;
        }
        .editButtona a {
          text-decoration: none;
        }
        @media screen and (max-width: 50em) {
          header {
            padding: var(--spacing-s) var(--spacing-l);
          }
          .dash {
            display: none;
          }
          .desktop {
            display: none;
          }
          .fileNav {
            align-items: flex-start;
            display: flex;
            margin: 0 var(--spacing-xs);
          }
          .fullFileName {
            display: block;
            font-style: italic;
            min-width: 50%;
            padding: 0 var(--spacing-xxs);
            text-align: center;
            width: 100%;
            word-wrap: break-word;
          }
          .mobileNavLink {
            color: var(--primary-text-color);
            font-family: var(--header-font-family);
            font-size: var(--font-size-h2);
            font-weight: var(--font-weight-h2);
            line-height: var(--line-height-h2);
            text-decoration: none;
          }
          .mobileNavLink:not([href]) {
            color: var(--deemphasized-text-color);
          }
          /* prettier formatter removes semi-colons after css mixins. */
          /* prettier-ignore */
          gr-dropdown-list {
            width: 100%;
          }
        }
        :host(.hideComments) {
          --gr-comment-thread-display: none;
        }
        :host(.hideCheckCodePointers) {
          --gr-check-code-pointers-display: none;
        }
        .diffContainer.sidebarOpen {
          margin-left: var(--sidebar-width);
        }
        .sidebarTriggerContainer {
          display: inline-block;
          margin-right: var(--spacing-m);
        }
        .sidebarAnchor {
          height: 0;
          width: 0;
          overflow: visible;
        }
        .sidebarContents {
          background: var(--background-color-secondary);
          width: var(--sidebar-width);
          border: var(--spacing-xxs) solid var(--border-color);
          border-left: 0;
          overflow: auto;
        }
        md-checkbox {
          --md-checkbox-container-size: 15px;
          --md-checkbox-icon-size: 15px;
        }
      `]}connectedCallback(){super.connectedCallback(),this.throttledToggleFileReviewed=dy((e=>this.handleToggleFileReviewed())),this.addEventListener("open-fix-preview",(e=>this.onOpenFixPreview(e))),this.cursor=new RM,this.diffHost&&this.reInitCursor(),window.addEventListener("scroll",this.updateSidebarHeight),window.addEventListener("resize",this.updateSidebarHeight),this.getUserModel().preferences$.pipe(ep((e=>e.diff_page_sidebar)),Rp(1)).toPromise().then((e=>{this.shownSidebar="NONE"===e||void 0===e?void 0:e.substring(7)}))}disconnectedCallback(){this.cursor?.dispose(),window.removeEventListener("scroll",this.updateSidebarHeight),window.removeEventListener("resize",this.updateSidebarHeight),super.disconnectedCallback()}reInitCursor(){this.diffHost&&(this.cursor?.replaceDiffs([this.diffHost]),this.cursor?.reInitCursor())}updated(e){if(super.updated(e),e.has("change")||e.has("path")||e.has("patchNum")||e.has("basePatchNum")?this.reloadDiff():e.has("isActiveChildView")&&this.isActiveChildView&&this.initializePositions(),(e.has("focusLineNum")||e.has("leftSide"))&&this.initCursor(),(e.has("change")||e.has("changeComments")||e.has("path")||e.has("patchNum")||e.has("basePatchNum")||e.has("files"))&&this.change&&this.changeComments&&this.path&&this.patchRange){ba(this.diffHost,"diffHost");const e=this.files?.changeFilesByPath?.[this.path];this.diffHost.updateComplete.then((()=>{ba(this.path),ba(this.patchRange),ba(this.diffHost),ba(this.changeComments),this.diffHost.threads=this.changeComments.getThreadsBySideForFile({path:this.path,basePath:e?.old_path},this.patchRange)}))}(e.has("change")||e.has("changeComments")||e.has("path")||e.has("patchRange"))&&void 0!==this.changeComments&&void 0!==this.path&&void 0!==this.patchRange&&(this.commentsForPath=this.changeComments.getCommentsForPath(this.path,this.patchRange)),this.updateSidebarHeight()}render(){if(!this.isActiveChildView)return uc;if(!(this.patchNum&&this.changeNum&&this.change&&this.path))return dc`<div class="loading">Loading...</div>`;const e=this.getFileRange();return dc`
      ${this.renderStickyHeader()}
      <h2 class="assistive-tech-only">Diff view</h2>
      <div class="diffContainer ${this.shownSidebar&&"sidebarOpen"}">
        <gr-diff-host
          id="diffHost"
          .changeNum=${this.changeNum}
          .change=${this.change}
          .patchRange=${this.patchRange}
          .file=${e}
          .lineOfInterest=${this.getLineOfInterest()}
          .path=${this.path}
          .projectName=${this.change?.project}
          @is-blame-loaded-changed=${this.onIsBlameLoadedChanged}
          @comment-anchor-tap=${this.onCommentAnchorTap}
          @line-selected=${this.onLineSelected}
          @diff-changed=${this.onDiffChanged}
          @edit-weblinks-changed=${this.onEditWeblinksChanged}
          @files-weblinks-changed=${this.onFilesWeblinksChanged}
          @render=${this.reInitCursor}
        >
        </gr-diff-host>
      </div>
      ${this.renderDialogs()}
    `}renderStickyHeader(){return dc` <div
      class="stickyHeader ${this.patchNum===Ju?"editMode":""}"
    >
      <h1 class="assistive-tech-only">
        Diff of ${this.path?Rg(this.path):""}
      </h1>
      <header>${this.renderHeader()}</header>
      <div class="subHeader">
        ${this.renderPatchRangeLeft()} ${this.renderRightControls()}
      </div>
      <div class="fileNav mobile">
        <a class="mobileNavLink" href=${Vw(this.computeNavLinkURL(-1))}
          >&lt;</a
        >
        <div class="fullFileName mobile">${kg(this.path)}</div>
        <a class="mobileNavLink" href=${Vw(this.computeNavLinkURL(1))}
          >&gt;</a
        >
      </div>
      ${this.renderSidebarContent()}
    </div>`}renderHeader(){const e=this.formatFilesForDropdown(),t=this.computeFileNum(e),i=this.computeFileNumClass(t,e);return dc` <div>
        <a href=${Vw(this.getChangeModel().changeUrl())}
          >${this.changeNum}</a
        ><span class="changeNumberColon">:</span>
        <span class="headerSubject"
          >${Fg(this.change?.subject,80)}</span
        >
        <md-checkbox
          id="reviewed"
          class="reviewed hideOnEdit"
          ?hidden=${!this.loggedIn}
          title="Toggle reviewed status of file"
          aria-label="file reviewed"
          ?checked=${this.reviewed}
          @change=${this.handleReviewedChange}
        ></md-checkbox>
        <div class="jumpToFileContainer">
          <gr-dropdown-list
            id="dropdown"
            .value=${this.path??""}
            .items=${e}
            show-copy-for-trigger-text
            @value-change=${this.handleFileChange}
          ></gr-dropdown-list>
        </div>
      </div>
      <div class="navLinks desktop">
        <span class="fileNum ${Vw(i)}">
          File ${t} of ${e.length}
          <span class="separator"></span>
        </span>
        <a
          class="navLink"
          title=${this.createTitle(pu.PREV_FILE,hu.NAVIGATION)}
          href=${Vw(this.computeNavLinkURL(-1))}
          >Prev</a
        >
        <span class="separator"></span>
        <a
          class="navLink"
          title=${this.createTitle(pu.UP_TO_CHANGE,hu.NAVIGATION)}
          href=${Vw(this.getChangeModel().changeUrl())}
          >Up</a
        >
        <span class="separator"></span>
        <a
          class="navLink"
          title=${this.createTitle(pu.NEXT_FILE,hu.NAVIGATION)}
          href=${Vw(this.computeNavLinkURL(1))}
          >Next</a
        >
      </div>`}renderSidebarTriggers(){return dc`
      <div class="sidebarTriggerContainer">
        <gr-endpoint-decorator name="sidebarTrigger">
          <gr-endpoint-param
            name="onTrigger"
            .value=${e=>{const t=this.shownSidebar===e;this.shownSidebar=t?void 0:e,this.getUserModel().updatePreferences({diff_page_sidebar:t?"NONE":`plugin-${e}`})}}
          ></gr-endpoint-param>
          <!-- params cannot start falsy, so the value must be wrapped -->
          <gr-endpoint-param
            name="openSidebar"
            .value=${{name:this.shownSidebar}}
          ></gr-endpoint-param>
        </gr-endpoint-decorator>
      </div>
    `}renderSidebarContent(){return dc`
      <div class="sidebarAnchor">
        ${eb(void 0!==this.shownSidebar,(()=>dc`
            <div
              class="sidebarContents"
              style=${Bm({height:`${this.sidebarHeight}px`})}
            >
              <gr-endpoint-decorator
                name=${`sidebarContent-${this.shownSidebar}`}
              >
                <gr-endpoint-param
                  name="change"
                  .value=${this.change}
                ></gr-endpoint-param>
                <gr-endpoint-param
                  name="path"
                  .value=${this.path}
                ></gr-endpoint-param>
                <!-- current diff path and, in case of rename, previous path -->
                <gr-endpoint-param
                  name="fileRange"
                  .value=${this.getFileRange()}
                ></gr-endpoint-param>
                <gr-endpoint-param
                  name="basePatchNum"
                  .value=${this.basePatchNum}
                ></gr-endpoint-param>
                <gr-endpoint-param
                  name="patchNum"
                  .value=${this.patchNum}
                ></gr-endpoint-param>
                <gr-endpoint-param
                  name="content"
                  .value=${this.diff}
                ></gr-endpoint-param>
                <gr-endpoint-param
                  name="cursor"
                  .value=${this.cursor}
                ></gr-endpoint-param>
                <gr-endpoint-param
                  name="diff"
                  .value=${this.diffHost?.diffElement}
                ></gr-endpoint-param>
                <gr-endpoint-param
                  name="comments"
                  .value=${this.commentsForPath}
                ></gr-endpoint-param>
                <gr-endpoint-param
                  name="onClose"
                  .value=${e=>{this.shownSidebar===e&&(this.shownSidebar=void 0,this.getUserModel().updatePreferences({diff_page_sidebar:"NONE"}))}}
                >
                </gr-endpoint-param>
              </gr-endpoint-decorator>
            </div>
          `))}
      </div>
    `}renderPatchRangeLeft(){return dc` <div class="patchRangeLeft">
      <gr-patch-range-select
        id="rangeSelect"
        .filesWeblinks=${this.filesWeblinks}
        .path=${this.path}
        @patch-range-change=${this.handlePatchChange}
      >
      </gr-patch-range-select>
      <span class="download desktop">
        <span class="separator"></span>
        <gr-dropdown
          link=""
          down-arrow=""
          .items=${this.computeDownloadDropdownLinks()}
          .disabledIds=${this.isTooLargeForDownload()?["left-content","right-content"]:[]}
          horizontal-align="left"
        >
          <span class="downloadTitle"> Download </span>
        </gr-dropdown>
      </span>
    </div>`}renderRightControls(){const e=!this.diff||this.diff.binary?"hide":"";return dc` <div class="rightControls">
      ${this.renderSidebarTriggers()} ${this.renderShowEntireFileButton()}
      ${this.renderBlameButton()}
      ${eb(this.computeCanEdit(),(()=>dc`
          <span class="separator"></span>
          <span class="editButton">
            <gr-button
              link=""
              title="Edit current file"
              @click=${this.goToEditFile}
              >Edit</gr-button
            >
          </span>
        `))}
      ${eb(this.computeShowEditLinks(),(()=>dc`
          <span class="separator"></span>
          ${this.editWeblinks.map((e=>dc`<gr-weblink .info=${e}></gr-weblink>`))}
        `))}
      ${eb(this.loggedIn&&this.prefs,(()=>dc`
          <span class="separator"></span>
          <div class="diffModeSelector ${e}">
            <span>Diff view:</span>
            <gr-diff-mode-selector
              id="modeSelect"
              .saveOnChange=${this.loggedIn}
              show-tooltip-below
            ></gr-diff-mode-selector>
          </div>
          <span id="diffPrefsContainer">
            <span class="preferences desktop">
              <gr-tooltip-content
                has-tooltip=""
                position-below=""
                title="Diff preferences"
              >
                <gr-button
                  link=""
                  class="prefsButton"
                  @click=${e=>this.handlePrefsTap(e)}
                  ><gr-icon icon="settings" filled></gr-icon
                ></gr-button>
              </gr-tooltip-content>
            </span>
          </span>
        `))}
      <gr-endpoint-decorator name="annotation-toggler">
        <span hidden="" id="annotation-span">
          <label id="annotation-label" for="annotation-checkbox"></label>
          <md-checkbox
            id="annotation-checkbox"
            touch-target="none"
            disabled
            aria-labelledby="annotation-label"
          ></md-checkbox>
        </span>
      </gr-endpoint-decorator>
    </div>`}renderShowEntireFileButton(){if(!kk(this.diff)&&!Ag(this.path))return dc`<gr-button
      link=""
      id="toggleEntireFile"
      title=${this.createTitle(pu.TOGGLE_ALL_DIFF_CONTEXT,hu.DIFFS)}
      @click=${this.handleToggleAllDiffContext}
      >${this.isShowingEntireFile?"Hide Unchanged Lines":"Show Entire File"}</gr-button
    >`}renderBlameButton(){if(!this.allowBlame)return;if(Ag(this.path)||kk(this.diff))return;let e="Loading blame ...";return this.isBlameLoading||(e=this.isBlameLoaded?"Hide Blame":"Show Blame"),dc`<span class="separator"></span
      ><span class="blameLoader">
        <gr-button
          link=""
          id="toggleBlame"
          title=${this.createTitle(pu.TOGGLE_BLAME,hu.DIFFS)}
          ?disabled=${this.isBlameLoading}
          @click=${this.toggleBlame}
          >${e}</gr-button
        >
      </span>`}renderDialogs(){return dc`
      <gr-apply-fix-dialog id="applyFixDialog"></gr-apply-fix-dialog>
      <gr-diff-preferences-dialog id="diffPreferencesDialog">
      </gr-diff-preferences-dialog>
      <dialog id="downloadModal" tabindex="-1">
        <gr-download-dialog
          id="downloadDialog"
          @close=${this.handleDownloadDialogClose}
        ></gr-download-dialog>
      </dialog>
    `}setReviewedStatus(e,t){this.loggedIn&&(t.manual_review||this.setReviewed(!0,e))}getFileRange(){if(!this.files||!this.path)return;const e=this.files.changeFilesByPath[this.path],t={path:this.path};return e?.old_path&&(t.basePath=e.old_path),t}handleReviewedChange(e){const t=e.target;this.setReviewed(t.checked??!1)}setReviewed(e,t=this.patchNum){this.patchNum!==Ju&&t&&this.path&&this.changeNum&&(this.reviewedFiles.has(this.path)&&e||(this.reviewed=e,this.getChangeModel().setReviewedFilesStatus(this.changeNum,t,this.path,e)))}handleToggleFileReviewed(){this.setReviewed(!this.reviewed)}handlePrevLine(){ba(this.diffHost,"diffHost"),this.cursor?.moveUp()}onOpenFixPreview(e){ba(this.applyFixDialog,"applyFixDialog"),this.applyFixDialog.open(e)}onIsBlameLoadedChanged(e){this.isBlameLoaded=e.detail.value}onDiffChanged(e){this.diff=e.detail.value}onEditWeblinksChanged(e){this.editWeblinks=e.detail.value}onFilesWeblinksChanged(e){this.filesWeblinks=e.detail.value}handleNextLine(){ba(this.diffHost,"diffHost"),this.cursor?.moveDown()}moveToFileWithComment(e){const t=this.findFileWithComment(e);t?this.getChangeModel().navigateToDiff({path:t}):this.getChangeModel().navigateToChange()}handleNewComment(){this.classList.remove("hideComments"),this.classList.remove("hideCheckCodePointers"),this.cursor?.createCommentInPlace()}handlePrevFile(){this.path&&this.files?.sortedPaths&&this.navToFile(this.files.sortedPaths,-1)}handleNextFile(){this.path&&this.files?.sortedPaths&&this.navToFile(this.files.sortedPaths,1)}handleNextChunk(){const e=this.cursor?.moveToNextChunk();e===zb.CLIPPED&&this.cursor?.isAtEnd()&&this.showToastAndNavigateFile("next","n")}handleNextCommentThread(){const e=this.cursor?.moveToNextCommentThread();e===zb.CLIPPED&&this.navigateToNextFileWithCommentThread()}showToastAndNavigateFile(e,t){if(this.lastDisplayedNavigateToFileToast.get(e)&&Date.now()-this.lastDisplayedNavigateToFileToast.get(e)<=5e3)this.lastDisplayedNavigateToFileToast.delete(e),this.navigateToUnreviewedFile(e);else{if(this.lastDisplayedNavigateToFileToast.set(e,Date.now()),this.hasShownNavigateToFileToast.get(e))return;ea(this,`Press ${t} again to navigate to ${e} unreviewed file`),this.hasShownNavigateToFileToast.set(e,!0)}}navigateToUnreviewedFile(e){if(!this.path)return;if(!this.files?.sortedPaths)return;if(!this.reviewedFiles)return;const t=this.files.sortedPaths.filter((e=>e===this.path||!this.reviewedFiles.has(e)));this.navToFile(t,"next"===e?1:-1)}handlePrevChunk(){this.cursor?.moveToPreviousChunk(),this.cursor?.isAtStart()&&this.showToastAndNavigateFile("previous","p")}handlePrevCommentThread(){this.cursor?.moveToPreviousCommentThread()}handleOpenReplyDialog(){this.loggedIn?this.getChangeModel().navigateToChange(!0):Jn(this,"show-auth-required",{})}handleToggleLeftPane(){ba(this.diffHost,"diffHost"),this.diffHost.toggleLeftDiff()}handleOpenDownloadDialog(){ba(this.downloadModal,"downloadModal"),this.downloadModal.showModal(),Ln(this.downloadModal,(()=>{ba(this.downloadModal,"downloadModal"),ba(this.downloadDialog,"downloadDialog"),this.downloadDialog.focus()}))}handleDownloadDialogClose(){ba(this.downloadModal,"downloadModal"),this.downloadModal.close()}handleCommaKey(){this.loggedIn&&(ba(this.diffPreferencesDialog,"diffPreferencesDialog"),this.diffPreferencesDialog.open())}handleToggleDiffMode(){this.userPrefs&&(this.userPrefs.diff_view===Su.SIDE_BY_SIDE?this.getUserModel().updatePreferences({diff_view:Su.UNIFIED}):this.getUserModel().updatePreferences({diff_view:Su.SIDE_BY_SIDE}))}navToFile(e,t,i){const r=this.getNavLinkPath(e,t);if(!r)return;if(!this.patchRange)return;if(r.up)return void this.getChangeModel().navigateToChange();if(!r.path)return;let o;i&&(o=this.changeComments?.getCommentsForPath(r.path,this.patchRange)?.[0].line),this.getChangeModel().navigateToDiff({path:r.path,lineNum:o})}computeNavLinkURL(e){if(!this.change)return;if(!this.path)return;if(!this.files?.sortedPaths)return;if(!e)return;const t=this.getNavLinkPath(this.files.sortedPaths,e);if(t){if(t.up)return this.getChangeModel().changeUrl();if(t.path&&this.patchNum)return this.getViewModel().diffUrl({diffView:{path:t.path},patchNum:this.patchNum})}}goToEditFile(){ba(this.path,"path");const e=this.cursor?.getTargetLineNumber(),t="number"==typeof e?e:void 0;this.getChangeModel().navigateToEdit({path:this.path,lineNum:t})}getNavLinkPath(e,t){if(!this.path||!e||0===e.length)return null;let i=e.indexOf(this.path);return-1===i?{path:t>0?e[0]:e[e.length-1]}:(i+=t,i<0||i>e.length-1?{up:!0}:{path:e[i]})}updateUrlToDiffUrl(e,t){if(!this.path||!this.patchNum)return;const i=this.getViewModel().diffUrl({diffView:{path:this.path,lineNum:e,leftSide:t},patchNum:this.patchNum});history.replaceState(null,"",i)}async reloadDiff(){this.diffHost&&(await this.diffHost.reload(!0),this.reporting.diffViewDisplayed(),this.isBlameLoaded&&this.loadBlame(),this.isShowingEntireFile=this.diffHost?.isShowFullContext()??!1)}initializePositions(){document.documentElement.scrollTop=0,this.reInitCursor(),this.diffHost?.initLayers(),this.classList.remove("hideComments"),this.classList.remove("hideCheckCodePointers")}initCursor(){this.focusLineNum&&this.cursor&&(this.cursor.side=this.leftSide?$u.LEFT:$u.RIGHT,this.cursor.initialLineNumber=this.focusLineNum)}getLineOfInterest(){if(this.focusLineNum)return{lineNum:this.focusLineNum,side:this.leftSide?$u.LEFT:$u.RIGHT}}formatFilesForDropdown(){if(!this.files)return[];if(!this.patchRange)return[];if(!this.changeComments)return[];const e=[];for(const t of this.files.sortedPaths){const i=this.files.changeFilesByPath[t];e.push({text:kg(t),mobileText:Rg(t),value:t,bottomText:this.changeComments.computeCommentsString(this.patchRange,t,i,!0),file:i})}return e}handleFileChange(e){const t=e.detail.value;t!==this.path&&this.getChangeModel().navigateToDiff({path:t})}handlePatchChange(e){if(!this.path)return;if(!this.patchNum)return;const{basePatchNum:t,patchNum:i}=e.detail;t===this.basePatchNum&&i===this.patchNum||this.getChangeModel().navigateToDiff({path:this.path},i,t)}handlePrefsTap(e){e.preventDefault(),ba(this.diffPreferencesDialog,"diffPreferencesDialog"),this.diffPreferencesDialog.open()}onCommentAnchorTap(e){const t=e.detail.number;Number.isInteger(t)&&this.updateUrlToDiffUrl(t,e.detail.side===Yu.PARENT)}onLineSelected(e){const t=e.detail.number;Number.isInteger(t)&&this.updateUrlToDiffUrl(t,e.detail.side===$u.LEFT)}isTooLargeForDownload(){return(this.file?.size??0)>5e7}computeDownloadDropdownLinks(){if(!this.change?.project)return[];if(!this.changeNum)return[];if(!this.patchRange)return[];if(!this.path)return[];const e=[{url:this.computeDownloadPatchLink(this.change.project,this.changeNum,this.patchRange,this.path),name:"Patch"}];if(this.isTooLargeForDownload())e.push({id:"left-content",name:"Left Content (Too Large)"}),e.push({id:"right-content",name:"Right Content (Too Large)"});else{if(this.diff&&this.diff.meta_a){let t=this.path;"RENAMED"===this.diff.change_type&&(t=this.diff.meta_a.name),e.push({url:this.computeDownloadFileLink(this.change.project,this.changeNum,this.patchRange,t,!0),name:"Left Content"})}this.diff&&this.diff.meta_b&&e.push({url:this.computeDownloadFileLink(this.change.project,this.changeNum,this.patchRange,this.path,!1),name:"Right Content"})}return e}computeDownloadFileLink(e,t,i,r,o){let s,n=i.patchNum;o&&(kx(i.basePatchNum)?s=Fx(i.basePatchNum):i.basePatchNum===Qu?s=1:n=i.basePatchNum);let a=IC(e,t,n)+`/files/${encodeURIComponent(r)}/download`;return s&&(a+=`?parent=${s}`),a}computeDownloadPatchLink(e,t,i,r){let o=IC(e,t,i.patchNum);return o+="/patch?zip&path="+encodeURIComponent(r),o}findFileWithComment(e){const t=this.files?.sortedPaths,i=this.changeComments?.getPaths(this.patchRange)??{};if(!t||0===t.length)return;if(!this.path)return;const r=t.indexOf(this.path),o=1===e?t.length:-1;for(let s=r+e;s!==o;s+=e)if(i[t[s]])return t[s]}loadBlame(){this.isBlameLoading=!0,ea(this,"Loading blame information. This may take a while ..."),ba(this.diffHost,"diffHost"),this.diffHost.loadBlame().then((()=>{this.isBlameLoading=!1,ea(this,"Blame loaded")})).catch((()=>{this.isBlameLoading=!1}))}toggleBlame(){this.allowBlame&&(ba(this.diffHost,"diffHost"),this.isBlameLoaded?this.diffHost.clearBlame():this.loadBlame())}handleToggleHideAllCommentsAndCodePointers(){this.classList.toggle("hideComments")?this.classList.add("hideCheckCodePointers"):this.classList.remove("hideCheckCodePointers")}handleToggleHideCheckCodePointers(){this.classList.toggle("hideCheckCodePointers")}handleOpenFileList(){ba(this.dropdown,"dropdown"),this.dropdown.open()}handleDiffAgainstBase(){this.isActiveChildView&&(ba(this.path,"path"),ba(this.patchNum,"patchNum"),this.basePatchNum!==Qu?this.getChangeModel().navigateToDiff({path:this.path},this.patchNum,Qu):ea(this,"Base is already selected."))}handleDiffBaseAgainstLeft(){this.isActiveChildView&&(ba(this.path,"path"),ba(this.patchNum,"patchNum"),this.basePatchNum!==Qu?this.getChangeModel().navigateToDiff({path:this.path},this.basePatchNum,Qu):ea(this,"Left is already base."))}handleDiffAgainstLatest(){this.isActiveChildView&&(ba(this.path,"path"),ba(this.patchNum,"patchNum"),this.patchNum!==this.latestPatchNum?this.getChangeModel().navigateToDiff({path:this.path},this.latestPatchNum,this.basePatchNum):ea(this,"Latest is already selected."))}handleDiffRightAgainstLatest(){this.isActiveChildView&&(ba(this.path,"path"),ba(this.patchNum,"patchNum"),this.patchNum!==this.latestPatchNum?this.getChangeModel().navigateToDiff({path:this.path},this.latestPatchNum,this.patchNum):ea(this,"Right is already latest."))}handleDiffBaseAgainstLatest(){this.isActiveChildView&&(ba(this.path,"path"),ba(this.patchNum,"patchNum"),this.patchNum!==this.latestPatchNum||this.basePatchNum!==Qu?this.getChangeModel().navigateToDiff({path:this.path},this.latestPatchNum,Qu):ea(this,"Already diffing base against latest."))}computeFileNum(e){if(this.path&&e)return e.findIndex((({value:e})=>e===this.path))+1}computeFileNumClass(e,t){return t&&e&&e>0?"show":""}handleToggleAllDiffContext(){ba(this.diffHost,"diffHost"),this.isShowingEntireFile=!this.isShowingEntireFile,this.diffHost.toggleAllContext()}handleNextUnreviewedFile(){this.setReviewed(!0),this.navigateToUnreviewedFile("next")}navigateToNextFileWithCommentThread(){if(!this.path)return;if(!this.files?.sortedPaths)return;const e=this.patchRange;if(!e)return;if(!this.change)return;const t=t=>this.changeComments?.getCommentsForPath(t,e)?.length??!1,i=this.files.sortedPaths.filter((e=>e===this.path||t(e)));this.navToFile(i,1,!0)}computeCanEdit(){return!!this.change&&!!this.loggedIn&&PC(this.change)&&!this.computeShowEditLinks()}computeShowEditLinks(){return!!this.editWeblinks&&this.editWeblinks.length>0}createTitle(e,t){return this.getShortcutsService().createTitle(e,t)}};NU([Hc("#diffHost")],OU.prototype,"diffHost",void 0),NU([Uc()],OU.prototype,"reviewed",void 0),NU([Hc("#downloadModal")],OU.prototype,"downloadModal",void 0),NU([Hc("#downloadDialog")],OU.prototype,"downloadDialog",void 0),NU([Hc("#dropdown")],OU.prototype,"dropdown",void 0),NU([Hc("#applyFixDialog")],OU.prototype,"applyFixDialog",void 0),NU([Hc("#diffPreferencesDialog")],OU.prototype,"diffPreferencesDialog",void 0),NU([Hc(".sidebarAnchor")],OU.prototype,"sidebarAnchor",void 0),NU([Uc()],OU.prototype,"sidebarHeight",void 0),NU([Uc()],OU.prototype,"patchRange",null),NU([Uc()],OU.prototype,"patchNum",void 0),NU([Uc()],OU.prototype,"basePatchNum",void 0),NU([Uc()],OU.prototype,"change",void 0),NU([Uc()],OU.prototype,"latestPatchNum",void 0),NU([Uc()],OU.prototype,"changeComments",void 0),NU([Uc()],OU.prototype,"changeNum",void 0),NU([Uc()],OU.prototype,"diff",void 0),NU([Uc()],OU.prototype,"files",void 0),NU([Uc()],OU.prototype,"path",void 0),NU([Uc()],OU.prototype,"file",void 0),NU([Uc()],OU.prototype,"shownSidebar",void 0),NU([Uc()],OU.prototype,"isActiveChildView",void 0),NU([Uc()],OU.prototype,"allowBlame",void 0),NU([Uc()],OU.prototype,"loggedIn",void 0),NU([Fc({type:Object})],OU.prototype,"prefs",void 0),NU([Uc()],OU.prototype,"userPrefs",void 0),NU([Uc()],OU.prototype,"editWeblinks",void 0),NU([Uc()],OU.prototype,"filesWeblinks",void 0),NU([Uc()],OU.prototype,"isBlameLoaded",void 0),NU([Uc()],OU.prototype,"isBlameLoading",void 0),NU([Uc()],OU.prototype,"focusLineNum",void 0),NU([Uc()],OU.prototype,"leftSide",void 0),NU([Uc()],OU.prototype,"commentsForPath",void 0),NU([Uc()],OU.prototype,"isShowingEntireFile",void 0),NU([Uc()],OU.prototype,"cursor",void 0),OU=NU([Dc("gr-diff-view")],OU);var DU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let LU=class extends Ic{constructor(){super(...arguments),this.fileContent=""}static get styles(){return[Nc,Sd`
        textarea {
          border: none;
          box-sizing: border-box;
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-code);
          /* usually 16px = 12px + 4px */
          line-height: calc(var(--font-size-code) + var(--spacing-s));
          min-height: 60vh;
          resize: none;
          white-space: pre;
          width: 100%;
        }
        textarea:focus {
          outline: none;
        }
      `]}render(){return dc` <textarea
      id="textarea"
      .value=${this.fileContent}
      @input=${this._handleTextareaInput}
    ></textarea>`}_handleTextareaInput(e){Jn(this,"content-change",{value:e.target.value})}};function MU(){return window.matchMedia("(prefers-color-scheme: dark)")}function FU(e){return e===mg.AUTO?MU().matches:e===mg.DARK}DU([Fc({type:String})],LU.prototype,"fileContent",void 0),LU=DU([Dc("gr-default-editor")],LU);var UU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let BU=class extends Ic{constructor(){super(),this.getUserModel=yu(this,jf),this.handleEditTabWidthInput=()=>{this.editPrefs.tab_size=Number(this.editTabWidth.value),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleEditLineLengthInput=()=>{this.editPrefs.line_length=Number(this.editColumns.value),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleEditIndentUnitInput=()=>{this.editPrefs.indent_unit=Number(this.editIndentUnit.value),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleEditSyntaxHighlightingChanged=()=>{this.editPrefs.syntax_highlighting=this.editSyntaxHighlighting.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleEditShowTabsChanged=()=>{this.editPrefs.show_tabs=this.editShowTabs.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleEditShowTrailingWhitespaceTap=()=>{this.editPrefs.show_whitespace_errors=this.editShowTrailingWhitespaceInput.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleMatchBracketsChanged=()=>{this.editPrefs.match_brackets=this.showMatchBrackets.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleEditLineWrappingChanged=()=>{this.editPrefs.line_wrapping=this.editShowLineWrapping.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleIndentWithTabsChanged=()=>{this.editPrefs.indent_with_tabs=this.showIndentWithTabs.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},this.handleAutoCloseBracketsChanged=()=>{this.editPrefs.auto_close_brackets=this.showAutoCloseBrackets.checked,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()})},zf(this,(()=>this.getUserModel().editPreferences$),(e=>{this.originalEditPrefs=e,this.editPrefs={...e}}))}static get styles(){return[Jy,Nc,my,Sd`
        md-outlined-text-field {
          max-width: 25em;
        }
      `]}render(){return dc`
      <div id="editPreferences" class="gr-form-styles">
        <section>
          <label for="editTabWidth" class="title">Tab width</label>
          <span class="value">
            <md-outlined-text-field
              id="editTabWidth"
              class="showBlueFocusBorder"
              type="number"
              step="1"
              .value=${Lg(this.editPrefs?.tab_size)}
              @input=${this.handleEditTabWidthInput}
              @beforeinput=${e=>{const t=e.data;t&&!/^[0-9]*$/.test(t)&&e.preventDefault()}}
            >
            </md-outlined-text-field>
          </span>
        </section>
        <section>
          <label for="editColumns" class="title">Columns</label>
          <span class="value">
            <md-outlined-text-field
              id="editColumns"
              class="showBlueFocusBorder"
              type="number"
              step="1"
              .value=${Lg(this.editPrefs?.line_length)}
              @input=${this.handleEditLineLengthInput}
              @beforeinput=${e=>{const t=e.data;t&&!/^[0-9]*$/.test(t)&&e.preventDefault()}}
            >
            </md-outlined-text-field>
          </span>
        </section>
        <section>
          <label for="editIndentUnit" class="title">Indent unit</label>
          <span class="value">
            <md-outlined-text-field
              id="editIndentUnit"
              class="showBlueFocusBorder"
              type="number"
              step="1"
              .value=${Lg(this.editPrefs?.indent_unit)}
              @input=${this.handleEditIndentUnitInput}
              @beforeinput=${e=>{const t=e.data;t&&!/^[0-9]*$/.test(t)&&e.preventDefault()}}
            >
            </md-outlined-text-field>
          </span>
        </section>
        <section>
          <label for="editSyntaxHighlighting" class="title"
            >Syntax highlighting</label
          >
          <span class="value">
            <md-checkbox
              id="editSyntaxHighlighting"
              ?checked=${!!this.editPrefs?.syntax_highlighting}
              @change=${this.handleEditSyntaxHighlightingChanged}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="editShowTabs" class="title">Show tabs</label>
          <span class="value">
            <md-checkbox
              id="editShowTabs"
              ?checked=${!!this.editPrefs?.show_tabs}
              @change=${this.handleEditShowTabsChanged}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="showTrailingWhitespaceInput" class="title"
            >Show trailing whitespace</label
          >
          <span class="value">
            <md-checkbox
              id="editShowTrailingWhitespaceInput"
              ?checked=${!!this.editPrefs?.show_whitespace_errors}
              @change=${this.handleEditShowTrailingWhitespaceTap}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="showMatchBrackets" class="title">Match brackets</label>
          <span class="value">
            <md-checkbox
              id="showMatchBrackets"
              ?checked=${!!this.editPrefs?.match_brackets}
              @change=${this.handleMatchBracketsChanged}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="editShowLineWrapping" class="title">Line wrapping</label>
          <span class="value">
            <md-checkbox
              id="editShowLineWrapping"
              ?checked=${!!this.editPrefs?.line_wrapping}
              @change=${this.handleEditLineWrappingChanged}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="showIndentWithTabs" class="title">Indent with tabs</label>
          <span class="value">
            <md-checkbox
              id="showIndentWithTabs"
              ?checked=${!!this.editPrefs?.indent_with_tabs}
              @change=${this.handleIndentWithTabsChanged}
            ></md-checkbox>
          </span>
        </section>
        <section>
          <label for="showAutoCloseBrackets" class="title"
            >Auto close brackets</label
          >
          <span class="value">
            <md-checkbox
              id="showAutoCloseBrackets"
              ?checked=${!!this.editPrefs?.auto_close_brackets}
              @change=${this.handleAutoCloseBracketsChanged}
            ></md-checkbox>
          </span>
        </section>
      </div>
    `}hasUnsavedChanges(){return this.originalEditPrefs?.tab_size!==this.editPrefs?.tab_size||this.originalEditPrefs?.line_length!==this.editPrefs?.line_length||this.originalEditPrefs?.indent_unit!==this.editPrefs?.indent_unit||Boolean(this.originalEditPrefs?.syntax_highlighting)!==Boolean(this.editPrefs?.syntax_highlighting)||Boolean(this.originalEditPrefs?.show_tabs)!==Boolean(this.editPrefs?.show_tabs)||Boolean(this.originalEditPrefs?.show_whitespace_errors)!==Boolean(this.editPrefs?.show_whitespace_errors)||Boolean(this.originalEditPrefs?.match_brackets)!==Boolean(this.editPrefs?.match_brackets)||Boolean(this.originalEditPrefs?.line_wrapping)!==Boolean(this.editPrefs?.line_wrapping)||Boolean(this.originalEditPrefs?.indent_with_tabs)!==Boolean(this.editPrefs?.indent_with_tabs)||Boolean(this.originalEditPrefs?.auto_close_brackets)!==Boolean(this.editPrefs?.auto_close_brackets)}async save(){this.editPrefs&&(await this.getUserModel().updateEditPreference(this.editPrefs),Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges()}))}};UU([Hc("#editTabWidth")],BU.prototype,"editTabWidth",void 0),UU([Hc("#editColumns")],BU.prototype,"editColumns",void 0),UU([Hc("#editIndentUnit")],BU.prototype,"editIndentUnit",void 0),UU([Hc("#editSyntaxHighlighting")],BU.prototype,"editSyntaxHighlighting",void 0),UU([Hc("#showAutoCloseBrackets")],BU.prototype,"showAutoCloseBrackets",void 0),UU([Hc("#showIndentWithTabs")],BU.prototype,"showIndentWithTabs",void 0),UU([Hc("#showMatchBrackets")],BU.prototype,"showMatchBrackets",void 0),UU([Hc("#editShowLineWrapping")],BU.prototype,"editShowLineWrapping",void 0),UU([Hc("#editShowTabs")],BU.prototype,"editShowTabs",void 0),UU([Hc("#editShowTrailingWhitespaceInput")],BU.prototype,"editShowTrailingWhitespaceInput",void 0),UU([Uc()],BU.prototype,"editPrefs",void 0),UU([Uc()],BU.prototype,"originalEditPrefs",void 0),BU=UU([Dc("gr-edit-preferences")],BU);var HU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let jU=class extends Ic{static get styles(){return[Nc,Iw,Sd`
        .editHeader,
        .editActions {
          padding: var(--spacing-l) var(--spacing-xl);
        }
        .editHeader,
        .editActions {
          background-color: var(--dialog-background-color);
        }
        .editHeader {
          border-bottom: 1px solid var(--border-color);
          font-weight: var(--font-weight-medium);
        }
        .editActions {
          border-top: 1px solid var(--border-color);
          display: flex;
          justify-content: flex-end;
        }
        .editPrefsModal gr-button {
          margin-left: var(--spacing-l);
        }
        div.edited:after {
          color: var(--deemphasized-text-color);
          content: ' *';
        }
        #editPreferences {
          display: flex;
          padding: var(--spacing-s) var(--spacing-xl);
        }
      `]}render(){return dc`
      <dialog id="editPrefsModal" tabindex="-1">
        <div role="dialog" aria-labelledby="editPreferencesTitle">
          <h3
            class=${th({"heading-3":!0,editHeader:!0,edited:this.editPrefsChanged??!1})}
            id="editPreferencesTitle"
          >
            Edit Preferences
          </h3>
          <gr-edit-preferences
            id="editPreferences"
            @has-unsaved-changes-changed=${this.handleHasUnsavedChangesChanged}
          ></gr-edit-preferences>
          <div class="editActions">
            <gr-button
              id="cancelButton"
              link=""
              @click=${this.handleCancelEdit}
            >
              Cancel
            </gr-button>
            <gr-button
              id="saveButton"
              link=""
              primary=""
              @click=${this.handleSaveEditPreferences}
              ?disabled=${!this.editPrefsChanged}
            >
              Save
            </gr-button>
          </div>
        </div>
      </dialog>
    `}handleCancelEdit(e){e.stopPropagation(),ba(this.editPrefsModal,"editPrefsModal"),this.editPrefsModal.close()}open(){ba(this.editPrefsModal,"editPrefsModal"),this.editPrefsModal.showModal()}async handleSaveEditPreferences(){ba(this.editPreferences,"editPreferences"),ba(this.editPrefsModal,"editPrefsModal"),await this.editPreferences.save(),this.editPrefsModal.close(),Jn(this,"has-edit-pref-change-saved",{})}handleHasUnsavedChangesChanged(e){this.editPrefsChanged=e.detail.value}};HU([Hc("#editPreferences")],jU.prototype,"editPreferences",void 0),HU([Hc("#editPrefsModal")],jU.prototype,"editPrefsModal",void 0),HU([Uc()],jU.prototype,"editPrefsChanged",void 0),jU=HU([Dc("gr-edit-preferences-dialog")],jU);var GU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let zU=class extends Ic{constructor(){super(),this.newContent="",this.saving=!1,this.successfulSave=!1,this.darkMode=!1,this.restApiService=Xn().restApiService,this.reporting=Xn().reportingService,this.getPluginLoader=yu(this,U_),this.getStorage=yu(this,TO),this.getUserModel=yu(this,jf),this.getChangeModel=yu(this,MT),this.getViewModel=yu(this,XC),this.getNavigation=yu(this,gy),this.shortcuts=new Gg(this),this.handleCloseTap=()=>{this.viewEditInChangeView()},this.handleSaveTap=()=>{this.saveEdit().then((e=>{e.ok&&this.viewEditInChangeView()}))},this.handlePublishTap=()=>{const e=this.viewState?.changeNum;ba(e,"change number"),this.saveEdit().then((()=>{this.showAlert("Publishing edit..."),this.restApiService.executeChangeAction(e,Uu.POST,"/edit:publish",void 0,{notify:xg.OWNER_REVIEWERS},(e=>{this.showAlert("Failed to publish edit"),this.reporting.error("/edit:publish",new Error(e?.statusText))})).then((e=>{void 0!==e&&(ba(this.change,"change"),this.getPluginLoader().jsApiService.handlePublishEdit(this.change,this.getLatestRevision(this.change)),this.getChangeModel().navigateToChangeResetReload())}))}))},this.addEventListener("content-change",(e=>{this.handleContentChange(e)})),zf(this,(()=>this.getChangeModel().change$),(e=>this.change=e)),zf(this,(()=>this.getUserModel().editPreferences$),(e=>this.editPrefs=e)),zf(this,(()=>this.getViewModel().state$),(e=>{this.viewState=e,this.viewStateChanged()})),zf(this,(()=>this.getChangeModel().latestPatchNumWithEdit$),(e=>this.latestPatchsetNumber=e)),zf(this,(()=>this.getUserModel().preferenceTheme$),(e=>{this.darkMode=FU(e)})),this.shortcuts.addLocal({key:"s",modifiers:[Fn.CTRL_KEY]},(()=>this.handleSaveShortcut())),this.shortcuts.addLocal({key:"s",modifiers:[Fn.META_KEY]},(()=>this.handleSaveShortcut()))}connectedCallback(){super.connectedCallback()}disconnectedCallback(){this.storeTask?.flush(),super.disconnectedCallback()}static get styles(){return[Nc,Sd`
        :host {
          background-color: var(--view-background-color);
        }
        .stickyHeader {
          background-color: var(--edit-mode-background-color);
          border-bottom: 1px var(--border-color) solid;
          position: sticky;
          top: 0;
          z-index: 1;
        }
        header {
          align-items: center;
          display: flex;
          flex-wrap: wrap;
          justify-content: space-between;
          padding: var(--spacing-m) var(--spacing-l);
        }
        header gr-editable-label {
          font-family: var(--header-font-family);
          font-size: var(--font-size-h3);
          font-weight: var(--font-weight-h3);
          line-height: var(--line-height-h3);
        }
        header gr-editable-label::part(label) {
          text-overflow: initial;
          white-space: initial;
          word-break: break-all;
        }
        header gr-editable-label::part(input-container) {
          margin-top: var(--spacing-l);
        }
        .textareaWrapper {
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          margin: var(--spacing-l);
        }
        .textareaWrapper .editButtons {
          display: none;
        }
        .controlGroup {
          align-items: center;
          display: flex;
          font-family: var(--header-font-family);
          font-size: var(--font-size-h3);
          font-weight: var(--font-weight-h3);
          line-height: var(--line-height-h3);
        }
        .rightControls {
          justify-content: flex-end;
        }
        .warning {
          color: var(--error-text-color);
        }
      `]}render(){return this.viewState?.childView!==zC.EDIT?uc:dc` ${this.renderHeader()} ${this.renderEndpoint()} `}renderHeader(){return dc`
      <div class="stickyHeader">
        <header>
          <span class="controlGroup">
            <span>Edit mode</span>
            ${this.renderEditingOldPatchsetWarning()}
            <span class="separator"></span>
            <gr-editable-label
              labelText="File path"
              .value=${this.viewState?.editView?.path}
              placeholder="File path..."
              @changed=${this.handlePathChanged}
            ></gr-editable-label>
          </span>
          <span class="controlGroup rightControls">
            <gr-tooltip-content
              has-tooltip=""
              position-below=""
              title="Edit preferences"
            >
              <gr-button
                link=""
                class="prefsButton"
                @click=${this.handleEditPrefsTap}
                ><gr-icon icon="settings" filled></gr-icon
              ></gr-button>
            </gr-tooltip-content>
            <gr-button id="close" link="" @click=${this.handleCloseTap}
              >Cancel</gr-button
            >
            <gr-button
              id="save"
              ?disabled=${this.computeSaveDisabled()}
              primary=""
              link=""
              title=${this.computeButtonTitle("Save")}
              @click=${this.handleSaveTap}
              >Save</gr-button
            >
            <gr-button
              id="publish"
              link=""
              primary=""
              title=${this.computeButtonTitle("Publish")}
              @click=${this.handlePublishTap}
              ?disabled=${this.computeSaveDisabled()}
              >Save & Publish</gr-button
            >
          </span>
        </header>
      </div>
      <gr-edit-preferences-dialog
        id="editPreferencesDialog"
        @has-edit-pref-change-saved=${this.handleEditPrefChangeSaved}
      >
      </gr-edit-preferences-dialog>
    `}renderEditingOldPatchsetWarning(){const e=this.viewState?.patchNum;return e===this.latestPatchsetNumber?uc:dc`<span class="warning">&nbsp;(Old Patchset)</span>`}renderEndpoint(){return dc`
      <div class="textareaWrapper">
        <gr-endpoint-decorator id="editorEndpoint" name="editor">
          <gr-endpoint-param
            name="fileContent"
            .value=${this.newContent}
          ></gr-endpoint-param>
          <gr-endpoint-param
            name="prefs"
            .value=${this.editPrefs}
          ></gr-endpoint-param>
          <gr-endpoint-param
            name="fileType"
            .value=${this.type}
          ></gr-endpoint-param>
          <gr-endpoint-param
            name="lineNum"
            .value=${this.viewState?.editView?.lineNum}
          ></gr-endpoint-param>
          <gr-endpoint-param
            name="darkMode"
            .value=${this.darkMode}
          ></gr-endpoint-param>
          <gr-default-editor
            id="file"
            .fileContent=${this.newContent}
          ></gr-default-editor>
        </gr-endpoint-decorator>
      </div>
    `}willUpdate(e){e.has("change")&&this.navigateToChangeIfEdit(),(e.has("change")||e.has("type"))&&this.navigateToChangeIfEditType()}get storageKey(){return`c${this.viewState?.changeNum}_ps${this.viewState?.patchNum}_${this.viewState?.editView?.path}`}viewStateChanged(){if(this.viewState?.childView!==zC.EDIT)return;const e=[];return e.push(this.getFileData()),Promise.all(e)}navigateToChangeIfEdit(){var e;this.change&&(e=this.change,(e?.status===Nu.MERGED||function(e){return e?.status===Nu.ABANDONED}(this.change))&&(ea(this,"Change edits cannot be created if change is merged or abandoned. Redirected to non edit mode."),this.getNavigation().setUrl(WC({change:this.change}))))}navigateToChangeIfEditType(){this.change&&this.type&&this.type.startsWith("image/")&&(ea(this,"You cannot edit binary files within the inline editor."),this.getNavigation().setUrl(WC({change:this.change})))}async handlePathChanged(e){const t=this.viewState?.changeNum,i=this.viewState?.editView?.path;ba(t,"change number"),ba(i,"path");const r=e.detail;if(r===i)return;const o=await this.restApiService.renameFileInChangeEdit(t,i,r);o?.ok&&(this.successfulSave=!0,this.viewEditInChangeView())}viewEditInChangeView(){this.change&&this.getNavigation().setUrl(WC({change:this.change,edit:!0,forceReload:!0}))}getFileData(){const e=this.viewState?.changeNum,t=this.viewState?.patchNum,i=this.viewState?.editView?.path;ba(e,"change number"),ba(t,"patchset number"),ba(i,"path");const r=this.getStorage().getEditableContentItem(this.storageKey);return this.restApiService.getFileContent(e,i,t).then((e=>{const t=e&&e.content||"";r&&r.message&&r.message!==t?(ea(this,"Content restored from a previous edit."),this.newContent=r.message):this.newContent=t,this.content=t,e&&e.ok&&e.type?this.type=e.type:this.type=""}))}saveEdit(){const e=this.viewState?.changeNum,t=this.viewState?.editView?.path;return ba(e,"change number"),ba(t,"path"),this.saving=!0,this.showAlert("Saving changes..."),this.getStorage().eraseEditableContentItem(this.storageKey),this.newContent?this.restApiService.saveChangeEdit(e,t,this.newContent).then((e=>(this.saving=!1,this.showAlert(e.ok?"All changes saved":"Failed to save changes"),e.ok?(this.content=this.newContent,this.successfulSave=!0,e):e))):Promise.reject(new Error("new content undefined"))}showAlert(e){ea(this,e)}computeSaveDisabled(){return!![this.content,this.newContent,this.saving].includes(void 0)||!!this.saving||this.content===this.newContent}computeButtonTitle(e){const t=`${e} disabled:`;return this.saving?`${t} Saving in progress...`:void 0===this.content||void 0===this.newContent?`${t} Editor is initializing`:this.content===this.newContent?`${t} ${"Save"===e?"No changes made":"No changes to publish"}`:"Save"===e?"Save and Close the file":"Publish your edit. A new patchset will be created."}getLatestRevision(e){const t=this.latestPatchsetNumber;for(const i of Object.values(e.revisions??{}))if(i._number===t)return i;return null}handleContentChange(e){this.storeTask=ny(this.storeTask,(()=>{const t=e.detail.value;t?(this.newContent=e.detail.value,this.getStorage().setEditableContentItem(this.storageKey,t)):this.getStorage().eraseEditableContentItem(this.storageKey)}),100)}handleSaveShortcut(){this.computeSaveDisabled()||this.saveEdit()}handleEditPrefsTap(e){e.preventDefault(),ba(this.editPreferencesDialog,"editPreferencesDialog"),this.editPreferencesDialog.open()}handleEditPrefChangeSaved(){aa(this)}};GU([Hc("#editPreferencesDialog")],zU.prototype,"editPreferencesDialog",void 0),GU([Uc()],zU.prototype,"viewState",void 0),GU([Uc()],zU.prototype,"change",void 0),GU([Uc()],zU.prototype,"type",void 0),GU([Uc()],zU.prototype,"content",void 0),GU([Uc()],zU.prototype,"newContent",void 0),GU([Uc()],zU.prototype,"saving",void 0),GU([Uc()],zU.prototype,"successfulSave",void 0),GU([Uc()],zU.prototype,"editPrefs",void 0),GU([Uc()],zU.prototype,"latestPatchsetNumber",void 0),GU([Uc()],zU.prototype,"darkMode",void 0),zU=GU([Dc("gr-editor-view")],zU);var VU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let WU=class extends Ic{constructor(){super(),this.getConfigModel=yu(this,Qw),this.getPluginLoader=yu(this,U_),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{if(!e)return;const t=e?.plugin?.js_resource_paths??[],i=e?.default_theme?[e.default_theme]:[],r=e?.gerrit?.instance_id;this.getPluginLoader().loadPlugins([...i,...t],r)}))}};VU([Uc()],WU.prototype,"config",void 0),WU=VU([Dc("gr-plugin-host")],WU);const qU=["git_source_editor/screen/edit"],KU={view:gw.PLUGIN_SCREEN},YU=mu("plugin-view-model");class XU extends df{constructor(){super(KU),this.screenName$=lf(this.state$,(e=>{return t=e.plugin,i=e.screen,t&&i?`${t}-screen-${i}`:"";var t,i}))}}var JU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let QU=class extends Ic{constructor(){super(),this.getPluginViewModel=yu(this,YU),zf(this,(()=>this.getPluginViewModel().state$),(e=>{this.screen=e.screen})),zf(this,(()=>this.getPluginViewModel().screenName$),(e=>{this.screenName=e}))}render(){return fM(this.screenName,dc`
        <gr-endpoint-decorator .name=${this.screenName}>
          <gr-endpoint-param
            name="token"
            .value=${this.screen}
          ></gr-endpoint-param>
        </gr-endpoint-decorator>
      `)}};JU([Uc()],QU.prototype,"screen",void 0),JU([Uc()],QU.prototype,"screenName",void 0),QU=JU([Dc("gr-plugin-screen")],QU);var ZU=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let eB=class extends Ic{constructor(){super(...arguments),this.showAgreements=!1,this.restApiService=Xn().restApiService,this.handleShowAgreement=e=>{this.agreementName=e.target.getAttribute("data-name");const t=e.target.getAttribute("data-url");this.agreementsUrl=this.getAgreementsUrl(t),this.showAgreements=!0},this.handleSaveAgreements=()=>{this.createToast("Agreement saving...");const e=this.agreementName;return this.restApiService.saveAccountAgreement({name:e}).then((e=>{let t="Agreement failed to be submitted, please try again";200===e.status&&(t="Agreement has been successfully submitted."),this.createToast(t),this.loadData(),this.agreementsText="",this.showAgreements=!1}))}}connectedCallback(){super.connectedCallback(),this.loadData(),oa("New Contributor Agreement")}static get styles(){return[Jy,Qb,my,Nc,Sd`
        h1 {
          margin-bottom: var(--spacing-m);
        }
        h3 {
          margin-bottom: var(--spacing-m);
        }
        .agreementsUrl {
          border: 1px solid var(--border-color);
          margin-bottom: var(--spacing-xl);
          margin-left: var(--spacing-xl);
          margin-right: var(--spacing-xl);
          padding: var(--spacing-s);
        }
        #claNewAgreementsLabel {
          font-weight: var(--font-weight-medium);
        }
        .contributorAgreementButton {
          font-weight: var(--font-weight-medium);
        }
        .alreadySubmittedText {
          color: var(--error-text-color);
          margin: 0 var(--spacing-xxl);
          padding: var(--spacing-m);
        }
        main {
          margin: var(--spacing-xxl) auto;
          max-width: 50em;
        }
      `]}render(){return dc`
      <main>
        <h1 class="heading-1">New Contributor Agreement</h1>
        <h3 class="heading-3">Select an agreement type:</h3>
        ${(this.serverConfig?.auth.contributor_agreements??[]).filter((e=>e.url)).map((e=>this.renderAgreementsButton(e)))}
        ${this.renderNewAgreement()}
      </main>
    `}renderAgreementsButton(e){return dc`
      <span class="contributorAgreementButton">
        <md-radio
          id="claNewAgreementsInput${e.name}"
          name="claNewAgreementsRadio"
          data-name=${Vw(e.name)}
          data-url=${Vw(e.url)}
          ?disabled=${this.disableAgreements(e)}
          @change=${this.handleShowAgreement}
        >
        </md-radio>
        <label id="claNewAgreementsLabel">${e.name}</label>
      </span>
      ${this.renderAlreadySubmittedText(e)}
      <div class="agreementsUrl">${e.description}</div>
    `}renderAlreadySubmittedText(e){if(this.disableAgreements(e))return dc`
      <div class="alreadySubmittedText">Agreement already submitted.</div>
    `}renderNewAgreement(){if(this.showAgreements)return dc`
      <div id="claNewAgreement">
        <h3 class="heading-3">Review the agreement:</h3>
        <div id="agreementsUrl" class="agreementsUrl">
          <a
            href=${Vw(this.agreementsUrl)}
            target="_blank"
            rel="noopener"
          >
            Please review the agreement.</a
          >
        </div>
        ${this.renderAgreementsTextBox()}
      </div>
    `}renderAgreementsTextBox(){if(!this.computeHideAgreementTextbox())return dc`
      <div class="agreementsTextBox">
        <h3 class="heading-3">Complete the agreement:</h3>
        <md-outlined-text-field
          id="input-agreements"
          class="showBlueFocusBorder"
          placeholder="Enter 'I agree' here"
          .value=${this.agreementsText??""}
          @input=${e=>{const t=e.target;this.agreementsText=t.value}}
        >
        </md-outlined-text-field>
        <gr-button
          @click=${this.handleSaveAgreements}
          ?disabled=${"i agree"!==this.agreementsText?.toLowerCase()}
        >
          Submit
        </gr-button>
      </div>
    `}loadData(){const e=[];return e.push(this.restApiService.getConfig(!0).then((e=>{this.serverConfig=e}))),e.push(this.restApiService.getAccountGroups().then((e=>{e&&(this.groups=e.sort(((e,t)=>(e.name||"").localeCompare(t.name||""))))}))),e.push(this.restApiService.getAccountAgreements().then((e=>{this.signedAgreements=e||[]}))),Promise.all(e)}getAgreementsUrl(e){return e?e.startsWith("http:")||e.startsWith("https:")?e:`${Sf()}/${e}`:""}createToast(e){ea(this,e)}disableAgreements(e){for(const t of this.groups??[])if(e?.auto_verify_group?.id===t.id||this.signedAgreements?.find((t=>t.name===e.name)))return!0;return!1}computeHideAgreementTextbox(){const e=this.serverConfig?.auth.contributor_agreements;return!(!this.agreementName||!e)&&e.some((e=>this.agreementName===e.name&&!e.auto_verify_group))}};ZU([Uc()],eB.prototype,"groups",void 0),ZU([Uc()],eB.prototype,"serverConfig",void 0),ZU([Uc()],eB.prototype,"agreementsText",void 0),ZU([Uc()],eB.prototype,"agreementName",void 0),ZU([Uc()],eB.prototype,"signedAgreements",void 0),ZU([Uc()],eB.prototype,"showAgreements",void 0),ZU([Uc()],eB.prototype,"agreementsUrl",void 0),eB=ZU([Dc("gr-cla-view")],eB);var tB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let iB=class extends Ic{constructor(){super(...arguments),this.account={},this.loading=!0,this.saving=!1,this.usernameMutable=!1,this.restApiService=Xn().restApiService}connectedCallback(){super.connectedCallback(),this.getAttribute("role")||this.setAttribute("role","dialog")}static get styles(){return[Jy,Nc,my,Sd`
        :host {
          display: block;
        }
        main {
          max-width: 46em;
        }
        :host(.loading) main {
          display: none;
        }
        .loadingMessage {
          display: none;
          font-style: italic;
        }
        :host(.loading) .loadingMessage {
          display: block;
        }
        hr {
          margin-top: var(--spacing-l);
          margin-bottom: var(--spacing-l);
        }
        header {
          border-bottom: 1px solid var(--border-color);
          font-weight: var(--font-weight-medium);
          margin-bottom: var(--spacing-l);
        }
        .container {
          padding: var(--spacing-m) var(--spacing-xl);
        }
        footer {
          display: flex;
          justify-content: flex-end;
        }
        footer gr-button {
          margin-left: var(--spacing-l);
        }
        input {
          width: 20em;
        }
        md-outlined-text-field {
          width: 20em;
        }
      `]}render(){return dc`<div class="container gr-form-styles">
      <header>Please confirm your contact information</header>
      <div class="loadingMessage">Loading...</div>
      <main>
        <p>
          The following contact information was automatically obtained when you
          signed in to the site. This information is used to display who you are
          to others, and to send updates to code reviews you have either started
          or subscribed to.
        </p>
        <hr />
        <section>
          <span class="title">Full Name</span>
          ${eb(this.nameMutable,(()=>dc`<span class="value">
              <md-outlined-text-field
                id="name"
                class="showBlueFocusBorder"
                ?disabled=${this.saving}
                .value=${this.account.name??""}
                @input=${e=>{const t=e.target,i=this.account;i&&i.name!==t.value&&(this.account={...i,name:t.value},this.hasNameChange=!0)}}
              >
              </md-outlined-text-field>
            </span>`),(()=>dc`<span class="value">${this.account.name}</span>`))}
        </section>
        <section>
          <span class="title">Display Name</span>
          <span class="value">
            <md-outlined-text-field
              id="displayName"
              class="showBlueFocusBorder"
              ?disabled=${this.saving}
              .value=${this.account.display_name??""}
              @input=${e=>{const t=e.target,i=this.account;i&&i.display_name!==t.value&&(this.account={...i,display_name:t.value},this.hasDisplayNameChange=!0)}}
            >
            </md-outlined-text-field>
          </span>
        </section>
        ${eb(this.computeUsernameEditable(),(()=>dc`<section>
            <span class="title">Username</span>
            ${eb(this.usernameMutable,(()=>dc` <span class="value">
                <md-outlined-text-field
                  id="username"
                  class="showBlueFocusBorder"
                  ?disabled=${this.saving}
                  .value=${this.username??""}
                  @input=${e=>{const t=e.target;this.usernameInput&&this.username!==t.value&&(this.username=t.value,this.hasUsernameChange=!0)}}
                >
                </md-outlined-text-field>
              </span>`),(()=>dc`<span class="value">${this.username}</span>`))}
          </section>`))}
        <hr />
        <p>
          More configuration options for Gerrit may be found in the
          <a @click=${this.close} href=${Vw(this.settingsUrl)}
            >settings</a
          >.
        </p>
      </main>
      <footer>
        <gr-button
          id="closeButton"
          link
          ?disabled=${this.saving}
          @click=${this.handleClose}
          >Close</gr-button
        >
        <gr-button
          id="saveButton"
          primary
          link
          ?disabled=${this.computeSaveDisabled()}
          @click=${this.handleSave}
          >Save</gr-button
        >
      </footer>
    </div>`}willUpdate(e){e.has("account")&&(this.usernameMutable=!this.account.username),e.has("serverConfig")&&(this.nameMutable=this.computeNameMutable()),e.has("loading")&&this.classList.toggle("loading",this.loading)}loadData(){this.loading=!0;const e=this.restApiService.getAccount().then((e=>{e&&(this.hasNameChange=!1,this.hasUsernameChange=!1,this.hasDisplayNameChange=!1,e.username=e.username||"",this.account=e,this.username=e.username)})),t=this.restApiService.getConfig().then((e=>{this.serverConfig=e}));return Promise.all([e,t]).then((()=>{this.loading=!1}))}computeUsernameEditable(){return!!this.serverConfig?.auth.editable_account_fields.includes(Lu.USER_NAME)}computeNameMutable(){return!!this.serverConfig?.auth.editable_account_fields.includes(Lu.FULL_NAME)}save(){this.saving=!0;const e=[];return this.hasUsernameChange&&this.usernameMutable&&this.username&&e.push(this.restApiService.setAccountUsername(this.username)),this.hasNameChange&&this.nameMutable&&this.account?.name&&e.push(this.restApiService.setAccountName(this.account.name)),this.hasDisplayNameChange&&this.account?.display_name&&e.push(this.restApiService.setAccountDisplayName(this.account.display_name)),Promise.all(e).then((()=>{this.saving=!1,Jn(this,"account-detail-update",{})}))}handleSave(e){e.preventDefault(),this.save().then((()=>this.close()))}handleClose(e){e.preventDefault(),this.close()}close(){this.saving=!0,Jn(this,"close",{})}computeSaveDisabled(){return this.saving||!this.account?.display_name&&!this.account.name&&!this.username}};tB([Hc("#name")],iB.prototype,"nameInput",void 0),tB([Hc("#username")],iB.prototype,"usernameInput",void 0),tB([Hc("#displayName")],iB.prototype,"displayName",void 0),tB([Fc()],iB.prototype,"settingsUrl",void 0),tB([Uc()],iB.prototype,"account",void 0),tB([Uc()],iB.prototype,"loading",void 0),tB([Uc()],iB.prototype,"saving",void 0),tB([Uc()],iB.prototype,"serverConfig",void 0),tB([Uc()],iB.prototype,"usernameMutable",void 0),tB([Uc()],iB.prototype,"hasUsernameChange",void 0),tB([Uc()],iB.prototype,"username",void 0),tB([Uc()],iB.prototype,"nameMutable",void 0),tB([Uc()],iB.prototype,"hasNameChange",void 0),tB([Uc()],iB.prototype,"hasDisplayNameChange",void 0),iB=tB([Dc("gr-registration-dialog")],iB);var rB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let oB=class extends Ic{static get styles(){return[Nc,my,Jy,Sd`
        #changeCols {
          width: auto;
        }
        #changeCols .visibleHeader {
          text-align: center;
        }
        .checkboxContainer {
          text-align: center;
        }
      `]}constructor(){super(),this.displayedColumns=[],this.defaultColumns=Object.values(dg),this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{this.serverConfig=e}))}render(){return dc`<div class="gr-form-styles">
      <table id="changeCols">
        <thead>
          <tr>
            <th class="nameHeader">Column</th>
            <th class="visibleHeader">Visible</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><label for="numberCheckbox">Number</label></td>
            <td class="checkboxContainer">
              <md-checkbox
                id="numberCheckbox"
                name="number"
                ?checked=${!!this.showNumber}
                @change=${this.handleNumberCheckboxClick}
              ></md-checkbox>
            </td>
          </tr>
          ${this.defaultColumns.map((e=>this.renderRow(e)))}
        </tbody>
      </table>
    </div>`}renderRow(e){return dc`<tr>
      <td><label for=${e}>${e}</label></td>
      <td class="checkboxContainer">
        <md-checkbox
          id=${e}
          name=${e}
          ?checked=${!this.computeIsColumnHidden(e)}
          @change=${this.handleTargetClick}
        ></md-checkbox>
      </td>
    </tr>`}getDisplayedColumns(){return null===this.shadowRoot?[]:Array.from(this.shadowRoot.querySelectorAll(".checkboxContainer md-checkbox:not([name=number])")).filter((e=>e.checked)).map((e=>e.name))}computeIsColumnHidden(e){return!(!this.displayedColumns||!e||this.displayedColumns.includes(e))}handleNumberCheckboxClick(e){this.showNumber=e.target.checked,Jn(this,"show-number-changed",{value:this.showNumber})}handleTargetClick(){this.displayedColumns=this.getDisplayedColumns(),Jn(this,"displayed-columns-changed",{value:this.displayedColumns})}};rB([Fc({type:Array})],oB.prototype,"displayedColumns",void 0),rB([Fc({type:Boolean})],oB.prototype,"showNumber",void 0),rB([Fc({type:Array})],oB.prototype,"defaultColumns",void 0),rB([Uc()],oB.prototype,"serverConfig",void 0),oB=rB([Dc("gr-change-table-editor")],oB);var sB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let nB=class extends Ic{static get styles(){return[Jy,Nc,my,vy,Sd`
        gr-avatar {
          height: 120px;
          width: 120px;
          margin-right: var(--spacing-xs);
          vertical-align: -0.25em;
        }
        div section.hide {
          display: none;
        }
        gr-hovercard-account-contents {
          display: block;
          max-width: 600px;
          margin-top: var(--spacing-m);
          background: var(--dialog-background-color);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius);
          box-shadow: var(--elevation-level-5);
        }
        gr-autogrow-textarea {
          background-color: var(--view-background-color);
          color: var(--primary-text-color);
        }
        gr-autogrow-textarea:focus {
          border: 2px solid var(--input-focus-border-color);
        }
        .lengthCounter {
          font-weight: var(--font-weight-normal);
        }
        p {
          max-width: 65ch;
          margin-bottom: var(--spacing-m);
        }
      `]}constructor(){super(),this.hasUnsavedChanges=!1,this.hasNameChange=!1,this.hasUsernameChange=!1,this.hasDisplayNameChange=!1,this.hasStatusChange=!1,this.loading=!1,this.saving=!1,this.avatarChangeUrl="",this.docsBaseUrl="",this.restApiService=Xn().restApiService,this.getConfigModel=yu(this,Qw),zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e))}render(){return!this.account||this.loading?uc:dc`<div class="gr-form-styles">
      <p>
        All profile fields below may be publicly displayed to others, including
        on changes you are associated with, as well as in search and
        autocompletion.
        <a href=${$f(this.docsBaseUrl,"user-privacy.html")}
          >Learn more</a
        >
      </p>
      <gr-endpoint-decorator name="profile"></gr-endpoint-decorator>
      <section>
        <span class="title"></span>
        <span class="value">
          <gr-avatar .account=${this.account} imageSize="120"></gr-avatar>
        </span>
      </section>
      ${eb(this.avatarChangeUrl,(()=>dc` <section>
          <span class="title"></span>
          <span class="value">
            <a href=${this.avatarChangeUrl}> Change avatar </a>
          </span>
        </section>`))}
      <section>
        <span class="title">ID</span>
        <span class="value">${this.account._account_id}</span>
      </section>
      <section>
        <span class="title">Email</span>
        <span class="value">${this.account.email}</span>
      </section>
      <section>
        <span class="title">Registered</span>
        <span class="value">
          <gr-date-formatter
            withTooltip
            .dateStr=${this.account.registered_on}
          ></gr-date-formatter>
        </span>
      </section>
      <section id="usernameSection">
        <span class="title">Username</span>
        ${eb(this.computeUsernameEditable(),(()=>dc`<span class="value">
            <md-outlined-text-field
              id="usernameInput"
              class="showBlueFocusBorder"
              ?disabled=${this.saving}
              @keydown=${this.handleKeydown}
              .value=${this.username??""}
              @input=${e=>{const t=e.target;this.username!==t.value&&(this.username=t.value,this.hasUsernameChange=!0)}}
            >
            </md-outlined-text-field>
          </span>`),(()=>dc`<span class="value">${this.username}</span>`))}
      </section>
      <section id="nameSection">
        <label class="title" for="nameInput">Full name</label>
        ${eb(this.nameMutable,(()=>dc`<span class="value">
            <md-outlined-text-field
              id="nameInput"
              class="showBlueFocusBorder"
              ?disabled=${this.saving}
              @keydown=${this.handleKeydown}
              .value=${this.account?.name??""}
              @input=${e=>{const t=e.target,i=this.account;i&&i.name!==t.value&&(this.account={...i,name:t.value},this.hasNameChange=!0)}}
            >
            </md-outlined-text-field>
          </span>`),(()=>dc` <span class="value">${this.account?.name}</span>`))}
      </section>
      <section>
        <label class="title" for="displayNameInput">Display name</label>
        <span class="value">
          <md-outlined-text-field
            id="displayNameInput"
            class="showBlueFocusBorder"
            ?disabled=${this.saving}
            @keydown=${this.handleKeydown}
            .value=${this.account.display_name??""}
            @input=${e=>{const t=e.target,i=this.account;i&&i.display_name!==t.value&&(this.account={...i,display_name:t.value},this.hasDisplayNameChange=!0)}}
          >
          </md-outlined-text-field>
        </span>
      </section>
      <section>
        <span class="title">
          <label for="statusInput">About me (e.g. employer)</label>
          <div class="lengthCounter">
            ${this.account.status?.length??0}/140
          </div>
        </span>
        <span class="value">
          <gr-autogrow-textarea
            id="statusInput"
            .label=${"statusInput"}
            ?disabled=${this.saving}
            maxlength="140"
            .value=${this.account?.status??""}
            @input=${e=>{const t=this.account,i=e.target.value??"";t&&t.status!==i&&(this.account={...t,status:i},this.hasStatusChange=!0)}}
          ></gr-autogrow-textarea>
        </span>
      </section>
      <section>
        <span class="title">
          <gr-tooltip-content
            title="This is how you appear to others"
            has-tooltip
            show-icon
          >
            Account preview
          </gr-tooltip-content>
        </span>
        <span class="value">
          <gr-account-chip .account=${this.account}></gr-account-chip>
          <gr-hovercard-account-contents
            .account=${this.account}
          ></gr-hovercard-account-contents>
        </span>
      </section>
    </div>`}willUpdate(e){e.has("serverConfig")&&(this.nameMutable=this.computeNameMutable()),(e.has("hasNameChange")||e.has("hasUsernameChange")||e.has("hasStatusChange")||e.has("hasDisplayNameChange"))&&(this.hasUnsavedChanges=this.computeHasUnsavedChanges()),e.has("hasUnsavedChanges")&&Jn(this,"unsaved-changes-changed",{value:this.hasUnsavedChanges})}loadData(){const e=[];return this.loading=!0,e.push(this.restApiService.getConfig().then((e=>{this.serverConfig=e}))),this.restApiService.invalidateAccountsDetailCache(),e.push(this.restApiService.getAccount().then((e=>{e&&(this.hasNameChange=!1,this.hasUsernameChange=!1,this.hasDisplayNameChange=!1,this.hasStatusChange=!1,e.username=e.username||"",this.account=e,this.username=e.username)}))),e.push(this.restApiService.getAvatarChangeUrl().then((e=>{this.avatarChangeUrl=e||""}))),Promise.all(e).then((()=>{this.loading=!1}))}save(){return this.hasUnsavedChanges?(this.saving=!0,this.maybeSetName().then((()=>this.maybeSetUsername())).then((()=>this.maybeSetDisplayName())).then((()=>this.maybeSetStatus())).then((()=>{this.hasNameChange=!1,this.hasUsernameChange=!1,this.hasDisplayNameChange=!1,this.hasStatusChange=!1,this.saving=!1,Jn(this,"account-detail-update",{})}))):Promise.resolve()}delete(){return this.restApiService.deleteAccount()}maybeSetName(){return this.hasNameChange&&this.nameMutable&&this.account?.name?this.restApiService.setAccountName(this.account.name):Promise.resolve()}maybeSetUsername(){return this.hasUsernameChange&&this.computeUsernameEditable()&&this.username?this.restApiService.setAccountUsername(this.username):Promise.resolve()}maybeSetDisplayName(){return this.hasDisplayNameChange&&void 0!==this.account?.display_name?this.restApiService.setAccountDisplayName(this.account.display_name):Promise.resolve()}maybeSetStatus(){return this.hasStatusChange&&void 0!==this.account?.status?this.restApiService.setAccountStatus(this.account.status):Promise.resolve()}computeHasUnsavedChanges(){return this.hasNameChange||this.hasUsernameChange||this.hasStatusChange||this.hasDisplayNameChange}computeUsernameEditable(){return!!this.serverConfig?.auth.editable_account_fields.includes(Lu.USER_NAME)&&!this.account?.username}computeNameMutable(){return!!this.serverConfig?.auth.editable_account_fields.includes(Lu.FULL_NAME)}handleKeydown(e){"Enter"===e.key&&(e.stopPropagation(),this.save())}};sB([Uc()],nB.prototype,"nameMutable",void 0),sB([Fc({type:Boolean})],nB.prototype,"hasUnsavedChanges",void 0),sB([Uc()],nB.prototype,"hasNameChange",void 0),sB([Uc()],nB.prototype,"hasUsernameChange",void 0),sB([Uc()],nB.prototype,"hasDisplayNameChange",void 0),sB([Uc()],nB.prototype,"hasStatusChange",void 0),sB([Uc()],nB.prototype,"loading",void 0),sB([Uc()],nB.prototype,"saving",void 0),sB([Uc()],nB.prototype,"account",void 0),sB([Uc()],nB.prototype,"serverConfig",void 0),sB([Uc()],nB.prototype,"username",void 0),sB([Uc()],nB.prototype,"avatarChangeUrl",void 0),sB([Uc()],nB.prototype,"docsBaseUrl",void 0),nB=sB([Dc("gr-account-info")],nB);var aB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let lB=class extends Ic{constructor(){super(...arguments),this.restApiService=Xn().restApiService}connectedCallback(){super.connectedCallback(),this.loadData()}loadData(){return this.restApiService.getAccountAgreements().then((e=>{this._agreements=e}))}static get styles(){return[Nc,Sd`
        #agreements .nameColumn {
          min-width: 15em;
          width: auto;
        }
        #agreements .descriptionColumn {
          width: auto;
        }
      `,my]}renderAgreement(e){if(e)return dc`
      <tr>
        <td class="nameColumn">
          <a href=${this.getUrlBase(e?.url)} rel="external">
            ${e.name}
          </a>
        </td>
        <td class="descriptionColumn">${e.description}</td>
      </tr>
    `}render(){return dc` <div class="gr-form-styles">
      <table id="agreements">
        <thead>
          <tr>
            <th class="nameColumn">Name</th>
            <th class="descriptionColumn">Description</th>
          </tr>
        </thead>
        <tbody>
          ${(this._agreements??[]).map((e=>this.renderAgreement(e)))}
        </tbody>
      </table>
      <a href=${this.getUrl()}>New Contributor Agreement</a>
    </div>`}getUrl(){return`${Sf()}/settings/new-agreement`}getUrlBase(e){return e?`${Sf()}/${e}`:""}};aB([Fc({type:Array})],lB.prototype,"_agreements",void 0),lB=aB([Dc("gr-agreements-list")],lB);var dB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let cB=class extends Ic{constructor(){super(),this.originalEmails=[],this.emails=[],this.emailsToRemove=[],this.newPreferred="",this.restApiService=Xn().restApiService,this.getUserModel=yu(this,jf),zf(this,(()=>this.getUserModel().emails$),(e=>{e&&(this.originalEmails=af(e),this.emails=af(e))}))}static get styles(){return[Nc,my,Jy,Sd`
        th {
          color: var(--deemphasized-text-color);
          text-align: left;
        }
        #emailTable .emailColumn {
          min-width: 32.5em;
          width: auto;
        }
        #emailTable .preferredHeader {
          text-align: center;
          width: 6em;
        }
        #emailTable .preferredControl {
          height: auto;
          text-align: center;
        }
      `]}render(){return dc`<div class="gr-form-styles">
      <table id="emailTable">
        <thead>
          <tr>
            <th class="emailColumn">Email</th>
            <th class="preferredHeader">Preferred</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          ${this.emails.map(((e,t)=>this.renderEmail(e,t)))}
        </tbody>
      </table>
    </div>`}renderEmail(e,t){return dc`<tr>
      <td class="emailColumn">${e.email}</td>
      <td class="preferredControl">
        <md-radio
          class="preferredRadio"
          name="preferred"
          .value=${e.email}
          ?checked=${!!e.preferred}
          @change=${this.handlePreferredChange}
        >
        </md-radio>
      </td>
      <td>
        <gr-button
          @click=${()=>this.handleDeleteButton(t)}
          ?disabled=${this.checkPreferred(e.preferred)}
          class="remove-button"
          >Delete</gr-button
        >
      </td>
    </tr>`}save(){const e=[];for(const t of this.emailsToRemove)e.push(this.restApiService.deleteAccountEmail(t.email));return this.newPreferred&&e.push(this.restApiService.setPreferredAccountEmail(this.newPreferred)),Promise.all(e).then((async()=>{this.emailsToRemove=[],this.newPreferred="",await this.getUserModel().loadEmails(!0),this.setHasUnsavedChanges()}))}handleDeleteButton(e){const t=this.emails[e],i=this.emails.some((e=>JSON.stringify(t)===JSON.stringify(e)));i&&this.emailsToRemove.push(t),this.emails.splice(e,1),this.requestUpdate(),this.setHasUnsavedChanges()}handlePreferredChange(e){if(!(e.target instanceof bP))return;const t=e.target.value;for(let e=0;e<this.emails.length;e++)t===this.emails[e].email?(this.emails[e].preferred=!0,this.requestUpdate(),this.newPreferred=t,this.setHasUnsavedChanges()):this.emails[e].preferred&&(delete this.emails[e].preferred,this.setHasUnsavedChanges(),this.requestUpdate())}checkPreferred(e){return e??!1}setHasUnsavedChanges(){Jn(this,"has-unsaved-changes-changed",{value:JSON.stringify(this.originalEmails)!==JSON.stringify(this.emails)||this.emailsToRemove.length>0})}};dB([Uc()],cB.prototype,"originalEmails",void 0),dB([Uc()],cB.prototype,"emails",void 0),dB([Uc()],cB.prototype,"emailsToRemove",void 0),dB([Uc()],cB.prototype,"newPreferred",void 0),cB=dB([Dc("gr-email-editor")],cB);var hB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let pB=class extends Ic{constructor(){super(...arguments),this.hasUnsavedChanges=!1,this.keys=[],this.newKey="",this.keysToRemove=[],this.restApiService=Xn().restApiService}static get styles(){return[my,vy,Nc,Iw,Sd`
        .keyHeader {
          width: 9em;
        }
        .userIdHeader {
          width: 15em;
        }
        #viewKeyModal {
          padding: var(--spacing-xxl);
          width: 50em;
        }
        .closeButton {
          bottom: 2em;
          position: absolute;
          right: 2em;
        }
        #existing {
          margin-bottom: var(--spacing-l);
        }
        gr-autogrow-textarea {
          background-color: var(--view-background-color);
          position: relative;
          height: auto;
          min-height: 4em;
          --gr-autogrow-textarea-border-width: 0px;
          --gr-autogrow-textarea-border-color: var(--border-color);
          --input-field-bg: var(--view-background-color);
          --input-field-disabled-bg: var(--view-background-color);
          --secondary-bg-color: var(--background-color-secondary);
          --text-default: var(--primary-text-color);
          --text-disabled: var(--deemphasized-text-color);
          --text-secondary: var(--deemphasized-text-color);
        }
        gr-autogrow-textarea:focus {
          border: 2px solid var(--input-focus-border-color);
        }
      `]}render(){return dc`
      <div class="gr-form-styles">
        <fieldset id="existing">
          <table>
            <thead>
              <tr>
                <th class="idColumn">ID</th>
                <th class="fingerPrintColumn">Fingerprint</th>
                <th class="userIdHeader">User IDs</th>
                <th class="keyHeader">Public Key</th>
                <th></th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              ${this.keys.map(((e,t)=>this.renderKey(e,t)))}
            </tbody>
          </table>
          <dialog id="viewKeyModal" tabindex="-1">
            <fieldset>
              <section>
                <span class="title">Status</span>
                <span class="value">${this.keyToView?.status}</span>
              </section>
              <section>
                <span class="title">Key</span>
                <span class="value">${this.keyToView?.key}</span>
              </section>
            </fieldset>
            <gr-button
              class="closeButton"
              @click=${()=>{this.viewKeyModal?.close()}}
              >Close</gr-button
            >
          </dialog>
          <gr-button @click=${this.save} ?disabled=${!this.hasUnsavedChanges}
            >Save Changes</gr-button
          >
        </fieldset>
        <fieldset>
          <section>
            <span class="title">New GPG key</span>
            <span class="value">
              <gr-autogrow-textarea
                id="newKey"
                autocomplete="on"
                .value=${this.newKey}
                @input=${e=>this.handleNewKeyChanged(e)}
                placeholder="New GPG Key"
              ></gr-autogrow-textarea>
            </span>
          </section>
          <gr-button
            id="addButton"
            ?disabled=${!this.newKey?.length}
            @click=${this.handleAddKey}
            >Add New GPG Key</gr-button
          >
        </fieldset>
      </div>
    `}renderKey(e,t){return dc`<tr>
      <td class="idColumn">${e.id}</td>
      <td class="fingerPrintColumn">${e.fingerprint}</td>
      <td class="userIdHeader">${e.user_ids?.map((e=>dc`${e}`))}</td>
      <td class="keyHeader">
        <gr-button @click=${()=>this.showKey(e)} link=""
          >Click To View</gr-button
        >
      </td>
      <td>
        <gr-copy-clipboard
          hasTooltip
          buttonTitle="Copy GPG public key to clipboard"
          hideInput
          .text=${e.key}
        >
        </gr-copy-clipboard>
      </td>
      <td>
        <gr-button @click=${()=>this.handleDeleteKey(t)}
          >Delete</gr-button
        >
      </td>
    </tr>`}loadData(){return this.keys=[],this.restApiService.getAccountGPGKeys().then((e=>{e&&(this.keys=Object.keys(e).map((t=>{const i=e[t];return i.id=t,i})))}))}save(){const e=this.keysToRemove.map((e=>this.restApiService.deleteAccountGPGKey(e.id)));return Promise.all(e).then((()=>{this.keysToRemove=[],this.setHasUnsavedChanges(!1)}))}showKey(e){this.keyToView=e,this.viewKeyModal?.showModal()}handleNewKeyChanged(e){const t=e.target.value??"";this.newKey=t}handleDeleteKey(e){this.keysToRemove.push(this.keys[e]),this.keys.splice(e,1),this.requestUpdate(),this.setHasUnsavedChanges(!0)}handleAddKey(){return ba(this.newKeyTextarea),ba(this.addButton),this.addButton.disabled=!0,this.newKeyTextarea.disabled=!0,this.restApiService.addAccountGPGKey({add:[this.newKey.trim()]}).then((()=>{ba(this.newKeyTextarea),this.newKeyTextarea.disabled=!1,this.newKey="",this.loadData()})).catch((()=>{ba(this.newKeyTextarea),ba(this.addButton),this.addButton.disabled=!1,this.newKeyTextarea.disabled=!1}))}setHasUnsavedChanges(e){this.hasUnsavedChanges=e,Jn(this,"has-unsaved-changes-changed",{value:e})}};hB([Hc("#viewKeyModal")],pB.prototype,"viewKeyModal",void 0),hB([Hc("#addButton")],pB.prototype,"addButton",void 0),hB([Hc("#newKey")],pB.prototype,"newKeyTextarea",void 0),hB([Fc({type:Boolean})],pB.prototype,"hasUnsavedChanges",void 0),hB([Uc()],pB.prototype,"keys",void 0),hB([Uc()],pB.prototype,"keyToView",void 0),hB([Uc()],pB.prototype,"newKey",void 0),hB([Uc()],pB.prototype,"keysToRemove",void 0),pB=hB([Dc("gr-gpg-editor")],pB);var uB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let gB=class extends Ic{constructor(){super(...arguments),this._groups=[],this.restApiService=Xn().restApiService}loadData(){return this.restApiService.getAccountGroups().then((e=>{e&&(this._groups=e.sort(((e,t)=>(e.name||"").localeCompare(t.name||""))))}))}static get styles(){return[Nc,my,Sd`
        #groups .nameColumn {
          min-width: 11em;
          width: auto;
        }
        .descriptionHeader {
          min-width: 21.5em;
        }
        .visibleCell {
          text-align: center;
          width: 6em;
        }
      `]}render(){return dc` <div class="gr-form-styles">
      <table id="groups">
        <thead>
          <tr>
            <th class="nameHeader">Name</th>
            <th class="descriptionHeader">Description</th>
            <th class="visibleCell">Visible to all</th>
          </tr>
        </thead>
        <tbody>
          ${(this._groups??[]).map((e=>{const t=this._computeGroupPath(e)??"";return dc`
              <tr>
                <td class="nameColumn">
                  <a href=${t}> ${e.name} </a>
                </td>
                <td>${e.description}</td>
                <td class="visibleCell">
                  ${e?.options?.visible_to_all?"Yes":"No"}
                </td>
              </tr>
            `}))}
        </tbody>
      </table>
    </div>`}_computeGroupPath(e){if(e?.id)return iw({groupId:decodeURIComponent(e.id)})}};uB([Uc()],gB.prototype,"_groups",void 0),gB=uB([Dc("gr-group-list")],gB);var mB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let fB=class extends Ic{constructor(){super(),this.loading=!1,this.passwordUrl=null,this.maxLifetime="unlimited",this.tokens=[],this.newTokenId="",this.newLifetime="",this.restApiService=Xn().restApiService,this.getConfigModel=yu(this,Qw),this.getUserModel=yu(this,jf),zf(this,(()=>this.getConfigModel().serverConfig$),(e=>{e?(this.passwordUrl=e.auth.http_password_url||null,this.maxLifetime=e.auth.max_token_lifetime||"unlimited"):(this.passwordUrl=null,this.maxLifetime="unlimited")})),zf(this,(()=>this.getUserModel().account$),(e=>{e&&(this.username=e.username)}))}static get styles(){return[Jy,Nc,my,Iw,Sd`
        .token {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
        }
        #deleteAuthTokenModal {
          padding: var(--spacing-xxl);
          width: 50em;
        }
        #generatedAuthTokenModal {
          padding: var(--spacing-xxl);
          width: 50em;
        }
        #generatedAuthTokenDisplay {
          margin: var(--spacing-l) 0;
        }
        #generatedAuthTokenDisplay .title {
          width: unset;
        }
        #generatedAuthTokenDisplay .value {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
        }
        #authTokenWarning {
          font-style: italic;
          text-align: center;
        }
        #existing {
          margin-top: var(--spacing-l);
          margin-bottom: var(--spacing-l);
        }
        #existing .idColumn {
          min-width: 15em;
          width: auto;
        }
        .closeButton {
          bottom: 2em;
          position: absolute;
          right: 2em;
        }
        .expired {
          color: var(--negative-red-text-color);
        }
        .lifeTimeInput {
          min-width: 23em;
        }
        #legacyPasswordNote {
          width: 100%;
          background: var(--label-background);
          padding: 1em;
        }
      `]}render(){return dc` <div class="gr-form-styles">
        <div ?hidden=${!!this.passwordUrl}>
          <section>
            <span class="title">Username</span>
            <span class="value">${this.username??""}</span>
          </section>

          <section
            ?hidden=${!(1===this.tokens.length&&"legacy"===this.tokens[0].id)}
          >
            ${this.renderLegacyPasswordNote()}
          </section>

          <fieldset id="existing">
            <table>
              <thead>
                <tr>
                  <th class="idColumn">ID</th>
                  <th class="expirationColumn">Expiration Date</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                ${this.tokens.map((e=>this.renderToken(e)))}
              </tbody>
              <tfoot>
                ${this.renderFooterRow()}
              </tfoot>
            </table>
          </fieldset>
        </div>
        <span ?hidden=${!this.passwordUrl}>
          <a
            href=${this.passwordUrl}
            target="_blank"
            rel="noopener noreferrer"
          >
            Obtain password</a
          >
          (opens in a new tab)
        </span>
      </div>
      <dialog
        tabindex="-1"
        id="generatedAuthTokenModal"
        @closed=${this.generatedAuthTokenModalClosed}
      >
        <div class="gr-form-styles">
          <section id="generatedAuthTokenDisplay">
            <span class="title">New Token:</span>
            <span class="value"
              >${this.status||this.generatedAuthToken?.token}</span
            >
            <gr-copy-clipboard
              hasTooltip=""
              buttonTitle="Copy token to clipboard"
              hideInput=""
              .text=${this.status?"":this.generatedAuthToken?.token}
            >
            </gr-copy-clipboard>
          </section>
          <section
            id="authTokenWarning"
            ?hidden=${!this.generatedAuthToken?.expiration}
          >
            This token will be valid until &nbsp;
            <gr-date-formatter
              showDateAndTime
              withTooltip
              .dateStr=${this.generatedAuthToken?.expiration}
            ></gr-date-formatter>
            .
          </section>
          <section id="authTokenWarning">
            This token will not be displayed again.<br />
            If you lose it, you will need to generate a new one.
          </section>
          <gr-button
            link=""
            class="closeButton"
            @click=${this.closeGenerateModal}
            >Close</gr-button
          >
        </div>
      </dialog>
      <dialog tabindex="-1" id="deleteAuthTokenModal">
        <gr-dialog
          id="deleteDialog"
          class="confirmDialog"
          confirm-label="Delete"
          confirm-on-enter
          @confirm=${()=>this.handleDeleteAuthTokenConfirmed()}
          @cancel=${()=>this.closeDeleteModal()}
        >
          <div class="header" slot="header">Delete Authentication Token</div>
          <div class="main" slot="main">
            <section>
              Do you really want to delete the token? The deletion cannot be
              reverted.
            </section>
          </div>
        </gr-dialog>
      </dialog>`}renderLegacyPasswordNote(){return dc`<div id="legacyPasswordNote">
      This account only has a legacy HTTP password configured. The legacy HTTP
      password will be accepted until the first authentication token has been
      created. At this point the HTTP password will be removed from the account.
    </div>`}renderToken(e){return dc` <tr class=${this.isTokenExpired(e)?"expired":""}>
      <td class="idColumn">${e.id}</td>
      <td class="expirationColumn">
        <gr-date-formatter
          withTooltip
          showDateAndTime
          dateFormat="STD"
          .dateStr=${e.expiration}
        ></gr-date-formatter>
      </td>
      <td>
        <gr-button
          id="deleteButton"
          aria-label=${`delete token ${e.id}`}
          @click=${()=>this.handleDeleteTap(e.id)}
          >Delete</gr-button
        >
      </td>
    </tr>`}renderFooterRow(){return dc`
      <tr>
        <th style="vertical-align: top;">
          <md-outlined-text-field
            id="newToken"
            class="showBlueFocusBorder"
            placeholder="New Token ID"
            .value=${this.newTokenId??""}
            @input=${e=>{const t=e.target;this.newTokenId=t.value}}
            @keydown=${this.handleInputKeydown}
          >
          </md-outlined-text-field>
        </th>
        <th style="vertical-align: top;">
          <md-outlined-text-field
            id="lifetime"
            class="lifeTimeInput showBlueFocusBorder"
            placeholder="Lifetime (e.g. 30d)"
            supporting-text="Max. allowed lifetime: ${this.formatDuration(this.maxLifetime)}. Leave empty to use maximum allowed lifetime."
            .value=${this.newLifetime??""}
            @input=${e=>{const t=e.target;this.newLifetime=t.value}}
            @keydown=${this.handleInputKeydown}
          >
          </md-outlined-text-field>
        </th>
        <th>
          <gr-button
            id="generateButton"
            link=""
            ?loading=${this.loading}
            ?disabled=${!this.newTokenId.length}
            @click=${this.handleGenerateTap}
            >Generate</gr-button
          >
        </th>
      </tr>
    `}formatDuration(e){if(!e)return"";if("unlimited"===e)return"unlimited";let t=parseInt(e,10),i=Math.floor(t/60);t%=60;let r=Math.floor(i/24);i%=24;const o=Math.floor(r/365);r%=365;let s="";return o&&(s+=`${o}y `),r&&(s+=`${r}d `),i&&(s+=`${i}h `),t&&(s+=`${t}m`),s}loadData(){return this.restApiService.getAccountAuthTokens().then((e=>{e&&(this.tokens=e)}))}isTokenExpired(e){return!!e.expiration&&Wm(e.expiration)<new Date}handleGenerateTap(){this.loading=!0,this.status="Generating...",this.generatedAuthTokenModal?.showModal(),this.restApiService.generateAccountAuthToken(this.newTokenId,this.newLifetime).then((e=>{e?(this.generatedAuthToken=e,this.status=void 0,this.loadData(),this.tokenInput.value="",this.tokenInput.dispatchEvent(new Event("input",{bubbles:!0})),this.tokenLifetime.value="",this.tokenLifetime.dispatchEvent(new Event("input",{bubbles:!0}))):this.status="Failed to generate"})).finally((()=>{this.loading=!1}))}handleDeleteTap(e){this.deleteAuthTokenModal?.setAttribute("tokenId",e),this.deleteAuthTokenModal?.showModal()}handleDeleteAuthTokenConfirmed(){const e=this.deleteAuthTokenModal?.getAttribute("tokenId");null!=e&&this.restApiService.deleteAccountAuthToken(e).then((()=>{this.loadData()})).catch((e=>{ea(this,`Failed to delete token: ${e}`)})).finally((()=>{this.closeDeleteModal()}))}closeGenerateModal(){this.generatedAuthTokenModal?.close()}closeDeleteModal(){this.deleteAuthTokenModal?.close()}generatedAuthTokenModalClosed(){this.status=void 0,this.generatedAuthToken=void 0}handleInputKeydown(e){"Enter"===e.key&&(e.stopPropagation(),this.handleGenerateTap())}};mB([Hc("#generatedAuthTokenModal")],fB.prototype,"generatedAuthTokenModal",void 0),mB([Hc("#deleteAuthTokenModal")],fB.prototype,"deleteAuthTokenModal",void 0),mB([Uc()],fB.prototype,"loading",void 0),mB([Uc()],fB.prototype,"username",void 0),mB([Uc()],fB.prototype,"generatedAuthToken",void 0),mB([Uc()],fB.prototype,"status",void 0),mB([Uc()],fB.prototype,"passwordUrl",void 0),mB([Uc()],fB.prototype,"maxLifetime",void 0),mB([Fc({type:Array})],fB.prototype,"tokens",void 0),mB([Fc({type:String})],fB.prototype,"newTokenId",void 0),mB([Fc({type:String})],fB.prototype,"newLifetime",void 0),mB([Hc("#generateButton")],fB.prototype,"generateButton",void 0),mB([Hc("#newToken")],fB.prototype,"tokenInput",void 0),mB([Hc("#lifetime")],fB.prototype,"tokenLifetime",void 0),fB=mB([Dc("gr-auth-token")],fB);var vB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const bB=[Pu.OPENID,Pu.OAUTH];let yB=class extends Ic{constructor(){super(...arguments),this.identities=[],this.showLinkAnotherIdentity=!1,this.restApiService=Xn().restApiService}static get styles(){return[Nc,my,Iw,Sd`
        tr th.emailAddressHeader,
        tr th.identityHeader {
          width: 15em;
          padding: 0 10px;
        }
        tr td.statusColumn,
        tr td.emailAddressColumn,
        tr td.identityColumn {
          overflow-wrap: anywhere;
        }
        tr td.emailAddressColumn,
        tr td.identityColumn {
          padding: 4px 10px;
          width: 15em;
        }
        .deleteButton {
          float: right;
        }
        .deleteButton:not(.show) {
          display: none;
        }
        .space {
          margin-bottom: var(--spacing-l);
        }
      `]}render(){return dc`<div class="gr-form-styles">
        <fieldset class="space">
          <table>
            <thead>
              <tr>
                <th class="statusHeader">Status</th>
                <th class="emailAddressHeader">Email Address</th>
                <th class="identityHeader">Identity</th>
                <th class="deleteHeader"></th>
              </tr>
            </thead>
            <tbody>
              ${this.getIdentities().map(((e,t)=>this.renderIdentity(e,t)))}
            </tbody>
          </table>
        </fieldset>
        ${eb(this.showLinkAnotherIdentity,(()=>dc`<fieldset>
            <a href=${this.computeLinkAnotherIdentity()}>
              <gr-button id="linkAnotherIdentity" link=""
                >Link Another Identity</gr-button
              >
            </a>
          </fieldset>`))}
      </div>
      <dialog id="modal" tabindex="-1">
        <gr-confirm-delete-item-dialog
          class="confirmDialog"
          @confirm=${this.handleDeleteItemConfirm}
          @cancel=${this.handleConfirmDialogCancel}
          .item=${this.idName}
          itemtypename="ID"
        ></gr-confirm-delete-item-dialog>
      </dialog>`}renderIdentity(e,t){return dc`<tr>
      <td class="statusColumn">${e.trusted?"":"Untrusted"}</td>
      <td class="emailAddressColumn">${e.email_address}</td>
      <td class="identityColumn">
        ${e.identity.startsWith("mailto:")?"":e.identity}
      </td>
      <td class="deleteColumn">
        <gr-button
          data-index=${t}
          class=${th({deleteButton:!0,show:!!e.can_delete})}
          @click=${()=>this.handleDeleteItem(e.identity)}
        >
          Delete
        </gr-button>
      </td>
    </tr>`}willUpdate(e){e.has("serverConfig")&&(this.showLinkAnotherIdentity=this.computeShowLinkAnotherIdentity())}getIdentities(){return this.identities.filter((e=>!e.identity.startsWith("username:")))}loadData(){return this.restApiService.getExternalIds().then((e=>{this.identities=e??[]}))}_computeHideDeleteClass(e){return e?"show":""}handleDeleteItemConfirm(){return this.modal?.close(),ba(this.idName),this.restApiService.deleteAccountIdentity([this.idName]).then((()=>{this.loadData()}))}handleConfirmDialogCancel(){this.modal?.close()}handleDeleteItem(e){this.idName=e,this.modal?.showModal()}computeShowLinkAnotherIdentity(){return!!this.serverConfig?.auth?.auth_type&&bB.includes(this.serverConfig.auth.auth_type)}computeLinkAnotherIdentity(){const e=Sf()||"";let t=window.location.pathname;return e&&(t="/"+t.substring(e.length)),e+"/login/"+encodeURIComponent(t)+"?link"}};vB([Hc("#modal")],yB.prototype,"modal",void 0),vB([Uc()],yB.prototype,"identities",void 0),vB([Uc()],yB.prototype,"idName",void 0),vB([Fc({type:Object})],yB.prototype,"serverConfig",void 0),vB([Uc()],yB.prototype,"showLinkAnotherIdentity",void 0),yB=vB([Dc("gr-identities")],yB);var wB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let _B=class extends Ic{constructor(){super(),this.menuItems=[],this.originalPrefs=Eg(),this.newName="",this.newUrl="",this.newTarget=!1,this.getUserModel=yu(this,jf),zf(this,(()=>this.getUserModel().preferences$),(e=>{this.originalPrefs=e,this.menuItems=[...e.my]}))}static get styles(){return[Jy,my,Nc,Qb,N_,Sd`
        .buttonColumn {
          width: 2em;
        }
        .moveUpButton,
        .moveDownButton {
          width: 100%;
        }
        tbody tr:first-of-type td .moveUpButton,
        tbody tr:last-of-type td .moveDownButton {
          display: none;
        }
        td.urlCell {
          overflow-wrap: anywhere;
        }
        .newUrlInput {
          min-width: 23em;
        }
        th {
          white-space: nowrap;
        }
      `]}render(){const e=sf(this.menuItems,this.originalPrefs.my);return dc`
      <div class="gr-form-styles">
        <h2 id="Menu" class=${th({"heading-2":!0,edited:!e})}>Menu</h2>
        <fieldset id="menu">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>URL</th>
                <th>New Tab</th>
                <th></th>
                <th></th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              ${this.menuItems.map(((e,t)=>this.renderMenuItemRow(e,t)))}
            </tbody>
            <tfoot>
              ${this.renderFooterRow()}
            </tfoot>
          </table>
          <gr-button id="save" @click=${this.handleSave} ?disabled=${e}
            >Save Changes</gr-button
          >
          <gr-button id="reset" link @click=${this.handleReset}
            >Reset</gr-button
          >
        </fieldset>
      </div>
    `}renderMenuItemRow(e,t){return dc`
      <tr>
        <td>${e.name}</td>
        <td class="urlCell">${e.url}</td>
        <td>
          <md-checkbox
            disabled
            ?checked=${"_blank"===e.target}
          ></md-checkbox>
        </td>
        <td class="buttonColumn">
          <gr-button
            link
            data-index=${t}
            @click=${()=>this.swapItems(t,t-1)}
            class="moveUpButton"
            >↑</gr-button
          >
        </td>
        <td class="buttonColumn">
          <gr-button
            link
            data-index=${t}
            @click=${()=>this.swapItems(t,t+1)}
            class="moveDownButton"
            >↓</gr-button
          >
        </td>
        <td>
          <gr-button
            link
            data-index=${t}
            @click=${()=>{this.menuItems.splice(t,1),this.requestUpdate("menuItems")}}
            class="remove-button"
            >Delete</gr-button
          >
        </td>
      </tr>
    `}renderFooterRow(){return dc`
      <tr>
        <th>
          <md-outlined-text-field
            class="showBlueFocusBorder"
            placeholder="New Title"
            .value=${this.newName??""}
            @input=${e=>{const t=e.target;this.newName=t.value}}
            @keydown=${this.handleInputKeydown}
          >
          </md-outlined-text-field>
        </th>
        <th>
          <md-outlined-text-field
            class="newUrlInput showBlueFocusBorder"
            placeholder="New URL"
            .value=${this.newUrl??""}
            @input=${e=>{const t=e.target;this.newUrl=t.value}}
            @keydown=${this.handleInputKeydown}
          >
          </md-outlined-text-field>
        </th>
        <th>
          <md-checkbox
            id="lineWrappingInput"
            ?checked=${this.newTarget}
            @change=${()=>this.newTarget=!this.newTarget}
          ></md-checkbox>
        </th>
        <th></th>
        <th></th>
        <th>
          <gr-button
            id="add"
            link
            ?disabled=${0===this.newName.length||0===this.newUrl.length}
            @click=${this.handleAddButton}
            >Add</gr-button
          >
        </th>
      </tr>
    `}handleSave(){this.getUserModel().updatePreferences({...this.originalPrefs,my:this.menuItems})}handleReset(){this.menuItems=[...this.originalPrefs.my]}swapItems(e,t){const i=this.menuItems.length-1;if(e<0||t<0)return;if(e>i||t>i)return;const r=this.menuItems[e];this.menuItems[e]=this.menuItems[t],this.menuItems[t]=r,this.requestUpdate("menuItems")}handleAddButton(){0!==this.newName.length&&0!==this.newUrl.length&&(this.menuItems.push({name:this.newName,url:this.newUrl,target:this.newTarget?"_blank":void 0}),this.newName="",this.newUrl="",this.requestUpdate("menuItems"))}handleInputKeydown(e){"Enter"===e.key&&(e.stopPropagation(),this.handleAddButton())}};wB([Uc()],_B.prototype,"menuItems",void 0),wB([Uc()],_B.prototype,"originalPrefs",void 0),wB([Uc()],_B.prototype,"newName",void 0),wB([Uc()],_B.prototype,"newUrl",void 0),wB([Uc()],_B.prototype,"newTarget",void 0),_B=wB([Dc("gr-menu-editor")],_B);var xB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let CB=class extends Ic{constructor(){super(),this.docsBaseUrl="",this.getUserModel=yu(this,jf),this.getConfigModel=yu(this,Qw),this.getPluginLoader=yu(this,U_),this.flagsService=Xn().flagsService,zf(this,(()=>this.getUserModel().preferences$),(e=>{this.originalPrefs=e,this.prefs={...e}})),zf(this,(()=>this.getUserModel().account$),(e=>{this.account=e})),zf(this,(()=>this.getConfigModel().docsBaseUrl$),(e=>this.docsBaseUrl=e)),zf(this,(()=>this.getPluginLoader().pluginsModel.suggestionsPlugins$),(e=>this.suggestionsProvider=e?.[0]?.provider))}static get styles(){return[Nc,N_,my,Jy,Sd`
        :host {
          border: none;
          margin-bottom: var(--spacing-xxl);
        }
        h2 {
          font-family: var(--header-font-family);
          font-size: var(--font-size-h2);
          font-weight: var(--font-weight-h2);
          line-height: var(--line-height-h2);
        }
        md-checkbox {
          --md-checkbox-container-size: 15px;
          --md-checkbox-icon-size: 15px;
        }
      `]}render(){return dc`
      <h2 id="Preferences" class=${this.hasUnsavedChanges()?"edited":""}>
        Preferences
      </h2>
      <fieldset id="preferences">
        <div id="preferences" class="gr-form-styles">
          <section>
            <label class="title" for="themeSelect">Theme</label>
            <span class="value">
              <md-outlined-select
                value=${this.prefs?.theme??mg.AUTO}
                @change=${e=>{const t=e.target;this.prefs.theme=t.value,this.requestUpdate()}}
              >
                <md-select-option value="AUTO">
                  <div slot="headline">Auto (based on OS prefs)</div>
                </md-select-option>
                <md-select-option value="LIGHT">
                  <div slot="headline">Light</div>
                </md-select-option>
                <md-select-option value="DARK">
                  <div slot="headline">Dark</div>
                </md-select-option>
              </md-outlined-select>
            </span>
          </section>
          <section>
            <label class="title" for="changesPerPageSelect"
              >Changes per page</label
            >
            <span class="value">
              <md-outlined-select
                value=${Lg(this.prefs?.changes_per_page)}
                @change=${e=>{const t=e.target;this.prefs.changes_per_page=Number(t.value),this.requestUpdate()}}
              >
                <md-select-option value="10">
                  <div slot="headline">10 rows per page</div>
                </md-select-option>
                <md-select-option value="25">
                  <div slot="headline">25 rows per page</div>
                </md-select-option>
                <md-select-option value="50">
                  <div slot="headline">50 rows per page</div>
                </md-select-option>
                <md-select-option value="100">
                  <div slot="headline">100 rows per page</div>
                </md-select-option>
              </md-outlined-select>
            </span>
          </section>
          <section>
            <label class="title" for="dateTimeFormatSelect"
              >Date/time format</label
            >
            <span class="value">
              <md-outlined-select
                value=${Lg(this.prefs?.date_format)}
                @change=${e=>{const t=e.target;this.prefs.date_format=t.value,this.requestUpdate()}}
              >
                <md-select-option value="STD">
                  <div slot="headline">Jun 3 ; Jun 3, 2016</div>
                </md-select-option>
                <md-select-option value="US">
                  <div slot="headline">06/03 ; 06/03/16</div>
                </md-select-option>
                <md-select-option value="ISO">
                  <div slot="headline">06-03 ; 2016-06-03</div>
                </md-select-option>
                <md-select-option value="EURO">
                  <div slot="headline">3. Jun ; 03.06.2016</div>
                </md-select-option>
                <md-select-option value="UK">
                  <div slot="headline">03/06 ; 03/06/2016</div>
                </md-select-option>
              </md-outlined-select>
              <md-outlined-select
                value=${Lg(this.prefs?.time_format)}
                @change=${e=>{const t=e.target;this.prefs.time_format=t.value,this.requestUpdate()}}
              >
                <md-select-option value="HHMM_12">
                  <div slot="headline">4:10 PM</div>
                </md-select-option>
                <md-select-option value="HHMM_24">
                  <div slot="headline">16:10</div>
                </md-select-option>
              </md-outlined-select>
            </span>
          </section>
          <section>
            <label class="title" for="emailNotificationsSelect"
              >Email notifications</label
            >
            <span class="value">
              <md-outlined-select
                value=${Lg(this.prefs?.email_strategy)}
                @change=${e=>{const t=e.target;this.prefs.email_strategy=t.value,this.requestUpdate()}}
              >
                <md-select-option value="CC_ON_OWN_COMMENTS">
                  <div slot="headline">Every comment</div>
                </md-select-option>
                <md-select-option value="ENABLED">
                  <div slot="headline">Only comments left by others</div>
                </md-select-option>
                <md-select-option value="ATTENTION_SET_ONLY">
                  <div slot="headline">Only when I am in the attention set</div>
                </md-select-option>
              </md-outlined-select>
            </span>
          </section>
          <section>
            <label class="title" for="emailFormatSelect">Email format</label>
            <span class="value">
              <md-outlined-select
                value=${Lg(this.prefs?.email_format)}
                @change=${e=>{const t=e.target;this.prefs.email_format=t.value,this.requestUpdate()}}
              >
                <md-select-option value="HTML_PLAINTEXT">
                  <div slot="headline">HTML and plaintext</div>
                </md-select-option>
                <md-select-option value="PLAINTEXT">
                  <div slot="headline">Plaintext only</div>
                </md-select-option>
              </md-outlined-select>
            </span>
          </section>
          ${this.renderBrowserNotifications()}
          ${this.renderGenerateSuggestionWhenCommenting()}
          ${this.renderAiCommentAutocompletion()}
          ${this.renderDefaultBaseForMerges()}
          <section>
            <label class="title" for="relativeDateInChangeTable"
              >Show Relative Dates In Changes Table</label
            >
            <span class="value">
              <md-checkbox
                id="relativeDateInChangeTable"
                ?checked=${!!this.prefs?.relative_date_in_change_table}
                @change=${()=>{this.prefs.relative_date_in_change_table=this.relativeDateInChangeTable.checked,this.requestUpdate()}}
              ></md-checkbox>
            </span>
          </section>
          <section>
            <span class="title">Diff view</span>
            <span class="value">
              <md-outlined-select
                value=${Lg(this.prefs?.diff_view)}
                @change=${e=>{const t=e.target;this.prefs.diff_view=t.value,this.requestUpdate()}}
              >
                <md-select-option value="SIDE_BY_SIDE">
                  <div slot="headline">Side by side</div>
                </md-select-option>
                <md-select-option value="UNIFIED_DIFF">
                  <div slot="headline">Unified diff</div>
                </md-select-option>
              </md-outlined-select>
            </span>
          </section>
          <section>
            <label for="showSizeBarsInFileList" class="title"
              >Show size bars in file list</label
            >
            <span class="value">
              <md-checkbox
                id="showSizeBarsInFileList"
                ?checked=${!!this.prefs?.size_bar_in_change_table}
                @change=${()=>{this.prefs.size_bar_in_change_table=this.showSizeBarsInFileList.checked,this.requestUpdate()}}
              ></md-checkbox>
            </span>
          </section>
          <section>
            <label for="publishCommentsOnPush" class="title"
              >Publish comments on push</label
            >
            <span class="value">
              <md-checkbox
                id="publishCommentsOnPush"
                ?checked=${!!this.prefs?.publish_comments_on_push}
                @change=${()=>{this.prefs.publish_comments_on_push=this.publishCommentsOnPush.checked,this.requestUpdate()}}
              ></md-checkbox>
            </span>
          </section>
          <section>
            <label for="workInProgressByDefault" class="title"
              >Set new changes to "work in progress" by default</label
            >
            <span class="value">
              <md-checkbox
                id="workInProgressByDefault"
                ?checked=${!!this.prefs?.work_in_progress_by_default}
                @change=${()=>{this.prefs.work_in_progress_by_default=this.workInProgressByDefault.checked,this.requestUpdate()}}
              ></md-checkbox>
            </span>
          </section>
          <section>
            <label for="disableKeyboardShortcuts" class="title"
              >Disable all keyboard shortcuts</label
            >
            <span class="value">
              <md-checkbox
                id="disableKeyboardShortcuts"
                ?checked=${!!this.prefs?.disable_keyboard_shortcuts}
                @change=${()=>{this.prefs.disable_keyboard_shortcuts=this.disableKeyboardShortcuts.checked,this.requestUpdate()}}
              ></md-checkbox>
            </span>
          </section>
          <section>
            <label for="disableTokenHighlighting" class="title"
              >Disable token highlighting on hover</label
            >
            <span class="value">
              <md-checkbox
                id="disableTokenHighlighting"
                ?checked=${!!this.prefs?.disable_token_highlighting}
                @change=${()=>{this.prefs.disable_token_highlighting=this.disableTokenHighlighting.checked,this.requestUpdate()}}
              ></md-checkbox>
            </span>
          </section>
          <section>
            <label for="insertSignedOff" class="title">
              Insert Signed-off-by Footer For Inline Edit Changes
            </label>
            <span class="value">
              <md-checkbox
                id="insertSignedOff"
                ?checked=${!!this.prefs?.signed_off_by}
                @change=${()=>{this.prefs.signed_off_by=this.insertSignedOff.checked,this.requestUpdate()}}
              ></md-checkbox>
            </span>
          </section>
        </div>
        <gr-button
          id="savePrefs"
          @click=${async()=>{await this.save()}}
          ?disabled=${!this.hasUnsavedChanges()}
          >Save Changes</gr-button
        >
      </fieldset>
    `}renderBrowserNotifications(){return this.flagsService.isEnabled(da.PUSH_NOTIFICATIONS_DEVELOPER)||xT(this.account)?dc` <section id="allowBrowserNotificationsSection">
      <div class="title">
        <label for="allowBrowserNotifications"
          >Allow browser notifications</label
        >
        <a
          href=${$f(this.docsBaseUrl,"user-attention-set.html#_browser_notifications")}
          target="_blank"
          rel="noopener noreferrer"
        >
          <gr-icon icon="help" title="read documentation"></gr-icon>
        </a>
      </div>
      <span class="value">
        <md-checkbox
          id="allowBrowserNotifications"
          ?checked=${!!this.prefs?.allow_browser_notifications}
          @change=${()=>{this.prefs.allow_browser_notifications=this.allowBrowserNotifications.checked,this.requestUpdate()}}
        ></md-checkbox>
      </span>
    </section>`:uc}renderGenerateSuggestionWhenCommenting(){return this.flagsService.isEnabled(da.ML_SUGGESTED_EDIT_V2)&&!this.flagsService.isEnabled(da.ML_SUGGESTED_EDIT_UNCHECK_BY_DEFAULT)&&this.suggestionsProvider?dc`
      <section id="allowSuggestCodeWhileCommentingSection">
        <div class="title">
          <label for="allowSuggestCodeWhileCommenting"
            >AI suggested fixes while commenting</label
          >
          <a
            href=${this.suggestionsProvider.getDocumentationLink?.()||$f(this.docsBaseUrl,"user-suggest-edits.html#_generate_suggestion")}
            target="_blank"
            rel="noopener noreferrer"
          >
            <gr-icon icon="help" title="read documentation"></gr-icon>
          </a>
        </div>
        <span class="value">
          <md-checkbox
            id="allowSuggestCodeWhileCommenting"
            ?checked=${!!this.prefs?.allow_suggest_code_while_commenting}
            @change=${()=>{this.prefs.allow_suggest_code_while_commenting=this.allowSuggestCodeWhileCommenting.checked,this.requestUpdate()}}
          ></md-checkbox>
        </span>
      </section>
    `:uc}renderAiCommentAutocompletion(){return this.suggestionsProvider?dc`
      <section id="allowAiCommentAutocompletionSection">
        <div class="title">
          <label for="allowAiCommentAutocompletion"
            >AI suggested text completions while commenting</label
          >
        </div>
        <span class="value">
          <md-checkbox
            id="allowAiCommentAutocompletion"
            ?checked=${!!this.prefs?.allow_autocompleting_comments}
            @change=${()=>{this.prefs.allow_autocompleting_comments=this.allowAiCommentAutocompletion.checked,this.requestUpdate()}}
          ></md-checkbox>
        </span>
      </section>
    `:uc}renderDefaultBaseForMerges(){return this.prefs,uc}hasUnsavedChanges(){return this.originalPrefs?.theme!==this.prefs?.theme||this.originalPrefs?.changes_per_page!==this.prefs?.changes_per_page||this.originalPrefs?.date_format!==this.prefs?.date_format||this.originalPrefs?.time_format!==this.prefs?.time_format||this.originalPrefs?.email_strategy!==this.prefs?.email_strategy||this.originalPrefs?.email_format!==this.prefs?.email_format||Boolean(this.originalPrefs?.allow_browser_notifications)!==Boolean(this.prefs?.allow_browser_notifications)||Boolean(this.originalPrefs?.allow_suggest_code_while_commenting)!==Boolean(this.prefs?.allow_suggest_code_while_commenting)||Boolean(this.originalPrefs?.allow_autocompleting_comments)!==Boolean(this.prefs?.allow_autocompleting_comments)||this.originalPrefs?.default_base_for_merges!==this.prefs?.default_base_for_merges||Boolean(this.originalPrefs?.relative_date_in_change_table)!==Boolean(this.prefs?.relative_date_in_change_table)||this.originalPrefs?.diff_view!==this.prefs?.diff_view||Boolean(this.originalPrefs?.size_bar_in_change_table)!==Boolean(this.prefs?.size_bar_in_change_table)||Boolean(this.originalPrefs?.publish_comments_on_push)!==Boolean(this.prefs?.publish_comments_on_push)||Boolean(this.originalPrefs?.work_in_progress_by_default)!==Boolean(this.prefs?.work_in_progress_by_default)||Boolean(this.originalPrefs?.disable_keyboard_shortcuts)!==Boolean(this.prefs?.disable_keyboard_shortcuts)||Boolean(this.originalPrefs?.disable_token_highlighting)!==Boolean(this.prefs?.disable_token_highlighting)||Boolean(this.originalPrefs?.signed_off_by)!==Boolean(this.prefs?.signed_off_by)}async save(){this.prefs&&await this.getUserModel().updatePreferences(this.prefs)}};xB([Hc("#allowBrowserNotifications")],CB.prototype,"allowBrowserNotifications",void 0),xB([Hc("#allowSuggestCodeWhileCommenting")],CB.prototype,"allowSuggestCodeWhileCommenting",void 0),xB([Hc("#allowAiCommentAutocompletion")],CB.prototype,"allowAiCommentAutocompletion",void 0),xB([Hc("#relativeDateInChangeTable")],CB.prototype,"relativeDateInChangeTable",void 0),xB([Hc("#showSizeBarsInFileList")],CB.prototype,"showSizeBarsInFileList",void 0),xB([Hc("#publishCommentsOnPush")],CB.prototype,"publishCommentsOnPush",void 0),xB([Hc("#workInProgressByDefault")],CB.prototype,"workInProgressByDefault",void 0),xB([Hc("#disableKeyboardShortcuts")],CB.prototype,"disableKeyboardShortcuts",void 0),xB([Hc("#disableTokenHighlighting")],CB.prototype,"disableTokenHighlighting",void 0),xB([Hc("#insertSignedOff")],CB.prototype,"insertSignedOff",void 0),xB([Uc()],CB.prototype,"prefs",void 0),xB([Uc()],CB.prototype,"originalPrefs",void 0),xB([Uc()],CB.prototype,"account",void 0),xB([Uc()],CB.prototype,"docsBaseUrl",void 0),xB([Uc()],CB.prototype,"suggestionsProvider",void 0),CB=xB([Dc("gr-preferences")],CB);var EB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let SB=class extends Ic{constructor(){super(...arguments),this.hasUnsavedChanges=!1,this.keys=[],this.newKey="",this.keysToRemove=[],this.prevHasUnsavedChanges=!1,this.restApiService=Xn().restApiService}static get styles(){return[my,vy,Nc,Iw,Sd`
        .statusHeader {
          width: 4em;
        }
        .keyHeader {
          width: 7.5em;
        }
        #viewKeyModal {
          padding: var(--spacing-xxl);
          width: 50em;
        }
        .publicKey {
          font-family: var(--monospace-font-family);
          font-size: var(--font-size-mono);
          line-height: var(--line-height-mono);
          overflow-x: scroll;
          overflow-wrap: break-word;
          width: 30em;
        }
        .closeButton {
          bottom: 2em;
          position: absolute;
          right: 2em;
        }
        #existing {
          margin-bottom: var(--spacing-l);
        }
        #existing .commentColumn {
          min-width: 27em;
          width: auto;
        }
        gr-autogrow-textarea {
          background-color: var(--view-background-color);
          --gr-autogrow-textarea-border-width: 0px;
          --gr-autogrow-textarea-border-color: var(--border-color);
        }
        gr-autogrow-textarea:focus {
          border: 2px solid var(--input-focus-border-color);
        }
      `]}updated(e){if(e.has("hasUnsavedChanges")){if(this.prevHasUnsavedChanges===this.hasUnsavedChanges)return;this.prevHasUnsavedChanges=this.hasUnsavedChanges,Jn(this,"has-unsaved-changes-changed",{value:this.hasUnsavedChanges})}}render(){return dc`
      <div class="gr-form-styles">
        <fieldset id="existing">
          <table>
            <thead>
              <tr>
                <th class="commentColumn">Comment</th>
                <th class="statusHeader">Status</th>
                <th class="keyHeader">Public key</th>
                <th></th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              ${this.keys.map(((e,t)=>this.renderKey(e,t)))}
            </tbody>
          </table>
          <dialog id="viewKeyModal" tabindex="-1">
            <fieldset>
              <section>
                <span class="title">Algorithm</span>
                <span class="value">${this.keyToView?.algorithm}</span>
              </section>
              <section>
                <span class="title">Public key</span>
                <span class="value publicKey"
                  >${this.keyToView?.encoded_key}</span
                >
              </section>
              <section>
                <span class="title">Comment</span>
                <span class="value">${this.keyToView?.comment}</span>
              </section>
            </fieldset>
            <gr-button
              class="closeButton"
              @click=${()=>this.viewKeyModal.close()}
              >Close</gr-button
            >
          </dialog>
          <gr-button
            @click=${()=>this.save()}
            ?disabled=${!this.hasUnsavedChanges}
            >Save Changes</gr-button
          >
        </fieldset>
        <fieldset>
          <section>
            <span class="title">New SSH key</span>
            <span class="value">
              <gr-autogrow-textarea
                id="newKey"
                autocomplete="on"
                placeholder="New SSH Key"
                .value=${this.newKey}
                @input=${e=>{const t=e.target.value??"";this.newKey=t}}
              ></gr-autogrow-textarea>
            </span>
          </section>
          <gr-button
            id="addButton"
            ?disabled=${!this.newKey.length}
            @click=${()=>this.handleAddKey()}
            >Add New SSH Key</gr-button
          >
        </fieldset>
      </div>
    `}renderKey(e,t){return dc` <tr>
      <td class="commentColumn">${e.comment}</td>
      <td>${e.valid?"Valid":"Invalid"}</td>
      <td>
        <gr-button
          link=""
          @click=${e=>this.showKey(e)}
          data-index=${t}
          >Click To View</gr-button
        >
      </td>
      <td>
        <gr-copy-clipboard
          hasTooltip=""
          .buttonTitle=${"Copy SSH public key to clipboard"}
          hideInput=""
          .text=${e.ssh_public_key}
        >
        </gr-copy-clipboard>
      </td>
      <td>
        <gr-button
          link=""
          data-index=${t}
          @click=${e=>this.handleDeleteKey(e)}
          >Delete</gr-button
        >
      </td>
    </tr>`}loadData(){return this.restApiService.getAccountSSHKeys().then((e=>{e&&(this.keys=e)}))}save(){const e=this.keysToRemove.map((e=>this.restApiService.deleteAccountSSHKey(`${e.seq}`)));return Promise.all(e).then((()=>{this.keysToRemove=[],this.hasUnsavedChanges=!1}))}showKey(e){const t=e.target,i=Number(t.getAttribute("data-index"));this.keyToView=this.keys[i],this.viewKeyModal.showModal()}handleDeleteKey(e){const t=e.target,i=Number(t.getAttribute("data-index"));this.keysToRemove.push(this.keys[i]),this.keys.splice(i,1),this.requestUpdate(),this.hasUnsavedChanges=!0}handleAddKey(){return this.addButton.disabled=!0,this.newKeyEditor.disabled=!0,this.restApiService.addAccountSSHKey(this.newKey.trim()).then((e=>{this.newKeyEditor.disabled=!1,this.newKey="",this.keys.push(e),this.requestUpdate()})).catch((()=>{this.addButton.disabled=!1,this.newKeyEditor.disabled=!1}))}};EB([Fc({type:Boolean})],SB.prototype,"hasUnsavedChanges",void 0),EB([Fc({type:Array})],SB.prototype,"keys",void 0),EB([Fc({type:Object})],SB.prototype,"keyToView",void 0),EB([Fc({type:String})],SB.prototype,"newKey",void 0),EB([Fc({type:Array})],SB.prototype,"keysToRemove",void 0),EB([Uc()],SB.prototype,"prevHasUnsavedChanges",void 0),EB([Hc("#addButton")],SB.prototype,"addButton",void 0),EB([Hc("#newKey")],SB.prototype,"newKeyEditor",void 0),EB([Hc("#viewKeyModal")],SB.prototype,"viewKeyModal",void 0),SB=EB([Dc("gr-ssh-editor")],SB);var $B=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const kB=[{name:"Changes",key:"notify_new_changes"},{name:"Patches",key:"notify_new_patch_sets"},{name:"Comments",key:"notify_all_comments"},{name:"Submits",key:"notify_submitted_changes"},{name:"Abandons",key:"notify_abandoned_changes"}];let AB=class extends Ic{constructor(){super(...arguments),this.projectsToRemove=[],this.query=e=>this.getProjectSuggestions(e),this.restApiService=Xn().restApiService}static get styles(){return[Jy,Nc,my,Sd`
        #watchedProjects .notifType {
          text-align: center;
          padding: 0 var(--spacing-s);
        }
        .notifControl {
          cursor: pointer;
          text-align: center;
        }
        .notifControl:hover {
          outline: 1px solid var(--border-color);
        }
        .projectFilter {
          color: var(--deemphasized-text-color);
          font-style: italic;
          margin-left: var(--spacing-l);
        }
        .projectProblem {
          color: var(--error-text-color);
          margin-left: var(--spacing-l);
        }
        .newFilterInput {
          width: 100%;
        }
        md-checkbox {
          --md-checkbox-container-size: 15px;
          --md-checkbox-icon-size: 15px;
        }
      `]}render(){const e=kB;return dc` <div class="gr-form-styles">
      <table id="watchedProjects">
        <thead>
          <tr>
            <th>Repo</th>
            ${e.map((e=>dc`<th class="notifType">${e.name}</th>`))}
            <th></th>
          </tr>
        </thead>
        <tbody>
          ${(this.projects??[]).map((e=>this.renderProject(e)))}
        </tbody>
        <tfoot>
          <tr>
            <th>
              <gr-autocomplete
                id="newProject"
                .query=${this.query}
                threshold="1"
                allow-non-suggested-values
                tab-complete
                placeholder="Repo"
                .showBlueFocusBorder=${!0}
              ></gr-autocomplete>
            </th>
            <th colspan=${e.length}>
              <md-outlined-text-field
                id="newFilter"
                class="newFilterInput showBlueFocusBorder"
                placeholder="branch:name, or other search expression"
              >
              </md-outlined-text-field>
            </th>
            <th>
              <gr-button link="" @click=${this.handleAddProject}>Add</gr-button>
            </th>
          </tr>
        </tfoot>
      </table>
    </div>`}renderProject(e){const t=kB;return dc` <tr>
      <td>
        ${e.project}
        ${eb(e.filter,(()=>dc`<div class="projectFilter">${e.filter}</div>`))}
        ${eb(e.problem,(()=>dc`<div class="projectProblem" title="Consider removing watch">
              ${e.problem}
            </div>`))}
      </td>
      ${t.map((t=>this.renderNotifyControl(e,t.key)))}
      <td>
        <gr-button
          link=""
          @click=${t=>this.handleRemoveProject(e)}
          >Delete</gr-button
        >
      </td>
    </tr>`}renderNotifyControl(e,t){return dc` <td class="notifControl" @click=${this.handleNotifCellClick}>
      <md-checkbox
        data-key=${t}
        @change=${i=>this.handleCheckboxChange(e,t,i)}
        ?checked=${!!e[t]}
      ></md-checkbox>
    </td>`}loadData(){return this.restApiService.getWatchedProjects().then((e=>{this.originalProjects=e,this.projects=e?[...e]:[]}))}save(){let e;return e=this.projectsToRemove.length?this.restApiService.deleteWatchedProjects(this.projectsToRemove):Promise.resolve(void 0),e.then((()=>this.projects?this.restApiService.saveWatchedProjects(this.projects):Promise.resolve(void 0))).then((e=>{this.originalProjects=e,this.projects=e?[...e]:[],this.projectsToRemove=[],this.setHasUnsavedChanges()}))}getProjectSuggestions(e){return this.restApiService.getSuggestedRepos(e,void 0,Ff).then((e=>{const t=[];for(const[i,r]of Object.entries(e??{}))t.push({name:i,value:r.id});return t}))}handleRemoveProject(e){if(!this.projects||!this.originalProjects)return;const t=this.projects.indexOf(e);t<0||(this.projects.splice(t,1),this.originalProjects.includes(e)&&this.projectsToRemove.push(e),this.requestUpdate(),this.setHasUnsavedChanges())}canAddProject(e,t,i){if(null===e&&null===t)return!1;if(!e&&t)return!0;if(!this.projects)return!0;for(let t=0;t<this.projects.length;t++)if(this.projects[t].project===e&&this.areFiltersEqual(this.projects[t].filter,i))return!1;return!0}getNewProjectIndex(e,t){if(!this.projects)return;let i;for(i=0;i<this.projects.length;i++){const r=this.projects[i].filter;if(this.projects[i].project>e||this.projects[i].project===e&&this.isFilterDefined(r)&&this.isFilterDefined(t)&&r>t)break}return i}handleAddProject(){ba(this.newProject,"newProject"),ba(this.newFilter,"newFilter");const e=this.newProject.value,t=this.newProject.text,i=this.newFilter.value;if(!this.canAddProject(e,t,i))return;const r=this.getNewProjectIndex(t,i);void 0!==r&&(this.projects?.splice(r,0,{project:t,filter:i,_is_local:!0}),this.requestUpdate()),this.newProject.clear(),this.newFilter.value="",this.setHasUnsavedChanges()}handleCheckboxChange(e,t,i){const r=i.target.checked;e[t]=!!r,this.requestUpdate(),this.setHasUnsavedChanges()}handleNotifCellClick(e){if(null===e.target)return;const t=e.target.querySelector("md-checkbox");t&&t.click()}setHasUnsavedChanges(){Jn(this,"has-unsaved-changes-changed",{value:nf(this.originalProjects,this.projects)||this.projectsToRemove.length>0})}isFilterDefined(e){return null!=e}areFiltersEqual(e,t){return!this.isFilterDefined(e)&&!this.isFilterDefined(t)||e===t}};$B([Hc("#newFilter")],AB.prototype,"newFilter",void 0),$B([Hc("#newProject")],AB.prototype,"newProject",void 0),$B([Uc()],AB.prototype,"originalProjects",void 0),$B([Uc()],AB.prototype,"projects",void 0),$B([Uc()],AB.prototype,"projectsToRemove",void 0),AB=$B([Dc("gr-watched-projects-editor")],AB);var RB=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};const TB=["HTTP","HTTP_LDAP"];let IB=class extends Ic{constructor(){super(),this.prefs={},this.accountInfoChanged=!1,this.localChangeTableColumns=[],this.loading=!0,this.changeTableChanged=!1,this.diffPrefsChanged=!1,this.editPrefsChanged=!1,this.watchedProjectsChanged=!1,this.keysChanged=!1,this.gpgKeysChanged=!1,this.addingEmail=!1,this.lastSentVerificationEmail=null,this.emailsChanged=!1,this.isDeletingAccount=!1,this.restApiService=Xn().restApiService,this.getUserModel=yu(this,jf),this.flagsService=Xn().flagsService,this.getViewModel=yu(this,mO),this.getNavigation=yu(this,gy),this.handleLocationChange=()=>{const e=window.location.hash;if(e){const t=(this.shadowRoot||document).querySelector(e);t&&setTimeout((()=>t.scrollIntoView()),0)}},zf(this,(()=>this.getViewModel().emailToken$),(e=>{this.emailToken=e,this.confirmEmail()})),zf(this,(()=>this.getUserModel().account$),(e=>{this.account=e})),zf(this,(()=>this.getUserModel().preferences$),(e=>{if(!e)throw new Error("getPreferences returned undefined");this.prefs=e,this.showNumber=!!e.legacycid_in_change_table,this.localChangeTableColumns=Hf(e)}))}async confirmEmail(){if(!this.emailToken)return;const e=await this.restApiService.confirmEmail(this.emailToken);e&&ea(this,e),this.getViewModel().clearToken(),await this.getUserModel().loadEmails(!0)}connectedCallback(){super.connectedCallback(),document.addEventListener("location-change",this.handleLocationChange),oa("Settings")}async getAccountState(){const e=await this.restApiService.getAccountState();this.accountState=e?JSON.stringify(e,null,2):"ERROR: failed to get account state"}firstUpdated(){const e=[this.accountInfo.loadData(),this.watchedProjectsEditor.loadData(),this.groupList.loadData(),this.identities.loadData()];e.push(this.restApiService.getConfig().then((e=>{this.serverConfig=e;const t=[];return this.serverConfig?.sshd&&t.push(this.sshEditorPromise.then((e=>e.loadData()))),this.serverConfig?.receive?.enable_signed_push&&t.push(this.gpgEditorPromise.then((e=>e.loadData()))),this.showHttpAuth()&&t.push(this.tokenEditorPromise.then((e=>e.loadData()))),Promise.all(t)}))),this._testOnly_loadingPromise=Promise.all(e).then((()=>{this.loading=!1,this.handleLocationChange()}))}static get styles(){return[Nc,Jy,Qb,my,Iw,N_,y$,Sd`
        :host {
          color: var(--primary-text-color);
          overflow: auto;
        }
        h2 {
          font-family: var(--header-font-family);
          font-size: var(--font-size-h2);
          font-weight: var(--font-weight-h2);
          line-height: var(--line-height-h2);
        }
        .newEmailInput {
          width: 20em;
        }
        #email {
          margin-bottom: var(--spacing-l);
        }
        .filters p {
          margin-bottom: var(--spacing-l);
        }
        .queryExample em {
          color: violet;
        }
        .toggle {
          align-items: center;
          display: flex;
          margin-bottom: var(--spacing-l);
          margin-right: var(--spacing-l);
        }
        .account-button {
          margin-left: var(--spacing-l);
        }
        .account-state-output {
          width: 100vh;
          max-width: calc(100% - var(--spacing-xl));
          height: 50vh;
          margin-bottom: var(--spacing-l);
        }
        .account-state-note {
          width: 100vh;
          max-width: calc(100% - var(--spacing-xl));
        }
        .confirm-account-deletion-main ul {
          list-style: disc inside;
          margin-left: var(--spacing-l);
        }
      `]}render(){const e=this.loading||void 0===this.loading;return dc`<div class="loading" ?hidden=${!e}>Loading...</div>
      <div ?hidden=${e}>
        <gr-page-nav class="navStyles">
          <ul>
            <li><a href="#Profile">Profile</a></li>
            <li><a href="#Preferences">Preferences</a></li>
            <li><a href="#DiffPreferences">Diff Preferences</a></li>
            <li><a href="#EditPreferences">Edit Preferences</a></li>
            <li><a href="#Menu">Menu</a></li>
            <li><a href="#ChangeTableColumns">Change Table Columns</a></li>
            <li><a href="#Notifications">Notifications</a></li>
            <li><a href="#EmailAddresses">Email Addresses</a></li>
            ${eb(this.showHttpAuth(),(()=>dc`<li><a href="#HTTPCredentials">HTTP Credentials</a></li>`))}
            ${eb(this.serverConfig?.sshd,(()=>dc`<li><a href="#SSHKeys"> SSH Keys </a></li>`))}
            ${eb(this.serverConfig?.receive?.enable_signed_push,(()=>dc`<li><a href="#GPGKeys"> GPG Keys </a></li>`))}
            <li><a href="#Groups">Groups</a></li>
            <li><a href="#Identities">Identities</a></li>
            ${eb(this.serverConfig?.auth.use_contributor_agreements,(()=>dc`<li><a href="#Agreements">Agreements</a></li>`))}
            <gr-endpoint-decorator name="settings-menu-item">
            </gr-endpoint-decorator>
          </ul>
        </gr-page-nav>
        <div class="main gr-form-styles">
          <h1 class="heading-1">User Settings</h1>
          <h2
            id="Profile"
            class=${this.computeHeaderClass(this.accountInfoChanged)}
          >
            Profile
          </h2>
          <fieldset id="profile">
            <gr-account-info
              id="accountInfo"
              ?hasUnsavedChanges=${this.accountInfoChanged}
              @unsaved-changes-changed=${e=>{this.accountInfoChanged=e.detail.value}}
              @account-detail-update=${()=>{Jn(this,"account-detail-update",{})}}
            ></gr-account-info>
            <gr-button
              @click=${()=>{this.accountInfo.save()}}
              ?disabled=${!this.accountInfoChanged}
              >Save Changes</gr-button
            >
            <gr-button
              class="account-button"
              @click=${()=>{this.confirmDeleteAccount()}}
              >Delete Account</gr-button
            >
            <gr-button
              class="account-button"
              @click=${()=>{this.dumpAccountState()}}
              >Dump Account State</gr-button
            >
            <dialog id="confirm-account-deletion">
              <gr-dialog
                @cancel=${()=>this.deleteAccountConfirmationDialog?.close()}
                @confirm=${()=>this.deleteAccount()}
                .loading=${this.isDeletingAccount}
                .loadingLabel=${"Deleting account"}
                .confirmLabel=${"Delete account"}
              >
                <div class="confirm-account-deletion-header" slot="header">
                  Are you sure you wish to delete your account?
                </div>
                <div class="confirm-account-deletion-main" slot="main">
                  <ul>
                    <li>Deleting your account is not reversible.</li>
                    <li>Deleting your account will not delete your changes.</li>
                  </ul>
                </div>
              </gr-dialog>
            </dialog>
            <dialog id="dump-account-state">
              <gr-dialog
                cancel-label=""
                @confirm=${()=>this.dumpAccountStateConfirmationDialog?.close()}
                confirm-label="OK"
                confirm-on-enter=""
              >
                <div slot="header">Account State:</div>
                <div slot="main">
                  <textarea class="account-state-output" readonly>
${this.accountState}</textarea
                  >
                  <p class="account-state-note">
                    Note: The account state may contain sensitive data (e.g.
                    deadnames). Share it with others only on a need to know
                    basis (e.g. for debugging account or permission issues).
                  </p>
                </div>
              </gr-dialog>
            </dialog>
          </fieldset>
          <gr-preferences id="Preferences"></gr-preferences>
          <h2
            id="DiffPreferences"
            class=${this.computeHeaderClass(this.diffPrefsChanged)}
          >
            Diff Preferences
          </h2>
          <fieldset id="diffPreferences">
            <gr-diff-preferences
              id="diffPrefs"
              @has-unsaved-changes-changed=${e=>{this.diffPrefsChanged=e.detail.value}}
            ></gr-diff-preferences>
            <gr-button
              id="saveDiffPrefs"
              @click=${()=>{this.diffPrefs.save()}}
              ?disabled=${!this.diffPrefsChanged}
              >Save Changes</gr-button
            >
          </fieldset>
          <h2
            id="EditPreferences"
            class=${this.computeHeaderClass(this.editPrefsChanged)}
          >
            Edit Preferences
          </h2>
          <fieldset id="editPreferences">
            <gr-edit-preferences
              id="editPrefs"
              @has-unsaved-changes-changed=${e=>{this.editPrefsChanged=e.detail.value}}
            ></gr-edit-preferences>
            <gr-button
              id="saveEditPrefs"
              @click=${()=>{this.editPrefs.save()}}
              ?disabled=${!this.editPrefsChanged}
              >Save Changes</gr-button
            >
          </fieldset>
          <gr-menu-editor id="Menu"></gr-menu-editor>
          <h2
            id="ChangeTableColumns"
            class=${this.computeHeaderClass(this.changeTableChanged)}
          >
            Change Table Columns
          </h2>
          <fieldset id="changeTableColumns">
            <gr-change-table-editor
              .showNumber=${this.showNumber}
              @show-number-changed=${e=>{this.showNumber=e.detail.value,this.changeTableChanged=!0}}
              .displayedColumns=${this.localChangeTableColumns}
              @displayed-columns-changed=${e=>{this.localChangeTableColumns=e.detail.value,this.changeTableChanged=!0}}
            >
            </gr-change-table-editor>
            <gr-button
              id="saveChangeTable"
              @click=${this.handleSaveChangeTable}
              ?disabled=${!this.changeTableChanged}
              >Save Changes</gr-button
            >
          </fieldset>
          <h2
            id="Notifications"
            class=${this.computeHeaderClass(this.watchedProjectsChanged)}
          >
            Notifications
          </h2>
          <fieldset id="watchedProjects">
            <gr-watched-projects-editor
              @has-unsaved-changes-changed=${e=>{this.watchedProjectsChanged=e.detail.value}}
              id="watchedProjectsEditor"
            ></gr-watched-projects-editor>
            <gr-button
              @click=${()=>{this.watchedProjectsEditor.save()}}
              ?disabled=${!this.watchedProjectsChanged}
              id="_handleSaveWatchedProjects"
              >Save Changes</gr-button
            >
          </fieldset>
          <h2
            id="EmailAddresses"
            class=${this.computeHeaderClass(this.emailsChanged)}
          >
            Email Addresses
          </h2>
          <fieldset id="email">
            <gr-email-editor
              id="emailEditor"
              @has-unsaved-changes-changed=${e=>{this.emailsChanged=e.detail.value}}
            ></gr-email-editor>
            <gr-button
              @click=${async()=>{await this.emailEditor.save()}}
              ?disabled=${!this.emailsChanged}
              >Save Changes</gr-button
            >
          </fieldset>
          <fieldset id="newEmail">
            <section>
              <span class="title">New email address</span>
              <span class="value">
                <md-outlined-text-field
                  class="newEmailInput showBlueFocusBorder"
                  placeholder="email@example.com"
                  ?disabled=${this.addingEmail}
                  .value=${this.newEmail??""}
                  @input=${e=>{const t=e.target;this.newEmail=t.value}}
                  @keydown=${this.handleNewEmailKeydown}
                >
                </md-outlined-text-field>
              </span>
            </section>
            <section
              id="verificationSentMessage"
              ?hidden=${!this.lastSentVerificationEmail}
            >
              <p>
                A verification email was sent to
                <em>${this.lastSentVerificationEmail}</em>. Please check your
                inbox.
              </p>
            </section>
            <gr-button
              ?disabled=${!this.computeAddEmailButtonEnabled()}
              @click=${this.handleAddEmailButton}
              >Send Verification</gr-button
            >
          </fieldset>
          ${eb(this.showHttpAuth(),(()=>dc` <div>
              <h2 id="HTTPCredentials">HTTP Credentials</h2>
              <fieldset>
                <gr-auth-token id="authToken"></gr-auth-token>
              </fieldset>
            </div>`))}
          ${eb(this.serverConfig?.sshd,(()=>dc`<h2
                id="SSHKeys"
                class=${this.computeHeaderClass(this.keysChanged)}
              >
                SSH keys
              </h2>
              <gr-ssh-editor
                id="sshEditor"
                ?hasUnsavedChanges=${this.keysChanged}
                @has-unsaved-changes-changed=${e=>{this.keysChanged=e.detail.value}}
              ></gr-ssh-editor>`))}
          ${eb(this.serverConfig?.receive?.enable_signed_push,(()=>dc`<div>
              <h2
                id="GPGKeys"
                class=${this.computeHeaderClass(this.gpgKeysChanged)}
              >
                GPG keys
              </h2>
              <gr-gpg-editor
                id="gpgEditor"
                ?hasUnsavedChanges=${this.gpgKeysChanged}
                @has-unsaved-changes-changed=${e=>{this.gpgKeysChanged=e.detail.value}}
              ></gr-gpg-editor>
            </div>`))}
          <h2 id="Groups">Groups</h2>
          <fieldset>
            <gr-group-list id="groupList"></gr-group-list>
          </fieldset>
          <h2 id="Identities">Identities</h2>
          <fieldset>
            <gr-identities
              id="identities"
              .serverConfig=${this.serverConfig}
            ></gr-identities>
          </fieldset>
          ${eb(this.serverConfig?.auth.use_contributor_agreements,(()=>dc`<h2 id="Agreements">Agreements</h2>
              <fieldset>
                <gr-agreements-list id="agreementsList"></gr-agreements-list>
              </fieldset>`))}
          <gr-endpoint-decorator name="settings-screen">
          </gr-endpoint-decorator>
        </div>
      </div>`}disconnectedCallback(){document.removeEventListener("location-change",this.handleLocationChange),super.disconnectedCallback()}reloadAccountDetail(){Promise.all([this.accountInfo.loadData()])}async handleSaveChangeTable(){this.prefs.change_table=this.localChangeTableColumns,this.prefs.legacycid_in_change_table=this.showNumber,await this.getUserModel().updatePreferences(this.prefs),this.changeTableChanged=!1}computeHeaderClass(e){return e?"edited":""}handleNewEmailKeydown(e){"Enter"===e.key&&(e.stopPropagation(),this.handleAddEmailButton())}isNewEmailValid(e){return!!e&&e.includes("@")}computeAddEmailButtonEnabled(){return this.isNewEmailValid(this.newEmail)&&!this.addingEmail}handleAddEmailButton(){this.isNewEmailValid(this.newEmail)&&(this.addingEmail=!0,this.restApiService.addAccountEmail(this.newEmail).then((async e=>{this.addingEmail=!1,e.status<200||e.status>=300||(this.lastSentVerificationEmail=this.newEmail,this.newEmail="",await this.getUserModel().loadEmails(!0))})))}confirmDeleteAccount(){this.deleteAccountConfirmationDialog?.showModal()}async deleteAccount(){this.isDeletingAccount=!0,await this.accountInfo.delete(),this.isDeletingAccount=!1,this.deleteAccountConfirmationDialog?.close(),this.getNavigation().setUrl(kf())}async dumpAccountState(){await this.getAccountState(),this.dumpAccountStateConfirmationDialog?.showModal()}showHttpAuth(){return!!this.serverConfig?.auth?.git_basic_auth_policy&&TB.includes(this.serverConfig.auth.git_basic_auth_policy.toUpperCase())}};RB([Hc("#accountInfo",!0)],IB.prototype,"accountInfo",void 0),RB([Hc("#confirm-account-deletion")],IB.prototype,"deleteAccountConfirmationDialog",void 0),RB([Hc("#dump-account-state")],IB.prototype,"dumpAccountStateConfirmationDialog",void 0),RB([Hc("#watchedProjectsEditor",!0)],IB.prototype,"watchedProjectsEditor",void 0),RB([Hc("#groupList",!0)],IB.prototype,"groupList",void 0),RB([Hc("#identities",!0)],IB.prototype,"identities",void 0),RB([Hc("#diffPrefs")],IB.prototype,"diffPrefs",void 0),RB([Hc("#editPrefs")],IB.prototype,"editPrefs",void 0),RB([zc("#sshEditor")],IB.prototype,"sshEditorPromise",void 0),RB([zc("#authToken")],IB.prototype,"tokenEditorPromise",void 0),RB([zc("#gpgEditor")],IB.prototype,"gpgEditorPromise",void 0),RB([Hc("#emailEditor",!0)],IB.prototype,"emailEditor",void 0),RB([Uc()],IB.prototype,"prefs",void 0),RB([Uc()],IB.prototype,"accountInfoChanged",void 0),RB([Uc()],IB.prototype,"localChangeTableColumns",void 0),RB([Uc()],IB.prototype,"loading",void 0),RB([Uc()],IB.prototype,"changeTableChanged",void 0),RB([Uc()],IB.prototype,"diffPrefsChanged",void 0),RB([Uc()],IB.prototype,"editPrefsChanged",void 0),RB([Uc()],IB.prototype,"watchedProjectsChanged",void 0),RB([Uc()],IB.prototype,"keysChanged",void 0),RB([Uc()],IB.prototype,"gpgKeysChanged",void 0),RB([Uc()],IB.prototype,"newEmail",void 0),RB([Uc()],IB.prototype,"addingEmail",void 0),RB([Uc()],IB.prototype,"lastSentVerificationEmail",void 0),RB([Uc()],IB.prototype,"serverConfig",void 0),RB([Uc()],IB.prototype,"emailsChanged",void 0),RB([Uc()],IB.prototype,"emailToken",void 0),RB([Uc()],IB.prototype,"showNumber",void 0),RB([Uc()],IB.prototype,"account",void 0),RB([Uc()],IB.prototype,"isDeletingAccount",void 0),RB([Uc()],IB.prototype,"accountState",void 0),IB=RB([Dc("gr-settings-view")],IB);const PB=[/^\/log(in|out)(\/(.+))?$/,/^\/plugins\/(.+)$/],NB=document.ontouchstart?"touchstart":"click";class OB{constructor(){this.entryRoutes=[],this.exitRoutes=[],this.currentPath="",this.base="",this.running=!1,this.documentLoaded=!1,this.loadHandler=()=>{setTimeout((()=>this.documentLoaded=!0),0)},this.clickHandler=e=>{if(0!==e.button)return;if(e.metaKey||e.ctrlKey||e.shiftKey)return;if(e.defaultPrevented)return;let t=e.target;const i=e.composedPath();if(i)for(let e=0;e<i.length;e++){const r=i[e];if(r.nodeName&&"A"===r.nodeName.toUpperCase()&&r.href){t=r;break}}for(;t&&"A"!==t.nodeName.toUpperCase();)t=t.parentNode;if(!t||"A"!==t.nodeName.toUpperCase())return;if(t.hasAttribute("download")||"external"===t.getAttribute("rel"))return;const r=t.getAttribute("href");if(function(e){const t=window.location;return e.pathname===t.pathname&&e.search===t.search}(t)&&(t.hash||"#"===r))return;if(r&&r.indexOf("mailto:")>-1)return;if(t.target)return;if(!If(t.href))return;let o=t.pathname+t.search+(t.hash??"");o="/"!==o[0]?"/"+o:o;const s=o;0===o.indexOf(this.base)&&(o=o.substr(this.base.length)),this.base&&s===o&&"file:"!==window.location.protocol||PB.find((e=>e.test(o)))||(e.preventDefault(),this.show(s))},this.popStateHandler=e=>{if(this.documentLoaded)if(e.state){const t=e.state.path;this.replace(t,e.state)}else{const e=window.location;this.show(e.pathname+e.search+e.hash,!1)}}}start(e={dispatch:!0,base:""}){if(!this.running&&(this.running=!0,this.base=e.base,window.document.addEventListener(NB,this.clickHandler),window.addEventListener("load",this.loadHandler),window.addEventListener("popstate",this.popStateHandler),"complete"===document.readyState&&(this.documentLoaded=!0),e.dispatch)){const e=window.location;this.replace(e.pathname+e.search+e.hash)}}stop(){this.running&&(this.currentPath="",this.running=!1,window.document.removeEventListener(NB,this.clickHandler),window.removeEventListener("popstate",this.popStateHandler),window.removeEventListener("load",this.loadHandler))}show(e,t=!0){const i=new LB(e,{},this.base),r=this.prevPageContext;this.prevPageContext=i,this.currentPath=i.path,this.dispatch(i,r),t&&!i.preventPush&&i.pushState()}redirect(e){setTimeout((()=>this.replace(e)),0)}replace(e,t={},i=!0){const r=new LB(e,t,this.base),o=this.prevPageContext;this.prevPageContext=r,this.currentPath=r.path,r.replaceState(),i&&this.dispatch(r,o)}dispatch(e,t){let i=0;const r=()=>{const e=this.exitRoutes[i++];e?e(t,r):s()};let o=0;const s=()=>{const t=this.entryRoutes[o++];if(e.path===this.currentPath){if(!t)throw new Error("No route has handled the URL.");t(e,s)}else e.preventPush=!0};t?r():s()}registerRoute(e,t){this.entryRoutes.push(MB(e,t))}registerExitRoute(e,t){this.exitRoutes.push(MB(e,t))}}function DB(e){return e?decodeURIComponent(e.replace(/\+/g," ")):""}class LB{constructor(e,t={},i=""){this.state=t,this.canonicalPath="",this.path="",this.querystring="",this.hash="",this.params=[],this.preventPush=!1,this.title="",this.title=window.document.title,"/"===e[0]&&0!==e.indexOf(i)&&(e=i+e),this.canonicalPath=e;const r=new RegExp("^"+i.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"));this.path=e.replace(r,"")||"/",this.state.path=e;const o=e.indexOf("?");if(this.querystring=-1!==o?DB(e.slice(o+1)):"",-1===this.path.indexOf("#"))return;const s=this.path.split("#");this.path=s[0],this.hash=DB(s[1])||"",this.querystring=this.querystring.split("#")[0]}pushState(){window.history.pushState(this.state,this.title,this.canonicalPath)}replaceState(){window.history.replaceState(this.state,this.title,this.canonicalPath)}match(e){const t=this.path.indexOf("?"),i=-1!==t?this.path.slice(0,t):this.path,r=e.exec(decodeURIComponent(i));return r&&(this.params=r.slice(1).map((e=>DB(e)))),!!r}}function MB(e,t){return(i,r)=>{i.match(e)?t(i,r):r()}}const FB=/^\/$/,UB=/^\/dashboard\/(.+)$/,BB=/^\/dashboard\/?$/,HB=/^\/projects\/(.+),dashboards\/(.+)/,jB=/^\/settings\/agreements\/?/,GB=/^\/settings\/new-agreement\/?/,zB=/^\/register(\/.*)?$/,VB=/.*/,WB=/^\/admin\/groups\/(?:uuid-)?([^,]+)$/,qB=/^\/groups\/self/,KB=/^\/admin\/groups\/(?:uuid-)?(.+),info$/,YB=/^\/admin\/groups\/(?:uuid-)?(.+),audit-log$/,XB=/^\/admin\/groups\/(?:uuid-)?(.+),members$/,JB=/^\/admin\/create-project\/?$/,QB=/^\/admin\/create-group\/?$/,ZB=/^\/admin\/(projects)\/?(.+)?$/,eH=/^\/admin\/repos\/([^,]+)$/,tH=/^\/admin\/repos\/(.+),commands$/,iH=/^\/admin\/repos\/edit\/repo\/(.+)\/branch\/(.+)\/file\/(.+)$/,rH=/^\/admin\/repos\/(.+),general$/,oH=/^\/admin\/repos\/(.+),access$/,sH=/^\/admin\/repos\/(.+),dashboards\/?(?:\/q\/filter:(.*?))?(?:,(\d+))?$/,nH=/^\/admin\/repos\/(.+),submit-requirements\/?(?:\/q\/filter:(.*?))?(?:,(\d+))?$/,aH=/^\/admin\/repos\/(.+),labels\/?(?:\/q\/filter:(.*?))?(?:,(\d+))?$/,lH=/^\/admin\/plugins\/?(?:\/q\/filter:(.*?))?(?:,(\d+))?$/,dH=/^\/admin\/groups\/?(?:\/q\/filter:(.*?))?(?:,(\d+))?$/,cH=/^\/admin\/repos\/?(?:\/q\/filter:(.*?))?(?:,(\d+))?$/,hH=/^\/admin\/repos\/(.+),branches\/?(?:\/q\/filter:(.*?))?(?:,(\d+))?$/,pH=/^\/admin\/repos\/(.+),tags\/?(?:\/q\/filter:(.*?))?(?:,(\d+))?$/,uH=/^\/q\/(.+?)(,(\d+))?$/,gH=/^\/q\/.+,n,z$/,mH=/^\/id\/(I[0-9a-f]{40})$/,fH=/^\/c\/(\d+)\/?(.*)$/,vH=/^\/(\d+)\/?/,bH=/^\/c\/(.+)\/\+\/(\d+)(\/?((-?\d+|edit)(\.\.(\d+|edit))?))?\/?$/,yH=/^\/c\/(.+)\/\+\/(\d+)(\/(\d+))?,edit\/?$/,wH=/^\/c\/(.+)\/\+\/(\d+)\/comment\/(\w+)\/?$/,_H=/^\/c\/(.+)\/\+\/(\d+)\/comments(?:\/)?(\w+)?\/?$/,xH=/^\/c\/(.+)\/\+\/(\d+)(\/((-?\d+|edit)(\.\.(\d+|edit))?(\/(.+))))\/?$/,CH=/^\/c\/(.+)\/\+\/(\d+)\/(\d+|edit)\/(.+),edit(#\d+)?$/,EH=/^\/c\/((.+)\/\+\/)?(\d+)(\/?((-?\d+|edit)(\.\.(\d+|edit))?\/(.+))?)@[ab]?\d+$/,SH=/^\/settings\/?/,$H=/^\/settings\/VE\/(\S+)/,kH=/^\/c\/(.+)\/ \/(.+)$/,AH=/^\/x\/([\w-]+)\/([\w-]+)\/?/,RH=/^\/Documentation\/q\/filter:(.*)$/,TH=/^\/Documentation\/q\/(.*)$/,IH=/^\/Documentation(\/)?(.+)?/,PH=/^([ab]?)(\d+)$/,NH=/@([ab]?\d+)$/,OH=/,n,z$/,DH=document.querySelector("gr-app");DH||console.info("No gr-app found (running tests)"),window.addEventListener("WebComponentsReady",(()=>{Xn().reportingService.timeEnd(ua.WEB_COMPONENTS_READY)}));const LH=mu("router");class MH{constructor(e,t,i,r,o,s,n,a,l,d,c,h,p){this.reporting=e,this.routerModel=t,this.restApiService=i,this.adminViewModel=r,this.agreementViewModel=o,this.changeViewModel=s,this.dashboardViewModel=n,this.documentationViewModel=a,this.groupViewModel=l,this.pluginViewModel=d,this.repoViewModel=c,this.searchViewModel=h,this.settingsViewModel=p,this._app=DH,this._isInitialLoad=!0,this.subscriptions=[],this.navigationBlockers=new Set,this.page=new OB,this.beforeUnloadHandler=e=>{const t=[...this.navigationBlockers][0];if(t)return e.preventDefault(),e.returnValue=t,t},this.subscriptions=[this.changeViewModel.state$.subscribe((e=>{if(!e)return;if(this.view!==gw.CHANGE)return;const t=new URL(window.location.toString()),i=new URL(function(e){switch(e.childView){case zC.OVERVIEW:return WC(e);case zC.DIFF:return qC(e);case zC.EDIT:return KC(e)}}(e),t);i.hash=t.hash;for(const e of t.searchParams.entries())"experiment"===e[0]&&i.searchParams.append(e[0],e[1]);t.toString()!==i.toString()&&this.page.replace(i.toString(),{},!1)})),this.routerModel.routerView$.subscribe((e=>this.view=e))]}blockNavigation(e){va(!!e,"empty reason is not allowed"),this.navigationBlockers.add(e),1===this.navigationBlockers.size&&(this.navigationBlockerPromise=function(){let e,t;const i=new Promise(((i,r)=>{e=i,t=r}));return i.resolve=e,i.reject=t,i}(),window.addEventListener("beforeunload",this.beforeUnloadHandler))}releaseNavigation(e){va(!!e,"empty reason is not allowed"),this.navigationBlockers.delete(e),0===this.navigationBlockers.size&&(window.removeEventListener("beforeunload",this.beforeUnloadHandler),this.navigationBlockerPromise?.resolve())}finalize(){for(const e of this.subscriptions)e.unsubscribe();this.subscriptions=[],this.page.stop(),window.removeEventListener("beforeunload",this.beforeUnloadHandler)}start(){this._app&&this.startRouter()}setState(e){"repo"in e&&void 0!==e.repo&&"changeNum"in e&&this.restApiService.addRepoNameToCache(e.changeNum,e.repo),this.routerModel.setState({view:e.view}),e.view!==gw.CHANGE&&this.changeViewModel.setState(void 0),this.appElement().params=e}appElement(){return document.getElementById("app-element")||document.querySelector("gr-app").shadowRoot.getElementById("app-element")}redirect(e){this._isRedirecting=!0,this.page.redirect(e)}normalizePatchRangeParams(e){void 0!==e.basePatchNum&&(e.patchNum&&e.basePatchNum===e.patchNum?e.basePatchNum=Qu:void 0===e.patchNum&&(e.patchNum=e.basePatchNum,e.basePatchNum=Qu))}redirectToLogin(e){const t=Sf()||"";qF(window.location,`${t}/login/${encodeURIComponent(e.substring(t.length))}`)}getHashFromCanonicalPath(e){return e.split("#").slice(1).join("#")}parseLineAddress(e){const t=e.match(PH);return t?{leftSide:!!t[1],lineNum:Number(t[2])}:null}redirectIfNotLoggedIn(e){return this.restApiService.getLoggedIn().then((t=>t?Promise.resolve():(this.redirectToLogin(e),Promise.reject(new Error))))}loadUserMiddleware(e,t){this.restApiService.getLoggedIn(),t()}mapRoute(e,t,i,r){this.page.registerRoute(e,((e,t)=>this.loadUserMiddleware(e,t))),this.page.registerRoute(e,(e=>{this.reporting.locationChanged(t),(r?this.redirectIfNotLoggedIn(e.canonicalPath):Promise.resolve()).then((()=>{i(e)}))}))}mapRouteState(e,t,i,r){this.mapRoute(e.urlPattern,i,(i=>{const r=e.createState(i);this.setState(r),t.setState(r)}),r)}setUrl(e){this.page.show(e)}replaceUrl(e){this.redirect(e)}dispatchLocationChangeEvent(){const e={hash:window.location.hash,pathname:window.location.pathname};Jn(document,"location-change",e)}_testOnly_startRouter(){this.startRouter({dispatch:!1,base:Sf()})}startRouter(e={dispatch:!0,base:Sf()}){this.page.registerExitRoute(/(.*)/,((e,t)=>{this._isRedirecting||this.reporting.beforeLocationChanged(),this._isRedirecting=!1,this._isInitialLoad=!1,t()})),this.page.registerRoute(/(.*)/,((e,t)=>{if(window.URLSearchParams){const t=function(e){const t=e.indexOf("?");return t>-1?e.slice(0,t):e}(e.canonicalPath),i=function(e){const t=e.indexOf("?"),i=t>-1?e.slice(t+1):"";return new URLSearchParams(i)}(e.canonicalPath);if(i.has("usp")){const e=i.get("usp");return this.reporting.reportLifeCycle(ha.USER_REFERRED_FROM,{usp:e}),i.delete("usp"),void this.redirect(function(e,t){const i=t.toString();return e+(i?"?":"")+i}(t,i))}}t()})),this.page.registerRoute(/(.*)/,((e,t)=>{0!==this.navigationBlockers.size?(ea(document,"Waiting 1 second for navigation blockers to resolve ..."),Promise.race([this.navigationBlockerPromise,new Promise((e=>{setTimeout(e,1e3)}))]).then((()=>{if(0===this.navigationBlockers.size)t();else{const e=[...this.navigationBlockers][0];ea(document,`Navigation is blocked by: ${e}`)}}))):t()})),this.page.registerRoute(/(.*)/,((e,t)=>{document.body.scrollTop=0,e.hash.match(AH)?this.redirect(e.hash):(setTimeout((()=>{this.dispatchLocationChangeEvent()}),1),t())})),this.mapRoute(FB,"handleRootRoute",(e=>this.handleRootRoute(e))),this.mapRoute(UB,"handleDashboardRoute",(e=>this.handleDashboardRoute(e))),this.mapRoute(BB,"handleCustomDashboardRoute",(e=>this.handleCustomDashboardRoute(e))),this.mapRouteState(oE,this.dashboardViewModel,"handleProjectDashboardRoute"),this.mapRoute(HB,"handleLegacyProjectDashboardRoute",(e=>this.handleLegacyProjectDashboardRoute(e))),this.mapRoute(KB,"handleGroupInfoRoute",(e=>this.handleGroupInfoRoute(e)),!0),this.mapRoute(YB,"handleGroupAuditLogRoute",(e=>this.handleGroupAuditLogRoute(e)),!0),this.mapRoute(XB,"handleGroupMembersRoute",(e=>this.handleGroupMembersRoute(e)),!0),this.mapRoute(dH,"handleGroupListRoute",(e=>this.handleGroupListRoute(e)),!0),this.mapRoute(qB,"handleGroupSelfRedirectRoute",(e=>this.handleGroupSelfRedirectRoute(e)),!0),this.mapRoute(WB,"handleGroupRoute",(e=>this.handleGroupRoute(e)),!0),this.mapRoute(ZB,"handleProjectsOldRoute",(e=>this.handleProjectsOldRoute(e))),this.mapRoute(tH,"handleRepoCommandsRoute",(e=>this.handleRepoCommandsRoute(e)),!0),this.mapRoute(iH,"handleRepoEditFileRoute",(e=>this.handleRepoEditFileRoute(e)),!0),this.mapRoute(rH,"handleRepoGeneralRoute",(e=>this.handleRepoGeneralRoute(e))),this.mapRoute(oH,"handleRepoAccessRoute",(e=>this.handleRepoAccessRoute(e))),this.mapRoute(sH,"handleRepoDashboardsRoute",(e=>this.handleRepoDashboardsRoute(e))),this.mapRoute(nH,"handleRepoSubmitRequirementsRoute",(e=>this.handleRepoSubmitRequirementsRoute(e)),!0),this.mapRoute(aH,"handleRepoLabelsRoute",(e=>this.handleRepoLabelsRoute(e)),!0),this.mapRoute(hH,"handleBranchListRoute",(e=>this.handleBranchListRoute(e))),this.mapRoute(pH,"handleTagListRoute",(e=>this.handleTagListRoute(e))),this.mapRoute(QB,"handleCreateGroupRoute",(e=>this.handleCreateGroupRoute(e)),!0),this.mapRoute(JB,"handleCreateProjectRoute",(e=>this.handleCreateProjectRoute(e)),!0),this.mapRoute(cH,"handleRepoListRoute",(e=>this.handleRepoListRoute(e))),this.mapRoute(eH,"handleRepoRoute",(e=>this.handleRepoRoute(e))),this.mapRoute(lH,"handlePluginListFilterRoute",(e=>this.handlePluginListFilterRoute(e)),!0),this.mapRouteState(_w,this.adminViewModel,"handlePluginListRoute",!0),this.mapRoute(gH,"handleQueryLegacySuffixRoute",(e=>this.handleQueryLegacySuffixRoute(e))),this.mapRoute(uH,"handleQueryRoute",(e=>this.handleQueryRoute(e))),this.mapRoute(mH,"handleChangeIdQueryRoute",(e=>this.handleChangeIdQueryRoute(e))),this.mapRoute(EH,"handleLegacyLinenum",(e=>this.handleLegacyLinenum(e))),this.mapRoute(vH,"handleChangeNumberLegacyRoute",(e=>this.handleChangeNumberLegacyRoute(e))),this.mapRoute(CH,"handleDiffEditRoute",(e=>this.handleDiffEditRoute(e)),!0),this.mapRoute(yH,"handleChangeEditRoute",(e=>this.handleChangeEditRoute(e)),!0),this.mapRoute(wH,"handleCommentRoute",(e=>this.handleCommentRoute(e))),this.mapRoute(_H,"handleCommentsRoute",(e=>this.handleCommentsRoute(e))),this.mapRoute(xH,"handleDiffRoute",(e=>this.handleDiffRoute(e))),this.mapRoute(bH,"handleChangeRoute",(e=>this.handleChangeRoute(e))),this.mapRoute(fH,"handleChangeLegacyRoute",(e=>this.handleChangeLegacyRoute(e))),this.mapRoute(jB,"handleAgreementsRoute",(()=>this.handleAgreementsRoute()),!0),this.mapRoute(GB,"handleNewAgreementsRoute",(()=>this.handleNewAgreementsRoute()),!0),this.mapRoute($H,"handleSettingsLegacyRoute",(e=>this.handleSettingsLegacyRoute(e)),!0),this.mapRoute(SH,"handleSettingsRoute",(e=>this.handleSettingsRoute(e)),!0),this.mapRoute(zB,"handleRegisterRoute",(e=>this.handleRegisterRoute(e))),this.mapRoute(kH,"handleImproperlyEncodedPlusRoute",(e=>this.handleImproperlyEncodedPlusRoute(e))),this.mapRoute(AH,"handlePluginScreen",(e=>this.handlePluginScreen(e))),this.mapRouteState(xw,this.adminViewModel,"handleServerInfoRoute",!0),this.mapRoute(RH,"handleDocumentationSearchRoute",(e=>this.handleDocumentationSearchRoute(e))),this.mapRoute(TH,"handleDocumentationSearchRedirectRoute",(e=>this.handleDocumentationSearchRedirectRoute(e))),this.mapRoute(IH,"handleDocumentationRedirectRoute",(e=>this.handleDocumentationRedirectRoute(e))),this.mapRoute(VB,"handleDefaultRoute",(()=>this.handleDefaultRoute())),this.page.start(e)}handleRootRoute(e){if(e.querystring.match(/^closeAfterLogin/))return window.close(),null;let t=this.getHashFromCanonicalPath(e.canonicalPath);if(t){"/"!==t[0]&&(t="/"+t),t.includes("/ /")&&e.canonicalPath.includes("/+/")&&(t=t.replace("/ /","/+/"));const i=Sf();let r=i+t;return t.startsWith("/VE/")&&(r=i+"/settings"+t),this.redirect(r),null}return this.restApiService.getLoggedIn().then((e=>{e?this.redirect("/dashboard/self"):this.redirect("/q/status:open+-is:wip")}))}handleDashboardRoute(e){return this.restApiService.getLoggedIn().then((t=>{if(t){const t={view:gw.DASHBOARD,type:sE.USER,user:e.params[0]};this.setState(t),this.dashboardViewModel.setState(t)}else"self"===e.params[0].toLowerCase()?this.redirectToLogin(e.canonicalPath):this.redirect("/q/owner:"+Rf(e.params[0]))}))}handleCustomDashboardRoute(e){const t=new URLSearchParams(e.querystring);let i="Custom Dashboard";const r=t.get("title");r&&(i=r),t.delete("title");let o="";const s=t.get("foreach");s&&(o=s+" "),t.delete("foreach");const n=[];for(const[e,i]of t)e&&i&&n.push({name:e,query:`${o}${i}`});if(0===n.length)return this.redirect("/dashboard/self"),Promise.resolve();const a={view:gw.DASHBOARD,type:sE.CUSTOM,user:"self",sections:n,title:i};return this.setState(a),this.dashboardViewModel.setState(a),Promise.resolve()}handleLegacyProjectDashboardRoute(e){this.redirect("/p/"+e.params[0]+"/+/dashboard/"+e.params[1])}handleGroupInfoRoute(e){const t=e.params[0];this.redirect(iw({groupId:t}))}handleGroupSelfRedirectRoute(e){this.redirect("/settings/#Groups")}handleGroupRoute(e){const t={view:gw.GROUP,groupId:e.params[0]};this.setState(t),this.groupViewModel.setState(t)}handleGroupAuditLogRoute(e){const t={view:gw.GROUP,detail:tw.LOG,groupId:e.params[0]};this.setState(t),this.groupViewModel.setState(t)}handleGroupMembersRoute(e){const t={view:gw.GROUP,detail:tw.MEMBERS,groupId:e.params[0]};this.setState(t),this.groupViewModel.setState(t)}handleGroupListRoute(e){const t={view:gw.ADMIN,adminView:Cw.GROUPS,offset:e.params[1]||"0",filter:e.params[0]??null,openCreateModal:!e.params[0]&&!e.params[1]&&"create"===e.hash};this.setState(t),this.adminViewModel.setState(t)}handleProjectsOldRoute(e){let t="";e.params[1]&&(t=encodeURIComponent(e.params[1]),e.params[1].includes(",")&&(t=encodeURIComponent(e.params[1]).replace("%2C",","))),this.redirect(`/admin/repos/${t}`)}handleRepoCommandsRoute(e){const t=e.params[0],i={view:gw.REPO,detail:vw.COMMANDS,repo:t};this.setState(i),this.repoViewModel.setState(i),this.reporting.setRepoName(t)}handleRepoEditFileRoute(e){const t=e.params[0],i=e.params[1],r=e.params[2],o={view:gw.REPO,detail:vw.COMMANDS,repo:t,createEdit:{branch:i,path:r}};this.setState(o),this.repoViewModel.setState(o),this.reporting.setRepoName(t)}handleRepoGeneralRoute(e){const t=e.params[0],i={view:gw.REPO,detail:vw.GENERAL,repo:t};this.setState(i),this.repoViewModel.setState(i),this.reporting.setRepoName(t)}handleRepoAccessRoute(e){const t=e.params[0],i={view:gw.REPO,detail:vw.ACCESS,repo:t};this.setState(i),this.repoViewModel.setState(i),this.reporting.setRepoName(t)}handleRepoDashboardsRoute(e){const t=e.params[0],i={view:gw.REPO,detail:vw.DASHBOARDS,repo:t,filter:e.params[1]??null,offset:e.params[2]??"0"};this.setState(i),this.repoViewModel.setState(i),this.reporting.setRepoName(t)}handleRepoSubmitRequirementsRoute(e){const t=e.params[0],i={view:gw.REPO,detail:vw.SUBMIT_REQUIREMENTS,repo:t,filter:e.params[1]??null,offset:e.params[2]??"0"};this.setState(i),this.repoViewModel.setState(i),this.reporting.setRepoName(t)}handleRepoLabelsRoute(e){const t=e.params[0],i={view:gw.REPO,detail:vw.LABELS,repo:t,filter:e.params[1]??null,offset:e.params[2]??"0"};this.setState(i),this.repoViewModel.setState(i),this.reporting.setRepoName(t)}handleBranchListRoute(e){const t={view:gw.REPO,detail:vw.BRANCHES,repo:e.params[0],offset:e.params[2]||"0",filter:e.params[1]??null};this.setState(t),this.repoViewModel.setState(t)}handleTagListRoute(e){const t={view:gw.REPO,detail:vw.TAGS,repo:e.params[0],offset:e.params[2]||"0",filter:e.params[1]??null};this.setState(t),this.repoViewModel.setState(t)}handleRepoListRoute(e){const t={view:gw.ADMIN,adminView:Cw.REPOS,offset:e.params[1]||"0",filter:e.params[0]??null,openCreateModal:!e.params[0]&&!e.params[1]&&"create"===e.hash};this.setState(t),this.adminViewModel.setState(t)}handleCreateProjectRoute(e){this.redirect("/admin/repos#create")}handleCreateGroupRoute(e){this.redirect("/admin/groups#create")}handleRepoRoute(e){this.redirect(e.path+",general")}handlePluginListFilterRoute(e){const t={view:gw.ADMIN,adminView:Cw.PLUGINS,offset:e.params[1]||"0",filter:e.params[0]??null};this.setState(t),this.adminViewModel.setState(t)}handleQueryRoute(e){const t={view:gw.SEARCH,query:e.params[0],offset:e.params[2]||"0",loading:!1};this.setState(t),this.searchViewModel.updateState(t)}handleChangeIdQueryRoute(e){const t={view:gw.SEARCH,query:e.params[0],offset:"0",loading:!1};this.setState(t),this.searchViewModel.updateState(t)}handleQueryLegacySuffixRoute(e){this.redirect(e.path.replace(OH,""))}handleChangeNumberLegacyRoute(e){this.redirect("/c/"+e.params[0]+(e.querystring.length>0?`?${e.querystring}`:""))}handleChangeRoute(e){const t=Number(e.params[1]),i={repo:e.params[0],changeNum:t,basePatchNum:Rx(e.params[4]),patchNum:Rx(e.params[6]),view:gw.CHANGE,childView:zC.OVERVIEW},r=new URLSearchParams(e.querystring);r.has("openReplyDialog")&&(i.openReplyDialog=!0);const o=r.get("tab");r.has("forceReload")&&(i.forceReload=!0),o&&(i.tab=o);const s=Number(r.get("checksPatchset"));Number.isInteger(s)&&s>0&&(i.checksPatchset=s);const n=r.get("filter");n&&(i.filter=n);const a=r.get("checksResultsFilter");a&&(i.checksResultsFilter=a);const l=LI(r.get("attempt"));l&&l!==OI&&(i.attempt=l);const d=r.get("checksRunsSelected");d&&(i.checksRunsSelected=new Set(d.split(","))),ba(i.repo,"project"),this.reporting.setRepoName(i.repo),this.reporting.setChangeId(t),this.normalizePatchRangeParams(i),this.setState(i),this.changeViewModel.setState(i)}async handleCommentRoute(e){const t=Number(e.params[1]),i=e.params[0],r=e.params[2];this.restApiService.addRepoNameToCache(t,i);const[o,s,n]=await Promise.all([this.restApiService.getDiffComments(t),this.restApiService.getDiffDrafts(t),this.restApiService.getChangeDetail(t)]),a=bC(lC(o),r)??bC(lC(s),r),l=a?.path,d=Dx(Ox(n));if(!a||!l||!d)return void this.show404();let{basePatchNum:c,patchNum:h}=function(e,t){if(!e.patch_set)throw new Error("Missing comment.patch_set");return e.side===Yu.PARENT?{patchNum:e.patch_set,basePatchNum:Qu}:t===e.patch_set?{patchNum:t,basePatchNum:Qu}:{patchNum:t,basePatchNum:e.patch_set}}(a,d);if(c!==Qu){const e=await this.restApiService.getDiff(t,c,h,l);e&&function(e){return!e.content.some((e=>e.a&&!e.common||e.b&&!e.common))}(e)&&(ea(document,`File is unchanged between Patchset ${c} and ${h}.\n           Showing diff of Base vs ${c}.`),h=c,c=Qu)}const p=qC({changeNum:t,repo:i,patchNum:h,basePatchNum:c,diffView:{path:l,lineNum:a.line,leftSide:sC(a,{basePatchNum:c,patchNum:h})}});this.redirect(p)}handleCommentsRoute(e){const t=Number(e.params[1]),i={repo:e.params[0],changeNum:t,commentId:e.params[2],view:gw.CHANGE,childView:zC.OVERVIEW};new URLSearchParams(e.querystring).has("forceReload")&&(i.forceReload=!0),ba(i.repo),this.reporting.setRepoName(i.repo),this.reporting.setChangeId(t),this.normalizePatchRangeParams(i),this.setState(i),this.changeViewModel.setState(i)}handleDiffRoute(e){const t=Number(e.params[1]),i={repo:e.params[0],changeNum:t,basePatchNum:Rx(e.params[4]),patchNum:Rx(e.params[6]),view:gw.CHANGE,childView:zC.DIFF,diffView:{path:e.params[8]}},r=new URLSearchParams(e.querystring),o=Number(r.get("checksPatchset"));Number.isInteger(o)&&o>0&&(i.checksPatchset=o),r.has("forceReload")&&(i.forceReload=!0);const s=this.parseLineAddress(e.hash);s&&(i.diffView.leftSide=s.leftSide,i.diffView.lineNum=s.lineNum),this.reporting.setRepoName(i.repo??""),this.reporting.setChangeId(t),this.normalizePatchRangeParams(i),this.setState(i),this.changeViewModel.setState(i)}handleChangeLegacyRoute(e){const t=Number(e.params[0]);t?this.restApiService.getRepoName(t).then((i=>{i?this.redirect(`/c/${i}/+/${t}/${e.params[1]}`+(e.querystring.length>0?`?${e.querystring}`:"")+(e.hash.length>0?`#${e.hash}`:"")):this.show404()})):this.show404()}handleLegacyLinenum(e){this.redirect(e.path.replace(NH,"#$1"))}handleDiffEditRoute(e){const t=e.params[0],i=Number(e.params[1]),r={repo:t,changeNum:i,patchNum:Rx(e.params[2]),view:gw.CHANGE,childView:zC.EDIT,editView:{path:e.params[3],lineNum:Number(e.hash)}};new URLSearchParams(e.querystring).has("forceReload")&&(r.forceReload=!0),this.normalizePatchRangeParams(r),this.setState(r),this.changeViewModel.setState(r),this.reporting.setRepoName(t),this.reporting.setChangeId(i)}handleChangeEditRoute(e){const t=e.params[0],i=Number(e.params[1]),r=new URLSearchParams(e.querystring),o={repo:t,changeNum:i,patchNum:Rx(e.params[3]),view:gw.CHANGE,childView:zC.OVERVIEW,edit:!0},s=r.get("tab");s&&(o.tab=s),r.has("forceReload")&&(o.forceReload=!0),this.normalizePatchRangeParams(o),this.setState(o),this.changeViewModel.setState(o),this.reporting.setRepoName(t),this.reporting.setChangeId(i)}handleAgreementsRoute(){this.redirect("/settings/#Agreements")}handleNewAgreementsRoute(){const e={view:gw.AGREEMENTS};this.setState(e),this.agreementViewModel.setState(e)}handleSettingsLegacyRoute(e){const t=e.params[0].replace(/ /g,"+"),i={view:gw.SETTINGS,emailToken:t};this.setState(i),this.settingsViewModel.setState(i)}handleSettingsRoute(e){const t={view:gw.SETTINGS};this.setState(t),this.settingsViewModel.setState(t)}handleRegisterRoute(e){this.setState({justRegistered:!0});let t=e.params[0]||"/";t.startsWith("/register")&&(t="/"),"/"===t[0]&&this.redirect(Sf()+t)}handleImproperlyEncodedPlusRoute(e){let t=this.getHashFromCanonicalPath(e.canonicalPath);t.length&&(t="#"+t),this.redirect(`/c/${e.params[0]}/+/${e.params[1]}${t}`)}handlePluginScreen(e){const t={view:gw.PLUGIN_SCREEN,plugin:e.params[0],screen:e.params[1]};this.setState(t),this.pluginViewModel.setState(t)}handleDocumentationSearchRoute(e){const t={view:gw.DOCUMENTATION_SEARCH,filter:e.params[0]??""};this.setState(t),this.documentationViewModel.setState(t)}handleDocumentationSearchRedirectRoute(e){this.redirect("/Documentation/q/filter:"+Rf(e.params[0]))}handleDocumentationRedirectRoute(e){e.params[1]?Rn():this.redirect("/Documentation/index.html")}handleDefaultRoute(){this._isInitialLoad?this.show404():this.windowReload()}windowReload(){Rn()}show404(){ia(new Response("",{status:404}))}}const FH=e=>(e=>null!=e?._$litType$?.h)(e)?e._$litType$.h:e.strings,UH=Zc(class extends eh{constructor(e){super(e),this.et=new WeakMap}render(e){return[e]}update(e,[t]){const i=Mv(this.it)?FH(this.it):null,r=Mv(t)?FH(t):null;if(null!==i&&(null===r||i!==r)){const t=zv(e).pop();let r=this.et.get(i);if(void 0===r){const e=document.createDocumentFragment();r=Rc(uc,e),r.setConnected(!1),this.et.set(i,r)}Gv(r,[t]),Bv(r,void 0,t)}if(null!==r){if(null===i||i!==r){const t=this.et.get(r);if(void 0!==t){const i=zv(t).pop();(e=>{e._$AR()})(e),Bv(e,void 0,i),Gv(e,[i])}}this.it=t}else this.it=void 0;return this.render(t)}});function BH(e){return t=>(i,r)=>{Object.defineProperty(i,r,{get(){return e(this.shadowRoot,t)},enumerable:!0,configurable:!0})}}BH(((e,t)=>e.querySelector(t))),BH(((e,t)=>e.querySelectorAll(t)));var HH=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let jH=class extends dn{static get template(){return nn`
      <style>
        /* prettier formatter removes semi-colons after css mixins. */
        /* prettier-ignore */
        :host {
          /* If you want to use css-mixins in Lit elements, then you have to
          first use them in a PolymerElement somewhere. We are collecting all
          css- mixin usage here, but we may move them somewhere else later when
          converting gr-app-element to Lit. In the Lit element you can then use
          the css variables directly such as --paper-input-container_-_padding,
          so you don't have to mess with mixins at all.
          */
          --paper-input-container: {
            padding: 8px 0;
          };
          --paper-font-common-base: {
            font-family: var(--header-font-family);
            -webkit-font-smoothing: initial;
          };
          --paper-input-container-input: {
            font-size: var(--font-size-normal);
            line-height: var(--line-height-normal);
            color: var(--primary-text-color);
          };
          --paper-input-container-underline: {
            height: 0;
            display: none;
          };
          --paper-input-container-underline-focus: {
            height: 0;
            display: none;
          };
          --paper-input-container-underline-disabled: {
            height: 0;
            display: none;
          };
          --paper-input-container-label: {
            display: none;
          };
          --paper-item: {
            min-height: 0;
            padding: 0px 16px;
          };
          --paper-item-focused-before: {
            background-color: var(--selection-background-color);
          };
          --paper-item-focused: {
            background-color: var(--selection-background-color);
          };
          --paper-listbox: {
            padding: 0;
          };
        }
      </style>
    `}};var GH;jH=HH([(GH="gr-css-mixins",e=>{if(GH)if(e.hasOwnProperty("is")){if(GH!==e.is)throw new Error(`custom element tag names do not match: (${GH} !== ${e.is})`)}else Object.defineProperty(e,"is",{value:GH});window.customElements.define(e.is,e)})],jH);var zH=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let VH=class extends Ic{constructor(){super(),this.loadRegistrationDialog=!1,this.loadKeyboardShortcutsDialog=!1,this.theme=mg.AUTO,this.pluginScreenName="",this.getRouter=yu(this,LH),this.getNavigation=yu(this,gy),this.reporting=Xn().reportingService,this.restApiService=Xn().restApiService,this.getBrowserModel=yu(this,LL),this.shortcuts=new Gg(this),this.getUserModel=yu(this,jf),this.getRouterModel=yu(this,mw),this.getChangeViewModel=yu(this,XC),this.getPluginViewModel=yu(this,YU),this.getSearchViewModel=yu(this,iE),document.addEventListener("page-error",(e=>{this.handlePageError(e)})),document.addEventListener("title-change",(e=>{this.handleTitleChange(e)})),document.addEventListener("location-change",(()=>this.requestUpdate())),document.addEventListener("gr-rpc-log",(e=>this.handleRpcLog(e))),this.shortcuts.addAbstract(pu.OPEN_SHORTCUT_HELP_DIALOG,(()=>this.showKeyboardShortcuts())),this.shortcuts.addAbstract(pu.GO_TO_USER_DASHBOARD,(()=>this.getNavigation().setUrl(aE({type:sE.USER,user:"self"})))),this.shortcuts.addAbstract(pu.GO_TO_OPENED_CHANGES,(()=>this.getNavigation().setUrl(tE({statuses:["open"]})))),this.shortcuts.addAbstract(pu.GO_TO_MERGED_CHANGES,(()=>this.getNavigation().setUrl(tE({statuses:["merged"]})))),this.shortcuts.addAbstract(pu.GO_TO_ABANDONED_CHANGES,(()=>this.getNavigation().setUrl(tE({statuses:["abandoned"]})))),this.shortcuts.addAbstract(pu.GO_TO_WATCHED_CHANGES,(()=>this.getNavigation().setUrl(tE({query:"is:watched is:open"})))),this.shortcuts.addAbstract(pu.GO_TO_REPOS,(()=>this.getNavigation().setUrl(Aw({adminView:Cw.REPOS})))),this.shortcuts.addAbstract(pu.GO_TO_GROUPS,(()=>this.getNavigation().setUrl(Aw({adminView:Cw.GROUPS})))),zf(this,(()=>this.getUserModel().preferenceTheme$),(e=>{this.theme=e,this.applyTheme()})),zf(this,(()=>this.getRouterModel().routerView$),(e=>{this.view=e,e&&this.errorView?.classList.remove("show")})),zf(this,(()=>this.getPluginViewModel().screenName$),(e=>this.pluginScreenName=e)),zf(this,(()=>this.getChangeViewModel().childView$),(e=>this.childView=e)),zf(this,(()=>this.getChangeViewModel().changeNum$),(e=>{this.changeNum=e})),MU().addEventListener("change",(()=>{this.theme===mg.AUTO&&this.applyTheme()}))}connectedCallback(){super.connectedCallback(),this.getBrowserModel().observeWidth().observe(this),this.reporting.appStarted(),this.getRouter().start(),this.restApiService.getAccount().then((e=>{this.account=e,e?this.reporting.reportLifeCycle(ha.STARTED_AS_USER):this.reporting.reportLifeCycle(ha.STARTED_AS_GUEST)})),this.restApiService.getVersion().then((e=>{this.version=e,this.logWelcome()})),this.settingsUrl=gO()}static get styles(){return[Nc,Iw,Sd`
        :host {
          background-color: var(--background-color-secondary);
          display: flex;
          flex-direction: column;
          min-height: 100%;
        }
        gr-main-header,
        footer {
          color: var(--primary-text-color);
        }
        gr-main-header {
          background: var(
            --header-background,
            var(--header-background-color, #eee)
          );
          /* Make sure the header is above the main content, to preserve
            box-shadow visibility. We need 111 here 1, because dropdowns in the
            header should be shown on top of the sticky diff header, which has a
            z-index of 110. */
          z-index: 111;
        }
        footer {
          background: var(
            --footer-background,
            var(--footer-background-color, #eee)
          );
          border-top: var(--footer-border-top);
          display: flex;
          justify-content: space-between;
          padding: var(--spacing-m) var(--spacing-l);
          z-index: 100;
        }
        main {
          flex: 1;
          padding-bottom: var(--spacing-xxl);
          position: relative;
        }
        .errorView {
          align-items: center;
          display: none;
          flex-direction: column;
          justify-content: center;
          position: absolute;
          top: 0;
          right: 0;
          bottom: 0;
          left: 0;
        }
        .errorView.show {
          display: flex;
        }
        .errorEmoji {
          font-size: 2.6rem;
        }
        .errorText,
        .errorMoreInfo {
          margin-top: var(--spacing-m);
        }
        .errorText {
          font-family: var(--header-font-family);
          font-size: var(--font-size-h3);
          font-weight: var(--font-weight-h3);
          line-height: var(--line-height-h3);
        }
        .errorMoreInfo {
          color: var(--deemphasized-text-color);
        }
      `]}render(){return dc`
      <gr-css-mixins></gr-css-mixins>
      <gr-endpoint-decorator name="banner"></gr-endpoint-decorator>
      ${this.renderHeader()}
      <main>
        ${this.renderChangeListView()} ${this.renderDashboardView()}
        ${fM(this.changeNum,dc`
              ${this.renderChangeView()} ${this.renderEditorView()}
              ${this.renderDiffView()}
            `)}
        ${this.renderSettingsView()} ${this.renderAdminView()}
        ${this.renderPluginScreen()} ${this.renderCLAView()}
        ${this.renderDocumentationSearch()}
        <div id="errorView" class="errorView">
          <div class="errorEmoji">${this.lastError?.emoji}</div>
          <div class="errorText">${this.lastError?.text}</div>
          <div class="errorMoreInfo">${this.lastError?.moreInfo}</div>
        </div>
      </main>
      ${this.renderFooter()} ${this.renderKeyboardShortcutsDialog()}
      ${this.renderRegistrationDialog()}
      <gr-endpoint-decorator name="plugin-overlay"></gr-endpoint-decorator>
      <gr-error-manager id="errorManager"></gr-error-manager>
      <gr-plugin-host id="plugins"></gr-plugin-host>
    `}renderHeader(){return this.hideHeaderAndFooter()?uc:dc`
      <gr-main-header
        id="mainHeader"
        @show-keyboard-shortcuts=${this.showKeyboardShortcuts}
      >
      </gr-main-header>
    `}renderFooter(){return this.hideHeaderAndFooter()?uc:dc`
      <footer>
        <div>
          Powered by
          <a
            href="https://www.gerritcodereview.com/"
            rel="noopener noreferrer"
            target="_blank"
            >Gerrit Code Review</a
          >
          (${this.version})
          <gr-endpoint-decorator name="footer-left"></gr-endpoint-decorator>
        </div>
        <div>
          Press “?” for keyboard shortcuts
          <gr-endpoint-decorator name="footer-right"></gr-endpoint-decorator>
        </div>
      </footer>
    `}hideHeaderAndFooter(){return this.view===gw.PLUGIN_SCREEN&&qU.includes(this.pluginScreenName)}renderChangeListView(){return UH(this.view===gw.SEARCH?dc` <gr-change-list-view></gr-change-list-view> `:uc)}renderDashboardView(){return UH(this.view===gw.DASHBOARD?dc`<gr-dashboard-view></gr-dashboard-view>`:uc)}renderChangeView(){return UH(this.isChangeView()?dc`<gr-change-view
            .backPage=${this.lastSearchPage}
          ></gr-change-view>`:uc)}isChangeView(){return this.view===gw.CHANGE&&this.childView===zC.OVERVIEW}renderEditorView(){return this.isEditorView()?dc`<gr-editor-view></gr-editor-view>`:uc}isEditorView(){return this.view===gw.CHANGE&&this.childView===zC.EDIT}renderDiffView(){return UH(this.isDiffView()?dc`<gr-diff-view></gr-diff-view>`:uc)}isDiffView(){return this.view===gw.CHANGE&&this.childView===zC.DIFF}renderSettingsView(){return this.view!==gw.SETTINGS?uc:dc`
      <gr-settings-view
        @account-detail-update=${this.handleAccountDetailUpdate}
      >
      </gr-settings-view>
    `}renderAdminView(){return this.view!==gw.ADMIN&&this.view!==gw.GROUP&&this.view!==gw.REPO?uc:dc`<gr-admin-view></gr-admin-view>`}renderPluginScreen(){return this.view!==gw.PLUGIN_SCREEN?uc:dc`<gr-plugin-screen></gr-plugin-screen>`}renderCLAView(){return this.view!==gw.AGREEMENTS?uc:dc`<gr-cla-view></gr-cla-view>`}renderDocumentationSearch(){return this.view!==gw.DOCUMENTATION_SEARCH?uc:dc`<gr-documentation-search></gr-documentation-search>`}renderKeyboardShortcutsDialog(){return this.loadKeyboardShortcutsDialog?dc`
      <dialog id="keyboardShortcuts" tabindex="-1">
        <gr-keyboard-shortcuts-dialog
          @close=${this.handleKeyboardShortcutDialogClose}
        ></gr-keyboard-shortcuts-dialog>
      </dialog>
    `:uc}renderRegistrationDialog(){return this.loadRegistrationDialog?dc`
      <dialog id="registrationModal" tabindex="-1">
        <gr-registration-dialog
          id="registrationDialog"
          .settingsUrl=${this.settingsUrl}
          @account-detail-update=${this.handleAccountDetailUpdate}
          @close=${this.handleRegistrationDialogClose}
        >
        </gr-registration-dialog>
      </dialog>
    `:uc}willUpdate(e){e.has("account")&&this.accountChanged(),e.has("params")&&(this.viewChanged(),this.paramsChanged())}accountChanged(){this.account&&(this.restApiService.getPreferences(),this.restApiService.getDiffPreferences(),this.restApiService.getEditPreferences(),this.errorManager&&(this.errorManager.knownAccountId=this.account&&this.account._account_id||null))}async viewChanged(){this.params&&function(e){return void 0!==e.justRegistered}(this.params)&&this.params.justRegistered&&(this.loadRegistrationDialog=!0,await this.updateComplete,ba(this.registrationModal,"registrationModal"),ba(this.registrationDialog,"registrationDialog"),this.registrationModal.showModal(),await this.registrationDialog.loadData()),sa(this," ")}applyTheme(){const e=FU(this.theme);document.documentElement.classList.toggle("darkTheme",e),document.documentElement.classList.toggle("lightTheme",!e),e?function(){if(document.head.querySelector("#dark-theme"))return;const e=document.createElement("style");e.setAttribute("id","dark-theme"),ud(e,yd);const t=document.head.querySelector("style#plugin-style");document.head.insertBefore(e,t)}():function(){const e=document.head.querySelector("#dark-theme");e?.remove()}()}handlePageError(e){this.view=void 0,this.errorView?.classList.add("show");const t=e.detail.response,i={text:[t?.status,t?.statusText].join(" ")};404===t?.status?(i.emoji="¯\\_(ツ)_/¯",this.lastError=i):(i.emoji="o_O",t&&t.text().then((e=>{const r=t.headers&&t.headers.get("X-Gerrit-Trace"),{status:o,statusText:s}=t;i.moreInfo=dU({status:o,statusText:s,errorText:e,trace:r}),this.lastError=i})))}paramsChanged(){const e=[gw.SEARCH,gw.DASHBOARD];if(this.params?.view&&e.includes(this.params.view)&&(this.lastSearchPage=location.pathname),this.params?.view!==gw.SEARCH){const e={view:gw.SEARCH,query:"",offset:"",loading:!1};this.getSearchViewModel().updateState(e)}}handleTitleChange(e){e.detail.title?document.title=e.detail.title+" · Gerrit Code Review":document.title=""}async showKeyboardShortcuts(){this.loadKeyboardShortcutsDialog=!0,await this.updateComplete,ba(this.keyboardShortcuts,"keyboardShortcuts"),this.keyboardShortcuts.hasAttribute("open")?this.keyboardShortcuts.close():this.keyboardShortcuts.showModal()}handleKeyboardShortcutDialogClose(){ba(this.keyboardShortcuts,"keyboardShortcuts"),this.keyboardShortcuts.close()}handleAccountDetailUpdate(){this.mainHeader?.reload(),this.settingsView?.reloadAccountDetail()}handleRegistrationDialogClose(){this.params.justRegistered=!1,ba(this.registrationModal,"registrationModal"),this.registrationModal.close()}logWelcome(){console.group("Runtime Info"),console.info("Gerrit UI (PolyGerrit)"),console.info(`Gerrit Server Version: ${this.version}`),window.VERSION_INFO&&console.info(`UI Version Info: ${window.VERSION_INFO}`),console.groupEnd()}handleRpcLog(e){this.reporting.reportRpcTiming(e.detail.anonymizedUrl,e.detail.elapsed)}};zH([Hc("#errorManager")],VH.prototype,"errorManager",void 0),zH([Hc("#errorView")],VH.prototype,"errorView",void 0),zH([Hc("#mainHeader")],VH.prototype,"mainHeader",void 0),zH([Hc("#registrationModal")],VH.prototype,"registrationModal",void 0),zH([Hc("#registrationDialog")],VH.prototype,"registrationDialog",void 0),zH([Hc("#keyboardShortcuts")],VH.prototype,"keyboardShortcuts",void 0),zH([Hc("gr-settings-view")],VH.prototype,"settingsView",void 0),zH([Fc({type:Object})],VH.prototype,"params",void 0),zH([Uc()],VH.prototype,"account",void 0),zH([Uc()],VH.prototype,"version",void 0),zH([Uc()],VH.prototype,"view",void 0),zH([Uc()],VH.prototype,"childView",void 0),zH([Uc()],VH.prototype,"changeNum",void 0),zH([Uc()],VH.prototype,"lastError",void 0),zH([Uc()],VH.prototype,"lastSearchPage",void 0),zH([Uc()],VH.prototype,"settingsUrl",void 0),zH([Uc()],VH.prototype,"loadRegistrationDialog",void 0),zH([Uc()],VH.prototype,"loadKeyboardShortcutsDialog",void 0),zH([Uc()],VH.prototype,"theme",void 0),zH([Uc()],VH.prototype,"pluginScreenName",void 0),zH([Uc()],VH.prototype,"serverConfig",void 0),VH=zH([Dc("gr-app-element")],VH),function(){var e=this||self,t=function(t,i){t=t.split(".");var r,o=e;t[0]in o||void 0===o.execScript||o.execScript("var "+t[0]);for(;t.length&&(r=t.shift());)t.length||void 0===i?o=o[r]&&o[r]!==Object.prototype[r]?o[r]:o[r]={}:o[r]=i},i=function(e,t,i){return e.call.apply(e.bind,arguments)},r=function(e,t,i){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),e.apply(t,i)}}return function(){return e.apply(t,arguments)}},o=function(e,t,s){return(o=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?i:r).apply(null,arguments)},s={align:1,alt:1,"aria-activedescendant":10,"aria-atomic":1,"aria-autocomplete":1,"aria-busy":1,"aria-checked":1,"aria-disabled":1,"aria-dropeffect":1,"aria-expanded":1,"aria-haspopup":1,"aria-hidden":1,"aria-invalid":1,"aria-label":1,"aria-level":1,"aria-live":1,"aria-multiline":1,"aria-multiselectable":1,"aria-orientation":1,"aria-posinset":1,"aria-pressed":1,"aria-readonly":1,"aria-relevant":1,"aria-required":1,"aria-selected":1,"aria-setsize":1,"aria-sort":1,"aria-valuemax":1,"aria-valuemin":1,"aria-valuenow":1,"aria-valuetext":1,autocapitalize:1,autocomplete:1,autocorrect:1,autofocus:1,bgcolor:1,border:1,checked:1,class:1,color:1,cols:1,colspan:1,contenteditable:1,dir:8,disabled:1,draggable:1,enctype:1,face:1,for:10,formenctype:1,frameborder:1,height:1,hidden:1,href:4,hreflang:1,id:10,ismap:1,itemid:1,itemprop:1,itemref:1,itemscope:1,itemtype:1,label:1,lang:1,list:10,loop:1,max:1,maxlength:1,min:1,multiple:1,muted:1,name:10,placeholder:1,preload:1,rel:1,required:1,reversed:1,role:1,rows:1,rowspan:1,selected:1,shape:1,size:1,sizes:1,span:1,spellcheck:1,src:4,start:1,step:1,style:5,summary:1,tabindex:1,target:8,title:1,translate:1,valign:1,value:1,width:1,wrap:1},n={a:{href:[{c:3}]},area:{href:[{c:3}]},audio:{src:[{c:3}]},blockquote:{cite:[{c:3}]},button:{formaction:[{c:3}],formmethod:[{c:1}],type:[{c:1}]},command:{type:[{c:1}]},content:{select:[{c:1}]},del:{cite:[{c:3}]},details:{open:[{c:1}]},form:{action:[{c:3}],method:[{c:1}]},iframe:{srcdoc:[{c:2}]},img:{src:[{c:3}],srcset:[{c:11}]},input:{formaction:[{c:3}],formmethod:[{c:1}],pattern:[{c:1}],readonly:[{c:1}],src:[{c:3}],type:[{c:1}]},ins:{cite:[{c:3}]},li:{type:[{c:1}]},link:{href:[{c:3,f:"rel",g:"alternate"},{c:3,f:"rel",g:"author"},{c:3,f:"rel",g:"bookmark"},{c:3,f:"rel",g:"canonical"},{c:3,f:"rel",g:"cite"},{c:3,f:"rel",g:"help"},{c:3,f:"rel",g:"icon"},{c:3,f:"rel",g:"license"},{c:3,f:"rel",g:"next"},{c:3,f:"rel",g:"prefetch"},{c:3,f:"rel",g:"dns-prefetch"},{c:3,f:"rel",g:"prerender"},{c:3,f:"rel",g:"preconnect"},{c:3,f:"rel",g:"preload"},{c:3,f:"rel",g:"prev"},{c:3,f:"rel",g:"search"},{c:3,f:"rel",g:"subresource"}],media:[{c:1}],nonce:[{c:1}],type:[{c:1}]},menuitem:{icon:[{c:3}]},ol:{type:[{c:1}]},q:{cite:[{c:3}]},script:{nonce:[{c:1}],type:[{c:1}]},source:{media:[{c:1}],src:[{c:3}]},style:{media:[{c:1}],nonce:[{c:1}]},table:{cellpadding:[{c:1}],cellspacing:[{c:1}]},textarea:{readonly:[{c:1}]},time:{datetime:[{c:1}]},video:{autoplay:[{c:1}],controls:[{c:1}],poster:[{c:3}],src:[{c:3}]}},a={a:1,abbr:1,address:1,applet:4,area:5,article:1,aside:1,audio:1,b:1,base:4,bdi:1,bdo:1,blockquote:1,body:1,br:5,button:1,canvas:1,caption:1,cite:1,code:1,col:5,colgroup:1,command:1,content:1,data:1,datalist:1,dd:1,del:1,details:1,dfn:1,dialog:1,div:1,dl:1,dt:1,em:1,embed:4,fieldset:1,figcaption:1,figure:1,font:1,footer:1,form:1,frame:1,frameset:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,head:1,header:1,hr:5,html:1,i:1,iframe:1,img:5,input:5,ins:1,kbd:1,keygen:5,label:1,legend:1,li:1,link:5,main:1,map:1,mark:1,math:4,menu:1,menuitem:1,meta:4,meter:1,nav:1,noscript:1,object:4,ol:1,optgroup:1,option:1,output:1,p:1,param:5,picture:1,pre:1,progress:1,q:1,rb:1,rp:1,rt:1,rtc:1,ruby:1,s:1,samp:1,script:3,section:1,select:1,slot:1,small:1,source:5,span:1,strong:1,style:2,sub:1,summary:1,sup:1,svg:4,table:1,tbody:1,td:1,template:4,textarea:6,tfoot:1,th:1,thead:1,time:1,title:6,tr:1,track:5,u:1,ul:1,var:1,video:1,wbr:5},l=[{auto:!0,ltr:!0,rtl:!0},{_self:!0,_blank:!0}],d={"*":{dir:0,target:1}},c=function(){if(!u){var e=p,t={};for(i in e)t[i]=e[i];for(u=t,e=0,t=h.length;e<t;++e){var i=h[e];u[i.toLowerCase()]=i}}return u},h="aLink accessKey allowFullscreen bgColor cellPadding cellSpacing codeBase codeType contentEditable crossOrigin dateTime dirName formAction formEnctype formMethod formNoValidate formTarget frameBorder innerHTML innerText inputMode isMap longDesc marginHeight marginWidth maxLength mediaGroup minLength noHref noResize noShade noValidate noWrap nodeValue outerHTML outerText readOnly tabIndex textContent trueSpeed useMap vAlign vLink valueAsDate valueAsNumber valueType".split(" "),p={accept_charset:"acceptCharset",char:"ch",charoff:"chOff",checked:"defaultChecked",class:"className",for:"htmlFor",http_equiv:"httpEquiv",muted:"defaultMuted",selected:"defaultSelected",value:"defaultValue"},u=null,g=null,m={},f=!1,v=0,b=/^(?!(?:annotation-xml|color-profile|font-face|font-face(?:-(?:src|uri|format|name))?|missing-glyph)$)[a-z][a-z.0-9_\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u200c\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\udfff\uf900-\ufdcf\ufdf0-\ufffd]*-[\-a-z.0-9_\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u200c\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\udfff\uf900-\ufdcf\ufdf0-\ufffd]*$/,y=function(e,t){var i=window.customElements;if(f){for(var r=window.Polymer.telemetry.registrations,o=r.length,s=v;s<o;++s)m[r[s].is]=m;v=o}return i&&i.get(e)||m[e]===m?2:"HTMLUnknownElement"===t.name?1:"HTMLElement"===t.name&&b.test(e)?3:0},w=/(?!,)([^\t\n\f\r ]+)(?:[\t\n\f\r ]+([.0-9+\-]+[a-z]?))?/gi,_=/[\t\n\f\r ]+/,x=/[\t\n\f\r ,]+/g,C=function(e){return(e=e.split(_,2))?{url:e[0],metadata:e[1]}:null},E=function(e){var t=String(e.url).replace(x,encodeURIComponent);if(e=e.metadata){if(x.lastIndex=0,x.test(e))return null;t+=" "+e}return t},S=function(e,t,i){return i};t("security.polymer_resin.install",(function(e){var t=function(e){function t(e){var t=this.getAttribute(e);return!t||/[\[\{]/.test(e)?null:t}var i=e.reportHandler||void 0,r=e.safeTypesBridge||S,h=/^$/;if(e=e.allowedIdentifierPrefixes)for(var p=0,u=e.length;p<u;++p)h=new RegExp(h.source+"|^"+String(e[p]).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"));i&&i(!1,"initResin");var m={},f=[,{h:null,j:function(e,t,i){return i},l:null,m:null},{h:null,j:null,l:null,m:"HTML"},{h:null,j:null,l:"about:invalid#zClosurez",m:"URL"},{h:null,j:null,l:"about:invalid#zClosurez",m:"RESOURCE_URL"},{h:null,j:null,l:"zClosurez",m:"STYLE"},,{h:null,j:null,l:" /*zClosurez*/ ",m:"JAVASCRIPT"},{h:null,j:function(e,t,i){i=String(i).toLowerCase();var r=null;return(e=d[e])&&(r=e[t]),(t=("number"==typeof r||((e=d["*"])&&(r=e[t]),"number"==typeof r))&&!0===l[r][String(i).toLowerCase()])?i:"zClosurez"},l:"zClosurez",m:null},{h:null,j:null,l:"zClosurez",m:"CONSTANT"},{h:null,j:function(e,t,i){return h.test(i)?i:"zClosurez"},l:"zClosurez",m:"CONSTANT"},{h:function(e,t,o){var s=o;if("string"==typeof s&&(s=(s=s.match(w))?s.map(C).filter(Boolean):[]),!Array.isArray(s))return"about:invalid#zClosurez";var n=s;s=[];var a=[],l={};if(Array.isArray(n))for(var d=0,c=n.length;d<c;++d){var h=n[d],p=h&&h.url;if(p){var u=r(p,"URL",l);if(u){var g=u!==l;(g?s:a).push({url:g?u:p,metadata:h.metadata})}}}else a.push(n);if(n=a.length?JSON.stringify(a):null,a=m,s.length){if(!Array.isArray(s))throw Error();a=s.map(E).filter(Boolean).join(" , ")||m}return n&&i&&i(!0,'Failed to sanitize attribute value of <%s>: <%s %s="%O">: %s',e,e,t,o,n),a===m?"about:invalid#zClosurez":a},j:null,l:null,m:null}],v={},b=document.createElement("polyresinuncustomized");return function(e,l,d,h){if(!h&&h!==document.all)return h;var p=e.nodeType;if(p!==Node.ELEMENT_NODE){if(p===Node.TEXT_NODE){if(l=!(p=e.parentElement),p&&p.nodeType===Node.ELEMENT_NODE){var u=p.localName;switch(y(u,p.constructor)){case 0:case 1:l=1===(p=Object.hasOwnProperty.call(a,u)?a[u]:null)||6===p;break;case 3:case 2:l=!0}}if(l)return""+r(h,"STRING",h)}return i&&i(!0,"Failed to sanitize %s %s%s node to value %O",e.parentElement&&e.parentElement.nodeName,"#text","",h),"zClosurez"}p=e.localName;var w=e.localName;if(e.getAttribute("is")||2!==y(w,e.constructor)){var _=v[w];_||(_=v[w]=document.createElement(w)),w=_}else w=b;switch(d){case"attribute":_=String(l).toLowerCase();var x=c()[_];if(("string"==typeof x?x:function(e){return String(e).replace(/\-([a-z])/g,(function(e,t){return t.toUpperCase()}))}(_))in w)break;return h;case"property":if(l in w)break;if(_=l.toLowerCase(),(_="string"==typeof(_=c()[_])?_:null)&&_ in w)break;return h;default:throw Error(d+": "+typeof d)}if("attribute"==d)l=l.toLowerCase();else{if(!(d=g)){for(u in w={},d=c())w[d[u]]=u;d=g=w}l="string"==typeof(u=d[l])?u:String(l).replace(/([A-Z])/g,"-$1").toLowerCase()}e:{if(e=o(t,e),Object.hasOwnProperty.call(n,p)&&(u=n[p],Object.hasOwnProperty.call(u,l)&&(u=u[l])instanceof Array)){for(d=null,w=!1,_=0,x=u.length;_<x;++_){var C=u[_],E=C.f;if(!E){d=C.c;break e}if(null===d&&(d={}),(E=Object.hasOwnProperty.call(d,E)?d[E]:d[E]=e(E))===C.g){d=C.c;break e}null==E&&(w=!0)}if(w){d=null;break e}}d="number"==typeof(e=s[l])?e:null}return u=m,e=null,null!=d&&(w=(d=f[d]).m,e=d.l,w&&(u=r(h,w,m)),u===m&&(d.j?(u=""+r(h,"STRING",h),u=d.j(p,l,u)):d.h&&(u=d.h(p,l,h)),u===e&&(u=m))),u===m&&(u=e||"zClosurez",i&&i(!0,'Failed to sanitize attribute of <%s>: <%s %s="%O">',p,p,l,h)),u}}(e||{});if(/^1\./.test(Polymer.version)){f=!0;var i=Polymer.Base._computeFinalAnnotationValue;if(e=function(e,r,o,s){o=i.call(this,e,r,o,s);var n="property";return s&&s.propertyName?r=s.propertyName:n=s&&s.kind||"property",t(e,r,n,o)},Polymer.Base._computeFinalAnnotationValue=e,Polymer.Base._computeFinalAnnotationValue!==e)throw Error("Cannot replace _computeFinalAnnotationValue.  Is Polymer frozen?")}else{var r=Polymer.sanitizeDOMValue||Polymer.Settings&&Polymer.Settings.sanitizeDOMValue;if(e=function(e,i,o,s){return e=r?r.call(Polymer,e,i,o,s):e,s?t(s,i,o,e):"zClosurez"},Polymer.Settings&&Polymer.Settings.o)Polymer.Settings.o(e);else if(Polymer.sanitizeDOMValue=e,Polymer.sanitizeDOMValue!==e)throw Error("Cannot install sanitizeDOMValue.  Is Polymer frozen?")}})),t("security.polymer_resin.CONSOLE_LOGGING_REPORT_HANDLER",(function(e,t,i){for(var r=[t],o=2,s=arguments.length;o<s;++o)r[o-1]=arguments[o];e?console.warn.apply(console,r):console.log.apply(console,r)}))}.call(window);const WH=window.security;WH.polymer_resin.CONSOLE_LOGGING_REPORT_HANDLER;class qH{constructor(){this._experiments=this._loadExperiments()}finalize(){}isEnabled(e){return this._experiments.has(e)}_loadExperiments(){return new Set(window.ENABLED_EXPERIMENTS??[])}get enabledExperiments(){return[...this._experiments]}}var KH;!function(e){e[e.UNDETERMINED=0]="UNDETERMINED",e[e.AUTHED=1]="AUTHED",e[e.NOT_AUTHED=2]="NOT_AUTHED",e[e.ERROR=3]="ERROR"}(KH||(KH={}));class YH{constructor(){this._last_auth_check_time=Date.now(),this._status=KH.UNDETERMINED}finalize(){}authCheck(){return(!this.authCheckPromise||Date.now()-this._last_auth_check_time>3e4)&&(this.authCheckPromise=fetch(`${Sf()}/auth-check`).then((e=>{try{e.clone().text()}catch{}return 204===e.status?(this._setStatus(KH.AUTHED),!0):(this._setStatus(KH.NOT_AUTHED),!1)})).catch((()=>(this._setStatus(KH.ERROR),this.authCheckPromise=void 0,!1))),this._last_auth_check_time=Date.now()),this.authCheckPromise}clearCache(){this.authCheckPromise=void 0}_setStatus(e){this._status!==e&&(this._status===KH.AUTHED&&Jn(document,"auth-error",{message:"Credentials expired.",action:"Refresh credentials"}),this._status=e)}get status(){return this._status}get isAuthed(){return this._status===KH.AUTHED}fetch(e,t){const i={headers:new Headers,...t};return this._fetchWithXsrfToken(e,i)}_getCookie(e){const t=e+"=";let i="";return document.cookie.split(";").some((e=>!!(e=e.trim()).startsWith(t)&&(i=e.substring(t.length),!0))),i}_fetchWithXsrfToken(e,t){if(t.method&&"GET"!==t.method){const e=this._getCookie("XSRF_TOKEN");e&&t.headers.append("X-Gerrit-Auth",e)}return t.credentials="same-origin",this._ensureBodyLoaded(fetch(e,t))}_ensureBodyLoaded(e){return e.then((e=>{if(!e.ok)try{e.clone().text()}catch{}return e}))}}class XH{schedule(e){return e()}}class JH{constructor(e,t=10){this.base=e,this.maxInflight=t,this.inflight=0,this.waiting=[]}async schedule(e){return new Promise(((t,i)=>{this.waiting.push((async()=>{try{const i=await this.base.schedule(e);t(i)}catch(e){i(e)}})),this.next()}))}next(){if(this.inflight>=this.maxInflight)return;if(0===this.waiting.length)return;const e=this.waiting.shift();++this.inflight,e().finally((()=>{--this.inflight,this.next()}))}}const QH="sendDiffDraft",ZH="Saving draft resulted in HTTP 200 (OK) but expected HTTP 201 (Created)",ej=/^set-cookie$/i,tj="/changes/*~*",ij=tj+"/revisions/*";let rj=new class{constructor(){this.data=new Map,window.INITIAL_DATA&&Object.entries(window.INITIAL_DATA).forEach((e=>this._cache().set(Mf(e[0]),e[1])))}_cache(){return this.data.has(Sf())||this.data.set(Sf(),new Map),this.data.get(Sf())}has(e){return this._cache().has(Mf(e))}get(e){return this._cache().get(Mf(e))}set(e,t){this._cache().set(Mf(e),t)}delete(e){this._cache().delete(Mf(e))}invalidatePrefix(e){const t=new Map;for(const[i,r]of this._cache().entries())i.startsWith(Mf(e))||t.set(i,r);this.data.set(Sf(),t)}},oj=new class{constructor(){this.data={}}testOnlyGetData(){return this.data}has(e){return!!this.data[Mf(e)]}get(e){return this.data[Mf(e)]}set(e,t){this.data[Mf(e)]=t}invalidatePrefix(e){const t={};Object.entries(this.data).forEach((([i,r])=>{i.startsWith(Mf(e))||(t[i]=r)})),this.data=t}},sj={},nj=new class{constructor(){this._etags=new Map,this._payloadCache=new Map}getOptions(e,t){const i=this._etags.get(e);if(!i)return t;const r={...t};return r.headers=r.headers||new Headers,r.headers.set("If-None-Match",i),r}collect(e,t,i){if(!t||!t.ok||200!==t.status)return;this._payloadCache.set(e,i);const r=t.headers&&t.headers.get("etag");r?(this._etags.set(e,r),this._truncateCache()):this._etags.delete(e)}getCachedPayload(e){return this._payloadCache.get(e)}_truncateCache(){for(const e of this._etags.keys()){if(this._etags.size<=30)break;this._etags.delete(e),this._payloadCache.delete(e)}}},aj={};function lj(e){e&&404!==e.status&&ra(e)}class dj{constructor(e,t){this.authService=e,this.flagService=t,this._cache=rj,this._sharedFetchPromises=oj,this._pendingRequests=sj,this._etags=nj,this._projectLookup=aj,this.flags=Xn().flagsService;const i=new Nf(new JH(new XH,10),3,50),r=new Nf(new JH(new XH,5),3,50);this._restApiHelper=new Bf(this._cache,this.authService,this._sharedFetchPromises,i,r),this._serialScheduler=new JH(new XH,1)}finalize(){}getConfig(e,t){return e?this._restApiHelper.fetchJSON({fetchOptions:Uf({requestOrigin:t}),url:"/config/server/info",reportUrlAsIs:!0}):this._restApiHelper.fetchCacheJSON({fetchOptions:Uf({requestOrigin:t}),url:"/config/server/info",reportUrlAsIs:!0})}getValidationOptions(e){return this._restApiHelper.fetchJSON({url:`/changes/${e}/validation-options`,reportUrlAsIs:!0})}getRepo(e,t){return this._restApiHelper.fetchCacheJSON({url:"/projects/"+encodeURIComponent(e),errFn:t,anonymizedUrl:"/projects/*"})}getProjectConfig(e,t){return this._restApiHelper.fetchCacheJSON({url:"/projects/"+encodeURIComponent(e)+"/config",errFn:t,anonymizedUrl:"/projects/*/config"})}getRepoAccess(e){return this._restApiHelper.fetchCacheJSON({url:"/access/?project="+encodeURIComponent(e),anonymizedUrl:"/access/?project=*"})}getRepoDashboards(e,t){return this._restApiHelper.fetchCacheJSON({url:`/projects/${encodeURIComponent(e)}/dashboards?inherited`,errFn:t,anonymizedUrl:"/projects/*/dashboards?inherited"})}saveRepoConfig(e,t){const i=`/projects/${encodeURIComponent(e)}/config`;return this._cache.delete(i),this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:t}),url:i,anonymizedUrl:"/projects/*/config",reportServerError:!0})}saveRepoConfigForReview(e,t){const i=`/projects/${encodeURIComponent(e)}/config:review`;return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.PUT,body:t}),url:i,anonymizedUrl:"/projects/*/config",reportServerError:!0})}runRepoGC(e){const t=encodeURIComponent(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,body:""}),url:`/projects/${t}/gc`,anonymizedUrl:"/projects/*/gc",reportServerError:!0})}createRepo(e){const t=encodeURIComponent(e.name);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:e}),url:`/projects/${t}`,anonymizedUrl:"/projects/*",reportServerError:!0})}createGroup(e){if(!e.name)throw new Error("Group name is required");const t=encodeURIComponent(e.name);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:e}),url:`/groups/${t}`,anonymizedUrl:"/groups/*",reportServerError:!0})}getGroupConfig(e,t){return this._restApiHelper.fetchJSON({url:`/groups/${encodeURIComponent(e)}/detail`,errFn:t,anonymizedUrl:"/groups/*/detail"})}deleteRepoBranches(e,t){const i=encodeURIComponent(e),r=encodeURIComponent(t);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.DELETE,body:""}),url:`/projects/${i}/branches/${r}`,anonymizedUrl:"/projects/*/branches/*",reportServerError:!0})}deleteRepoTags(e,t){const i=encodeURIComponent(e),r=encodeURIComponent(t);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.DELETE,body:""}),url:`/projects/${i}/tags/${r}`,anonymizedUrl:"/projects/*/tags/*",reportServerError:!0})}createRepoBranch(e,t,i){const r=encodeURIComponent(e),o=encodeURIComponent(t);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:i}),url:`/projects/${r}/branches/${o}`,anonymizedUrl:"/projects/*/branches/*",reportServerError:!0})}createRepoTag(e,t,i){const r=encodeURIComponent(e),o=encodeURIComponent(t);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:i}),url:`/projects/${r}/tags/${o}`,anonymizedUrl:"/projects/*/tags/*",reportServerError:!0})}getIsGroupOwner(e){if(!e)return Promise.resolve(!1);const t={url:`/groups/?owned&g=${encodeURIComponent(e)}`,anonymizedUrl:"/groups/owned&g=*"};return this._restApiHelper.fetchCacheJSON(t).then((t=>ma(t,e)))}getGroupMembers(e){const t=encodeURIComponent(e);return this._restApiHelper.fetchJSON({url:`/groups/${t}/members/`,anonymizedUrl:"/groups/*/members"})}getIncludedGroup(e){return this._restApiHelper.fetchJSON({url:`/groups/${encodeURIComponent(e)}/groups/`,anonymizedUrl:"/groups/*/groups"})}saveGroupName(e,t){const i=encodeURIComponent(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{name:t}}),url:`/groups/${i}/name`,anonymizedUrl:"/groups/*/name",reportServerError:!0})}saveGroupOwner(e,t){const i=encodeURIComponent(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{owner:t}}),url:`/groups/${i}/owner`,anonymizedUrl:"/groups/*/owner",reportServerError:!0})}saveGroupDescription(e,t){const i=encodeURIComponent(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{description:t}}),url:`/groups/${i}/description`,anonymizedUrl:"/groups/*/description",reportServerError:!0})}saveGroupOptions(e,t){const i=encodeURIComponent(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:t}),url:`/groups/${i}/options`,anonymizedUrl:"/groups/*/options",reportServerError:!0})}deleteGroup(e){const t=encodeURIComponent(e);return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`/groups/${t}`,anonymizedUrl:"/groups/*"})}getGroupAuditLog(e,t){return this._restApiHelper.fetchCacheJSON({url:`/groups/${e}/log.audit`,errFn:t,anonymizedUrl:"/groups/*/log.audit"})}saveGroupMember(e,t){const i=encodeURIComponent(e),r=encodeURIComponent(`${t}`);return this._restApiHelper.fetchJSON({fetchOptions:{method:Uu.PUT},url:`/groups/${i}/members/${r}`,anonymizedUrl:"/groups/*/members/*"})}saveIncludedGroup(e,t,i){const r=encodeURIComponent(e),o=encodeURIComponent(t),s={fetchOptions:{method:Uu.PUT},url:`/groups/${r}/groups/${o}`,errFn:i,anonymizedUrl:"/groups/*/groups/*"};return this._restApiHelper.fetchJSON(s)}deleteGroupMember(e,t){const i=encodeURIComponent(e),r=encodeURIComponent(`${t}`);return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`/groups/${i}/members/${r}`,anonymizedUrl:"/groups/*/members/*",reportServerError:!0})}deleteIncludedGroup(e,t){const i=encodeURIComponent(e),r=encodeURIComponent(t);return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`/groups/${i}/groups/${r}`,anonymizedUrl:"/groups/*/groups/*",reportServerError:!0})}getVersion(e){return this._restApiHelper.fetchCacheJSON({fetchOptions:Uf({requestOrigin:e}),url:"/config/server/version",reportUrlAsIs:!0})}getDiffPreferences(){return this.getLoggedIn().then((e=>e?this._restApiHelper.fetchCacheJSON({url:"/accounts/self/preferences.diff",reportUrlAsIs:!0}):Promise.resolve({context:10,cursor_blink_rate:0,font_size:12,ignore_whitespace:"IGNORE_NONE",line_length:100,line_wrapping:!1,show_line_endings:!0,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8})))}getEditPreferences(){return this.getLoggedIn().then((e=>e?this._restApiHelper.fetchCacheJSON({url:"/accounts/self/preferences.edit",reportUrlAsIs:!0}):Promise.resolve({auto_close_brackets:!1,cursor_blink_rate:0,hide_line_numbers:!1,hide_top_menu:!1,indent_unit:2,indent_with_tabs:!1,line_length:100,line_wrapping:!1,match_brackets:!0,show_base:!1,show_tabs:!0,show_whitespace_errors:!0,syntax_highlighting:!0,tab_size:8})))}savePreferences(e){return this._cache.delete("/accounts/self/preferences"),e.download_scheme&&(e.download_scheme=e.download_scheme.toLowerCase()),this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.PUT,body:e}),url:"/accounts/self/preferences",reportUrlAsIs:!0})}saveDiffPreferences(e){return this._cache.delete("/accounts/self/preferences.diff"),this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:e}),url:"/accounts/self/preferences.diff",reportUrlAsIs:!0,reportServerError:!0})}saveEditPreferences(e){return this._cache.delete("/accounts/self/preferences.edit"),this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:e}),url:"/accounts/self/preferences.edit",reportUrlAsIs:!0,reportServerError:!0})}getAccount(e){return this._restApiHelper.fetchCacheJSON({fetchOptions:Uf({requestOrigin:e}),url:"/accounts/self/detail",reportUrlAsIs:!0,errFn:e=>{e&&403!==e.status||this._cache.delete("/accounts/self/detail")}})}getAvatarChangeUrl(){return this._restApiHelper.fetchCacheJSON({url:"/accounts/self/avatar.change.url",reportUrlAsIs:!0,errFn:e=>{e&&403!==e.status||this._cache.delete("/accounts/self/avatar.change.url")}})}getExternalIds(){return this._restApiHelper.fetchJSON({url:"/accounts/self/external.ids",reportUrlAsIs:!0})}deleteAccount(){return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:"/accounts/self",reportUrlAsIs:!0,reportServerError:!0})}deleteAccountIdentity(e){return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,body:e}),url:"/accounts/self/external.ids:delete",reportUrlAsIs:!0,reportServerError:!0})}getAccountDetails(e,t){return this._restApiHelper.fetchCacheJSON({url:`/accounts/${encodeURIComponent(e)}/detail`,anonymizedUrl:"/accounts/*/detail",errFn:t})}async getAccountEmails(){return await this.getLoggedIn()?this._restApiHelper.fetchCacheJSON({url:"/accounts/self/emails",reportUrlAsIs:!0}):void 0}getAccountEmailsFor(e,t){return this.getLoggedIn().then((e=>e?this.getAccountCapabilities():void 0)).then((i=>{if(i&&i.viewSecondaryEmails)return this._restApiHelper.fetchCacheJSON({url:"/accounts/"+e+"/emails",reportUrlAsIs:!0,errFn:t})}))}addAccountEmail(e){return this._restApiHelper.fetch({fetchOptions:{method:Uu.PUT},url:"/accounts/self/emails/"+encodeURIComponent(e),anonymizedUrl:"/account/self/emails/*",reportServerError:!0})}deleteAccountEmail(e){return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:"/accounts/self/emails/"+encodeURIComponent(e),anonymizedUrl:"/accounts/self/email/*",reportServerError:!0})}async setPreferredAccountEmail(e){await this._restApiHelper.fetch({fetchOptions:{method:Uu.PUT},url:`/accounts/self/emails/${encodeURIComponent(e)}/preferred`,anonymizedUrl:"/accounts/self/emails/*/preferred",reportServerError:!0});const t=this._cache.get("/accounts/self/emails");if(t){const i=t.map((t=>t.email===e?{email:t.email,preferred:!0}:{email:t.email,preferred:!1}));this._cache.set("/accounts/self/emails",i)}}_updateCachedAccount(e){const t=this._cache.get("/accounts/self/detail");t&&this._cache.set("/accounts/self/detail",{...t,...e})}async setAccountName(e){const t=await this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{name:e}}),url:"/accounts/self/name",reportUrlAsIs:!0,reportServerError:!0});if(!t.ok)return;let i;204!==t.status&&(i=(await Df(t)).parsed),this._updateCachedAccount({name:i})}async setAccountUsername(e){const t=await this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{username:e}}),url:"/accounts/self/username",reportUrlAsIs:!0});if(!t.ok)return;let i;204!==t.status&&(i=(await Df(t)).parsed),this._updateCachedAccount({username:i})}async setAccountDisplayName(e){const t=await this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{display_name:e}}),url:"/accounts/self/displayname",reportUrlAsIs:!0,reportServerError:!0});if(!t.ok)return;let i;204!==t.status&&(i=(await Df(t)).parsed),this._updateCachedAccount({display_name:i})}async setAccountStatus(e){const t=await this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{status:e}}),url:"/accounts/self/status",reportUrlAsIs:!0});if(!t.ok)return;let i;204!==t.status&&(i=(await Df(t)).parsed),this._updateCachedAccount({status:i})}getAccountStatus(e){return this._restApiHelper.fetchJSON({url:`/accounts/${encodeURIComponent(e)}/status`,anonymizedUrl:"/accounts/*/status"})}getAccountGroups(){return this._restApiHelper.fetchJSON({url:"/accounts/self/groups",reportUrlAsIs:!0})}getAccountAgreements(){return this._restApiHelper.fetchJSON({url:"/accounts/self/agreements",reportUrlAsIs:!0})}saveAccountAgreement(e){return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:e}),url:"/accounts/self/agreements",reportUrlAsIs:!0,reportServerError:!0})}getAccountCapabilities(e){let t="";return e&&(t="?q="+e.map((e=>encodeURIComponent(e))).join("&q=")),this._restApiHelper.fetchCacheJSON({url:"/accounts/self/capabilities"+t,anonymizedUrl:"/accounts/self/capabilities?q=*"})}getLoggedIn(){return this.authService.authCheck()}getIsAdmin(){return this.getLoggedIn().then((e=>e?this.getAccountCapabilities():void 0)).then((e=>e&&e.administrateServer))}getDefaultPreferences(){return this._restApiHelper.fetchCacheJSON({url:"/config/server/preferences",reportUrlAsIs:!0})}getPreferences(){return this.getLoggedIn().then((e=>{if(e){const e={url:"/accounts/self/preferences",reportUrlAsIs:!0};return this._restApiHelper.fetchCacheJSON(e).then((e=>e||e))}return Eg()}))}getAccountState(){return this._restApiHelper.fetchJSON({url:"/accounts/self/state",reportUrlAsIs:!0})}getWatchedProjects(){return this._restApiHelper.fetchCacheJSON({url:"/accounts/self/watched.projects",reportUrlAsIs:!0})}saveWatchedProjects(e){return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.POST,body:e}),url:"/accounts/self/watched.projects",reportUrlAsIs:!0})}deleteWatchedProjects(e){return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,body:e}),url:"/accounts/self/watched.projects:delete",reportUrlAsIs:!0,reportServerError:!0})}getRequestForGetChanges(e,t,i,r){"n,z"===i&&(i=0);const o={O:r=r||this.getListChangesOptionsHex(),S:i||0};return e&&(o.n=e),t&&t.length>0&&(o.q=t),{url:"/changes/",params:{...o,"allow-incomplete-results":!0},reportUrlAsIs:!0}}async getChangesForDashboard(e,t,i,r){if(this.flagService.isEnabled(da.PARALLEL_DASHBOARD_REQUESTS)&&t&&t.length>1){const o=t.map((t=>this.getChanges(e,t,i,r)));return Promise.all(o).then((e=>{if(!e.includes(void 0))return e}))}return this.getChangesForMultipleQueries(e,t,i,r)}getChangesForMultipleQueries(e,t,i,r){if(!t)return Promise.resolve(void 0);const o=this.getRequestForGetChanges(e,t,i,r);return Promise.resolve(this._restApiHelper.fetchJSON(o,!0)).then((e=>{if(!e)return;const i=e=>{for(const t of e)this._maybeInsertInLookup(t)},r=1===t.length?[e]:e;for(const e of r)i(e);return r}))}getChanges(e,t,i,r,o){const s=this.getRequestForGetChanges(e,t,i,r);return Promise.resolve(this._restApiHelper.fetchJSON({...s,errFn:o},!0)).then((e=>{if(e)return(e=>{for(const t of e)this._maybeInsertInLookup(t)})(e),e}))}async getDetailedChangesWithActions(e,t=!1){const i=[uf.CHANGE_ACTIONS,uf.CURRENT_REVISION,uf.DETAILED_LABELS].concat(t?[uf.SUBMIT_REQUIREMENTS]:[]),r=e.map((e=>`change:${e}`)).join(" OR ");return await this.getChanges(void 0,r,void 0,TC(...i))}_maybeInsertInLookup(e){e?.project&&e._number&&this.addRepoNameToCache(e._number,e.project)}getChangeActionURL(e,t,i){return this._changeBaseURL(e,t).then((e=>e+i))}async getChangeDetail(e,t){if(!e)return;const i=await this.getChangeOptionsHex();return this._getChangeDetail(e,i,t).then((e=>PT.parse(e)))}async getAllRevisionFiles(e){if(!e)return;const t=TC(uf.ALL_REVISIONS,uf.ALL_FILES),i=await this.getChange(e,void 0,t);if(!i?.revisions)return;const r={};for(const e in i.revisions)i.revisions[e]?.files&&(r[e]=i.revisions[e].files);return r}getListChangesOptionsHex(){return window.DEFAULT_DETAIL_HEXES&&window.DEFAULT_DETAIL_HEXES.dashboardPage?window.DEFAULT_DETAIL_HEXES.dashboardPage:TC(uf.LABELS,uf.DETAILED_ACCOUNTS,uf.SUBMIT_REQUIREMENTS,uf.STAR)}async getChangeOptionsHex(){return window.DEFAULT_DETAIL_HEXES&&window.DEFAULT_DETAIL_HEXES.changePage?window.DEFAULT_DETAIL_HEXES.changePage:TC(...await this.getChangeOptions())}async getChangeOptions(){const e=await this.getConfig(!1),t=[uf.ALL_COMMITS,uf.ALL_REVISIONS,uf.CHANGE_ACTIONS,uf.DETAILED_ACCOUNTS,uf.DETAILED_LABELS,uf.DOWNLOAD_COMMANDS,uf.MESSAGES,uf.REVIEWER_UPDATES,uf.WEB_LINKS,uf.SKIP_DIFFSTAT,uf.PARENTS];return e?.receive?.enable_signed_push&&t.push(uf.PUSH_CERTIFICATES),this.flags.isEnabled(da.ASYNC_SUBMIT_REQUIREMENTS)||(t.push(uf.SUBMITTABLE),t.push(uf.SUBMIT_REQUIREMENTS)),t}_getChangeDetail(e,t,i){return this.getChangeActionURL(e,void 0,"/detail").then((e=>{const r={O:t},o=this._restApiHelper.urlWithParams(e,r),s={url:e,errFn:i,params:r,fetchOptions:this._etags.getOptions(o),anonymizedUrl:"/changes/*~*/detail?O="+t};return this._restApiHelper.fetch(s).then((e=>304===e?.status?Lf(this._etags.getCachedPayload(o)):!e||e.ok?e?Df(e).then((t=>(this._etags.collect(o,e,t.raw),this._maybeInsertInLookup(t.parsed),t.parsed))).catch((()=>{})):Promise.resolve(void 0):void(i?i.call(null,e):ra(e,s))))}))}async getSubmittabilityInfo(e){if(!this.flags.isEnabled(da.ASYNC_SUBMIT_REQUIREMENTS))return;const t=TC(uf.SUBMITTABLE,uf.SUBMIT_REQUIREMENTS),i=await this.getChange(e,void 0,t);return i&&void 0!==i.submittable&&void 0!==i.submit_requirements?{changeNum:e,submittable:i.submittable,submitRequirements:i.submit_requirements}:void 0}async getChangeCommitInfo(e,t){const i=await this._changeBaseURL(e,t);return this._restApiHelper.fetchJSON({url:`${i}/commit?links`,anonymizedUrl:`${ij}/commit?links`,errFn:lj})}async getChangeFiles(e,t){let i;kx(t.basePatchNum)?i={parent:Fx(t.basePatchNum)}:t.basePatchNum!==Qu&&(i={base:t.basePatchNum});const r=await this._changeBaseURL(e,t.patchNum);return this._restApiHelper.fetchJSON({url:`${r}/files`,params:i,anonymizedUrl:`${ij}/files`})}async getChangeEditFiles(e,t){const i=await this._changeBaseURL(e);let r=`${i}/edit?list`,o=`${i}/edit?list`;t.basePatchNum!==Qu&&(r+="&base="+encodeURIComponent(`${t.basePatchNum}`),o+="&base=*");const s=await this._restApiHelper.fetch({url:r,anonymizedUrl:o});if(s.ok&&204!==s.status)return(await Df(s)).parsed}async queryChangeFiles(e,t,i,r){const o=await this._changeBaseURL(e,t);return this._restApiHelper.fetchJSON({url:`${o}/files?q=${encodeURIComponent(i)}`,anonymizedUrl:`${ij}/files?q=*`,errFn:r})}getChangeOrEditFiles(e,t){return t.patchNum===Ju?this.getChangeEditFiles(e,t).then((e=>e&&e.files)):this.getChangeFiles(e,t)}async getChangeRevisionActions(e,t){const i=await this._changeBaseURL(e,t);return this._restApiHelper.fetchJSON({url:`${i}/actions`,anonymizedUrl:`${ij}/actions`})}getChangeSuggestedReviewers(e,t,i){return this.getChangeSuggestedGroup(Vu.REVIEWER,e,t,i)}getChangeSuggestedCCs(e,t,i){return this.getChangeSuggestedGroup(Vu.CC,e,t,i)}async getChangeSuggestedGroup(e,t,i,r){const o={n:6,"reviewer-state":e};i&&(o.q=i);const s=await this._changeBaseURL(t);return this._restApiHelper.fetchJSON({url:`${s}/suggest_reviewers`,params:o,anonymizedUrl:`${tj}/suggest_reviewers`,errFn:r})}async getChangeIncludedIn(e){const t=await this._changeBaseURL(e);return this._restApiHelper.fetchJSON({url:`${t}/in`,anonymizedUrl:`${t}/in`})}_computeFilter(e){return e?.startsWith("^")?"&r="+encodeURIComponent(e):e?"&m="+encodeURIComponent(e):""}_getGroupsUrl(e,t,i){return`/groups/?n=${t+1}&S=${i=i||0}`+this._computeFilter(e)}_getReposUrl(e,t,i){i=i||0,e??="";const r=encodeURIComponent(e);return e.includes(":")?[!0,`/projects/?n=${t+1}&S=${i}&query=${r}`]:[!1,`/projects/?n=${t+1}&S=${i}&d=&m=${r}`]}invalidateGroupsCache(){this._restApiHelper.invalidateFetchPromisesPrefix("/groups/?")}invalidateReposCache(){this._restApiHelper.invalidateFetchPromisesPrefix("/projects/?")}invalidateAccountsCache(){this._restApiHelper.invalidateFetchPromisesPrefix("/accounts/")}invalidateAccountsDetailCache(){this._restApiHelper.invalidateFetchPromisesPrefix("/accounts/self/detail")}invalidateAccountsEmailCache(){this._restApiHelper.invalidateFetchPromisesPrefix("/accounts/self/emails")}getGroups(e,t,i){const r=this._getGroupsUrl(e,t,i);return this._restApiHelper.fetchCacheJSON({url:r,anonymizedUrl:"/groups/?*"})}async getRepos(e,t,i,r,o){const[s,n]=this._getReposUrl(e,t,i);if(s)return this._restApiHelper.fetchCacheJSON({fetchOptions:Uf({requestOrigin:o}),url:n,anonymizedUrl:"/projects/?*",errFn:r});{const e=await this._restApiHelper.fetchCacheJSON({fetchOptions:Uf({requestOrigin:o}),url:n,anonymizedUrl:"/projects/?*",errFn:r});return void 0===e?[]:Object.entries(e).map((([e,t])=>({...t,name:e})))}}setRepoHead(e,t){return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{ref:t}}),url:`/projects/${encodeURIComponent(e)}/HEAD`,anonymizedUrl:"/projects/*/HEAD",reportServerError:!0})}getRepoBranches(e,t,i,r,o){r=r||0;const s=i+1;e=this._computeFilter(e);const n=`/projects/${encodeURIComponent(t)}/branches?n=${s}&S=${r}${e}`;return this._restApiHelper.fetchJSON({url:n,errFn:o,anonymizedUrl:"/projects/*/branches?*"})}getRepoTags(e,t,i,r,o){r=r||0;const s=`/projects/${encodeURIComponent(t)}/tags?n=${i+1}&S=${r}`+this._computeFilter(e);return this._restApiHelper.fetchJSON({url:s,errFn:o,anonymizedUrl:"/projects/*/tags"})}getPlugins(e,t,i,r){const o=`/plugins/?all&n=${t+1}&S=${i=i||0}${this._computeFilter(e)}`;return this._restApiHelper.fetchJSON({url:o,errFn:r,anonymizedUrl:"/plugins/?all"})}getRepoSubmitRequirements(e,t){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/submit_requirements`,errFn:t,anonymizedUrl:"/projects/*/submit_requirements"})}createSubmitRequirement(e,t,i){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/submit_requirements/${encodeURIComponent(t.name)}`,fetchOptions:Uf({method:Uu.PUT,body:t}),errFn:i,anonymizedUrl:"/projects/*/submit_requirements/*"})}updateSubmitRequirement(e,t,i,r){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/submit_requirements/${encodeURIComponent(t)}`,fetchOptions:Uf({method:Uu.PUT,body:i}),errFn:r,anonymizedUrl:"/projects/*/submit_requirements/*"})}deleteSubmitRequirement(e,t,i){return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`/projects/${encodeURIComponent(e)}/submit_requirements/${encodeURIComponent(t)}`,errFn:i,anonymizedUrl:"/projects/*/submit_requirements/*",reportServerError:!0})}saveRepoSubmitRequirementsForReview(e,t,i){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/submit_requirements:review`,fetchOptions:Uf({method:Uu.POST,body:t}),errFn:i,anonymizedUrl:"/projects/*/submit_requirements:review"})}getRepoLabels(e,t){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/labels/`,params:{},errFn:t,anonymizedUrl:"/projects/*/labels/"})}getRepoLabel(e,t,i){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/labels/${encodeURIComponent(t)}`,errFn:i,anonymizedUrl:"/projects/*/labels/*"})}createRepoLabel(e,t,i,r){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/labels/${encodeURIComponent(t)}`,fetchOptions:Uf({method:Uu.PUT,body:i}),errFn:r,anonymizedUrl:"/projects/*/labels/*"})}saveRepoLabelsForReview(e,t,i){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/labels:review`,fetchOptions:Uf({method:Uu.POST,body:t}),errFn:i,anonymizedUrl:"/projects/*/labels:review"})}updateRepoLabel(e,t,i,r){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/labels/${encodeURIComponent(t)}`,fetchOptions:Uf({method:Uu.PUT,body:i}),errFn:r,anonymizedUrl:"/projects/*/labels/*"})}deleteRepoLabel(e,t,i,r){return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.DELETE,body:i}),url:`/projects/${encodeURIComponent(e)}/labels/${encodeURIComponent(t)}`,errFn:r,anonymizedUrl:"/projects/*/labels/*",reportServerError:!0})}getRepoAccessRights(e,t){return this._restApiHelper.fetchJSON({url:`/projects/${encodeURIComponent(e)}/access`,errFn:t,anonymizedUrl:"/projects/*/access"})}setRepoAccessRights(e,t){return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,body:t}),url:`/projects/${encodeURIComponent(e)}/access`,anonymizedUrl:"/projects/*/access",reportServerError:!0})}setRepoAccessRightsForReview(e,t){return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.PUT,body:t}),url:`/projects/${encodeURIComponent(e)}/access:review`,anonymizedUrl:"/projects/*/access:review"})}getSuggestedGroups(e,t,i,r){const o={s:e};return i&&(o.n=i),t&&(o.p=t),this._restApiHelper.fetchJSON({url:"/groups/",params:o,reportUrlAsIs:!0,errFn:r})}getSuggestedRepos(e,t,i){const r={m:e,n:25,type:"ALL"};return t&&(r.n=t),this._restApiHelper.fetchJSON({url:"/projects/",params:r,reportUrlAsIs:!0,errFn:i})}async queryAccounts(e,t,i,r,o){const s={o:"DETAILS",q:""},n=[];if((e=e?.trim()??"").length>0&&n.push(`${Dg(e)}`),i){const e=await this.getRepoName(i);n.push(`cansee:${e}~${i}`)}return r&&n.push("is:active"),s.q=n.join(" and "),s.q?(t&&(s.n=t),this._restApiHelper.fetchJSON({url:"/accounts/",params:s,anonymizedUrl:"/accounts/?n=*",errFn:o})):Promise.resolve([])}getAccountSuggestions(e){const t={suggest:void 0,q:""};return(e=e?.trim()??"").length>0&&(t.q=e),t.q?this._restApiHelper.fetchJSON({url:"/accounts/",params:t}):Promise.resolve([])}addChangeReviewer(e,t){return this._sendChangeReviewerRequest(Uu.POST,e,t)}removeChangeReviewer(e,t){return this._sendChangeReviewerRequest(Uu.DELETE,e,t)}_sendChangeReviewerRequest(e,t,i){return this.getChangeActionURL(t,void 0,"/reviewers").then((t=>{let r;switch(e){case Uu.POST:r={reviewer:i};break;case Uu.DELETE:t+="/"+encodeURIComponent(i);break;default:fa(e,`Unsupported HTTP method: ${e}`)}return this._restApiHelper.fetch({fetchOptions:Uf({method:e,body:r}),url:t,reportServerError:!0})}))}async getRelatedChanges(e,t){const i="?o=SUBMITTABLE",r=await this._changeBaseURL(e,t);return this._restApiHelper.fetchJSON({url:`${r}/related${i}`,anonymizedUrl:`${ij}/related${i}`})}async getChangesSubmittedTogether(e,t=["NON_VISIBLE_CHANGES"]){const i=await this._changeBaseURL(e),r=`/submitted_together?o=${t.join("&o=")}`;return this._restApiHelper.fetchJSON({url:`${i}${r}`,anonymizedUrl:`${tj}${r}`})}async getChangeConflicts(e){const t=await this.getConfig(!1);if(!t?.change?.conflicts_predicate_enabled)return[];const i={O:TC(uf.CURRENT_REVISION,uf.CURRENT_COMMIT,uf.SUBMITTABLE),q:`status:open conflicts:${e}`};return this._restApiHelper.fetchJSON({url:"/changes/",params:i,anonymizedUrl:"/changes/conflicts:*"})}getChangeCherryPicks(e,t,i){const r={O:TC(uf.CURRENT_REVISION,uf.CURRENT_COMMIT),q:[`project:${e}`,`change:${t}`,`-branch:${i}`,"-is:abandoned"].join(" ")};return this._restApiHelper.fetchJSON({url:"/changes/",params:r,anonymizedUrl:"/changes/change:*"})}getChangesWithSameTopic(e,t){const i=TC(uf.LABELS,uf.CURRENT_REVISION,uf.CURRENT_COMMIT,uf.DETAILED_LABELS,uf.SUBMITTABLE),r=[`topic:${Dg(e)}`];t?.openChangesOnly&&r.push("status:open"),void 0!==t?.changeToExclude&&r.push(`-change:${t.changeToExclude}`);const o={O:i,q:r.join(" ")};return this._restApiHelper.fetchJSON({url:"/changes/",params:o,anonymizedUrl:"/changes/topic:*"})}getChangesWithSimilarTopic(e,t){const i=`intopic:${Dg(e)}`;return this._restApiHelper.fetchJSON({url:"/changes/",params:{q:i},anonymizedUrl:"/changes/intopic:*",errFn:t})}getChangesWithSimilarHashtag(e,t){const i=`inhashtag:${Dg(e)}`;return this._restApiHelper.fetchJSON({url:"/changes/",params:{q:i},anonymizedUrl:"/changes/inhashtag:*",errFn:t})}async getReviewedFiles(e,t){const i=await this._changeBaseURL(e,t);return this._restApiHelper.fetchJSON({url:`${i}/files?reviewed`,anonymizedUrl:`${ij}/files?reviewed`})}async saveFileReviewed(e,t,i,r){const o=await this._changeBaseURL(e,t);return this._restApiHelper.fetch({fetchOptions:{method:r?Uu.PUT:Uu.DELETE},url:`${o}/files/${encodeURIComponent(i)}/reviewed`,anonymizedUrl:`${ij}/files/*/reviewed`,reportServerError:!0})}getSaveReviewChangeOptions(){return["CHANGE_ACTIONS","DETAILED_LABELS","DETAILED_ACCOUNTS","MESSAGES","REVIEWER_UPDATES","SUBMITTABLE","SKIP_DIFFSTAT","SUBMIT_REQUIREMENTS"]}async saveChangeReview(e,t,i,r,o){o&&(i.response_format_options=this.getSaveReviewChangeOptions());const s=[this.awaitPendingDiffDrafts(),this.getChangeActionURL(e,t,"/review")];return Promise.all(s).then((([,e])=>this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.POST,body:i}),url:e,errFn:r})))}async getChangeEdit(e){if(!e)return;if(!await this.getLoggedIn())return;const t=await this._changeBaseURL(e),i=await this._restApiHelper.fetch({url:`${t}/edit/`,params:{"download-commands":!0},anonymizedUrl:`${tj}/edit/`});return i.ok&&204!==i.status?(await Df(i)).parsed:void 0}createChange(e,t,i,r,o,s,n,a){return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.POST,body:{project:e,branch:t,subject:i,topic:r,is_private:o,work_in_progress:s,base_change:n,base_commit:a}}),url:"/changes/",reportUrlAsIs:!0})}getFileContent(e,t,i){return(i===Ju?this._getFileInChangeEdit(e,t):this._getFileInRevision(e,t,i,lj)).then((e=>{if(!e.ok||204===e.status)return e;const t=e.headers.get("X-FYI-Content-Type");return Df(e).then((e=>({content:e.parsed,type:t,ok:!0})))}))}async _getFileInRevision(e,t,i,r){const o=await this._changeBaseURL(e,i);return this._restApiHelper.fetch({fetchOptions:Uf({headers:{Accept:"application/json"}}),url:`${o}/files/${encodeURIComponent(t)}/content`,errFn:r,anonymizedUrl:`${ij}/files/*/content`,reportServerError:!0})}async _getFileInChangeEdit(e,t){const i=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:Uf({headers:{Accept:"application/json"}}),url:`${i}/edit/${encodeURIComponent(t)}`,anonymizedUrl:`${tj}/edit/*`,reportServerError:!0})}async rebaseChangeEdit(e){const t=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:{method:Uu.POST},url:`${t}/edit:rebase`,anonymizedUrl:`${tj}/edit:rebase`,reportServerError:!0})}async deleteChangeEdit(e){const t=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`${t}/edit`,anonymizedUrl:`${tj}/edit`,reportServerError:!0})}async restoreFileInChangeEdit(e,t){const i=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,body:{restore_path:t}}),url:`${i}/edit`,anonymizedUrl:`${tj}/edit`,reportServerError:!0})}async renameFileInChangeEdit(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,body:{old_path:t,new_path:i}}),url:`${r}/edit`,anonymizedUrl:`${tj}/edit`,reportServerError:!0})}async deleteFileInChangeEdit(e,t){const i=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`${i}/edit/${encodeURIComponent(t)}`,anonymizedUrl:`${tj}/edit/*`,reportServerError:!0})}async saveChangeEdit(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:i,contentType:"text/plain"}),url:`${r}/edit/${encodeURIComponent(t)}`,anonymizedUrl:`${tj}/edit/*`,reportServerError:!0})}async saveFileUploadChangeEdit(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{binary_content:i}}),url:`${r}/edit/${encodeURIComponent(t)}`,anonymizedUrl:`${tj}/edit/*`,reportServerError:!0})}async getFixPreview(e,t,i){const r=await this._changeBaseURL(e,t);return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.POST,body:{fix_replacement_infos:i}}),url:`${r}/fix:preview`,anonymizedUrl:`${ij}/fix:preview`})}async applyFixSuggestion(e,t,i,r,o){const s=await this._changeBaseURL(e,r??t),n={fix_replacement_infos:i};return void 0!==r&&r!==t&&(n.original_patchset_for_fix=t),this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,headers:{Accept:"application/json"},body:n}),url:`${s}/fix:apply`,anonymizedUrl:`${ij}/fix:apply`,errFn:o,reportServerError:!0})}async publishChangeEdit(e){const t=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:{method:Uu.POST},url:`${t}/edit:publish`,anonymizedUrl:`${tj}/edit:publish`,reportServerError:!0})}async putChangeCommitMessage(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{message:t,committer_email:i}}),url:`${r}/message`,anonymizedUrl:`${tj}/message`,reportServerError:!0})}async updateIdentityInChangeEdit(e,t,i,r){const o=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{name:t,email:i,type:r}}),url:`${o}/edit:identity`,anonymizedUrl:`${tj}/edit:identity`,reportServerError:!0})}async deleteChangeCommitMessage(e,t){const i=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`${i}/messages/${t}`,anonymizedUrl:`${tj}/messages/${t}`,reportServerError:!0})}saveChangeStarred(e,t){return this.getRepoName(e).then((i=>{const r=`/accounts/self/starred.changes/${encodeURIComponent(i)+"~"}${e}`;return this._serialScheduler.schedule((()=>this._restApiHelper.fetch({fetchOptions:{method:t?Uu.PUT:Uu.DELETE},url:r,anonymizedUrl:"/accounts/self/starred.changes/*"})))}))}send(e,t,i,r,o,s){return this._restApiHelper.fetch({fetchOptions:Uf({method:e,body:i,contentType:o,requestOrigin:s}),url:t,errFn:r,reportServerError:!0})}async getDiff(e,t,i,r,o,s){const n={intraline:null,whitespace:o||"IGNORE_NONE"};kx(t)?n.parent=Fx(t):t!==Qu&&(n.base=t);const a=await this._changeBaseURL(e,i);return this._restApiHelper.fetchJSON({fetchOptions:Uf({headers:i===Ju?{"Cache-Control":"no-cache"}:void 0}),url:`${a}/files/${encodeURIComponent(r)}/diff`,params:n,errFn:s,anonymizedUrl:`${ij}'/files/*/diff`})}getDiffComments(e,t,i,r){return t||i||r?this._getDiffComments(e,"/comments",{"enable-context":!0,"context-padding":3},t,i,r):this._getDiffComments(e,"/comments",{"enable-context":!0,"context-padding":3})}async getDiffDrafts(e){return await this.getLoggedIn()?dC(await this._getDiffComments(e,"/drafts",{"enable-context":!0,"context-padding":3})):{}}_setRange(e,t){if(t.in_reply_to&&!t.range)for(let i=0;i<e.length;i++)if(e[i].id===t.in_reply_to){t.range=e[i].range;break}return t}_setRanges(e){(e=e||[]).sort(((e,t)=>Wm(e.updated).valueOf()-Wm(t.updated).valueOf()));for(const t of e)this._setRange(e,t);return e}_getDiffComments(e,t,i,r,o,s){const n=r=>this._changeBaseURL(e,r).then((e=>this._restApiHelper.fetchJSON({url:`${e}${t}`,anonymizedUrl:`${ij}${t}`,params:i},!0)));if(!r&&!o&&!s)return n();function a(e){return e.side===Yu.PARENT}function l(e){return e.side!==Yu.PARENT}function d(e){e.path=s}const c=[];let h,p,u;return u=n(o).then((e=>{h=e&&s&&e[s]||[],h=this._setRanges(h),r===Qu&&(p=h.filter(a),p.forEach(d)),h=h.filter(l),h.forEach(d)})),c.push(u),r!==Qu&&(u=n(r).then((e=>{p=(e&&s&&e[s]||[]).filter(l),p=this._setRanges(p),p.forEach(d)})),c.push(u)),Promise.all(c).then((()=>Promise.resolve({baseComments:p,comments:h})))}async getPortedComments(e,t){const i=await this._changeBaseURL(e,t);return this._restApiHelper.fetchJSON({url:`${i}/ported_comments/`,errFn:e=>{e&&console.info(`Fetching ported comments failed, ${e.status}`)}})}async getPortedDrafts(e,t){if(!await this.getLoggedIn())return{};const i=await this._changeBaseURL(e,t);return dC(await this._restApiHelper.fetchJSON({url:`${i}/ported_drafts/`,errFn:e=>{e&&console.info(`Fetching ported drafts failed, ${e.status}`)}}))}saveDiffDraft(e,t,i){return this._sendDiffDraftRequest(Uu.PUT,e,t,i)}deleteDiffDraft(e,t,i){return this._sendDiffDraftRequest(Uu.DELETE,e,t,i)}hasPendingDiffDrafts(){const e=this._pendingRequests[QH];return e&&e.length}awaitPendingDiffDrafts(){return Promise.all(this._pendingRequests[QH]||[]).then((()=>{this._pendingRequests[QH]=[]}))}_sendDiffDraftRequest(e,t,i,r){const o=!r.id&&e===Uu.PUT;let s="/drafts",n=s;r.id&&(s+=`/${r.id}`,n+="/*"),this._pendingRequests[QH]||(this._pendingRequests[QH]=[]);const a=e===Uu.PUT?Uf({method:e,body:r}):{method:e},l=this._changeBaseURL(t,i).then((e=>this._restApiHelper.fetch({fetchOptions:a,url:`${e}${s}`,anonymizedUrl:`${ij}${n}`,reportServerError:!0})));return this._pendingRequests[QH].push(l),o?this._failForCreate200(l):l}getCommitInfo(e,t){return this._restApiHelper.fetchJSON({url:"/projects/"+encodeURIComponent(e)+"/commits/"+encodeURIComponent(t),anonymizedUrl:"/projects/*/commits/*"})}_fetchB64File(e){return this._restApiHelper.fetch({url:e}).then((e=>{if(!e.ok)return Promise.reject(new Error(e.statusText));const t=e.headers.get("X-FYI-Content-Type");return e.text().then((e=>({body:e,type:t})))}))}getB64FileContents(e,t,i,r){const o="number"==typeof r?`?parent=${r}`:"";return this._changeBaseURL(e,t).then((e=>(e=`${e}/files/${encodeURIComponent(i)}/content${o}`,this._fetchB64File(e))))}getImagesForDiff(e,t,i){let r,o;return r=t.meta_a?.content_type.startsWith("image/")?i.basePatchNum===Qu?this.getB64FileContents(e,i.patchNum,t.meta_a.name,1):this.getB64FileContents(e,i.basePatchNum,t.meta_a.name):Promise.resolve(null),o=t.meta_b?.content_type.startsWith("image/")?this.getB64FileContents(e,i.patchNum,t.meta_b.name):Promise.resolve(null),Promise.all([r,o]).then((e=>({baseImage:e[0]&&t.meta_a?{...e[0],_expectedType:t.meta_a.content_type,_name:t.meta_a.name}:null,revisionImage:e[1]&&t.meta_b?{...e[1],_expectedType:t.meta_b.content_type,_name:t.meta_b.name}:null})))}_changeBaseURL(e,t){return this.getRepoName(e).then((i=>{let r=`/changes/${encodeURIComponent(i)}~${e}`;return t&&(r+=`/revisions/${t}`),r}))}async addToAttentionSet(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,body:{user:t,reason:i}}),url:`${r}/attention`,anonymizedUrl:`${tj}/attention`,reportServerError:!0})}async removeFromAttentionSet(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.DELETE,body:{reason:i}}),url:`${r}/attention/${t}`,anonymizedUrl:`${tj}/attention/*`,reportServerError:!0})}async setChangeTopic(e,t,i){const r=await this._changeBaseURL(e),o=await this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{topic:t}}),url:`${r}/topic`,anonymizedUrl:`${tj}/topic`,errFn:i});if(o.ok)return 204===o.status?"":(await Df(o)).parsed}removeChangeTopic(e,t){return this.setChangeTopic(e,"",t)}async setChangeHashtag(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.POST,body:t}),url:`${r}/hashtags`,anonymizedUrl:`${tj}/hashtags`,errFn:i})}getAccountAuthTokens(){const e={url:"/accounts/self/tokens",reportUrlAsIs:!0,reportServerError:!0,errFn:(t,i)=>{t&&405!==t.status&&404!==t.status&&ra(t,e)}};return this._restApiHelper.fetchJSON(e)}deleteAccountAuthToken(e){return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`/accounts/self/tokens/${e}`,reportUrlAsIs:!0,reportServerError:!0})}generateAccountAuthToken(e,t){return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.PUT,body:{id:e,lifetime:t}}),url:`/accounts/self/tokens/${e}`,reportUrlAsIs:!0})}getAccountSSHKeys(){return this._restApiHelper.fetchCacheJSON({url:"/accounts/self/sshkeys",reportUrlAsIs:!0})}addAccountSSHKey(e){return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.POST,body:e,contentType:"text/plain"}),url:"/accounts/self/sshkeys",reportUrlAsIs:!0,errFn:Ff})}deleteAccountSSHKey(e){return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:"/accounts/self/sshkeys/"+e,anonymizedUrl:"/accounts/self/sshkeys/*",reportServerError:!0})}getAccountGPGKeys(){return this._restApiHelper.fetchJSON({url:"/accounts/self/gpgkeys",reportUrlAsIs:!0})}addAccountGPGKey(e){return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.POST,body:e}),url:"/accounts/self/gpgkeys",reportUrlAsIs:!0,errFn:Ff})}deleteAccountGPGKey(e){return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`/accounts/self/gpgkeys/${e}`,anonymizedUrl:"/accounts/self/gpgkeys/*",reportServerError:!0})}async deleteVote(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`${r}/reviewers/${t}/votes/${encodeURIComponent(i)}`,anonymizedUrl:`${tj}/reviewers/*/votes/*`,reportServerError:!0})}async setDescription(e,t,i){const r=await this._changeBaseURL(e,t);return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{description:i}}),url:`${r}/description`,anonymizedUrl:`${ij}/description`,reportServerError:!0})}async confirmEmail(e){const t=await this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.PUT,body:{token:e}}),url:"/config/server/email.confirm",reportUrlAsIs:!0,reportServerError:!0});return 204===t?.status?"Email confirmed successfully.":null}getCapabilities(e){return this._restApiHelper.fetchJSON({url:"/config/server/capabilities",errFn:e,reportUrlAsIs:!0})}getTopMenus(){return this._restApiHelper.fetchCacheJSON({url:"/config/server/top-menus",reportUrlAsIs:!0})}probePath(e){return fetch(new Request(e,{method:Uu.HEAD})).then((e=>e.ok))}async startWorkInProgress(e,t){const i=await this._changeBaseURL(e);if(204===(await this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,body:t?{message:t}:{}}),url:`${i}/wip`,anonymizedUrl:`${tj}/wip`,reportServerError:!0})).status)return"Change marked as Work In Progress."}async deleteComment(e,t,i,r){const o=await this._changeBaseURL(e,t);return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.POST,body:{reason:r}}),url:`${o}/comments/${i}/delete`,anonymizedUrl:`${ij}/comments/*/delete`})}getChange(e,t,i){return e in this._projectLookup?this._changeBaseURL(e).then((e=>this._restApiHelper.fetchJSON({url:e,params:i?{O:i}:void 0,errFn:t,anonymizedUrl:"/changes/*~*"},!0))):this._restApiHelper.fetchJSON({url:`/changes/?q=change:${e}`,errFn:t,anonymizedUrl:"/changes/?q=change:*"},!0).then((e=>{const t=e;if(t&&t.length)return t[0]}))}addRepoNameToCache(e,t){this._projectLookup[e]=Promise.resolve(t)}getRepoName(e){let t=this._projectLookup[e];return t||(t=this.getChange(e,(()=>{})).then((i=>{if(i?.project)return i.project;const r=this._projectLookup[e];if(r&&r!==t)return r;throw ia(new Response(`Failed to lookup the repo for change number ${e}`,{status:404})),this._projectLookup[e]=void 0,new Error(`Failed to lookup the repo for change number ${e}`)})),this._projectLookup[e]=t,t)}async executeChangeAction(e,t,i,r,o,s){const n=await this._changeBaseURL(e,r);return this._restApiHelper.fetch({fetchOptions:Uf({method:t,body:o}),url:n+i,errFn:s,reportServerError:!0})}async getBlame(e,t,i,r){const o=encodeURIComponent(i),s=await this._changeBaseURL(e,t);return this._restApiHelper.fetchJSON({url:`${s}/files/${o}/blame`,params:r?{base:"t"}:void 0,anonymizedUrl:`${ij}/files/*/blame`})}async getPatchContent(e,t,i){const r=await this._changeBaseURL(e,t),o={download:"",raw:""};void 0!==i&&3!==i&&(o.context=i);const s=await this._restApiHelper.fetch({url:`${r}/patch`,params:o,anonymizedUrl:`${ij}/patch`});if(s?.ok)return await s.text()}_failForCreate200(e){return e.then((e=>{if(200===e.status){const t=Array.from(e.headers.entries()).reduce(((e,[t,i])=>(ej.test(t)||(e[t]=i),e)),{});throw new Error([ZH,JSON.stringify(t)].join("\n"))}return e}))}getDashboard(e,t,i){const r="/projects/"+encodeURIComponent(e)+"/dashboards/"+encodeURIComponent(t);return this._restApiHelper.fetchCacheJSON({url:r,errFn:i,anonymizedUrl:"/projects/*/dashboards/*"})}getDocumentationSearches(e){e=e.trim();const t=encodeURIComponent(e);return this._restApiHelper.fetchCacheJSON({url:`/Documentation/?q=${t}`,anonymizedUrl:"/Documentation/?*"})}async getMergeable(e){const t=await this._changeBaseURL(e);return this._restApiHelper.fetchJSON({url:`${t}/revisions/current/mergeable`,anonymizedUrl:`${tj}/revisions/current/mergeable`})}deleteDraftComments(e){const t={query:e};return this._restApiHelper.fetch({fetchOptions:Uf({method:Uu.POST,body:t}),url:"/accounts/self/drafts:delete"})}async getFlow(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetchJSON({url:`${r}/flows/${t}`,errFn:i,anonymizedUrl:`${tj}/flows/*`})}async listFlows(e,t){const i=await this._changeBaseURL(e);return this._restApiHelper.fetchJSON({url:`${i}/flows`,errFn:t,anonymizedUrl:`${tj}/flows`})}async getIfFlowsIsEnabled(e,t){const i=await this._changeBaseURL(e);return this._restApiHelper.fetchJSON({url:`${i}/is-flows-enabled`,errFn:t,anonymizedUrl:`${tj}/is-flows-enabled`})}async createFlow(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetchJSON({fetchOptions:Uf({method:Uu.POST,body:t}),url:`${r}/flows`,errFn:i,anonymizedUrl:`${tj}/flows`})}async deleteFlow(e,t,i){const r=await this._changeBaseURL(e);return this._restApiHelper.fetch({fetchOptions:{method:Uu.DELETE},url:`${r}/flows/${t}`,errFn:i,anonymizedUrl:`${tj}/flows/*`})}}const cj={view:gw.AGREEMENTS},hj=mu("agreement-view-model");class pj extends df{constructor(){super(cj)}}class uj{constructor(e,t,i){this.reporting=e,this.pluginsModel=t,this.changeModel=i,this.suggestionsServiceUpdated$=new Up(!1),this.pluginsModel.suggestionsPlugins$.subscribe((e=>{this.suggestionsProvider=e?.[0]?.provider,this.suggestionsServiceUpdated$.next(!0)})),this.changeModel.change$.subscribe((e=>{this.change=e,this.suggestionsServiceUpdated$.next(!0)}))}finalize(){}isGeneratedSuggestedFixEnabled(e){return!!this.suggestionsProvider&&!!this.change&&!!e&&e!==hg.PATCHSET_LEVEL_COMMENTS&&e!==hg.COMMIT_MESSAGE&&e!==hg.MERGE_LIST&&!0!==this.change.is_private&&(!this.suggestionsProvider.supportedFileExtensions||this.suggestionsProvider.supportedFileExtensions.includes(HR(e)))}isGeneratedSuggestedFixEnabledForComment(e){return this.isGeneratedSuggestedFixEnabled(e?.path)&&e?.side!==Yu.PARENT&&!!e&&!wC(e)&&!uC(e)}async generateSuggestedFix(e){if(!this.suggestionsProvider?.suggestFix||!this.change)return;this.reporting.reportInteraction(ga.GENERATE_SUGGESTION_REQUEST,{uuid:e.generatedSuggestionId,type:"suggest-fix",commentId:e.commentId,source:e.reportSource,fileExtension:HR(e.filePath??"")});const t=await this.suggestionsProvider.suggestFix({prompt:e.prompt,changeInfo:this.change,patchsetNumber:e.patchsetNumber,filePath:e.filePath,range:e.range,lineNumber:e.lineNumber});this.reporting.reportInteraction(ga.GENERATE_SUGGESTION_RESPONSE,{uuid:e.generatedSuggestionId,type:"suggest-fix",commentId:e.commentId,source:e.reportSource,response:t.responseCode,numSuggestions:t.fix_suggestions.length,fileExtension:HR(e.filePath??""),logProbability:t.fix_suggestions?.[0]?.log_probability});const i=t.fix_suggestions?.[0];return i?.replacements&&0!==i.replacements.length?i:void 0}async generateSuggestedFixForComment(e,t,i,r){if(e&&e.path&&e.patch_set&&this.suggestionsProvider?.suggestFix&&this.change&&t)return this.generateSuggestedFix({prompt:t,patchsetNumber:e.patch_set,filePath:e.path,range:e.range,lineNumber:e.line,generatedSuggestionId:i,commentId:Vx(e),reportSource:r})}async autocompleteComment(e,t,i){if(!(e&&e.path&&e.patch_set&&t&&0!==t.length&&this.change&&this.suggestionsProvider?.autocompleteComment))return;this.reporting.time(ua.COMMENT_COMPLETION);const r=await this.suggestionsProvider.autocompleteComment({id:Vx(e),commentText:t,changeInfo:this.change,patchsetNumber:e?.patch_set,filePath:e.path,range:e.range,lineNumber:e.line}),o=this.reporting.timeEnd(ua.COMMENT_COMPLETION);return this.createAutocompletionContext(t,r,o,e,i)}createAutocompletionContext(e,t,i,r,o){const s=t.completion??"";return{...this.createAutocompletionBaseContext(r,o),draftContent:e,draftContentLength:e.length,commentCompletion:s,commentCompletionLength:s.length,isFullCommentPrediction:0===e.length,draftInSyncWithSuggestionLength:0,modelVersion:t.modelVersion??"",outcome:t.outcome,responseCode:t.responseCode,requestDurationMs:i}}createAutocompletionBaseContext(e,t){return{commentId:Vx(e),commentNumber:t?.length??0,filePath:e.path,fileExtension:HR(e.path??"")}}}var gj=window&&window.__decorate||function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};L=!1,E(!0),function(e){Yn(e);{const t=e.reportingService;!function(e){document.addEventListener("visibilitychange",(()=>{e.onVisibilityChange()})),window.addEventListener("blur",(()=>{e.onFocusChange()})),window.addEventListener("focus",(()=>{e.onFocusChange()}))}(t),function(e){window.PerformanceObserver&&(PerformanceObserver.supportedEntryTypes||[]).includes("longtask")&&new PerformanceObserver((t=>{for(const i of t.getEntries())i.duration>400&&e.reporter(nl,al,`Task ${i.name}`,Math.round(i.duration),{},!1)})).observe({entryTypes:["longtask"]})}(t),Al(t),function(e){const t=e=>{if(e instanceof Error)return e;let t="";t+="string"==typeof e?e:JSON.stringify(e);const i=new Error(t);return i.stack="unknown",i},i=function(i){const r=(i=i||window).onerror;i.onerror=(i,o,s,n,a)=>function(i,r,o,s,n,a){return i&&i(r,o,s,n,a),a&&(s=s??a.lineNumber,n=n??a.columnNumber),e.error("onError",t(a),{line:s,column:n,url:o,msg:r}),!0}(r,i,o,s,n,a),i.addEventListener("unhandledrejection",(i=>{e.error("unhandledrejection",t(i.reason))}))};i()}(t),function(e){document.addEventListener("click",(t=>{const i=t.composedPath().find((e=>An(e)&&"A"===e.tagName.toUpperCase()));i&&e.reportInteraction(ga.LINK_CLICK,{path:Tn(t),link:i.href,text:i.innerText})}))}(t),function(e){kl||(kl=new $l(e))}(t)}window.GrPluginActionContext=la}(function(e){const t={finalize(){for(const t of Object.getOwnPropertyNames(e)){const e=t;try{this[e]&&this[e].finalize()}catch(t){throw console.info(`Failed to finalize ${String(e)}`),t}}}},i=new Map;for(const r of Object.keys(e)){const o=r,s=e[o];let n=!1;Object.defineProperty(t,o,{configurable:!0,get(){if(!i.has(o)){if(n)throw new Error(`Circular dependency for ${r}`);try{n=!0,i.set(o,s(t))}catch(e){console.error(`Failed to initialize ${String(o)}`,e)}finally{n=!1}}return i.get(o)}})}return t}({flagsService:e=>new qH,reportingService:e=>(ba(e.flagsService,"flagsService)"),new Il(e.flagsService)),authService:e=>new YH,restApiService:e=>(ba(e.authService,"authService"),ba(e.flagsService,"flagsService"),new dj(e.authService,e.flagsService))})),function(e,t=WH.polymer_resin.CONSOLE_LOGGING_REPORT_HANDLER){window.security.polymer_resin.install({allowedIdentifierPrefixes:[""],reportHandler:t,safeTypesBridge:e})}((function(e,i){if("URL"===i){let i=null;if(e instanceof t?i=e:"string"==typeof e&&(i=new t(e)),i)return i.toString()}if("STRING"===i||"CONSTANT"===i)return e;throw new Error(`Refused to bind value as ${i}: ${e}`)}));let mj=class extends Ic{constructor(){super(...arguments),this.finalizables=[]}connectedCallback(){super.connectedCallback();const e=new Map,t=(t,i)=>{let r;e.set(t,(()=>r||(r=i(),this.finalizables.push(r),r)))},i=t=>{const i=e.get(t);if(i)return i();throw new _u(t,"Forgot to set up dependency for gr-app")};for(const[e,r]of function(e,t){return new Map([[sU,()=>e.authService],[mw,()=>new fw(t(U_))],[jf,()=>new Gf(e.restApiService)],[LL,()=>new ML(t(jf))],[mE,()=>new fE(e.restApiService)],[Rw,()=>new Tw],[hj,()=>new pj],[XC,()=>new JC],[lE,()=>new dE],[C$,()=>new E$],[rw,()=>new ow],[YU,()=>new XU],[yw,()=>new ww],[iE,()=>new rE(e.restApiService,t(jf),(()=>t(gy)))],[mO,()=>new fO],[LH,()=>new MH(e.reportingService,t(mw),e.restApiService,t(Rw),t(hj),t(XC),t(lE),t(C$),t(rw),t(YU),t(yw),t(iE),t(mO))],[gy,()=>t(LH)],[MT,()=>new FT(t(gy),t(XC),e.restApiService,t(jf),t(U_),e.reportingService,e.flagsService)],[kP,()=>new AP(t(XC),t(MT),t(mE),e.restApiService,e.reportingService,t(gy))],[NM,()=>new OM(t(MT),t(kP),t(sP),e.restApiService,e.reportingService)],[Qw,()=>new Zw(t(MT),e.restApiService)],[sD,()=>new nD(t(MT),t(Qw),e.restApiService)],[U_,()=>new B_(e.reportingService,e.restApiService)],[sP,()=>new aP(t(XC),t(MT),e.reportingService,t(U_).pluginsModel)],[Bg,()=>new Hg(t(jf),e.reportingService)],[TO,()=>new IO],[ST,()=>new $T(e.reportingService)],[pO,()=>new uO(e.flagsService,e.reportingService,t(jf))],[UT,()=>new uj(e.reportingService,t(U_).pluginsModel,t(MT))],[RP,()=>new TP(t(MT))]])}(Xn(),i))t(e,r);for(const[t,i]of e)bu(this,t,i);var r;r=i(U_),window.Gerrit=r,this.serviceWorkerInstaller||(this.serviceWorkerInstaller=i(pO))}disconnectedCallback(){for(const e of this.finalizables)e.finalize();this.finalizables=[],super.disconnectedCallback()}render(){return dc`<gr-app-element id="app-element"></gr-app-element>`}};mj=gj([Dc("gr-app")],mj);